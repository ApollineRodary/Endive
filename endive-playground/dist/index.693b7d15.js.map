{"mappings":"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BACE,MAAM;YACR;YACA;gBACE,MAAM;gBACN,MAAM;YACR;SACD;QACD,mBAAmB;QACnB,eAAe;QACf,QAAQ;QACR,SAAS;QACT,SAAS;IACX;IAEA,aAAa;IACb;QACE,MAAM;QACN,UAAU;QACV,OAAO;YACL;gBACE,MAAM;gBACN,MAAM;gBACN,UAAU;YACZ;YACA;gBACE,MAAM;gBACN,MAAM;YACR;SACD;QACD,QAAQ;QACR,QAAQ;QACR,SAAS;QACT,SAAS;IACX;IAEA;QACE,MAAM;QACN,UAAU;QACV,OAAO;YACL;gBACE,MAAM;gBACN,MAAM;gBACN,UAAU;YACZ;YACA;gBACE,MAAM;gBACN,MAAM;YACR;SACD;QACD,QAAQ;QACR,QAAQ;QACR,SAAS;QACT,SAAS;IACX;IAEA;QACE,MAAM;QACN,UAAU;QACV,OAAO;YACL;gBACE,MAAM;gBACN,MAAM;YACR;YACA;gBACE,MAAM;gBACN,MAAM;YACR;SACD;QACD,cAAc;QACd,QAAQ;QACR,QAAQ;QACR,SAAS;QACT,SAAS;IACX;IAEA;QACE,MAAM;QACN,UAAU;QACV,OAAO;YACL;gBACE,MAAM;gBACN,MAAM;YACR;YACA;gBACE,MAAM;gBACN,MAAM;YACR;SACD;QACD,cAAc;QACd,QAAQ;QACR,QAAQ;QACR,SAAS;QACT,SAAS;IACX;IAEA;QACE,MAAM;QACN,UAAU;QACV,OAAO;YACL;gBACE,MAAM;gBACN,MAAM;gBACN,UAAU;YACZ;SACD;QACD,QAAQ;QACR,QAAQ;QACR,SAAS;QACT,SAAS;IACX;IAEA,UAAU;IACV;QACE,MAAM;QACN,UAAU;QACV,OAAO;YACL;gBACE,MAAM;gBACN,MAAM;gBACN,UAAU;YACZ;YACA;gBACE,MAAM;gBACN,MAAM;YACR;SACD;QACD,cAAc;QACd,mBAAmB;QACnB,eAAe;QACf,QAAQ;QACR,SAAS;QACT,SAAS;QACT,YAAY;YAAC;SAAwB;IACvC;IAEA;QACE,MAAM;QACN,UAAU;QACV,OAAO;YACL;gBACE,MAAM;gBACN,MAAM;YACR;SACD;QACD,mBAAmB;QACnB,eAAe;QACf,QAAQ;QACR,SAAS;QACT,SAAS;IACX;IAEA;QACE,MAAM;QACN,UAAU;QACV,OAAO;YACL;gBACE,MAAM;gBACN,MAAM;YACR;SACD;QACD,mBAAmB;QACnB,eAAe;QACf,QAAQ;QACR,SAAS;QACT,SAAS;IACX;CACD;AAED,MAAQ,MAAM,CAAC,sBAAsB,GAAG;IACtC,MAAM;QACJ,IAAI,CAAC,gBAAgB,CAAC;QACtB,IAAI,CAAC,gBAAgB,CAAC,cAAc,WAAW,CAAC;QAChD,IAAI,CAAC,SAAS,CAAC,MAAM;QACrB,IAAI,CAAC,SAAS,CAAC;QACf,IAAI,CAAC,YAAY,GAAG;QACpB,IAAI,YAAY,IAAI;QACpB,IAAI,CAAC,SAAS,CAAC,gBAAgB,CAAC,YAAY,SAAU,KAAK;YACzD,UAAU,YAAY,GAAG,CAAC,UAAU,YAAY;YAChD,UAAU,eAAe,CAAC,UAAU,YAAY;YAChD,MAAM,eAAe;QACvB;IACF;AACF;AAEA,MAAQ,UAAU,CAAC,QAAQ,CAAC,yBAAyB;IACnD,IAAI,YAAY,IAAI;IACpB,IAAI,CAAC,QAAQ,CAAC,QAAQ,WAAW,CAC/B,IAAI,MAAQ,aAAa,CAAC;QACxB,OAAO,CAAA,GAAA,wBAAW,AAAD,EAAE,GAAG,CAAC,CAAC,IAAM;gBAAC,CAAC,CAAC,EAAE;gBAAE,CAAC,CAAC,EAAE,CAAC,WAAW;aAAG;IAC1D;AAEJ","sources":["node_modules/@parcel/runtime-browser-hmr/lib/runtime-5a9b1d98c8e19d60.js","endive-playground/src/scripts/main.js","node_modules/blockly/core-browser.js","node_modules/blockly/blockly.js","node_modules/blockly/blockly_compressed.js","node_modules/blockly/core/registry.ts","node_modules/blockly/core/common.ts","node_modules/blockly/core/utils/idgenerator.ts","node_modules/blockly/core/events/utils.ts","node_modules/blockly/core/touch.ts","node_modules/blockly/core/browser_events.ts","node_modules/blockly/core/utils/array.ts","node_modules/blockly/core/css.ts","node_modules/blockly/core/utils/deprecation.ts","node_modules/blockly/core/utils/dom.ts","node_modules/blockly/core/utils/style.ts","node_modules/blockly/core/utils/svg_math.ts","node_modules/blockly/core/utils/xml.ts","node_modules/blockly/core/utils/toolbox.ts","node_modules/blockly/core/positionable_helpers.ts","node_modules/blockly/core/dialog.ts","node_modules/blockly/core/interfaces/i_variable_backed_parameter_model.ts","node_modules/blockly/core/interfaces/i_legacy_procedure_blocks.ts","node_modules/blockly/core/variables.ts","node_modules/blockly/core/clipboard/registry.ts","node_modules/blockly/core/render_management.ts","node_modules/blockly/core/xml.ts","node_modules/blockly/core/interfaces/i_serializable.ts","node_modules/blockly/core/serialization/registry.ts","node_modules/blockly/core/serialization/blocks.ts","node_modules/blockly/core/clipboard/block_paster.ts","node_modules/blockly/core/clipboard.ts","node_modules/blockly/core/utils/aria.ts","node_modules/blockly/core/widgetdiv.ts","node_modules/blockly/core/contextmenu.ts","node_modules/blockly/core/utils/math.ts","node_modules/blockly/core/dropdowndiv.ts","node_modules/blockly/core/block_animations.ts","node_modules/blockly/core/utils/string.ts","node_modules/blockly/core/tooltip.ts","node_modules/blockly/core/utils/object.ts","node_modules/blockly/core/interfaces/i_has_bubble.ts","node_modules/blockly/core/utils/colour.ts","node_modules/blockly/core/utils/parsing.ts","node_modules/blockly/core/interfaces/i_procedure_block.ts","node_modules/blockly/core/interfaces/i_observable.ts","node_modules/blockly/core/field_registry.ts","node_modules/blockly/core/field_dropdown.ts","node_modules/blockly/core/extensions.ts","node_modules/blockly/core/utils/svg_paths.ts","node_modules/blockly/core/icons/registry.ts","node_modules/blockly/core/procedures.ts","node_modules/blockly/core/renderers/common/constants.ts","node_modules/blockly/core/keyboard_nav/ast_node.ts","node_modules/blockly/core/connection.ts","node_modules/blockly/core/renderers/common/block_rendering.ts","node_modules/blockly/core/variables_dynamic.ts","node_modules/blockly/core/workspace_svg.ts","node_modules/blockly/core/interfaces/i_copyable.ts","node_modules/blockly/core/shortcut_items.ts","node_modules/blockly/core/serialization/procedures.ts","node_modules/blockly/core/serialization/workspaces.ts","node_modules/blockly/core/bump_objects.ts","node_modules/blockly/core/block_dragger.ts","node_modules/blockly/core/contextmenu_items.ts","node_modules/blockly/core/inject.ts","node_modules/blockly/core/interfaces/i_icon.ts","node_modules/blockly/core/interfaces/i_paster.ts","node_modules/blockly/core/interfaces/i_selectable_toolbox_item.ts","node_modules/blockly/core/blockly.ts","node_modules/blockly/core/interfaces/i_rendered_element.ts","node_modules/blockly/src/com/google/javascript/jscomp/js/base.js","node_modules/blockly/src/com/google/javascript/jscomp/js/util/defines.js","node_modules/blockly/src/com/google/javascript/jscomp/js/util/defineproperty.js","node_modules/blockly/src/com/google/javascript/jscomp/js/util/global.js","node_modules/blockly/src/com/google/javascript/jscomp/js/util/shouldpolyfill.js","node_modules/blockly/src/com/google/javascript/jscomp/js/util/polyfill.js","node_modules/blockly/src/com/google/javascript/jscomp/js/es6/globalthis.js","node_modules/blockly/src/com/google/javascript/jscomp/js/es6/util/arrayiterator.js","node_modules/blockly/src/com/google/javascript/jscomp/js/es6/symbol.js","node_modules/blockly/src/com/google/javascript/jscomp/js/es6/util/iteratorfromarray.js","node_modules/blockly/src/com/google/javascript/jscomp/js/es6/array/values.js","node_modules/blockly/src/com/google/javascript/jscomp/js/es6/array/flat.js","node_modules/blockly/src/com/google/javascript/jscomp/js/util/owns.js","node_modules/blockly/src/com/google/javascript/jscomp/js/es6/object/entries.js","node_modules/blockly/src/com/google/javascript/jscomp/js/es6/object/values.js","node_modules/blockly/core/blocks.ts","node_modules/blockly/core/events/events_abstract.ts","node_modules/blockly/core/events/events_ui_base.ts","node_modules/blockly/core/events/events_click.ts","node_modules/blockly/core/utils/useragent.ts","node_modules/blockly/core/component_manager.ts","node_modules/blockly/core/utils/coordinate.ts","node_modules/blockly/core/utils/svg.ts","node_modules/blockly/core/utils/rect.ts","node_modules/blockly/core/utils/size.ts","node_modules/blockly/core/scrollbar.ts","node_modules/blockly/core/sprites.ts","node_modules/blockly/core/zoom_controls.ts","node_modules/blockly/core/icons/icon_types.ts","node_modules/blockly/core/inputs/input_types.ts","node_modules/blockly/core/msg.ts","node_modules/blockly/core/events/events_var_base.ts","node_modules/blockly/core/events/events_var_create.ts","node_modules/blockly/core/variable_model.ts","node_modules/blockly/core/workspace_comment.ts","node_modules/blockly/core/events/events_selected.ts","node_modules/blockly/core/clipboard/workspace_comment_paster.ts","node_modules/blockly/core/workspace_comment_svg.ts","node_modules/blockly/core/serialization/exceptions.ts","node_modules/blockly/core/serialization/priorities.ts","node_modules/blockly/core/events/events_block_base.ts","node_modules/blockly/core/events/events_block_create.ts","node_modules/blockly/core/events/events_theme_change.ts","node_modules/blockly/core/events/events_viewport.ts","node_modules/blockly/core/config.ts","node_modules/blockly/core/connection_type.ts","node_modules/blockly/core/connection_db.ts","node_modules/blockly/core/menu.ts","node_modules/blockly/core/menuitem.ts","node_modules/blockly/core/contextmenu_registry.ts","node_modules/blockly/core/layers.ts","node_modules/blockly/core/bubble_dragger.ts","node_modules/blockly/core/internal_constants.ts","node_modules/blockly/core/workspace_dragger.ts","node_modules/blockly/core/gesture.ts","node_modules/blockly/core/grid.ts","node_modules/blockly/core/marker_manager.ts","node_modules/blockly/core/theme.ts","node_modules/blockly/core/theme/classic.ts","node_modules/blockly/core/options.ts","node_modules/blockly/core/events/events_block_change.ts","node_modules/blockly/core/field.ts","node_modules/blockly/core/names.ts","node_modules/blockly/core/observable_procedure_map.ts","node_modules/blockly/core/icons/icon.ts","node_modules/blockly/core/bubbles/bubble.ts","node_modules/blockly/core/bubbles/mini_workspace_bubble.ts","node_modules/blockly/core/icons/mutator_icon.ts","node_modules/blockly/core/utils/keycodes.ts","node_modules/blockly/core/utils.ts","node_modules/blockly/core/bubbles/text_bubble.ts","node_modules/blockly/core/bubbles/textinput_bubble.ts","node_modules/blockly/core/icons/comment_icon.ts","node_modules/blockly/core/icons/warning_icon.ts","node_modules/blockly/core/icons/exceptions.ts","node_modules/blockly/core/icons.ts","node_modules/blockly/core/renderers/measurables/types.ts","node_modules/blockly/core/renderers/measurables/base.ts","node_modules/blockly/core/renderers/measurables/row.ts","node_modules/blockly/core/renderers/measurables/bottom_row.ts","node_modules/blockly/core/renderers/measurables/connection.ts","node_modules/blockly/core/renderers/measurables/input_connection.ts","node_modules/blockly/core/renderers/measurables/external_value_input.ts","node_modules/blockly/core/renderers/measurables/field.ts","node_modules/blockly/core/renderers/measurables/hat.ts","node_modules/blockly/core/renderers/measurables/icon.ts","node_modules/blockly/core/renderers/measurables/in_row_spacer.ts","node_modules/blockly/core/renderers/measurables/inline_input.ts","node_modules/blockly/core/renderers/measurables/statement_input.ts","node_modules/blockly/core/renderers/measurables/input_row.ts","node_modules/blockly/core/renderers/measurables/jagged_edge.ts","node_modules/blockly/core/renderers/measurables/next_connection.ts","node_modules/blockly/core/renderers/measurables/output_connection.ts","node_modules/blockly/core/renderers/measurables/previous_connection.ts","node_modules/blockly/core/renderers/measurables/round_corner.ts","node_modules/blockly/core/renderers/measurables/spacer_row.ts","node_modules/blockly/core/renderers/measurables/square_corner.ts","node_modules/blockly/core/renderers/measurables/top_row.ts","node_modules/blockly/core/renderers/common/drawer.ts","node_modules/blockly/core/inputs/align.ts","node_modules/blockly/core/field_label.ts","node_modules/blockly/core/inputs/input.ts","node_modules/blockly/core/inputs/dummy_input.ts","node_modules/blockly/core/inputs/end_row_input.ts","node_modules/blockly/core/inputs/statement_input.ts","node_modules/blockly/core/inputs/value_input.ts","node_modules/blockly/core/renderers/common/info.ts","node_modules/blockly/core/events/events_marker_move.ts","node_modules/blockly/core/renderers/common/marker_svg.ts","node_modules/blockly/core/renderers/common/path_object.ts","node_modules/blockly/core/constants.ts","node_modules/blockly/core/insertion_marker_manager.ts","node_modules/blockly/core/renderers/common/renderer.ts","node_modules/blockly/core/theme_manager.ts","node_modules/blockly/core/connection_checker.ts","node_modules/blockly/core/events/events_var_delete.ts","node_modules/blockly/core/events/events_var_rename.ts","node_modules/blockly/core/variable_map.ts","node_modules/blockly/core/workspace.ts","node_modules/blockly/core/workspace_audio.ts","node_modules/blockly/core/layer_manager.ts","node_modules/blockly/core/events/events_trashcan_open.ts","node_modules/blockly/core/events/events_block_delete.ts","node_modules/blockly/core/block.ts","node_modules/blockly/core/keyboard_nav/marker.ts","node_modules/blockly/core/keyboard_nav/cursor.ts","node_modules/blockly/core/keyboard_nav/basic_cursor.ts","node_modules/blockly/core/keyboard_nav/tab_navigate_cursor.ts","node_modules/blockly/core/rendered_connection.ts","node_modules/blockly/core/block_svg.ts","node_modules/blockly/core/drag_target.ts","node_modules/blockly/core/delete_area.ts","node_modules/blockly/core/trashcan.ts","node_modules/blockly/core/shortcut_registry.ts","node_modules/blockly/core/serialization/variables.ts","node_modules/blockly/core/serialization.ts","node_modules/blockly/core/scrollbar_pair.ts","node_modules/blockly/core/metrics_manager.ts","node_modules/blockly/core/events/workspace_events.ts","node_modules/blockly/core/events/events_block_drag.ts","node_modules/blockly/core/bubbles.ts","node_modules/blockly/core/events/events_block_field_intermediate_change.ts","node_modules/blockly/core/events/events_block_move.ts","node_modules/blockly/core/events/events_bubble_open.ts","node_modules/blockly/core/events/events_comment_base.ts","node_modules/blockly/core/events/events_comment_change.ts","node_modules/blockly/core/events/events_comment_create.ts","node_modules/blockly/core/events/events_comment_delete.ts","node_modules/blockly/core/events/events_comment_move.ts","node_modules/blockly/core/events/events_toolbox_item_select.ts","node_modules/blockly/core/events/events.ts","node_modules/blockly/core/renderers/zelos/constants.ts","node_modules/blockly/core/renderers/zelos/drawer.ts","node_modules/blockly/core/field_image.ts","node_modules/blockly/core/field_input.ts","node_modules/blockly/core/field_textinput.ts","node_modules/blockly/core/renderers/zelos/measurables/bottom_row.ts","node_modules/blockly/core/renderers/zelos/measurables/inputs.ts","node_modules/blockly/core/renderers/zelos/measurables/row_elements.ts","node_modules/blockly/core/renderers/zelos/measurables/top_row.ts","node_modules/blockly/core/renderers/zelos/info.ts","node_modules/blockly/core/renderers/zelos/marker_svg.ts","node_modules/blockly/core/renderers/zelos/path_object.ts","node_modules/blockly/core/renderers/zelos/renderer.ts","node_modules/blockly/core/renderers/zelos/zelos.ts","node_modules/blockly/core/field_angle.ts","node_modules/blockly/core/field_checkbox.ts","node_modules/blockly/core/field_colour.ts","node_modules/blockly/core/field_label_serializable.ts","node_modules/blockly/core/field_multilineinput.ts","node_modules/blockly/core/field_number.ts","node_modules/blockly/core/field_variable.ts","node_modules/blockly/core/flyout_button.ts","node_modules/blockly/core/flyout_metrics_manager.ts","node_modules/blockly/core/flyout_base.ts","node_modules/blockly/core/flyout_horizontal.ts","node_modules/blockly/core/flyout_vertical.ts","node_modules/blockly/core/generator.ts","node_modules/blockly/core/inputs.ts","node_modules/blockly/core/connection_previewers/insertion_marker_previewer.ts","node_modules/blockly/core/renderers/geras/constants.ts","node_modules/blockly/core/renderers/geras/highlighter.ts","node_modules/blockly/core/renderers/geras/drawer.ts","node_modules/blockly/core/renderers/geras/highlight_constants.ts","node_modules/blockly/core/renderers/geras/measurables/inline_input.ts","node_modules/blockly/core/renderers/geras/measurables/statement_input.ts","node_modules/blockly/core/renderers/geras/info.ts","node_modules/blockly/core/renderers/geras/path_object.ts","node_modules/blockly/core/renderers/geras/renderer.ts","node_modules/blockly/core/renderers/geras/geras.ts","node_modules/blockly/core/renderers/minimalist/constants.ts","node_modules/blockly/core/renderers/minimalist/drawer.ts","node_modules/blockly/core/renderers/minimalist/info.ts","node_modules/blockly/core/renderers/minimalist/renderer.ts","node_modules/blockly/core/renderers/minimalist/minimalist.ts","node_modules/blockly/core/renderers/thrasos/info.ts","node_modules/blockly/core/renderers/thrasos/renderer.ts","node_modules/blockly/core/renderers/thrasos/thrasos.ts","node_modules/blockly/core/theme/zelos.ts","node_modules/blockly/core/theme/themes.ts","node_modules/blockly/core/toolbox/toolbox_item.ts","node_modules/blockly/core/toolbox/category.ts","node_modules/blockly/core/toolbox/separator.ts","node_modules/blockly/core/toolbox/collapsible_category.ts","node_modules/blockly/core/toolbox/toolbox.ts","node_modules/blockly/core/main.ts","node_modules/blockly/core/blockly_options.ts","node_modules/blockly/core/utils/metrics.ts","node_modules/blockly/core/renderers/common/i_path_object.ts","node_modules/blockly/core/interfaces/i_toolbox_item.ts","node_modules/blockly/core/interfaces/i_toolbox.ts","node_modules/blockly/core/interfaces/i_styleable.ts","node_modules/blockly/core/interfaces/i_serializer.ts","node_modules/blockly/core/interfaces/i_selectable.ts","node_modules/blockly/core/interfaces/i_registrable.ts","node_modules/blockly/core/interfaces/i_procedure_model.ts","node_modules/blockly/core/interfaces/i_procedure_map.ts","node_modules/blockly/core/interfaces/i_positionable.ts","node_modules/blockly/core/interfaces/i_parameter_model.ts","node_modules/blockly/core/interfaces/i_movable.ts","node_modules/blockly/core/interfaces/i_metrics_manager.ts","node_modules/blockly/core/interfaces/i_keyboard_accessible.ts","node_modules/blockly/core/interfaces/i_flyout.ts","node_modules/blockly/core/interfaces/i_draggable.ts","node_modules/blockly/core/interfaces/i_drag_target.ts","node_modules/blockly/core/interfaces/i_delete_area.ts","node_modules/blockly/core/interfaces/i_deletable.ts","node_modules/blockly/core/interfaces/i_contextmenu.ts","node_modules/blockly/core/interfaces/i_connection_previewer.ts","node_modules/blockly/core/interfaces/i_connection_checker.ts","node_modules/blockly/core/interfaces/i_component.ts","node_modules/blockly/core/interfaces/i_collapsible_toolbox_item.ts","node_modules/blockly/core/interfaces/i_bubble.ts","node_modules/blockly/core/interfaces/i_bounded_element.ts","node_modules/blockly/core/interfaces/i_block_dragger.ts","node_modules/blockly/core/interfaces/i_autohideable.ts","node_modules/blockly/core/interfaces/i_ast_node_location_with_block.ts","node_modules/blockly/core/interfaces/i_ast_node_location_svg.ts","node_modules/blockly/core/interfaces/i_ast_node_location.ts","endive-playground/src/scripts/generators/endive.js","node_modules/@parcel/transformer-js/src/esmodule-helpers.js","endive-playground/src/scripts/verify.js","crates/endive-wasm/pkg/endive_wasm.js","node_modules/@parcel/runtime-js/lib/runtime-e3f7ebee0483ebe1.js","node_modules/@parcel/runtime-js/lib/helpers/bundle-url.js","node_modules/lodash/lodash.js","node_modules/@parcel/runtime-js/lib/runtime-a04b64ca36f5b473.js","endive-playground/src/scripts/definitions.js","endive-playground/src/scripts/blocks.js"],"sourcesContent":["var HMR_HOST = null;var HMR_PORT = null;var HMR_SECURE = false;var HMR_ENV_HASH = \"d6ea1d42532a7575\";var HMR_USE_SSE = false;module.bundle.HMR_BUNDLE_ID = \"c2bb394e693b7d15\";\"use strict\";\n\n/* global HMR_HOST, HMR_PORT, HMR_ENV_HASH, HMR_SECURE, HMR_USE_SSE, chrome, browser, __parcel__import__, __parcel__importScripts__, ServiceWorkerGlobalScope */\n/*::\nimport type {\n  HMRAsset,\n  HMRMessage,\n} from '@parcel/reporter-dev-server/src/HMRServer.js';\ninterface ParcelRequire {\n  (string): mixed;\n  cache: {|[string]: ParcelModule|};\n  hotData: {|[string]: mixed|};\n  Module: any;\n  parent: ?ParcelRequire;\n  isParcelRequire: true;\n  modules: {|[string]: [Function, {|[string]: string|}]|};\n  HMR_BUNDLE_ID: string;\n  root: ParcelRequire;\n}\ninterface ParcelModule {\n  hot: {|\n    data: mixed,\n    accept(cb: (Function) => void): void,\n    dispose(cb: (mixed) => void): void,\n    // accept(deps: Array<string> | string, cb: (Function) => void): void,\n    // decline(): void,\n    _acceptCallbacks: Array<(Function) => void>,\n    _disposeCallbacks: Array<(mixed) => void>,\n  |};\n}\ninterface ExtensionContext {\n  runtime: {|\n    reload(): void,\n    getURL(url: string): string;\n    getManifest(): {manifest_version: number, ...};\n  |};\n}\ndeclare var module: {bundle: ParcelRequire, ...};\ndeclare var HMR_HOST: string;\ndeclare var HMR_PORT: string;\ndeclare var HMR_ENV_HASH: string;\ndeclare var HMR_SECURE: boolean;\ndeclare var HMR_USE_SSE: boolean;\ndeclare var chrome: ExtensionContext;\ndeclare var browser: ExtensionContext;\ndeclare var __parcel__import__: (string) => Promise<void>;\ndeclare var __parcel__importScripts__: (string) => Promise<void>;\ndeclare var globalThis: typeof self;\ndeclare var ServiceWorkerGlobalScope: Object;\n*/\nvar OVERLAY_ID = '__parcel__error__overlay__';\nvar OldModule = module.bundle.Module;\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData[moduleName],\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n  module.bundle.hotData[moduleName] = undefined;\n}\nmodule.bundle.Module = Module;\nmodule.bundle.hotData = {};\nvar checkedAssets /*: {|[string]: boolean|} */, assetsToDispose /*: Array<[ParcelRequire, string]> */, assetsToAccept /*: Array<[ParcelRequire, string]> */;\n\nfunction getHostname() {\n  return HMR_HOST || (location.protocol.indexOf('http') === 0 ? location.hostname : 'localhost');\n}\nfunction getPort() {\n  return HMR_PORT || location.port;\n}\n\n// eslint-disable-next-line no-redeclare\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = getHostname();\n  var port = getPort();\n  var protocol = HMR_SECURE || location.protocol == 'https:' && !['localhost', '127.0.0.1', '0.0.0.0'].includes(hostname) ? 'wss' : 'ws';\n  var ws;\n  if (HMR_USE_SSE) {\n    ws = new EventSource('/__parcel_hmr');\n  } else {\n    try {\n      ws = new WebSocket(protocol + '://' + hostname + (port ? ':' + port : '') + '/');\n    } catch (err) {\n      if (err.message) {\n        console.error(err.message);\n      }\n      ws = {};\n    }\n  }\n\n  // Web extension context\n  var extCtx = typeof browser === 'undefined' ? typeof chrome === 'undefined' ? null : chrome : browser;\n\n  // Safari doesn't support sourceURL in error stacks.\n  // eval may also be disabled via CSP, so do a quick check.\n  var supportsSourceURL = false;\n  try {\n    (0, eval)('throw new Error(\"test\"); //# sourceURL=test.js');\n  } catch (err) {\n    supportsSourceURL = err.stack.includes('test.js');\n  }\n\n  // $FlowFixMe\n  ws.onmessage = async function (event /*: {data: string, ...} */) {\n    checkedAssets = {} /*: {|[string]: boolean|} */;\n    assetsToAccept = [];\n    assetsToDispose = [];\n    var data /*: HMRMessage */ = JSON.parse(event.data);\n    if (data.type === 'update') {\n      // Remove error overlay if there is one\n      if (typeof document !== 'undefined') {\n        removeErrorOverlay();\n      }\n      let assets = data.assets.filter(asset => asset.envHash === HMR_ENV_HASH);\n\n      // Handle HMR Update\n      let handled = assets.every(asset => {\n        return asset.type === 'css' || asset.type === 'js' && hmrAcceptCheck(module.bundle.root, asset.id, asset.depsByBundle);\n      });\n      if (handled) {\n        console.clear();\n\n        // Dispatch custom event so other runtimes (e.g React Refresh) are aware.\n        if (typeof window !== 'undefined' && typeof CustomEvent !== 'undefined') {\n          window.dispatchEvent(new CustomEvent('parcelhmraccept'));\n        }\n        await hmrApplyUpdates(assets);\n\n        // Dispose all old assets.\n        let processedAssets = {} /*: {|[string]: boolean|} */;\n        for (let i = 0; i < assetsToDispose.length; i++) {\n          let id = assetsToDispose[i][1];\n          if (!processedAssets[id]) {\n            hmrDispose(assetsToDispose[i][0], id);\n            processedAssets[id] = true;\n          }\n        }\n\n        // Run accept callbacks. This will also re-execute other disposed assets in topological order.\n        processedAssets = {};\n        for (let i = 0; i < assetsToAccept.length; i++) {\n          let id = assetsToAccept[i][1];\n          if (!processedAssets[id]) {\n            hmrAccept(assetsToAccept[i][0], id);\n            processedAssets[id] = true;\n          }\n        }\n      } else fullReload();\n    }\n    if (data.type === 'error') {\n      // Log parcel errors to console\n      for (let ansiDiagnostic of data.diagnostics.ansi) {\n        let stack = ansiDiagnostic.codeframe ? ansiDiagnostic.codeframe : ansiDiagnostic.stack;\n        console.error('🚨 [parcel]: ' + ansiDiagnostic.message + '\\n' + stack + '\\n\\n' + ansiDiagnostic.hints.join('\\n'));\n      }\n      if (typeof document !== 'undefined') {\n        // Render the fancy html overlay\n        removeErrorOverlay();\n        var overlay = createErrorOverlay(data.diagnostics.html);\n        // $FlowFixMe\n        document.body.appendChild(overlay);\n      }\n    }\n  };\n  if (ws instanceof WebSocket) {\n    ws.onerror = function (e) {\n      if (e.message) {\n        console.error(e.message);\n      }\n    };\n    ws.onclose = function () {\n      console.warn('[parcel] 🚨 Connection to the HMR server was lost');\n    };\n  }\n}\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n    console.log('[parcel] ✨ Error resolved');\n  }\n}\nfunction createErrorOverlay(diagnostics) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n  let errorHTML = '<div style=\"background: black; opacity: 0.85; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; font-family: Menlo, Consolas, monospace; z-index: 9999;\">';\n  for (let diagnostic of diagnostics) {\n    let stack = diagnostic.frames.length ? diagnostic.frames.reduce((p, frame) => {\n      return `${p}\n<a href=\"/__parcel_launch_editor?file=${encodeURIComponent(frame.location)}\" style=\"text-decoration: underline; color: #888\" onclick=\"fetch(this.href); return false\">${frame.location}</a>\n${frame.code}`;\n    }, '') : diagnostic.stack;\n    errorHTML += `\n      <div>\n        <div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">\n          🚨 ${diagnostic.message}\n        </div>\n        <pre>${stack}</pre>\n        <div>\n          ${diagnostic.hints.map(hint => '<div>💡 ' + hint + '</div>').join('')}\n        </div>\n        ${diagnostic.documentation ? `<div>📝 <a style=\"color: violet\" href=\"${diagnostic.documentation}\" target=\"_blank\">Learn more</a></div>` : ''}\n      </div>\n    `;\n  }\n  errorHTML += '</div>';\n  overlay.innerHTML = errorHTML;\n  return overlay;\n}\nfunction fullReload() {\n  if ('reload' in location) {\n    location.reload();\n  } else if (extCtx && extCtx.runtime && extCtx.runtime.reload) {\n    extCtx.runtime.reload();\n  }\n}\nfunction getParents(bundle, id) /*: Array<[ParcelRequire, string]> */{\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n  var parents = [];\n  var k, d, dep;\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || Array.isArray(dep) && dep[dep.length - 1] === id) {\n        parents.push([bundle, k]);\n      }\n    }\n  }\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n  return parents;\n}\nfunction updateLink(link) {\n  var href = link.getAttribute('href');\n  if (!href) {\n    return;\n  }\n  var newLink = link.cloneNode();\n  newLink.onload = function () {\n    if (link.parentNode !== null) {\n      // $FlowFixMe\n      link.parentNode.removeChild(link);\n    }\n  };\n  newLink.setAttribute('href',\n  // $FlowFixMe\n  href.split('?')[0] + '?' + Date.now());\n  // $FlowFixMe\n  link.parentNode.insertBefore(newLink, link.nextSibling);\n}\nvar cssTimeout = null;\nfunction reloadCSS() {\n  if (cssTimeout) {\n    return;\n  }\n  cssTimeout = setTimeout(function () {\n    var links = document.querySelectorAll('link[rel=\"stylesheet\"]');\n    for (var i = 0; i < links.length; i++) {\n      // $FlowFixMe[incompatible-type]\n      var href /*: string */ = links[i].getAttribute('href');\n      var hostname = getHostname();\n      var servedFromHMRServer = hostname === 'localhost' ? new RegExp('^(https?:\\\\/\\\\/(0.0.0.0|127.0.0.1)|localhost):' + getPort()).test(href) : href.indexOf(hostname + ':' + getPort());\n      var absolute = /^https?:\\/\\//i.test(href) && href.indexOf(location.origin) !== 0 && !servedFromHMRServer;\n      if (!absolute) {\n        updateLink(links[i]);\n      }\n    }\n    cssTimeout = null;\n  }, 50);\n}\nfunction hmrDownload(asset) {\n  if (asset.type === 'js') {\n    if (typeof document !== 'undefined') {\n      let script = document.createElement('script');\n      script.src = asset.url + '?t=' + Date.now();\n      if (asset.outputFormat === 'esmodule') {\n        script.type = 'module';\n      }\n      return new Promise((resolve, reject) => {\n        var _document$head;\n        script.onload = () => resolve(script);\n        script.onerror = reject;\n        (_document$head = document.head) === null || _document$head === void 0 || _document$head.appendChild(script);\n      });\n    } else if (typeof importScripts === 'function') {\n      // Worker scripts\n      if (asset.outputFormat === 'esmodule') {\n        return __parcel__import__(asset.url + '?t=' + Date.now());\n      } else {\n        return new Promise((resolve, reject) => {\n          try {\n            __parcel__importScripts__(asset.url + '?t=' + Date.now());\n            resolve();\n          } catch (err) {\n            reject(err);\n          }\n        });\n      }\n    }\n  }\n}\nasync function hmrApplyUpdates(assets) {\n  global.parcelHotUpdate = Object.create(null);\n  let scriptsToRemove;\n  try {\n    // If sourceURL comments aren't supported in eval, we need to load\n    // the update from the dev server over HTTP so that stack traces\n    // are correct in errors/logs. This is much slower than eval, so\n    // we only do it if needed (currently just Safari).\n    // https://bugs.webkit.org/show_bug.cgi?id=137297\n    // This path is also taken if a CSP disallows eval.\n    if (!supportsSourceURL) {\n      let promises = assets.map(asset => {\n        var _hmrDownload;\n        return (_hmrDownload = hmrDownload(asset)) === null || _hmrDownload === void 0 ? void 0 : _hmrDownload.catch(err => {\n          // Web extension fix\n          if (extCtx && extCtx.runtime && extCtx.runtime.getManifest().manifest_version == 3 && typeof ServiceWorkerGlobalScope != 'undefined' && global instanceof ServiceWorkerGlobalScope) {\n            extCtx.runtime.reload();\n            return;\n          }\n          throw err;\n        });\n      });\n      scriptsToRemove = await Promise.all(promises);\n    }\n    assets.forEach(function (asset) {\n      hmrApply(module.bundle.root, asset);\n    });\n  } finally {\n    delete global.parcelHotUpdate;\n    if (scriptsToRemove) {\n      scriptsToRemove.forEach(script => {\n        if (script) {\n          var _document$head2;\n          (_document$head2 = document.head) === null || _document$head2 === void 0 || _document$head2.removeChild(script);\n        }\n      });\n    }\n  }\n}\nfunction hmrApply(bundle /*: ParcelRequire */, asset /*:  HMRAsset */) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n  if (asset.type === 'css') {\n    reloadCSS();\n  } else if (asset.type === 'js') {\n    let deps = asset.depsByBundle[bundle.HMR_BUNDLE_ID];\n    if (deps) {\n      if (modules[asset.id]) {\n        // Remove dependencies that are removed and will become orphaned.\n        // This is necessary so that if the asset is added back again, the cache is gone, and we prevent a full page reload.\n        let oldDeps = modules[asset.id][1];\n        for (let dep in oldDeps) {\n          if (!deps[dep] || deps[dep] !== oldDeps[dep]) {\n            let id = oldDeps[dep];\n            let parents = getParents(module.bundle.root, id);\n            if (parents.length === 1) {\n              hmrDelete(module.bundle.root, id);\n            }\n          }\n        }\n      }\n      if (supportsSourceURL) {\n        // Global eval. We would use `new Function` here but browser\n        // support for source maps is better with eval.\n        (0, eval)(asset.output);\n      }\n\n      // $FlowFixMe\n      let fn = global.parcelHotUpdate[asset.id];\n      modules[asset.id] = [fn, deps];\n    } else if (bundle.parent) {\n      hmrApply(bundle.parent, asset);\n    }\n  }\n}\nfunction hmrDelete(bundle, id) {\n  let modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n  if (modules[id]) {\n    // Collect dependencies that will become orphaned when this module is deleted.\n    let deps = modules[id][1];\n    let orphans = [];\n    for (let dep in deps) {\n      let parents = getParents(module.bundle.root, deps[dep]);\n      if (parents.length === 1) {\n        orphans.push(deps[dep]);\n      }\n    }\n\n    // Delete the module. This must be done before deleting dependencies in case of circular dependencies.\n    delete modules[id];\n    delete bundle.cache[id];\n\n    // Now delete the orphans.\n    orphans.forEach(id => {\n      hmrDelete(module.bundle.root, id);\n    });\n  } else if (bundle.parent) {\n    hmrDelete(bundle.parent, id);\n  }\n}\nfunction hmrAcceptCheck(bundle /*: ParcelRequire */, id /*: string */, depsByBundle /*: ?{ [string]: { [string]: string } }*/) {\n  if (hmrAcceptCheckOne(bundle, id, depsByBundle)) {\n    return true;\n  }\n\n  // Traverse parents breadth first. All possible ancestries must accept the HMR update, or we'll reload.\n  let parents = getParents(module.bundle.root, id);\n  let accepted = false;\n  while (parents.length > 0) {\n    let v = parents.shift();\n    let a = hmrAcceptCheckOne(v[0], v[1], null);\n    if (a) {\n      // If this parent accepts, stop traversing upward, but still consider siblings.\n      accepted = true;\n    } else {\n      // Otherwise, queue the parents in the next level upward.\n      let p = getParents(module.bundle.root, v[1]);\n      if (p.length === 0) {\n        // If there are no parents, then we've reached an entry without accepting. Reload.\n        accepted = false;\n        break;\n      }\n      parents.push(...p);\n    }\n  }\n  return accepted;\n}\nfunction hmrAcceptCheckOne(bundle /*: ParcelRequire */, id /*: string */, depsByBundle /*: ?{ [string]: { [string]: string } }*/) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n  if (depsByBundle && !depsByBundle[bundle.HMR_BUNDLE_ID]) {\n    // If we reached the root bundle without finding where the asset should go,\n    // there's nothing to do. Mark as \"accepted\" so we don't reload the page.\n    if (!bundle.parent) {\n      return true;\n    }\n    return hmrAcceptCheck(bundle.parent, id, depsByBundle);\n  }\n  if (checkedAssets[id]) {\n    return true;\n  }\n  checkedAssets[id] = true;\n  var cached = bundle.cache[id];\n  assetsToDispose.push([bundle, id]);\n  if (!cached || cached.hot && cached.hot._acceptCallbacks.length) {\n    assetsToAccept.push([bundle, id]);\n    return true;\n  }\n}\nfunction hmrDispose(bundle /*: ParcelRequire */, id /*: string */) {\n  var cached = bundle.cache[id];\n  bundle.hotData[id] = {};\n  if (cached && cached.hot) {\n    cached.hot.data = bundle.hotData[id];\n  }\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData[id]);\n    });\n  }\n  delete bundle.cache[id];\n}\nfunction hmrAccept(bundle /*: ParcelRequire */, id /*: string */) {\n  // Execute the module.\n  bundle(id);\n\n  // Run the accept callbacks in the new version of the module.\n  var cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      var assetsToAlsoAccept = cb(function () {\n        return getParents(module.bundle.root, id);\n      });\n      if (assetsToAlsoAccept && assetsToAccept.length) {\n        assetsToAlsoAccept.forEach(function (a) {\n          hmrDispose(a[0], a[1]);\n        });\n\n        // $FlowFixMe[method-unbinding]\n        assetsToAccept.push.apply(assetsToAccept, assetsToAlsoAccept);\n      }\n    });\n  }\n}","import * as Blockly from \"blockly/core\";\n\nimport { endiveGenerator } from \"./generators/endive.js\";\nimport { verifyTheorems } from \"./verify.js\";\n\nimport \"./blocks.js\";\n\nconst updateCodeEvents = new Set([\n  Blockly.Events.BLOCK_CHANGE,\n  Blockly.Events.BLOCK_CREATE,\n  Blockly.Events.BLOCK_DELETE,\n  Blockly.Events.BLOCK_MOVE,\n]);\n\nfunction updateCode(event) {\n  if (workspace.isDragging()) return;\n  if (!updateCodeEvents.has(event.type)) return;\n\n  const endiveCode = endiveGenerator.workspaceToCode(workspace);\n  document.getElementById(\"endivecodearea\").value = endiveCode;\n  // document.getElementById('latexcodearea').value = latexCode;\n}\n\nconst verifyProofs = function (button) {\n  console.log(verifyTheorems(workspace));\n};\n\nlet toolbox = {\n  kind: \"categoryToolbox\",\n  contents: [\n    {\n      kind: \"category\",\n      name: \"Théorèmes\",\n      contents: [\n        {\n          kind: \"block\",\n          type: \"theorem\",\n        },\n        {\n          kind: \"block\",\n          type: \"lemma\",\n        },\n      ],\n    },\n    {\n      kind: \"category\",\n      name: \"Formules\",\n      contents: [\n        {\n          kind: \"block\",\n          type: \"proposition_forall\",\n        },\n        {\n          kind: \"block\",\n          type: \"proposition_exists\",\n        },\n        {\n          kind: \"block\",\n          type: \"proposition_or\",\n        },\n        {\n          kind: \"block\",\n          type: \"proposition_and\",\n        },\n        {\n          kind: \"block\",\n          type: \"proposition_implies\",\n        },\n        {\n          kind: \"block\",\n          type: \"proposition_reference\",\n        },\n      ],\n    },\n    {\n      kind: \"category\",\n      name: \"Preuve\",\n      contents: [\n        {\n          kind: \"block\",\n          type: \"tactic_let\",\n        },\n        {\n          kind: \"block\",\n          type: \"tactic_suppose\",\n        },\n        {\n          kind: \"block\",\n          type: \"tactic_then\",\n        },\n        {\n          kind: \"button\",\n          text: \"Vérifier\",\n          callbackKey: \"verifyProofs\",\n        },\n      ],\n    },\n  ],\n};\n\nlet workspace = Blockly.inject(\"blocklyDiv\", {\n  toolbox: toolbox,\n  scrollbars: false,\n  horizontalLayout: false,\n  toolboxPosition: \"start\",\n});\n\nworkspace.clear();\nworkspace.userDefinedTypes = [[\"Prop\"]];\nworkspace.addChangeListener(updateCode);\nworkspace.registerButtonCallback(\"verifyProofs\", verifyProofs);\n\nlet defaultVariableNames = [\"x\", \"y\", \"z\", \"P\", \"Q\"];\ndefaultVariableNames.forEach(function (variableName) {\n  workspace.createVariable(variableName);\n});\n\nendiveGenerator.init(workspace);\n","/* eslint-disable */\n;(function(root, factory) {\n  if (typeof define === 'function' && define.amd) { // AMD\n    define(['./blockly'], factory);\n  } else if (typeof exports === 'object') { // Node.js\n    module.exports = factory(require('./blockly'));\n  } else { // Browser\n    root.Blockly = factory(root.Blockly);\n  }\n}(this, function(Blockly) {\n/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @fileoverview Blockly core module for the browser. It includes blockly.js\n *               and adds a helper method for setting the locale.\n */\n\n/* eslint-disable */\n'use strict';\n\nreturn Blockly;\n}));\n","/* eslint-disable */\n;(function(root, factory) {\n  if (typeof define === 'function' && define.amd) { // AMD\n    define(['./blockly_compressed'], factory);\n  } else if (typeof exports === 'object') { // Node.js\n    module.exports = factory(require('./blockly_compressed'));\n  } else { // Browser\n    root.Blockly = factory(root.Blockly);\n  }\n}(this, function(Blockly) {\n/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @fileoverview Blockly module; just a wrapper for blockly_compressed.js.\n */\n\nreturn Blockly;\n}));\n",null,"/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.registry\n\nimport type {Abstract} from './events/events_abstract.js';\nimport type {Field} from './field.js';\nimport type {IBlockDragger} from './interfaces/i_block_dragger.js';\nimport type {IConnectionChecker} from './interfaces/i_connection_checker.js';\nimport type {IFlyout} from './interfaces/i_flyout.js';\nimport type {IMetricsManager} from './interfaces/i_metrics_manager.js';\nimport type {IIcon} from './interfaces/i_icon.js';\nimport type {Input} from './inputs/input.js';\nimport type {ISerializer} from './interfaces/i_serializer.js';\nimport type {IToolbox} from './interfaces/i_toolbox.js';\nimport type {Cursor} from './keyboard_nav/cursor.js';\nimport type {Options} from './options.js';\nimport type {Renderer} from './renderers/common/renderer.js';\nimport type {Theme} from './theme.js';\nimport type {ToolboxItem} from './toolbox/toolbox_item.js';\nimport type {IPaster} from './interfaces/i_paster.js';\nimport type {ICopyData, ICopyable} from './interfaces/i_copyable.js';\nimport type {IConnectionPreviewer} from './interfaces/i_connection_previewer.js';\n\n/**\n * A map of maps. With the keys being the type and name of the class we are\n * registering and the value being the constructor function.\n * e.g. {'field': {'field_angle': Blockly.FieldAngle}}\n */\nconst typeMap: {\n  [key: string]: {\n    [key: string]: (new () => AnyDuringMigration) | AnyDuringMigration;\n  };\n} = Object.create(null);\nexport const TEST_ONLY = {typeMap};\n\n/**\n * A map of maps. With the keys being the type and caseless name of the class we\n * are registring, and the value being the most recent cased name for that\n * registration.\n */\nconst nameMap: {[key: string]: {[key: string]: string}} = Object.create(null);\n\n/**\n * The string used to register the default class for a type of plugin.\n */\nexport const DEFAULT = 'default';\n\n/**\n * A name with the type of the element stored in the generic.\n */\nexport class Type<_T> {\n  /** @param name The name of the registry type. */\n  constructor(private readonly name: string) {}\n\n  /**\n   * Returns the name of the type.\n   *\n   * @returns The name.\n   */\n  toString(): string {\n    return this.name;\n  }\n\n  static CONNECTION_CHECKER = new Type<IConnectionChecker>('connectionChecker');\n\n  static CONNECTION_PREVIEWER = new Type<IConnectionPreviewer>(\n    'connectionPreviewer',\n  );\n\n  static CURSOR = new Type<Cursor>('cursor');\n\n  static EVENT = new Type<Abstract>('event');\n\n  static FIELD = new Type<Field>('field');\n\n  static INPUT = new Type<Input>('input');\n\n  static RENDERER = new Type<Renderer>('renderer');\n\n  static TOOLBOX = new Type<IToolbox>('toolbox');\n\n  static THEME = new Type<Theme>('theme');\n\n  static TOOLBOX_ITEM = new Type<ToolboxItem>('toolboxItem');\n\n  static FLYOUTS_VERTICAL_TOOLBOX = new Type<IFlyout>('flyoutsVerticalToolbox');\n\n  static FLYOUTS_HORIZONTAL_TOOLBOX = new Type<IFlyout>(\n    'flyoutsHorizontalToolbox',\n  );\n\n  static METRICS_MANAGER = new Type<IMetricsManager>('metricsManager');\n\n  static BLOCK_DRAGGER = new Type<IBlockDragger>('blockDragger');\n\n  /** @internal */\n  static SERIALIZER = new Type<ISerializer>('serializer');\n\n  /** @internal */\n  static ICON = new Type<IIcon>('icon');\n\n  /** @internal */\n  static PASTER = new Type<IPaster<ICopyData, ICopyable<ICopyData>>>('paster');\n}\n\n/**\n * Registers a class based on a type and name.\n *\n * @param type The type of the plugin.\n *     (e.g. Field, Renderer)\n * @param name The plugin's name. (Ex. field_angle, geras)\n * @param registryItem The class or object to register.\n * @param opt_allowOverrides True to prevent an error when overriding an already\n *     registered item.\n * @throws {Error} if the type or name is empty, a name with the given type has\n *     already been registered, or if the given class or object is not valid for\n *     its type.\n */\nexport function register<T>(\n  type: string | Type<T>,\n  name: string,\n  registryItem:\n    | (new (...p1: AnyDuringMigration[]) => T)\n    | null\n    | AnyDuringMigration,\n  opt_allowOverrides?: boolean,\n): void {\n  if (\n    (!(type instanceof Type) && typeof type !== 'string') ||\n    `${type}`.trim() === ''\n  ) {\n    throw Error(\n      'Invalid type \"' +\n        type +\n        '\". The type must be a' +\n        ' non-empty string or a Blockly.registry.Type.',\n    );\n  }\n  type = `${type}`.toLowerCase();\n\n  if (typeof name !== 'string' || name.trim() === '') {\n    throw Error(\n      'Invalid name \"' + name + '\". The name must be a' + ' non-empty string.',\n    );\n  }\n  const caselessName = name.toLowerCase();\n  if (!registryItem) {\n    throw Error('Can not register a null value');\n  }\n  let typeRegistry = typeMap[type];\n  let nameRegistry = nameMap[type];\n  // If the type registry has not been created, create it.\n  if (!typeRegistry) {\n    typeRegistry = typeMap[type] = Object.create(null);\n    nameRegistry = nameMap[type] = Object.create(null);\n  }\n\n  // Validate that the given class has all the required properties.\n  validate(type, registryItem);\n\n  // Don't throw an error if opt_allowOverrides is true.\n  if (!opt_allowOverrides && typeRegistry[caselessName]) {\n    throw Error(\n      'Name \"' +\n        caselessName +\n        '\" with type \"' +\n        type +\n        '\" already registered.',\n    );\n  }\n  typeRegistry[caselessName] = registryItem;\n  nameRegistry[caselessName] = name;\n}\n\n/**\n * Checks the given registry item for properties that are required based on the\n * type.\n *\n * @param type The type of the plugin. (e.g. Field, Renderer)\n * @param registryItem A class or object that we are checking for the required\n *     properties.\n */\nfunction validate(type: string, registryItem: Function | AnyDuringMigration) {\n  switch (type) {\n    case String(Type.FIELD):\n      if (typeof registryItem.fromJson !== 'function') {\n        throw Error('Type \"' + type + '\" must have a fromJson function');\n      }\n      break;\n  }\n}\n\n/**\n * Unregisters the registry item with the given type and name.\n *\n * @param type The type of the plugin.\n *     (e.g. Field, Renderer)\n * @param name The plugin's name. (Ex. field_angle, geras)\n */\nexport function unregister<T>(type: string | Type<T>, name: string) {\n  type = `${type}`.toLowerCase();\n  name = name.toLowerCase();\n  const typeRegistry = typeMap[type];\n  if (!typeRegistry || !typeRegistry[name]) {\n    console.warn(\n      'Unable to unregister [' +\n        name +\n        '][' +\n        type +\n        '] from the ' +\n        'registry.',\n    );\n    return;\n  }\n  delete typeMap[type][name];\n  delete nameMap[type][name];\n}\n\n/**\n * Gets the registry item for the given name and type. This can be either a\n * class or an object.\n *\n * @param type The type of the plugin.\n *     (e.g. Field, Renderer)\n * @param name The plugin's name. (Ex. field_angle, geras)\n * @param opt_throwIfMissing Whether or not to throw an error if we are unable\n *     to find the plugin.\n * @returns The class or object with the given name and type or null if none\n *     exists.\n */\nfunction getItem<T>(\n  type: string | Type<T>,\n  name: string,\n  opt_throwIfMissing?: boolean,\n): (new (...p1: AnyDuringMigration[]) => T) | null | AnyDuringMigration {\n  type = `${type}`.toLowerCase();\n  name = name.toLowerCase();\n  const typeRegistry = typeMap[type];\n  if (!typeRegistry || !typeRegistry[name]) {\n    const msg = 'Unable to find [' + name + '][' + type + '] in the registry.';\n    if (opt_throwIfMissing) {\n      throw new Error(\n        msg + ' You must require or register a ' + type + ' plugin.',\n      );\n    } else {\n      console.warn(msg);\n    }\n    return null;\n  }\n  return typeRegistry[name];\n}\n\n/**\n * Returns whether or not the registry contains an item with the given type and\n * name.\n *\n * @param type The type of the plugin.\n *     (e.g. Field, Renderer)\n * @param name The plugin's name. (Ex. field_angle, geras)\n * @returns True if the registry has an item with the given type and name, false\n *     otherwise.\n */\nexport function hasItem<T>(type: string | Type<T>, name: string): boolean {\n  type = `${type}`.toLowerCase();\n  name = name.toLowerCase();\n  const typeRegistry = typeMap[type];\n  if (!typeRegistry) {\n    return false;\n  }\n  return !!typeRegistry[name];\n}\n\n/**\n * Gets the class for the given name and type.\n *\n * @param type The type of the plugin.\n *     (e.g. Field, Renderer)\n * @param name The plugin's name. (Ex. field_angle, geras)\n * @param opt_throwIfMissing Whether or not to throw an error if we are unable\n *     to find the plugin.\n * @returns The class with the given name and type or null if none exists.\n */\nexport function getClass<T>(\n  type: string | Type<T>,\n  name: string,\n  opt_throwIfMissing?: boolean,\n): (new (...p1: AnyDuringMigration[]) => T) | null {\n  return getItem(type, name, opt_throwIfMissing) as\n    | (new (...p1: AnyDuringMigration[]) => T)\n    | null;\n}\n\n/**\n * Gets the object for the given name and type.\n *\n * @param type The type of the plugin.\n *     (e.g. Category)\n * @param name The plugin's name. (Ex. logic_category)\n * @param opt_throwIfMissing Whether or not to throw an error if we are unable\n *     to find the object.\n * @returns The object with the given name and type or null if none exists.\n */\nexport function getObject<T>(\n  type: string | Type<T>,\n  name: string,\n  opt_throwIfMissing?: boolean,\n): T | null {\n  return getItem(type, name, opt_throwIfMissing) as T;\n}\n\n/**\n * Returns a map of items registered with the given type.\n *\n * @param type The type of the plugin. (e.g. Category)\n * @param opt_cased Whether or not to return a map with cased keys (rather than\n *     caseless keys). False by default.\n * @param opt_throwIfMissing Whether or not to throw an error if we are unable\n *     to find the object. False by default.\n * @returns A map of objects with the given type, or null if none exists.\n */\nexport function getAllItems<T>(\n  type: string | Type<T>,\n  opt_cased?: boolean,\n  opt_throwIfMissing?: boolean,\n): {[key: string]: T | null | (new (...p1: AnyDuringMigration[]) => T)} | null {\n  type = `${type}`.toLowerCase();\n  const typeRegistry = typeMap[type];\n  if (!typeRegistry) {\n    const msg = `Unable to find [${type}] in the registry.`;\n    if (opt_throwIfMissing) {\n      throw new Error(`${msg} You must require or register a ${type} plugin.`);\n    } else {\n      console.warn(msg);\n    }\n    return null;\n  }\n  if (!opt_cased) {\n    return typeRegistry;\n  }\n  const nameRegistry = nameMap[type];\n  const casedRegistry = Object.create(null);\n  for (const key of Object.keys(typeRegistry)) {\n    casedRegistry[nameRegistry[key]] = typeRegistry[key];\n  }\n  return casedRegistry;\n}\n\n/**\n * Gets the class from Blockly options for the given type.\n * This is used for plugins that override a built in feature. (e.g. Toolbox)\n *\n * @param type The type of the plugin.\n * @param options The option object to check for the given plugin.\n * @param opt_throwIfMissing Whether or not to throw an error if we are unable\n *     to find the plugin.\n * @returns The class for the plugin.\n */\nexport function getClassFromOptions<T>(\n  type: Type<T>,\n  options: Options,\n  opt_throwIfMissing?: boolean,\n): (new (...p1: AnyDuringMigration[]) => T) | null {\n  const plugin = options.plugins[String(type)] || DEFAULT;\n\n  // If the user passed in a plugin class instead of a registered plugin name.\n  if (typeof plugin === 'function') {\n    return plugin;\n  }\n  return getClass(type, plugin, opt_throwIfMissing);\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.common\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {Block} from './block.js';\nimport {ISelectable} from './blockly.js';\nimport {BlockDefinition, Blocks} from './blocks.js';\nimport type {Connection} from './connection.js';\nimport type {Workspace} from './workspace.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/** Database of all workspaces. */\nconst WorkspaceDB_ = Object.create(null);\n\n/**\n * Find the workspace with the specified ID.\n *\n * @param id ID of workspace to find.\n * @returns The sought after workspace or null if not found.\n */\nexport function getWorkspaceById(id: string): Workspace | null {\n  return WorkspaceDB_[id] || null;\n}\n\n/**\n * Find all workspaces.\n *\n * @returns Array of workspaces.\n */\nexport function getAllWorkspaces(): Workspace[] {\n  const workspaces = [];\n  for (const workspaceId in WorkspaceDB_) {\n    workspaces.push(WorkspaceDB_[workspaceId]);\n  }\n  return workspaces;\n}\n\n/**\n * Register a workspace in the workspace db.\n *\n * @param workspace\n */\nexport function registerWorkspace(workspace: Workspace) {\n  WorkspaceDB_[workspace.id] = workspace;\n}\n\n/**\n * Unregister a workspace from the workspace db.\n *\n * @param workspace\n */\nexport function unregisterWorkpace(workspace: Workspace) {\n  delete WorkspaceDB_[workspace.id];\n}\n\n/**\n * The main workspace most recently used.\n * Set by Blockly.WorkspaceSvg.prototype.markFocused\n */\nlet mainWorkspace: Workspace;\n\n/**\n * Returns the last used top level workspace (based on focus).  Try not to use\n * this function, particularly if there are multiple Blockly instances on a\n * page.\n *\n * @returns The main workspace.\n */\nexport function getMainWorkspace(): Workspace {\n  return mainWorkspace;\n}\n\n/**\n * Sets last used main workspace.\n *\n * @param workspace The most recently used top level workspace.\n */\nexport function setMainWorkspace(workspace: Workspace) {\n  mainWorkspace = workspace;\n}\n\n/**\n * Currently selected copyable object.\n */\nlet selected: ISelectable | null = null;\n\n/**\n * Returns the currently selected copyable object.\n */\nexport function getSelected(): ISelectable | null {\n  return selected;\n}\n\n/**\n * Sets the currently selected block. This function does not visually mark the\n * block as selected or fire the required events. If you wish to\n * programmatically select a block, use `BlockSvg#select`.\n *\n * @param newSelection The newly selected block.\n * @internal\n */\nexport function setSelected(newSelection: ISelectable | null) {\n  selected = newSelection;\n}\n\n/**\n * Container element in which to render the WidgetDiv, DropDownDiv and Tooltip.\n */\nlet parentContainer: Element | null;\n\n/**\n * Get the container element in which to render the WidgetDiv, DropDownDiv and\n * Tooltip.\n *\n * @returns The parent container.\n */\nexport function getParentContainer(): Element | null {\n  return parentContainer;\n}\n\n/**\n * Set the parent container.  This is the container element that the WidgetDiv,\n * DropDownDiv, and Tooltip are rendered into the first time `Blockly.inject`\n * is called.\n * This method is a NOP if called after the first `Blockly.inject`.\n *\n * @param newParent The container element.\n */\nexport function setParentContainer(newParent: Element) {\n  parentContainer = newParent;\n}\n\n/**\n * Size the SVG image to completely fill its container. Call this when the view\n * actually changes sizes (e.g. on a window resize/device orientation change).\n * See workspace.resizeContents to resize the workspace when the contents\n * change (e.g. when a block is added or removed).\n * Record the height/width of the SVG image.\n *\n * @param workspace Any workspace in the SVG.\n */\nexport function svgResize(workspace: WorkspaceSvg) {\n  let mainWorkspace = workspace;\n  while (mainWorkspace.options.parentWorkspace) {\n    mainWorkspace = mainWorkspace.options.parentWorkspace;\n  }\n  const svg = mainWorkspace.getParentSvg();\n  const cachedSize = mainWorkspace.getCachedParentSvgSize();\n  const div = svg.parentElement;\n  if (!(div instanceof HTMLElement)) {\n    // Workspace deleted, or something.\n    return;\n  }\n\n  const width = div.offsetWidth;\n  const height = div.offsetHeight;\n  if (cachedSize.width !== width) {\n    svg.setAttribute('width', width + 'px');\n    mainWorkspace.setCachedParentSvgSize(width, null);\n  }\n  if (cachedSize.height !== height) {\n    svg.setAttribute('height', height + 'px');\n    mainWorkspace.setCachedParentSvgSize(null, height);\n  }\n  mainWorkspace.resize();\n}\n\n/**\n * All of the connections on blocks that are currently being dragged.\n */\nexport const draggingConnections: Connection[] = [];\n\n/**\n * Get a map of all the block's descendants mapping their type to the number of\n *    children with that type.\n *\n * @param block The block to map.\n * @param opt_stripFollowing Optionally ignore all following\n *    statements (blocks that are not inside a value or statement input\n *    of the block).\n * @returns Map of types to type counts for descendants of the bock.\n */\nexport function getBlockTypeCounts(\n  block: Block,\n  opt_stripFollowing?: boolean,\n): {[key: string]: number} {\n  const typeCountsMap = Object.create(null);\n  const descendants = block.getDescendants(true);\n  if (opt_stripFollowing) {\n    const nextBlock = block.getNextBlock();\n    if (nextBlock) {\n      const index = descendants.indexOf(nextBlock);\n      descendants.splice(index, descendants.length - index);\n    }\n  }\n  for (let i = 0, checkBlock; (checkBlock = descendants[i]); i++) {\n    if (typeCountsMap[checkBlock.type]) {\n      typeCountsMap[checkBlock.type]++;\n    } else {\n      typeCountsMap[checkBlock.type] = 1;\n    }\n  }\n  return typeCountsMap;\n}\n\n/**\n * Helper function for defining a block from JSON.  The resulting function has\n * the correct value of jsonDef at the point in code where jsonInit is called.\n *\n * @param jsonDef The JSON definition of a block.\n * @returns A function that calls jsonInit with the correct value\n *     of jsonDef.\n */\nfunction jsonInitFactory(jsonDef: AnyDuringMigration): () => void {\n  return function (this: Block) {\n    this.jsonInit(jsonDef);\n  };\n}\n\n/**\n * Define blocks from an array of JSON block definitions, as might be generated\n * by the Blockly Developer Tools.\n *\n * @param jsonArray An array of JSON block definitions.\n */\nexport function defineBlocksWithJsonArray(jsonArray: AnyDuringMigration[]) {\n  TEST_ONLY.defineBlocksWithJsonArrayInternal(jsonArray);\n}\n\n/**\n * Private version of defineBlocksWithJsonArray for stubbing in tests.\n */\nfunction defineBlocksWithJsonArrayInternal(jsonArray: AnyDuringMigration[]) {\n  defineBlocks(createBlockDefinitionsFromJsonArray(jsonArray));\n}\n\n/**\n * Define blocks from an array of JSON block definitions, as might be generated\n * by the Blockly Developer Tools.\n *\n * @param jsonArray An array of JSON block definitions.\n * @returns A map of the block\n *     definitions created.\n */\nexport function createBlockDefinitionsFromJsonArray(\n  jsonArray: AnyDuringMigration[],\n): {[key: string]: BlockDefinition} {\n  const blocks: {[key: string]: BlockDefinition} = {};\n  for (let i = 0; i < jsonArray.length; i++) {\n    const elem = jsonArray[i];\n    if (!elem) {\n      console.warn(`Block definition #${i} in JSON array is ${elem}. Skipping`);\n      continue;\n    }\n    const type = elem['type'];\n    if (!type) {\n      console.warn(\n        `Block definition #${i} in JSON array is missing a type attribute. ` +\n          'Skipping.',\n      );\n      continue;\n    }\n    blocks[type] = {init: jsonInitFactory(elem)};\n  }\n  return blocks;\n}\n\n/**\n * Add the specified block definitions to the block definitions\n * dictionary (Blockly.Blocks).\n *\n * @param blocks A map of block\n *     type names to block definitions.\n */\nexport function defineBlocks(blocks: {[key: string]: BlockDefinition}) {\n  // Iterate over own enumerable properties.\n  for (const type of Object.keys(blocks)) {\n    const definition = blocks[type];\n    if (type in Blocks) {\n      console.warn(`Block definiton \"${type}\" overwrites previous definition.`);\n    }\n    Blocks[type] = definition;\n  }\n}\n\nexport const TEST_ONLY = {defineBlocksWithJsonArrayInternal};\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.utils.idGenerator\n\n/**\n * Legal characters for the universally unique IDs.  Should be all on\n * a US keyboard.  No characters that conflict with XML or JSON.\n * Requests to remove additional 'problematic' characters from this\n * soup will be denied.  That's your failure to properly escape in\n * your own environment.  Issues #251, #625, #682, #1304.\n */\nconst soup =\n  '!#$%()*+,-./:;=?@[]^_`{|}~' +\n  'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n\n/**\n * Namespace object for internal implementations we want to be able to\n * stub in tests. Do not use externally.\n *\n * @internal\n */\nconst internal = {\n  /**\n   * Generate a random unique ID.  This should be globally unique.\n   * 87 characters ^ 20 length is greater than 128 bits (better than a UUID).\n   *\n   * @returns A globally unique ID string.\n   */\n  genUid: () => {\n    const length = 20;\n    const soupLength = soup.length;\n    const id = [];\n    for (let i = 0; i < length; i++) {\n      id[i] = soup.charAt(Math.random() * soupLength);\n    }\n    return id.join('');\n  },\n};\nexport const TEST_ONLY = internal;\n\n/** Next unique ID to use. */\nlet nextId = 0;\n\n/**\n * Generate the next unique element IDs.\n * IDs are compatible with the HTML4 'id' attribute restrictions:\n * Use only ASCII letters, digits, '_', '-' and '.'\n *\n * For UUIDs use genUid (below) instead; this ID generator should\n * primarily be used for IDs that end up in the DOM.\n *\n * @returns The next unique identifier.\n */\nexport function getNextUniqueId(): string {\n  return 'blockly-' + (nextId++).toString(36);\n}\n\n/**\n * Generate a random unique ID.\n *\n * @see internal.genUid\n * @returns A globally unique ID string.\n */\nexport function genUid(): string {\n  return internal.genUid();\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.Events.utils\n\nimport type {Block} from '../block.js';\nimport * as common from '../common.js';\nimport * as registry from '../registry.js';\nimport * as idGenerator from '../utils/idgenerator.js';\nimport type {Workspace} from '../workspace.js';\nimport type {WorkspaceSvg} from '../workspace_svg.js';\n\nimport type {Abstract} from './events_abstract.js';\nimport type {BlockChange} from './events_block_change.js';\nimport type {BlockCreate} from './events_block_create.js';\nimport type {BlockMove} from './events_block_move.js';\nimport type {CommentCreate} from './events_comment_create.js';\nimport type {CommentMove} from './events_comment_move.js';\nimport type {ViewportChange} from './events_viewport.js';\n\n/** Group ID for new events.  Grouped events are indivisible. */\nlet group = '';\n\n/** Sets whether the next event should be added to the undo stack. */\nlet recordUndo = true;\n\n/**\n * Sets whether events should be added to the undo stack.\n *\n * @param newValue True if events should be added to the undo stack.\n */\nexport function setRecordUndo(newValue: boolean) {\n  recordUndo = newValue;\n}\n\n/**\n * Returns whether or not events will be added to the undo stack.\n *\n * @returns True if events will be added to the undo stack.\n */\nexport function getRecordUndo(): boolean {\n  return recordUndo;\n}\n\n/** Allow change events to be created and fired. */\nlet disabled = 0;\n\n/**\n * Name of event that creates a block. Will be deprecated for BLOCK_CREATE.\n */\nexport const CREATE = 'create';\n\n/**\n * Name of event that creates a block.\n */\nexport const BLOCK_CREATE = CREATE;\n\n/**\n * Name of event that deletes a block. Will be deprecated for BLOCK_DELETE.\n */\nexport const DELETE = 'delete';\n\n/**\n * Name of event that deletes a block.\n */\nexport const BLOCK_DELETE = DELETE;\n\n/**\n * Name of event that changes a block. Will be deprecated for BLOCK_CHANGE.\n */\nexport const CHANGE = 'change';\n\n/**\n * Name of event that changes a block.\n */\nexport const BLOCK_CHANGE = CHANGE;\n\n/**\n * Name of event representing an in-progress change to a field of a block, which\n * is expected to be followed by a block change event.\n */\nexport const BLOCK_FIELD_INTERMEDIATE_CHANGE =\n  'block_field_intermediate_change';\n\n/**\n * Name of event that moves a block. Will be deprecated for BLOCK_MOVE.\n */\nexport const MOVE = 'move';\n\n/**\n * Name of event that moves a block.\n */\nexport const BLOCK_MOVE = MOVE;\n\n/**\n * Name of event that creates a variable.\n */\nexport const VAR_CREATE = 'var_create';\n\n/**\n * Name of event that deletes a variable.\n */\nexport const VAR_DELETE = 'var_delete';\n\n/**\n * Name of event that renames a variable.\n */\nexport const VAR_RENAME = 'var_rename';\n\n/**\n * Name of generic event that records a UI change.\n */\nexport const UI = 'ui';\n\n/**\n * Name of event that record a block drags a block.\n */\nexport const BLOCK_DRAG = 'drag';\n\n/**\n * Name of event that records a change in selected element.\n */\nexport const SELECTED = 'selected';\n\n/**\n * Name of event that records a click.\n */\nexport const CLICK = 'click';\n\n/**\n * Name of event that records a marker move.\n */\nexport const MARKER_MOVE = 'marker_move';\n\n/**\n * Name of event that records a bubble open.\n */\nexport const BUBBLE_OPEN = 'bubble_open';\n\n/**\n * Name of event that records a trashcan open.\n */\nexport const TRASHCAN_OPEN = 'trashcan_open';\n\n/**\n * Name of event that records a toolbox item select.\n */\nexport const TOOLBOX_ITEM_SELECT = 'toolbox_item_select';\n\n/**\n * Name of event that records a theme change.\n */\nexport const THEME_CHANGE = 'theme_change';\n\n/**\n * Name of event that records a viewport change.\n */\nexport const VIEWPORT_CHANGE = 'viewport_change';\n\n/**\n * Name of event that creates a comment.\n */\nexport const COMMENT_CREATE = 'comment_create';\n\n/**\n * Name of event that deletes a comment.\n */\nexport const COMMENT_DELETE = 'comment_delete';\n\n/**\n * Name of event that changes a comment.\n */\nexport const COMMENT_CHANGE = 'comment_change';\n\n/**\n * Name of event that moves a comment.\n */\nexport const COMMENT_MOVE = 'comment_move';\n\n/**\n * Name of event that records a workspace load.\n */\nexport const FINISHED_LOADING = 'finished_loading';\n\n/**\n * Type of events that cause objects to be bumped back into the visible\n * portion of the workspace.\n *\n * Not to be confused with bumping so that disconnected connections do not\n * appear connected.\n */\nexport type BumpEvent = BlockCreate | BlockMove | CommentCreate | CommentMove;\n\n/**\n * List of events that cause objects to be bumped back into the visible\n * portion of the workspace.\n *\n * Not to be confused with bumping so that disconnected connections do not\n * appear connected.\n */\nexport const BUMP_EVENTS: string[] = [\n  BLOCK_CREATE,\n  BLOCK_MOVE,\n  COMMENT_CREATE,\n  COMMENT_MOVE,\n];\n\n/** List of events queued for firing. */\nconst FIRE_QUEUE: Abstract[] = [];\n\n/**\n * Create a custom event and fire it.\n *\n * @param event Custom data for event.\n */\nexport function fire(event: Abstract) {\n  TEST_ONLY.fireInternal(event);\n}\n\n/**\n * Private version of fireInternal for stubbing in tests.\n */\nfunction fireInternal(event: Abstract) {\n  if (!isEnabled()) {\n    return;\n  }\n  if (!FIRE_QUEUE.length) {\n    // First event added; schedule a firing of the event queue.\n    try {\n      // If we are in a browser context, we want to make sure that the event\n      // fires after blocks have been rerendered this frame.\n      requestAnimationFrame(() => {\n        setTimeout(fireNow, 0);\n      });\n    } catch (e) {\n      // Otherwise we just want to delay so events can be coallesced.\n      // requestAnimationFrame will error triggering this.\n      setTimeout(fireNow, 0);\n    }\n  }\n  FIRE_QUEUE.push(event);\n}\n\n/** Fire all queued events. */\nfunction fireNow() {\n  const queue = filter(FIRE_QUEUE, true);\n  FIRE_QUEUE.length = 0;\n  for (let i = 0, event; (event = queue[i]); i++) {\n    if (!event.workspaceId) {\n      continue;\n    }\n    const eventWorkspace = common.getWorkspaceById(event.workspaceId);\n    if (eventWorkspace) {\n      eventWorkspace.fireChangeListener(event);\n    }\n  }\n\n  // Post-filter the undo stack to squash and remove any events that result in\n  // a null event\n\n  // 1. Determine which workspaces will need to have their undo stacks validated\n  const workspaceIds = new Set(queue.map((e) => e.workspaceId));\n  for (const workspaceId of workspaceIds) {\n    // Only process valid workspaces\n    if (!workspaceId) {\n      continue;\n    }\n    const eventWorkspace = common.getWorkspaceById(workspaceId);\n    if (!eventWorkspace) {\n      continue;\n    }\n\n    // Find the last contiguous group of events on the stack\n    const undoStack = eventWorkspace.getUndoStack();\n    let i;\n    let group: string | undefined = undefined;\n    for (i = undoStack.length; i > 0; i--) {\n      const event = undoStack[i - 1];\n      if (event.group === '') {\n        break;\n      } else if (group === undefined) {\n        group = event.group;\n      } else if (event.group !== group) {\n        break;\n      }\n    }\n    if (!group || i == undoStack.length - 1) {\n      // Need a group of two or more events on the stack. Nothing to do here.\n      continue;\n    }\n\n    // Extract the event group, filter, and add back to the undo stack\n    let events = undoStack.splice(i, undoStack.length - i);\n    events = filter(events, true);\n    undoStack.push(...events);\n  }\n}\n\n/**\n * Filter the queued events and merge duplicates.\n *\n * @param queueIn Array of events.\n * @param forward True if forward (redo), false if backward (undo).\n * @returns Array of filtered events.\n */\nexport function filter(queueIn: Abstract[], forward: boolean): Abstract[] {\n  let queue = queueIn.slice();\n  // Shallow copy of queue.\n  if (!forward) {\n    // Undo is merged in reverse order.\n    queue.reverse();\n  }\n  const mergedQueue = [];\n  const hash = Object.create(null);\n  // Merge duplicates.\n  for (let i = 0, event; (event = queue[i]); i++) {\n    if (!event.isNull()) {\n      // Treat all UI events as the same type in hash table.\n      const eventType = event.isUiEvent ? UI : event.type;\n      // TODO(#5927): Check whether `blockId` exists before accessing it.\n      const blockId = (event as AnyDuringMigration).blockId;\n      const key = [eventType, blockId, event.workspaceId].join(' ');\n\n      const lastEntry = hash[key];\n      const lastEvent = lastEntry ? lastEntry.event : null;\n      if (!lastEntry) {\n        // Each item in the hash table has the event and the index of that event\n        // in the input array.  This lets us make sure we only merge adjacent\n        // move events.\n        hash[key] = {event, index: i};\n        mergedQueue.push(event);\n      } else if (event.type === MOVE && lastEntry.index === i - 1) {\n        const moveEvent = event as BlockMove;\n        // Merge move events.\n        lastEvent.newParentId = moveEvent.newParentId;\n        lastEvent.newInputName = moveEvent.newInputName;\n        lastEvent.newCoordinate = moveEvent.newCoordinate;\n        if (moveEvent.reason) {\n          if (lastEvent.reason) {\n            // Concatenate reasons without duplicates.\n            const reasonSet = new Set(\n              moveEvent.reason.concat(lastEvent.reason),\n            );\n            lastEvent.reason = Array.from(reasonSet);\n          } else {\n            lastEvent.reason = moveEvent.reason;\n          }\n        }\n        lastEntry.index = i;\n      } else if (\n        event.type === CHANGE &&\n        (event as BlockChange).element === lastEvent.element &&\n        (event as BlockChange).name === lastEvent.name\n      ) {\n        const changeEvent = event as BlockChange;\n        // Merge change events.\n        lastEvent.newValue = changeEvent.newValue;\n      } else if (event.type === VIEWPORT_CHANGE) {\n        const viewportEvent = event as ViewportChange;\n        // Merge viewport change events.\n        lastEvent.viewTop = viewportEvent.viewTop;\n        lastEvent.viewLeft = viewportEvent.viewLeft;\n        lastEvent.scale = viewportEvent.scale;\n        lastEvent.oldScale = viewportEvent.oldScale;\n      } else if (event.type === CLICK && lastEvent.type === BUBBLE_OPEN) {\n        // Drop click events caused by opening/closing bubbles.\n      } else {\n        // Collision: newer events should merge into this event to maintain\n        // order.\n        hash[key] = {event, index: i};\n        mergedQueue.push(event);\n      }\n    }\n  }\n  // Filter out any events that have become null due to merging.\n  queue = mergedQueue.filter(function (e) {\n    return !e.isNull();\n  });\n  if (!forward) {\n    // Restore undo order.\n    queue.reverse();\n  }\n  // Move mutation events to the top of the queue.\n  // Intentionally skip first event.\n  for (let i = 1, event; (event = queue[i]); i++) {\n    // AnyDuringMigration because:  Property 'element' does not exist on type\n    // 'Abstract'.\n    if (\n      event.type === CHANGE &&\n      (event as AnyDuringMigration).element === 'mutation'\n    ) {\n      queue.unshift(queue.splice(i, 1)[0]);\n    }\n  }\n  return queue;\n}\n\n/**\n * Modify pending undo events so that when they are fired they don't land\n * in the undo stack.  Called by Workspace.clearUndo.\n */\nexport function clearPendingUndo() {\n  for (let i = 0, event; (event = FIRE_QUEUE[i]); i++) {\n    event.recordUndo = false;\n  }\n}\n\n/**\n * Stop sending events.  Every call to this function MUST also call enable.\n */\nexport function disable() {\n  disabled++;\n}\n\n/**\n * Start sending events.  Unless events were already disabled when the\n * corresponding call to disable was made.\n */\nexport function enable() {\n  disabled--;\n}\n\n/**\n * Returns whether events may be fired or not.\n *\n * @returns True if enabled.\n */\nexport function isEnabled(): boolean {\n  return disabled === 0;\n}\n\n/**\n * Current group.\n *\n * @returns ID string.\n */\nexport function getGroup(): string {\n  return group;\n}\n\n/**\n * Start or stop a group.\n *\n * @param state True to start new group, false to end group.\n *   String to set group explicitly.\n */\nexport function setGroup(state: boolean | string) {\n  TEST_ONLY.setGroupInternal(state);\n}\n\n/**\n * Private version of setGroup for stubbing in tests.\n */\nfunction setGroupInternal(state: boolean | string) {\n  if (typeof state === 'boolean') {\n    group = state ? idGenerator.genUid() : '';\n  } else {\n    group = state;\n  }\n}\n\n/**\n * Compute a list of the IDs of the specified block and all its descendants.\n *\n * @param block The root block.\n * @returns List of block IDs.\n * @internal\n */\nexport function getDescendantIds(block: Block): string[] {\n  const ids = [];\n  const descendants = block.getDescendants(false);\n  for (let i = 0, descendant; (descendant = descendants[i]); i++) {\n    ids[i] = descendant.id;\n  }\n  return ids;\n}\n\n/**\n * Decode the JSON into an event.\n *\n * @param json JSON representation.\n * @param workspace Target workspace for event.\n * @returns The event represented by the JSON.\n * @throws {Error} if an event type is not found in the registry.\n */\nexport function fromJson(\n  json: AnyDuringMigration,\n  workspace: Workspace,\n): Abstract {\n  const eventClass = get(json['type']);\n  if (!eventClass) throw Error('Unknown event type.');\n\n  return (eventClass as any).fromJson(json, workspace);\n}\n\n/**\n * Gets the class for a specific event type from the registry.\n *\n * @param eventType The type of the event to get.\n * @returns The event class with the given type.\n */\nexport function get(\n  eventType: string,\n): new (...p1: AnyDuringMigration[]) => Abstract {\n  const event = registry.getClass(registry.Type.EVENT, eventType);\n  if (!event) {\n    throw new Error(`Event type ${eventType} not found in registry.`);\n  }\n  return event;\n}\n\n/**\n * Enable/disable a block depending on whether it is properly connected.\n * Use this on applications where all blocks should be connected to a top block.\n * Recommend setting the 'disable' option to 'false' in the config so that\n * users don't try to re-enable disabled orphan blocks.\n *\n * @param event Custom data for event.\n */\nexport function disableOrphans(event: Abstract) {\n  if (event.type === MOVE || event.type === CREATE) {\n    const blockEvent = event as BlockMove | BlockCreate;\n    if (!blockEvent.workspaceId) {\n      return;\n    }\n    const eventWorkspace = common.getWorkspaceById(\n      blockEvent.workspaceId,\n    ) as WorkspaceSvg;\n    if (!blockEvent.blockId) {\n      throw new Error('Encountered a blockEvent without a proper blockId');\n    }\n    let block = eventWorkspace.getBlockById(blockEvent.blockId);\n    if (block) {\n      // Changing blocks as part of this event shouldn't be undoable.\n      const initialUndoFlag = recordUndo;\n      try {\n        recordUndo = false;\n        const parent = block.getParent();\n        if (parent && parent.isEnabled()) {\n          const children = block.getDescendants(false);\n          for (let i = 0, child; (child = children[i]); i++) {\n            child.setEnabled(true);\n          }\n        } else if (\n          (block.outputConnection || block.previousConnection) &&\n          !eventWorkspace.isDragging()\n        ) {\n          do {\n            block.setEnabled(false);\n            block = block.getNextBlock();\n          } while (block);\n        }\n      } finally {\n        recordUndo = initialUndoFlag;\n      }\n    }\n  }\n}\n\nexport const TEST_ONLY = {\n  FIRE_QUEUE,\n  fireNow,\n  fireInternal,\n  setGroupInternal,\n};\n","/**\n * @license\n * Copyright 2016 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.Touch\n\nimport type {Gesture} from './gesture.js';\n\n/** Length in ms for a touch to become a long press. */\nconst LONGPRESS = 750;\n\n/**\n * Whether touch is enabled in the browser.\n * Copied from Closure's goog.events.BrowserFeature.TOUCH_ENABLED\n */\nexport const TOUCH_ENABLED =\n  'ontouchstart' in globalThis ||\n  !!(\n    globalThis['document'] &&\n    document.documentElement &&\n    'ontouchstart' in document.documentElement\n  ) || // IE10 uses non-standard touch events,\n  // so it has a different check.\n  !!(\n    globalThis['navigator'] &&\n    (globalThis['navigator']['maxTouchPoints'] ||\n      (globalThis['navigator'] as any)['msMaxTouchPoints'])\n  );\n\n/** Which touch events are we currently paying attention to? */\nlet touchIdentifier_: string | null = null;\n\n/**\n * The TOUCH_MAP lookup dictionary specifies additional touch events to fire,\n * in conjunction with mouse events.\n */\nexport const TOUCH_MAP: {[key: string]: string[]} = {\n  'mousedown': ['pointerdown'],\n  'mouseenter': ['pointerenter'],\n  'mouseleave': ['pointerleave'],\n  'mousemove': ['pointermove'],\n  'mouseout': ['pointerout'],\n  'mouseover': ['pointerover'],\n  'mouseup': ['pointerup', 'pointercancel'],\n  'touchend': ['pointerup'],\n  'touchcancel': ['pointercancel'],\n};\n\n/** PID of queued long-press task. */\nlet longPid_: AnyDuringMigration = 0;\n\n/**\n * Context menus on touch devices are activated using a long-press.\n * Unfortunately the contextmenu touch event is currently (2015) only supported\n * by Chrome.  This function is fired on any touchstart event, queues a task,\n * which after about a second opens the context menu.  The tasks is killed\n * if the touch event terminates early.\n *\n * @param e Touch start event.\n * @param gesture The gesture that triggered this longStart.\n * @internal\n */\nexport function longStart(e: PointerEvent, gesture: Gesture) {\n  longStop();\n  longPid_ = setTimeout(function () {\n    // Let the gesture route the right-click correctly.\n    if (gesture) {\n      gesture.handleRightClick(e);\n    }\n  }, LONGPRESS);\n}\n\n/**\n * Nope, that's not a long-press.  Either touchend or touchcancel was fired,\n * or a drag hath begun.  Kill the queued long-press task.\n *\n * @internal\n */\nexport function longStop() {\n  if (longPid_) {\n    clearTimeout(longPid_);\n    longPid_ = 0;\n  }\n}\n\n/**\n * Clear the touch identifier that tracks which touch stream to pay attention\n * to.  This ends the current drag/gesture and allows other pointers to be\n * captured.\n */\nexport function clearTouchIdentifier() {\n  touchIdentifier_ = null;\n}\n\n/**\n * Decide whether Blockly should handle or ignore this event.\n * Mouse and touch events require special checks because we only want to deal\n * with one touch stream at a time.  All other events should always be handled.\n *\n * @param e The event to check.\n * @returns True if this event should be passed through to the registered\n *     handler; false if it should be blocked.\n */\nexport function shouldHandleEvent(e: Event): boolean {\n  // Do not replace the startsWith with a check for `instanceof PointerEvent`.\n  // `click` and `contextmenu` are PointerEvents in some browsers,\n  // despite not starting with `pointer`, but we want to always handle them\n  // without worrying about touch identifiers.\n  return (\n    !e.type.startsWith('pointer') ||\n    (e instanceof PointerEvent && checkTouchIdentifier(e))\n  );\n}\n\n/**\n * Get the pointer identifier from the given event.\n *\n * @param e Pointer event.\n * @returns The pointerId of the event.\n */\nexport function getTouchIdentifierFromEvent(e: PointerEvent): string {\n  return `${e.pointerId}`;\n}\n\n/**\n * Check whether the pointer identifier on the event matches the current saved\n * identifier. If the current identifier was unset, save the identifier from\n * the event. This starts a drag/gesture, during which pointer events with\n * other identifiers will be silently ignored.\n *\n * @param e Pointer event.\n * @returns Whether the identifier on the event matches the current saved\n *     identifier.\n */\nexport function checkTouchIdentifier(e: PointerEvent): boolean {\n  const identifier = getTouchIdentifierFromEvent(e);\n\n  if (touchIdentifier_) {\n    // We're already tracking some touch/mouse event.  Is this from the same\n    // source?\n    return touchIdentifier_ === identifier;\n  }\n  if (e.type === 'pointerdown') {\n    // No identifier set yet, and this is the start of a drag.  Set it and\n    // return.\n    touchIdentifier_ = identifier;\n    return true;\n  }\n  // There was no identifier yet, but this wasn't a start event so we're going\n  // to ignore it.  This probably means that another drag finished while this\n  // pointer was down.\n  return false;\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.browserEvents\n\nimport * as Touch from './touch.js';\nimport * as userAgent from './utils/useragent.js';\n\n/**\n * Blockly opaque event data used to unbind events when using\n * `bind` and `conditionalBind`.\n */\nexport type Data = [EventTarget, string, (e: Event) => void][];\n\n/**\n * The multiplier for scroll wheel deltas using the line delta mode.\n * See https://developer.mozilla.org/en-US/docs/Web/API/WheelEvent/deltaMode\n * for more information on deltaMode.\n */\nconst LINE_MODE_MULTIPLIER = 40;\n\n/**\n * The multiplier for scroll wheel deltas using the page delta mode.\n * See https://developer.mozilla.org/en-US/docs/Web/API/WheelEvent/deltaMode\n * for more information on deltaMode.\n */\nconst PAGE_MODE_MULTIPLIER = 125;\n\n/**\n * Bind an event handler that can be ignored if it is not part of the active\n * touch stream.\n * Use this for events that either start or continue a multi-part gesture (e.g.\n * mousedown or mousemove, which may be part of a drag or click).\n *\n * @param node Node upon which to listen.\n * @param name Event name to listen to (e.g. 'mousedown').\n * @param thisObject The value of 'this' in the function.\n * @param func Function to call when event is triggered.\n * @param opt_noCaptureIdentifier True if triggering on this event should not\n *     block execution of other event handlers on this touch or other\n *     simultaneous touches.  False by default.\n * @returns Opaque data that can be passed to unbindEvent_.\n */\nexport function conditionalBind(\n  node: EventTarget,\n  name: string,\n  thisObject: Object | null,\n  func: Function,\n  opt_noCaptureIdentifier?: boolean,\n): Data {\n  /**\n   *\n   * @param e\n   */\n  function wrapFunc(e: Event) {\n    const captureIdentifier = !opt_noCaptureIdentifier;\n\n    if (!(captureIdentifier && !Touch.shouldHandleEvent(e))) {\n      if (thisObject) {\n        func.call(thisObject, e);\n      } else {\n        func(e);\n      }\n    }\n  }\n\n  const bindData: Data = [];\n  if (name in Touch.TOUCH_MAP) {\n    for (let i = 0; i < Touch.TOUCH_MAP[name].length; i++) {\n      const type = Touch.TOUCH_MAP[name][i];\n      node.addEventListener(type, wrapFunc, false);\n      bindData.push([node, type, wrapFunc]);\n    }\n  } else {\n    node.addEventListener(name, wrapFunc, false);\n    bindData.push([node, name, wrapFunc]);\n  }\n  return bindData;\n}\n\n/**\n * Bind an event handler that should be called regardless of whether it is part\n * of the active touch stream.\n * Use this for events that are not part of a multi-part gesture (e.g.\n * mouseover for tooltips).\n *\n * @param node Node upon which to listen.\n * @param name Event name to listen to (e.g. 'mousedown').\n * @param thisObject The value of 'this' in the function.\n * @param func Function to call when event is triggered.\n * @returns Opaque data that can be passed to unbindEvent_.\n */\nexport function bind(\n  node: EventTarget,\n  name: string,\n  thisObject: Object | null,\n  func: Function,\n): Data {\n  /**\n   *\n   * @param e\n   */\n  function wrapFunc(e: Event) {\n    if (thisObject) {\n      func.call(thisObject, e);\n    } else {\n      func(e);\n    }\n  }\n\n  const bindData: Data = [];\n  if (name in Touch.TOUCH_MAP) {\n    for (let i = 0; i < Touch.TOUCH_MAP[name].length; i++) {\n      const type = Touch.TOUCH_MAP[name][i];\n      node.addEventListener(type, wrapFunc, false);\n      bindData.push([node, type, wrapFunc]);\n    }\n  } else {\n    node.addEventListener(name, wrapFunc, false);\n    bindData.push([node, name, wrapFunc]);\n  }\n  return bindData;\n}\n\n/**\n * Unbind one or more events event from a function call.\n *\n * @param bindData Opaque data from bindEvent_.\n *     This list is emptied during the course of calling this function.\n * @returns The function call.\n */\nexport function unbind(bindData: Data): (e: Event) => void {\n  // Accessing an element of the last property of the array is unsafe if the\n  // bindData is an empty array. But that should never happen because developers\n  // should only pass Data from bind or conditionalBind.\n  const callback = bindData[bindData.length - 1][2];\n  while (bindData.length) {\n    const [node, name, func] = bindData.pop()!;\n    node.removeEventListener(name, func, false);\n  }\n  return callback;\n}\n\n/**\n * Returns true if this event is targeting a text input widget?\n *\n * @param e An event.\n * @returns True if text input.\n */\nexport function isTargetInput(e: Event): boolean {\n  if (e.target instanceof HTMLElement) {\n    if (\n      e.target.isContentEditable ||\n      e.target.getAttribute('data-is-text-input') === 'true'\n    ) {\n      return true;\n    }\n\n    if (e.target instanceof HTMLInputElement) {\n      const target = e.target;\n      return (\n        target.type === 'text' ||\n        target.type === 'number' ||\n        target.type === 'email' ||\n        target.type === 'password' ||\n        target.type === 'search' ||\n        target.type === 'tel' ||\n        target.type === 'url'\n      );\n    }\n\n    if (e.target instanceof HTMLTextAreaElement) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\n/**\n * Returns true this event is a right-click.\n *\n * @param e Mouse event.\n * @returns True if right-click.\n */\nexport function isRightButton(e: MouseEvent): boolean {\n  if (e.ctrlKey && userAgent.MAC) {\n    // Control-clicking on Mac OS X is treated as a right-click.\n    // WebKit on Mac OS X fails to change button to 2 (but Gecko does).\n    return true;\n  }\n  return e.button === 2;\n}\n\n/**\n * Returns the converted coordinates of the given mouse event.\n * The origin (0,0) is the top-left corner of the Blockly SVG.\n *\n * @param e Mouse event.\n * @param svg SVG element.\n * @param matrix Inverted screen CTM to use.\n * @returns Object with .x and .y properties.\n */\nexport function mouseToSvg(\n  e: MouseEvent,\n  svg: SVGSVGElement,\n  matrix: SVGMatrix | null,\n): SVGPoint {\n  const svgPoint = svg.createSVGPoint();\n  svgPoint.x = e.clientX;\n  svgPoint.y = e.clientY;\n\n  if (!matrix) {\n    matrix = svg.getScreenCTM()!.inverse();\n  }\n  return svgPoint.matrixTransform(matrix);\n}\n\n/**\n * Returns the scroll delta of a mouse event in pixel units.\n *\n * @param e Mouse event.\n * @returns Scroll delta object with .x and .y properties.\n */\nexport function getScrollDeltaPixels(e: WheelEvent): {x: number; y: number} {\n  switch (e.deltaMode) {\n    case 0x00: // Pixel mode.\n    default:\n      return {x: e.deltaX, y: e.deltaY};\n    case 0x01: // Line mode.\n      return {\n        x: e.deltaX * LINE_MODE_MULTIPLIER,\n        y: e.deltaY * LINE_MODE_MULTIPLIER,\n      };\n    case 0x02: // Page mode.\n      return {\n        x: e.deltaX * PAGE_MODE_MULTIPLIER,\n        y: e.deltaY * PAGE_MODE_MULTIPLIER,\n      };\n  }\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.utils.array\n\n/**\n * Removes the first occurrence of a particular value from an array.\n *\n * @param arr Array from which to remove value.\n * @param value Value to remove.\n * @returns True if an element was removed.\n * @internal\n */\nexport function removeElem<T>(arr: Array<T>, value: T): boolean {\n  const i = arr.indexOf(value);\n  if (i === -1) {\n    return false;\n  }\n  arr.splice(i, 1);\n  return true;\n}\n","/**\n * @license\n * Copyright 2013 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.Css\n\n/** Has CSS already been injected? */\nlet injected = false;\n\n/**\n * Add some CSS to the blob that will be injected later.  Allows optional\n * components such as fields and the toolbox to store separate CSS.\n *\n * @param cssContent Multiline CSS string or an array of single lines of CSS.\n */\nexport function register(cssContent: string) {\n  if (injected) {\n    throw Error('CSS already injected');\n  }\n  content += '\\n' + cssContent;\n}\n\n/**\n * Inject the CSS into the DOM.  This is preferable over using a regular CSS\n * file since:\n * a) It loads synchronously and doesn't force a redraw later.\n * b) It speeds up loading by not blocking on a separate HTTP transfer.\n * c) The CSS content may be made dynamic depending on init options.\n *\n * @param hasCss If false, don't inject CSS (providing CSS becomes the\n *     document's responsibility).\n * @param pathToMedia Path from page to the Blockly media directory.\n */\nexport function inject(hasCss: boolean, pathToMedia: string) {\n  // Only inject the CSS once.\n  if (injected) {\n    return;\n  }\n  injected = true;\n  if (!hasCss) {\n    return;\n  }\n  // Strip off any trailing slash (either Unix or Windows).\n  const mediaPath = pathToMedia.replace(/[\\\\/]$/, '');\n  const cssContent = content.replace(/<<<PATH>>>/g, mediaPath);\n  // Cleanup the collected css content after injecting it to the DOM.\n  content = '';\n\n  // Inject CSS tag at start of head.\n  const cssNode = document.createElement('style');\n  cssNode.id = 'blockly-common-style';\n  const cssTextNode = document.createTextNode(cssContent);\n  cssNode.appendChild(cssTextNode);\n  document.head.insertBefore(cssNode, document.head.firstChild);\n}\n\n/**\n * The CSS content for Blockly.\n */\nlet content = `\n.blocklySvg {\n  background-color: #fff;\n  outline: none;\n  overflow: hidden;  /* IE overflows by default. */\n  position: absolute;\n  display: block;\n}\n\n.blocklyWidgetDiv {\n  display: none;\n  position: absolute;\n  z-index: 99999;  /* big value for bootstrap3 compatibility */\n}\n\n.injectionDiv {\n  height: 100%;\n  position: relative;\n  overflow: hidden;  /* So blocks in drag surface disappear at edges */\n  touch-action: none;\n}\n\n.blocklyNonSelectable {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n}\n\n.blocklyBlockCanvas.blocklyCanvasTransitioning,\n.blocklyBubbleCanvas.blocklyCanvasTransitioning {\n  transition: transform .5s;\n}\n\n.blocklyTooltipDiv {\n  background-color: #ffffc7;\n  border: 1px solid #ddc;\n  box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);\n  color: #000;\n  display: none;\n  font: 9pt sans-serif;\n  opacity: .9;\n  padding: 2px;\n  position: absolute;\n  z-index: 100000;  /* big value for bootstrap3 compatibility */\n}\n\n.blocklyDropDownDiv {\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1000;\n  display: none;\n  border: 1px solid;\n  border-color: #dadce0;\n  background-color: #fff;\n  border-radius: 2px;\n  padding: 4px;\n  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownDiv.blocklyFocused {\n  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownContent {\n  max-height: 300px;  /* @todo: spec for maximum height. */\n  overflow: auto;\n  overflow-x: hidden;\n  position: relative;\n}\n\n.blocklyDropDownArrow {\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 16px;\n  height: 16px;\n  z-index: -1;\n  background-color: inherit;\n  border-color: inherit;\n}\n\n.blocklyDropDownButton {\n  display: inline-block;\n  float: left;\n  padding: 0;\n  margin: 4px;\n  border-radius: 4px;\n  outline: none;\n  border: 1px solid;\n  transition: box-shadow .1s;\n  cursor: pointer;\n}\n\n.blocklyArrowTop {\n  border-top: 1px solid;\n  border-left: 1px solid;\n  border-top-left-radius: 4px;\n  border-color: inherit;\n}\n\n.blocklyArrowBottom {\n  border-bottom: 1px solid;\n  border-right: 1px solid;\n  border-bottom-right-radius: 4px;\n  border-color: inherit;\n}\n\n.blocklyResizeSE {\n  cursor: se-resize;\n  fill: #aaa;\n}\n\n.blocklyResizeSW {\n  cursor: sw-resize;\n  fill: #aaa;\n}\n\n.blocklyResizeLine {\n  stroke: #515A5A;\n  stroke-width: 1;\n}\n\n.blocklyHighlightedConnectionPath {\n  fill: none;\n  stroke: #fc3;\n  stroke-width: 4px;\n}\n\n.blocklyPathLight {\n  fill: none;\n  stroke-linecap: round;\n  stroke-width: 1;\n}\n\n.blocklySelected>.blocklyPathLight {\n  display: none;\n}\n\n.blocklyDraggable {\n  cursor: grab;\n  cursor: -webkit-grab;\n}\n\n.blocklyDragging {\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n  /* Changes cursor on mouse down. Not effective in Firefox because of\n     https://bugzilla.mozilla.org/show_bug.cgi?id=771241 */\n.blocklyDraggable:active {\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n.blocklyDragging.blocklyDraggingDelete {\n  cursor: url(\"<<<PATH>>>/handdelete.cur\"), auto;\n}\n\n.blocklyDragging>.blocklyPath,\n.blocklyDragging>.blocklyPathLight {\n  fill-opacity: .8;\n  stroke-opacity: .8;\n}\n\n.blocklyDragging>.blocklyPathDark {\n  display: none;\n}\n\n.blocklyDisabled>.blocklyPath {\n  fill-opacity: .5;\n  stroke-opacity: .5;\n}\n\n.blocklyDisabled>.blocklyPathLight,\n.blocklyDisabled>.blocklyPathDark {\n  display: none;\n}\n\n.blocklyInsertionMarker>.blocklyPath,\n.blocklyInsertionMarker>.blocklyPathLight,\n.blocklyInsertionMarker>.blocklyPathDark {\n  fill-opacity: .2;\n  stroke: none;\n}\n\n.blocklyMultilineText {\n  font-family: monospace;\n}\n\n.blocklyNonEditableText>text {\n  pointer-events: none;\n}\n\n.blocklyFlyout {\n  position: absolute;\n  z-index: 20;\n}\n\n.blocklyText text {\n  cursor: default;\n}\n\n/*\n  Don't allow users to select text.  It gets annoying when trying to\n  drag a block and selected text moves instead.\n*/\n.blocklySvg text {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  cursor: inherit;\n}\n\n.blocklyHidden {\n  display: none;\n}\n\n.blocklyFieldDropdown:not(.blocklyHidden) {\n  display: block;\n}\n\n.blocklyIconGroup {\n  cursor: default;\n}\n\n.blocklyIconGroup:not(:hover),\n.blocklyIconGroupReadonly {\n  opacity: .6;\n}\n\n.blocklyIconShape {\n  fill: #00f;\n  stroke: #fff;\n  stroke-width: 1px;\n}\n\n.blocklyIconSymbol {\n  fill: #fff;\n}\n\n.blocklyMinimalBody {\n  margin: 0;\n  padding: 0;\n}\n\n.blocklyHtmlInput {\n  border: none;\n  border-radius: 4px;\n  height: 100%;\n  margin: 0;\n  outline: none;\n  padding: 0;\n  width: 100%;\n  text-align: center;\n  display: block;\n  box-sizing: border-box;\n}\n\n/* Remove the increase and decrease arrows on the field number editor */\ninput.blocklyHtmlInput[type=number]::-webkit-inner-spin-button,\ninput.blocklyHtmlInput[type=number]::-webkit-outer-spin-button {\n  -webkit-appearance: none;\n  margin: 0;\n}\n\ninput[type=number] {\n  -moz-appearance: textfield;\n}\n\n.blocklyMainBackground {\n  stroke-width: 1;\n  stroke: #c6c6c6;  /* Equates to #ddd due to border being off-pixel. */\n}\n\n.blocklyMutatorBackground {\n  fill: #fff;\n  stroke: #ddd;\n  stroke-width: 1;\n}\n\n.blocklyFlyoutBackground {\n  fill: #ddd;\n  fill-opacity: .8;\n}\n\n.blocklyMainWorkspaceScrollbar {\n  z-index: 20;\n}\n\n.blocklyFlyoutScrollbar {\n  z-index: 30;\n}\n\n.blocklyScrollbarHorizontal,\n.blocklyScrollbarVertical {\n  position: absolute;\n  outline: none;\n}\n\n.blocklyScrollbarBackground {\n  opacity: 0;\n}\n\n.blocklyScrollbarHandle {\n  fill: #ccc;\n}\n\n.blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,\n.blocklyScrollbarHandle:hover {\n  fill: #bbb;\n}\n\n/* Darken flyout scrollbars due to being on a grey background. */\n/* By contrast, workspace scrollbars are on a white background. */\n.blocklyFlyout .blocklyScrollbarHandle {\n  fill: #bbb;\n}\n\n.blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,\n.blocklyFlyout .blocklyScrollbarHandle:hover {\n  fill: #aaa;\n}\n\n.blocklyInvalidInput {\n  background: #faa;\n}\n\n.blocklyVerticalMarker {\n  stroke-width: 3px;\n  fill: rgba(255,255,255,.5);\n  pointer-events: none;\n}\n\n.blocklyComputeCanvas {\n  position: absolute;\n  width: 0;\n  height: 0;\n}\n\n.blocklyNoPointerEvents {\n  pointer-events: none;\n}\n\n.blocklyContextMenu {\n  border-radius: 4px;\n  max-height: 100%;\n}\n\n.blocklyDropdownMenu {\n  border-radius: 2px;\n  padding: 0 !important;\n}\n\n.blocklyDropdownMenu .blocklyMenuItem {\n  /* 28px on the left for icon or checkbox. */\n  padding-left: 28px;\n}\n\n/* BiDi override for the resting state. */\n.blocklyDropdownMenu .blocklyMenuItemRtl {\n  /* Flip left/right padding for BiDi. */\n  padding-left: 5px;\n  padding-right: 28px;\n}\n\n.blocklyWidgetDiv .blocklyMenu {\n  background: #fff;\n  border: 1px solid transparent;\n  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);\n  font: normal 13px Arial, sans-serif;\n  margin: 0;\n  outline: none;\n  padding: 4px 0;\n  position: absolute;\n  overflow-y: auto;\n  overflow-x: hidden;\n  max-height: 100%;\n  z-index: 20000;  /* Arbitrary, but some apps depend on it... */\n}\n\n.blocklyWidgetDiv .blocklyMenu.blocklyFocused {\n  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownDiv .blocklyMenu {\n  background: inherit;  /* Compatibility with gapi, reset from goog-menu */\n  border: inherit;  /* Compatibility with gapi, reset from goog-menu */\n  font: normal 13px \"Helvetica Neue\", Helvetica, sans-serif;\n  outline: none;\n  position: relative;  /* Compatibility with gapi, reset from goog-menu */\n  z-index: 20000;  /* Arbitrary, but some apps depend on it... */\n}\n\n/* State: resting. */\n.blocklyMenuItem {\n  border: none;\n  color: #000;\n  cursor: pointer;\n  list-style: none;\n  margin: 0;\n  /* 7em on the right for shortcut. */\n  min-width: 7em;\n  padding: 6px 15px;\n  white-space: nowrap;\n}\n\n/* State: disabled. */\n.blocklyMenuItemDisabled {\n  color: #ccc;\n  cursor: inherit;\n}\n\n/* State: hover. */\n.blocklyMenuItemHighlight {\n  background-color: rgba(0,0,0,.1);\n}\n\n/* State: selected/checked. */\n.blocklyMenuItemCheckbox {\n  height: 16px;\n  position: absolute;\n  width: 16px;\n}\n\n.blocklyMenuItemSelected .blocklyMenuItemCheckbox {\n  background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px;\n  float: left;\n  margin-left: -24px;\n  position: static;  /* Scroll with the menu. */\n}\n\n.blocklyMenuItemRtl .blocklyMenuItemCheckbox {\n  float: right;\n  margin-right: -24px;\n}\n\n.blocklyBlockDragSurface {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  overflow: visible !important;\n  z-index: 80;\n  pointer-events: none;\n}\n`;\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.utils.deprecation\n\n// Set of previously-emitted warnings.\nconst previousWarnings = new Set();\n\n/**\n * Warn developers that a function or property is deprecated.\n *\n * @param name The name of the function or property.\n * @param deprecationDate The date of deprecation. Prefer 'version n.0.0'\n *     format, and fall back to 'month yyyy' or 'quarter yyyy' format.\n * @param deletionDate The date of deletion. Prefer 'version n.0.0'\n *     format, and fall back to 'month yyyy' or 'quarter yyyy' format.\n * @param opt_use The name of a function or property to use instead, if any.\n * @internal\n */\nexport function warn(\n  name: string,\n  deprecationDate: string,\n  deletionDate: string,\n  opt_use?: string,\n) {\n  let msg =\n    name +\n    ' was deprecated in ' +\n    deprecationDate +\n    ' and will be deleted in ' +\n    deletionDate +\n    '.';\n  if (opt_use) {\n    msg += '\\nUse ' + opt_use + ' instead.';\n  }\n\n  // Don't log deprecation warnings multiple times.\n  if (previousWarnings.has(msg)) {\n    return;\n  }\n\n  previousWarnings.add(msg);\n  console.warn(msg);\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.utils.dom\n\nimport * as deprecation from './deprecation.js';\nimport type {Svg} from './svg.js';\n\n/**\n * Required name space for SVG elements.\n */\nexport const SVG_NS = 'http://www.w3.org/2000/svg';\n\n/**\n * Required name space for HTML elements.\n */\nexport const HTML_NS = 'http://www.w3.org/1999/xhtml';\n\n/**\n * Required name space for XLINK elements.\n */\nexport const XLINK_NS = 'http://www.w3.org/1999/xlink';\n\n/**\n * Node type constants.\n * https://developer.mozilla.org/en-US/docs/Web/API/Node/nodeType\n */\nexport enum NodeType {\n  ELEMENT_NODE = 1,\n  TEXT_NODE = 3,\n  COMMENT_NODE = 8,\n}\n\n/** Temporary cache of text widths. */\nlet cacheWidths: {[key: string]: number} | null = null;\n\n/** Number of current references to cache. */\nlet cacheReference = 0;\n\n/** A HTML canvas context used for computing text width. */\nlet canvasContext: CanvasRenderingContext2D | null = null;\n\n/**\n * Helper method for creating SVG elements.\n *\n * @param name Element's tag name.\n * @param attrs Dictionary of attribute names and values.\n * @param opt_parent Optional parent on which to append the element.\n * @returns if name is a string or a more specific type if it a member of Svg.\n */\nexport function createSvgElement<T extends SVGElement>(\n  name: string | Svg<T>,\n  attrs: {[key: string]: string | number},\n  opt_parent?: Element | null,\n): T {\n  const e = document.createElementNS(SVG_NS, `${name}`) as T;\n  for (const key in attrs) {\n    e.setAttribute(key, `${attrs[key]}`);\n  }\n  if (opt_parent) {\n    opt_parent.appendChild(e);\n  }\n  return e;\n}\n\n/**\n * Add a CSS class to a element.\n *\n * Handles multiple space-separated classes for legacy reasons.\n *\n * @param element DOM element to add class to.\n * @param className Name of class to add.\n * @returns True if class was added, false if already present.\n */\nexport function addClass(element: Element, className: string): boolean {\n  const classNames = className.split(' ');\n  if (classNames.every((name) => element.classList.contains(name))) {\n    return false;\n  }\n  element.classList.add(...classNames);\n  return true;\n}\n\n/**\n * Removes multiple classes from an element.\n *\n * @param element DOM element to remove classes from.\n * @param classNames A string of one or multiple class names for an element.\n */\nexport function removeClasses(element: Element, classNames: string) {\n  element.classList.remove(...classNames.split(' '));\n}\n\n/**\n * Remove a CSS class from a element.\n *\n * Handles multiple space-separated classes for legacy reasons.\n *\n * @param element DOM element to remove class from.\n * @param className Name of class to remove.\n * @returns True if class was removed, false if never present.\n */\nexport function removeClass(element: Element, className: string): boolean {\n  const classNames = className.split(' ');\n  if (classNames.every((name) => !element.classList.contains(name))) {\n    return false;\n  }\n  element.classList.remove(...classNames);\n  return true;\n}\n\n/**\n * Checks if an element has the specified CSS class.\n *\n * @param element DOM element to check.\n * @param className Name of class to check.\n * @returns True if class exists, false otherwise.\n */\nexport function hasClass(element: Element, className: string): boolean {\n  return element.classList.contains(className);\n}\n\n/**\n * Removes a node from its parent. No-op if not attached to a parent.\n *\n * @param node The node to remove.\n * @returns The node removed if removed; else, null.\n */\n// Copied from Closure goog.dom.removeNode\nexport function removeNode(node: Node | null): Node | null {\n  return node && node.parentNode ? node.parentNode.removeChild(node) : null;\n}\n\n/**\n * Insert a node after a reference node.\n * Contrast with node.insertBefore function.\n *\n * @param newNode New element to insert.\n * @param refNode Existing element to precede new node.\n */\nexport function insertAfter(newNode: Element, refNode: Element) {\n  const siblingNode = refNode.nextSibling;\n  const parentNode = refNode.parentNode;\n  if (!parentNode) {\n    throw Error('Reference node has no parent.');\n  }\n  if (siblingNode) {\n    parentNode.insertBefore(newNode, siblingNode);\n  } else {\n    parentNode.appendChild(newNode);\n  }\n}\n\n/**\n * Whether a node contains another node.\n *\n * @param parent The node that should contain the other node.\n * @param descendant The node to test presence of.\n * @returns Whether the parent node contains the descendant node.\n * @deprecated Use native 'contains' DOM method.\n */\nexport function containsNode(parent: Node, descendant: Node): boolean {\n  deprecation.warn(\n    'Blockly.utils.dom.containsNode',\n    'version 10',\n    'version 11',\n    'Use native \"contains\" DOM method',\n  );\n  return parent.contains(descendant);\n}\n\n/**\n * Sets the CSS transform property on an element. This function sets the\n * non-vendor-prefixed and vendor-prefixed versions for backwards compatibility\n * with older browsers. See https://caniuse.com/#feat=transforms2d\n *\n * @param element Element to which the CSS transform will be applied.\n * @param transform The value of the CSS `transform` property.\n */\nexport function setCssTransform(\n  element: HTMLElement | SVGElement,\n  transform: string,\n) {\n  element.style['transform'] = transform;\n  element.style['-webkit-transform' as any] = transform;\n}\n\n/**\n * Start caching text widths. Every call to this function MUST also call\n * stopTextWidthCache. Caches must not survive between execution threads.\n */\nexport function startTextWidthCache() {\n  cacheReference++;\n  if (!cacheWidths) {\n    cacheWidths = Object.create(null);\n  }\n}\n\n/**\n * Stop caching field widths. Unless caching was already on when the\n * corresponding call to startTextWidthCache was made.\n */\nexport function stopTextWidthCache() {\n  cacheReference--;\n  if (!cacheReference) {\n    cacheWidths = null;\n  }\n}\n\n/**\n * Gets the width of a text element, caching it in the process.\n *\n * @param textElement An SVG 'text' element.\n * @returns Width of element.\n */\nexport function getTextWidth(textElement: SVGTextElement): number {\n  const key = textElement.textContent + '\\n' + textElement.className.baseVal;\n  let width;\n  // Return the cached width if it exists.\n  if (cacheWidths) {\n    width = cacheWidths[key];\n    if (width) {\n      return width;\n    }\n  }\n\n  // Attempt to compute fetch the width of the SVG text element.\n  try {\n    width = textElement.getComputedTextLength();\n  } catch (e) {\n    // In other cases where we fail to get the computed text. Instead, use an\n    // approximation and do not cache the result. At some later point in time\n    // when the block is inserted into the visible DOM, this method will be\n    // called again and, at that point in time, will not throw an exception.\n    return textElement.textContent!.length * 8;\n  }\n\n  // Cache the computed width and return.\n  if (cacheWidths) {\n    cacheWidths[key] = width;\n  }\n  return width;\n}\n\n/**\n * Gets the width of a text element using a faster method than `getTextWidth`.\n * This method requires that we know the text element's font family and size in\n * advance. Similar to `getTextWidth`, we cache the width we compute.\n *\n * @param textElement An SVG 'text' element.\n * @param fontSize The font size to use.\n * @param fontWeight The font weight to use.\n * @param fontFamily The font family to use.\n * @returns Width of element.\n */\nexport function getFastTextWidth(\n  textElement: SVGTextElement,\n  fontSize: number,\n  fontWeight: string,\n  fontFamily: string,\n): number {\n  return getFastTextWidthWithSizeString(\n    textElement,\n    fontSize + 'pt',\n    fontWeight,\n    fontFamily,\n  );\n}\n\n/**\n * Gets the width of a text element using a faster method than `getTextWidth`.\n * This method requires that we know the text element's font family and size in\n * advance. Similar to `getTextWidth`, we cache the width we compute.\n * This method is similar to `getFastTextWidth` but expects the font size\n * parameter to be a string.\n *\n * @param textElement An SVG 'text' element.\n * @param fontSize The font size to use.\n * @param fontWeight The font weight to use.\n * @param fontFamily The font family to use.\n * @returns Width of element.\n */\nexport function getFastTextWidthWithSizeString(\n  textElement: SVGTextElement,\n  fontSize: string,\n  fontWeight: string,\n  fontFamily: string,\n): number {\n  const text = textElement.textContent;\n  const key = text + '\\n' + textElement.className.baseVal;\n  let width;\n\n  // Return the cached width if it exists.\n  if (cacheWidths) {\n    width = cacheWidths[key];\n    if (width) {\n      return width;\n    }\n  }\n\n  if (!canvasContext) {\n    // Inject the canvas element used for computing text widths.\n    const computeCanvas = document.createElement('canvas');\n    computeCanvas.className = 'blocklyComputeCanvas';\n    document.body.appendChild(computeCanvas);\n\n    // Initialize the HTML canvas context and set the font.\n    // The context font must match blocklyText's fontsize and font-family\n    // set in CSS.\n    canvasContext = computeCanvas.getContext('2d') as CanvasRenderingContext2D;\n  }\n  // Set the desired font size and family.\n  canvasContext.font = fontWeight + ' ' + fontSize + ' ' + fontFamily;\n\n  // Measure the text width using the helper canvas context.\n  if (text) {\n    width = canvasContext.measureText(text).width;\n  } else {\n    width = 0;\n  }\n\n  // Cache the computed width and return.\n  if (cacheWidths) {\n    cacheWidths[key] = width;\n  }\n  return width;\n}\n\n/**\n * Measure a font's metrics. The height and baseline values.\n *\n * @param text Text to measure the font dimensions of.\n * @param fontSize The font size to use.\n * @param fontWeight The font weight to use.\n * @param fontFamily The font family to use.\n * @returns Font measurements.\n */\nexport function measureFontMetrics(\n  text: string,\n  fontSize: string,\n  fontWeight: string,\n  fontFamily: string,\n): {height: number; baseline: number} {\n  const span = document.createElement('span');\n  span.style.font = fontWeight + ' ' + fontSize + ' ' + fontFamily;\n  span.textContent = text;\n\n  const block = document.createElement('div');\n  block.style.width = '1px';\n  block.style.height = '0';\n\n  const div = document.createElement('div');\n  div.style.display = 'flex';\n  div.style.position = 'fixed';\n  div.style.top = '0';\n  div.style.left = '0';\n  div.appendChild(span);\n  div.appendChild(block);\n\n  document.body.appendChild(div);\n  const result = {\n    height: 0,\n    baseline: 0,\n  };\n  try {\n    div.style.alignItems = 'baseline';\n    result.baseline = block.offsetTop - span.offsetTop;\n    div.style.alignItems = 'flex-end';\n    result.height = block.offsetTop - span.offsetTop;\n  } finally {\n    document.body.removeChild(div);\n  }\n  return result;\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.utils.style\n\nimport {Coordinate} from './coordinate.js';\nimport {Rect} from './rect.js';\nimport {Size} from './size.js';\n\n/**\n * Gets the height and width of an element.\n * Similar to Closure's goog.style.getSize\n *\n * @param element Element to get size of.\n * @returns Object with width/height properties.\n */\nexport function getSize(element: Element): Size {\n  return TEST_ONLY.getSizeInternal(element);\n}\n\n/**\n * Private version of getSize for stubbing in tests.\n */\nfunction getSizeInternal(element: Element): Size {\n  if (getComputedStyle(element, 'display') !== 'none') {\n    return getSizeWithDisplay(element);\n  }\n\n  // Evaluate size with a temporary element.\n  // AnyDuringMigration because:  Property 'style' does not exist on type\n  // 'Element'.\n  const style = (element as AnyDuringMigration).style;\n  const originalDisplay = style.display;\n  const originalVisibility = style.visibility;\n  const originalPosition = style.position;\n\n  style.visibility = 'hidden';\n  style.position = 'absolute';\n  style.display = 'inline';\n\n  const offsetWidth = (element as HTMLElement).offsetWidth;\n  const offsetHeight = (element as HTMLElement).offsetHeight;\n\n  style.display = originalDisplay;\n  style.position = originalPosition;\n  style.visibility = originalVisibility;\n\n  return new Size(offsetWidth, offsetHeight);\n}\n\n/**\n * Gets the height and width of an element when the display is not none.\n *\n * @param element Element to get size of.\n * @returns Object with width/height properties.\n */\nfunction getSizeWithDisplay(element: Element): Size {\n  const offsetWidth = (element as HTMLElement).offsetWidth;\n  const offsetHeight = (element as HTMLElement).offsetHeight;\n  return new Size(offsetWidth, offsetHeight);\n}\n\n/**\n * Retrieves a computed style value of a node. It returns empty string\n * if the property requested is an SVG one and it has not been\n * explicitly set (firefox and webkit).\n *\n * Copied from Closure's goog.style.getComputedStyle\n *\n * @param element Element to get style of.\n * @param property Property to get (camel-case).\n * @returns Style value.\n */\nexport function getComputedStyle(element: Element, property: string): string {\n  const styles = window.getComputedStyle(element);\n  // element.style[..] is undefined for browser specific styles\n  // as 'filter'.\n  return (\n    (styles as AnyDuringMigration)[property] ||\n    styles.getPropertyValue(property)\n  );\n}\n\n/**\n * Returns a Coordinate object relative to the top-left of the HTML document.\n * Similar to Closure's goog.style.getPageOffset\n *\n * @param el Element to get the page offset for.\n * @returns The page offset.\n */\nexport function getPageOffset(el: Element): Coordinate {\n  const pos = new Coordinate(0, 0);\n  const box = el.getBoundingClientRect();\n  const documentElement = document.documentElement;\n  // Must add the scroll coordinates in to get the absolute page offset\n  // of element since getBoundingClientRect returns relative coordinates to\n  // the viewport.\n  const scrollCoord = new Coordinate(\n    window.pageXOffset || documentElement.scrollLeft,\n    window.pageYOffset || documentElement.scrollTop,\n  );\n  pos.x = box.left + scrollCoord.x;\n  pos.y = box.top + scrollCoord.y;\n\n  return pos;\n}\n\n/**\n * Calculates the viewport coordinates relative to the document.\n * Similar to Closure's goog.style.getViewportPageOffset\n *\n * @returns The page offset of the viewport.\n */\nexport function getViewportPageOffset(): Coordinate {\n  const body = document.body;\n  const documentElement = document.documentElement;\n  const scrollLeft = body.scrollLeft || documentElement.scrollLeft;\n  const scrollTop = body.scrollTop || documentElement.scrollTop;\n  return new Coordinate(scrollLeft, scrollTop);\n}\n\n/**\n * Gets the computed border widths (on all sides) in pixels\n * Copied from Closure's goog.style.getBorderBox\n *\n * @param element  The element to get the border widths for.\n * @returns The computed border widths.\n */\nexport function getBorderBox(element: Element): Rect {\n  const left = parseFloat(getComputedStyle(element, 'borderLeftWidth'));\n  const right = parseFloat(getComputedStyle(element, 'borderRightWidth'));\n  const top = parseFloat(getComputedStyle(element, 'borderTopWidth'));\n  const bottom = parseFloat(getComputedStyle(element, 'borderBottomWidth'));\n\n  return new Rect(top, bottom, left, right);\n}\n\n/**\n * Changes the scroll position of `container` with the minimum amount so\n * that the content and the borders of the given `element` become visible.\n * If the element is bigger than the container, its top left corner will be\n * aligned as close to the container's top left corner as possible.\n * Copied from Closure's goog.style.scrollIntoContainerView\n *\n * @param element The element to make visible.\n * @param container The container to scroll. If not set, then the document\n *     scroll element will be used.\n * @param opt_center Whether to center the element in the container.\n *     Defaults to false.\n */\nexport function scrollIntoContainerView(\n  element: Element,\n  container: Element,\n  opt_center?: boolean,\n) {\n  const offset = getContainerOffsetToScrollInto(element, container, opt_center);\n  container.scrollLeft = offset.x;\n  container.scrollTop = offset.y;\n}\n\n/**\n * Calculate the scroll position of `container` with the minimum amount so\n * that the content and the borders of the given `element` become visible.\n * If the element is bigger than the container, its top left corner will be\n * aligned as close to the container's top left corner as possible.\n * Copied from Closure's goog.style.getContainerOffsetToScrollInto\n *\n * @param element The element to make visible.\n * @param container The container to scroll. If not set, then the document\n *     scroll element will be used.\n * @param opt_center Whether to center the element in the container.\n *     Defaults to false.\n * @returns The new scroll position of the container.\n */\nexport function getContainerOffsetToScrollInto(\n  element: Element,\n  container: Element,\n  opt_center?: boolean,\n): Coordinate {\n  // Absolute position of the element's border's top left corner.\n  const elementPos = getPageOffset(element);\n  // Absolute position of the container's border's top left corner.\n  const containerPos = getPageOffset(container);\n  const containerBorder = getBorderBox(container);\n  // Relative pos. of the element's border box to the container's content box.\n  const relX = elementPos.x - containerPos.x - containerBorder.left;\n  const relY = elementPos.y - containerPos.y - containerBorder.top;\n  // How much the element can move in the container, i.e. the difference between\n  // the element's bottom-right-most and top-left-most position where it's\n  // fully visible.\n  const elementSize = getSizeWithDisplay(element);\n  const spaceX = container.clientWidth - elementSize.width;\n  const spaceY = container.clientHeight - elementSize.height;\n  let scrollLeft = container.scrollLeft;\n  let scrollTop = container.scrollTop;\n  if (opt_center) {\n    // All browsers round non-integer scroll positions down.\n    scrollLeft += relX - spaceX / 2;\n    scrollTop += relY - spaceY / 2;\n  } else {\n    // This formula was designed to give the correct scroll values in the\n    // following cases:\n    // - element is higher than container (spaceY < 0) => scroll down by relY\n    // - element is not higher that container (spaceY >= 0):\n    //   - it is above container (relY < 0) => scroll up by abs(relY)\n    //   - it is below container (relY > spaceY) => scroll down by relY - spaceY\n    //   - it is in the container => don't scroll\n    scrollLeft += Math.min(relX, Math.max(relX - spaceX, 0));\n    scrollTop += Math.min(relY, Math.max(relY - spaceY, 0));\n  }\n  return new Coordinate(scrollLeft, scrollTop);\n}\n\nexport const TEST_ONLY = {\n  getSizeInternal,\n};\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.utils.svgMath\n\nimport type {WorkspaceSvg} from '../workspace_svg.js';\n\nimport {Coordinate} from './coordinate.js';\nimport {Rect} from './rect.js';\nimport * as style from './style.js';\n\n/**\n * Static regex to pull the x,y values out of an SVG translate() directive.\n * Note that Firefox and IE (9,10) return 'translate(12)' instead of\n * 'translate(12, 0)'.\n * Note that IE (9,10) returns 'translate(16 8)' instead of 'translate(16, 8)'.\n * Note that IE has been reported to return scientific notation (0.123456e-42).\n */\nconst XY_REGEX = /translate\\(\\s*([-+\\d.e]+)([ ,]\\s*([-+\\d.e]+)\\s*)?/;\n\n/**\n * Static regex to pull the x,y values out of a translate() or translate3d()\n * style property.\n * Accounts for same exceptions as XY_REGEX.\n */\nconst XY_STYLE_REGEX =\n  /transform:\\s*translate(?:3d)?\\(\\s*([-+\\d.e]+)\\s*px([ ,]\\s*([-+\\d.e]+)\\s*px)?/;\n\n/**\n * Return the coordinates of the top-left corner of this element relative to\n * its parent.  Only for SVG elements and children (e.g. rect, g, path).\n *\n * @param element SVG element to find the coordinates of.\n * @returns Object with .x and .y properties.\n */\nexport function getRelativeXY(element: Element): Coordinate {\n  const xy = new Coordinate(0, 0);\n  // First, check for x and y attributes.\n  // Checking for the existence of x/y properties is faster than getAttribute.\n  // However, x/y contains an SVGAnimatedLength object, so rely on getAttribute\n  // to get the number.\n  const x = (element as any).x && element.getAttribute('x');\n  const y = (element as any).y && element.getAttribute('y');\n  if (x) {\n    xy.x = parseInt(x);\n  }\n  if (y) {\n    xy.y = parseInt(y);\n  }\n  // Second, check for transform=\"translate(...)\" attribute.\n  const transform = element.getAttribute('transform');\n  const r = transform && transform.match(XY_REGEX);\n  if (r) {\n    xy.x += Number(r[1]);\n    if (r[3]) {\n      xy.y += Number(r[3]);\n    }\n  }\n\n  // Then check for style = transform: translate(...) or translate3d(...)\n  const style = element.getAttribute('style');\n  if (style && style.indexOf('translate') > -1) {\n    const styleComponents = style.match(XY_STYLE_REGEX);\n    if (styleComponents) {\n      xy.x += Number(styleComponents[1]);\n      if (styleComponents[3]) {\n        xy.y += Number(styleComponents[3]);\n      }\n    }\n  }\n  return xy;\n}\n\n/**\n * Return the coordinates of the top-left corner of this element relative to\n * the div Blockly was injected into.\n *\n * @param element SVG element to find the coordinates of. If this is not a child\n *     of the div Blockly was injected into, the behaviour is undefined.\n * @returns Object with .x and .y properties.\n */\nexport function getInjectionDivXY(element: Element): Coordinate {\n  let x = 0;\n  let y = 0;\n  while (element) {\n    const xy = getRelativeXY(element);\n    x = x + xy.x;\n    y = y + xy.y;\n    const classes = element.getAttribute('class') || '';\n    if ((' ' + classes + ' ').indexOf(' injectionDiv ') !== -1) {\n      break;\n    }\n    element = element.parentNode as Element;\n  }\n  return new Coordinate(x, y);\n}\n\n/**\n * Get the position of the current viewport in window coordinates.  This takes\n * scroll into account.\n *\n * @returns An object containing window width, height, and scroll position in\n *     window coordinates.\n * @internal\n */\nexport function getViewportBBox(): Rect {\n  // Pixels, in window coordinates.\n  const scrollOffset = style.getViewportPageOffset();\n  return new Rect(\n    scrollOffset.y,\n    document.documentElement.clientHeight + scrollOffset.y,\n    scrollOffset.x,\n    document.documentElement.clientWidth + scrollOffset.x,\n  );\n}\n\n/**\n * Gets the document scroll distance as a coordinate object.\n * Copied from Closure's goog.dom.getDocumentScroll.\n *\n * @returns Object with values 'x' and 'y'.\n */\nexport function getDocumentScroll(): Coordinate {\n  const el = document.documentElement;\n  const win = window;\n  return new Coordinate(\n    win.pageXOffset || el.scrollLeft,\n    win.pageYOffset || el.scrollTop,\n  );\n}\n\n/**\n * Converts screen coordinates to workspace coordinates.\n *\n * @param ws The workspace to find the coordinates on.\n * @param screenCoordinates The screen coordinates to be converted to workspace\n *     coordinates\n * @returns The workspace coordinates.\n */\nexport function screenToWsCoordinates(\n  ws: WorkspaceSvg,\n  screenCoordinates: Coordinate,\n): Coordinate {\n  const screenX = screenCoordinates.x;\n  const screenY = screenCoordinates.y;\n\n  const injectionDiv = ws.getInjectionDiv();\n  // Bounding rect coordinates are in client coordinates, meaning that they\n  // are in pixels relative to the upper left corner of the visible browser\n  // window.  These coordinates change when you scroll the browser window.\n  const boundingRect = injectionDiv.getBoundingClientRect();\n\n  // The client coordinates offset by the injection div's upper left corner.\n  const clientOffsetPixels = new Coordinate(\n    screenX - boundingRect.left,\n    screenY - boundingRect.top,\n  );\n\n  // The offset in pixels between the main workspace's origin and the upper\n  // left corner of the injection div.\n  const mainOffsetPixels = ws.getOriginOffsetInPixels();\n\n  // The position of the new comment in pixels relative to the origin of the\n  // main workspace.\n  const finalOffsetPixels = Coordinate.difference(\n    clientOffsetPixels,\n    mainOffsetPixels,\n  );\n  // The position in main workspace coordinates.\n  const finalOffsetMainWs = finalOffsetPixels.scale(1 / ws.scale);\n  return finalOffsetMainWs;\n}\n\n/**\n * Converts workspace coordinates to screen coordinates.\n *\n * @param ws The workspace to get the coordinates out of.\n * @param workspaceCoordinates  The workspace coordinates to be converted\n *     to screen coordinates.\n * @returns The screen coordinates.\n */\nexport function wsToScreenCoordinates(\n  ws: WorkspaceSvg,\n  workspaceCoordinates: Coordinate,\n): Coordinate {\n  // Fix workspace scale vs browser scale.\n  const screenCoordinates = workspaceCoordinates.scale(ws.scale);\n  const screenX = screenCoordinates.x;\n  const screenY = screenCoordinates.y;\n\n  const injectionDiv = ws.getInjectionDiv();\n  const boundingRect = injectionDiv.getBoundingClientRect();\n  const mainOffset = ws.getOriginOffsetInPixels();\n\n  // Fix workspace origin vs browser origin.\n  return new Coordinate(\n    screenX + boundingRect.left + mainOffset.x,\n    screenY + boundingRect.top + mainOffset.y,\n  );\n}\n\nexport const TEST_ONLY = {\n  XY_REGEX,\n  XY_STYLE_REGEX,\n};\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.utils.xml\n\nlet domParser: DOMParser = {\n  parseFromString: function () {\n    throw new Error(\n      'DOMParser was not found in the global scope and was not properly ' +\n        'injected using injectDependencies',\n    );\n  },\n};\n\nlet xmlSerializer: XMLSerializer = {\n  serializeToString: function () {\n    throw new Error(\n      'XMLSerializer was not foundin the global scope and was not properly ' +\n        'injected using injectDependencies',\n    );\n  },\n};\n\n/**\n * Injected dependencies.  By default these are just (and have the\n * same types as) the corresponding DOM Window properties, but the\n * Node.js wrapper for Blockly (see scripts/package/node/core.js)\n * calls injectDependencies to supply implementations from the jsdom\n * package instead.\n */\nlet {document, DOMParser, XMLSerializer} = globalThis;\nif (DOMParser) domParser = new DOMParser();\nif (XMLSerializer) xmlSerializer = new XMLSerializer();\n\n/**\n * Inject implementations of document, DOMParser and/or XMLSerializer\n * to use instead of the default ones.\n *\n * Used by the Node.js wrapper for Blockly (see\n * scripts/package/node/core.js) to supply implementations from the\n * jsdom package instead.\n *\n * While they may be set individually, it is normally the case that\n * all three will be sourced from the same JSDOM instance.  They MUST\n * at least come from the same copy of the jsdom package.  (Typically\n * this is hard to avoid satsifying this requirement, but it can be\n * inadvertently violated by using webpack to build multiple bundles\n * containing Blockly and jsdom, and then loading more than one into\n * the same JavaScript runtime.  See\n * https://github.com/google/blockly-samples/pull/1452#issuecomment-1364442135\n * for an example of how this happened.)\n *\n * @param dependencies Options object containing dependencies to set.\n */\nexport function injectDependencies(dependencies: {\n  document?: Document;\n  DOMParser?: typeof DOMParser;\n  XMLSerializer?: typeof XMLSerializer;\n}) {\n  ({\n    // Default to existing value if option not supplied.\n    document = document,\n    DOMParser = DOMParser,\n    XMLSerializer = XMLSerializer,\n  } = dependencies);\n\n  domParser = new DOMParser();\n  xmlSerializer = new XMLSerializer();\n}\n\n/**\n * Namespace for Blockly's XML.\n */\nexport const NAME_SPACE = 'https://developers.google.com/blockly/xml';\n\n// eslint-disable-next-line no-control-regex\nconst INVALID_CONTROL_CHARS = /[\\x00-\\x09\\x0B\\x0C\\x0E-\\x1F]/g;\n\n/**\n * Create DOM element for XML.\n *\n * @param tagName Name of DOM element.\n * @returns New DOM element.\n */\nexport function createElement(tagName: string): Element {\n  return document.createElementNS(NAME_SPACE, tagName);\n}\n\n/**\n * Create text element for XML.\n *\n * @param text Text content.\n * @returns New DOM text node.\n */\nexport function createTextNode(text: string): Text {\n  return document.createTextNode(text);\n}\n\n/**\n * Converts an XML string into a DOM structure.\n *\n * Control characters should be escaped. (But we will try to best-effort parse\n * unescaped characters.)\n *\n * Note that even when escaped, U+0000 will be parsed as U+FFFD (the\n * \"replacement character\") because U+0000 is never a valid XML character\n * (even in XML 1.1).\n * https://www.w3.org/TR/xml11/#charsets\n *\n * @param text An XML string.\n * @returns A DOM object representing the singular child of the document\n *     element.\n * @throws if the text doesn't parse.\n */\nexport function textToDom(text: string): Element {\n  let doc = domParser.parseFromString(text, 'text/xml');\n  if (\n    doc &&\n    doc.documentElement &&\n    !doc.getElementsByTagName('parsererror').length\n  ) {\n    return doc.documentElement;\n  }\n\n  // Attempt to parse as HTML to deserialize control characters that were\n  // serialized before the serializer did proper escaping.\n  doc = domParser.parseFromString(text, 'text/html');\n  if (\n    doc &&\n    doc.body.firstChild &&\n    doc.body.firstChild.nodeName.toLowerCase() === 'xml'\n  ) {\n    return doc.body.firstChild as Element;\n  }\n\n  throw new Error(`DOMParser was unable to parse: ${text}`);\n}\n\n/**\n * Converts a DOM structure into plain text.\n * Currently the text format is fairly ugly: all one line with no whitespace.\n *\n * Control characters are escaped using their decimal encodings. This includes\n * U+0000 even though it is technically never a valid XML character (even in\n * XML 1.1).\n * https://www.w3.org/TR/xml11/#charsets\n *\n * When decoded U+0000 will be parsed as U+FFFD (the \"replacement character\").\n *\n * @param dom A tree of XML nodes.\n * @returns Text representation.\n */\nexport function domToText(dom: Node): string {\n  return sanitizeText(xmlSerializer.serializeToString(dom));\n}\n\nfunction sanitizeText(text: string) {\n  return text.replace(\n    INVALID_CONTROL_CHARS,\n    (match) => `&#${match.charCodeAt(0)};`,\n  );\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.utils.toolbox\n\nimport type {ConnectionState} from '../serialization/blocks.js';\nimport type {CssConfig as CategoryCssConfig} from '../toolbox/category.js';\nimport type {CssConfig as SeparatorCssConfig} from '../toolbox/separator.js';\nimport * as utilsXml from './xml.js';\n\n/**\n * The information needed to create a block in the toolbox.\n * Note that disabled has a different type for backwards compatibility.\n */\nexport interface BlockInfo {\n  kind: string;\n  blockxml?: string | Node;\n  type?: string;\n  gap?: string | number;\n  disabled?: string | boolean;\n  enabled?: boolean;\n  id?: string;\n  x?: number;\n  y?: number;\n  collapsed?: boolean;\n  inline?: boolean;\n  data?: string;\n  extraState?: AnyDuringMigration;\n  icons?: {[key: string]: AnyDuringMigration};\n  fields?: {[key: string]: AnyDuringMigration};\n  inputs?: {[key: string]: ConnectionState};\n  next?: ConnectionState;\n}\n\n/**\n * The information needed to create a separator in the toolbox.\n */\nexport interface SeparatorInfo {\n  kind: string;\n  id: string | undefined;\n  gap: number | undefined;\n  cssconfig: SeparatorCssConfig | undefined;\n}\n\n/**\n * The information needed to create a button in the toolbox.\n */\nexport interface ButtonInfo {\n  kind: string;\n  text: string;\n  callbackkey: string;\n}\n\n/**\n * The information needed to create a label in the toolbox.\n */\nexport interface LabelInfo {\n  kind: string;\n  text: string;\n  id: string | undefined;\n}\n\n/**\n * The information needed to create either a button or a label in the flyout.\n */\nexport type ButtonOrLabelInfo = ButtonInfo | LabelInfo;\n\n/**\n * The information needed to create a category in the toolbox.\n */\nexport interface StaticCategoryInfo {\n  kind: string;\n  name: string;\n  contents: ToolboxItemInfo[];\n  id: string | undefined;\n  categorystyle: string | undefined;\n  colour: string | undefined;\n  cssconfig: CategoryCssConfig | undefined;\n  hidden: string | undefined;\n  expanded?: string | boolean;\n}\n\n/**\n * The information needed to create a custom category.\n */\nexport interface DynamicCategoryInfo {\n  kind: string;\n  custom: string;\n  id: string | undefined;\n  categorystyle: string | undefined;\n  colour: string | undefined;\n  cssconfig: CategoryCssConfig | undefined;\n  hidden: string | undefined;\n  expanded?: string | boolean;\n}\n\n/**\n * The information needed to create either a dynamic or static category.\n */\nexport type CategoryInfo = StaticCategoryInfo | DynamicCategoryInfo;\n\n/**\n * Any information that can be used to create an item in the toolbox.\n */\nexport type ToolboxItemInfo = FlyoutItemInfo | StaticCategoryInfo;\n\n/**\n * All the different types that can be displayed in a flyout.\n */\nexport type FlyoutItemInfo =\n  | BlockInfo\n  | SeparatorInfo\n  | ButtonInfo\n  | LabelInfo\n  | DynamicCategoryInfo;\n\n/**\n * The JSON definition of a toolbox.\n */\nexport interface ToolboxInfo {\n  kind?: string;\n  contents: ToolboxItemInfo[];\n}\n\n/**\n * An array holding flyout items.\n */\nexport type FlyoutItemInfoArray = FlyoutItemInfo[];\n\n/**\n * All of the different types that can create a toolbox.\n */\nexport type ToolboxDefinition = Node | ToolboxInfo | string;\n\n/**\n * All of the different types that can be used to show items in a flyout.\n */\nexport type FlyoutDefinition =\n  | FlyoutItemInfoArray\n  | NodeList\n  | ToolboxInfo\n  | Node[];\n\n/**\n * The name used to identify a toolbox that has category like items.\n * This only needs to be used if a toolbox wants to be treated like a category\n * toolbox but does not actually contain any toolbox items with the kind\n * 'category'.\n */\nconst CATEGORY_TOOLBOX_KIND = 'categoryToolbox';\n\n/**\n * The name used to identify a toolbox that has no categories and is displayed\n * as a simple flyout displaying blocks, buttons, or labels.\n */\nconst FLYOUT_TOOLBOX_KIND = 'flyoutToolbox';\n\n/**\n * Position of the toolbox and/or flyout relative to the workspace.\n */\nexport enum Position {\n  TOP,\n  BOTTOM,\n  LEFT,\n  RIGHT,\n}\n\n/**\n * Converts the toolbox definition into toolbox JSON.\n *\n * @param toolboxDef The definition of the toolbox in one of its many forms.\n * @returns Object holding information for creating a toolbox.\n * @internal\n */\nexport function convertToolboxDefToJson(\n  toolboxDef: ToolboxDefinition | null,\n): ToolboxInfo | null {\n  if (!toolboxDef) {\n    return null;\n  }\n\n  if (toolboxDef instanceof Element || typeof toolboxDef === 'string') {\n    toolboxDef = parseToolboxTree(toolboxDef);\n    // AnyDuringMigration because:  Argument of type 'Node | null' is not\n    // assignable to parameter of type 'Node'.\n    toolboxDef = convertToToolboxJson(toolboxDef as AnyDuringMigration);\n  }\n\n  const toolboxJson = toolboxDef as ToolboxInfo;\n  validateToolbox(toolboxJson);\n  return toolboxJson;\n}\n\n/**\n * Validates the toolbox JSON fields have been set correctly.\n *\n * @param toolboxJson Object holding information for creating a toolbox.\n * @throws {Error} if the toolbox is not the correct format.\n */\nfunction validateToolbox(toolboxJson: ToolboxInfo) {\n  const toolboxKind = toolboxJson['kind'];\n  const toolboxContents = toolboxJson['contents'];\n\n  if (toolboxKind) {\n    if (\n      toolboxKind !== FLYOUT_TOOLBOX_KIND &&\n      toolboxKind !== CATEGORY_TOOLBOX_KIND\n    ) {\n      throw Error(\n        'Invalid toolbox kind ' +\n          toolboxKind +\n          '.' +\n          ' Please supply either ' +\n          FLYOUT_TOOLBOX_KIND +\n          ' or ' +\n          CATEGORY_TOOLBOX_KIND,\n      );\n    }\n  }\n  if (!toolboxContents) {\n    throw Error('Toolbox must have a contents attribute.');\n  }\n}\n\n/**\n * Converts the flyout definition into a list of flyout items.\n *\n * @param flyoutDef The definition of the flyout in one of its many forms.\n * @returns A list of flyout items.\n * @internal\n */\nexport function convertFlyoutDefToJsonArray(\n  flyoutDef: FlyoutDefinition | null,\n): FlyoutItemInfoArray {\n  if (!flyoutDef) {\n    return [];\n  }\n\n  if ((flyoutDef as AnyDuringMigration)['contents']) {\n    return (flyoutDef as AnyDuringMigration)['contents'];\n  }\n  // If it is already in the correct format return the flyoutDef.\n  // AnyDuringMigration because:  Property 'nodeType' does not exist on type\n  // 'Node | FlyoutItemInfo'.\n  if (\n    Array.isArray(flyoutDef) &&\n    flyoutDef.length > 0 &&\n    !(flyoutDef[0] as AnyDuringMigration).nodeType\n  ) {\n    // AnyDuringMigration because:  Type 'FlyoutItemInfoArray | Node[]' is not\n    // assignable to type 'FlyoutItemInfoArray'.\n    return flyoutDef as AnyDuringMigration;\n  }\n\n  // AnyDuringMigration because:  Type 'ToolboxItemInfo[] | FlyoutItemInfoArray'\n  // is not assignable to type 'FlyoutItemInfoArray'.\n  return xmlToJsonArray(flyoutDef as Node[] | NodeList) as AnyDuringMigration;\n}\n\n/**\n * Whether or not the toolbox definition has categories.\n *\n * @param toolboxJson Object holding information for creating a toolbox.\n * @returns True if the toolbox has categories.\n * @internal\n */\nexport function hasCategories(toolboxJson: ToolboxInfo | null): boolean {\n  return TEST_ONLY.hasCategoriesInternal(toolboxJson);\n}\n\n/**\n * Private version of hasCategories for stubbing in tests.\n */\nfunction hasCategoriesInternal(toolboxJson: ToolboxInfo | null): boolean {\n  if (!toolboxJson) {\n    return false;\n  }\n\n  const toolboxKind = toolboxJson['kind'];\n  if (toolboxKind) {\n    return toolboxKind === CATEGORY_TOOLBOX_KIND;\n  }\n\n  const categories = toolboxJson['contents'].filter(function (item) {\n    return item['kind'].toUpperCase() === 'CATEGORY';\n  });\n  return !!categories.length;\n}\n\n/**\n * Whether or not the category is collapsible.\n *\n * @param categoryInfo Object holing information for creating a category.\n * @returns True if the category has subcategories.\n * @internal\n */\nexport function isCategoryCollapsible(categoryInfo: CategoryInfo): boolean {\n  if (!categoryInfo || !(categoryInfo as AnyDuringMigration)['contents']) {\n    return false;\n  }\n\n  const categories = (categoryInfo as AnyDuringMigration)['contents'].filter(\n    function (item: AnyDuringMigration) {\n      return item['kind'].toUpperCase() === 'CATEGORY';\n    },\n  );\n  return !!categories.length;\n}\n\n/**\n * Parses the provided toolbox definition into a consistent format.\n *\n * @param toolboxDef The definition of the toolbox in one of its many forms.\n * @returns Object holding information for creating a toolbox.\n */\nfunction convertToToolboxJson(toolboxDef: Node): ToolboxInfo {\n  const contents = xmlToJsonArray(toolboxDef as Node | Node[]);\n  const toolboxJson = {'contents': contents};\n  if (toolboxDef instanceof Node) {\n    addAttributes(toolboxDef, toolboxJson);\n  }\n  return toolboxJson;\n}\n\n/**\n * Converts the xml for a toolbox to JSON.\n *\n * @param toolboxDef The definition of the toolbox in one of its many forms.\n * @returns A list of objects in the toolbox.\n */\nfunction xmlToJsonArray(\n  toolboxDef: Node | Node[] | NodeList,\n): FlyoutItemInfoArray | ToolboxItemInfo[] {\n  const arr = [];\n  // If it is a node it will have children.\n  // AnyDuringMigration because:  Property 'childNodes' does not exist on type\n  // 'Node | NodeList | Node[]'.\n  let childNodes = (toolboxDef as AnyDuringMigration).childNodes;\n  if (!childNodes) {\n    // Otherwise the toolboxDef is an array or collection.\n    childNodes = toolboxDef;\n  }\n  for (let i = 0, child; (child = childNodes[i]); i++) {\n    if (!child.tagName) {\n      continue;\n    }\n    const obj = {};\n    const tagName = child.tagName.toUpperCase();\n    (obj as AnyDuringMigration)['kind'] = tagName;\n\n    // Store the XML for a block.\n    if (tagName === 'BLOCK') {\n      (obj as AnyDuringMigration)['blockxml'] = child;\n    } else if (child.childNodes && child.childNodes.length > 0) {\n      // Get the contents of a category\n      (obj as AnyDuringMigration)['contents'] = xmlToJsonArray(child);\n    }\n\n    // Add XML attributes to object\n    addAttributes(child, obj);\n    arr.push(obj);\n  }\n  // AnyDuringMigration because:  Type '{}[]' is not assignable to type\n  // 'ToolboxItemInfo[] | FlyoutItemInfoArray'.\n  return arr as AnyDuringMigration;\n}\n\n/**\n * Adds the attributes on the node to the given object.\n *\n * @param node The node to copy the attributes from.\n * @param obj The object to copy the attributes to.\n */\nfunction addAttributes(node: Node, obj: AnyDuringMigration) {\n  // AnyDuringMigration because:  Property 'attributes' does not exist on type\n  // 'Node'.\n  for (let j = 0; j < (node as AnyDuringMigration).attributes.length; j++) {\n    // AnyDuringMigration because:  Property 'attributes' does not exist on type\n    // 'Node'.\n    const attr = (node as AnyDuringMigration).attributes[j];\n    if (attr.nodeName.indexOf('css-') > -1) {\n      obj['cssconfig'] = obj['cssconfig'] || {};\n      obj['cssconfig'][attr.nodeName.replace('css-', '')] = attr.value;\n    } else {\n      obj[attr.nodeName] = attr.value;\n    }\n  }\n}\n\n/**\n * Parse the provided toolbox tree into a consistent DOM format.\n *\n * @param toolboxDef DOM tree of blocks, or text representation of same.\n * @returns DOM tree of blocks, or null.\n */\nexport function parseToolboxTree(\n  toolboxDef: Element | null | string,\n): Element | null {\n  let parsedToolboxDef: Element | null = null;\n  if (toolboxDef) {\n    if (typeof toolboxDef === 'string') {\n      parsedToolboxDef = utilsXml.textToDom(toolboxDef);\n      if (parsedToolboxDef.nodeName.toLowerCase() !== 'xml') {\n        throw TypeError('Toolbox should be an <xml> document.');\n      }\n    } else if (toolboxDef instanceof Element) {\n      parsedToolboxDef = toolboxDef;\n    }\n  }\n  return parsedToolboxDef;\n}\n\nexport const TEST_ONLY = {\n  hasCategoriesInternal,\n};\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.uiPosition\n\nimport type {UiMetrics} from './metrics_manager.js';\nimport {Scrollbar} from './scrollbar.js';\nimport {Rect} from './utils/rect.js';\nimport type {Size} from './utils/size.js';\nimport * as toolbox from './utils/toolbox.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Enum for vertical positioning.\n *\n * @internal\n */\nexport enum verticalPosition {\n  TOP,\n  BOTTOM,\n}\n\n/**\n * Enum for horizontal positioning.\n *\n * @internal\n */\nexport enum horizontalPosition {\n  LEFT,\n  RIGHT,\n}\n\n/**\n * An object defining a horizontal and vertical positioning.\n *\n * @internal\n */\nexport interface Position {\n  horizontal: horizontalPosition;\n  vertical: verticalPosition;\n}\n\n/**\n * Enum for bump rules to use for dealing with collisions.\n *\n * @internal\n */\nexport enum bumpDirection {\n  UP,\n  DOWN,\n}\n\n/**\n * Returns a rectangle representing reasonable position for where to place a UI\n * element of the specified size given the restraints and locations of the\n * scrollbars. This method does not take into account any already placed UI\n * elements.\n *\n * @param position The starting horizontal and vertical position.\n * @param size the size of the UI element to get a start position for.\n * @param horizontalPadding The horizontal padding to use.\n * @param verticalPadding The vertical padding to use.\n * @param metrics The workspace UI metrics.\n * @param workspace The workspace.\n * @returns The suggested start position.\n * @internal\n */\nexport function getStartPositionRect(\n  position: Position,\n  size: Size,\n  horizontalPadding: number,\n  verticalPadding: number,\n  metrics: UiMetrics,\n  workspace: WorkspaceSvg,\n): Rect {\n  // Horizontal positioning.\n  let left = 0;\n  const hasVerticalScrollbar =\n    workspace.scrollbar && workspace.scrollbar.canScrollVertically();\n  if (position.horizontal === horizontalPosition.LEFT) {\n    left = metrics.absoluteMetrics.left + horizontalPadding;\n    if (hasVerticalScrollbar && workspace.RTL) {\n      left += Scrollbar.scrollbarThickness;\n    }\n  } else {\n    // position.horizontal === horizontalPosition.RIGHT\n    left =\n      metrics.absoluteMetrics.left +\n      metrics.viewMetrics.width -\n      size.width -\n      horizontalPadding;\n    if (hasVerticalScrollbar && !workspace.RTL) {\n      left -= Scrollbar.scrollbarThickness;\n    }\n  }\n  // Vertical positioning.\n  let top = 0;\n  if (position.vertical === verticalPosition.TOP) {\n    top = metrics.absoluteMetrics.top + verticalPadding;\n  } else {\n    // position.vertical === verticalPosition.BOTTOM\n    top =\n      metrics.absoluteMetrics.top +\n      metrics.viewMetrics.height -\n      size.height -\n      verticalPadding;\n    if (workspace.scrollbar && workspace.scrollbar.canScrollHorizontally()) {\n      // The scrollbars are always positioned on the bottom if they exist.\n      top -= Scrollbar.scrollbarThickness;\n    }\n  }\n  return new Rect(top, top + size.height, left, left + size.width);\n}\n\n/**\n * Returns a corner position that is on the opposite side of the workspace from\n * the toolbox.\n * If in horizontal orientation, defaults to the bottom corner. If in vertical\n * orientation, defaults to the right corner.\n *\n * @param workspace The workspace.\n * @param metrics The workspace metrics.\n * @returns The suggested corner position.\n * @internal\n */\nexport function getCornerOppositeToolbox(\n  workspace: WorkspaceSvg,\n  metrics: UiMetrics,\n): Position {\n  const leftCorner =\n    metrics.toolboxMetrics.position !== toolbox.Position.LEFT &&\n    (!workspace.horizontalLayout || workspace.RTL);\n  const topCorner = metrics.toolboxMetrics.position === toolbox.Position.BOTTOM;\n  const hPosition = leftCorner\n    ? horizontalPosition.LEFT\n    : horizontalPosition.RIGHT;\n  const vPosition = topCorner ? verticalPosition.TOP : verticalPosition.BOTTOM;\n  return {horizontal: hPosition, vertical: vPosition};\n}\n\n/**\n * Returns a position Rect based on a starting position that is bumped\n * so that it doesn't intersect with any of the provided savedPositions. This\n * method does not check that the bumped position is still within bounds.\n *\n * @param startRect The starting position to use.\n * @param margin The margin to use between elements when bumping.\n * @param bumpDir The direction to bump if there is a collision with an existing\n *     UI element.\n * @param savedPositions List of rectangles that represent the positions of UI\n *     elements already placed.\n * @returns The suggested position rectangle.\n * @internal\n */\nexport function bumpPositionRect(\n  startRect: Rect,\n  margin: number,\n  bumpDir: bumpDirection,\n  savedPositions: Rect[],\n): Rect {\n  let top = startRect.top;\n  const left = startRect.left;\n  const width = startRect.right - startRect.left;\n  const height = startRect.bottom - startRect.top;\n\n  // Check for collision and bump if needed.\n  let boundingRect = startRect;\n  for (let i = 0; i < savedPositions.length; i++) {\n    const otherEl = savedPositions[i];\n    if (boundingRect.intersects(otherEl)) {\n      if (bumpDir === bumpDirection.UP) {\n        top = otherEl.top - height - margin;\n      } else {\n        // bumpDir === bumpDirection.DOWN\n        top = otherEl.bottom + margin;\n      }\n      // Recheck other savedPositions\n      boundingRect = new Rect(top, top + height, left, left + width);\n      i = -1;\n    }\n  }\n  return boundingRect;\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.dialog\n\nlet alertImplementation = function (\n  message: string,\n  opt_callback?: () => void,\n) {\n  window.alert(message);\n  if (opt_callback) {\n    opt_callback();\n  }\n};\n\nlet confirmImplementation = function (\n  message: string,\n  callback: (result: boolean) => void,\n) {\n  callback(window.confirm(message));\n};\n\nlet promptImplementation = function (\n  message: string,\n  defaultValue: string,\n  callback: (result: string | null) => void,\n) {\n  callback(window.prompt(message, defaultValue));\n};\n\n/**\n * Wrapper to window.alert() that app developers may override via setAlert to\n * provide alternatives to the modal browser window.\n *\n * @param message The message to display to the user.\n * @param opt_callback The callback when the alert is dismissed.\n */\nexport function alert(message: string, opt_callback?: () => void) {\n  alertImplementation(message, opt_callback);\n}\n\n/**\n * Sets the function to be run when Blockly.dialog.alert() is called.\n *\n * @param alertFunction The function to be run.\n * @see Blockly.dialog.alert\n */\nexport function setAlert(alertFunction: (p1: string, p2?: () => void) => void) {\n  alertImplementation = alertFunction;\n}\n\n/**\n * Wrapper to window.confirm() that app developers may override via setConfirm\n * to provide alternatives to the modal browser window.\n *\n * @param message The message to display to the user.\n * @param callback The callback for handling user response.\n */\nexport function confirm(message: string, callback: (p1: boolean) => void) {\n  TEST_ONLY.confirmInternal(message, callback);\n}\n\n/**\n * Private version of confirm for stubbing in tests.\n */\nfunction confirmInternal(message: string, callback: (p1: boolean) => void) {\n  confirmImplementation(message, callback);\n}\n\n/**\n * Sets the function to be run when Blockly.dialog.confirm() is called.\n *\n * @param confirmFunction The function to be run.\n * @see Blockly.dialog.confirm\n */\nexport function setConfirm(\n  confirmFunction: (p1: string, p2: (p1: boolean) => void) => void,\n) {\n  confirmImplementation = confirmFunction;\n}\n\n/**\n * Wrapper to window.prompt() that app developers may override via setPrompt to\n * provide alternatives to the modal browser window. Built-in browser prompts\n * are often used for better text input experience on mobile device. We strongly\n * recommend testing mobile when overriding this.\n *\n * @param message The message to display to the user.\n * @param defaultValue The value to initialize the prompt with.\n * @param callback The callback for handling user response.\n */\nexport function prompt(\n  message: string,\n  defaultValue: string,\n  callback: (p1: string | null) => void,\n) {\n  promptImplementation(message, defaultValue, callback);\n}\n\n/**\n * Sets the function to be run when Blockly.dialog.prompt() is called.\n *\n * @param promptFunction The function to be run.\n * @see Blockly.dialog.prompt\n */\nexport function setPrompt(\n  promptFunction: (\n    p1: string,\n    p2: string,\n    p3: (p1: string | null) => void,\n  ) => void,\n) {\n  promptImplementation = promptFunction;\n}\n\nexport const TEST_ONLY = {\n  confirmInternal,\n};\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {VariableModel} from '../variable_model.js';\nimport {IParameterModel} from './i_parameter_model.js';\n\n/** Interface for a parameter model that holds a variable model. */\nexport interface IVariableBackedParameterModel extends IParameterModel {\n  /** Returns the variable model held by this type. */\n  getVariableModel(): VariableModel;\n}\n\n/**\n * Returns whether the given object is a variable holder or not.\n */\nexport function isVariableBackedParameterModel(\n  param: IParameterModel,\n): param is IVariableBackedParameterModel {\n  return (param as any).getVariableModel !== undefined;\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Legacy means of representing a procedure signature. The elements are\n * respectively: name, parameter names, and whether it has a return value.\n */\nexport type ProcedureTuple = [string, string[], boolean];\n\n/**\n * Procedure block type.\n *\n * @internal\n */\nexport interface ProcedureBlock {\n  getProcedureCall: () => string;\n  renameProcedure: (p1: string, p2: string) => void;\n  getProcedureDef: () => ProcedureTuple;\n}\n\n/** @internal */\nexport interface LegacyProcedureDefBlock {\n  getProcedureDef: () => ProcedureTuple;\n}\n\n/** @internal */\nexport function isLegacyProcedureDefBlock(\n  block: Object,\n): block is LegacyProcedureDefBlock {\n  return (block as any).getProcedureDef !== undefined;\n}\n\n/** @internal */\nexport interface LegacyProcedureCallBlock {\n  getProcedureCall: () => string;\n  renameProcedure: (p1: string, p2: string) => void;\n}\n\n/** @internal */\nexport function isLegacyProcedureCallBlock(\n  block: Object,\n): block is LegacyProcedureCallBlock {\n  return (\n    (block as any).getProcedureCall !== undefined &&\n    (block as any).renameProcedure !== undefined\n  );\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.Variables\n\nimport {Blocks} from './blocks.js';\nimport * as dialog from './dialog.js';\nimport {isVariableBackedParameterModel} from './interfaces/i_variable_backed_parameter_model.js';\nimport {Msg} from './msg.js';\nimport {isLegacyProcedureDefBlock} from './interfaces/i_legacy_procedure_blocks.js';\nimport * as utilsXml from './utils/xml.js';\nimport {VariableModel} from './variable_model.js';\nimport type {Workspace} from './workspace.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * String for use in the \"custom\" attribute of a category in toolbox XML.\n * This string indicates that the category should be dynamically populated with\n * variable blocks.\n * See also Blockly.Procedures.CATEGORY_NAME and\n * Blockly.VariablesDynamic.CATEGORY_NAME.\n */\nexport const CATEGORY_NAME = 'VARIABLE';\n\n/**\n * Find all user-created variables that are in use in the workspace.\n * For use by generators.\n * To get a list of all variables on a workspace, including unused variables,\n * call Workspace.getAllVariables.\n *\n * @param ws The workspace to search for variables.\n * @returns Array of variable models.\n */\nexport function allUsedVarModels(ws: Workspace): VariableModel[] {\n  const blocks = ws.getAllBlocks(false);\n  const variables = new Set<VariableModel>();\n  // Iterate through every block and add each variable to the set.\n  for (let i = 0; i < blocks.length; i++) {\n    const blockVariables = blocks[i].getVarModels();\n    if (blockVariables) {\n      for (let j = 0; j < blockVariables.length; j++) {\n        const variable = blockVariables[j];\n        const id = variable.getId();\n        if (id) {\n          variables.add(variable);\n        }\n      }\n    }\n  }\n  // Convert the set into a list.\n  return Array.from(variables.values());\n}\n\n/**\n * Find all developer variables used by blocks in the workspace.\n * Developer variables are never shown to the user, but are declared as global\n * variables in the generated code.\n * To declare developer variables, define the getDeveloperVariables function on\n * your block and return a list of variable names.\n * For use by generators.\n *\n * @param workspace The workspace to search.\n * @returns A list of non-duplicated variable names.\n */\nexport function allDeveloperVariables(workspace: Workspace): string[] {\n  const blocks = workspace.getAllBlocks(false);\n  const variables = new Set<string>();\n  for (let i = 0, block; (block = blocks[i]); i++) {\n    const getDeveloperVariables = block.getDeveloperVariables;\n    if (getDeveloperVariables) {\n      const devVars = getDeveloperVariables();\n      for (let j = 0; j < devVars.length; j++) {\n        variables.add(devVars[j]);\n      }\n    }\n  }\n  // Convert the set into a list.\n  return Array.from(variables.values());\n}\n\n/**\n * Construct the elements (blocks and button) required by the flyout for the\n * variable category.\n *\n * @param workspace The workspace containing variables.\n * @returns Array of XML elements.\n */\nexport function flyoutCategory(workspace: WorkspaceSvg): Element[] {\n  let xmlList = new Array<Element>();\n  const button = document.createElement('button');\n  button.setAttribute('text', '%{BKY_NEW_VARIABLE}');\n  button.setAttribute('callbackKey', 'CREATE_VARIABLE');\n\n  workspace.registerButtonCallback('CREATE_VARIABLE', function (button) {\n    createVariableButtonHandler(button.getTargetWorkspace());\n  });\n\n  xmlList.push(button);\n\n  const blockList = flyoutCategoryBlocks(workspace);\n  xmlList = xmlList.concat(blockList);\n  return xmlList;\n}\n\n/**\n * Construct the blocks required by the flyout for the variable category.\n *\n * @param workspace The workspace containing variables.\n * @returns Array of XML block elements.\n */\nexport function flyoutCategoryBlocks(workspace: Workspace): Element[] {\n  const variableModelList = workspace.getVariablesOfType('');\n\n  const xmlList = [];\n  if (variableModelList.length > 0) {\n    // New variables are added to the end of the variableModelList.\n    const mostRecentVariable = variableModelList[variableModelList.length - 1];\n    if (Blocks['variables_set']) {\n      const block = utilsXml.createElement('block');\n      block.setAttribute('type', 'variables_set');\n      block.setAttribute('gap', Blocks['math_change'] ? '8' : '24');\n      block.appendChild(generateVariableFieldDom(mostRecentVariable));\n      xmlList.push(block);\n    }\n    if (Blocks['math_change']) {\n      const block = utilsXml.createElement('block');\n      block.setAttribute('type', 'math_change');\n      block.setAttribute('gap', Blocks['variables_get'] ? '20' : '8');\n      block.appendChild(generateVariableFieldDom(mostRecentVariable));\n      const value = utilsXml.textToDom(\n        '<value name=\"DELTA\">' +\n          '<shadow type=\"math_number\">' +\n          '<field name=\"NUM\">1</field>' +\n          '</shadow>' +\n          '</value>',\n      );\n      block.appendChild(value);\n      xmlList.push(block);\n    }\n\n    if (Blocks['variables_get']) {\n      variableModelList.sort(VariableModel.compareByName);\n      for (let i = 0, variable; (variable = variableModelList[i]); i++) {\n        const block = utilsXml.createElement('block');\n        block.setAttribute('type', 'variables_get');\n        block.setAttribute('gap', '8');\n        block.appendChild(generateVariableFieldDom(variable));\n        xmlList.push(block);\n      }\n    }\n  }\n  return xmlList;\n}\n\nexport const VAR_LETTER_OPTIONS = 'ijkmnopqrstuvwxyzabcdefgh';\n\n/**\n * Return a new variable name that is not yet being used. This will try to\n * generate single letter variable names in the range 'i' to 'z' to start with.\n * If no unique name is located it will try 'i' to 'z', 'a' to 'h',\n * then 'i2' to 'z2' etc.  Skip 'l'.\n *\n * @param workspace The workspace to be unique in.\n * @returns New variable name.\n */\nexport function generateUniqueName(workspace: Workspace): string {\n  return TEST_ONLY.generateUniqueNameInternal(workspace);\n}\n\n/**\n * Private version of generateUniqueName for stubbing in tests.\n */\nfunction generateUniqueNameInternal(workspace: Workspace): string {\n  return generateUniqueNameFromOptions(\n    VAR_LETTER_OPTIONS.charAt(0),\n    workspace.getAllVariableNames(),\n  );\n}\n\n/**\n * Returns a unique name that is not present in the usedNames array. This\n * will try to generate single letter names in the range a - z (skip l). It\n * will start with the character passed to startChar.\n *\n * @param startChar The character to start the search at.\n * @param usedNames A list of all of the used names.\n * @returns A unique name that is not present in the usedNames array.\n */\nexport function generateUniqueNameFromOptions(\n  startChar: string,\n  usedNames: string[],\n): string {\n  if (!usedNames.length) {\n    return startChar;\n  }\n\n  const letters = VAR_LETTER_OPTIONS;\n  let suffix = '';\n  let letterIndex = letters.indexOf(startChar);\n  let potName = startChar;\n\n  // eslint-disable-next-line no-constant-condition\n  while (true) {\n    let inUse = false;\n    for (let i = 0; i < usedNames.length; i++) {\n      if (usedNames[i].toLowerCase() === potName) {\n        inUse = true;\n        break;\n      }\n    }\n    if (!inUse) {\n      break;\n    }\n\n    letterIndex++;\n    if (letterIndex === letters.length) {\n      // Reached the end of the character sequence so back to 'i'.\n      letterIndex = 0;\n      suffix = `${Number(suffix) + 1}`;\n    }\n    potName = letters.charAt(letterIndex) + suffix;\n  }\n  return potName;\n}\n\n/**\n * Handles \"Create Variable\" button in the default variables toolbox category.\n * It will prompt the user for a variable name, including re-prompts if a name\n * is already in use among the workspace's variables.\n *\n * Custom button handlers can delegate to this function, allowing variables\n * types and after-creation processing. More complex customization (e.g.,\n * prompting for variable type) is beyond the scope of this function.\n *\n * @param workspace The workspace on which to create the variable.\n * @param opt_callback A callback. It will be passed an acceptable new variable\n *     name, or null if change is to be aborted (cancel button), or undefined if\n *     an existing variable was chosen.\n * @param opt_type The type of the variable like 'int', 'string', or ''. This\n *     will default to '', which is a specific type.\n */\nexport function createVariableButtonHandler(\n  workspace: Workspace,\n  opt_callback?: (p1?: string | null) => void,\n  opt_type?: string,\n) {\n  const type = opt_type || '';\n  // This function needs to be named so it can be called recursively.\n  function promptAndCheckWithAlert(defaultName: string) {\n    promptName(Msg['NEW_VARIABLE_TITLE'], defaultName, function (text) {\n      if (!text) {\n        // User canceled prompt.\n        if (opt_callback) opt_callback(null);\n        return;\n      }\n\n      const existing = nameUsedWithAnyType(text, workspace);\n      if (!existing) {\n        // No conflict\n        workspace.createVariable(text, type);\n        if (opt_callback) opt_callback(text);\n        return;\n      }\n\n      let msg;\n      if (existing.type === type) {\n        msg = Msg['VARIABLE_ALREADY_EXISTS'].replace('%1', existing.name);\n      } else {\n        msg = Msg['VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE'];\n        msg = msg.replace('%1', existing.name).replace('%2', existing.type);\n      }\n      dialog.alert(msg, function () {\n        promptAndCheckWithAlert(text);\n      });\n    });\n  }\n  promptAndCheckWithAlert('');\n}\n\n/**\n * Opens a prompt that allows the user to enter a new name for a variable.\n * Triggers a rename if the new name is valid. Or re-prompts if there is a\n * collision.\n *\n * @param workspace The workspace on which to rename the variable.\n * @param variable Variable to rename.\n * @param opt_callback A callback. It will be passed an acceptable new variable\n *     name, or null if change is to be aborted (cancel button), or undefined if\n *     an existing variable was chosen.\n */\nexport function renameVariable(\n  workspace: Workspace,\n  variable: VariableModel,\n  opt_callback?: (p1?: string | null) => void,\n) {\n  // This function needs to be named so it can be called recursively.\n  function promptAndCheckWithAlert(defaultName: string) {\n    const promptText = Msg['RENAME_VARIABLE_TITLE'].replace(\n      '%1',\n      variable.name,\n    );\n    promptName(promptText, defaultName, function (newName) {\n      if (!newName) {\n        // User canceled prompt.\n        if (opt_callback) opt_callback(null);\n        return;\n      }\n\n      const existing = nameUsedWithOtherType(newName, variable.type, workspace);\n      const procedure = nameUsedWithConflictingParam(\n        variable.name,\n        newName,\n        workspace,\n      );\n      if (!existing && !procedure) {\n        // No conflict.\n        workspace.renameVariableById(variable.getId(), newName);\n        if (opt_callback) opt_callback(newName);\n        return;\n      }\n\n      let msg = '';\n      if (existing) {\n        msg = Msg['VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE']\n          .replace('%1', existing.name)\n          .replace('%2', existing.type);\n      } else if (procedure) {\n        msg = Msg['VARIABLE_ALREADY_EXISTS_FOR_A_PARAMETER']\n          .replace('%1', newName)\n          .replace('%2', procedure);\n      }\n      dialog.alert(msg, function () {\n        promptAndCheckWithAlert(newName);\n      });\n    });\n  }\n  promptAndCheckWithAlert('');\n}\n\n/**\n * Prompt the user for a new variable name.\n *\n * @param promptText The string of the prompt.\n * @param defaultText The default value to show in the prompt's field.\n * @param callback A callback. It will be passed the new variable name, or null\n *     if the user picked something illegal.\n */\nexport function promptName(\n  promptText: string,\n  defaultText: string,\n  callback: (p1: string | null) => void,\n) {\n  dialog.prompt(promptText, defaultText, function (newVar) {\n    // Merge runs of whitespace.  Strip leading and trailing whitespace.\n    // Beyond this, all names are legal.\n    if (newVar) {\n      newVar = newVar.replace(/[\\s\\xa0]+/g, ' ').trim();\n      if (newVar === Msg['RENAME_VARIABLE'] || newVar === Msg['NEW_VARIABLE']) {\n        // Ok, not ALL names are legal...\n        newVar = null;\n      }\n    }\n    callback(newVar);\n  });\n}\n/**\n * Check whether there exists a variable with the given name but a different\n * type.\n *\n * @param name The name to search for.\n * @param type The type to exclude from the search.\n * @param workspace The workspace to search for the variable.\n * @returns The variable with the given name and a different type, or null if\n *     none was found.\n */\nfunction nameUsedWithOtherType(\n  name: string,\n  type: string,\n  workspace: Workspace,\n): VariableModel | null {\n  const allVariables = workspace.getVariableMap().getAllVariables();\n\n  name = name.toLowerCase();\n  for (let i = 0, variable; (variable = allVariables[i]); i++) {\n    if (variable.name.toLowerCase() === name && variable.type !== type) {\n      return variable;\n    }\n  }\n  return null;\n}\n\n/**\n * Check whether there exists a variable with the given name of any type.\n *\n * @param name The name to search for.\n * @param workspace The workspace to search for the variable.\n * @returns The variable with the given name, or null if none was found.\n */\nexport function nameUsedWithAnyType(\n  name: string,\n  workspace: Workspace,\n): VariableModel | null {\n  const allVariables = workspace.getVariableMap().getAllVariables();\n\n  name = name.toLowerCase();\n  for (let i = 0, variable; (variable = allVariables[i]); i++) {\n    if (variable.name.toLowerCase() === name) {\n      return variable;\n    }\n  }\n  return null;\n}\n\n/**\n * Returns the name of the procedure with a conflicting parameter name, or null\n * if one does not exist.\n *\n * This checks the procedure map if it contains models, and the legacy procedure\n * blocks otherwise.\n *\n * @param oldName The old name of the variable.\n * @param newName The proposed name of the variable.\n * @param workspace The workspace to search for conflicting parameters.\n * @internal\n */\nexport function nameUsedWithConflictingParam(\n  oldName: string,\n  newName: string,\n  workspace: Workspace,\n): string | null {\n  return workspace.getProcedureMap().getProcedures().length\n    ? checkForConflictingParamWithProcedureModels(oldName, newName, workspace)\n    : checkForConflictingParamWithLegacyProcedures(oldName, newName, workspace);\n}\n\n/**\n * Returns the name of the procedure model with a conflicting param name, or\n * null if one does not exist.\n */\nfunction checkForConflictingParamWithProcedureModels(\n  oldName: string,\n  newName: string,\n  workspace: Workspace,\n): string | null {\n  oldName = oldName.toLowerCase();\n  newName = newName.toLowerCase();\n\n  const procedures = workspace.getProcedureMap().getProcedures();\n  for (const procedure of procedures) {\n    const params = procedure\n      .getParameters()\n      .filter(isVariableBackedParameterModel)\n      .map((param) => param.getVariableModel().name);\n    if (!params) continue;\n    const procHasOld = params.some((param) => param.toLowerCase() === oldName);\n    const procHasNew = params.some((param) => param.toLowerCase() === newName);\n    if (procHasOld && procHasNew) return procedure.getName();\n  }\n  return null;\n}\n\n/**\n * Returns the name of the procedure block with a conflicting param name, or\n * null if one does not exist.\n */\nfunction checkForConflictingParamWithLegacyProcedures(\n  oldName: string,\n  newName: string,\n  workspace: Workspace,\n): string | null {\n  oldName = oldName.toLowerCase();\n  newName = newName.toLowerCase();\n\n  const blocks = workspace.getAllBlocks(false);\n  for (const block of blocks) {\n    if (!isLegacyProcedureDefBlock(block)) continue;\n    const def = block.getProcedureDef();\n    const params = def[1];\n    const blockHasOld = params.some((param) => param.toLowerCase() === oldName);\n    const blockHasNew = params.some((param) => param.toLowerCase() === newName);\n    if (blockHasOld && blockHasNew) return def[0];\n  }\n  return null;\n}\n\n/**\n * Generate DOM objects representing a variable field.\n *\n * @param variableModel The variable model to represent.\n * @returns The generated DOM.\n */\nexport function generateVariableFieldDom(\n  variableModel: VariableModel,\n): Element {\n  /* Generates the following XML:\n   * <field name=\"VAR\" id=\"goKTKmYJ8DhVHpruv\" variabletype=\"int\">foo</field>\n   */\n  const field = utilsXml.createElement('field');\n  field.setAttribute('name', 'VAR');\n  field.setAttribute('id', variableModel.getId());\n  field.setAttribute('variabletype', variableModel.type);\n  const name = utilsXml.createTextNode(variableModel.name);\n  field.appendChild(name);\n  return field;\n}\n\n/**\n * Helper function to look up or create a variable on the given workspace.\n * If no variable exists, creates and returns it.\n *\n * @param workspace The workspace to search for the variable.  It may be a\n *     flyout workspace or main workspace.\n * @param id The ID to use to look up or create the variable, or null.\n * @param opt_name The string to use to look up or create the variable.\n * @param opt_type The type to use to look up or create the variable.\n * @returns The variable corresponding to the given ID or name + type\n *     combination.\n */\nexport function getOrCreateVariablePackage(\n  workspace: Workspace,\n  id: string | null,\n  opt_name?: string,\n  opt_type?: string,\n): VariableModel {\n  let variable = getVariable(workspace, id, opt_name, opt_type);\n  if (!variable) {\n    variable = createVariable(workspace, id, opt_name, opt_type);\n  }\n  return variable;\n}\n\n/**\n * Look up  a variable on the given workspace.\n * Always looks in the main workspace before looking in the flyout workspace.\n * Always prefers lookup by ID to lookup by name + type.\n *\n * @param workspace The workspace to search for the variable.  It may be a\n *     flyout workspace or main workspace.\n * @param id The ID to use to look up the variable, or null.\n * @param opt_name The string to use to look up the variable.\n *     Only used if lookup by ID fails.\n * @param opt_type The type to use to look up the variable.\n *     Only used if lookup by ID fails.\n * @returns The variable corresponding to the given ID or name + type\n *     combination, or null if not found.\n */\nexport function getVariable(\n  workspace: Workspace,\n  id: string | null,\n  opt_name?: string,\n  opt_type?: string,\n): VariableModel | null {\n  const potentialVariableMap = workspace.getPotentialVariableMap();\n  let variable = null;\n  // Try to just get the variable, by ID if possible.\n  if (id) {\n    // Look in the real variable map before checking the potential variable map.\n    variable = workspace.getVariableById(id);\n    if (!variable && potentialVariableMap) {\n      variable = potentialVariableMap.getVariableById(id);\n    }\n    if (variable) {\n      return variable;\n    }\n  }\n  // If there was no ID, or there was an ID but it didn't match any variables,\n  // look up by name and type.\n  if (opt_name) {\n    if (opt_type === undefined) {\n      throw Error('Tried to look up a variable by name without a type');\n    }\n    // Otherwise look up by name and type.\n    variable = workspace.getVariable(opt_name, opt_type);\n    if (!variable && potentialVariableMap) {\n      variable = potentialVariableMap.getVariable(opt_name, opt_type);\n    }\n  }\n  return variable;\n}\n\n/**\n * Helper function to create a variable on the given workspace.\n *\n * @param workspace The workspace in which to create the variable.  It may be a\n *     flyout workspace or main workspace.\n * @param id The ID to use to create the variable, or null.\n * @param opt_name The string to use to create the variable.\n * @param opt_type The type to use to create the variable.\n * @returns The variable corresponding to the given ID or name + type\n *     combination.\n */\nfunction createVariable(\n  workspace: Workspace,\n  id: string | null,\n  opt_name?: string,\n  opt_type?: string,\n): VariableModel {\n  const potentialVariableMap = workspace.getPotentialVariableMap();\n  // Variables without names get uniquely named for this workspace.\n  if (!opt_name) {\n    const ws = workspace.isFlyout\n      ? (workspace as WorkspaceSvg).targetWorkspace\n      : workspace;\n    opt_name = generateUniqueName(ws!);\n  }\n\n  // Create a potential variable if in the flyout.\n  let variable = null;\n  if (potentialVariableMap) {\n    variable = potentialVariableMap.createVariable(opt_name, opt_type, id);\n  } else {\n    // In the main workspace, create a real variable.\n    variable = workspace.createVariable(opt_name, opt_type, id);\n  }\n  return variable;\n}\n\n/**\n * Helper function to get the list of variables that have been added to the\n * workspace after adding a new block, using the given list of variables that\n * were in the workspace before the new block was added.\n *\n * @param workspace The workspace to inspect.\n * @param originalVariables The array of variables that existed in the workspace\n *     before adding the new block.\n * @returns The new array of variables that were freshly added to the workspace\n *     after creating the new block, or [] if no new variables were added to the\n *     workspace.\n * @internal\n */\nexport function getAddedVariables(\n  workspace: Workspace,\n  originalVariables: VariableModel[],\n): VariableModel[] {\n  const allCurrentVariables = workspace.getAllVariables();\n  const addedVariables = [];\n  if (originalVariables.length !== allCurrentVariables.length) {\n    for (let i = 0; i < allCurrentVariables.length; i++) {\n      const variable = allCurrentVariables[i];\n      // For any variable that is present in allCurrentVariables but not\n      // present in originalVariables, add the variable to addedVariables.\n      if (originalVariables.indexOf(variable) === -1) {\n        addedVariables.push(variable);\n      }\n    }\n  }\n  return addedVariables;\n}\n\nexport const TEST_ONLY = {\n  generateUniqueNameInternal,\n};\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {ICopyable, ICopyData} from '../interfaces/i_copyable.js';\nimport type {IPaster} from '../interfaces/i_paster.js';\nimport * as registry from '../registry.js';\n\n/**\n * Registers the given paster so that it cna be used for pasting.\n *\n * @param type The type of the paster to register, e.g. 'block', 'comment', etc.\n * @param paster The paster to register.\n */\nexport function register<U extends ICopyData, T extends ICopyable<U>>(\n  type: string,\n  paster: IPaster<U, T>,\n) {\n  registry.register(registry.Type.PASTER, type, paster);\n}\n\n/**\n * Unregisters the paster associated with the given type.\n *\n * @param type The type of the paster to unregister.\n */\nexport function unregister(type: string) {\n  registry.unregister(registry.Type.PASTER, type);\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {BlockSvg} from './block_svg.js';\nimport * as userAgent from './utils/useragent.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/** The set of all blocks in need of rendering which don't have parents. */\nconst rootBlocks = new Set<BlockSvg>();\n\n/** The set of all blocks in need of rendering. */\nconst dirtyBlocks = new WeakSet<BlockSvg>();\n\n/**\n * The promise which resolves after the current set of renders is completed. Or\n * null if there are no queued renders.\n *\n * Stored so that we can return it from afterQueuedRenders.\n */\nlet afterRendersPromise: Promise<void> | null = null;\n\n/** The function to call to resolve the `afterRendersPromise`. */\nlet afterRendersResolver: (() => void) | null = null;\n\n/**\n * The ID of the current animation frame request. Used to cancel the request\n * if necessary.\n */\nlet animationRequestId = 0;\n\n/**\n * Registers that the given block and all of its parents need to be rerendered,\n * and registers a callback to do so after a delay, to allowf or batching.\n *\n * @param block The block to rerender.\n * @returns A promise that resolves after the currently queued renders have been\n *     completed. Used for triggering other behavior that relies on updated\n *     size/position location for the block.\n * @internal\n */\nexport function queueRender(block: BlockSvg): Promise<void> {\n  queueBlock(block);\n\n  if (alwaysImmediatelyRender()) {\n    doRenders();\n    return Promise.resolve();\n  }\n\n  if (!afterRendersPromise) {\n    afterRendersPromise = new Promise((resolve) => {\n      afterRendersResolver = resolve;\n      animationRequestId = window.requestAnimationFrame(() => {\n        doRenders();\n        resolve();\n      });\n    });\n  }\n  return afterRendersPromise;\n}\n\n/**\n * @returns A promise that resolves after the currently queued renders have\n *     been completed.\n */\nexport function finishQueuedRenders(): Promise<void> {\n  // If there are no queued renders, return a resolved promise so `then`\n  // callbacks trigger immediately.\n  return afterRendersPromise ? afterRendersPromise : Promise.resolve();\n}\n\n/**\n * Triggers an immediate render of all queued renders. Should only be used in\n * cases where queueing renders breaks functionality + backwards compatibility\n * (such as rendering icons).\n *\n * @param workspace If provided, only rerender blocks in this workspace.\n *\n * @internal\n */\nexport function triggerQueuedRenders(workspace?: WorkspaceSvg) {\n  if (!workspace) window.cancelAnimationFrame(animationRequestId);\n  doRenders(workspace);\n  if (!workspace && afterRendersResolver) afterRendersResolver();\n}\n\n/**\n * @returns True if we should always trigger an immediate render.\n *     Some platforms don't properly support `requestAnimationFrame`, so to\n *     avoid glitchiness, we give up the performance improvements.\n */\nfunction alwaysImmediatelyRender() {\n  return userAgent.JavaFx;\n}\n\n/**\n * Adds the given block and its parents to the render queue. Adds the root block\n * to the list of root blocks.\n *\n * @param block The block to queue.\n */\nfunction queueBlock(block: BlockSvg) {\n  dirtyBlocks.add(block);\n  const parent = block.getParent();\n  if (parent) {\n    queueBlock(parent);\n  } else {\n    rootBlocks.add(block);\n  }\n}\n\n/**\n * Rerenders all of the blocks in the queue.\n *\n * @param workspace If provided, only rerender blocks in this workspace.\n */\nfunction doRenders(workspace?: WorkspaceSvg) {\n  const workspaces = workspace\n    ? new Set([workspace])\n    : new Set([...rootBlocks].map((block) => block.workspace));\n  const blocks = [...rootBlocks]\n    .filter(shouldRenderRootBlock)\n    .filter((b) => workspaces.has(b.workspace));\n  for (const block of blocks) {\n    renderBlock(block);\n  }\n  for (const workspace of workspaces) {\n    workspace.resizeContents();\n  }\n  for (const block of blocks) {\n    const blockOrigin = block.getRelativeToSurfaceXY();\n    block.updateComponentLocations(blockOrigin);\n  }\n\n  for (const block of blocks) {\n    dequeueBlock(block);\n  }\n  if (!workspace) afterRendersPromise = null;\n}\n\n/** Removes the given block and children from the render queue. */\nfunction dequeueBlock(block: BlockSvg) {\n  rootBlocks.delete(block);\n  dirtyBlocks.delete(block);\n  for (const child of block.getChildren(false)) {\n    dequeueBlock(child);\n  }\n}\n\n/**\n * Returns true if the block should be rendered.\n *\n * No need to render dead blocks.\n *\n * No need to render blocks with parents. A render for the block may have been\n * queued, and the the block was connected to a parent, so it is no longer a\n * root block. Rendering will be triggered through the real root block.\n */\nfunction shouldRenderRootBlock(block: BlockSvg): boolean {\n  return !block.isDisposed() && !block.getParent();\n}\n\n/**\n * Recursively renders all of the dirty children of the given block, and\n * then renders the block.\n *\n * @param block The block to rerender.\n */\nfunction renderBlock(block: BlockSvg) {\n  if (!dirtyBlocks.has(block)) return;\n  for (const child of block.getChildren(false)) {\n    renderBlock(child);\n  }\n  block.renderEfficiently();\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.Xml\n\nimport type {Block} from './block.js';\nimport type {BlockSvg} from './block_svg.js';\nimport type {Connection} from './connection.js';\nimport * as eventUtils from './events/utils.js';\nimport type {Field} from './field.js';\nimport {IconType} from './icons/icon_types.js';\nimport {inputTypes} from './inputs/input_types.js';\nimport * as dom from './utils/dom.js';\nimport {Size} from './utils/size.js';\nimport * as utilsXml from './utils/xml.js';\nimport type {VariableModel} from './variable_model.js';\nimport * as Variables from './variables.js';\nimport type {Workspace} from './workspace.js';\nimport {WorkspaceComment} from './workspace_comment.js';\nimport {WorkspaceCommentSvg} from './workspace_comment_svg.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport * as renderManagement from './render_management.js';\n\n/**\n * Encode a block tree as XML.\n *\n * @param workspace The workspace containing blocks.\n * @param opt_noId True if the encoder should skip the block IDs.\n * @returns XML DOM element.\n */\nexport function workspaceToDom(\n  workspace: Workspace,\n  opt_noId?: boolean,\n): Element {\n  const treeXml = utilsXml.createElement('xml');\n  const variablesElement = variablesToDom(\n    Variables.allUsedVarModels(workspace),\n  );\n  if (variablesElement.hasChildNodes()) {\n    treeXml.appendChild(variablesElement);\n  }\n  const comments = workspace.getTopComments(true);\n  for (let i = 0; i < comments.length; i++) {\n    const comment = comments[i];\n    treeXml.appendChild(comment.toXmlWithXY(opt_noId));\n  }\n  const blocks = workspace.getTopBlocks(true);\n  for (let i = 0; i < blocks.length; i++) {\n    const block = blocks[i];\n    treeXml.appendChild(blockToDomWithXY(block, opt_noId));\n  }\n  return treeXml;\n}\n\n/**\n * Encode a list of variables as XML.\n *\n * @param variableList List of all variable models.\n * @returns Tree of XML elements.\n */\nexport function variablesToDom(variableList: VariableModel[]): Element {\n  const variables = utilsXml.createElement('variables');\n  for (let i = 0; i < variableList.length; i++) {\n    const variable = variableList[i];\n    const element = utilsXml.createElement('variable');\n    element.appendChild(utilsXml.createTextNode(variable.name));\n    if (variable.type) {\n      element.setAttribute('type', variable.type);\n    }\n    element.id = variable.getId();\n    variables.appendChild(element);\n  }\n  return variables;\n}\n\n/**\n * Encode a block subtree as XML with XY coordinates.\n *\n * @param block The root block to encode.\n * @param opt_noId True if the encoder should skip the block ID.\n * @returns Tree of XML elements or an empty document fragment if the block was\n *     an insertion marker.\n */\nexport function blockToDomWithXY(\n  block: Block,\n  opt_noId?: boolean,\n): Element | DocumentFragment {\n  if (block.isInsertionMarker()) {\n    // Skip over insertion markers.\n    block = block.getChildren(false)[0];\n    if (!block) {\n      // Disappears when appended.\n      return new DocumentFragment();\n    }\n  }\n\n  let width = 0; // Not used in LTR.\n  if (block.workspace.RTL) {\n    width = block.workspace.getWidth();\n  }\n\n  const element = blockToDom(block, opt_noId);\n  if (isElement(element)) {\n    const xy = block.getRelativeToSurfaceXY();\n    element.setAttribute(\n      'x',\n      String(Math.round(block.workspace.RTL ? width - xy.x : xy.x)),\n    );\n    element.setAttribute('y', String(Math.round(xy.y)));\n  }\n  return element;\n}\n\n/**\n * Encode a field as XML.\n *\n * @param field The field to encode.\n * @returns XML element, or null if the field did not need to be serialized.\n */\nfunction fieldToDom(field: Field): Element | null {\n  if (field.isSerializable()) {\n    const container = utilsXml.createElement('field');\n    container.setAttribute('name', field.name || '');\n    return field.toXml(container);\n  }\n  return null;\n}\n\n/**\n * Encode all of a block's fields as XML and attach them to the given tree of\n * XML elements.\n *\n * @param block A block with fields to be encoded.\n * @param element The XML element to which the field DOM should be attached.\n */\nfunction allFieldsToDom(block: Block, element: Element) {\n  for (let i = 0; i < block.inputList.length; i++) {\n    const input = block.inputList[i];\n    for (let j = 0; j < input.fieldRow.length; j++) {\n      const field = input.fieldRow[j];\n      const fieldDom = fieldToDom(field);\n      if (fieldDom) {\n        element.appendChild(fieldDom);\n      }\n    }\n  }\n}\n\n/**\n * Encode a block subtree as XML.\n *\n * @param block The root block to encode.\n * @param opt_noId True if the encoder should skip the block ID.\n * @returns Tree of XML elements or an empty document fragment if the block was\n *     an insertion marker.\n */\nexport function blockToDom(\n  block: Block,\n  opt_noId?: boolean,\n): Element | DocumentFragment {\n  // Skip over insertion markers.\n  if (block.isInsertionMarker()) {\n    const child = block.getChildren(false)[0];\n    if (child) {\n      return blockToDom(child);\n    } else {\n      // Disappears when appended.\n      return new DocumentFragment();\n    }\n  }\n\n  const element = utilsXml.createElement(block.isShadow() ? 'shadow' : 'block');\n  element.setAttribute('type', block.type);\n  if (!opt_noId) {\n    element.id = block.id;\n  }\n  if (block.mutationToDom) {\n    // Custom data for an advanced block.\n    const mutation = block.mutationToDom();\n    if (mutation && (mutation.hasChildNodes() || mutation.hasAttributes())) {\n      element.appendChild(mutation);\n    }\n  }\n\n  allFieldsToDom(block, element);\n\n  const commentText = block.getCommentText();\n  if (commentText) {\n    const comment = block.getIcon(IconType.COMMENT)!;\n    const size = comment.getBubbleSize();\n    const pinned = comment.bubbleIsVisible();\n\n    const commentElement = utilsXml.createElement('comment');\n    commentElement.appendChild(utilsXml.createTextNode(commentText));\n    commentElement.setAttribute('pinned', `${pinned}`);\n    commentElement.setAttribute('h', String(size.height));\n    commentElement.setAttribute('w', String(size.width));\n\n    element.appendChild(commentElement);\n  }\n\n  if (block.data) {\n    const dataElement = utilsXml.createElement('data');\n    dataElement.appendChild(utilsXml.createTextNode(block.data));\n    element.appendChild(dataElement);\n  }\n\n  for (let i = 0; i < block.inputList.length; i++) {\n    const input = block.inputList[i];\n    let container: Element;\n    let empty = true;\n    if (input.type === inputTypes.DUMMY || input.type === inputTypes.END_ROW) {\n      continue;\n    } else {\n      const childBlock = input.connection!.targetBlock();\n      if (input.type === inputTypes.VALUE) {\n        container = utilsXml.createElement('value');\n      } else if (input.type === inputTypes.STATEMENT) {\n        container = utilsXml.createElement('statement');\n      }\n      const childShadow = input.connection!.getShadowDom();\n      if (childShadow && (!childBlock || !childBlock.isShadow())) {\n        container!.appendChild(cloneShadow(childShadow, opt_noId));\n      }\n      if (childBlock) {\n        const childElem = blockToDom(childBlock, opt_noId);\n        if (childElem.nodeType === dom.NodeType.ELEMENT_NODE) {\n          container!.appendChild(childElem);\n          empty = false;\n        }\n      }\n    }\n    container!.setAttribute('name', input.name);\n    if (!empty) {\n      element.appendChild(container!);\n    }\n  }\n  if (\n    block.inputsInline !== undefined &&\n    block.inputsInline !== block.inputsInlineDefault\n  ) {\n    element.setAttribute('inline', String(block.inputsInline));\n  }\n  if (block.isCollapsed()) {\n    element.setAttribute('collapsed', 'true');\n  }\n  if (!block.isEnabled()) {\n    element.setAttribute('disabled', 'true');\n  }\n  if (!block.isDeletable() && !block.isShadow()) {\n    element.setAttribute('deletable', 'false');\n  }\n  if (!block.isMovable() && !block.isShadow()) {\n    element.setAttribute('movable', 'false');\n  }\n  if (!block.isEditable()) {\n    element.setAttribute('editable', 'false');\n  }\n\n  const nextBlock = block.getNextBlock();\n  let container: Element;\n  if (nextBlock) {\n    const nextElem = blockToDom(nextBlock, opt_noId);\n    if (nextElem.nodeType === dom.NodeType.ELEMENT_NODE) {\n      container = utilsXml.createElement('next');\n      container.appendChild(nextElem);\n      element.appendChild(container);\n    }\n  }\n  const nextShadow =\n    block.nextConnection && block.nextConnection.getShadowDom();\n  if (nextShadow && (!nextBlock || !nextBlock.isShadow())) {\n    container!.appendChild(cloneShadow(nextShadow, opt_noId));\n  }\n\n  return element;\n}\n\n/**\n * Deeply clone the shadow's DOM so that changes don't back-wash to the block.\n *\n * @param shadow A tree of XML elements.\n * @param opt_noId True if the encoder should skip the block ID.\n * @returns A tree of XML elements.\n */\nfunction cloneShadow(shadow: Element, opt_noId?: boolean): Element {\n  shadow = shadow.cloneNode(true) as Element;\n  // Walk the tree looking for whitespace.  Don't prune whitespace in a tag.\n  let node: Node | null = shadow;\n  let textNode;\n  while (node) {\n    if (opt_noId && node.nodeName === 'shadow') {\n      // Strip off IDs from shadow blocks.  There should never be a 'block' as\n      // a child of a 'shadow', so no need to check that.\n      (node as Element).removeAttribute('id');\n    }\n    if (node.firstChild) {\n      node = node.firstChild;\n    } else {\n      while (node && !node.nextSibling) {\n        textNode = node;\n        node = node.parentNode;\n        if (\n          textNode.nodeType === dom.NodeType.TEXT_NODE &&\n          (textNode as Text).data.trim() === '' &&\n          node?.firstChild !== textNode\n        ) {\n          // Prune whitespace after a tag.\n          dom.removeNode(textNode);\n        }\n      }\n      if (node) {\n        textNode = node;\n        node = node.nextSibling;\n        if (\n          textNode.nodeType === dom.NodeType.TEXT_NODE &&\n          (textNode as Text).data.trim() === ''\n        ) {\n          // Prune whitespace before a tag.\n          dom.removeNode(textNode);\n        }\n      }\n    }\n  }\n  return shadow;\n}\n\n/**\n * Converts a DOM structure into plain text.\n * Currently the text format is fairly ugly: all one line with no whitespace,\n * unless the DOM itself has whitespace built-in.\n *\n * @param dom A tree of XML nodes.\n * @returns Text representation.\n */\nexport function domToText(dom: Node): string {\n  const text = utilsXml.domToText(dom);\n  // Unpack self-closing tags.  These tags fail when embedded in HTML.\n  // <block name=\"foo\"/> -> <block name=\"foo\"></block>\n  return text.replace(/<(\\w+)([^<]*)\\/>/g, '<$1$2></$1>');\n}\n\n/**\n * Converts a DOM structure into properly indented text.\n *\n * @param dom A tree of XML elements.\n * @returns Text representation.\n */\nexport function domToPrettyText(dom: Node): string {\n  // This function is not guaranteed to be correct for all XML.\n  // But it handles the XML that Blockly generates.\n  const blob = domToText(dom);\n  // Place every open and close tag on its own line.\n  const lines = blob.split('<');\n  // Indent every line.\n  let indent = '';\n  for (let i = 1; i < lines.length; i++) {\n    const line = lines[i];\n    if (line[0] === '/') {\n      indent = indent.substring(2);\n    }\n    lines[i] = indent + '<' + line;\n    if (line[0] !== '/' && line.slice(-2) !== '/>') {\n      indent += '  ';\n    }\n  }\n  // Pull simple tags back together.\n  // E.g. <foo></foo>\n  let text = lines.join('\\n');\n  text = text.replace(/(<(\\w+)\\b[^>]*>[^\\n]*)\\n *<\\/\\2>/g, '$1</$2>');\n  // Trim leading blank line.\n  return text.replace(/^\\n/, '');\n}\n\n/**\n * Clear the given workspace then decode an XML DOM and\n * create blocks on the workspace.\n *\n * @param xml XML DOM.\n * @param workspace The workspace.\n * @returns An array containing new block IDs.\n */\nexport function clearWorkspaceAndLoadFromXml(\n  xml: Element,\n  workspace: WorkspaceSvg,\n): string[] {\n  workspace.setResizesEnabled(false);\n  workspace.clear();\n  const blockIds = domToWorkspace(xml, workspace);\n  workspace.setResizesEnabled(true);\n  return blockIds;\n}\n\n/**\n * Decode an XML DOM and create blocks on the workspace.\n *\n * @param xml XML DOM.\n * @param workspace The workspace.\n * @returns An array containing new block IDs.\n */\nexport function domToWorkspace(xml: Element, workspace: Workspace): string[] {\n  let width = 0; // Not used in LTR.\n  if (workspace.RTL) {\n    width = workspace.getWidth();\n  }\n  const newBlockIds = []; // A list of block IDs added by this call.\n  dom.startTextWidthCache();\n  const existingGroup = eventUtils.getGroup();\n  if (!existingGroup) {\n    eventUtils.setGroup(true);\n  }\n\n  // Disable workspace resizes as an optimization.\n  // Assume it is rendered so we can check.\n  if ((workspace as WorkspaceSvg).setResizesEnabled) {\n    (workspace as WorkspaceSvg).setResizesEnabled(false);\n  }\n  let variablesFirst = true;\n  try {\n    for (let i = 0, xmlChild; (xmlChild = xml.childNodes[i]); i++) {\n      const name = xmlChild.nodeName.toLowerCase();\n      const xmlChildElement = xmlChild as Element;\n      if (\n        name === 'block' ||\n        (name === 'shadow' && !eventUtils.getRecordUndo())\n      ) {\n        // Allow top-level shadow blocks if recordUndo is disabled since\n        // that means an undo is in progress.  Such a block is expected\n        // to be moved to a nested destination in the next operation.\n        const block = domToBlockInternal(xmlChildElement, workspace);\n        newBlockIds.push(block.id);\n        const blockX = parseInt(xmlChildElement.getAttribute('x') ?? '10', 10);\n        const blockY = parseInt(xmlChildElement.getAttribute('y') ?? '10', 10);\n        if (!isNaN(blockX) && !isNaN(blockY)) {\n          block.moveBy(workspace.RTL ? width - blockX : blockX, blockY, [\n            'create',\n          ]);\n        }\n        variablesFirst = false;\n      } else if (name === 'shadow') {\n        throw TypeError('Shadow block cannot be a top-level block.');\n      } else if (name === 'comment') {\n        if (workspace.rendered) {\n          WorkspaceCommentSvg.fromXmlRendered(\n            xmlChildElement,\n            workspace as WorkspaceSvg,\n            width,\n          );\n        } else {\n          WorkspaceComment.fromXml(xmlChildElement, workspace);\n        }\n      } else if (name === 'variables') {\n        if (variablesFirst) {\n          domToVariables(xmlChildElement, workspace);\n        } else {\n          throw Error(\n            \"'variables' tag must exist once before block and \" +\n              'shadow tag elements in the workspace XML, but it was found in ' +\n              'another location.',\n          );\n        }\n        variablesFirst = false;\n      }\n    }\n  } finally {\n    eventUtils.setGroup(existingGroup);\n    if ((workspace as WorkspaceSvg).setResizesEnabled) {\n      (workspace as WorkspaceSvg).setResizesEnabled(true);\n    }\n    if (workspace.rendered) renderManagement.triggerQueuedRenders();\n    dom.stopTextWidthCache();\n  }\n  // Re-enable workspace resizing.\n  eventUtils.fire(new (eventUtils.get(eventUtils.FINISHED_LOADING))(workspace));\n  return newBlockIds;\n}\n\n/**\n * Decode an XML DOM and create blocks on the workspace. Position the new\n * blocks immediately below prior blocks, aligned by their starting edge.\n *\n * @param xml The XML DOM.\n * @param workspace The workspace to add to.\n * @returns An array containing new block IDs.\n */\nexport function appendDomToWorkspace(\n  xml: Element,\n  workspace: WorkspaceSvg,\n): string[] {\n  // First check if we have a WorkspaceSvg, otherwise the blocks have no shape\n  // and the position does not matter.\n  // Assume it is rendered so we can check.\n  if (!(workspace as WorkspaceSvg).getBlocksBoundingBox) {\n    return domToWorkspace(xml, workspace);\n  }\n\n  const bbox = (workspace as WorkspaceSvg).getBlocksBoundingBox();\n  // Load the new blocks into the workspace and get the IDs of the new blocks.\n  const newBlockIds = domToWorkspace(xml, workspace);\n  if (bbox && bbox.top !== bbox.bottom) {\n    // Check if any previous block.\n    let offsetY = 0; // Offset to add to y of the new block.\n    let offsetX = 0;\n    const farY = bbox.bottom; // Bottom position.\n    const topX = workspace.RTL ? bbox.right : bbox.left; // X of bounding box.\n    // Check position of the new blocks.\n    let newLeftX = Infinity; // X of top left corner.\n    let newRightX = -Infinity; // X of top right corner.\n    let newY = Infinity; // Y of top corner.\n    const ySeparation = 10;\n    for (let i = 0; i < newBlockIds.length; i++) {\n      const blockXY = workspace\n        .getBlockById(newBlockIds[i])!\n        .getRelativeToSurfaceXY();\n      if (blockXY.y < newY) {\n        newY = blockXY.y;\n      }\n      if (blockXY.x < newLeftX) {\n        // if we left align also on x\n        newLeftX = blockXY.x;\n      }\n      if (blockXY.x > newRightX) {\n        // if we right align also on x\n        newRightX = blockXY.x;\n      }\n    }\n    offsetY = farY - newY + ySeparation;\n    offsetX = workspace.RTL ? topX - newRightX : topX - newLeftX;\n    for (let i = 0; i < newBlockIds.length; i++) {\n      const block = workspace.getBlockById(newBlockIds[i]);\n      block!.moveBy(offsetX, offsetY, ['create']);\n    }\n  }\n  return newBlockIds;\n}\n\n/**\n * Decode an XML block tag and create a block (and possibly sub blocks) on the\n * workspace.\n *\n * @param xmlBlock XML block element.\n * @param workspace The workspace.\n * @returns The root block created.\n */\nexport function domToBlock(xmlBlock: Element, workspace: Workspace): Block {\n  const block = domToBlockInternal(xmlBlock, workspace);\n  if (workspace.rendered) renderManagement.triggerQueuedRenders();\n  return block;\n}\n\n/**\n * Decode an XML block tag and create a block (and possibly sub blocks) on the\n * workspace.\n *\n * This is defined internally so that it doesn't trigger an immediate render,\n * which we do want to happen for external calls.\n *\n * @param xmlBlock XML block element.\n * @param workspace The workspace.\n * @returns The root block created.\n * @internal\n */\nexport function domToBlockInternal(\n  xmlBlock: Element,\n  workspace: Workspace,\n): Block {\n  // Create top-level block.\n  eventUtils.disable();\n  const variablesBeforeCreation = workspace.getAllVariables();\n  let topBlock;\n  try {\n    topBlock = domToBlockHeadless(xmlBlock, workspace);\n    // Generate list of all blocks.\n    if (workspace.rendered) {\n      const topBlockSvg = topBlock as BlockSvg;\n      const blocks = topBlock.getDescendants(false);\n      topBlockSvg.setConnectionTracking(false);\n      // Render each block.\n      for (let i = blocks.length - 1; i >= 0; i--) {\n        (blocks[i] as BlockSvg).initSvg();\n      }\n      for (let i = blocks.length - 1; i >= 0; i--) {\n        (blocks[i] as BlockSvg).queueRender();\n      }\n      // Populating the connection database may be deferred until after the\n      // blocks have rendered.\n      setTimeout(function () {\n        if (!topBlockSvg.disposed) {\n          topBlockSvg.setConnectionTracking(true);\n        }\n      }, 1);\n      // Allow the scrollbars to resize and move based on the new contents.\n      // TODO(@picklesrus): #387. Remove when domToBlock avoids resizing.\n      (workspace as WorkspaceSvg).resizeContents();\n    } else {\n      const blocks = topBlock.getDescendants(false);\n      for (let i = blocks.length - 1; i >= 0; i--) {\n        blocks[i].initModel();\n      }\n    }\n  } finally {\n    eventUtils.enable();\n  }\n  if (eventUtils.isEnabled()) {\n    const newVariables = Variables.getAddedVariables(\n      workspace,\n      variablesBeforeCreation,\n    );\n    // Fire a VarCreate event for each (if any) new variable created.\n    for (let i = 0; i < newVariables.length; i++) {\n      const thisVariable = newVariables[i];\n      eventUtils.fire(\n        new (eventUtils.get(eventUtils.VAR_CREATE))(thisVariable),\n      );\n    }\n    // Block events come after var events, in case they refer to newly created\n    // variables.\n    eventUtils.fire(new (eventUtils.get(eventUtils.CREATE))(topBlock));\n  }\n  return topBlock;\n}\n\n/**\n * Decode an XML list of variables and add the variables to the workspace.\n *\n * @param xmlVariables List of XML variable elements.\n * @param workspace The workspace to which the variable should be added.\n */\nexport function domToVariables(xmlVariables: Element, workspace: Workspace) {\n  for (let i = 0; i < xmlVariables.children.length; i++) {\n    const xmlChild = xmlVariables.children[i];\n    const type = xmlChild.getAttribute('type');\n    const id = xmlChild.getAttribute('id');\n    const name = xmlChild.textContent;\n\n    if (!name) return;\n    workspace.createVariable(name, type, id);\n  }\n}\n\n/** A mapping of nodeName to node for child nodes of xmlBlock. */\ninterface childNodeTagMap {\n  mutation: Element[];\n  comment: Element[];\n  data: Element[];\n  field: Element[];\n  input: Element[];\n  next: Element[];\n}\n\n/**\n * Creates a mapping of childNodes for each supported XML tag for the provided\n * xmlBlock. Logs a warning for any encountered unsupported tags.\n *\n * @param xmlBlock XML block element.\n * @returns The childNode map from nodeName to node.\n */\nfunction mapSupportedXmlTags(xmlBlock: Element): childNodeTagMap {\n  const childNodeMap = {\n    mutation: new Array<Element>(),\n    comment: new Array<Element>(),\n    data: new Array<Element>(),\n    field: new Array<Element>(),\n    input: new Array<Element>(),\n    next: new Array<Element>(),\n  };\n  for (let i = 0; i < xmlBlock.children.length; i++) {\n    const xmlChild = xmlBlock.children[i];\n    if (xmlChild.nodeType === dom.NodeType.TEXT_NODE) {\n      // Ignore any text at the <block> level.  It's all whitespace anyway.\n      continue;\n    }\n    switch (xmlChild.nodeName.toLowerCase()) {\n      case 'mutation':\n        childNodeMap.mutation.push(xmlChild);\n        break;\n      case 'comment':\n        childNodeMap.comment.push(xmlChild);\n        break;\n      case 'data':\n        childNodeMap.data.push(xmlChild);\n        break;\n      case 'title':\n      // Titles were renamed to field in December 2013.\n      // Fall through.\n      case 'field':\n        childNodeMap.field.push(xmlChild);\n        break;\n      case 'value':\n      case 'statement':\n        childNodeMap.input.push(xmlChild);\n        break;\n      case 'next':\n        childNodeMap.next.push(xmlChild);\n        break;\n      default:\n        // Unknown tag; ignore.  Same principle as HTML parsers.\n        console.warn('Ignoring unknown tag: ' + xmlChild.nodeName);\n    }\n  }\n  return childNodeMap;\n}\n\n/**\n * Applies mutation tag child nodes to the given block.\n *\n * @param xmlChildren Child nodes.\n * @param block The block to apply the child nodes on.\n * @returns True if mutation may have added some elements that need\n *     initialization (requiring initSvg call).\n */\nfunction applyMutationTagNodes(xmlChildren: Element[], block: Block): boolean {\n  let shouldCallInitSvg = false;\n  for (let i = 0; i < xmlChildren.length; i++) {\n    const xmlChild = xmlChildren[i];\n    // Custom data for an advanced block.\n    if (block.domToMutation) {\n      block.domToMutation(xmlChild);\n      if ((block as BlockSvg).initSvg) {\n        // Mutation may have added some elements that need initializing.\n        shouldCallInitSvg = true;\n      }\n    }\n  }\n  return shouldCallInitSvg;\n}\n\n/**\n * Applies comment tag child nodes to the given block.\n *\n * @param xmlChildren Child nodes.\n * @param block The block to apply the child nodes on.\n */\nfunction applyCommentTagNodes(xmlChildren: Element[], block: Block) {\n  for (let i = 0; i < xmlChildren.length; i++) {\n    const xmlChild = xmlChildren[i];\n    const text = xmlChild.textContent;\n    const pinned = xmlChild.getAttribute('pinned') === 'true';\n    const width = parseInt(xmlChild.getAttribute('w') ?? '50', 10);\n    const height = parseInt(xmlChild.getAttribute('h') ?? '50', 10);\n\n    block.setCommentText(text);\n    const comment = block.getIcon(IconType.COMMENT)!;\n    if (!isNaN(width) && !isNaN(height)) {\n      comment.setBubbleSize(new Size(width, height));\n    }\n    // Set the pinned state of the bubble.\n    comment.setBubbleVisible(pinned);\n    // Actually show the bubble after the block has been rendered.\n    setTimeout(() => comment.setBubbleVisible(pinned), 1);\n  }\n}\n\n/**\n * Applies data tag child nodes to the given block.\n *\n * @param xmlChildren Child nodes.\n * @param block The block to apply the child nodes on.\n */\nfunction applyDataTagNodes(xmlChildren: Element[], block: Block) {\n  for (let i = 0; i < xmlChildren.length; i++) {\n    const xmlChild = xmlChildren[i];\n    block.data = xmlChild.textContent;\n  }\n}\n\n/**\n * Applies field tag child nodes to the given block.\n *\n * @param xmlChildren Child nodes.\n * @param block The block to apply the child nodes on.\n */\nfunction applyFieldTagNodes(xmlChildren: Element[], block: Block) {\n  for (let i = 0; i < xmlChildren.length; i++) {\n    const xmlChild = xmlChildren[i];\n    const nodeName = xmlChild.getAttribute('name');\n    if (!nodeName) {\n      console.warn(`Ignoring unnamed field in block ${block.type}`);\n      continue;\n    }\n    domToField(block, nodeName, xmlChild);\n  }\n}\n\n/**\n * Finds any enclosed blocks or shadows within this XML node.\n *\n * @param xmlNode The XML node to extract child block info from.\n * @returns Any found child block.\n */\nfunction findChildBlocks(xmlNode: Element): {\n  childBlockElement: Element | null;\n  childShadowElement: Element | null;\n} {\n  let childBlockElement: Element | null = null;\n  let childShadowElement: Element | null = null;\n  for (let i = 0; i < xmlNode.childNodes.length; i++) {\n    const xmlChild = xmlNode.childNodes[i];\n    if (isElement(xmlChild)) {\n      if (xmlChild.nodeName.toLowerCase() === 'block') {\n        childBlockElement = xmlChild;\n      } else if (xmlChild.nodeName.toLowerCase() === 'shadow') {\n        childShadowElement = xmlChild;\n      }\n    }\n  }\n  return {childBlockElement, childShadowElement};\n}\n/**\n * Applies input child nodes (value or statement) to the given block.\n *\n * @param xmlChildren Child nodes.\n * @param workspace The workspace containing the given block.\n * @param block The block to apply the child nodes on.\n * @param prototypeName The prototype name of the block.\n */\nfunction applyInputTagNodes(\n  xmlChildren: Element[],\n  workspace: Workspace,\n  block: Block,\n  prototypeName: string,\n) {\n  for (let i = 0; i < xmlChildren.length; i++) {\n    const xmlChild = xmlChildren[i];\n    const nodeName = xmlChild.getAttribute('name');\n    const input = nodeName ? block.getInput(nodeName) : null;\n    if (!input) {\n      console.warn(\n        'Ignoring non-existent input ' +\n          nodeName +\n          ' in block ' +\n          prototypeName,\n      );\n      break;\n    }\n    const childBlockInfo = findChildBlocks(xmlChild);\n    if (childBlockInfo.childBlockElement) {\n      if (!input.connection) {\n        throw TypeError('Input connection does not exist.');\n      }\n      domToBlockHeadless(\n        childBlockInfo.childBlockElement,\n        workspace,\n        input.connection,\n        false,\n      );\n    }\n    // Set shadow after so we don't create a shadow we delete immediately.\n    if (childBlockInfo.childShadowElement) {\n      input.connection?.setShadowDom(childBlockInfo.childShadowElement);\n    }\n  }\n}\n\n/**\n * Applies next child nodes to the given block.\n *\n * @param xmlChildren Child nodes.\n * @param workspace The workspace containing the given block.\n * @param block The block to apply the child nodes on.\n */\nfunction applyNextTagNodes(\n  xmlChildren: Element[],\n  workspace: Workspace,\n  block: Block,\n) {\n  for (let i = 0; i < xmlChildren.length; i++) {\n    const xmlChild = xmlChildren[i];\n    const childBlockInfo = findChildBlocks(xmlChild);\n    if (childBlockInfo.childBlockElement) {\n      if (!block.nextConnection) {\n        throw TypeError('Next statement does not exist.');\n      }\n      // If there is more than one XML 'next' tag.\n      if (block.nextConnection.isConnected()) {\n        throw TypeError('Next statement is already connected.');\n      }\n      // Create child block.\n      domToBlockHeadless(\n        childBlockInfo.childBlockElement,\n        workspace,\n        block.nextConnection,\n        true,\n      );\n    }\n    // Set shadow after so we don't create a shadow we delete immediately.\n    if (childBlockInfo.childShadowElement && block.nextConnection) {\n      block.nextConnection.setShadowDom(childBlockInfo.childShadowElement);\n    }\n  }\n}\n\n/**\n * Decode an XML block tag and create a block (and possibly sub blocks) on the\n * workspace.\n *\n * @param xmlBlock XML block element.\n * @param workspace The workspace.\n * @param parentConnection The parent connection to to connect this block to\n *     after instantiating.\n * @param connectedToParentNext Whether the provided parent connection is a next\n *     connection, rather than output or statement.\n * @returns The root block created.\n */\nfunction domToBlockHeadless(\n  xmlBlock: Element,\n  workspace: Workspace,\n  parentConnection?: Connection,\n  connectedToParentNext?: boolean,\n): Block {\n  let block = null;\n  const prototypeName = xmlBlock.getAttribute('type');\n  if (!prototypeName) {\n    throw TypeError('Block type unspecified: ' + xmlBlock.outerHTML);\n  }\n  const id = xmlBlock.getAttribute('id') ?? undefined;\n  block = workspace.newBlock(prototypeName, id);\n\n  // Preprocess childNodes so tags can be processed in a consistent order.\n  const xmlChildNameMap = mapSupportedXmlTags(xmlBlock);\n\n  const shouldCallInitSvg = applyMutationTagNodes(\n    xmlChildNameMap.mutation,\n    block,\n  );\n  applyCommentTagNodes(xmlChildNameMap.comment, block);\n  applyDataTagNodes(xmlChildNameMap.data, block);\n\n  // Connect parent after processing mutation and before setting fields.\n  if (parentConnection) {\n    if (connectedToParentNext) {\n      if (block.previousConnection) {\n        parentConnection.connect(block.previousConnection);\n      } else {\n        throw TypeError('Next block does not have previous statement.');\n      }\n    } else {\n      if (block.outputConnection) {\n        parentConnection.connect(block.outputConnection);\n      } else if (block.previousConnection) {\n        parentConnection.connect(block.previousConnection);\n      } else {\n        throw TypeError(\n          'Child block does not have output or previous statement.',\n        );\n      }\n    }\n  }\n\n  applyFieldTagNodes(xmlChildNameMap.field, block);\n  applyInputTagNodes(xmlChildNameMap.input, workspace, block, prototypeName);\n  applyNextTagNodes(xmlChildNameMap.next, workspace, block);\n\n  if (shouldCallInitSvg) {\n    // This shouldn't even be called here\n    // (ref: https://github.com/google/blockly/pull/4296#issuecomment-884226021\n    // But the XML serializer/deserializer is iceboxed so I'm not going to fix\n    // it.\n    (block as BlockSvg).initSvg();\n  }\n\n  const inline = xmlBlock.getAttribute('inline');\n  if (inline) {\n    block.setInputsInline(inline === 'true');\n  }\n  const disabled = xmlBlock.getAttribute('disabled');\n  if (disabled) {\n    block.setEnabled(disabled !== 'true' && disabled !== 'disabled');\n  }\n  const deletable = xmlBlock.getAttribute('deletable');\n  if (deletable) {\n    block.setDeletable(deletable === 'true');\n  }\n  const movable = xmlBlock.getAttribute('movable');\n  if (movable) {\n    block.setMovable(movable === 'true');\n  }\n  const editable = xmlBlock.getAttribute('editable');\n  if (editable) {\n    block.setEditable(editable === 'true');\n  }\n  const collapsed = xmlBlock.getAttribute('collapsed');\n  if (collapsed) {\n    block.setCollapsed(collapsed === 'true');\n  }\n  if (xmlBlock.nodeName.toLowerCase() === 'shadow') {\n    // Ensure all children are also shadows.\n    const children = block.getChildren(false);\n    for (let i = 0; i < children.length; i++) {\n      const child = children[i];\n      if (!child.isShadow()) {\n        throw TypeError('Shadow block not allowed non-shadow child.');\n      }\n    }\n\n    block.setShadow(true);\n  }\n  return block;\n}\n\n/**\n * Decode an XML field tag and set the value of that field on the given block.\n *\n * @param block The block that is currently being deserialized.\n * @param fieldName The name of the field on the block.\n * @param xml The field tag to decode.\n */\nfunction domToField(block: Block, fieldName: string, xml: Element) {\n  const field = block.getField(fieldName);\n  if (!field) {\n    console.warn(\n      'Ignoring non-existent field ' + fieldName + ' in block ' + block.type,\n    );\n    return;\n  }\n  field.fromXml(xml);\n}\n\n/**\n * Remove any 'next' block (statements in a stack).\n *\n * @param xmlBlock XML block element or an empty DocumentFragment if the block\n *     was an insertion marker.\n */\nexport function deleteNext(xmlBlock: Element | DocumentFragment) {\n  for (let i = 0; i < xmlBlock.childNodes.length; i++) {\n    const child = xmlBlock.childNodes[i];\n    if (child.nodeName.toLowerCase() === 'next') {\n      xmlBlock.removeChild(child);\n      break;\n    }\n  }\n}\n\nfunction isElement(node: Node): node is Element {\n  return node.nodeType === dom.NodeType.ELEMENT_NODE;\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport interface ISerializable {\n  /**\n   * @param doFullSerialization If true, this signals that any backing data\n   *     structures used by this ISerializable should also be serialized. This\n   *     is used for copy-paste.\n   * @returns a JSON serializable value that records the ISerializable's state.\n   */\n  saveState(doFullSerialization: boolean): any;\n\n  /**\n   * Takes in a JSON serializable value and sets the ISerializable's state\n   * based on that.\n   *\n   * @param state The state to apply to the ISerializable.\n   */\n  loadState(state: any): void;\n}\n\n/** Type guard that checks whether the given object is a ISerializable. */\nexport function isSerializable(obj: any): obj is ISerializable {\n  return obj.saveState !== undefined && obj.loadState !== undefined;\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.serialization.registry\n\nimport type {ISerializer} from '../interfaces/i_serializer.js';\nimport * as registry from '../registry.js';\n\n/**\n * Registers the given serializer so that it can be used for serialization and\n * deserialization.\n *\n * @param name The name of the serializer to register.\n * @param serializer The serializer to register.\n */\nexport function register(name: string, serializer: ISerializer) {\n  registry.register(registry.Type.SERIALIZER, name, serializer);\n}\n\n/**\n * Unregisters the serializer associated with the given name.\n *\n * @param name The name of the serializer to unregister.\n */\nexport function unregister(name: string) {\n  registry.unregister(registry.Type.SERIALIZER, name);\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.serialization.blocks\n\nimport type {Block} from '../block.js';\nimport type {BlockSvg} from '../block_svg.js';\nimport type {Connection} from '../connection.js';\nimport * as eventUtils from '../events/utils.js';\nimport {inputTypes} from '../inputs/input_types.js';\nimport {isSerializable} from '../interfaces/i_serializable.js';\nimport type {ISerializer} from '../interfaces/i_serializer.js';\nimport * as registry from '../registry.js';\nimport * as utilsXml from '../utils/xml.js';\nimport type {Workspace} from '../workspace.js';\nimport * as Xml from '../xml.js';\nimport * as renderManagement from '../render_management.js';\n\nimport {\n  BadConnectionCheck,\n  MissingBlockType,\n  MissingConnection,\n  RealChildOfShadow,\n  UnregisteredIcon,\n} from './exceptions.js';\nimport * as priorities from './priorities.js';\nimport * as serializationRegistry from './registry.js';\n\n// TODO(#5160): Remove this once lint is fixed.\n/* eslint-disable no-use-before-define */\n\n/**\n * Represents the state of a connection.\n */\nexport interface ConnectionState {\n  shadow?: State;\n  block?: State;\n}\n\n/**\n * Represents the state of a given block.\n */\nexport interface State {\n  type: string;\n  id?: string;\n  x?: number;\n  y?: number;\n  collapsed?: boolean;\n  deletable?: boolean;\n  movable?: boolean;\n  editable?: boolean;\n  enabled?: boolean;\n  inline?: boolean;\n  data?: string;\n  extraState?: AnyDuringMigration;\n  icons?: {[key: string]: AnyDuringMigration};\n  fields?: {[key: string]: AnyDuringMigration};\n  inputs?: {[key: string]: ConnectionState};\n  next?: ConnectionState;\n}\n\n/**\n * Returns the state of the given block as a plain JavaScript object.\n *\n * @param block The block to serialize.\n * @param param1 addCoordinates: If true, the coordinates of the block are added\n *     to the serialized state. False by default. addinputBlocks: If true,\n *     children of the block which are connected to inputs will be serialized.\n *     True by default. addNextBlocks: If true, children of the block which are\n *     connected to the block's next connection (if it exists) will be\n *     serialized. True by default. doFullSerialization: If true, fields that\n *     normally just save a reference to some external state (eg variables) will\n *     instead serialize all of the info about that state. This supports\n *     deserializing the block into a workspace where that state doesn't yet\n *     exist. True by default.\n * @returns The serialized state of the block, or null if the block could not be\n *     serialied (eg it was an insertion marker).\n */\nexport function save(\n  block: Block,\n  {\n    addCoordinates = false,\n    addInputBlocks = true,\n    addNextBlocks = true,\n    doFullSerialization = true,\n    saveIds = true,\n  }: {\n    addCoordinates?: boolean;\n    addInputBlocks?: boolean;\n    addNextBlocks?: boolean;\n    doFullSerialization?: boolean;\n    saveIds?: boolean;\n  } = {},\n): State | null {\n  if (block.isInsertionMarker()) {\n    return null;\n  }\n  const state = {\n    'type': block.type,\n    'id': saveIds ? block.id : undefined,\n  };\n\n  if (addCoordinates) {\n    // AnyDuringMigration because:  Argument of type '{ type: string; id:\n    // string; }' is not assignable to parameter of type 'State'.\n    saveCoords(block, state as AnyDuringMigration);\n  }\n  // AnyDuringMigration because:  Argument of type '{ type: string; id: string;\n  // }' is not assignable to parameter of type 'State'.\n  saveAttributes(block, state as AnyDuringMigration);\n  // AnyDuringMigration because:  Argument of type '{ type: string; id: string;\n  // }' is not assignable to parameter of type 'State'.\n  saveExtraState(block, state as AnyDuringMigration, doFullSerialization);\n  // AnyDuringMigration because:  Argument of type '{ type: string; id: string;\n  // }' is not assignable to parameter of type 'State'.\n  saveIcons(block, state as AnyDuringMigration, doFullSerialization);\n  // AnyDuringMigration because:  Argument of type '{ type: string; id: string;\n  // }' is not assignable to parameter of type 'State'.\n  saveFields(block, state as AnyDuringMigration, doFullSerialization);\n  if (addInputBlocks) {\n    // AnyDuringMigration because:  Argument of type '{ type: string; id:\n    // string; }' is not assignable to parameter of type 'State'.\n    saveInputBlocks(\n      block,\n      state as AnyDuringMigration,\n      doFullSerialization,\n      saveIds,\n    );\n  }\n  if (addNextBlocks) {\n    // AnyDuringMigration because:  Argument of type '{ type: string; id:\n    // string; }' is not assignable to parameter of type 'State'.\n    saveNextBlocks(\n      block,\n      state as AnyDuringMigration,\n      doFullSerialization,\n      saveIds,\n    );\n  }\n\n  // AnyDuringMigration because:  Type '{ type: string; id: string; }' is not\n  // assignable to type 'State'.\n  return state as AnyDuringMigration;\n}\n\n/**\n * Adds attributes to the given state object based on the state of the block.\n * Eg collapsed, disabled, inline, etc.\n *\n * @param block The block to base the attributes on.\n * @param state The state object to append to.\n */\nfunction saveAttributes(block: Block, state: State) {\n  if (block.isCollapsed()) {\n    state['collapsed'] = true;\n  }\n  if (!block.isEnabled()) {\n    state['enabled'] = false;\n  }\n  if (!block.isOwnDeletable()) {\n    state['deletable'] = false;\n  }\n  if (!block.isOwnMovable()) {\n    state['movable'] = false;\n  }\n  if (!block.isOwnEditable()) {\n    state['editable'] = false;\n  }\n  if (\n    block.inputsInline !== undefined &&\n    block.inputsInline !== block.inputsInlineDefault\n  ) {\n    state['inline'] = block.inputsInline;\n  }\n  // Data is a nullable string, so we don't need to worry about falsy values.\n  if (block.data) {\n    state['data'] = block.data;\n  }\n}\n\n/**\n * Adds the coordinates of the given block to the given state object.\n *\n * @param block The block to base the coordinates on.\n * @param state The state object to append to.\n */\nfunction saveCoords(block: Block, state: State) {\n  const workspace = block.workspace;\n  const xy = block.getRelativeToSurfaceXY();\n  state['x'] = Math.round(workspace.RTL ? workspace.getWidth() - xy.x : xy.x);\n  state['y'] = Math.round(xy.y);\n}\n\n/**\n * Adds any extra state the block may provide to the given state object.\n *\n * @param block The block to serialize the extra state of.\n * @param state The state object to append to.\n * @param doFullSerialization Whether or not to serialize the full state of the\n *     extra state (rather than possibly saving a reference to some state).\n */\nfunction saveExtraState(\n  block: Block,\n  state: State,\n  doFullSerialization: boolean,\n) {\n  if (block.saveExtraState) {\n    const extraState = block.saveExtraState(doFullSerialization);\n    if (extraState !== null) {\n      state['extraState'] = extraState;\n    }\n  } else if (block.mutationToDom) {\n    const extraState = block.mutationToDom();\n    if (extraState !== null) {\n      state['extraState'] = Xml.domToText(extraState).replace(\n        ' xmlns=\"https://developers.google.com/blockly/xml\"',\n        '',\n      );\n    }\n  }\n}\n\n/**\n * Adds the state of all of the icons on the block to the given state object.\n *\n * @param block The block to serialize the icon state of.\n * @param state The state object to append to.\n * @param doFullSerialization Whether or not to serialize the full state of the\n *     icon (rather than possibly saving a reference to some state).\n */\nfunction saveIcons(block: Block, state: State, doFullSerialization: boolean) {\n  const icons = Object.create(null);\n  for (const icon of block.getIcons()) {\n    if (isSerializable(icon)) {\n      const state = icon.saveState(doFullSerialization);\n      if (state) icons[icon.getType().toString()] = state;\n    }\n  }\n\n  if (Object.keys(icons).length) {\n    state['icons'] = icons;\n  }\n}\n\n/**\n * Adds the state of all of the fields on the block to the given state object.\n *\n * @param block The block to serialize the field state of.\n * @param state The state object to append to.\n * @param doFullSerialization Whether or not to serialize the full state of the\n *     field (rather than possibly saving a reference to some state).\n */\nfunction saveFields(block: Block, state: State, doFullSerialization: boolean) {\n  const fields = Object.create(null);\n  for (let i = 0; i < block.inputList.length; i++) {\n    const input = block.inputList[i];\n    for (let j = 0; j < input.fieldRow.length; j++) {\n      const field = input.fieldRow[j];\n      if (field.isSerializable()) {\n        fields[field.name!] = field.saveState(doFullSerialization);\n      }\n    }\n  }\n  if (Object.keys(fields).length) {\n    state['fields'] = fields;\n  }\n}\n\n/**\n * Adds the state of all of the child blocks of the given block (which are\n * connected to inputs) to the given state object.\n *\n * @param block The block to serialize the input blocks of.\n * @param state The state object to append to.\n * @param doFullSerialization Whether or not to do full serialization.\n */\nfunction saveInputBlocks(\n  block: Block,\n  state: State,\n  doFullSerialization: boolean,\n  saveIds: boolean,\n) {\n  const inputs = Object.create(null);\n  for (let i = 0; i < block.inputList.length; i++) {\n    const input = block.inputList[i];\n    if (!input.connection) continue;\n    const connectionState = saveConnection(\n      input.connection as Connection,\n      doFullSerialization,\n      saveIds,\n    );\n    if (connectionState) {\n      inputs[input.name] = connectionState;\n    }\n  }\n\n  if (Object.keys(inputs).length) {\n    state['inputs'] = inputs;\n  }\n}\n\n/**\n * Adds the state of all of the next blocks of the given block to the given\n * state object.\n *\n * @param block The block to serialize the next blocks of.\n * @param state The state object to append to.\n * @param doFullSerialization Whether or not to do full serialization.\n */\nfunction saveNextBlocks(\n  block: Block,\n  state: State,\n  doFullSerialization: boolean,\n  saveIds: boolean,\n) {\n  if (!block.nextConnection) {\n    return;\n  }\n  const connectionState = saveConnection(\n    block.nextConnection,\n    doFullSerialization,\n    saveIds,\n  );\n  if (connectionState) {\n    state['next'] = connectionState;\n  }\n}\n\n/**\n * Returns the state of the given connection (ie the state of any connected\n * shadow or real blocks).\n *\n * @param connection The connection to serialize the connected blocks of.\n * @returns An object containing the state of any connected shadow block, or any\n *     connected real block.\n * @param doFullSerialization Whether or not to do full serialization.\n */\nfunction saveConnection(\n  connection: Connection,\n  doFullSerialization: boolean,\n  saveIds: boolean,\n): ConnectionState | null {\n  const shadow = connection.getShadowState(true);\n  const child = connection.targetBlock();\n  if (!shadow && !child) {\n    return null;\n  }\n  const state = Object.create(null);\n  if (shadow) {\n    state['shadow'] = shadow;\n  }\n  if (child && !child.isShadow()) {\n    state['block'] = save(child, {doFullSerialization, saveIds});\n  }\n  return state;\n}\n\n/**\n * Loads the block represented by the given state into the given workspace.\n *\n * @param state The state of a block to deserialize into the workspace.\n * @param workspace The workspace to add the block to.\n * @param param1 recordUndo: If true, events triggered by this function will be\n *     undo-able by the user. False by default.\n * @returns The block that was just loaded.\n */\nexport function append(\n  state: State,\n  workspace: Workspace,\n  {recordUndo = false}: {recordUndo?: boolean} = {},\n): Block {\n  const block = appendInternal(state, workspace, {recordUndo});\n  if (workspace.rendered) renderManagement.triggerQueuedRenders();\n  return block;\n}\n\n/**\n * Loads the block represented by the given state into the given workspace.\n * This is defined internally so that the extra parameters don't clutter our\n * external API.\n * But it is exported so that other places within Blockly can call it directly\n * with the extra parameters.\n *\n * @param state The state of a block to deserialize into the workspace.\n * @param workspace The workspace to add the block to.\n * @param param1 parentConnection: If provided, the system will attempt to\n *     connect the block to this connection after it is created. Undefined by\n *     default. isShadow: If true, the block will be set to a shadow block after\n *     it is created. False by default. recordUndo: If true, events triggered by\n *     this function will be undo-able by the user. False by default.\n * @returns The block that was just appended.\n * @internal\n */\nexport function appendInternal(\n  state: State,\n  workspace: Workspace,\n  {\n    parentConnection = undefined,\n    isShadow = false,\n    recordUndo = false,\n  }: {\n    parentConnection?: Connection;\n    isShadow?: boolean;\n    recordUndo?: boolean;\n  } = {},\n): Block {\n  const prevRecordUndo = eventUtils.getRecordUndo();\n  eventUtils.setRecordUndo(recordUndo);\n  const existingGroup = eventUtils.getGroup();\n  if (!existingGroup) {\n    eventUtils.setGroup(true);\n  }\n  eventUtils.disable();\n\n  let block;\n  try {\n    block = appendPrivate(state, workspace, {parentConnection, isShadow});\n  } finally {\n    eventUtils.enable();\n  }\n\n  if (eventUtils.isEnabled()) {\n    eventUtils.fire(new (eventUtils.get(eventUtils.BLOCK_CREATE))(block));\n  }\n  eventUtils.setGroup(existingGroup);\n  eventUtils.setRecordUndo(prevRecordUndo);\n\n  // Adding connections to the connection db is expensive. This defers that\n  // operation to decrease load time.\n  if (workspace.rendered) {\n    const blockSvg = block as BlockSvg;\n    setTimeout(() => {\n      if (!blockSvg.disposed) {\n        blockSvg.setConnectionTracking(true);\n      }\n    }, 1);\n  }\n\n  return block;\n}\n\n/**\n * Loads the block represented by the given state into the given workspace.\n * This is defined privately so that it can be called recursively without firing\n * eroneous events. Events (and other things we only want to occur on the top\n * block) are handled by appendInternal.\n *\n * @param state The state of a block to deserialize into the workspace.\n * @param workspace The workspace to add the block to.\n * @param param1 parentConnection: If provided, the system will attempt to\n *     connect the block to this connection after it is created. Undefined by\n *     default. isShadow: The block will be set to a shadow block after it is\n *     created. False by default.\n * @returns The block that was just appended.\n */\nfunction appendPrivate(\n  state: State,\n  workspace: Workspace,\n  {\n    parentConnection = undefined,\n    isShadow = false,\n  }: {parentConnection?: Connection; isShadow?: boolean} = {},\n): Block {\n  if (!state['type']) {\n    throw new MissingBlockType(state);\n  }\n\n  const block = workspace.newBlock(state['type'], state['id']);\n  block.setShadow(isShadow);\n  loadCoords(block, state);\n  loadAttributes(block, state);\n  loadExtraState(block, state);\n  tryToConnectParent(parentConnection, block, state);\n  loadIcons(block, state);\n  loadFields(block, state);\n  loadInputBlocks(block, state);\n  loadNextBlocks(block, state);\n  initBlock(block, workspace.rendered);\n\n  return block;\n}\n\n/**\n * Applies any coordinate information available on the state object to the\n * block.\n *\n * @param block The block to set the position of.\n * @param state The state object to reference.\n */\nfunction loadCoords(block: Block, state: State) {\n  let x = state['x'] === undefined ? 0 : state['x'];\n  const y = state['y'] === undefined ? 0 : state['y'];\n\n  const workspace = block.workspace;\n  x = workspace.RTL ? workspace.getWidth() - x : x;\n\n  block.moveBy(x, y);\n}\n\n/**\n * Applies any attribute information available on the state object to the block.\n *\n * @param block The block to set the attributes of.\n * @param state The state object to reference.\n */\nfunction loadAttributes(block: Block, state: State) {\n  if (state['collapsed']) {\n    block.setCollapsed(true);\n  }\n  if (state['deletable'] === false) {\n    block.setDeletable(false);\n  }\n  if (state['movable'] === false) {\n    block.setMovable(false);\n  }\n  if (state['editable'] === false) {\n    block.setEditable(false);\n  }\n  if (state['enabled'] === false) {\n    block.setEnabled(false);\n  }\n  if (state['inline'] !== undefined) {\n    block.setInputsInline(state['inline']);\n  }\n  if (state['data'] !== undefined) {\n    block.data = state['data'];\n  }\n}\n\n/**\n * Applies any extra state information available on the state object to the\n * block.\n *\n * @param block The block to set the extra state of.\n * @param state The state object to reference.\n */\nfunction loadExtraState(block: Block, state: State) {\n  if (!state['extraState']) {\n    return;\n  }\n  if (block.loadExtraState) {\n    block.loadExtraState(state['extraState']);\n  } else if (block.domToMutation) {\n    block.domToMutation(utilsXml.textToDom(state['extraState']));\n  }\n}\n\n/**\n * Attempts to connect the block to the parent connection, if it exists.\n *\n * @param parentConnection The parent connection to try to connect the block to.\n * @param child The block to try to connect to the parent.\n * @param state The state which defines the given block\n */\nfunction tryToConnectParent(\n  parentConnection: Connection | undefined,\n  child: Block,\n  state: State,\n) {\n  if (!parentConnection) {\n    return;\n  }\n\n  if (parentConnection.getSourceBlock().isShadow() && !child.isShadow()) {\n    throw new RealChildOfShadow(state);\n  }\n\n  let connected = false;\n  let childConnection;\n  if (parentConnection.type === inputTypes.VALUE) {\n    childConnection = child.outputConnection;\n    if (!childConnection) {\n      throw new MissingConnection('output', child, state);\n    }\n    connected = parentConnection.connect(childConnection);\n  } else {\n    // Statement type.\n    childConnection = child.previousConnection;\n    if (!childConnection) {\n      throw new MissingConnection('previous', child, state);\n    }\n    connected = parentConnection.connect(childConnection);\n  }\n\n  if (!connected) {\n    const checker = child.workspace.connectionChecker;\n    throw new BadConnectionCheck(\n      checker.getErrorMessage(\n        checker.canConnectWithReason(childConnection, parentConnection, false),\n        childConnection,\n        parentConnection,\n      ),\n      parentConnection.type === inputTypes.VALUE\n        ? 'output connection'\n        : 'previous connection',\n      child,\n      state,\n    );\n  }\n}\n\n/**\n * Applies icon state to the icons on the block, based on the given state\n * object.\n *\n * @param block The block to set the icon state of.\n * @param state The state object to reference.\n */\nfunction loadIcons(block: Block, state: State) {\n  if (!state['icons']) return;\n\n  const iconTypes = Object.keys(state['icons']);\n  for (const iconType of iconTypes) {\n    const iconState = state['icons'][iconType];\n    let icon = block.getIcon(iconType);\n    if (!icon) {\n      const constructor = registry.getClass(\n        registry.Type.ICON,\n        iconType,\n        false,\n      );\n      if (!constructor) throw new UnregisteredIcon(iconType, block, state);\n      icon = new constructor(block);\n      block.addIcon(icon);\n    }\n    if (isSerializable(icon)) icon.loadState(iconState);\n  }\n}\n\n/**\n * Applies any field information available on the state object to the block.\n *\n * @param block The block to set the field state of.\n * @param state The state object to reference.\n */\nfunction loadFields(block: Block, state: State) {\n  if (!state['fields']) {\n    return;\n  }\n  const keys = Object.keys(state['fields']);\n  for (let i = 0; i < keys.length; i++) {\n    const fieldName = keys[i];\n    const fieldState = state['fields'][fieldName];\n    const field = block.getField(fieldName);\n    if (!field) {\n      console.warn(\n        `Ignoring non-existant field ${fieldName} in block ${block.type}`,\n      );\n      continue;\n    }\n    field.loadState(fieldState);\n  }\n}\n\n/**\n * Creates any child blocks (attached to inputs) defined by the given state\n * and attaches them to the given block.\n *\n * @param block The block to attach input blocks to.\n * @param state The state object to reference.\n */\nfunction loadInputBlocks(block: Block, state: State) {\n  if (!state['inputs']) {\n    return;\n  }\n  const keys = Object.keys(state['inputs']);\n  for (let i = 0; i < keys.length; i++) {\n    const inputName = keys[i];\n    const input = block.getInput(inputName);\n    if (!input || !input.connection) {\n      throw new MissingConnection(inputName, block, state);\n    }\n    loadConnection(input.connection, state['inputs'][inputName]);\n  }\n}\n\n/**\n * Creates any next blocks defined by the given state and attaches them to the\n * given block.\n *\n * @param block The block to attach next blocks to.\n * @param state The state object to reference.\n */\nfunction loadNextBlocks(block: Block, state: State) {\n  if (!state['next']) {\n    return;\n  }\n  if (!block.nextConnection) {\n    throw new MissingConnection('next', block, state);\n  }\n  loadConnection(block.nextConnection, state['next']);\n}\n/**\n * Applies the state defined by connectionState to the given connection, ie\n * assigns shadows and attaches child blocks.\n *\n * @param connection The connection to deserialize the connected blocks of.\n * @param connectionState The object containing the state of any connected\n *     shadow block, or any connected real block.\n */\nfunction loadConnection(\n  connection: Connection,\n  connectionState: ConnectionState,\n) {\n  if (connectionState['shadow']) {\n    connection.setShadowState(connectionState['shadow']);\n  }\n  if (connectionState['block']) {\n    appendPrivate(\n      connectionState['block'],\n      connection.getSourceBlock().workspace,\n      {parentConnection: connection},\n    );\n  }\n}\n\n// TODO(#5146): Remove this from the serialization system.\n/**\n * Initializes the give block, eg init the model, inits the svg, renders, etc.\n *\n * @param block The block to initialize.\n * @param rendered Whether the block is a rendered or headless block.\n */\nfunction initBlock(block: Block, rendered: boolean) {\n  if (rendered) {\n    const blockSvg = block as BlockSvg;\n    // Adding connections to the connection db is expensive. This defers that\n    // operation to decrease load time.\n    blockSvg.setConnectionTracking(false);\n\n    blockSvg.initSvg();\n    blockSvg.queueRender();\n\n    // fixes #6076 JSO deserialization doesn't\n    // set .iconXY_ property so here it will be set\n    for (const icon of blockSvg.getIcons()) {\n      icon.onLocationChange(blockSvg.getRelativeToSurfaceXY());\n    }\n  } else {\n    block.initModel();\n  }\n}\n\n// Alias to disambiguate saving within the serializer.\nconst saveBlock = save;\n\n/**\n * Serializer for saving and loading block state.\n */\nexport class BlockSerializer implements ISerializer {\n  priority: number;\n\n  /* eslint-disable-next-line require-jsdoc */\n  constructor() {\n    /** The priority for deserializing blocks. */\n    this.priority = priorities.BLOCKS;\n  }\n\n  /**\n   * Serializes the blocks of the given workspace.\n   *\n   * @param workspace The workspace to save the blocks of.\n   * @returns The state of the workspace's blocks, or null if there are no\n   *     blocks.\n   */\n  save(\n    workspace: Workspace,\n  ): {languageVersion: number; blocks: State[]} | null {\n    const blockStates = [];\n    for (const block of workspace.getTopBlocks(false)) {\n      const state = saveBlock(block, {\n        addCoordinates: true,\n        doFullSerialization: false,\n      });\n      if (state) {\n        blockStates.push(state);\n      }\n    }\n    if (blockStates.length) {\n      return {\n        'languageVersion': 0, // Currently unused.\n        'blocks': blockStates,\n      };\n    }\n    return null;\n  }\n\n  /**\n   * Deserializes the blocks defined by the given state into the given\n   * workspace.\n   *\n   * @param state The state of the blocks to deserialize.\n   * @param workspace The workspace to deserialize into.\n   */\n  load(\n    state: {languageVersion: number; blocks: State[]},\n    workspace: Workspace,\n  ) {\n    const blockStates = state['blocks'];\n    for (const state of blockStates) {\n      append(state, workspace, {recordUndo: eventUtils.getRecordUndo()});\n    }\n  }\n\n  /**\n   * Disposes of any blocks that exist on the workspace.\n   *\n   * @param workspace The workspace to clear the blocks of.\n   */\n  clear(workspace: Workspace) {\n    // Cannot use workspace.clear() because that also removes variables.\n    for (const block of workspace.getTopBlocks(false)) {\n      block.dispose(false);\n    }\n  }\n}\n\nserializationRegistry.register('blocks', new BlockSerializer());\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {BlockSvg} from '../block_svg.js';\nimport * as registry from './registry.js';\nimport {ICopyData} from '../interfaces/i_copyable.js';\nimport {IPaster} from '../interfaces/i_paster.js';\nimport {State, append} from '../serialization/blocks.js';\nimport {Coordinate} from '../utils/coordinate.js';\nimport {WorkspaceSvg} from '../workspace_svg.js';\nimport * as eventUtils from '../events/utils.js';\nimport {config} from '../config.js';\n\nexport class BlockPaster implements IPaster<BlockCopyData, BlockSvg> {\n  static TYPE = 'block';\n\n  paste(\n    copyData: BlockCopyData,\n    workspace: WorkspaceSvg,\n    coordinate?: Coordinate,\n  ): BlockSvg | null {\n    if (!workspace.isCapacityAvailable(copyData.typeCounts!)) return null;\n\n    if (coordinate) {\n      copyData.blockState['x'] = coordinate.x;\n      copyData.blockState['y'] = coordinate.y;\n    }\n\n    eventUtils.disable();\n    let block;\n    try {\n      block = append(copyData.blockState, workspace) as BlockSvg;\n      moveBlockToNotConflict(block);\n    } finally {\n      eventUtils.enable();\n    }\n\n    if (!block) return block;\n\n    if (eventUtils.isEnabled() && !block.isShadow()) {\n      eventUtils.fire(new (eventUtils.get(eventUtils.BLOCK_CREATE))(block));\n    }\n    block.select();\n    return block;\n  }\n}\n\n/**\n * Moves the given block to a location where it does not: (1) overlap exactly\n * with any other blocks, or (2) look like it is connected to any other blocks.\n *\n * Exported for testing.\n *\n * @param block The block to move to an unambiguous location.\n * @internal\n */\nexport function moveBlockToNotConflict(block: BlockSvg) {\n  const workspace = block.workspace;\n  const snapRadius = config.snapRadius;\n  const coord = block.getRelativeToSurfaceXY();\n  const offset = new Coordinate(0, 0);\n  // getRelativeToSurfaceXY is really expensive, so we want to cache this.\n  const otherCoords = workspace\n    .getAllBlocks(false)\n    .filter((otherBlock) => otherBlock.id != block.id)\n    .map((b) => b.getRelativeToSurfaceXY());\n\n  while (\n    blockOverlapsOtherExactly(Coordinate.sum(coord, offset), otherCoords) ||\n    blockIsInSnapRadius(block, offset, snapRadius)\n  ) {\n    if (workspace.RTL) {\n      offset.translate(-snapRadius, snapRadius * 2);\n    } else {\n      offset.translate(snapRadius, snapRadius * 2);\n    }\n  }\n\n  block!.moveTo(Coordinate.sum(coord, offset));\n}\n\n/**\n * @returns true if the given block coordinates are less than a delta of 1 from\n *     any of the other coordinates.\n */\nfunction blockOverlapsOtherExactly(\n  coord: Coordinate,\n  otherCoords: Coordinate[],\n): boolean {\n  return otherCoords.some(\n    (otherCoord) =>\n      Math.abs(otherCoord.x - coord.x) <= 1 &&\n      Math.abs(otherCoord.y - coord.y) <= 1,\n  );\n}\n\n/**\n * @returns true if the given block (when offset by the given amount) is close\n *     enough to any other connections (within the snap radius) that it looks\n *     like they could connect.\n */\nfunction blockIsInSnapRadius(\n  block: BlockSvg,\n  offset: Coordinate,\n  snapRadius: number,\n): boolean {\n  return block\n    .getConnections_(false)\n    .some((connection) => !!connection.closest(snapRadius, offset).connection);\n}\n\nexport interface BlockCopyData extends ICopyData {\n  blockState: State;\n  typeCounts: {[key: string]: number};\n}\n\nregistry.register(BlockPaster.TYPE, new BlockPaster());\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.clipboard\n\nimport type {ICopyData, ICopyable} from './interfaces/i_copyable.js';\nimport {BlockPaster} from './clipboard/block_paster.js';\nimport * as globalRegistry from './registry.js';\nimport {WorkspaceSvg} from './workspace_svg.js';\nimport * as registry from './clipboard/registry.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as deprecation from './utils/deprecation.js';\n\n/** Metadata about the object that is currently on the clipboard. */\nlet stashedCopyData: ICopyData | null = null;\n\nlet stashedWorkspace: WorkspaceSvg | null = null;\n\n/**\n * Copy a copyable element onto the local clipboard.\n *\n * @param toCopy The copyable element to be copied.\n * @deprecated v11. Use `myCopyable.toCopyData()` instead. To be removed v12.\n * @internal\n */\nexport function copy<T extends ICopyData>(toCopy: ICopyable<T>): T | null {\n  deprecation.warn(\n    'Blockly.clipboard.copy',\n    'v11',\n    'v12',\n    'myCopyable.toCopyData()',\n  );\n  return TEST_ONLY.copyInternal(toCopy);\n}\n\n/**\n * Private version of copy for stubbing in tests.\n */\nfunction copyInternal<T extends ICopyData>(toCopy: ICopyable<T>): T | null {\n  const data = toCopy.toCopyData();\n  stashedCopyData = data;\n  stashedWorkspace = (toCopy as any).workspace ?? null;\n  return data;\n}\n\n/**\n * Paste a pasteable element into the workspace.\n *\n * @param copyData The data to paste into the workspace.\n * @param workspace The workspace to paste the data into.\n * @param coordinate The location to paste the thing at.\n * @returns The pasted thing if the paste was successful, null otherwise.\n */\nexport function paste<T extends ICopyData>(\n  copyData: T,\n  workspace: WorkspaceSvg,\n  coordinate?: Coordinate,\n): ICopyable<T> | null;\n\n/**\n * Pastes the last copied ICopyable into the workspace.\n *\n * @returns the pasted thing if the paste was successful, null otherwise.\n */\nexport function paste(): ICopyable<ICopyData> | null;\n\n/**\n * Pastes the given data into the workspace, or the last copied ICopyable if\n * no data is passed.\n *\n * @param copyData The data to paste into the workspace.\n * @param workspace The workspace to paste the data into.\n * @param coordinate The location to paste the thing at.\n * @returns The pasted thing if the paste was successful, null otherwise.\n */\nexport function paste<T extends ICopyData>(\n  copyData?: T,\n  workspace?: WorkspaceSvg,\n  coordinate?: Coordinate,\n): ICopyable<ICopyData> | null {\n  if (!copyData || !workspace) {\n    if (!stashedCopyData || !stashedWorkspace) return null;\n    return pasteFromData(stashedCopyData, stashedWorkspace);\n  }\n  return pasteFromData(copyData, workspace, coordinate);\n}\n\n/**\n * Paste a pasteable element into the workspace.\n *\n * @param copyData The data to paste into the workspace.\n * @param workspace The workspace to paste the data into.\n * @param coordinate The location to paste the thing at.\n * @returns The pasted thing if the paste was successful, null otherwise.\n */\nfunction pasteFromData<T extends ICopyData>(\n  copyData: T,\n  workspace: WorkspaceSvg,\n  coordinate?: Coordinate,\n): ICopyable<T> | null {\n  workspace = workspace.getRootWorkspace() ?? workspace;\n  return (globalRegistry\n    .getObject(globalRegistry.Type.PASTER, copyData.paster, false)\n    ?.paste(copyData, workspace, coordinate) ?? null) as ICopyable<T> | null;\n}\n\n/**\n * Duplicate this copy-paste-able element.\n *\n * @param toDuplicate The element to be duplicated.\n * @returns The element that was duplicated, or null if the duplication failed.\n * @deprecated v11. Use\n *     `Blockly.clipboard.paste(myCopyable.toCopyData(), myWorkspace)` instead.\n *     To be removed v12.\n * @internal\n */\nexport function duplicate<\n  U extends ICopyData,\n  T extends ICopyable<U> & IHasWorkspace,\n>(toDuplicate: T): T | null {\n  deprecation.warn(\n    'Blockly.clipboard.duplicate',\n    'v11',\n    'v12',\n    'Blockly.clipboard.paste(myCopyable.toCopyData(), myWorkspace)',\n  );\n  return TEST_ONLY.duplicateInternal(toDuplicate);\n}\n\n/**\n * Private version of duplicate for stubbing in tests.\n */\nfunction duplicateInternal<\n  U extends ICopyData,\n  T extends ICopyable<U> & IHasWorkspace,\n>(toDuplicate: T): T | null {\n  const data = toDuplicate.toCopyData();\n  if (!data) return null;\n  return paste(data, toDuplicate.workspace) as T;\n}\n\ninterface IHasWorkspace {\n  workspace: WorkspaceSvg;\n}\n\nexport const TEST_ONLY = {\n  duplicateInternal,\n  copyInternal,\n};\n\nexport {BlockPaster, registry};\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.utils.aria\n\n/** ARIA states/properties prefix. */\nconst ARIA_PREFIX = 'aria-';\n\n/** ARIA role attribute. */\nconst ROLE_ATTRIBUTE = 'role';\n\n/**\n * ARIA role values.\n * Copied from Closure's goog.a11y.aria.Role\n */\nexport enum Role {\n  // ARIA role for an interactive control of tabular data.\n  GRID = 'grid',\n\n  // ARIA role for a cell in a grid.\n  GRIDCELL = 'gridcell',\n  // ARIA role for a group of related elements like tree item siblings.\n  GROUP = 'group',\n\n  // ARIA role for a listbox.\n  LISTBOX = 'listbox',\n\n  // ARIA role for a popup menu.\n  MENU = 'menu',\n\n  // ARIA role for menu item elements.\n  MENUITEM = 'menuitem',\n  // ARIA role for a checkbox box element inside a menu.\n  MENUITEMCHECKBOX = 'menuitemcheckbox',\n  // ARIA role for option items that are  children of combobox, listbox, menu,\n  // radiogroup, or tree elements.\n  OPTION = 'option',\n  // ARIA role for ignorable cosmetic elements with no semantic significance.\n  PRESENTATION = 'presentation',\n\n  // ARIA role for a row of cells in a grid.\n  ROW = 'row',\n  // ARIA role for a tree.\n  TREE = 'tree',\n\n  // ARIA role for a tree item that sometimes may be expanded or collapsed.\n  TREEITEM = 'treeitem',\n}\n\n/**\n * ARIA states and properties.\n * Copied from Closure's goog.a11y.aria.State\n */\nexport enum State {\n  // ARIA property for setting the currently active descendant of an element,\n  // for example the selected item in a list box. Value: ID of an element.\n  ACTIVEDESCENDANT = 'activedescendant',\n  // ARIA property defines the total number of columns in a table, grid, or\n  // treegrid.\n  // Value: integer.\n  COLCOUNT = 'colcount',\n  // ARIA state for a disabled item. Value: one of {true, false}.\n  DISABLED = 'disabled',\n\n  // ARIA state for setting whether the element like a tree node is expanded.\n  // Value: one of {true, false, undefined}.\n  EXPANDED = 'expanded',\n\n  // ARIA state indicating that the entered value does not conform. Value:\n  // one of {false, true, 'grammar', 'spelling'}\n  INVALID = 'invalid',\n\n  // ARIA property that provides a label to override any other text, value, or\n  // contents used to describe this element. Value: string.\n  LABEL = 'label',\n  // ARIA property for setting the element which labels another element.\n  // Value: space-separated IDs of elements.\n  LABELLEDBY = 'labelledby',\n\n  // ARIA property for setting the level of an element in the hierarchy.\n  // Value: integer.\n  LEVEL = 'level',\n  // ARIA property indicating if the element is horizontal or vertical.\n  // Value: one of {'vertical', 'horizontal'}.\n  ORIENTATION = 'orientation',\n\n  // ARIA property that defines an element's number of position in a list.\n  // Value: integer.\n  POSINSET = 'posinset',\n\n  // ARIA property defines the total number of rows in a table, grid, or\n  // treegrid.\n  // Value: integer.\n  ROWCOUNT = 'rowcount',\n\n  // ARIA state for setting the currently selected item in the list.\n  // Value: one of {true, false, undefined}.\n  SELECTED = 'selected',\n  // ARIA property defining the number of items in a list. Value: integer.\n  SETSIZE = 'setsize',\n\n  // ARIA property for slider maximum value. Value: number.\n  VALUEMAX = 'valuemax',\n\n  // ARIA property for slider minimum value. Value: number.\n  VALUEMIN = 'valuemin',\n}\n\n/**\n * Sets the role of an element.\n *\n * Similar to Closure's goog.a11y.aria\n *\n * @param element DOM node to set role of.\n * @param roleName Role name.\n */\nexport function setRole(element: Element, roleName: Role) {\n  element.setAttribute(ROLE_ATTRIBUTE, roleName);\n}\n\n/**\n * Sets the state or property of an element.\n * Copied from Closure's goog.a11y.aria\n *\n * @param element DOM node where we set state.\n * @param stateName State attribute being set.\n *     Automatically adds prefix 'aria-' to the state name if the attribute is\n * not an extra attribute.\n * @param value Value for the state attribute.\n */\nexport function setState(\n  element: Element,\n  stateName: State,\n  value: string | boolean | number | string[],\n) {\n  if (Array.isArray(value)) {\n    value = value.join(' ');\n  }\n  const attrStateName = ARIA_PREFIX + stateName;\n  element.setAttribute(attrStateName, `${value}`);\n}\n","/**\n * @license\n * Copyright 2013 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.WidgetDiv\n\nimport * as common from './common.js';\nimport * as dom from './utils/dom.js';\nimport type {Field} from './field.js';\nimport type {Rect} from './utils/rect.js';\nimport type {Size} from './utils/size.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/** The object currently using this container. */\nlet owner: unknown = null;\n\n/** Optional cleanup function set by whichever object uses the widget. */\nlet dispose: (() => void) | null = null;\n\n/** A class name representing the current owner's workspace container. */\nconst containerClassName = 'blocklyWidgetDiv';\n\n/** A class name representing the current owner's workspace renderer. */\nlet rendererClassName = '';\n\n/** A class name representing the current owner's workspace theme. */\nlet themeClassName = '';\n\n/** The HTML container for popup overlays (e.g. editor widgets). */\nlet containerDiv: HTMLDivElement | null;\n\n/**\n * Returns the HTML container for editor widgets.\n *\n * @returns The editor widget container.\n */\nexport function getDiv(): HTMLDivElement | null {\n  return containerDiv;\n}\n\n/**\n * Allows unit tests to reset the div. Do not use outside of tests.\n *\n * @param newDiv The new value for the DIV field.\n * @internal\n */\nexport function testOnly_setDiv(newDiv: HTMLDivElement | null) {\n  containerDiv = newDiv;\n  if (newDiv === null) {\n    document.querySelector('.' + containerClassName)?.remove();\n  }\n}\n\n/**\n * Create the widget div and inject it onto the page.\n */\nexport function createDom() {\n  if (document.querySelector('.' + containerClassName)) {\n    return; // Already created.\n  }\n\n  containerDiv = document.createElement('div') as HTMLDivElement;\n  containerDiv.className = containerClassName;\n  const container = common.getParentContainer() || document.body;\n  container.appendChild(containerDiv);\n}\n\n/**\n * Initialize and display the widget div.  Close the old one if needed.\n *\n * @param newOwner The object that will be using this container.\n * @param rtl Right-to-left (true) or left-to-right (false).\n * @param newDispose Optional cleanup function to be run when the widget is\n *     closed.\n */\nexport function show(newOwner: unknown, rtl: boolean, newDispose: () => void) {\n  hide();\n  owner = newOwner;\n  dispose = newDispose;\n  const div = containerDiv;\n  if (!div) return;\n  div.style.direction = rtl ? 'rtl' : 'ltr';\n  div.style.display = 'block';\n  const mainWorkspace = common.getMainWorkspace() as WorkspaceSvg;\n  rendererClassName = mainWorkspace.getRenderer().getClassName();\n  themeClassName = mainWorkspace.getTheme().getClassName();\n  if (rendererClassName) {\n    dom.addClass(div, rendererClassName);\n  }\n  if (themeClassName) {\n    dom.addClass(div, themeClassName);\n  }\n}\n\n/**\n * Destroy the widget and hide the div.\n */\nexport function hide() {\n  if (!isVisible()) {\n    return;\n  }\n  owner = null;\n\n  const div = containerDiv;\n  if (!div) return;\n  div.style.display = 'none';\n  div.style.left = '';\n  div.style.top = '';\n  dispose && dispose();\n  dispose = null;\n  div.textContent = '';\n\n  if (rendererClassName) {\n    dom.removeClass(div, rendererClassName);\n    rendererClassName = '';\n  }\n  if (themeClassName) {\n    dom.removeClass(div, themeClassName);\n    themeClassName = '';\n  }\n  (common.getMainWorkspace() as WorkspaceSvg).markFocused();\n}\n\n/**\n * Is the container visible?\n *\n * @returns True if visible.\n */\nexport function isVisible(): boolean {\n  return !!owner;\n}\n\n/**\n * Destroy the widget and hide the div if it is being used by the specified\n * object.\n *\n * @param oldOwner The object that was using this container.\n */\nexport function hideIfOwner(oldOwner: unknown) {\n  if (owner === oldOwner) {\n    hide();\n  }\n}\n/**\n * Set the widget div's position and height.  This function does nothing clever:\n * it will not ensure that your widget div ends up in the visible window.\n *\n * @param x Horizontal location (window coordinates, not body).\n * @param y Vertical location (window coordinates, not body).\n * @param height The height of the widget div (pixels).\n */\nfunction positionInternal(x: number, y: number, height: number) {\n  containerDiv!.style.left = x + 'px';\n  containerDiv!.style.top = y + 'px';\n  containerDiv!.style.height = height + 'px';\n}\n\n/**\n * Position the widget div based on an anchor rectangle.\n * The widget should be placed adjacent to but not overlapping the anchor\n * rectangle.  The preferred position is directly below and aligned to the left\n * (LTR) or right (RTL) side of the anchor.\n *\n * @param viewportBBox The bounding rectangle of the current viewport, in window\n *     coordinates.\n * @param anchorBBox The bounding rectangle of the anchor, in window\n *     coordinates.\n * @param widgetSize The size of the widget that is inside the widget div, in\n *     window coordinates.\n * @param rtl Whether the workspace is in RTL mode.  This determines horizontal\n *     alignment.\n * @internal\n */\nexport function positionWithAnchor(\n  viewportBBox: Rect,\n  anchorBBox: Rect,\n  widgetSize: Size,\n  rtl: boolean,\n) {\n  const y = calculateY(viewportBBox, anchorBBox, widgetSize);\n  const x = calculateX(viewportBBox, anchorBBox, widgetSize, rtl);\n\n  if (y < 0) {\n    positionInternal(x, 0, widgetSize.height + y);\n  } else {\n    positionInternal(x, y, widgetSize.height);\n  }\n}\n\n/**\n * Calculate an x position (in window coordinates) such that the widget will not\n * be offscreen on the right or left.\n *\n * @param viewportBBox The bounding rectangle of the current viewport, in window\n *     coordinates.\n * @param anchorBBox The bounding rectangle of the anchor, in window\n *     coordinates.\n * @param widgetSize The dimensions of the widget inside the widget div.\n * @param rtl Whether the Blockly workspace is in RTL mode.\n * @returns A valid x-coordinate for the top left corner of the widget div, in\n *     window coordinates.\n */\nfunction calculateX(\n  viewportBBox: Rect,\n  anchorBBox: Rect,\n  widgetSize: Size,\n  rtl: boolean,\n): number {\n  if (rtl) {\n    // Try to align the right side of the field and the right side of widget.\n    const widgetLeft = anchorBBox.right - widgetSize.width;\n    // Don't go offscreen left.\n    const x = Math.max(widgetLeft, viewportBBox.left);\n    // But really don't go offscreen right:\n    return Math.min(x, viewportBBox.right - widgetSize.width);\n  } else {\n    // Try to align the left side of the field and the left side of widget.\n    // Don't go offscreen right.\n    const x = Math.min(anchorBBox.left, viewportBBox.right - widgetSize.width);\n    // But left is more important, because that's where the text is.\n    return Math.max(x, viewportBBox.left);\n  }\n}\n\n/**\n * Calculate a y position (in window coordinates) such that the widget will not\n * be offscreen on the top or bottom.\n *\n * @param viewportBBox The bounding rectangle of the current viewport, in window\n *     coordinates.\n * @param anchorBBox The bounding rectangle of the anchor, in window\n *     coordinates.\n * @param widgetSize The dimensions of the widget inside the widget div.\n * @returns A valid y-coordinate for the top left corner of the widget div, in\n *     window coordinates.\n */\nfunction calculateY(\n  viewportBBox: Rect,\n  anchorBBox: Rect,\n  widgetSize: Size,\n): number {\n  // Flip the widget vertically if off the bottom.\n  // The widget could go off the top of the window, but it would also go off\n  // the bottom.  The window is just too small.\n  if (anchorBBox.bottom + widgetSize.height >= viewportBBox.bottom) {\n    // The bottom of the widget is at the top of the field.\n    return anchorBBox.top - widgetSize.height;\n  } else {\n    // The top of the widget is at the bottom of the field.\n    return anchorBBox.bottom;\n  }\n}\n\n/**\n * Determine if the owner is a field for purposes of repositioning.\n * We can't simply check `instanceof Field` as that would introduce a circular\n * dependency.\n */\nfunction isRepositionable(item: any): item is Field {\n  return !!item?.repositionForWindowResize;\n}\n\n/**\n * Reposition the widget div if the owner of it says to.\n * If the owner isn't a field, just give up and hide it.\n */\nexport function repositionForWindowResize(): void {\n  if (!isRepositionable(owner) || !owner.repositionForWindowResize()) {\n    // If the owner is not a Field, or if the owner returns false from the\n    // reposition method, we should hide the widget div. Otherwise, we'll assume\n    // the owner handled any needed resize.\n    hide();\n  }\n}\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.ContextMenu\n\nimport type {Block} from './block.js';\nimport type {BlockSvg} from './block_svg.js';\nimport * as browserEvents from './browser_events.js';\nimport * as clipboard from './clipboard.js';\nimport {config} from './config.js';\nimport * as dom from './utils/dom.js';\nimport type {\n  ContextMenuOption,\n  LegacyContextMenuOption,\n} from './contextmenu_registry.js';\nimport * as eventUtils from './events/utils.js';\nimport {Menu} from './menu.js';\nimport {MenuItem} from './menuitem.js';\nimport {Msg} from './msg.js';\nimport * as aria from './utils/aria.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport {Rect} from './utils/rect.js';\nimport * as serializationBlocks from './serialization/blocks.js';\nimport * as svgMath from './utils/svg_math.js';\nimport * as WidgetDiv from './widgetdiv.js';\nimport {WorkspaceCommentSvg} from './workspace_comment_svg.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport * as Xml from './xml.js';\n\n/**\n * Which block is the context menu attached to?\n */\nlet currentBlock: Block | null = null;\n\nconst dummyOwner = {};\n\n/**\n * Gets the block the context menu is currently attached to.\n *\n * @returns The block the context menu is attached to.\n */\nexport function getCurrentBlock(): Block | null {\n  return currentBlock;\n}\n\n/**\n * Sets the block the context menu is currently attached to.\n *\n * @param block The block the context menu is attached to.\n */\nexport function setCurrentBlock(block: Block | null) {\n  currentBlock = block;\n}\n\n/**\n * Menu object.\n */\nlet menu_: Menu | null = null;\n\n/**\n * Construct the menu based on the list of options and show the menu.\n *\n * @param e Mouse event.\n * @param options Array of menu options.\n * @param rtl True if RTL, false if LTR.\n */\nexport function show(\n  e: Event,\n  options: (ContextMenuOption | LegacyContextMenuOption)[],\n  rtl: boolean,\n) {\n  WidgetDiv.show(dummyOwner, rtl, dispose);\n  if (!options.length) {\n    hide();\n    return;\n  }\n  const menu = populate_(options, rtl);\n  menu_ = menu;\n\n  position_(menu, e, rtl);\n  // 1ms delay is required for focusing on context menus because some other\n  // mouse event is still waiting in the queue and clears focus.\n  setTimeout(function () {\n    menu.focus();\n  }, 1);\n  currentBlock = null; // May be set by Blockly.Block.\n}\n\n/**\n * Create the context menu object and populate it with the given options.\n *\n * @param options Array of menu options.\n * @param rtl True if RTL, false if LTR.\n * @returns The menu that will be shown on right click.\n */\nfunction populate_(\n  options: (ContextMenuOption | LegacyContextMenuOption)[],\n  rtl: boolean,\n): Menu {\n  /* Here's what one option object looks like:\n      {text: 'Make It So',\n       enabled: true,\n       callback: Blockly.MakeItSo}\n    */\n  const menu = new Menu();\n  menu.setRole(aria.Role.MENU);\n  for (let i = 0; i < options.length; i++) {\n    const option = options[i];\n    const menuItem = new MenuItem(option.text);\n    menuItem.setRightToLeft(rtl);\n    menuItem.setRole(aria.Role.MENUITEM);\n    menu.addChild(menuItem);\n    menuItem.setEnabled(option.enabled);\n    if (option.enabled) {\n      const actionHandler = function () {\n        hide();\n        requestAnimationFrame(() => {\n          setTimeout(() => {\n            // If .scope does not exist on the option, then the callback\n            // will not be expecting a scope parameter, so there should be\n            // no problems. Just assume it is a ContextMenuOption and we'll\n            // pass undefined if it's not.\n            option.callback((option as ContextMenuOption).scope);\n          }, 0);\n        });\n      };\n      menuItem.onAction(actionHandler, {});\n    }\n  }\n  return menu;\n}\n\n/**\n * Add the menu to the page and position it correctly.\n *\n * @param menu The menu to add and position.\n * @param e Mouse event for the right click that is making the context\n *     menu appear.\n * @param rtl True if RTL, false if LTR.\n */\nfunction position_(menu: Menu, e: Event, rtl: boolean) {\n  // Record windowSize and scrollOffset before adding menu.\n  const viewportBBox = svgMath.getViewportBBox();\n  const mouseEvent = e as MouseEvent;\n  // This one is just a point, but we'll pretend that it's a rect so we can use\n  // some helper functions.\n  const anchorBBox = new Rect(\n    mouseEvent.clientY + viewportBBox.top,\n    mouseEvent.clientY + viewportBBox.top,\n    mouseEvent.clientX + viewportBBox.left,\n    mouseEvent.clientX + viewportBBox.left,\n  );\n\n  createWidget_(menu);\n  const menuSize = menu.getSize();\n\n  if (rtl) {\n    anchorBBox.left += menuSize.width;\n    anchorBBox.right += menuSize.width;\n    viewportBBox.left += menuSize.width;\n    viewportBBox.right += menuSize.width;\n  }\n\n  WidgetDiv.positionWithAnchor(viewportBBox, anchorBBox, menuSize, rtl);\n  // Calling menuDom.focus() has to wait until after the menu has been placed\n  // correctly.  Otherwise it will cause a page scroll to get the misplaced menu\n  // in view.  See issue #1329.\n  menu.focus();\n}\n\n/**\n * Create and render the menu widget inside Blockly's widget div.\n *\n * @param menu The menu to add to the widget div.\n */\nfunction createWidget_(menu: Menu) {\n  const div = WidgetDiv.getDiv();\n  if (!div) {\n    throw Error('Attempting to create a context menu when widget div is null');\n  }\n  const menuDom = menu.render(div);\n  dom.addClass(menuDom, 'blocklyContextMenu');\n  // Prevent system context menu when right-clicking a Blockly context menu.\n  browserEvents.conditionalBind(\n    menuDom as EventTarget,\n    'contextmenu',\n    null,\n    haltPropagation,\n  );\n  // Focus only after the initial render to avoid issue #1329.\n  menu.focus();\n}\n/**\n * Halts the propagation of the event without doing anything else.\n *\n * @param e An event.\n */\nfunction haltPropagation(e: Event) {\n  // This event has been handled.  No need to bubble up to the document.\n  e.preventDefault();\n  e.stopPropagation();\n}\n\n/**\n * Hide the context menu.\n */\nexport function hide() {\n  WidgetDiv.hideIfOwner(dummyOwner);\n  currentBlock = null;\n}\n\n/**\n * Dispose of the menu.\n */\nexport function dispose() {\n  if (menu_) {\n    menu_.dispose();\n    menu_ = null;\n  }\n}\n\n/**\n * Create a callback function that creates and configures a block,\n *   then places the new block next to the original and returns it.\n *\n * @param block Original block.\n * @param state XML or JSON object representation of the new block.\n * @returns Function that creates a block.\n */\nexport function callbackFactory(\n  block: Block,\n  state: Element | serializationBlocks.State,\n): () => BlockSvg {\n  return () => {\n    eventUtils.disable();\n    let newBlock: BlockSvg;\n    try {\n      if (state instanceof Element) {\n        newBlock = Xml.domToBlockInternal(state, block.workspace!) as BlockSvg;\n      } else {\n        newBlock = serializationBlocks.appendInternal(\n          state,\n          block.workspace,\n        ) as BlockSvg;\n      }\n      // Move the new block next to the old block.\n      const xy = block.getRelativeToSurfaceXY();\n      if (block.RTL) {\n        xy.x -= config.snapRadius;\n      } else {\n        xy.x += config.snapRadius;\n      }\n      xy.y += config.snapRadius * 2;\n      newBlock.moveBy(xy.x, xy.y);\n    } finally {\n      eventUtils.enable();\n    }\n    if (eventUtils.isEnabled() && !newBlock.isShadow()) {\n      eventUtils.fire(new (eventUtils.get(eventUtils.BLOCK_CREATE))(newBlock));\n    }\n    newBlock.select();\n    return newBlock;\n  };\n}\n\n// Helper functions for creating context menu options.\n\n/**\n * Make a context menu option for deleting the current workspace comment.\n *\n * @param comment The workspace comment where the\n *     right-click originated.\n * @returns A menu option,\n *     containing text, enabled, and a callback.\n * @internal\n */\nexport function commentDeleteOption(\n  comment: WorkspaceCommentSvg,\n): LegacyContextMenuOption {\n  const deleteOption = {\n    text: Msg['REMOVE_COMMENT'],\n    enabled: true,\n    callback: function () {\n      eventUtils.setGroup(true);\n      comment.dispose();\n      eventUtils.setGroup(false);\n    },\n  };\n  return deleteOption;\n}\n\n/**\n * Make a context menu option for duplicating the current workspace comment.\n *\n * @param comment The workspace comment where the\n *     right-click originated.\n * @returns A menu option,\n *     containing text, enabled, and a callback.\n * @internal\n */\nexport function commentDuplicateOption(\n  comment: WorkspaceCommentSvg,\n): LegacyContextMenuOption {\n  const duplicateOption = {\n    text: Msg['DUPLICATE_COMMENT'],\n    enabled: true,\n    callback: function () {\n      const data = comment.toCopyData();\n      if (!data) return;\n      clipboard.paste(data, comment.workspace);\n    },\n  };\n  return duplicateOption;\n}\n\n/**\n * Make a context menu option for adding a comment on the workspace.\n *\n * @param ws The workspace where the right-click\n *     originated.\n * @param e The right-click mouse event.\n * @returns A menu option, containing text, enabled, and a callback.\n *     comments are not bundled in.\n * @internal\n */\nexport function workspaceCommentOption(\n  ws: WorkspaceSvg,\n  e: Event,\n): ContextMenuOption {\n  /**\n   * Helper function to create and position a comment correctly based on the\n   * location of the mouse event.\n   */\n  function addWsComment() {\n    const comment = new WorkspaceCommentSvg(\n      ws,\n      Msg['WORKSPACE_COMMENT_DEFAULT_TEXT'],\n      WorkspaceCommentSvg.DEFAULT_SIZE,\n      WorkspaceCommentSvg.DEFAULT_SIZE,\n    );\n\n    const injectionDiv = ws.getInjectionDiv();\n    // Bounding rect coordinates are in client coordinates, meaning that they\n    // are in pixels relative to the upper left corner of the visible browser\n    // window.  These coordinates change when you scroll the browser window.\n    const boundingRect = injectionDiv.getBoundingClientRect();\n\n    // The client coordinates offset by the injection div's upper left corner.\n    const mouseEvent = e as MouseEvent;\n    const clientOffsetPixels = new Coordinate(\n      mouseEvent.clientX - boundingRect.left,\n      mouseEvent.clientY - boundingRect.top,\n    );\n\n    // The offset in pixels between the main workspace's origin and the upper\n    // left corner of the injection div.\n    const mainOffsetPixels = ws.getOriginOffsetInPixels();\n\n    // The position of the new comment in pixels relative to the origin of the\n    // main workspace.\n    const finalOffset = Coordinate.difference(\n      clientOffsetPixels,\n      mainOffsetPixels,\n    );\n    // The position of the new comment in main workspace coordinates.\n    finalOffset.scale(1 / ws.scale);\n\n    const commentX = finalOffset.x;\n    const commentY = finalOffset.y;\n    comment.moveBy(commentX, commentY);\n    if (ws.rendered) {\n      comment.initSvg();\n      comment.render();\n      comment.select();\n    }\n  }\n\n  const wsCommentOption = {\n    enabled: true,\n  } as ContextMenuOption;\n  wsCommentOption.text = Msg['ADD_COMMENT'];\n  wsCommentOption.callback = function () {\n    addWsComment();\n  };\n  return wsCommentOption;\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.utils.math\n\n/**\n * Converts degrees to radians.\n * Copied from Closure's goog.math.toRadians.\n *\n * @param angleDegrees Angle in degrees.\n * @returns Angle in radians.\n */\nexport function toRadians(angleDegrees: number): number {\n  return (angleDegrees * Math.PI) / 180;\n}\n\n/**\n * Converts radians to degrees.\n * Copied from Closure's goog.math.toDegrees.\n *\n * @param angleRadians Angle in radians.\n * @returns Angle in degrees.\n */\nexport function toDegrees(angleRadians: number): number {\n  return (angleRadians * 180) / Math.PI;\n}\n\n/**\n * Clamp the provided number between the lower bound and the upper bound.\n *\n * @param lowerBound The desired lower bound.\n * @param number The number to clamp.\n * @param upperBound The desired upper bound.\n * @returns The clamped number.\n */\nexport function clamp(\n  lowerBound: number,\n  number: number,\n  upperBound: number,\n): number {\n  if (upperBound < lowerBound) {\n    const temp = upperBound;\n    upperBound = lowerBound;\n    lowerBound = temp;\n  }\n  return Math.max(lowerBound, Math.min(number, upperBound));\n}\n","/**\n * @license\n * Copyright 2016 Massachusetts Institute of Technology\n * All rights reserved.\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * A div that floats on top of the workspace, for drop-down menus.\n *\n * @class\n */\n// Former goog.module ID: Blockly.dropDownDiv\n\nimport type {BlockSvg} from './block_svg.js';\nimport * as common from './common.js';\nimport * as dom from './utils/dom.js';\nimport type {Field} from './field.js';\nimport * as math from './utils/math.js';\nimport {Rect} from './utils/rect.js';\nimport type {Size} from './utils/size.js';\nimport * as style from './utils/style.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Arrow size in px. Should match the value in CSS\n * (need to position pre-render).\n */\nexport const ARROW_SIZE = 16;\n\n/**\n * Drop-down border size in px. Should match the value in CSS (need to position\n * the arrow).\n */\nexport const BORDER_SIZE = 1;\n\n/**\n * Amount the arrow must be kept away from the edges of the main drop-down div,\n * in px.\n */\nexport const ARROW_HORIZONTAL_PADDING = 12;\n\n/** Amount drop-downs should be padded away from the source, in px. */\nexport const PADDING_Y = 16;\n\n/** Length of animations in seconds. */\nexport const ANIMATION_TIME = 0.25;\n\n/**\n * Timer for animation out, to be cleared if we need to immediately hide\n * without disrupting new shows.\n */\nlet animateOutTimer: ReturnType<typeof setTimeout> | null = null;\n\n/** Callback for when the drop-down is hidden. */\nlet onHide: Function | null = null;\n\n/** A class name representing the current owner's workspace renderer. */\nlet renderedClassName = '';\n\n/** A class name representing the current owner's workspace theme. */\nlet themeClassName = '';\n\n/** The content element. */\nlet div: HTMLDivElement;\n\n/** The content element. */\nlet content: HTMLDivElement;\n\n/** The arrow element. */\nlet arrow: HTMLDivElement;\n\n/**\n * Drop-downs will appear within the bounds of this element if possible.\n * Set in setBoundsElement.\n */\nlet boundsElement: Element | null = null;\n\n/** The object currently using the drop-down. */\nlet owner: Field | null = null;\n\n/** Whether the dropdown was positioned to a field or the source block. */\nlet positionToField: boolean | null = null;\n\n/**\n * Dropdown bounds info object used to encapsulate sizing information about a\n * bounding element (bounding box and width/height).\n */\nexport interface BoundsInfo {\n  top: number;\n  left: number;\n  bottom: number;\n  right: number;\n  width: number;\n  height: number;\n}\n\n/** Dropdown position metrics. */\nexport interface PositionMetrics {\n  initialX: number;\n  initialY: number;\n  finalX: number;\n  finalY: number;\n  arrowX: number | null;\n  arrowY: number | null;\n  arrowAtTop: boolean | null;\n  arrowVisible: boolean;\n}\n\n/**\n * Create and insert the DOM element for this div.\n *\n * @internal\n */\nexport function createDom() {\n  if (document.querySelector('.blocklyDropDownDiv')) {\n    return; // Already created.\n  }\n  div = document.createElement('div');\n  div.className = 'blocklyDropDownDiv';\n  const parentDiv = common.getParentContainer() || document.body;\n  parentDiv.appendChild(div);\n\n  content = document.createElement('div');\n  content.className = 'blocklyDropDownContent';\n  div.appendChild(content);\n\n  arrow = document.createElement('div');\n  arrow.className = 'blocklyDropDownArrow';\n  div.appendChild(arrow);\n\n  div.style.opacity = '0';\n  // Transition animation for transform: translate() and opacity.\n  div.style.transition =\n    'transform ' + ANIMATION_TIME + 's, ' + 'opacity ' + ANIMATION_TIME + 's';\n\n  // Handle focusin/out events to add a visual indicator when\n  // a child is focused or blurred.\n  div.addEventListener('focusin', function () {\n    dom.addClass(div, 'blocklyFocused');\n  });\n  div.addEventListener('focusout', function () {\n    dom.removeClass(div, 'blocklyFocused');\n  });\n}\n\n/**\n * Set an element to maintain bounds within. Drop-downs will appear\n * within the box of this element if possible.\n *\n * @param boundsElem Element to bind drop-down to.\n */\nexport function setBoundsElement(boundsElem: Element | null) {\n  boundsElement = boundsElem;\n}\n\n/**\n * @returns The field that currently owns this, or null.\n */\nexport function getOwner(): Field | null {\n  return owner;\n}\n\n/**\n * Provide the div for inserting content into the drop-down.\n *\n * @returns Div to populate with content.\n */\nexport function getContentDiv(): Element {\n  return content;\n}\n\n/** Clear the content of the drop-down. */\nexport function clearContent() {\n  content.textContent = '';\n  content.style.width = '';\n}\n\n/**\n * Set the colour for the drop-down.\n *\n * @param backgroundColour Any CSS colour for the background.\n * @param borderColour Any CSS colour for the border.\n */\nexport function setColour(backgroundColour: string, borderColour: string) {\n  div.style.backgroundColor = backgroundColour;\n  div.style.borderColor = borderColour;\n}\n\n/**\n * Shortcut to show and place the drop-down with positioning determined\n * by a particular block. The primary position will be below the block,\n * and the secondary position above the block. Drop-down will be\n * constrained to the block's workspace.\n *\n * @param field The field showing the drop-down.\n * @param block Block to position the drop-down around.\n * @param opt_onHide Optional callback for when the drop-down is hidden.\n * @param opt_secondaryYOffset Optional Y offset for above-block positioning.\n * @returns True if the menu rendered below block; false if above.\n */\nexport function showPositionedByBlock<T>(\n  field: Field<T>,\n  block: BlockSvg,\n  opt_onHide?: Function,\n  opt_secondaryYOffset?: number,\n): boolean {\n  return showPositionedByRect(\n    getScaledBboxOfBlock(block),\n    field as Field,\n    opt_onHide,\n    opt_secondaryYOffset,\n  );\n}\n\n/**\n * Shortcut to show and place the drop-down with positioning determined\n * by a particular field. The primary position will be below the field,\n * and the secondary position above the field. Drop-down will be\n * constrained to the block's workspace.\n *\n * @param field The field to position the dropdown against.\n * @param opt_onHide Optional callback for when the drop-down is hidden.\n * @param opt_secondaryYOffset Optional Y offset for above-block positioning.\n * @returns True if the menu rendered below block; false if above.\n */\nexport function showPositionedByField<T>(\n  field: Field<T>,\n  opt_onHide?: Function,\n  opt_secondaryYOffset?: number,\n): boolean {\n  positionToField = true;\n  return showPositionedByRect(\n    getScaledBboxOfField(field as Field),\n    field as Field,\n    opt_onHide,\n    opt_secondaryYOffset,\n  );\n}\n/**\n * Get the scaled bounding box of a block.\n *\n * @param block The block.\n * @returns The scaled bounding box of the block.\n */\nfunction getScaledBboxOfBlock(block: BlockSvg): Rect {\n  const blockSvg = block.getSvgRoot();\n  const scale = block.workspace.scale;\n  const scaledHeight = block.height * scale;\n  const scaledWidth = block.width * scale;\n  const xy = style.getPageOffset(blockSvg);\n  return new Rect(xy.y, xy.y + scaledHeight, xy.x, xy.x + scaledWidth);\n}\n\n/**\n * Get the scaled bounding box of a field.\n *\n * @param field The field.\n * @returns The scaled bounding box of the field.\n */\nfunction getScaledBboxOfField(field: Field): Rect {\n  const bBox = field.getScaledBBox();\n  return new Rect(bBox.top, bBox.bottom, bBox.left, bBox.right);\n}\n\n/**\n * Helper method to show and place the drop-down with positioning determined\n * by a scaled bounding box.  The primary position will be below the rect,\n * and the secondary position above the rect. Drop-down will be constrained to\n * the block's workspace.\n *\n * @param bBox The scaled bounding box.\n * @param field The field to position the dropdown against.\n * @param opt_onHide Optional callback for when the drop-down is hidden.\n * @param opt_secondaryYOffset Optional Y offset for above-block positioning.\n * @returns True if the menu rendered below block; false if above.\n */\nfunction showPositionedByRect(\n  bBox: Rect,\n  field: Field,\n  opt_onHide?: Function,\n  opt_secondaryYOffset?: number,\n): boolean {\n  // If we can fit it, render below the block.\n  const primaryX = bBox.left + (bBox.right - bBox.left) / 2;\n  const primaryY = bBox.bottom;\n  // If we can't fit it, render above the entire parent block.\n  const secondaryX = primaryX;\n  let secondaryY = bBox.top;\n  if (opt_secondaryYOffset) {\n    secondaryY += opt_secondaryYOffset;\n  }\n  const sourceBlock = field.getSourceBlock() as BlockSvg;\n  // Set bounds to main workspace; show the drop-down.\n  let workspace = sourceBlock.workspace;\n  while (workspace.options.parentWorkspace) {\n    workspace = workspace.options.parentWorkspace;\n  }\n  setBoundsElement(workspace.getParentSvg().parentNode as Element | null);\n  return show(\n    field,\n    sourceBlock.RTL,\n    primaryX,\n    primaryY,\n    secondaryX,\n    secondaryY,\n    opt_onHide,\n  );\n}\n\n/**\n * Show and place the drop-down.\n * The drop-down is placed with an absolute \"origin point\" (x, y) - i.e.,\n * the arrow will point at this origin and box will positioned below or above\n * it.  If we can maintain the container bounds at the primary point, the arrow\n * will point there, and the container will be positioned below it.\n * If we can't maintain the container bounds at the primary point, fall-back to\n * the secondary point and position above.\n *\n * @param newOwner The object showing the drop-down\n * @param rtl Right-to-left (true) or left-to-right (false).\n * @param primaryX Desired origin point x, in absolute px.\n * @param primaryY Desired origin point y, in absolute px.\n * @param secondaryX Secondary/alternative origin point x, in absolute px.\n * @param secondaryY Secondary/alternative origin point y, in absolute px.\n * @param opt_onHide Optional callback for when the drop-down is hidden.\n * @returns True if the menu rendered at the primary origin point.\n * @internal\n */\nexport function show<T>(\n  newOwner: Field<T>,\n  rtl: boolean,\n  primaryX: number,\n  primaryY: number,\n  secondaryX: number,\n  secondaryY: number,\n  opt_onHide?: Function,\n): boolean {\n  owner = newOwner as Field;\n  onHide = opt_onHide || null;\n  // Set direction.\n  div.style.direction = rtl ? 'rtl' : 'ltr';\n\n  const mainWorkspace = common.getMainWorkspace() as WorkspaceSvg;\n  renderedClassName = mainWorkspace.getRenderer().getClassName();\n  themeClassName = mainWorkspace.getTheme().getClassName();\n  if (renderedClassName) {\n    dom.addClass(div, renderedClassName);\n  }\n  if (themeClassName) {\n    dom.addClass(div, themeClassName);\n  }\n\n  // When we change `translate` multiple times in close succession,\n  // Chrome may choose to wait and apply them all at once.\n  // Since we want the translation to initial X, Y to be immediate,\n  // and the translation to final X, Y to be animated,\n  // we saw problems where both would be applied after animation was turned on,\n  // making the dropdown appear to fly in from (0, 0).\n  // Using both `left`, `top` for the initial translation and then `translate`\n  // for the animated transition to final X, Y is a workaround.\n  return positionInternal(primaryX, primaryY, secondaryX, secondaryY);\n}\n\nconst internal = {\n  /**\n   * Get sizing info about the bounding element.\n   *\n   * @returns An object containing size information about the bounding element\n   *     (bounding box and width/height).\n   */\n  getBoundsInfo: function (): BoundsInfo {\n    const boundPosition = style.getPageOffset(boundsElement as Element);\n    const boundSize = style.getSize(boundsElement as Element);\n\n    return {\n      left: boundPosition.x,\n      right: boundPosition.x + boundSize.width,\n      top: boundPosition.y,\n      bottom: boundPosition.y + boundSize.height,\n      width: boundSize.width,\n      height: boundSize.height,\n    };\n  },\n\n  /**\n   * Helper to position the drop-down and the arrow, maintaining bounds.\n   * See explanation of origin points in show.\n   *\n   * @param primaryX Desired origin point x, in absolute px.\n   * @param primaryY Desired origin point y, in absolute px.\n   * @param secondaryX Secondary/alternative origin point x, in absolute px.\n   * @param secondaryY Secondary/alternative origin point y, in absolute px.\n   * @returns Various final metrics, including rendered positions for drop-down\n   *     and arrow.\n   */\n  getPositionMetrics: function (\n    primaryX: number,\n    primaryY: number,\n    secondaryX: number,\n    secondaryY: number,\n  ): PositionMetrics {\n    const boundsInfo = internal.getBoundsInfo();\n    const divSize = style.getSize(div as Element);\n\n    // Can we fit in-bounds below the target?\n    if (primaryY + divSize.height < boundsInfo.bottom) {\n      return getPositionBelowMetrics(primaryX, primaryY, boundsInfo, divSize);\n    }\n    // Can we fit in-bounds above the target?\n    if (secondaryY - divSize.height > boundsInfo.top) {\n      return getPositionAboveMetrics(\n        secondaryX,\n        secondaryY,\n        boundsInfo,\n        divSize,\n      );\n    }\n    // Can we fit outside the workspace bounds (but inside the window)\n    // below?\n    if (primaryY + divSize.height < document.documentElement.clientHeight) {\n      return getPositionBelowMetrics(primaryX, primaryY, boundsInfo, divSize);\n    }\n    // Can we fit outside the workspace bounds (but inside the window)\n    // above?\n    if (secondaryY - divSize.height > document.documentElement.clientTop) {\n      return getPositionAboveMetrics(\n        secondaryX,\n        secondaryY,\n        boundsInfo,\n        divSize,\n      );\n    }\n\n    // Last resort, render at top of page.\n    return getPositionTopOfPageMetrics(primaryX, boundsInfo, divSize);\n  },\n};\n\n/**\n * Get the metrics for positioning the div below the source.\n *\n * @param primaryX Desired origin point x, in absolute px.\n * @param primaryY Desired origin point y, in absolute px.\n * @param boundsInfo An object containing size information about the bounding\n *     element (bounding box and width/height).\n * @param divSize An object containing information about the size of the\n *     DropDownDiv (width & height).\n * @returns Various final metrics, including rendered positions for drop-down\n *     and arrow.\n */\nfunction getPositionBelowMetrics(\n  primaryX: number,\n  primaryY: number,\n  boundsInfo: BoundsInfo,\n  divSize: Size,\n): PositionMetrics {\n  const xCoords = getPositionX(\n    primaryX,\n    boundsInfo.left,\n    boundsInfo.right,\n    divSize.width,\n  );\n\n  const arrowY = -(ARROW_SIZE / 2 + BORDER_SIZE);\n  const finalY = primaryY + PADDING_Y;\n\n  return {\n    initialX: xCoords.divX,\n    initialY: primaryY,\n    finalX: xCoords.divX, // X position remains constant during animation.\n    finalY,\n    arrowX: xCoords.arrowX,\n    arrowY,\n    arrowAtTop: true,\n    arrowVisible: true,\n  };\n}\n\n/**\n * Get the metrics for positioning the div above the source.\n *\n * @param secondaryX Secondary/alternative origin point x, in absolute px.\n * @param secondaryY Secondary/alternative origin point y, in absolute px.\n * @param boundsInfo An object containing size information about the bounding\n *     element (bounding box and width/height).\n * @param divSize An object containing information about the size of the\n *     DropDownDiv (width & height).\n * @returns Various final metrics, including rendered positions for drop-down\n *     and arrow.\n */\nfunction getPositionAboveMetrics(\n  secondaryX: number,\n  secondaryY: number,\n  boundsInfo: BoundsInfo,\n  divSize: Size,\n): PositionMetrics {\n  const xCoords = getPositionX(\n    secondaryX,\n    boundsInfo.left,\n    boundsInfo.right,\n    divSize.width,\n  );\n\n  const arrowY = divSize.height - BORDER_SIZE * 2 - ARROW_SIZE / 2;\n  const finalY = secondaryY - divSize.height - PADDING_Y;\n  const initialY = secondaryY - divSize.height; // No padding on Y.\n\n  return {\n    initialX: xCoords.divX,\n    initialY,\n    finalX: xCoords.divX, // X position remains constant during animation.\n    finalY,\n    arrowX: xCoords.arrowX,\n    arrowY,\n    arrowAtTop: false,\n    arrowVisible: true,\n  };\n}\n\n/**\n * Get the metrics for positioning the div at the top of the page.\n *\n * @param sourceX Desired origin point x, in absolute px.\n * @param boundsInfo An object containing size information about the bounding\n *     element (bounding box and width/height).\n * @param divSize An object containing information about the size of the\n *     DropDownDiv (width & height).\n * @returns Various final metrics, including rendered positions for drop-down\n *     and arrow.\n */\nfunction getPositionTopOfPageMetrics(\n  sourceX: number,\n  boundsInfo: BoundsInfo,\n  divSize: Size,\n): PositionMetrics {\n  const xCoords = getPositionX(\n    sourceX,\n    boundsInfo.left,\n    boundsInfo.right,\n    divSize.width,\n  );\n\n  // No need to provide arrow-specific information because it won't be visible.\n  return {\n    initialX: xCoords.divX,\n    initialY: 0,\n    finalX: xCoords.divX, // X position remains constant during animation.\n    finalY: 0, // Y position remains constant during animation.\n    arrowAtTop: null,\n    arrowX: null,\n    arrowY: null,\n    arrowVisible: false,\n  };\n}\n\n/**\n * Get the x positions for the left side of the DropDownDiv and the arrow,\n * accounting for the bounds of the workspace.\n *\n * @param sourceX Desired origin point x, in absolute px.\n * @param boundsLeft The left edge of the bounding element, in absolute px.\n * @param boundsRight The right edge of the bounding element, in absolute px.\n * @param divWidth The width of the div in px.\n * @returns An object containing metrics for the x positions of the left side of\n *     the DropDownDiv and the arrow.\n * @internal\n */\nexport function getPositionX(\n  sourceX: number,\n  boundsLeft: number,\n  boundsRight: number,\n  divWidth: number,\n): {divX: number; arrowX: number} {\n  let divX = sourceX;\n  // Offset the topLeft coord so that the dropdowndiv is centered.\n  divX -= divWidth / 2;\n  // Fit the dropdowndiv within the bounds of the workspace.\n  divX = math.clamp(boundsLeft, divX, boundsRight - divWidth);\n\n  let arrowX = sourceX;\n  // Offset the arrow coord so that the arrow is centered.\n  arrowX -= ARROW_SIZE / 2;\n  // Convert the arrow position to be relative to the top left of the div.\n  let relativeArrowX = arrowX - divX;\n  const horizPadding = ARROW_HORIZONTAL_PADDING;\n  // Clamp the arrow position so that it stays attached to the dropdowndiv.\n  relativeArrowX = math.clamp(\n    horizPadding,\n    relativeArrowX,\n    divWidth - horizPadding - ARROW_SIZE,\n  );\n\n  return {arrowX: relativeArrowX, divX};\n}\n\n/**\n * Is the container visible?\n *\n * @returns True if visible.\n */\nexport function isVisible(): boolean {\n  return !!owner;\n}\n\n/**\n * Hide the menu only if it is owned by the provided object.\n *\n * @param divOwner Object which must be owning the drop-down to hide.\n * @param opt_withoutAnimation True if we should hide the dropdown without\n *     animating.\n * @returns True if hidden.\n */\nexport function hideIfOwner<T>(\n  divOwner: Field<T>,\n  opt_withoutAnimation?: boolean,\n): boolean {\n  if (owner === divOwner) {\n    if (opt_withoutAnimation) {\n      hideWithoutAnimation();\n    } else {\n      hide();\n    }\n    return true;\n  }\n  return false;\n}\n\n/** Hide the menu, triggering animation. */\nexport function hide() {\n  // Start the animation by setting the translation and fading out.\n  // Reset to (initialX, initialY) - i.e., no translation.\n  div.style.transform = 'translate(0, 0)';\n  div.style.opacity = '0';\n  // Finish animation - reset all values to default.\n  animateOutTimer = setTimeout(function () {\n    hideWithoutAnimation();\n  }, ANIMATION_TIME * 1000);\n  if (onHide) {\n    onHide();\n    onHide = null;\n  }\n}\n\n/** Hide the menu, without animation. */\nexport function hideWithoutAnimation() {\n  if (!isVisible()) {\n    return;\n  }\n  if (animateOutTimer) {\n    clearTimeout(animateOutTimer);\n  }\n\n  // Reset style properties in case this gets called directly\n  // instead of hide() - see discussion on #2551.\n  div.style.transform = '';\n  div.style.left = '';\n  div.style.top = '';\n  div.style.opacity = '0';\n  div.style.display = 'none';\n  div.style.backgroundColor = '';\n  div.style.borderColor = '';\n\n  if (onHide) {\n    onHide();\n    onHide = null;\n  }\n  clearContent();\n  owner = null;\n\n  if (renderedClassName) {\n    dom.removeClass(div, renderedClassName);\n    renderedClassName = '';\n  }\n  if (themeClassName) {\n    dom.removeClass(div, themeClassName);\n    themeClassName = '';\n  }\n  (common.getMainWorkspace() as WorkspaceSvg).markFocused();\n}\n\n/**\n * Set the dropdown div's position.\n *\n * @param primaryX Desired origin point x, in absolute px.\n * @param primaryY Desired origin point y, in absolute px.\n * @param secondaryX Secondary/alternative origin point x, in absolute px.\n * @param secondaryY Secondary/alternative origin point y, in absolute px.\n * @returns True if the menu rendered at the primary origin point.\n */\nfunction positionInternal(\n  primaryX: number,\n  primaryY: number,\n  secondaryX: number,\n  secondaryY: number,\n): boolean {\n  const metrics = internal.getPositionMetrics(\n    primaryX,\n    primaryY,\n    secondaryX,\n    secondaryY,\n  );\n\n  // Update arrow CSS.\n  if (metrics.arrowVisible) {\n    arrow.style.display = '';\n    arrow.style.transform =\n      'translate(' +\n      metrics.arrowX +\n      'px,' +\n      metrics.arrowY +\n      'px) rotate(45deg)';\n    arrow.setAttribute(\n      'class',\n      metrics.arrowAtTop\n        ? 'blocklyDropDownArrow blocklyArrowTop'\n        : 'blocklyDropDownArrow blocklyArrowBottom',\n    );\n  } else {\n    arrow.style.display = 'none';\n  }\n\n  const initialX = Math.floor(metrics.initialX);\n  const initialY = Math.floor(metrics.initialY);\n  const finalX = Math.floor(metrics.finalX);\n  const finalY = Math.floor(metrics.finalY);\n\n  // First apply initial translation.\n  div.style.left = initialX + 'px';\n  div.style.top = initialY + 'px';\n\n  // Show the div.\n  div.style.display = 'block';\n  div.style.opacity = '1';\n  // Add final translate, animated through `transition`.\n  // Coordinates are relative to (initialX, initialY),\n  // where the drop-down is absolutely positioned.\n  const dx = finalX - initialX;\n  const dy = finalY - initialY;\n  div.style.transform = 'translate(' + dx + 'px,' + dy + 'px)';\n\n  return !!metrics.arrowAtTop;\n}\n\n/**\n * Repositions the dropdownDiv on window resize. If it doesn't know how to\n * calculate the new position, it will just hide it instead.\n *\n * @internal\n */\nexport function repositionForWindowResize() {\n  // This condition mainly catches the dropdown div when it is being used as a\n  // dropdown.  It is important not to close it in this case because on Android,\n  // when a field is focused, the soft keyboard opens triggering a window resize\n  // event and we want the dropdown div to stick around so users can type into\n  // it.\n  if (owner) {\n    const block = owner.getSourceBlock() as BlockSvg;\n    const bBox = positionToField\n      ? getScaledBboxOfField(owner)\n      : getScaledBboxOfBlock(block);\n    // If we can fit it, render below the block.\n    const primaryX = bBox.left + (bBox.right - bBox.left) / 2;\n    const primaryY = bBox.bottom;\n    // If we can't fit it, render above the entire parent block.\n    const secondaryX = primaryX;\n    const secondaryY = bBox.top;\n    positionInternal(primaryX, primaryY, secondaryX, secondaryY);\n  } else {\n    hide();\n  }\n}\n\nexport const TEST_ONLY = internal;\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockAnimations\n\nimport type {BlockSvg} from './block_svg.js';\nimport * as dom from './utils/dom.js';\nimport {Svg} from './utils/svg.js';\n\n/** A bounding box for a cloned block. */\ninterface CloneRect {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n}\n\n/** PID of disconnect UI animation.  There can only be one at a time. */\nlet disconnectPid: ReturnType<typeof setTimeout> | null = null;\n\n/** The wobbling block.  There can only be one at a time. */\nlet wobblingBlock: BlockSvg | null = null;\n\n/**\n * Play some UI effects (sound, animation) when disposing of a block.\n *\n * @param block The block being disposed of.\n * @internal\n */\nexport function disposeUiEffect(block: BlockSvg) {\n  // Disposing is going to take so long the animation won't play anyway.\n  if (block.getDescendants(false).length > 100) return;\n\n  const workspace = block.workspace;\n  const svgGroup = block.getSvgRoot();\n  workspace.getAudioManager().play('delete');\n\n  const xy = workspace.getSvgXY(svgGroup);\n  // Deeply clone the current block.\n  const clone: SVGGElement = svgGroup.cloneNode(true) as SVGGElement;\n  clone.setAttribute('transform', 'translate(' + xy.x + ',' + xy.y + ')');\n  workspace.getParentSvg().appendChild(clone);\n  const cloneRect = {\n    'x': xy.x,\n    'y': xy.y,\n    'width': block.width,\n    'height': block.height,\n  };\n  disposeUiStep(clone, cloneRect, workspace.RTL, new Date(), workspace.scale);\n}\n/**\n * Animate a cloned block and eventually dispose of it.\n * This is a class method, not an instance method since the original block has\n * been destroyed and is no longer accessible.\n *\n * @param clone SVG element to animate and dispose of.\n * @param rect Starting rect of the clone.\n * @param rtl True if RTL, false if LTR.\n * @param start Date of animation's start.\n * @param workspaceScale Scale of workspace.\n */\nfunction disposeUiStep(\n  clone: Element,\n  rect: CloneRect,\n  rtl: boolean,\n  start: Date,\n  workspaceScale: number,\n) {\n  const ms = new Date().getTime() - start.getTime();\n  const percent = ms / 150;\n  if (percent > 1) {\n    dom.removeNode(clone);\n  } else {\n    const x =\n      rect.x + (((rtl ? -1 : 1) * rect.width * workspaceScale) / 2) * percent;\n    const y = rect.y + rect.height * workspaceScale * percent;\n    const scale = (1 - percent) * workspaceScale;\n    clone.setAttribute(\n      'transform',\n      'translate(' + x + ',' + y + ')' + ' scale(' + scale + ')',\n    );\n    setTimeout(disposeUiStep, 10, clone, rect, rtl, start, workspaceScale);\n  }\n}\n\n/**\n * Play some UI effects (sound, ripple) after a connection has been established.\n *\n * @param block The block being connected.\n * @internal\n */\nexport function connectionUiEffect(block: BlockSvg) {\n  const workspace = block.workspace;\n  const scale = workspace.scale;\n  workspace.getAudioManager().play('click');\n  if (scale < 1) {\n    return; // Too small to care about visual effects.\n  }\n  // Determine the absolute coordinates of the inferior block.\n  const xy = workspace.getSvgXY(block.getSvgRoot());\n  // Offset the coordinates based on the two connection types, fix scale.\n  if (block.outputConnection) {\n    xy.x += (block.RTL ? 3 : -3) * scale;\n    xy.y += 13 * scale;\n  } else if (block.previousConnection) {\n    xy.x += (block.RTL ? -23 : 23) * scale;\n    xy.y += 3 * scale;\n  }\n  const ripple = dom.createSvgElement(\n    Svg.CIRCLE,\n    {\n      'cx': xy.x,\n      'cy': xy.y,\n      'r': 0,\n      'fill': 'none',\n      'stroke': '#888',\n      'stroke-width': 10,\n    },\n    workspace.getParentSvg(),\n  );\n\n  const scaleAnimation = dom.createSvgElement(\n    Svg.ANIMATE,\n    {\n      'id': 'animationCircle',\n      'begin': 'indefinite',\n      'attributeName': 'r',\n      'dur': '150ms',\n      'from': 0,\n      'to': 25 * scale,\n    },\n    ripple,\n  );\n  const opacityAnimation = dom.createSvgElement(\n    Svg.ANIMATE,\n    {\n      'id': 'animationOpacity',\n      'begin': 'indefinite',\n      'attributeName': 'opacity',\n      'dur': '150ms',\n      'from': 1,\n      'to': 0,\n    },\n    ripple,\n  );\n\n  scaleAnimation.beginElement();\n  opacityAnimation.beginElement();\n\n  setTimeout(() => void dom.removeNode(ripple), 150);\n}\n\n/**\n * Play some UI effects (sound, animation) when disconnecting a block.\n *\n * @param block The block being disconnected.\n * @internal\n */\nexport function disconnectUiEffect(block: BlockSvg) {\n  disconnectUiStop();\n  block.workspace.getAudioManager().play('disconnect');\n  if (block.workspace.scale < 1) {\n    return; // Too small to care about visual effects.\n  }\n  // Horizontal distance for bottom of block to wiggle.\n  const DISPLACEMENT = 10;\n  // Scale magnitude of skew to height of block.\n  const height = block.getHeightWidth().height;\n  let magnitude = (Math.atan(DISPLACEMENT / height) / Math.PI) * 180;\n  if (!block.RTL) {\n    magnitude *= -1;\n  }\n  // Start the animation.\n  wobblingBlock = block;\n  disconnectUiStep(block, magnitude, new Date());\n}\n\n/**\n * Animate a brief wiggle of a disconnected block.\n *\n * @param block Block to animate.\n * @param magnitude Maximum degrees skew (reversed for RTL).\n * @param start Date of animation's start.\n */\nfunction disconnectUiStep(block: BlockSvg, magnitude: number, start: Date) {\n  const DURATION = 200; // Milliseconds.\n  const WIGGLES = 3; // Half oscillations.\n\n  const ms = new Date().getTime() - start.getTime();\n  const percent = ms / DURATION;\n\n  let skew = '';\n  if (percent <= 1) {\n    const val = Math.round(\n      Math.sin(percent * Math.PI * WIGGLES) * (1 - percent) * magnitude,\n    );\n    skew = `skewX(${val})`;\n    disconnectPid = setTimeout(disconnectUiStep, 10, block, magnitude, start);\n  }\n\n  block\n    .getSvgRoot()\n    .setAttribute('transform', `${block.getTranslation()} ${skew}`);\n}\n\n/**\n * Stop the disconnect UI animation immediately.\n *\n * @internal\n */\nexport function disconnectUiStop() {\n  if (!wobblingBlock) return;\n  if (disconnectPid) {\n    clearTimeout(disconnectPid);\n    disconnectPid = null;\n  }\n  wobblingBlock\n    .getSvgRoot()\n    .setAttribute('transform', wobblingBlock.getTranslation());\n  wobblingBlock = null;\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.utils.string\n\nimport * as deprecation from './deprecation.js';\n\n/**\n * Fast prefix-checker.\n * Copied from Closure's goog.string.startsWith.\n *\n * @param str The string to check.\n * @param prefix A string to look for at the start of `str`.\n * @returns True if `str` begins with `prefix`.\n * @deprecated Use built-in **string.startsWith** instead.\n */\nexport function startsWith(str: string, prefix: string): boolean {\n  deprecation.warn(\n    'Blockly.utils.string.startsWith()',\n    'April 2022',\n    'April 2023',\n    'Use built-in string.startsWith',\n  );\n  return str.startsWith(prefix);\n}\n\n/**\n * Given an array of strings, return the length of the shortest one.\n *\n * @param array Array of strings.\n * @returns Length of shortest string.\n */\nexport function shortestStringLength(array: string[]): number {\n  if (!array.length) {\n    return 0;\n  }\n  return array.reduce(function (a, b) {\n    return a.length < b.length ? a : b;\n  }).length;\n}\n\n/**\n * Given an array of strings, return the length of the common prefix.\n * Words may not be split.  Any space after a word is included in the length.\n *\n * @param array Array of strings.\n * @param opt_shortest Length of shortest string.\n * @returns Length of common prefix.\n */\nexport function commonWordPrefix(\n  array: string[],\n  opt_shortest?: number,\n): number {\n  if (!array.length) {\n    return 0;\n  } else if (array.length === 1) {\n    return array[0].length;\n  }\n  let wordPrefix = 0;\n  const max = opt_shortest || shortestStringLength(array);\n  let len;\n  for (len = 0; len < max; len++) {\n    const letter = array[0][len];\n    for (let i = 1; i < array.length; i++) {\n      if (letter !== array[i][len]) {\n        return wordPrefix;\n      }\n    }\n    if (letter === ' ') {\n      wordPrefix = len + 1;\n    }\n  }\n  for (let i = 1; i < array.length; i++) {\n    const letter = array[i][len];\n    if (letter && letter !== ' ') {\n      return wordPrefix;\n    }\n  }\n  return max;\n}\n\n/**\n * Given an array of strings, return the length of the common suffix.\n * Words may not be split.  Any space after a word is included in the length.\n *\n * @param array Array of strings.\n * @param opt_shortest Length of shortest string.\n * @returns Length of common suffix.\n */\nexport function commonWordSuffix(\n  array: string[],\n  opt_shortest?: number,\n): number {\n  if (!array.length) {\n    return 0;\n  } else if (array.length === 1) {\n    return array[0].length;\n  }\n  let wordPrefix = 0;\n  const max = opt_shortest || shortestStringLength(array);\n  let len;\n  for (len = 0; len < max; len++) {\n    const letter = array[0].substr(-len - 1, 1);\n    for (let i = 1; i < array.length; i++) {\n      if (letter !== array[i].substr(-len - 1, 1)) {\n        return wordPrefix;\n      }\n    }\n    if (letter === ' ') {\n      wordPrefix = len + 1;\n    }\n  }\n  for (let i = 1; i < array.length; i++) {\n    const letter = array[i].charAt(array[i].length - len - 1);\n    if (letter && letter !== ' ') {\n      return wordPrefix;\n    }\n  }\n  return max;\n}\n\n/**\n * Wrap text to the specified width.\n *\n * @param text Text to wrap.\n * @param limit Width to wrap each line.\n * @returns Wrapped text.\n */\nexport function wrap(text: string, limit: number): string {\n  const lines = text.split('\\n');\n  for (let i = 0; i < lines.length; i++) {\n    lines[i] = wrapLine(lines[i], limit);\n  }\n  return lines.join('\\n');\n}\n\n/**\n * Wrap single line of text to the specified width.\n *\n * @param text Text to wrap.\n * @param limit Width to wrap each line.\n * @returns Wrapped text.\n */\nfunction wrapLine(text: string, limit: number): string {\n  if (text.length <= limit) {\n    // Short text, no need to wrap.\n    return text;\n  }\n  // Split the text into words.\n  const words = text.trim().split(/\\s+/);\n  // Set limit to be the length of the largest word.\n  for (let i = 0; i < words.length; i++) {\n    if (words[i].length > limit) {\n      limit = words[i].length;\n    }\n  }\n\n  let lastScore;\n  let score = -Infinity;\n  let lastText;\n  let lineCount = 1;\n  do {\n    lastScore = score;\n    lastText = text;\n    // Create a list of booleans representing if a space (false) or\n    // a break (true) appears after each word.\n    let wordBreaks = [];\n    // Seed the list with evenly spaced linebreaks.\n    const steps = words.length / lineCount;\n    let insertedBreaks = 1;\n    for (let i = 0; i < words.length - 1; i++) {\n      if (insertedBreaks < (i + 1.5) / steps) {\n        insertedBreaks++;\n        wordBreaks[i] = true;\n      } else {\n        wordBreaks[i] = false;\n      }\n    }\n    wordBreaks = wrapMutate(words, wordBreaks, limit);\n    score = wrapScore(words, wordBreaks, limit);\n    text = wrapToText(words, wordBreaks);\n    lineCount++;\n  } while (score > lastScore);\n  return lastText;\n}\n\n/**\n * Compute a score for how good the wrapping is.\n *\n * @param words Array of each word.\n * @param wordBreaks Array of line breaks.\n * @param limit Width to wrap each line.\n * @returns Larger the better.\n */\nfunction wrapScore(\n  words: string[],\n  wordBreaks: boolean[],\n  limit: number,\n): number {\n  // If this function becomes a performance liability, add caching.\n  // Compute the length of each line.\n  const lineLengths = [0];\n  const linePunctuation = [];\n  for (let i = 0; i < words.length; i++) {\n    lineLengths[lineLengths.length - 1] += words[i].length;\n    if (wordBreaks[i] === true) {\n      lineLengths.push(0);\n      linePunctuation.push(words[i].charAt(words[i].length - 1));\n    } else if (wordBreaks[i] === false) {\n      lineLengths[lineLengths.length - 1]++;\n    }\n  }\n  const maxLength = Math.max(...lineLengths);\n\n  let score = 0;\n  for (let i = 0; i < lineLengths.length; i++) {\n    // Optimize for width.\n    // -2 points per char over limit (scaled to the power of 1.5).\n    score -= Math.pow(Math.abs(limit - lineLengths[i]), 1.5) * 2;\n    // Optimize for even lines.\n    // -1 point per char smaller than max (scaled to the power of 1.5).\n    score -= Math.pow(maxLength - lineLengths[i], 1.5);\n    // Optimize for structure.\n    // Add score to line endings after punctuation.\n    if ('.?!'.indexOf(linePunctuation[i]) !== -1) {\n      score += limit / 3;\n    } else if (',;)]}'.indexOf(linePunctuation[i]) !== -1) {\n      score += limit / 4;\n    }\n  }\n  // All else being equal, the last line should not be longer than the\n  // previous line.  For example, this looks wrong:\n  // aaa bbb\n  // ccc ddd eee\n  if (\n    lineLengths.length > 1 &&\n    lineLengths[lineLengths.length - 1] <= lineLengths[lineLengths.length - 2]\n  ) {\n    score += 0.5;\n  }\n  return score;\n}\n/**\n * Mutate the array of line break locations until an optimal solution is found.\n * No line breaks are added or deleted, they are simply moved around.\n *\n * @param words Array of each word.\n * @param wordBreaks Array of line breaks.\n * @param limit Width to wrap each line.\n * @returns New array of optimal line breaks.\n */\nfunction wrapMutate(\n  words: string[],\n  wordBreaks: boolean[],\n  limit: number,\n): boolean[] {\n  let bestScore = wrapScore(words, wordBreaks, limit);\n  let bestBreaks;\n  // Try shifting every line break forward or backward.\n  for (let i = 0; i < wordBreaks.length - 1; i++) {\n    if (wordBreaks[i] === wordBreaks[i + 1]) {\n      continue;\n    }\n    const mutatedWordBreaks = new Array<boolean>().concat(wordBreaks);\n    mutatedWordBreaks[i] = !mutatedWordBreaks[i];\n    mutatedWordBreaks[i + 1] = !mutatedWordBreaks[i + 1];\n    const mutatedScore = wrapScore(words, mutatedWordBreaks, limit);\n    if (mutatedScore > bestScore) {\n      bestScore = mutatedScore;\n      bestBreaks = mutatedWordBreaks;\n    }\n  }\n  if (bestBreaks) {\n    // Found an improvement.  See if it may be improved further.\n    return wrapMutate(words, bestBreaks, limit);\n  }\n  // No improvements found.  Done.\n  return wordBreaks;\n}\n\n/**\n * Reassemble the array of words into text, with the specified line breaks.\n *\n * @param words Array of each word.\n * @param wordBreaks Array of line breaks.\n * @returns Plain text.\n */\nfunction wrapToText(words: string[], wordBreaks: boolean[]): string {\n  const text = [];\n  for (let i = 0; i < words.length; i++) {\n    text.push(words[i]);\n    if (wordBreaks[i] !== undefined) {\n      text.push(wordBreaks[i] ? '\\n' : ' ');\n    }\n  }\n  return text.join('');\n}\n\n/**\n * Is the given string a number (includes negative and decimals).\n *\n * @param str Input string.\n * @returns True if number, false otherwise.\n */\nexport function isNumber(str: string): boolean {\n  return /^\\s*-?\\d+(\\.\\d+)?\\s*$/.test(str);\n}\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.Tooltip\n\nimport * as browserEvents from './browser_events.js';\nimport * as common from './common.js';\nimport * as blocklyString from './utils/string.js';\n\n/**\n * A type which can define a tooltip.\n * Either a string, an object containing a tooltip property, or a function which\n * returns either a string, or another arbitrarily nested function which\n * eventually unwinds to a string.\n */\nexport type TipInfo =\n  | string\n  | {tooltip: AnyDuringMigration}\n  | (() => TipInfo | string | Function);\n\n/**\n * A function that renders custom tooltip UI.\n * 1st parameter: the div element to render content into.\n * 2nd parameter: the element being moused over (i.e., the element for which the\n * tooltip should be shown).\n */\nexport type CustomTooltip = (p1: Element, p2: Element) => AnyDuringMigration;\n\n/**\n * An optional function that renders custom tooltips into the provided DIV. If\n * this is defined, the function will be called instead of rendering the default\n * tooltip UI.\n */\nlet customTooltip: CustomTooltip | undefined = undefined;\n\n/**\n * Sets a custom function that will be called if present instead of the default\n * tooltip UI.\n *\n * @param customFn A custom tooltip used to render an alternate tooltip UI.\n */\nexport function setCustomTooltip(customFn: CustomTooltip) {\n  customTooltip = customFn;\n}\n\n/**\n * Gets the custom tooltip function.\n *\n * @returns The custom tooltip function, if defined.\n */\nexport function getCustomTooltip(): CustomTooltip | undefined {\n  return customTooltip;\n}\n\n/** Is a tooltip currently showing? */\nlet visible = false;\n\n/**\n * Returns whether or not a tooltip is showing\n *\n * @returns True if a tooltip is showing\n */\nexport function isVisible(): boolean {\n  return visible;\n}\n\n/** Is someone else blocking the tooltip from being shown? */\nlet blocked = false;\n\n/**\n * Maximum width (in characters) of a tooltip.\n */\nexport const LIMIT = 50;\n\n/** PID of suspended thread to clear tooltip on mouse out. */\nlet mouseOutPid: AnyDuringMigration = 0;\n\n/** PID of suspended thread to show the tooltip. */\nlet showPid: AnyDuringMigration = 0;\n\n/**\n * Last observed X location of the mouse pointer (freezes when tooltip appears).\n */\nlet lastX = 0;\n\n/**\n * Last observed Y location of the mouse pointer (freezes when tooltip appears).\n */\nlet lastY = 0;\n\n/** Current element being pointed at. */\nlet element: AnyDuringMigration = null;\n\n/**\n * Once a tooltip has opened for an element, that element is 'poisoned' and\n * cannot respawn a tooltip until the pointer moves over a different element.\n */\nlet poisonedElement: AnyDuringMigration = null;\n\n/**\n * Horizontal offset between mouse cursor and tooltip.\n */\nexport const OFFSET_X = 0;\n\n/**\n * Vertical offset between mouse cursor and tooltip.\n */\nexport const OFFSET_Y = 10;\n\n/**\n * Radius mouse can move before killing tooltip.\n */\nexport const RADIUS_OK = 10;\n\n/**\n * Delay before tooltip appears.\n */\nexport const HOVER_MS = 750;\n\n/**\n * Horizontal padding between tooltip and screen edge.\n */\nexport const MARGINS = 5;\n\n/** The HTML container.  Set once by createDom. */\nlet containerDiv: HTMLDivElement | null = null;\n\n/**\n * Returns the HTML tooltip container.\n *\n * @returns The HTML tooltip container.\n */\nexport function getDiv(): HTMLDivElement | null {\n  return containerDiv;\n}\n\n/**\n * Returns the tooltip text for the given element.\n *\n * @param object The object to get the tooltip text of.\n * @returns The tooltip text of the element.\n */\nexport function getTooltipOfObject(object: AnyDuringMigration | null): string {\n  const obj = getTargetObject(object);\n  if (obj) {\n    let tooltip = obj.tooltip;\n    while (typeof tooltip === 'function') {\n      tooltip = tooltip();\n    }\n    if (typeof tooltip !== 'string') {\n      throw Error('Tooltip function must return a string.');\n    }\n    return tooltip;\n  }\n  return '';\n}\n\n/**\n * Returns the target object that the given object is targeting for its\n * tooltip. Could be the object itself.\n *\n * @param obj The object are trying to find the target tooltip object of.\n * @returns The target tooltip object.\n */\nfunction getTargetObject(\n  obj: object | null,\n): {tooltip: AnyDuringMigration} | null {\n  while (obj && (obj as any).tooltip) {\n    if (\n      typeof (obj as any).tooltip === 'string' ||\n      typeof (obj as any).tooltip === 'function'\n    ) {\n      return obj as {tooltip: string | (() => string)};\n    }\n    obj = (obj as any).tooltip;\n  }\n  return null;\n}\n\n/**\n * Create the tooltip div and inject it onto the page.\n */\nexport function createDom() {\n  if (document.querySelector('.blocklyTooltipDiv')) {\n    return; // Already created.\n  }\n  // Create an HTML container for popup overlays (e.g. editor widgets).\n  containerDiv = document.createElement('div');\n  containerDiv.className = 'blocklyTooltipDiv';\n  const container = common.getParentContainer() || document.body;\n  container.appendChild(containerDiv);\n}\n\n/**\n * Binds the required mouse events onto an SVG element.\n *\n * @param element SVG element onto which tooltip is to be bound.\n */\nexport function bindMouseEvents(element: Element) {\n  // TODO (#6097): Don't stash wrapper info on the DOM.\n  (element as AnyDuringMigration).mouseOverWrapper_ = browserEvents.bind(\n    element,\n    'pointerover',\n    null,\n    onMouseOver,\n  );\n  (element as AnyDuringMigration).mouseOutWrapper_ = browserEvents.bind(\n    element,\n    'pointerout',\n    null,\n    onMouseOut,\n  );\n\n  // Don't use bindEvent_ for mousemove since that would create a\n  // corresponding touch handler, even though this only makes sense in the\n  // context of a mouseover/mouseout.\n  element.addEventListener('pointermove', onMouseMove, false);\n}\n\n/**\n * Unbinds tooltip mouse events from the SVG element.\n *\n * @param element SVG element onto which tooltip is bound.\n */\nexport function unbindMouseEvents(element: Element | null) {\n  if (!element) {\n    return;\n  }\n  // TODO (#6097): Don't stash wrapper info on the DOM.\n  browserEvents.unbind((element as AnyDuringMigration).mouseOverWrapper_);\n  browserEvents.unbind((element as AnyDuringMigration).mouseOutWrapper_);\n  element.removeEventListener('pointermove', onMouseMove);\n}\n\n/**\n * Hide the tooltip if the mouse is over a different object.\n * Initialize the tooltip to potentially appear for this object.\n *\n * @param e Mouse event.\n */\nfunction onMouseOver(e: PointerEvent) {\n  if (blocked) {\n    // Someone doesn't want us to show tooltips.\n    return;\n  }\n  // If the tooltip is an object, treat it as a pointer to the next object in\n  // the chain to look at.  Terminate when a string or function is found.\n  const newElement = getTargetObject(e.currentTarget);\n  if (element !== newElement) {\n    hide();\n    poisonedElement = null;\n    element = newElement;\n  }\n  // Forget about any immediately preceding mouseOut event.\n  clearTimeout(mouseOutPid);\n}\n\n/**\n * Hide the tooltip if the mouse leaves the object and enters the workspace.\n *\n * @param _e Mouse event.\n */\nfunction onMouseOut(_e: PointerEvent) {\n  if (blocked) {\n    // Someone doesn't want us to show tooltips.\n    return;\n  }\n  // Moving from one element to another (overlapping or with no gap) generates\n  // a mouseOut followed instantly by a mouseOver.  Fork off the mouseOut\n  // event and kill it if a mouseOver is received immediately.\n  // This way the task only fully executes if mousing into the void.\n  mouseOutPid = setTimeout(function () {\n    element = null;\n    poisonedElement = null;\n    hide();\n  }, 1);\n  clearTimeout(showPid);\n  showPid = 0;\n}\n\n/**\n * When hovering over an element, schedule a tooltip to be shown.  If a tooltip\n * is already visible, hide it if the mouse strays out of a certain radius.\n *\n * @param e Mouse event.\n */\nfunction onMouseMove(e: Event) {\n  if (!element || !(element as AnyDuringMigration).tooltip) {\n    // No tooltip here to show.\n    return;\n  } else if (blocked) {\n    // Someone doesn't want us to show tooltips.  We are probably handling a\n    // user gesture, such as a click or drag.\n    return;\n  }\n  if (visible) {\n    // Compute the distance between the mouse position when the tooltip was\n    // shown and the current mouse position.  Pythagorean theorem.\n    // AnyDuringMigration because:  Property 'pageX' does not exist on type\n    // 'Event'.\n    const dx = lastX - (e as AnyDuringMigration).pageX;\n    // AnyDuringMigration because:  Property 'pageY' does not exist on type\n    // 'Event'.\n    const dy = lastY - (e as AnyDuringMigration).pageY;\n    if (Math.sqrt(dx * dx + dy * dy) > RADIUS_OK) {\n      hide();\n    }\n  } else if (poisonedElement !== element) {\n    // The mouse moved, clear any previously scheduled tooltip.\n    clearTimeout(showPid);\n    // Maybe this time the mouse will stay put.  Schedule showing of tooltip.\n    // AnyDuringMigration because:  Property 'pageX' does not exist on type\n    // 'Event'.\n    lastX = (e as AnyDuringMigration).pageX;\n    // AnyDuringMigration because:  Property 'pageY' does not exist on type\n    // 'Event'.\n    lastY = (e as AnyDuringMigration).pageY;\n    showPid = setTimeout(show, HOVER_MS);\n  }\n}\n\n/**\n * Dispose of the tooltip.\n *\n * @internal\n */\nexport function dispose() {\n  element = null;\n  poisonedElement = null;\n  hide();\n}\n\n/**\n * Hide the tooltip.\n */\nexport function hide() {\n  if (visible) {\n    visible = false;\n    if (containerDiv) {\n      containerDiv.style.display = 'none';\n    }\n  }\n  if (showPid) {\n    clearTimeout(showPid);\n    showPid = 0;\n  }\n}\n\n/**\n * Hide any in-progress tooltips and block showing new tooltips until the next\n * call to unblock().\n *\n * @internal\n */\nexport function block() {\n  hide();\n  blocked = true;\n}\n\n/**\n * Unblock tooltips: allow them to be scheduled and shown according to their own\n * logic.\n *\n * @internal\n */\nexport function unblock() {\n  blocked = false;\n}\n\n/** Renders the tooltip content into the tooltip div. */\nfunction renderContent() {\n  if (!containerDiv || !element) {\n    // This shouldn't happen, but if it does, we can't render.\n    return;\n  }\n  if (typeof customTooltip === 'function') {\n    customTooltip(containerDiv, element);\n  } else {\n    renderDefaultContent();\n  }\n}\n\n/** Renders the default tooltip UI. */\nfunction renderDefaultContent() {\n  let tip = getTooltipOfObject(element);\n  tip = blocklyString.wrap(tip, LIMIT);\n  // Create new text, line by line.\n  const lines = tip.split('\\n');\n  for (let i = 0; i < lines.length; i++) {\n    const div = document.createElement('div');\n    div.appendChild(document.createTextNode(lines[i]));\n    containerDiv!.appendChild(div);\n  }\n}\n\n/**\n * Gets the coordinates for the tooltip div, taking into account the edges of\n * the screen to prevent showing the tooltip offscreen.\n *\n * @param rtl True if the tooltip should be in right-to-left layout.\n * @returns Coordinates at which the tooltip div should be placed.\n */\nfunction getPosition(rtl: boolean): {x: number; y: number} {\n  // Position the tooltip just below the cursor.\n  const windowWidth = document.documentElement.clientWidth;\n  const windowHeight = document.documentElement.clientHeight;\n\n  let anchorX = lastX;\n  if (rtl) {\n    anchorX -= OFFSET_X + containerDiv!.offsetWidth;\n  } else {\n    anchorX += OFFSET_X;\n  }\n\n  let anchorY = lastY + OFFSET_Y;\n  if (anchorY + containerDiv!.offsetHeight > windowHeight + window.scrollY) {\n    // Falling off the bottom of the screen; shift the tooltip up.\n    anchorY -= containerDiv!.offsetHeight + 2 * OFFSET_Y;\n  }\n\n  if (rtl) {\n    // Prevent falling off left edge in RTL mode.\n    anchorX = Math.max(MARGINS - window.scrollX, anchorX);\n  } else {\n    if (\n      anchorX + containerDiv!.offsetWidth >\n      windowWidth + window.scrollX - 2 * MARGINS\n    ) {\n      // Falling off the right edge of the screen;\n      // clamp the tooltip on the edge.\n      anchorX = windowWidth - containerDiv!.offsetWidth - 2 * MARGINS;\n    }\n  }\n\n  return {x: anchorX, y: anchorY};\n}\n\n/** Create the tooltip and show it. */\nfunction show() {\n  if (blocked) {\n    // Someone doesn't want us to show tooltips.\n    return;\n  }\n  poisonedElement = element;\n  if (!containerDiv) {\n    return;\n  }\n  // Erase all existing text.\n  containerDiv.textContent = '';\n\n  // Add new content.\n  renderContent();\n\n  // Display the tooltip.\n  const rtl = (element as any).RTL;\n  containerDiv.style.direction = rtl ? 'rtl' : 'ltr';\n  containerDiv.style.display = 'block';\n  visible = true;\n\n  const {x, y} = getPosition(rtl);\n  containerDiv.style.left = x + 'px';\n  containerDiv.style.top = y + 'px';\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.utils.object\n\n/**\n * Complete a deep merge of all members of a source object with a target object.\n *\n * @param target Target.\n * @param source Source.\n * @returns The resulting object.\n */\nexport function deepMerge(\n  target: AnyDuringMigration,\n  source: AnyDuringMigration,\n): AnyDuringMigration {\n  for (const x in source) {\n    if (source[x] !== null && typeof source[x] === 'object') {\n      target[x] = deepMerge(target[x] || Object.create(null), source[x]);\n    } else {\n      target[x] = source[x];\n    }\n  }\n  return target;\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport interface IHasBubble {\n  /** @returns True if the bubble is currently open, false otherwise. */\n  bubbleIsVisible(): boolean;\n\n  /** Sets whether the bubble is open or not. */\n  setBubbleVisible(visible: boolean): void;\n}\n\n/** Type guard that checks whether the given object is a IHasBubble. */\nexport function hasBubble(obj: any): obj is IHasBubble {\n  return (\n    obj.bubbleIsVisible !== undefined && obj.setBubbleVisible !== undefined\n  );\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.utils.colour\n\n/**\n * The richness of block colours, regardless of the hue.\n * Must be in the range of 0 (inclusive) to 1 (exclusive).\n */\nlet hsvSaturation = 0.45;\n\n/**\n * Get the richness of block colours, regardless of the hue.\n *\n * @returns The current richness.\n * @internal\n */\nexport function getHsvSaturation(): number {\n  return hsvSaturation;\n}\n\n/**\n * Set the richness of block colours, regardless of the hue.\n *\n * @param newSaturation The new richness, in the range of  0 (inclusive) to 1\n *     (exclusive)\n * @internal\n */\nexport function setHsvSaturation(newSaturation: number) {\n  hsvSaturation = newSaturation;\n}\n\n/**\n * The intensity of block colours, regardless of the hue.\n * Must be in the range of 0 (inclusive) to 1 (exclusive).\n */\nlet hsvValue = 0.65;\n\n/**\n * Get the intensity of block colours, regardless of the hue.\n *\n * @returns The current intensity.\n * @internal\n */\nexport function getHsvValue(): number {\n  return hsvValue;\n}\n\n/**\n * Set the intensity of block colours, regardless of the hue.\n *\n * @param newValue The new intensity, in the range of  0 (inclusive) to 1\n *     (exclusive)\n * @internal\n */\nexport function setHsvValue(newValue: number) {\n  hsvValue = newValue;\n}\n\n/**\n * Parses a colour from a string.\n * .parse('red') = '#ff0000'\n * .parse('#f00') = '#ff0000'\n * .parse('#ff0000') = '#ff0000'\n * .parse('0xff0000') = '#ff0000'\n * .parse('rgb(255, 0, 0)') = '#ff0000'\n *\n * @param str Colour in some CSS format.\n * @returns A string containing a hex representation of the colour, or null if\n *     can't be parsed.\n */\nexport function parse(str: string | number): string | null {\n  str = `${str}`.toLowerCase().trim();\n  let hex = names[str];\n  if (hex) {\n    // e.g. 'red'\n    return hex;\n  }\n  hex = str.substring(0, 2) === '0x' ? '#' + str.substring(2) : str;\n  hex = hex[0] === '#' ? hex : '#' + hex;\n  if (/^#[0-9a-f]{6}$/.test(hex)) {\n    // e.g. '#00ff88'\n    return hex;\n  }\n  if (/^#[0-9a-f]{3}$/.test(hex)) {\n    // e.g. '#0f8'\n    return ['#', hex[1], hex[1], hex[2], hex[2], hex[3], hex[3]].join('');\n  }\n  const rgb = str.match(/^(?:rgb)?\\s*\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*\\)$/);\n  if (rgb) {\n    // e.g. 'rgb(0, 128, 255)'\n    const r = Number(rgb[1]);\n    const g = Number(rgb[2]);\n    const b = Number(rgb[3]);\n    if (r >= 0 && r < 256 && g >= 0 && g < 256 && b >= 0 && b < 256) {\n      return rgbToHex(r, g, b);\n    }\n  }\n  return null;\n}\n\n/**\n * Converts a colour from RGB to hex representation.\n *\n * @param r Amount of red, int between 0 and 255.\n * @param g Amount of green, int between 0 and 255.\n * @param b Amount of blue, int between 0 and 255.\n * @returns Hex representation of the colour.\n */\nexport function rgbToHex(r: number, g: number, b: number): string {\n  const rgb = (r << 16) | (g << 8) | b;\n  if (r < 0x10) {\n    return '#' + (0x1000000 | rgb).toString(16).substr(1);\n  }\n  return '#' + rgb.toString(16);\n}\n\n/**\n * Converts a colour to RGB.\n *\n * @param colour String representing colour in any colour format ('#ff0000',\n *     'red', '0xff000', etc).\n * @returns RGB representation of the colour.\n */\nexport function hexToRgb(colour: string): number[] {\n  const hex = parse(colour);\n  if (!hex) {\n    return [0, 0, 0];\n  }\n\n  const rgb = parseInt(hex.substr(1), 16);\n  const r = rgb >> 16;\n  const g = (rgb >> 8) & 255;\n  const b = rgb & 255;\n\n  return [r, g, b];\n}\n\n/**\n * Converts an HSV triplet to hex representation.\n *\n * @param h Hue value in [0, 360].\n * @param s Saturation value in [0, 1].\n * @param v Brightness in [0, 255].\n * @returns Hex representation of the colour.\n */\nexport function hsvToHex(h: number, s: number, v: number): string {\n  let red = 0;\n  let green = 0;\n  let blue = 0;\n  if (s === 0) {\n    red = v;\n    green = v;\n    blue = v;\n  } else {\n    const sextant = Math.floor(h / 60);\n    const remainder = h / 60 - sextant;\n    const val1 = v * (1 - s);\n    const val2 = v * (1 - s * remainder);\n    const val3 = v * (1 - s * (1 - remainder));\n    switch (sextant) {\n      case 1:\n        red = val2;\n        green = v;\n        blue = val1;\n        break;\n      case 2:\n        red = val1;\n        green = v;\n        blue = val3;\n        break;\n      case 3:\n        red = val1;\n        green = val2;\n        blue = v;\n        break;\n      case 4:\n        red = val3;\n        green = val1;\n        blue = v;\n        break;\n      case 5:\n        red = v;\n        green = val1;\n        blue = val2;\n        break;\n      case 6:\n      case 0:\n        red = v;\n        green = val3;\n        blue = val1;\n        break;\n    }\n  }\n  return rgbToHex(Math.floor(red), Math.floor(green), Math.floor(blue));\n}\n\n/**\n * Blend two colours together, using the specified factor to indicate the\n * weight given to the first colour.\n *\n * @param colour1 First colour.\n * @param colour2 Second colour.\n * @param factor The weight to be given to colour1 over colour2.\n *     Values should be in the range [0, 1].\n * @returns Combined colour represented in hex.\n */\nexport function blend(\n  colour1: string,\n  colour2: string,\n  factor: number,\n): string | null {\n  const hex1 = parse(colour1);\n  if (!hex1) {\n    return null;\n  }\n  const hex2 = parse(colour2);\n  if (!hex2) {\n    return null;\n  }\n  const rgb1 = hexToRgb(hex1);\n  const rgb2 = hexToRgb(hex2);\n  const r = Math.round(rgb2[0] + factor * (rgb1[0] - rgb2[0]));\n  const g = Math.round(rgb2[1] + factor * (rgb1[1] - rgb2[1]));\n  const b = Math.round(rgb2[2] + factor * (rgb1[2] - rgb2[2]));\n  return rgbToHex(r, g, b);\n}\n\n/**\n * A map that contains the 16 basic colour keywords as defined by W3C:\n * https://www.w3.org/TR/2018/REC-css-color-3-20180619/#html4\n * The keys of this map are the lowercase \"readable\" names of the colours,\n * while the values are the \"hex\" values.\n */\nexport const names: {[key: string]: string} = {\n  'aqua': '#00ffff',\n  'black': '#000000',\n  'blue': '#0000ff',\n  'fuchsia': '#ff00ff',\n  'gray': '#808080',\n  'green': '#008000',\n  'lime': '#00ff00',\n  'maroon': '#800000',\n  'navy': '#000080',\n  'olive': '#808000',\n  'purple': '#800080',\n  'red': '#ff0000',\n  'silver': '#c0c0c0',\n  'teal': '#008080',\n  'white': '#ffffff',\n  'yellow': '#ffff00',\n};\n\n/**\n * Convert a hue (HSV model) into an RGB hex triplet.\n *\n * @param hue Hue on a colour wheel (0-360).\n * @returns RGB code, e.g. '#5ba65b'.\n */\nexport function hueToHex(hue: number): string {\n  return hsvToHex(hue, hsvSaturation, hsvValue * 255);\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.utils.parsing\n\nimport {Msg} from '../msg.js';\n\nimport * as colourUtils from './colour.js';\n\n/**\n * Internal implementation of the message reference and interpolation token\n * parsing used by tokenizeInterpolation() and replaceMessageReferences().\n *\n * @param message Text which might contain string table references and\n *     interpolation tokens.\n * @param parseInterpolationTokens Option to parse numeric interpolation\n *     tokens (%1, %2, ...) when true.\n * @param tokenizeNewlines Split individual newline characters into separate\n *     tokens when true.\n * @returns Array of strings and numbers.\n */\nfunction tokenizeInterpolationInternal(\n  message: string,\n  parseInterpolationTokens: boolean,\n  tokenizeNewlines: boolean,\n): (string | number)[] {\n  const tokens = [];\n  const chars = message.split('');\n  chars.push(''); // End marker.\n  // Parse the message with a finite state machine.\n  // 0 - Base case.\n  // 1 - % found.\n  // 2 - Digit found.\n  // 3 - Message ref found.\n  let state = 0;\n  const buffer = new Array<string>();\n  let number = null;\n  for (let i = 0; i < chars.length; i++) {\n    const c = chars[i];\n    if (state === 0) {\n      // Start escape.\n      if (c === '%') {\n        const text = buffer.join('');\n        if (text) {\n          tokens.push(text);\n        }\n        buffer.length = 0;\n        state = 1;\n      } else if (tokenizeNewlines && c === '\\n') {\n        // Output newline characters as single-character tokens, to be replaced\n        // with endOfRow dummies during interpolation.\n        const text = buffer.join('');\n        if (text) {\n          tokens.push(text);\n        }\n        buffer.length = 0;\n        tokens.push(c);\n      } else {\n        buffer.push(c); // Regular char.\n      }\n    } else if (state === 1) {\n      if (c === '%') {\n        buffer.push(c); // Escaped %: %%\n        state = 0;\n      } else if (parseInterpolationTokens && '0' <= c && c <= '9') {\n        state = 2;\n        number = c;\n        const text = buffer.join('');\n        if (text) {\n          tokens.push(text);\n        }\n        buffer.length = 0;\n      } else if (c === '{') {\n        state = 3;\n      } else {\n        buffer.push('%', c); // Not recognized. Return as literal.\n        state = 0;\n      }\n    } else if (state === 2) {\n      if ('0' <= c && c <= '9') {\n        number += c; // Multi-digit number.\n      } else {\n        tokens.push(parseInt(number ?? '', 10));\n        i--; // Parse this char again.\n        state = 0;\n      }\n    } else if (state === 3) {\n      // String table reference\n      if (c === '') {\n        // Premature end before closing '}'\n        buffer.splice(0, 0, '%{'); // Re-insert leading delimiter\n        i--; // Parse this char again.\n        state = 0; // and parse as string literal.\n      } else if (c !== '}') {\n        buffer.push(c);\n      } else {\n        const rawKey = buffer.join('');\n        if (/[A-Z]\\w*/i.test(rawKey)) {\n          // Strict matching\n          // Found a valid string key. Attempt case insensitive match.\n          const keyUpper = rawKey.toUpperCase();\n\n          // BKY_ is the prefix used to namespace the strings used in\n          // Blockly core files and the predefined blocks in ../blocks/.\n          // These strings are defined in ../msgs/ files.\n          const bklyKey = keyUpper.startsWith('BKY_')\n            ? keyUpper.substring(4)\n            : null;\n          if (bklyKey && bklyKey in Msg) {\n            const rawValue = Msg[bklyKey];\n            if (typeof rawValue === 'string') {\n              // Attempt to dereference substrings, too, appending to the\n              // end.\n              Array.prototype.push.apply(\n                tokens,\n                tokenizeInterpolationInternal(\n                  rawValue,\n                  parseInterpolationTokens,\n                  tokenizeNewlines,\n                ),\n              );\n            } else if (parseInterpolationTokens) {\n              // When parsing interpolation tokens, numbers are special\n              // placeholders (%1, %2, etc). Make sure all other values are\n              // strings.\n              tokens.push(`${rawValue}`);\n            } else {\n              tokens.push(rawValue);\n            }\n          } else {\n            // No entry found in the string table. Pass reference as string.\n            tokens.push('%{' + rawKey + '}');\n          }\n          buffer.length = 0; // Clear the array\n          state = 0;\n        } else {\n          tokens.push('%{' + rawKey + '}');\n          buffer.length = 0;\n          state = 0; // and parse as string literal.\n        }\n      }\n    }\n  }\n  let text = buffer.join('');\n  if (text) {\n    tokens.push(text);\n  }\n\n  // Merge adjacent text tokens into a single string (but if newlines should be\n  // tokenized, don't merge those with adjacent text).\n  const mergedTokens = [];\n  buffer.length = 0;\n  for (let i = 0; i < tokens.length; i++) {\n    if (\n      typeof tokens[i] === 'string' &&\n      !(tokenizeNewlines && tokens[i] === '\\n')\n    ) {\n      buffer.push(tokens[i] as string);\n    } else {\n      text = buffer.join('');\n      if (text) {\n        mergedTokens.push(text);\n      }\n      buffer.length = 0;\n      mergedTokens.push(tokens[i]);\n    }\n  }\n  text = buffer.join('');\n  if (text) {\n    mergedTokens.push(text);\n  }\n  buffer.length = 0;\n\n  return mergedTokens;\n}\n\n/**\n * Parse a string with any number of interpolation tokens (%1, %2, ...).\n * It will also replace string table references (e.g., %{bky_my_msg} and\n * %{BKY_MY_MSG} will both be replaced with the value in\n * Msg['MY_MSG']). Percentage sign characters '%' may be self-escaped\n * (e.g., '%%'). Newline characters will also be output as string tokens\n * containing a single newline character.\n *\n * @param message Text which might contain string table references and\n *     interpolation tokens.\n * @returns Array of strings and numbers.\n */\nexport function tokenizeInterpolation(message: string): (string | number)[] {\n  return tokenizeInterpolationInternal(message, true, true);\n}\n\n/**\n * Replaces string table references in a message, if the message is a string.\n * For example, \"%{bky_my_msg}\" and \"%{BKY_MY_MSG}\" will both be replaced with\n * the value in Msg['MY_MSG'].\n *\n * @param message Message, which may be a string that contains\n *     string table references.\n * @returns String with message references replaced.\n */\nexport function replaceMessageReferences(message: string | any): string {\n  if (typeof message !== 'string') {\n    return message;\n  }\n  const interpolatedResult = tokenizeInterpolationInternal(\n    message,\n    false,\n    false,\n  );\n  // When parseInterpolationTokens and tokenizeNewlines are false,\n  // interpolatedResult should be at most length 1.\n  return interpolatedResult.length ? String(interpolatedResult[0]) : '';\n}\n\n/**\n * Validates that any %{MSG_KEY} references in the message refer to keys of\n * the Msg string table.\n *\n * @param message Text which might contain string table references.\n * @returns True if all message references have matching values.\n *     Otherwise, false.\n */\nexport function checkMessageReferences(message: string): boolean {\n  let validSoFar = true;\n\n  const msgTable = Msg;\n  // TODO (#1169): Implement support for other string tables,\n  // prefixes other than BKY_.\n  const m = message.match(/%{BKY_[A-Z]\\w*}/gi);\n  if (m) {\n    for (let i = 0; i < m.length; i++) {\n      const msgKey = m[i].toUpperCase();\n      if (msgTable[msgKey.slice(6, -1)] === undefined) {\n        console.warn('No message string for ' + m[i] + ' in ' + message);\n        validSoFar = false; // Continue to report other errors.\n      }\n    }\n  }\n\n  return validSoFar;\n}\n\n/**\n * Parse a block colour from a number or string, as provided in a block\n * definition.\n *\n * @param colour HSV hue value (0 to 360), #RRGGBB string,\n *     or a message reference string pointing to one of those two values.\n * @returns An object containing the colour as\n *     a #RRGGBB string, and the hue if the input was an HSV hue value.\n * @throws {Error} If the colour cannot be parsed.\n */\nexport function parseBlockColour(colour: number | string): {\n  hue: number | null;\n  hex: string;\n} {\n  const dereferenced =\n    typeof colour === 'string' ? replaceMessageReferences(colour) : colour;\n\n  const hue = Number(dereferenced);\n  if (!isNaN(hue) && 0 <= hue && hue <= 360) {\n    return {\n      hue: hue,\n      hex: colourUtils.hsvToHex(\n        hue,\n        colourUtils.getHsvSaturation(),\n        colourUtils.getHsvValue() * 255,\n      ),\n    };\n  } else {\n    const hex = colourUtils.parse(dereferenced);\n    if (hex) {\n      // Only store hue if colour is set as a hue.\n      return {hue: null, hex: hex};\n    } else {\n      let errorMsg = 'Invalid colour: \"' + dereferenced + '\"';\n      if (colour !== dereferenced) {\n        errorMsg += ' (from \"' + colour + '\")';\n      }\n      throw Error(errorMsg);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2022 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {Block} from '../block.js';\nimport {IProcedureModel} from './i_procedure_model.js';\n// Former goog.module ID: Blockly.procedures.IProcedureBlock\n\n/** The interface for a block which models a procedure. */\nexport interface IProcedureBlock {\n  getProcedureModel(): IProcedureModel;\n  doProcedureUpdate(): void;\n  isProcedureDef(): boolean;\n}\n\n/** A type guard which checks if the given block is a procedure block. */\nexport function isProcedureBlock(\n  block: Block | IProcedureBlock,\n): block is IProcedureBlock {\n  return (\n    (block as IProcedureBlock).getProcedureModel !== undefined &&\n    (block as IProcedureBlock).doProcedureUpdate !== undefined &&\n    (block as IProcedureBlock).isProcedureDef !== undefined\n  );\n}\n","/**\n * @license\n * Copyright 2022 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * An object that fires events optionally.\n *\n * @internal\n */\nexport interface IObservable {\n  startPublishing(): void;\n  stopPublishing(): void;\n}\n\n/**\n * Type guard for checking if an object fulfills IObservable.\n *\n * @internal\n */\nexport function isObservable(obj: any): obj is IObservable {\n  return obj.startPublishing !== undefined && obj.stopPublishing !== undefined;\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.fieldRegistry\n\nimport type {Field, FieldProto} from './field.js';\nimport * as registry from './registry.js';\n\ninterface RegistryOptions {\n  type: string;\n  [key: string]: unknown;\n}\n\n/**\n * Registers a field type.\n * fieldRegistry.fromJson uses this registry to\n * find the appropriate field type.\n *\n * @param type The field type name as used in the JSON definition.\n * @param fieldClass The field class containing a fromJson function that can\n *     construct an instance of the field.\n * @throws {Error} if the type name is empty, the field is already registered,\n *     or the fieldClass is not an object containing a fromJson function.\n */\nexport function register(type: string, fieldClass: FieldProto) {\n  registry.register(registry.Type.FIELD, type, fieldClass);\n}\n\n/**\n * Unregisters the field registered with the given type.\n *\n * @param type The field type name as used in the JSON definition.\n */\nexport function unregister(type: string) {\n  registry.unregister(registry.Type.FIELD, type);\n}\n\n/**\n * Construct a Field from a JSON arg object.\n * Finds the appropriate registered field by the type name as registered using\n * fieldRegistry.register.\n *\n * @param options A JSON object with a type and options specific to the field\n *     type.\n * @returns The new field instance or null if a field wasn't found with the\n *     given type name\n * @internal\n */\nexport function fromJson<T>(options: RegistryOptions): Field<T> | null {\n  return TEST_ONLY.fromJsonInternal(options);\n}\n\n/**\n * Private version of fromJson for stubbing in tests.\n *\n * @param options\n */\nfunction fromJsonInternal<T>(options: RegistryOptions): Field<T> | null {\n  const fieldObject = registry.getObject(registry.Type.FIELD, options.type);\n  if (!fieldObject) {\n    console.warn(\n      'Blockly could not create a field of type ' +\n        options['type'] +\n        '. The field is probably not being registered. This could be because' +\n        ' the file is not loaded, the field does not register itself (Issue' +\n        ' #1584), or the registration is not being reached.',\n    );\n    return null;\n  } else if (typeof (fieldObject as any).fromJson !== 'function') {\n    throw new TypeError('returned Field was not a IRegistrableField');\n  } else {\n    type fromJson = (options: {}) => Field<T>;\n    return (fieldObject as unknown as {fromJson: fromJson}).fromJson(options);\n  }\n}\n\nexport const TEST_ONLY = {\n  fromJsonInternal,\n};\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Dropdown input field.  Used for editable titles and variables.\n * In the interests of a consistent UI, the toolbox shares some functions and\n * properties with the context menu.\n *\n * @class\n */\n// Former goog.module ID: Blockly.FieldDropdown\n\nimport type {BlockSvg} from './block_svg.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport {\n  Field,\n  FieldConfig,\n  FieldValidator,\n  UnattachedFieldError,\n} from './field.js';\nimport * as fieldRegistry from './field_registry.js';\nimport {Menu} from './menu.js';\nimport {MenuItem} from './menuitem.js';\nimport * as style from './utils/style.js';\nimport * as aria from './utils/aria.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport * as parsing from './utils/parsing.js';\nimport * as utilsString from './utils/string.js';\nimport {Svg} from './utils/svg.js';\n\n/**\n * Class for an editable dropdown field.\n */\nexport class FieldDropdown extends Field<string> {\n  /** Horizontal distance that a checkmark overhangs the dropdown. */\n  static CHECKMARK_OVERHANG = 25;\n\n  /**\n   * Maximum height of the dropdown menu, as a percentage of the viewport\n   * height.\n   */\n  static MAX_MENU_HEIGHT_VH = 0.45;\n\n  static ARROW_CHAR = '▾';\n\n  /** A reference to the currently selected menu item. */\n  private selectedMenuItem: MenuItem | null = null;\n\n  /** The dropdown menu. */\n  protected menu_: Menu | null = null;\n\n  /**\n   * SVG image element if currently selected option is an image, or null.\n   */\n  private imageElement: SVGImageElement | null = null;\n\n  /** Tspan based arrow element. */\n  private arrow: SVGTSpanElement | null = null;\n\n  /** SVG based arrow element. */\n  private svgArrow: SVGElement | null = null;\n\n  /**\n   * Serializable fields are saved by the serializer, non-serializable fields\n   * are not. Editable fields should also be serializable.\n   */\n  override SERIALIZABLE = true;\n\n  /** Mouse cursor style when over the hotspot that initiates the editor. */\n  override CURSOR = 'default';\n\n  protected menuGenerator_?: MenuGenerator;\n\n  /** A cache of the most recently generated options. */\n  private generatedOptions: MenuOption[] | null = null;\n\n  /**\n   * The prefix field label, of common words set after options are trimmed.\n   *\n   * @internal\n   */\n  override prefixField: string | null = null;\n\n  /**\n   * The suffix field label, of common words set after options are trimmed.\n   *\n   * @internal\n   */\n  override suffixField: string | null = null;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  private selectedOption!: MenuOption;\n  override clickTarget_: SVGElement | null = null;\n\n  /**\n   * @param menuGenerator A non-empty array of options for a dropdown list, or a\n   *     function which generates these options. Also accepts Field.SKIP_SETUP\n   *     if you wish to skip setup (only used by subclasses that want to handle\n   *     configuration and setting the field value after their own constructors\n   *     have run).\n   * @param validator A function that is called to validate changes to the\n   *     field's value. Takes in a language-neutral dropdown option & returns a\n   *     validated language-neutral dropdown option, or null to abort the\n   *     change.\n   * @param config A map of options used to configure the field.\n   *     See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/dropdown#creation}\n   * for a list of properties this parameter supports.\n   * @throws {TypeError} If `menuGenerator` options are incorrectly structured.\n   */\n  constructor(\n    menuGenerator: MenuGenerator,\n    validator?: FieldDropdownValidator,\n    config?: FieldDropdownConfig,\n  );\n  constructor(menuGenerator: typeof Field.SKIP_SETUP);\n  constructor(\n    menuGenerator: MenuGenerator | typeof Field.SKIP_SETUP,\n    validator?: FieldDropdownValidator,\n    config?: FieldDropdownConfig,\n  ) {\n    super(Field.SKIP_SETUP);\n\n    // If we pass SKIP_SETUP, don't do *anything* with the menu generator.\n    if (menuGenerator === Field.SKIP_SETUP) return;\n\n    if (Array.isArray(menuGenerator)) {\n      validateOptions(menuGenerator);\n      const trimmed = trimOptions(menuGenerator);\n      this.menuGenerator_ = trimmed.options;\n      this.prefixField = trimmed.prefix || null;\n      this.suffixField = trimmed.suffix || null;\n    } else {\n      this.menuGenerator_ = menuGenerator;\n    }\n\n    /**\n     * The currently selected option. The field is initialized with the\n     * first option selected.\n     */\n    this.selectedOption = this.getOptions(false)[0];\n\n    if (config) {\n      this.configure_(config);\n    }\n    this.setValue(this.selectedOption[1]);\n    if (validator) {\n      this.setValidator(validator);\n    }\n  }\n\n  /**\n   * Sets the field's value based on the given XML element. Should only be\n   * called by Blockly.Xml.\n   *\n   * @param fieldElement The element containing info about the field's state.\n   * @internal\n   */\n  override fromXml(fieldElement: Element) {\n    if (this.isOptionListDynamic()) {\n      this.getOptions(false);\n    }\n    this.setValue(fieldElement.textContent);\n  }\n\n  /**\n   * Sets the field's value based on the given state.\n   *\n   * @param state The state to apply to the dropdown field.\n   * @internal\n   */\n  override loadState(state: AnyDuringMigration) {\n    if (this.loadLegacyState(FieldDropdown, state)) {\n      return;\n    }\n    if (this.isOptionListDynamic()) {\n      this.getOptions(false);\n    }\n    this.setValue(state);\n  }\n\n  /**\n   * Create the block UI for this dropdown.\n   */\n  override initView() {\n    if (this.shouldAddBorderRect_()) {\n      this.createBorderRect_();\n    } else {\n      this.clickTarget_ = (this.sourceBlock_ as BlockSvg).getSvgRoot();\n    }\n    this.createTextElement_();\n\n    this.imageElement = dom.createSvgElement(Svg.IMAGE, {}, this.fieldGroup_);\n\n    if (this.getConstants()!.FIELD_DROPDOWN_SVG_ARROW) {\n      this.createSVGArrow_();\n    } else {\n      this.createTextArrow_();\n    }\n\n    if (this.borderRect_) {\n      dom.addClass(this.borderRect_, 'blocklyDropdownRect');\n    }\n  }\n\n  /**\n   * Whether or not the dropdown should add a border rect.\n   *\n   * @returns True if the dropdown field should add a border rect.\n   */\n  protected shouldAddBorderRect_(): boolean {\n    return (\n      !this.getConstants()!.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW ||\n      (this.getConstants()!.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW &&\n        !this.getSourceBlock()?.isShadow())\n    );\n  }\n\n  /** Create a tspan based arrow. */\n  protected createTextArrow_() {\n    this.arrow = dom.createSvgElement(Svg.TSPAN, {}, this.textElement_);\n    this.arrow!.appendChild(\n      document.createTextNode(\n        this.getSourceBlock()?.RTL\n          ? FieldDropdown.ARROW_CHAR + ' '\n          : ' ' + FieldDropdown.ARROW_CHAR,\n      ),\n    );\n    if (this.getSourceBlock()?.RTL) {\n      this.getTextElement().insertBefore(this.arrow, this.textContent_);\n    } else {\n      this.getTextElement().appendChild(this.arrow);\n    }\n  }\n\n  /** Create an SVG based arrow. */\n  protected createSVGArrow_() {\n    this.svgArrow = dom.createSvgElement(\n      Svg.IMAGE,\n      {\n        'height': this.getConstants()!.FIELD_DROPDOWN_SVG_ARROW_SIZE + 'px',\n        'width': this.getConstants()!.FIELD_DROPDOWN_SVG_ARROW_SIZE + 'px',\n      },\n      this.fieldGroup_,\n    );\n    this.svgArrow!.setAttributeNS(\n      dom.XLINK_NS,\n      'xlink:href',\n      this.getConstants()!.FIELD_DROPDOWN_SVG_ARROW_DATAURI,\n    );\n  }\n\n  /**\n   * Create a dropdown menu under the text.\n   *\n   * @param e Optional mouse event that triggered the field to open, or\n   *     undefined if triggered programmatically.\n   */\n  protected override showEditor_(e?: MouseEvent) {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    this.dropdownCreate();\n    if (e && typeof e.clientX === 'number') {\n      this.menu_!.openingCoords = new Coordinate(e.clientX, e.clientY);\n    } else {\n      this.menu_!.openingCoords = null;\n    }\n\n    // Remove any pre-existing elements in the dropdown.\n    dropDownDiv.clearContent();\n    // Element gets created in render.\n    const menuElement = this.menu_!.render(dropDownDiv.getContentDiv());\n    dom.addClass(menuElement, 'blocklyDropdownMenu');\n\n    if (this.getConstants()!.FIELD_DROPDOWN_COLOURED_DIV) {\n      const primaryColour = block.getColour();\n      const borderColour = (this.sourceBlock_ as BlockSvg).style.colourTertiary;\n      dropDownDiv.setColour(primaryColour, borderColour);\n    }\n\n    dropDownDiv.showPositionedByField(this, this.dropdownDispose_.bind(this));\n\n    // Focusing needs to be handled after the menu is rendered and positioned.\n    // Otherwise it will cause a page scroll to get the misplaced menu in\n    // view. See issue #1329.\n    this.menu_!.focus();\n\n    if (this.selectedMenuItem) {\n      this.menu_!.setHighlighted(this.selectedMenuItem);\n      style.scrollIntoContainerView(\n        this.selectedMenuItem.getElement()!,\n        dropDownDiv.getContentDiv(),\n        true,\n      );\n    }\n\n    this.applyColour();\n  }\n\n  /** Create the dropdown editor. */\n  private dropdownCreate() {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    const menu = new Menu();\n    menu.setRole(aria.Role.LISTBOX);\n    this.menu_ = menu;\n\n    const options = this.getOptions(false);\n    this.selectedMenuItem = null;\n    for (let i = 0; i < options.length; i++) {\n      const [label, value] = options[i];\n      const content = (() => {\n        if (typeof label === 'object') {\n          // Convert ImageProperties to an HTMLImageElement.\n          const image = new Image(label['width'], label['height']);\n          image.src = label['src'];\n          image.alt = label['alt'] || '';\n          return image;\n        }\n        return label;\n      })();\n      const menuItem = new MenuItem(content, value);\n      menuItem.setRole(aria.Role.OPTION);\n      menuItem.setRightToLeft(block.RTL);\n      menuItem.setCheckable(true);\n      menu.addChild(menuItem);\n      menuItem.setChecked(value === this.value_);\n      if (value === this.value_) {\n        this.selectedMenuItem = menuItem;\n      }\n      menuItem.onAction(this.handleMenuActionEvent, this);\n    }\n  }\n\n  /**\n   * Disposes of events and DOM-references belonging to the dropdown editor.\n   */\n  protected dropdownDispose_() {\n    if (this.menu_) {\n      this.menu_.dispose();\n    }\n    this.menu_ = null;\n    this.selectedMenuItem = null;\n    this.applyColour();\n  }\n\n  /**\n   * Handle an action in the dropdown menu.\n   *\n   * @param menuItem The MenuItem selected within menu.\n   */\n  private handleMenuActionEvent(menuItem: MenuItem) {\n    dropDownDiv.hideIfOwner(this, true);\n    this.onItemSelected_(this.menu_ as Menu, menuItem);\n  }\n\n  /**\n   * Handle the selection of an item in the dropdown menu.\n   *\n   * @param menu The Menu component clicked.\n   * @param menuItem The MenuItem selected within menu.\n   */\n  protected onItemSelected_(menu: Menu, menuItem: MenuItem) {\n    this.setValue(menuItem.getValue());\n  }\n\n  /**\n   * @returns True if the option list is generated by a function.\n   *     Otherwise false.\n   */\n  isOptionListDynamic(): boolean {\n    return typeof this.menuGenerator_ === 'function';\n  }\n\n  /**\n   * Return a list of the options for this dropdown.\n   *\n   * @param useCache For dynamic options, whether or not to use the cached\n   *     options or to re-generate them.\n   * @returns A non-empty array of option tuples:\n   *     (human-readable text or image, language-neutral name).\n   * @throws {TypeError} If generated options are incorrectly structured.\n   */\n  getOptions(useCache?: boolean): MenuOption[] {\n    if (!this.menuGenerator_) {\n      // A subclass improperly skipped setup without defining the menu\n      // generator.\n      throw TypeError('A menu generator was never defined.');\n    }\n    if (Array.isArray(this.menuGenerator_)) return this.menuGenerator_;\n    if (useCache && this.generatedOptions) return this.generatedOptions;\n\n    this.generatedOptions = this.menuGenerator_();\n    validateOptions(this.generatedOptions);\n    return this.generatedOptions;\n  }\n\n  /**\n   * Ensure that the input value is a valid language-neutral option.\n   *\n   * @param newValue The input value.\n   * @returns A valid language-neutral option, or null if invalid.\n   */\n  protected override doClassValidation_(newValue?: string): string | null {\n    const options = this.getOptions(true);\n    const isValueValid = options.some((option) => option[1] === newValue);\n\n    if (!isValueValid) {\n      if (this.sourceBlock_) {\n        console.warn(\n          \"Cannot set the dropdown's value to an unavailable option.\" +\n            ' Block type: ' +\n            this.sourceBlock_.type +\n            ', Field name: ' +\n            this.name +\n            ', Value: ' +\n            newValue,\n        );\n      }\n      return null;\n    }\n    return newValue as string;\n  }\n\n  /**\n   * Update the value of this dropdown field.\n   *\n   * @param newValue The value to be saved. The default validator guarantees\n   *     that this is one of the valid dropdown options.\n   */\n  protected override doValueUpdate_(newValue: string) {\n    super.doValueUpdate_(newValue);\n    const options = this.getOptions(true);\n    for (let i = 0, option; (option = options[i]); i++) {\n      if (option[1] === this.value_) {\n        this.selectedOption = option;\n      }\n    }\n  }\n\n  /**\n   * Updates the dropdown arrow to match the colour/style of the block.\n   */\n  override applyColour() {\n    const style = (this.sourceBlock_ as BlockSvg).style;\n    if (this.borderRect_) {\n      this.borderRect_.setAttribute('stroke', style.colourTertiary);\n      if (this.menu_) {\n        this.borderRect_.setAttribute('fill', style.colourTertiary);\n      } else {\n        this.borderRect_.setAttribute('fill', 'transparent');\n      }\n    }\n    // Update arrow's colour.\n    if (this.sourceBlock_ && this.arrow) {\n      if (this.sourceBlock_.isShadow()) {\n        this.arrow.style.fill = style.colourSecondary;\n      } else {\n        this.arrow.style.fill = style.colourPrimary;\n      }\n    }\n  }\n\n  /** Draws the border with the correct width. */\n  protected override render_() {\n    // Hide both elements.\n    this.getTextContent().nodeValue = '';\n    this.imageElement!.style.display = 'none';\n\n    // Show correct element.\n    const option = this.selectedOption && this.selectedOption[0];\n    if (option && typeof option === 'object') {\n      this.renderSelectedImage(option);\n    } else {\n      this.renderSelectedText();\n    }\n\n    this.positionBorderRect_();\n  }\n\n  /**\n   * Renders the selected option, which must be an image.\n   *\n   * @param imageJson Selected option that must be an image.\n   */\n  private renderSelectedImage(imageJson: ImageProperties) {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    this.imageElement!.style.display = '';\n    this.imageElement!.setAttributeNS(\n      dom.XLINK_NS,\n      'xlink:href',\n      imageJson.src,\n    );\n    this.imageElement!.setAttribute('height', String(imageJson.height));\n    this.imageElement!.setAttribute('width', String(imageJson.width));\n\n    const imageHeight = Number(imageJson.height);\n    const imageWidth = Number(imageJson.width);\n\n    // Height and width include the border rect.\n    const hasBorder = !!this.borderRect_;\n    const height = Math.max(\n      hasBorder ? this.getConstants()!.FIELD_DROPDOWN_BORDER_RECT_HEIGHT : 0,\n      imageHeight + IMAGE_Y_PADDING,\n    );\n    const xPadding = hasBorder\n      ? this.getConstants()!.FIELD_BORDER_RECT_X_PADDING\n      : 0;\n    let arrowWidth = 0;\n    if (this.svgArrow) {\n      arrowWidth = this.positionSVGArrow(\n        imageWidth + xPadding,\n        height / 2 - this.getConstants()!.FIELD_DROPDOWN_SVG_ARROW_SIZE / 2,\n      );\n    } else {\n      arrowWidth = dom.getFastTextWidth(\n        this.arrow as SVGTSpanElement,\n        this.getConstants()!.FIELD_TEXT_FONTSIZE,\n        this.getConstants()!.FIELD_TEXT_FONTWEIGHT,\n        this.getConstants()!.FIELD_TEXT_FONTFAMILY,\n      );\n    }\n    this.size_.width = imageWidth + arrowWidth + xPadding * 2;\n    this.size_.height = height;\n\n    let arrowX = 0;\n    if (block.RTL) {\n      const imageX = xPadding + arrowWidth;\n      this.imageElement!.setAttribute('x', `${imageX}`);\n    } else {\n      arrowX = imageWidth + arrowWidth;\n      this.getTextElement().setAttribute('text-anchor', 'end');\n      this.imageElement!.setAttribute('x', `${xPadding}`);\n    }\n    this.imageElement!.setAttribute('y', String(height / 2 - imageHeight / 2));\n\n    this.positionTextElement_(arrowX + xPadding, imageWidth + arrowWidth);\n  }\n\n  /** Renders the selected option, which must be text. */\n  private renderSelectedText() {\n    // Retrieves the selected option to display through getText_.\n    this.getTextContent().nodeValue = this.getDisplayText_();\n    const textElement = this.getTextElement();\n    dom.addClass(textElement, 'blocklyDropdownText');\n    textElement.setAttribute('text-anchor', 'start');\n\n    // Height and width include the border rect.\n    const hasBorder = !!this.borderRect_;\n    const height = Math.max(\n      hasBorder ? this.getConstants()!.FIELD_DROPDOWN_BORDER_RECT_HEIGHT : 0,\n      this.getConstants()!.FIELD_TEXT_HEIGHT,\n    );\n    const textWidth = dom.getFastTextWidth(\n      this.getTextElement(),\n      this.getConstants()!.FIELD_TEXT_FONTSIZE,\n      this.getConstants()!.FIELD_TEXT_FONTWEIGHT,\n      this.getConstants()!.FIELD_TEXT_FONTFAMILY,\n    );\n    const xPadding = hasBorder\n      ? this.getConstants()!.FIELD_BORDER_RECT_X_PADDING\n      : 0;\n    let arrowWidth = 0;\n    if (this.svgArrow) {\n      arrowWidth = this.positionSVGArrow(\n        textWidth + xPadding,\n        height / 2 - this.getConstants()!.FIELD_DROPDOWN_SVG_ARROW_SIZE / 2,\n      );\n    }\n    this.size_.width = textWidth + arrowWidth + xPadding * 2;\n    this.size_.height = height;\n\n    this.positionTextElement_(xPadding, textWidth);\n  }\n\n  /**\n   * Position a drop-down arrow at the appropriate location at render-time.\n   *\n   * @param x X position the arrow is being rendered at, in px.\n   * @param y Y position the arrow is being rendered at, in px.\n   * @returns Amount of space the arrow is taking up, in px.\n   */\n  private positionSVGArrow(x: number, y: number): number {\n    if (!this.svgArrow) {\n      return 0;\n    }\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    const hasBorder = !!this.borderRect_;\n    const xPadding = hasBorder\n      ? this.getConstants()!.FIELD_BORDER_RECT_X_PADDING\n      : 0;\n    const textPadding = this.getConstants()!.FIELD_DROPDOWN_SVG_ARROW_PADDING;\n    const svgArrowSize = this.getConstants()!.FIELD_DROPDOWN_SVG_ARROW_SIZE;\n    const arrowX = block.RTL ? xPadding : x + textPadding;\n    this.svgArrow.setAttribute(\n      'transform',\n      'translate(' + arrowX + ',' + y + ')',\n    );\n    return svgArrowSize + textPadding;\n  }\n\n  /**\n   * Use the `getText_` developer hook to override the field's text\n   * representation.  Get the selected option text.  If the selected option is\n   * an image we return the image alt text.\n   *\n   * @returns Selected option text.\n   */\n  protected override getText_(): string | null {\n    if (!this.selectedOption) {\n      return null;\n    }\n    const option = this.selectedOption[0];\n    if (typeof option === 'object') {\n      return option['alt'];\n    }\n    return option;\n  }\n\n  /**\n   * Construct a FieldDropdown from a JSON arg object.\n   *\n   * @param options A JSON object with options (options).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static fromJson(options: FieldDropdownFromJsonConfig): FieldDropdown {\n    if (!options.options) {\n      throw new Error(\n        'options are required for the dropdown field. The ' +\n          'options property must be assigned an array of ' +\n          '[humanReadableValue, languageNeutralValue] tuples.',\n      );\n    }\n    // `this` might be a subclass of FieldDropdown if that class doesn't\n    // override the static fromJson method.\n    return new this(options.options, undefined, options);\n  }\n}\n\n/**\n * Definition of a human-readable image dropdown option.\n */\nexport interface ImageProperties {\n  src: string;\n  alt: string;\n  width: number;\n  height: number;\n}\n\n/**\n * An individual option in the dropdown menu. The first element is the human-\n * readable value (text or image), and the second element is the language-\n * neutral value.\n */\nexport type MenuOption = [string | ImageProperties, string];\n\n/**\n * A function that generates an array of menu options for FieldDropdown\n * or its descendants.\n */\nexport type MenuGeneratorFunction = (this: FieldDropdown) => MenuOption[];\n\n/**\n * Either an array of menu options or a function that generates an array of\n * menu options for FieldDropdown or its descendants.\n */\nexport type MenuGenerator = MenuOption[] | MenuGeneratorFunction;\n\n/**\n * Config options for the dropdown field.\n */\nexport type FieldDropdownConfig = FieldConfig;\n\n/**\n * fromJson config for the dropdown field.\n */\nexport interface FieldDropdownFromJsonConfig extends FieldDropdownConfig {\n  options?: MenuOption[];\n}\n\n/**\n * A function that is called to validate changes to the field's value before\n * they are set.\n *\n * @see {@link https://developers.google.com/blockly/guides/create-custom-blocks/fields/validators#return_values}\n * @param newValue The value to be validated.\n * @returns One of three instructions for setting the new value: `T`, `null`,\n * or `undefined`.\n *\n * - `T` to set this function's returned value instead of `newValue`.\n *\n * - `null` to invoke `doValueInvalid_` and not set a value.\n *\n * - `undefined` to set `newValue` as is.\n */\nexport type FieldDropdownValidator = FieldValidator<string>;\n\n/**\n * The y offset from the top of the field to the top of the image, if an image\n * is selected.\n */\nconst IMAGE_Y_OFFSET = 5;\n\n/** The total vertical padding above and below an image. */\nconst IMAGE_Y_PADDING: number = IMAGE_Y_OFFSET * 2;\n\n/**\n * Factor out common words in statically defined options.\n * Create prefix and/or suffix labels.\n */\nfunction trimOptions(options: MenuOption[]): {\n  options: MenuOption[];\n  prefix?: string;\n  suffix?: string;\n} {\n  let hasImages = false;\n  const trimmedOptions = options.map(([label, value]): MenuOption => {\n    if (typeof label === 'string') {\n      return [parsing.replaceMessageReferences(label), value];\n    }\n\n    hasImages = true;\n    // Copy the image properties so they're not influenced by the original.\n    // NOTE: No need to deep copy since image properties are only 1 level deep.\n    const imageLabel =\n      label.alt !== null\n        ? {...label, alt: parsing.replaceMessageReferences(label.alt)}\n        : {...label};\n    return [imageLabel, value];\n  });\n\n  if (hasImages || options.length < 2) return {options: trimmedOptions};\n\n  const stringOptions = trimmedOptions as [string, string][];\n  const stringLabels = stringOptions.map(([label]) => label);\n\n  const shortest = utilsString.shortestStringLength(stringLabels);\n  const prefixLength = utilsString.commonWordPrefix(stringLabels, shortest);\n  const suffixLength = utilsString.commonWordSuffix(stringLabels, shortest);\n\n  if (\n    (!prefixLength && !suffixLength) ||\n    shortest <= prefixLength + suffixLength\n  ) {\n    // One or more strings will entirely vanish if we proceed.  Abort.\n    return {options: stringOptions};\n  }\n\n  const prefix = prefixLength\n    ? stringLabels[0].substring(0, prefixLength - 1)\n    : undefined;\n  const suffix = suffixLength\n    ? stringLabels[0].substr(1 - suffixLength)\n    : undefined;\n  return {\n    options: applyTrim(stringOptions, prefixLength, suffixLength),\n    prefix,\n    suffix,\n  };\n}\n\n/**\n * Use the calculated prefix and suffix lengths to trim all of the options in\n * the given array.\n *\n * @param options Array of option tuples:\n *     (human-readable text or image, language-neutral name).\n * @param prefixLength The length of the common prefix.\n * @param suffixLength The length of the common suffix\n * @returns A new array with all of the option text trimmed.\n */\nfunction applyTrim(\n  options: [string, string][],\n  prefixLength: number,\n  suffixLength: number,\n): MenuOption[] {\n  return options.map(([text, value]) => [\n    text.substring(prefixLength, text.length - suffixLength),\n    value,\n  ]);\n}\n\n/**\n * Validates the data structure to be processed as an options list.\n *\n * @param options The proposed dropdown options.\n * @throws {TypeError} If proposed options are incorrectly structured.\n */\nfunction validateOptions(options: MenuOption[]) {\n  if (!Array.isArray(options)) {\n    throw TypeError('FieldDropdown options must be an array.');\n  }\n  if (!options.length) {\n    throw TypeError('FieldDropdown options must not be an empty array.');\n  }\n  let foundError = false;\n  for (let i = 0; i < options.length; i++) {\n    const tuple = options[i];\n    if (!Array.isArray(tuple)) {\n      foundError = true;\n      console.error(\n        'Invalid option[' +\n          i +\n          ']: Each FieldDropdown option must be an ' +\n          'array. Found: ',\n        tuple,\n      );\n    } else if (typeof tuple[1] !== 'string') {\n      foundError = true;\n      console.error(\n        'Invalid option[' +\n          i +\n          ']: Each FieldDropdown option id must be ' +\n          'a string. Found ' +\n          tuple[1] +\n          ' in: ',\n        tuple,\n      );\n    } else if (\n      tuple[0] &&\n      typeof tuple[0] !== 'string' &&\n      typeof tuple[0].src !== 'string'\n    ) {\n      foundError = true;\n      console.error(\n        'Invalid option[' +\n          i +\n          ']: Each FieldDropdown option must have a ' +\n          'string label or image description. Found' +\n          tuple[0] +\n          ' in: ',\n        tuple,\n      );\n    }\n  }\n  if (foundError) {\n    throw TypeError('Found invalid FieldDropdown options.');\n  }\n}\n\nfieldRegistry.register('field_dropdown', FieldDropdown);\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.Extensions\n\nimport type {Block} from './block.js';\nimport type {BlockSvg} from './block_svg.js';\nimport {FieldDropdown} from './field_dropdown.js';\nimport {MutatorIcon} from './icons/mutator_icon.js';\nimport * as parsing from './utils/parsing.js';\n\n/** The set of all registered extensions, keyed by extension name/id. */\nconst allExtensions = Object.create(null);\nexport const TEST_ONLY = {allExtensions};\n\n/**\n * Registers a new extension function. Extensions are functions that help\n * initialize blocks, usually adding dynamic behavior such as onchange\n * handlers and mutators. These are applied using Block.applyExtension(), or\n * the JSON \"extensions\" array attribute.\n *\n * @param name The name of this extension.\n * @param initFn The function to initialize an extended block.\n * @throws {Error} if the extension name is empty, the extension is already\n *     registered, or extensionFn is not a function.\n */\nexport function register(name: string, initFn: Function) {\n  if (typeof name !== 'string' || name.trim() === '') {\n    throw Error('Error: Invalid extension name \"' + name + '\"');\n  }\n  if (allExtensions[name]) {\n    throw Error('Error: Extension \"' + name + '\" is already registered.');\n  }\n  if (typeof initFn !== 'function') {\n    throw Error('Error: Extension \"' + name + '\" must be a function');\n  }\n  allExtensions[name] = initFn;\n}\n\n/**\n * Registers a new extension function that adds all key/value of mixinObj.\n *\n * @param name The name of this extension.\n * @param mixinObj The values to mix in.\n * @throws {Error} if the extension name is empty or the extension is already\n *     registered.\n */\nexport function registerMixin(name: string, mixinObj: AnyDuringMigration) {\n  if (!mixinObj || typeof mixinObj !== 'object') {\n    throw Error('Error: Mixin \"' + name + '\" must be a object');\n  }\n  register(name, function (this: Block) {\n    this.mixin(mixinObj);\n  });\n}\n\n/**\n * Registers a new extension function that adds a mutator to the block.\n * At register time this performs some basic sanity checks on the mutator.\n * The wrapper may also add a mutator dialog to the block, if both compose and\n * decompose are defined on the mixin.\n *\n * @param name The name of this mutator extension.\n * @param mixinObj The values to mix in.\n * @param opt_helperFn An optional function to apply after mixing in the object.\n * @param opt_blockList A list of blocks to appear in the flyout of the mutator\n *     dialog.\n * @throws {Error} if the mutation is invalid or can't be applied to the block.\n */\nexport function registerMutator(\n  name: string,\n  mixinObj: AnyDuringMigration,\n  opt_helperFn?: () => AnyDuringMigration,\n  opt_blockList?: string[],\n) {\n  const errorPrefix = 'Error when registering mutator \"' + name + '\": ';\n\n  checkHasMutatorProperties(errorPrefix, mixinObj);\n  const hasMutatorDialog = checkMutatorDialog(mixinObj, errorPrefix);\n\n  if (opt_helperFn && typeof opt_helperFn !== 'function') {\n    throw Error(errorPrefix + 'Extension \"' + name + '\" is not a function');\n  }\n\n  // Sanity checks passed.\n  register(name, function (this: Block) {\n    if (hasMutatorDialog) {\n      this.setMutator(new MutatorIcon(opt_blockList || [], this as BlockSvg));\n    }\n    // Mixin the object.\n    this.mixin(mixinObj);\n\n    if (opt_helperFn) {\n      opt_helperFn.apply(this);\n    }\n  });\n}\n\n/**\n * Unregisters the extension registered with the given name.\n *\n * @param name The name of the extension to unregister.\n */\nexport function unregister(name: string) {\n  if (isRegistered(name)) {\n    delete allExtensions[name];\n  } else {\n    console.warn(\n      'No extension mapping for name \"' + name + '\" found to unregister',\n    );\n  }\n}\n\n/**\n * Returns whether an extension is registered with the given name.\n *\n * @param name The name of the extension to check for.\n * @returns True if the extension is registered.  False if it is not registered.\n */\nexport function isRegistered(name: string): boolean {\n  return !!allExtensions[name];\n}\n\n/**\n * Applies an extension method to a block. This should only be called during\n * block construction.\n *\n * @param name The name of the extension.\n * @param block The block to apply the named extension to.\n * @param isMutator True if this extension defines a mutator.\n * @throws {Error} if the extension is not found.\n */\nexport function apply(name: string, block: Block, isMutator: boolean) {\n  const extensionFn = allExtensions[name];\n  if (typeof extensionFn !== 'function') {\n    throw Error('Error: Extension \"' + name + '\" not found.');\n  }\n  let mutatorProperties;\n  if (isMutator) {\n    // Fail early if the block already has mutation properties.\n    checkNoMutatorProperties(name, block);\n  } else {\n    // Record the old properties so we can make sure they don't change after\n    // applying the extension.\n    mutatorProperties = getMutatorProperties(block);\n  }\n  extensionFn.apply(block);\n\n  if (isMutator) {\n    const errorPrefix = 'Error after applying mutator \"' + name + '\": ';\n    checkHasMutatorProperties(errorPrefix, block);\n  } else {\n    if (\n      !mutatorPropertiesMatch(mutatorProperties as AnyDuringMigration[], block)\n    ) {\n      throw Error(\n        'Error when applying extension \"' +\n          name +\n          '\": ' +\n          'mutation properties changed when applying a non-mutator extension.',\n      );\n    }\n  }\n}\n\n/**\n * Check that the given block does not have any of the four mutator properties\n * defined on it.  This function should be called before applying a mutator\n * extension to a block, to make sure we are not overwriting properties.\n *\n * @param mutationName The name of the mutation to reference in error messages.\n * @param block The block to check.\n * @throws {Error} if any of the properties already exist on the block.\n */\nfunction checkNoMutatorProperties(mutationName: string, block: Block) {\n  const properties = getMutatorProperties(block);\n  if (properties.length) {\n    throw Error(\n      'Error: tried to apply mutation \"' +\n        mutationName +\n        '\" to a block that already has mutator functions.' +\n        '  Block id: ' +\n        block.id,\n    );\n  }\n}\n\n/**\n * Checks if the given object has both the 'mutationToDom' and 'domToMutation'\n * functions.\n *\n * @param object The object to check.\n * @param errorPrefix The string to prepend to any error message.\n * @returns True if the object has both functions.  False if it has neither\n *     function.\n * @throws {Error} if the object has only one of the functions, or either is not\n *     actually a function.\n */\nfunction checkXmlHooks(\n  object: AnyDuringMigration,\n  errorPrefix: string,\n): boolean {\n  return checkHasFunctionPair(\n    object.mutationToDom,\n    object.domToMutation,\n    errorPrefix + ' mutationToDom/domToMutation',\n  );\n}\n/**\n * Checks if the given object has both the 'saveExtraState' and 'loadExtraState'\n * functions.\n *\n * @param object The object to check.\n * @param errorPrefix The string to prepend to any error message.\n * @returns True if the object has both functions.  False if it has neither\n *     function.\n * @throws {Error} if the object has only one of the functions, or either is not\n *     actually a function.\n */\nfunction checkJsonHooks(\n  object: AnyDuringMigration,\n  errorPrefix: string,\n): boolean {\n  return checkHasFunctionPair(\n    object.saveExtraState,\n    object.loadExtraState,\n    errorPrefix + ' saveExtraState/loadExtraState',\n  );\n}\n\n/**\n * Checks if the given object has both the 'compose' and 'decompose' functions.\n *\n * @param object The object to check.\n * @param errorPrefix The string to prepend to any error message.\n * @returns True if the object has both functions.  False if it has neither\n *     function.\n * @throws {Error} if the object has only one of the functions, or either is not\n *     actually a function.\n */\nfunction checkMutatorDialog(\n  object: AnyDuringMigration,\n  errorPrefix: string,\n): boolean {\n  return checkHasFunctionPair(\n    object.compose,\n    object.decompose,\n    errorPrefix + ' compose/decompose',\n  );\n}\n\n/**\n * Checks that both or neither of the given functions exist and that they are\n * indeed functions.\n *\n * @param func1 The first function in the pair.\n * @param func2 The second function in the pair.\n * @param errorPrefix The string to prepend to any error message.\n * @returns True if the object has both functions.  False if it has neither\n *     function.\n * @throws {Error} If the object has only one of the functions, or either is not\n *     actually a function.\n */\nfunction checkHasFunctionPair(\n  func1: AnyDuringMigration,\n  func2: AnyDuringMigration,\n  errorPrefix: string,\n): boolean {\n  if (func1 && func2) {\n    if (typeof func1 !== 'function' || typeof func2 !== 'function') {\n      throw Error(errorPrefix + ' must be a function');\n    }\n    return true;\n  } else if (!func1 && !func2) {\n    return false;\n  }\n  throw Error(errorPrefix + 'Must have both or neither functions');\n}\n\n/**\n * Checks that the given object required mutator properties.\n *\n * @param errorPrefix The string to prepend to any error message.\n * @param object The object to inspect.\n */\nfunction checkHasMutatorProperties(\n  errorPrefix: string,\n  object: AnyDuringMigration,\n) {\n  const hasXmlHooks = checkXmlHooks(object, errorPrefix);\n  const hasJsonHooks = checkJsonHooks(object, errorPrefix);\n  if (!hasXmlHooks && !hasJsonHooks) {\n    throw Error(\n      errorPrefix +\n        'Mutations must contain either XML hooks, or JSON hooks, or both',\n    );\n  }\n  // A block with a mutator isn't required to have a mutation dialog, but\n  // it should still have both or neither of compose and decompose.\n  checkMutatorDialog(object, errorPrefix);\n}\n\n/**\n * Get a list of values of mutator properties on the given block.\n *\n * @param block The block to inspect.\n * @returns A list with all of the defined properties, which should be\n *     functions, but may be anything other than undefined.\n */\nfunction getMutatorProperties(block: Block): AnyDuringMigration[] {\n  const result = [];\n  // List each function explicitly by reference to allow for renaming\n  // during compilation.\n  if (block.domToMutation !== undefined) {\n    result.push(block.domToMutation);\n  }\n  if (block.mutationToDom !== undefined) {\n    result.push(block.mutationToDom);\n  }\n  if (block.saveExtraState !== undefined) {\n    result.push(block.saveExtraState);\n  }\n  if (block.loadExtraState !== undefined) {\n    result.push(block.loadExtraState);\n  }\n  if (block.compose !== undefined) {\n    result.push(block.compose);\n  }\n  if (block.decompose !== undefined) {\n    result.push(block.decompose);\n  }\n  return result;\n}\n\n/**\n * Check that the current mutator properties match a list of old mutator\n * properties.  This should be called after applying a non-mutator extension,\n * to verify that the extension didn't change properties it shouldn't.\n *\n * @param oldProperties The old values to compare to.\n * @param block The block to inspect for new values.\n * @returns True if the property lists match.\n */\nfunction mutatorPropertiesMatch(\n  oldProperties: AnyDuringMigration[],\n  block: Block,\n): boolean {\n  const newProperties = getMutatorProperties(block);\n  if (newProperties.length !== oldProperties.length) {\n    return false;\n  }\n  for (let i = 0; i < newProperties.length; i++) {\n    if (oldProperties[i] !== newProperties[i]) {\n      return false;\n    }\n  }\n  return true;\n}\n\n/**\n * Calls a function after the page has loaded, possibly immediately.\n *\n * @param fn Function to run.\n * @throws Error Will throw if no global document can be found (e.g., Node.js).\n * @internal\n */\nexport function runAfterPageLoad(fn: () => void) {\n  if (typeof document !== 'object') {\n    throw Error('runAfterPageLoad() requires browser document.');\n  }\n  if (document.readyState === 'complete') {\n    fn(); // Page has already loaded. Call immediately.\n  } else {\n    // Poll readyState.\n    const readyStateCheckInterval = setInterval(function () {\n      if (document.readyState === 'complete') {\n        clearInterval(readyStateCheckInterval);\n        fn();\n      }\n    }, 10);\n  }\n}\n\n/**\n * Builds an extension function that will map a dropdown value to a tooltip\n * string.\n *\n * @param dropdownName The name of the field whose value is the key to the\n *     lookup table.\n * @param lookupTable The table of field values to tooltip text.\n * @returns The extension function.\n */\nexport function buildTooltipForDropdown(\n  dropdownName: string,\n  lookupTable: {[key: string]: string},\n): (this: Block) => void {\n  // List of block types already validated, to minimize duplicate warnings.\n  const blockTypesChecked: string[] = [];\n\n  return function (this: Block) {\n    if (blockTypesChecked.indexOf(this.type) === -1) {\n      checkDropdownOptionsInTable(this, dropdownName, lookupTable);\n      blockTypesChecked.push(this.type);\n    }\n\n    this.setTooltip(\n      function (this: Block) {\n        const value = String(this.getFieldValue(dropdownName));\n        return parsing.replaceMessageReferences(lookupTable[value]);\n      }.bind(this),\n    );\n  };\n}\n\n/**\n * Checks all options keys are present in the provided string lookup table.\n * Emits console warnings when they are not.\n *\n * @param block The block containing the dropdown\n * @param dropdownName The name of the dropdown\n * @param lookupTable The string lookup table\n */\nfunction checkDropdownOptionsInTable(\n  block: Block,\n  dropdownName: string,\n  lookupTable: {[key: string]: string},\n) {\n  const dropdown = block.getField(dropdownName);\n  if (!(dropdown instanceof FieldDropdown) || dropdown.isOptionListDynamic()) {\n    return;\n  }\n\n  const options = dropdown.getOptions();\n  for (const [, key] of options) {\n    if (lookupTable[key] === undefined) {\n      console.warn(\n        `No tooltip mapping for value ${key} of field ` +\n          `${dropdownName} of block type ${block.type}.`,\n      );\n    }\n  }\n}\n\n/**\n * Builds an extension function that will install a dynamic tooltip. The\n * tooltip message should include the string '%1' and that string will be\n * replaced with the text of the named field.\n *\n * @param msgTemplate The template form to of the message text, with %1\n *     placeholder.\n * @param fieldName The field with the replacement text.\n * @returns The extension function.\n */\nexport function buildTooltipWithFieldText(\n  msgTemplate: string,\n  fieldName: string,\n): (this: Block) => void {\n  return function (this: Block) {\n    this.setTooltip(\n      function (this: Block) {\n        const field = this.getField(fieldName);\n        return parsing\n          .replaceMessageReferences(msgTemplate)\n          .replace('%1', field ? field.getText() : '');\n      }.bind(this),\n    );\n  };\n}\n\n/**\n * Configures the tooltip to mimic the parent block when connected. Otherwise,\n * uses the tooltip text at the time this extension is initialized. This takes\n * advantage of the fact that all other values from JSON are initialized before\n * extensions.\n */\nfunction extensionParentTooltip(this: Block) {\n  const tooltipWhenNotConnected = this.tooltip;\n  this.setTooltip(\n    function (this: Block) {\n      const parent = this.getParent();\n      return (\n        (parent && parent.getInputsInline() && parent.tooltip) ||\n        tooltipWhenNotConnected\n      );\n    }.bind(this),\n  );\n}\nregister('parent_tooltip_when_inline', extensionParentTooltip);\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.utils.svgPaths\n\n/**\n * Create a string representing the given x, y pair.  It does not matter whether\n * the coordinate is relative or absolute.  The result has leading\n * and trailing spaces, and separates the x and y coordinates with a comma but\n * no space.\n *\n * @param x The x coordinate.\n * @param y The y coordinate.\n * @returns A string of the format ' x,y '\n */\nexport function point(x: number, y: number): string {\n  return ' ' + x + ',' + y + ' ';\n}\n\n/**\n * Draw a cubic or quadratic curve.  See\n * developer.mozilla.org/en-US/docs/Web/SVG/Attribute/d#Cubic_B%C3%A9zier_Curve\n * These coordinates are unitless and hence in the user coordinate system.\n *\n * @param command The command to use.\n *     Should be one of: c, C, s, S, q, Q.\n * @param points  An array containing all of the points to pass to the curve\n *     command, in order.  The points are represented as strings of the format '\n *     x, y '.\n * @returns A string defining one or more Bezier curves.  See the MDN\n *     documentation for exact format.\n */\nexport function curve(command: string, points: string[]): string {\n  return ' ' + command + points.join('');\n}\n\n/**\n * Move the cursor to the given position without drawing a line.\n * The coordinates are absolute.\n * These coordinates are unitless and hence in the user coordinate system.\n * See developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Paths#Line_commands\n *\n * @param x The absolute x coordinate.\n * @param y The absolute y coordinate.\n * @returns A string of the format ' M x,y '\n */\nexport function moveTo(x: number, y: number): string {\n  return ' M ' + x + ',' + y + ' ';\n}\n\n/**\n * Move the cursor to the given position without drawing a line.\n * Coordinates are relative.\n * These coordinates are unitless and hence in the user coordinate system.\n * See developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Paths#Line_commands\n *\n * @param dx The relative x coordinate.\n * @param dy The relative y coordinate.\n * @returns A string of the format ' m dx,dy '\n */\nexport function moveBy(dx: number, dy: number): string {\n  return ' m ' + dx + ',' + dy + ' ';\n}\n\n/**\n * Draw a line from the current point to the end point, which is the current\n * point shifted by dx along the x-axis and dy along the y-axis.\n * These coordinates are unitless and hence in the user coordinate system.\n * See developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Paths#Line_commands\n *\n * @param dx The relative x coordinate.\n * @param dy The relative y coordinate.\n * @returns A string of the format ' l dx,dy '\n */\nexport function lineTo(dx: number, dy: number): string {\n  return ' l ' + dx + ',' + dy + ' ';\n}\n\n/**\n * Draw multiple lines connecting all of the given points in order.  This is\n * equivalent to a series of 'l' commands.\n * These coordinates are unitless and hence in the user coordinate system.\n * See developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Paths#Line_commands\n *\n * @param points An array containing all of the points to draw lines to, in\n *     order.  The points are represented as strings of the format ' dx,dy '.\n * @returns A string of the format ' l (dx,dy)+ '\n */\nexport function line(points: string[]): string {\n  return ' l' + points.join('');\n}\n\n/**\n * Draw a horizontal or vertical line.\n * The first argument specifies the direction and whether the given position is\n * relative or absolute.\n * These coordinates are unitless and hence in the user coordinate system.\n * See developer.mozilla.org/en-US/docs/Web/SVG/Attribute/d#LineTo_path_commands\n *\n * @param command The command to prepend to the coordinate.  This should be one\n *     of: V, v, H, h.\n * @param val The coordinate to pass to the command.  It may be absolute or\n *     relative.\n * @returns A string of the format ' command val '\n */\nexport function lineOnAxis(command: string, val: number): string {\n  return ' ' + command + ' ' + val + ' ';\n}\n\n/**\n * Draw an elliptical arc curve.\n * These coordinates are unitless and hence in the user coordinate system.\n * See developer.mozilla.org/en-US/docs/Web/SVG/Attribute/d#Elliptical_Arc_Curve\n *\n * @param command The command string.  Either 'a' or 'A'.\n * @param flags The flag string.  See the MDN documentation for a description\n *     and examples.\n * @param radius The radius of the arc to draw.\n * @param point The point to move the cursor to after drawing the arc, specified\n *     either in absolute or relative coordinates depending on the command.\n * @returns A string of the format 'command radius radius flags point'\n */\nexport function arc(\n  command: string,\n  flags: string,\n  radius: number,\n  point: string,\n): string {\n  return command + ' ' + radius + ' ' + radius + ' ' + flags + point;\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {Block} from '../block.js';\nimport type {IIcon} from '../interfaces/i_icon.js';\nimport * as registry from '../registry.js';\nimport {IconType} from './icon_types.js';\n\n/**\n * Registers the given icon so that it can be deserialized.\n *\n * @param type The type of the icon to register. This should be the same string\n *     that is returned from its `getType` method.\n * @param iconConstructor The icon class/constructor to register.\n */\nexport function register(\n  type: IconType<IIcon>,\n  iconConstructor: new (block: Block) => IIcon,\n) {\n  registry.register(registry.Type.ICON, type.toString(), iconConstructor);\n}\n\n/**\n * Unregisters the icon associated with the given type.\n *\n * @param type The type of the icon to unregister.\n */\nexport function unregister(type: string) {\n  registry.unregister(registry.Type.ICON, type);\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.Procedures\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_change.js';\n\nimport type {Block} from './block.js';\nimport type {BlockSvg} from './block_svg.js';\nimport {Blocks} from './blocks.js';\nimport * as common from './common.js';\nimport type {Abstract} from './events/events_abstract.js';\nimport type {BubbleOpen} from './events/events_bubble_open.js';\nimport * as eventUtils from './events/utils.js';\nimport {Field, UnattachedFieldError} from './field.js';\nimport {Msg} from './msg.js';\nimport {Names} from './names.js';\nimport {IParameterModel} from './interfaces/i_parameter_model.js';\nimport {IProcedureMap} from './interfaces/i_procedure_map.js';\nimport {IProcedureModel} from './interfaces/i_procedure_model.js';\nimport {\n  IProcedureBlock,\n  isProcedureBlock,\n} from './interfaces/i_procedure_block.js';\nimport {\n  isLegacyProcedureCallBlock,\n  isLegacyProcedureDefBlock,\n  ProcedureBlock,\n  ProcedureTuple,\n} from './interfaces/i_legacy_procedure_blocks.js';\nimport {ObservableProcedureMap} from './observable_procedure_map.js';\nimport * as utilsXml from './utils/xml.js';\nimport * as Variables from './variables.js';\nimport type {Workspace} from './workspace.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport {MutatorIcon} from './icons.js';\n\n/**\n * String for use in the \"custom\" attribute of a category in toolbox XML.\n * This string indicates that the category should be dynamically populated with\n * procedure blocks.\n * See also Blockly.Variables.CATEGORY_NAME and\n * Blockly.VariablesDynamic.CATEGORY_NAME.\n */\nexport const CATEGORY_NAME = 'PROCEDURE';\n\n/**\n * The default argument for a procedures_mutatorarg block.\n */\nexport const DEFAULT_ARG = 'x';\n\n/**\n * Find all user-created procedure definitions in a workspace.\n *\n * @param root Root workspace.\n * @returns Pair of arrays, the first contains procedures without return\n *     variables, the second with. Each procedure is defined by a three-element\n *     list of name, parameter list, and return value boolean.\n */\nexport function allProcedures(\n  root: Workspace,\n): [ProcedureTuple[], ProcedureTuple[]] {\n  const proceduresNoReturn: ProcedureTuple[] = root\n    .getProcedureMap()\n    .getProcedures()\n    .filter((p) => !p.getReturnTypes())\n    .map((p) => [\n      p.getName(),\n      p.getParameters().map((pa) => pa.getName()),\n      false,\n    ]);\n  root.getBlocksByType('procedures_defnoreturn', false).forEach((b) => {\n    if (!isProcedureBlock(b) && isLegacyProcedureDefBlock(b)) {\n      proceduresNoReturn.push(b.getProcedureDef());\n    }\n  });\n\n  const proceduresReturn: ProcedureTuple[] = root\n    .getProcedureMap()\n    .getProcedures()\n    .filter((p) => !!p.getReturnTypes())\n    .map((p) => [\n      p.getName(),\n      p.getParameters().map((pa) => pa.getName()),\n      true,\n    ]);\n  root.getBlocksByType('procedures_defreturn', false).forEach((b) => {\n    if (!isProcedureBlock(b) && isLegacyProcedureDefBlock(b)) {\n      proceduresReturn.push(b.getProcedureDef());\n    }\n  });\n  proceduresNoReturn.sort(procTupleComparator);\n  proceduresReturn.sort(procTupleComparator);\n  return [proceduresNoReturn, proceduresReturn];\n}\n\n/**\n * Comparison function for case-insensitive sorting of the first element of\n * a tuple.\n *\n * @param ta First tuple.\n * @param tb Second tuple.\n * @returns -1, 0, or 1 to signify greater than, equality, or less than.\n */\nfunction procTupleComparator(ta: ProcedureTuple, tb: ProcedureTuple): number {\n  return ta[0].localeCompare(tb[0], undefined, {sensitivity: 'base'});\n}\n\n/**\n * Ensure two identically-named procedures don't exist.\n * Take the proposed procedure name, and return a legal name i.e. one that\n * is not empty and doesn't collide with other procedures.\n *\n * @param name Proposed procedure name.\n * @param block Block to disambiguate.\n * @returns Non-colliding name.\n */\nexport function findLegalName(name: string, block: Block): string {\n  if (block.isInFlyout) {\n    // Flyouts can have multiple procedures called 'do something'.\n    return name;\n  }\n  name = name || Msg['UNNAMED_KEY'] || 'unnamed';\n  while (!isLegalName(name, block.workspace, block)) {\n    // Collision with another procedure.\n    const r = name.match(/^(.*?)(\\d+)$/);\n    if (!r) {\n      name += '2';\n    } else {\n      name = r[1] + (parseInt(r[2]) + 1);\n    }\n  }\n  return name;\n}\n/**\n * Does this procedure have a legal name?  Illegal names include names of\n * procedures already defined.\n *\n * @param name The questionable name.\n * @param workspace The workspace to scan for collisions.\n * @param opt_exclude Optional block to exclude from comparisons (one doesn't\n *     want to collide with oneself).\n * @returns True if the name is legal.\n */\nfunction isLegalName(\n  name: string,\n  workspace: Workspace,\n  opt_exclude?: Block,\n): boolean {\n  return !isNameUsed(name, workspace, opt_exclude);\n}\n\n/**\n * Return if the given name is already a procedure name.\n *\n * @param name The questionable name.\n * @param workspace The workspace to scan for collisions.\n * @param opt_exclude Optional block to exclude from comparisons (one doesn't\n *     want to collide with oneself).\n * @returns True if the name is used, otherwise return false.\n */\nexport function isNameUsed(\n  name: string,\n  workspace: Workspace,\n  opt_exclude?: Block,\n): boolean {\n  for (const block of workspace.getAllBlocks(false)) {\n    if (block === opt_exclude) continue;\n\n    if (\n      isLegacyProcedureDefBlock(block) &&\n      Names.equals(block.getProcedureDef()[0], name)\n    ) {\n      return true;\n    }\n  }\n\n  const excludeModel =\n    opt_exclude && isProcedureBlock(opt_exclude)\n      ? opt_exclude?.getProcedureModel()\n      : undefined;\n  for (const model of workspace.getProcedureMap().getProcedures()) {\n    if (model === excludeModel) continue;\n    if (Names.equals(model.getName(), name)) return true;\n  }\n  return false;\n}\n\n/**\n * Rename a procedure.  Called by the editable field.\n *\n * @param name The proposed new name.\n * @returns The accepted name.\n */\nexport function rename(this: Field, name: string): string {\n  const block = this.getSourceBlock();\n  if (!block) {\n    throw new UnattachedFieldError();\n  }\n\n  // Strip leading and trailing whitespace.  Beyond this, all names are legal.\n  name = name.trim();\n\n  const legalName = findLegalName(name, block);\n  if (isProcedureBlock(block) && !block.isInsertionMarker()) {\n    block.getProcedureModel().setName(legalName);\n  }\n  const oldName = this.getValue();\n  if (oldName !== name && oldName !== legalName) {\n    // Rename any callers.\n    const blocks = block.workspace.getAllBlocks(false);\n    for (let i = 0; i < blocks.length; i++) {\n      // Assume it is a procedure so we can check.\n      const procedureBlock = blocks[i] as unknown as ProcedureBlock;\n      if (procedureBlock.renameProcedure) {\n        procedureBlock.renameProcedure(oldName as string, legalName);\n      }\n    }\n  }\n  return legalName;\n}\n\n/**\n * Construct the blocks required by the flyout for the procedure category.\n *\n * @param workspace The workspace containing procedures.\n * @returns Array of XML block elements.\n */\nexport function flyoutCategory(workspace: WorkspaceSvg): Element[] {\n  const xmlList = [];\n  if (Blocks['procedures_defnoreturn']) {\n    // <block type=\"procedures_defnoreturn\" gap=\"16\">\n    //     <field name=\"NAME\">do something</field>\n    // </block>\n    const block = utilsXml.createElement('block');\n    block.setAttribute('type', 'procedures_defnoreturn');\n    block.setAttribute('gap', '16');\n    const nameField = utilsXml.createElement('field');\n    nameField.setAttribute('name', 'NAME');\n    nameField.appendChild(\n      utilsXml.createTextNode(Msg['PROCEDURES_DEFNORETURN_PROCEDURE']),\n    );\n    block.appendChild(nameField);\n    xmlList.push(block);\n  }\n  if (Blocks['procedures_defreturn']) {\n    // <block type=\"procedures_defreturn\" gap=\"16\">\n    //     <field name=\"NAME\">do something</field>\n    // </block>\n    const block = utilsXml.createElement('block');\n    block.setAttribute('type', 'procedures_defreturn');\n    block.setAttribute('gap', '16');\n    const nameField = utilsXml.createElement('field');\n    nameField.setAttribute('name', 'NAME');\n    nameField.appendChild(\n      utilsXml.createTextNode(Msg['PROCEDURES_DEFRETURN_PROCEDURE']),\n    );\n    block.appendChild(nameField);\n    xmlList.push(block);\n  }\n  if (Blocks['procedures_ifreturn']) {\n    // <block type=\"procedures_ifreturn\" gap=\"16\"></block>\n    const block = utilsXml.createElement('block');\n    block.setAttribute('type', 'procedures_ifreturn');\n    block.setAttribute('gap', '16');\n    xmlList.push(block);\n  }\n  if (xmlList.length) {\n    // Add slightly larger gap between system blocks and user calls.\n    xmlList[xmlList.length - 1].setAttribute('gap', '24');\n  }\n\n  /**\n   * Add items to xmlList for each listed procedure.\n   *\n   * @param procedureList A list of procedures, each of which is defined by a\n   *     three-element list of name, parameter list, and return value boolean.\n   * @param templateName The type of the block to generate.\n   */\n  function populateProcedures(\n    procedureList: ProcedureTuple[],\n    templateName: string,\n  ) {\n    for (let i = 0; i < procedureList.length; i++) {\n      const name = procedureList[i][0];\n      const args = procedureList[i][1];\n      // <block type=\"procedures_callnoreturn\" gap=\"16\">\n      //   <mutation name=\"do something\">\n      //     <arg name=\"x\"></arg>\n      //   </mutation>\n      // </block>\n      const block = utilsXml.createElement('block');\n      block.setAttribute('type', templateName);\n      block.setAttribute('gap', '16');\n      const mutation = utilsXml.createElement('mutation');\n      mutation.setAttribute('name', name);\n      block.appendChild(mutation);\n      for (let j = 0; j < args.length; j++) {\n        const arg = utilsXml.createElement('arg');\n        arg.setAttribute('name', args[j]);\n        mutation.appendChild(arg);\n      }\n      xmlList.push(block);\n    }\n  }\n\n  const tuple = allProcedures(workspace);\n  populateProcedures(tuple[0], 'procedures_callnoreturn');\n  populateProcedures(tuple[1], 'procedures_callreturn');\n  return xmlList;\n}\n\n/**\n * Updates the procedure mutator's flyout so that the arg block is not a\n * duplicate of another arg.\n *\n * @param workspace The procedure mutator's workspace. This workspace's flyout\n *     is what is being updated.\n */\nfunction updateMutatorFlyout(workspace: WorkspaceSvg) {\n  const usedNames = [];\n  const blocks = workspace.getBlocksByType('procedures_mutatorarg', false);\n  for (let i = 0, block; (block = blocks[i]); i++) {\n    usedNames.push(block.getFieldValue('NAME'));\n  }\n\n  const xmlElement = utilsXml.createElement('xml');\n  const argBlock = utilsXml.createElement('block');\n  argBlock.setAttribute('type', 'procedures_mutatorarg');\n  const nameField = utilsXml.createElement('field');\n  nameField.setAttribute('name', 'NAME');\n  const argValue = Variables.generateUniqueNameFromOptions(\n    DEFAULT_ARG,\n    usedNames,\n  );\n  const fieldContent = utilsXml.createTextNode(argValue);\n\n  nameField.appendChild(fieldContent);\n  argBlock.appendChild(nameField);\n  xmlElement.appendChild(argBlock);\n\n  workspace.updateToolbox(xmlElement);\n}\n\n/**\n * Listens for when a procedure mutator is opened. Then it triggers a flyout\n * update and adds a mutator change listener to the mutator workspace.\n *\n * @param e The event that triggered this listener.\n * @internal\n */\nexport function mutatorOpenListener(e: Abstract) {\n  if (e.type !== eventUtils.BUBBLE_OPEN) {\n    return;\n  }\n  const bubbleEvent = e as BubbleOpen;\n  if (\n    !(bubbleEvent.bubbleType === 'mutator' && bubbleEvent.isOpen) ||\n    !bubbleEvent.blockId\n  ) {\n    return;\n  }\n  const workspaceId = bubbleEvent.workspaceId;\n  const block = common\n    .getWorkspaceById(workspaceId)!\n    .getBlockById(bubbleEvent.blockId) as BlockSvg;\n  const type = block.type;\n  if (type !== 'procedures_defnoreturn' && type !== 'procedures_defreturn') {\n    return;\n  }\n  const workspace = (\n    block.getIcon(MutatorIcon.TYPE) as MutatorIcon\n  ).getWorkspace()!;\n  updateMutatorFlyout(workspace);\n  workspace.addChangeListener(mutatorChangeListener);\n}\n/**\n * Listens for changes in a procedure mutator and triggers flyout updates when\n * necessary.\n *\n * @param e The event that triggered this listener.\n */\nfunction mutatorChangeListener(e: Abstract) {\n  if (\n    e.type !== eventUtils.BLOCK_CREATE &&\n    e.type !== eventUtils.BLOCK_DELETE &&\n    e.type !== eventUtils.BLOCK_CHANGE &&\n    e.type !== eventUtils.BLOCK_FIELD_INTERMEDIATE_CHANGE\n  ) {\n    return;\n  }\n  const workspaceId = e.workspaceId as string;\n  const workspace = common.getWorkspaceById(workspaceId) as WorkspaceSvg;\n  updateMutatorFlyout(workspace);\n}\n\n/**\n * Find all the callers of a named procedure.\n *\n * @param name Name of procedure.\n * @param workspace The workspace to find callers in.\n * @returns Array of caller blocks.\n */\nexport function getCallers(name: string, workspace: Workspace): Block[] {\n  return workspace.getAllBlocks(false).filter((block) => {\n    return (\n      blockIsModernCallerFor(block, name) ||\n      (isLegacyProcedureCallBlock(block) &&\n        Names.equals(block.getProcedureCall(), name))\n    );\n  });\n}\n\n/**\n * @returns True if the given block is a modern-style caller block of the given\n *     procedure name.\n */\nfunction blockIsModernCallerFor(block: Block, procName: string): boolean {\n  return (\n    isProcedureBlock(block) &&\n    !block.isProcedureDef() &&\n    block.getProcedureModel() &&\n    Names.equals(block.getProcedureModel().getName(), procName)\n  );\n}\n\n/**\n * When a procedure definition changes its parameters, find and edit all its\n * callers.\n *\n * @param defBlock Procedure definition block.\n */\nexport function mutateCallers(defBlock: Block) {\n  const oldRecordUndo = eventUtils.getRecordUndo();\n  const procedureBlock = defBlock as unknown as ProcedureBlock;\n  const name = procedureBlock.getProcedureDef()[0];\n  const xmlElement = defBlock.mutationToDom!(true);\n  const callers = getCallers(name, defBlock.workspace);\n  for (let i = 0, caller; (caller = callers[i]); i++) {\n    const oldMutationDom = caller.mutationToDom!();\n    const oldMutation = oldMutationDom && utilsXml.domToText(oldMutationDom);\n    if (caller.domToMutation) {\n      caller.domToMutation(xmlElement);\n    }\n    const newMutationDom = caller.mutationToDom!();\n    const newMutation = newMutationDom && utilsXml.domToText(newMutationDom);\n    if (oldMutation !== newMutation) {\n      // Fire a mutation on every caller block.  But don't record this as an\n      // undo action since it is deterministically tied to the procedure's\n      // definition mutation.\n      eventUtils.setRecordUndo(false);\n      eventUtils.fire(\n        new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n          caller,\n          'mutation',\n          null,\n          oldMutation,\n          newMutation,\n        ),\n      );\n      eventUtils.setRecordUndo(oldRecordUndo);\n    }\n  }\n}\n\n/**\n * Find the definition block for the named procedure.\n *\n * @param name Name of procedure.\n * @param workspace The workspace to search.\n * @returns The procedure definition block, or null not found.\n */\nexport function getDefinition(\n  name: string,\n  workspace: Workspace,\n): Block | null {\n  // Do not assume procedure is a top block. Some languages allow nested\n  // procedures. Also do not assume it is one of the built-in blocks. Only\n  // rely on isProcedureDef and getProcedureDef.\n  for (const block of workspace.getAllBlocks(false)) {\n    if (\n      isProcedureBlock(block) &&\n      block.isProcedureDef() &&\n      Names.equals(block.getProcedureModel().getName(), name)\n    ) {\n      return block;\n    }\n    if (\n      isLegacyProcedureDefBlock(block) &&\n      Names.equals(block.getProcedureDef()[0], name)\n    ) {\n      return block;\n    }\n  }\n  return null;\n}\n\nexport {\n  ObservableProcedureMap,\n  IParameterModel,\n  IProcedureBlock,\n  isProcedureBlock,\n  IProcedureMap,\n  IProcedureModel,\n  ProcedureTuple,\n};\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.ConstantProvider\n\nimport {ConnectionType} from '../../connection_type.js';\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {BlockStyle, Theme} from '../../theme.js';\nimport * as colour from '../../utils/colour.js';\nimport * as dom from '../../utils/dom.js';\nimport * as parsing from '../../utils/parsing.js';\nimport {Svg} from '../../utils/svg.js';\nimport * as svgPaths from '../../utils/svg_paths.js';\n\n/** An object containing sizing and path information about outside corners. */\nexport interface OutsideCorners {\n  topLeft: string;\n  topRight: string;\n  bottomRight: string;\n  bottomLeft: string;\n  rightHeight: number;\n}\n\n/** An object containing sizing and path information about inside corners. */\nexport interface InsideCorners {\n  width: number;\n  height: number;\n  pathTop: string;\n  pathBottom: string;\n}\n\n/** An object containing sizing and path information about a start hat. */\nexport interface StartHat {\n  height: number;\n  width: number;\n  path: string;\n}\n\n/** An object containing sizing and path information about a notch. */\nexport interface Notch {\n  type: number;\n  width: number;\n  height: number;\n  pathLeft: string;\n  pathRight: string;\n}\n\n/** An object containing sizing and path information about a puzzle tab. */\nexport interface PuzzleTab {\n  type: number;\n  width: number;\n  height: number;\n  pathDown: string;\n  pathUp: string;\n}\n\n/**\n * An object containing sizing and path information about collapsed block\n * indicators.\n */\nexport interface JaggedTeeth {\n  height: number;\n  width: number;\n  path: string;\n}\n\nexport type BaseShape = {\n  type: number;\n  width: number;\n  height: number;\n};\n\n/** An object containing sizing and type information about a dynamic shape. */\nexport type DynamicShape = {\n  type: number;\n  width: (p1: number) => number;\n  height: (p1: number) => number;\n  isDynamic: true;\n  connectionOffsetY: (p1: number) => number;\n  connectionOffsetX: (p1: number) => number;\n  pathDown: (p1: number) => string;\n  pathUp: (p1: number) => string;\n  pathRightDown: (p1: number) => string;\n  pathRightUp: (p1: number) => string;\n};\n\n/** An object containing sizing and type information about a shape. */\nexport type Shape = BaseShape | DynamicShape;\n\n/**\n * Returns whether the shape is dynamic or not.\n *\n * @param shape The shape to check for dynamic-ness.\n * @returns Whether the shape is a dynamic shape or not.\n */\nexport function isDynamicShape(shape: Shape): shape is DynamicShape {\n  return (shape as DynamicShape).isDynamic;\n}\n\n/** Returns whether the shape is a puzzle tab or not. */\nexport function isPuzzleTab(shape: Shape): shape is PuzzleTab {\n  return (\n    (shape as PuzzleTab).pathDown !== undefined &&\n    (shape as PuzzleTab).pathUp !== undefined\n  );\n}\n\n/** Returns whether the shape is a notch or not. */\nexport function isNotch(shape: Shape): shape is Notch {\n  return (\n    (shape as Notch).pathLeft !== undefined &&\n    (shape as Notch).pathRight !== undefined\n  );\n}\n\n/**\n * An object that provides constants for rendering blocks.\n */\nexport class ConstantProvider {\n  /** The size of an empty spacer. */\n  NO_PADDING = 0;\n\n  /** The size of small padding. */\n  SMALL_PADDING = 3;\n\n  /** The size of medium padding. */\n  MEDIUM_PADDING = 5;\n\n  /** The size of medium-large padding. */\n  MEDIUM_LARGE_PADDING = 8;\n\n  /** The size of large padding. */\n  LARGE_PADDING = 10;\n  TALL_INPUT_FIELD_OFFSET_Y: number;\n\n  /** The height of the puzzle tab used for input and output connections. */\n  TAB_HEIGHT = 15;\n\n  /**\n   * The offset from the top of the block at which a puzzle tab is positioned.\n   */\n  TAB_OFFSET_FROM_TOP = 5;\n\n  /**\n   * Vertical overlap of the puzzle tab, used to make it look more like a\n   * puzzle piece.\n   */\n  TAB_VERTICAL_OVERLAP = 2.5;\n\n  /** The width of the puzzle tab used for input and output connections. */\n  TAB_WIDTH = 8;\n\n  /** The width of the notch used for previous and next connections. */\n  NOTCH_WIDTH = 15;\n\n  /** The height of the notch used for previous and next connections. */\n  NOTCH_HEIGHT = 4;\n\n  /** The minimum width of the block. */\n  MIN_BLOCK_WIDTH = 12;\n  EMPTY_BLOCK_SPACER_HEIGHT = 16;\n  DUMMY_INPUT_MIN_HEIGHT: number;\n  DUMMY_INPUT_SHADOW_MIN_HEIGHT: number;\n\n  /** Rounded corner radius. */\n  CORNER_RADIUS = 8;\n\n  /**\n   * Offset from the left side of a block or the inside of a statement input\n   * to the left side of the notch.\n   */\n  NOTCH_OFFSET_LEFT = 15;\n  STATEMENT_INPUT_NOTCH_OFFSET: number;\n\n  STATEMENT_BOTTOM_SPACER = 0;\n  STATEMENT_INPUT_PADDING_LEFT = 20;\n\n  /** Vertical padding between consecutive statement inputs. */\n  BETWEEN_STATEMENT_PADDING_Y = 4;\n  TOP_ROW_MIN_HEIGHT: number;\n  TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT: number;\n  BOTTOM_ROW_MIN_HEIGHT: number;\n  BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT: number;\n\n  /**\n   * Whether to add a 'hat' on top of all blocks with no previous or output\n   * connections. Can be overridden by 'hat' property on Theme.BlockStyle.\n   */\n  ADD_START_HATS = false;\n\n  /** Height of the top hat. */\n  START_HAT_HEIGHT = 15;\n\n  /** Width of the top hat. */\n  START_HAT_WIDTH = 100;\n\n  SPACER_DEFAULT_HEIGHT = 15;\n\n  MIN_BLOCK_HEIGHT = 24;\n\n  EMPTY_INLINE_INPUT_PADDING = 14.5;\n  EMPTY_INLINE_INPUT_HEIGHT: number;\n\n  EXTERNAL_VALUE_INPUT_PADDING = 2;\n  EMPTY_STATEMENT_INPUT_HEIGHT: number;\n  START_POINT: string;\n\n  /** Height of SVG path for jagged teeth at the end of collapsed blocks. */\n  JAGGED_TEETH_HEIGHT = 12;\n\n  /** Width of SVG path for jagged teeth at the end of collapsed blocks. */\n  JAGGED_TEETH_WIDTH = 6;\n\n  /** Point size of text. */\n  FIELD_TEXT_FONTSIZE = 11;\n\n  /** Text font weight. */\n  FIELD_TEXT_FONTWEIGHT = 'normal';\n\n  /** Text font family. */\n  FIELD_TEXT_FONTFAMILY = 'sans-serif';\n\n  /**\n   * Height of text.  This constant is dynamically set in\n   * `setFontConstants_` to be the height of the text based on the font\n   * used.\n   */\n  FIELD_TEXT_HEIGHT = -1; // Dynamically set.\n\n  /**\n   * Text baseline.  This constant is dynamically set in `setFontConstants_`\n   * to be the baseline of the text based on the font used.\n   */\n  FIELD_TEXT_BASELINE = -1; // Dynamically set.\n\n  /** A field's border rect corner radius. */\n  FIELD_BORDER_RECT_RADIUS = 4;\n\n  /** A field's border rect default height. */\n  FIELD_BORDER_RECT_HEIGHT = 16;\n\n  /** A field's border rect X padding. */\n  FIELD_BORDER_RECT_X_PADDING = 5;\n\n  /** A field's border rect Y padding. */\n  FIELD_BORDER_RECT_Y_PADDING = 3;\n\n  /**\n   * The backing colour of a field's border rect.\n   */\n  FIELD_BORDER_RECT_COLOUR = '#fff';\n  FIELD_TEXT_BASELINE_CENTER: boolean;\n  FIELD_DROPDOWN_BORDER_RECT_HEIGHT: number;\n\n  /**\n   * Whether or not a dropdown field should add a border rect when in a shadow\n   * block.\n   */\n  FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW = false;\n\n  /**\n   * Whether or not a dropdown field's div should be coloured to match the\n   * block colours.\n   */\n  FIELD_DROPDOWN_COLOURED_DIV = false;\n\n  /** Whether or not a dropdown field uses a text or SVG arrow. */\n  FIELD_DROPDOWN_SVG_ARROW = false;\n  FIELD_DROPDOWN_SVG_ARROW_PADDING: number;\n\n  /** A dropdown field's SVG arrow size. */\n  FIELD_DROPDOWN_SVG_ARROW_SIZE = 12;\n  FIELD_DROPDOWN_SVG_ARROW_DATAURI: string;\n\n  /**\n   * Whether or not to show a box shadow around the widget div. This is only a\n   * feature of full block fields.\n   */\n  FIELD_TEXTINPUT_BOX_SHADOW = false;\n\n  /**\n   * Whether or not the colour field should display its colour value on the\n   * entire block.\n   */\n  FIELD_COLOUR_FULL_BLOCK = false;\n\n  /** A colour field's default width. */\n  FIELD_COLOUR_DEFAULT_WIDTH = 26;\n  FIELD_COLOUR_DEFAULT_HEIGHT: number;\n  FIELD_CHECKBOX_X_OFFSET: number;\n  randomIdentifier: string;\n\n  /**\n   * The defs tag that contains all filters and patterns for this Blockly\n   * instance.\n   */\n  private defs: SVGElement | null = null;\n\n  /**\n   * The ID of the emboss filter, or the empty string if no filter is set.\n   */\n  embossFilterId = '';\n\n  /** The <filter> element to use for highlighting, or null if not set. */\n  private embossFilter: SVGElement | null = null;\n\n  /**\n   * The ID of the disabled pattern, or the empty string if no pattern is set.\n   */\n  disabledPatternId = '';\n\n  /**\n   * The <pattern> element to use for disabled blocks, or null if not set.\n   */\n  private disabledPattern: SVGElement | null = null;\n\n  /**\n   * The ID of the debug filter, or the empty string if no pattern is set.\n   */\n  debugFilterId = '';\n\n  /**\n   * The <filter> element to use for a debug highlight, or null if not set.\n   */\n  private debugFilter: SVGElement | null = null;\n\n  /** The <style> element to use for injecting renderer specific CSS. */\n  private cssNode: HTMLStyleElement | null = null;\n\n  /**\n   * Cursor colour.\n   */\n  CURSOR_COLOUR = '#cc0a0a';\n\n  /**\n   * Immovable marker colour.\n   */\n  MARKER_COLOUR = '#4286f4';\n\n  /**\n   * Width of the horizontal cursor.\n   */\n  CURSOR_WS_WIDTH = 100;\n\n  /**\n   * Height of the horizontal cursor.\n   */\n  WS_CURSOR_HEIGHT = 5;\n\n  /**\n   * Padding around a stack.\n   */\n  CURSOR_STACK_PADDING = 10;\n\n  /**\n   * Padding around a block.\n   */\n  CURSOR_BLOCK_PADDING = 2;\n\n  /**\n   * Stroke of the cursor.\n   */\n  CURSOR_STROKE_WIDTH = 4;\n\n  /**\n   * Whether text input and colour fields fill up the entire source block.\n   */\n  FULL_BLOCK_FIELDS = false;\n\n  /**\n   * The main colour of insertion markers, in hex.  The block is rendered a\n   * transparent grey by changing the fill opacity in CSS.\n   */\n  INSERTION_MARKER_COLOUR = '#000000';\n\n  /**\n   * The insertion marker opacity.\n   */\n  INSERTION_MARKER_OPACITY = 0.2;\n\n  SHAPES: {[key: string]: number} = {PUZZLE: 1, NOTCH: 2};\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  JAGGED_TEETH!: JaggedTeeth;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  NOTCH!: Notch;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  START_HAT!: StartHat;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  PUZZLE_TAB!: PuzzleTab;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  INSIDE_CORNERS!: InsideCorners;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  OUTSIDE_CORNERS!: OutsideCorners;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n\n  blockStyles!: {[key: string]: BlockStyle};\n\n  constructor() {\n    /**\n     * Offset from the top of the row for placing fields on inline input rows\n     * and statement input rows.\n     * Matches existing rendering (in 2019).\n     */\n    this.TALL_INPUT_FIELD_OFFSET_Y = this.MEDIUM_PADDING;\n\n    /** The minimum height of a dummy input row. */\n    this.DUMMY_INPUT_MIN_HEIGHT = this.TAB_HEIGHT;\n\n    /** The minimum height of a dummy input row in a shadow block. */\n    this.DUMMY_INPUT_SHADOW_MIN_HEIGHT = this.TAB_HEIGHT;\n\n    /**\n     * Additional offset added to the statement input's width to account for the\n     * notch.\n     */\n    this.STATEMENT_INPUT_NOTCH_OFFSET = this.NOTCH_OFFSET_LEFT;\n\n    /** The top row's minimum height. */\n    this.TOP_ROW_MIN_HEIGHT = this.MEDIUM_PADDING;\n\n    /** The top row's minimum height if it precedes a statement. */\n    this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT = this.LARGE_PADDING;\n\n    /** The bottom row's minimum height. */\n    this.BOTTOM_ROW_MIN_HEIGHT = this.MEDIUM_PADDING;\n\n    /** The bottom row's minimum height if it follows a statement input. */\n    this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT = this.LARGE_PADDING;\n\n    /** The height of an empty inline input. */\n    this.EMPTY_INLINE_INPUT_HEIGHT = this.TAB_HEIGHT + 11;\n\n    /**\n     * The height of an empty statement input.  Note that in the old rendering\n     * this varies slightly depending on whether the block has external or\n     * inline inputs. In the new rendering this is consistent.  It seems\n     * unlikely that the old behaviour was intentional.\n     */\n    this.EMPTY_STATEMENT_INPUT_HEIGHT = this.MIN_BLOCK_HEIGHT;\n\n    this.START_POINT = svgPaths.moveBy(0, 0);\n\n    /**\n     * A field's text element's dominant baseline. Pre-2022 this could be false\n     * for certain browsers.\n     */\n    this.FIELD_TEXT_BASELINE_CENTER = true;\n\n    /** A dropdown field's border rect height. */\n    this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT = this.FIELD_BORDER_RECT_HEIGHT;\n\n    /** A dropdown field's SVG arrow padding. */\n    this.FIELD_DROPDOWN_SVG_ARROW_PADDING = this.FIELD_BORDER_RECT_X_PADDING;\n\n    /** A dropdown field's SVG arrow datauri. */\n    this.FIELD_DROPDOWN_SVG_ARROW_DATAURI =\n      'data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllci' +\n      'AxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaG' +\n      'VpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLW' +\n      'Fycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuND' +\n      'EsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTD' +\n      'AuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNz' +\n      'FDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMC' +\n      'wxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNz' +\n      'lhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYz' +\n      'AuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMz' +\n      'dBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=';\n\n    /** A colour field's default height. */\n    this.FIELD_COLOUR_DEFAULT_HEIGHT = this.FIELD_BORDER_RECT_HEIGHT;\n\n    /** A checkbox field's X offset. */\n    this.FIELD_CHECKBOX_X_OFFSET = this.FIELD_BORDER_RECT_X_PADDING - 3;\n\n    /**\n     * A random identifier used to ensure a unique ID is used for each\n     * filter/pattern for the case of multiple Blockly instances on a page.\n     */\n    this.randomIdentifier = String(Math.random()).substring(2);\n  }\n\n  /**\n   * Initialize shape objects based on the constants set in the constructor.\n   */\n  init() {\n    /**\n     * An object containing sizing and path information about collapsed block\n     * indicators.\n     */\n    this.JAGGED_TEETH = this.makeJaggedTeeth();\n\n    /** An object containing sizing and path information about notches. */\n    this.NOTCH = this.makeNotch();\n\n    /** An object containing sizing and path information about start hats */\n    this.START_HAT = this.makeStartHat();\n\n    /**\n     * An object containing sizing and path information about puzzle tabs.\n     */\n    this.PUZZLE_TAB = this.makePuzzleTab();\n\n    /**\n     * An object containing sizing and path information about inside corners\n     */\n    this.INSIDE_CORNERS = this.makeInsideCorners();\n\n    /**\n     * An object containing sizing and path information about outside corners.\n     */\n    this.OUTSIDE_CORNERS = this.makeOutsideCorners();\n  }\n\n  /**\n   * Refresh constants properties that depend on the theme.\n   *\n   * @param theme The current workspace theme.\n   */\n  setTheme(theme: Theme) {\n    /** The block styles map. */\n    this.blockStyles = Object.create(null);\n\n    const blockStyles = theme.blockStyles;\n    for (const key in blockStyles) {\n      this.blockStyles[key] = this.validatedBlockStyle_(blockStyles[key]);\n    }\n\n    this.setDynamicProperties_(theme);\n  }\n\n  /**\n   * Sets dynamic properties that depend on other values or theme properties.\n   *\n   * @param theme The current workspace theme.\n   */\n  protected setDynamicProperties_(theme: Theme) {\n    this.setFontConstants_(theme);\n    this.setComponentConstants_(theme);\n\n    this.ADD_START_HATS =\n      theme.startHats !== undefined ? theme.startHats : this.ADD_START_HATS;\n  }\n\n  /**\n   * Set constants related to fonts.\n   *\n   * @param theme The current workspace theme.\n   */\n  protected setFontConstants_(theme: Theme) {\n    if (theme.fontStyle && theme.fontStyle['family']) {\n      this.FIELD_TEXT_FONTFAMILY = theme.fontStyle['family'];\n    }\n\n    if (theme.fontStyle && theme.fontStyle['weight']) {\n      this.FIELD_TEXT_FONTWEIGHT = theme.fontStyle['weight'];\n    }\n\n    if (theme.fontStyle && theme.fontStyle['size']) {\n      this.FIELD_TEXT_FONTSIZE = theme.fontStyle['size'];\n    }\n\n    const fontMetrics = dom.measureFontMetrics(\n      'Hg',\n      this.FIELD_TEXT_FONTSIZE + 'pt',\n      this.FIELD_TEXT_FONTWEIGHT,\n      this.FIELD_TEXT_FONTFAMILY,\n    );\n\n    this.FIELD_TEXT_HEIGHT = fontMetrics.height;\n    this.FIELD_TEXT_BASELINE = fontMetrics.baseline;\n  }\n\n  /**\n   * Set constants from a theme's component styles.\n   *\n   * @param theme The current workspace theme.\n   */\n  protected setComponentConstants_(theme: Theme) {\n    this.CURSOR_COLOUR =\n      theme.getComponentStyle('cursorColour') || this.CURSOR_COLOUR;\n    this.MARKER_COLOUR =\n      theme.getComponentStyle('markerColour') || this.MARKER_COLOUR;\n    this.INSERTION_MARKER_COLOUR =\n      theme.getComponentStyle('insertionMarkerColour') ||\n      this.INSERTION_MARKER_COLOUR;\n    this.INSERTION_MARKER_OPACITY =\n      Number(theme.getComponentStyle('insertionMarkerOpacity')) ||\n      this.INSERTION_MARKER_OPACITY;\n  }\n\n  /**\n   * Get or create a block style based on a single colour value.  Generate a\n   * name for the style based on the colour.\n   *\n   * @param colour #RRGGBB colour string.\n   * @returns An object containing the style and an autogenerated name for that\n   *     style.\n   */\n  getBlockStyleForColour(colour: string): {style: BlockStyle; name: string} {\n    const name = 'auto_' + colour;\n    if (!this.blockStyles[name]) {\n      this.blockStyles[name] = this.createBlockStyle_(colour);\n    }\n    return {style: this.blockStyles[name], name};\n  }\n\n  /**\n   * Gets the BlockStyle for the given block style name.\n   *\n   * @param blockStyleName The name of the block style.\n   * @returns The named block style, or a default style if no style with the\n   *     given name was found.\n   */\n  getBlockStyle(blockStyleName: string | null): BlockStyle {\n    return (\n      this.blockStyles[blockStyleName || ''] ||\n      (blockStyleName && blockStyleName.indexOf('auto_') === 0\n        ? this.getBlockStyleForColour(blockStyleName.substring(5)).style\n        : this.createBlockStyle_('#000000'))\n    );\n  }\n\n  /**\n   * Create a block style object based on the given colour.\n   *\n   * @param colour #RRGGBB colour string.\n   * @returns A populated block style based on the given colour.\n   */\n  protected createBlockStyle_(colour: string): BlockStyle {\n    return this.validatedBlockStyle_({'colourPrimary': colour});\n  }\n\n  /**\n   * Get a full block style object based on the input style object.  Populate\n   * any missing values.\n   *\n   * @param blockStyle A full or partial block style object.\n   * @returns A full block style object, with all required properties populated.\n   */\n  protected validatedBlockStyle_(blockStyle: Partial<BlockStyle>): BlockStyle {\n    // Make a new object with all of the same properties.\n    const valid = {} as BlockStyle;\n    if (blockStyle) {\n      Object.assign(valid, blockStyle);\n    }\n    // Validate required properties.\n    const parsedColour = parsing.parseBlockColour(\n      valid['colourPrimary'] || '#000',\n    );\n    valid.colourPrimary = parsedColour.hex;\n    valid.colourSecondary = valid['colourSecondary']\n      ? parsing.parseBlockColour(valid['colourSecondary']).hex\n      : this.generateSecondaryColour_(valid.colourPrimary);\n    valid.colourTertiary = valid['colourTertiary']\n      ? parsing.parseBlockColour(valid['colourTertiary']).hex\n      : this.generateTertiaryColour_(valid.colourPrimary);\n\n    valid.hat = valid['hat'] || '';\n    return valid;\n  }\n\n  /**\n   * Generate a secondary colour from the passed in primary colour.\n   *\n   * @param inputColour Primary colour.\n   * @returns The generated secondary colour.\n   */\n  protected generateSecondaryColour_(inputColour: string): string {\n    return colour.blend('#fff', inputColour, 0.6) || inputColour;\n  }\n\n  /**\n   * Generate a tertiary colour from the passed in primary colour.\n   *\n   * @param inputColour Primary colour.\n   * @returns The generated tertiary colour.\n   */\n  protected generateTertiaryColour_(inputColour: string): string {\n    return colour.blend('#fff', inputColour, 0.3) || inputColour;\n  }\n\n  /**\n   * Dispose of this constants provider.\n   * Delete all DOM elements that this provider created.\n   */\n  dispose() {\n    if (this.embossFilter) {\n      dom.removeNode(this.embossFilter);\n    }\n    if (this.disabledPattern) {\n      dom.removeNode(this.disabledPattern);\n    }\n    if (this.debugFilter) {\n      dom.removeNode(this.debugFilter);\n    }\n    this.cssNode = null;\n  }\n\n  /**\n   * @returns An object containing sizing and path information about collapsed\n   *     block indicators.\n   */\n  protected makeJaggedTeeth(): JaggedTeeth {\n    const height = this.JAGGED_TEETH_HEIGHT;\n    const width = this.JAGGED_TEETH_WIDTH;\n\n    const mainPath = svgPaths.line([\n      svgPaths.point(width, height / 4),\n      svgPaths.point(-width * 2, height / 2),\n      svgPaths.point(width, height / 4),\n    ]);\n    return {height, width, path: mainPath};\n  }\n\n  /**\n   * @returns An object containing sizing and path information about start hats.\n   */\n  protected makeStartHat(): StartHat {\n    const height = this.START_HAT_HEIGHT;\n    const width = this.START_HAT_WIDTH;\n\n    const mainPath = svgPaths.curve('c', [\n      svgPaths.point(30, -height),\n      svgPaths.point(70, -height),\n      svgPaths.point(width, 0),\n    ]);\n    return {height, width, path: mainPath};\n  }\n\n  /**\n   * @returns An object containing sizing and path information about puzzle\n   *     tabs.\n   */\n  protected makePuzzleTab(): PuzzleTab {\n    const width = this.TAB_WIDTH;\n    const height = this.TAB_HEIGHT;\n\n    /**\n     * Make the main path for the puzzle tab made out of a few curves (c and s).\n     * Those curves are defined with relative positions.  The 'up' and 'down'\n     * versions of the paths are the same, but the Y sign flips.  Forward and\n     * back are the signs to use to move the cursor in the direction that the\n     * path is being drawn.\n     *\n     * @param up True if the path should be drawn from bottom to top, false\n     *     otherwise.\n     * @returns A path fragment describing a puzzle tab.\n     */\n    function makeMainPath(up: boolean): string {\n      const forward = up ? -1 : 1;\n      const back = -forward;\n\n      const overlap = 2.5;\n      const halfHeight = height / 2;\n      const control1Y = halfHeight + overlap;\n      const control2Y = halfHeight + 0.5;\n      const control3Y = overlap; // 2.5\n\n      const endPoint1 = svgPaths.point(-width, forward * halfHeight);\n      const endPoint2 = svgPaths.point(width, forward * halfHeight);\n\n      return (\n        svgPaths.curve('c', [\n          svgPaths.point(0, forward * control1Y),\n          svgPaths.point(-width, back * control2Y),\n          endPoint1,\n        ]) +\n        svgPaths.curve('s', [\n          svgPaths.point(width, back * control3Y),\n          endPoint2,\n        ])\n      );\n    }\n\n    // c 0,-10  -8,8  -8,-7.5  s 8,2.5  8,-7.5\n    const pathUp = makeMainPath(true);\n    // c 0,10  -8,-8  -8,7.5  s 8,-2.5  8,7.5\n    const pathDown = makeMainPath(false);\n\n    return {\n      type: this.SHAPES.PUZZLE,\n      width,\n      height,\n      pathDown,\n      pathUp,\n    };\n  }\n\n  /**\n   * @returns An object containing sizing and path information about notches.\n   */\n  protected makeNotch(): Notch {\n    const width = this.NOTCH_WIDTH;\n    const height = this.NOTCH_HEIGHT;\n    const innerWidth = 3;\n    const outerWidth = (width - innerWidth) / 2;\n\n    /**\n     * Make the main path for the notch.\n     *\n     * @param dir Direction multiplier to apply to horizontal offsets along the\n     *     path. Either 1 or -1.\n     * @returns A path fragment describing a notch.\n     */\n    function makeMainPath(dir: number): string {\n      return svgPaths.line([\n        svgPaths.point(dir * outerWidth, height),\n        svgPaths.point(dir * innerWidth, 0),\n        svgPaths.point(dir * outerWidth, -height),\n      ]);\n    }\n    const pathLeft = makeMainPath(1);\n    const pathRight = makeMainPath(-1);\n\n    return {\n      type: this.SHAPES.NOTCH,\n      width,\n      height,\n      pathLeft,\n      pathRight,\n    };\n  }\n\n  /**\n   * @returns An object containing sizing and path information about inside\n   *     corners.\n   */\n  protected makeInsideCorners(): InsideCorners {\n    const radius = this.CORNER_RADIUS;\n\n    const innerTopLeftCorner = svgPaths.arc(\n      'a',\n      '0 0,0',\n      radius,\n      svgPaths.point(-radius, radius),\n    );\n\n    const innerBottomLeftCorner = svgPaths.arc(\n      'a',\n      '0 0,0',\n      radius,\n      svgPaths.point(radius, radius),\n    );\n\n    return {\n      width: radius,\n      height: radius,\n      pathTop: innerTopLeftCorner,\n      pathBottom: innerBottomLeftCorner,\n    };\n  }\n\n  /**\n   * @returns An object containing sizing and path information about outside\n   *     corners.\n   */\n  protected makeOutsideCorners(): OutsideCorners {\n    const radius = this.CORNER_RADIUS;\n    /** SVG path for drawing the rounded top-left corner. */\n    const topLeft =\n      svgPaths.moveBy(0, radius) +\n      svgPaths.arc('a', '0 0,1', radius, svgPaths.point(radius, -radius));\n\n    /** SVG path for drawing the rounded top-right corner. */\n    const topRight = svgPaths.arc(\n      'a',\n      '0 0,1',\n      radius,\n      svgPaths.point(radius, radius),\n    );\n\n    /** SVG path for drawing the rounded bottom-left corner. */\n    const bottomLeft = svgPaths.arc(\n      'a',\n      '0 0,1',\n      radius,\n      svgPaths.point(-radius, -radius),\n    );\n\n    /** SVG path for drawing the rounded bottom-right corner. */\n    const bottomRight = svgPaths.arc(\n      'a',\n      '0 0,1',\n      radius,\n      svgPaths.point(-radius, radius),\n    );\n\n    return {\n      topLeft,\n      topRight,\n      bottomRight,\n      bottomLeft,\n      rightHeight: radius,\n    };\n  }\n\n  /**\n   * Get an object with connection shape and sizing information based on the\n   * type of the connection.\n   *\n   * @param connection The connection to find a shape object for\n   * @returns The shape object for the connection.\n   */\n  shapeFor(connection: RenderedConnection): Shape {\n    switch (connection.type) {\n      case ConnectionType.INPUT_VALUE:\n      case ConnectionType.OUTPUT_VALUE:\n        return this.PUZZLE_TAB;\n      case ConnectionType.PREVIOUS_STATEMENT:\n      case ConnectionType.NEXT_STATEMENT:\n        return this.NOTCH;\n      default:\n        throw Error('Unknown connection type');\n    }\n  }\n\n  /**\n   * Create any DOM elements that this renderer needs (filters, patterns, etc).\n   *\n   * @param svg The root of the workspace's SVG.\n   * @param tagName The name to use for the CSS style tag.\n   * @param selector The CSS selector to use.\n   */\n  createDom(svg: SVGElement, tagName: string, selector: string) {\n    this.injectCSS_(tagName, selector);\n\n    /*\n        <defs>\n          ... filters go here ...\n        </defs>\n        */\n    this.defs = dom.createSvgElement(Svg.DEFS, {}, svg);\n    /*\n          <filter id=\"blocklyEmbossFilter837493\">\n            <feGaussianBlur in=\"SourceAlpha\" stdDeviation=\"1\" result=\"blur\" />\n            <feSpecularLighting in=\"blur\" surfaceScale=\"1\"\n       specularConstant=\"0.5\" specularExponent=\"10\" lighting-color=\"white\"\n                                result=\"specOut\">\n              <fePointLight x=\"-5000\" y=\"-10000\" z=\"20000\" />\n            </feSpecularLighting>\n            <feComposite in=\"specOut\" in2=\"SourceAlpha\" operator=\"in\"\n                         result=\"specOut\" />\n            <feComposite in=\"SourceGraphic\" in2=\"specOut\" operator=\"arithmetic\"\n                         k1=\"0\" k2=\"1\" k3=\"1\" k4=\"0\" />\n          </filter>\n        */\n    const embossFilter = dom.createSvgElement(\n      Svg.FILTER,\n      {'id': 'blocklyEmbossFilter' + this.randomIdentifier},\n      this.defs,\n    );\n    dom.createSvgElement(\n      Svg.FEGAUSSIANBLUR,\n      {'in': 'SourceAlpha', 'stdDeviation': 1, 'result': 'blur'},\n      embossFilter,\n    );\n    const feSpecularLighting = dom.createSvgElement(\n      Svg.FESPECULARLIGHTING,\n      {\n        'in': 'blur',\n        'surfaceScale': 1,\n        'specularConstant': 0.5,\n        'specularExponent': 10,\n        'lighting-color': 'white',\n        'result': 'specOut',\n      },\n      embossFilter,\n    );\n    dom.createSvgElement(\n      Svg.FEPOINTLIGHT,\n      {'x': -5000, 'y': -10000, 'z': 20000},\n      feSpecularLighting,\n    );\n    dom.createSvgElement(\n      Svg.FECOMPOSITE,\n      {\n        'in': 'specOut',\n        'in2': 'SourceAlpha',\n        'operator': 'in',\n        'result': 'specOut',\n      },\n      embossFilter,\n    );\n    dom.createSvgElement(\n      Svg.FECOMPOSITE,\n      {\n        'in': 'SourceGraphic',\n        'in2': 'specOut',\n        'operator': 'arithmetic',\n        'k1': 0,\n        'k2': 1,\n        'k3': 1,\n        'k4': 0,\n      },\n      embossFilter,\n    );\n    this.embossFilterId = embossFilter.id;\n    this.embossFilter = embossFilter;\n\n    /*\n          <pattern id=\"blocklyDisabledPattern837493\"\n       patternUnits=\"userSpaceOnUse\" width=\"10\" height=\"10\"> <rect width=\"10\"\n       height=\"10\" fill=\"#aaa\" /> <path d=\"M 0 0 L 10 10 M 10 0 L 0 10\"\n       stroke=\"#cc0\" />\n          </pattern>\n        */\n    const disabledPattern = dom.createSvgElement(\n      Svg.PATTERN,\n      {\n        'id': 'blocklyDisabledPattern' + this.randomIdentifier,\n        'patternUnits': 'userSpaceOnUse',\n        'width': 10,\n        'height': 10,\n      },\n      this.defs,\n    );\n    dom.createSvgElement(\n      Svg.RECT,\n      {'width': 10, 'height': 10, 'fill': '#aaa'},\n      disabledPattern,\n    );\n    dom.createSvgElement(\n      Svg.PATH,\n      {'d': 'M 0 0 L 10 10 M 10 0 L 0 10', 'stroke': '#cc0'},\n      disabledPattern,\n    );\n    this.disabledPatternId = disabledPattern.id;\n    this.disabledPattern = disabledPattern;\n\n    this.createDebugFilter();\n  }\n\n  /**\n   * Create a filter for highlighting the currently rendering block during\n   * render debugging.\n   */\n  private createDebugFilter() {\n    // Only create the debug filter once.\n    if (!this.debugFilter) {\n      const debugFilter = dom.createSvgElement(\n        Svg.FILTER,\n        {\n          'id': 'blocklyDebugFilter' + this.randomIdentifier,\n          'height': '160%',\n          'width': '180%',\n          'y': '-30%',\n          'x': '-40%',\n        },\n        this.defs,\n      );\n      // Set all gaussian blur pixels to 1 opacity before applying flood\n      const debugComponentTransfer = dom.createSvgElement(\n        Svg.FECOMPONENTTRANSFER,\n        {'result': 'outBlur'},\n        debugFilter,\n      );\n      dom.createSvgElement(\n        Svg.FEFUNCA,\n        {'type': 'table', 'tableValues': '0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1'},\n        debugComponentTransfer,\n      );\n      // Color the highlight\n      dom.createSvgElement(\n        Svg.FEFLOOD,\n        {\n          'flood-color': '#ff0000',\n          'flood-opacity': 0.5,\n          'result': 'outColor',\n        },\n        debugFilter,\n      );\n      dom.createSvgElement(\n        Svg.FECOMPOSITE,\n        {\n          'in': 'outColor',\n          'in2': 'outBlur',\n          'operator': 'in',\n          'result': 'outGlow',\n        },\n        debugFilter,\n      );\n      this.debugFilterId = debugFilter.id;\n      this.debugFilter = debugFilter;\n    }\n  }\n\n  /**\n   * Inject renderer specific CSS into the page.\n   *\n   * @param tagName The name of the style tag to use.\n   * @param selector The CSS selector to use.\n   */\n  protected injectCSS_(tagName: string, selector: string) {\n    const cssArray = this.getCSS_(selector);\n    const cssNodeId = 'blockly-renderer-style-' + tagName;\n    this.cssNode = document.getElementById(cssNodeId) as HTMLStyleElement;\n    const text = cssArray.join('\\n');\n    if (this.cssNode) {\n      // Already injected, update if the theme changed.\n      this.cssNode.firstChild!.textContent = text;\n      return;\n    }\n    // Inject CSS tag at start of head.\n    const cssNode = document.createElement('style');\n    cssNode.id = cssNodeId;\n    const cssTextNode = document.createTextNode(text);\n    cssNode.appendChild(cssTextNode);\n    document.head.insertBefore(cssNode, document.head.firstChild);\n    this.cssNode = cssNode;\n  }\n\n  /**\n   * Get any renderer specific CSS to inject when the renderer is initialized.\n   *\n   * @param selector CSS selector to use.\n   * @returns Array of CSS strings.\n   */\n  protected getCSS_(selector: string): string[] {\n    // prettier-ignore\n    return [\n      // Text.\n      `${selector} .blocklyText, `,\n      `${selector} .blocklyFlyoutLabelText {`,\n        `font: ${this.FIELD_TEXT_FONTWEIGHT} ` +\n            `${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,\n      `}`,\n\n      // Fields.\n      `${selector} .blocklyText {`,\n        `fill: #fff;`,\n      `}`,\n      `${selector} .blocklyNonEditableText>rect,`,\n      `${selector} .blocklyEditableText>rect {`,\n        `fill: ${this.FIELD_BORDER_RECT_COLOUR};`,\n        `fill-opacity: .6;`,\n        `stroke: none;`,\n      `}`,\n      `${selector} .blocklyNonEditableText>text,`,\n      `${selector} .blocklyEditableText>text {`,\n        `fill: #000;`,\n      `}`,\n\n      // Flyout labels.\n      `${selector} .blocklyFlyoutLabelText {`,\n        `fill: #000;`,\n      `}`,\n\n      // Bubbles.\n      `${selector} .blocklyText.blocklyBubbleText {`,\n        `fill: #000;`,\n      `}`,\n\n      // Editable field hover.\n      `${selector} .blocklyEditableText:not(.editing):hover>rect {`,\n        `stroke: #fff;`,\n        `stroke-width: 2;`,\n      `}`,\n\n      // Text field input.\n      `${selector} .blocklyHtmlInput {`,\n        `font-family: ${this.FIELD_TEXT_FONTFAMILY};`,\n        `font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,\n      `}`,\n\n      // Selection highlight.\n      `${selector} .blocklySelected>.blocklyPath {`,\n        `stroke: #fc3;`,\n        `stroke-width: 3px;`,\n      `}`,\n\n      // Connection highlight.\n      `${selector} .blocklyHighlightedConnectionPath {`,\n        `stroke: #fc3;`,\n      `}`,\n\n      // Replaceable highlight.\n      `${selector} .blocklyReplaceable .blocklyPath {`,\n        `fill-opacity: .5;`,\n      `}`,\n      `${selector} .blocklyReplaceable .blocklyPathLight,`,\n      `${selector} .blocklyReplaceable .blocklyPathDark {`,\n        `display: none;`,\n      `}`,\n\n      // Insertion marker.\n      `${selector} .blocklyInsertionMarker>.blocklyPath {`,\n        `fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,\n        `stroke: none;`,\n      `}`,\n    ];\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The class representing an AST node.\n * Used to traverse the Blockly AST.\n *\n * @class\n */\n// Former goog.module ID: Blockly.ASTNode\n\nimport type {Block} from '../block.js';\nimport type {Connection} from '../connection.js';\nimport {ConnectionType} from '../connection_type.js';\nimport type {Field} from '../field.js';\nimport type {Input} from '../inputs/input.js';\nimport type {IASTNodeLocation} from '../interfaces/i_ast_node_location.js';\nimport type {IASTNodeLocationWithBlock} from '../interfaces/i_ast_node_location_with_block.js';\nimport {Coordinate} from '../utils/coordinate.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Class for an AST node.\n * It is recommended that you use one of the createNode methods instead of\n * creating a node directly.\n */\nexport class ASTNode {\n  /**\n   * True to navigate to all fields. False to only navigate to clickable fields.\n   */\n  static NAVIGATE_ALL_FIELDS = false;\n\n  /**\n   * The default y offset to use when moving the cursor from a stack to the\n   * workspace.\n   */\n  private static readonly DEFAULT_OFFSET_Y: number = -20;\n  private readonly type: string;\n  private readonly isConnectionLocation: boolean;\n  private readonly location: IASTNodeLocation;\n\n  /** The coordinate on the workspace. */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'Coordinate'.\n  private wsCoordinate: Coordinate = null as AnyDuringMigration;\n\n  /**\n   * @param type The type of the location.\n   *     Must be in ASTNode.types.\n   * @param location The position in the AST.\n   * @param opt_params Optional dictionary of options.\n   */\n  constructor(type: string, location: IASTNodeLocation, opt_params?: Params) {\n    if (!location) {\n      throw Error('Cannot create a node without a location.');\n    }\n\n    /**\n     * The type of the location.\n     * One of ASTNode.types\n     */\n    this.type = type;\n\n    /** Whether the location points to a connection. */\n    this.isConnectionLocation = ASTNode.isConnectionType(type);\n\n    /** The location of the AST node. */\n    this.location = location;\n\n    this.processParams(opt_params || null);\n  }\n\n  /**\n   * Parse the optional parameters.\n   *\n   * @param params The user specified parameters.\n   */\n  private processParams(params: Params | null) {\n    if (!params) {\n      return;\n    }\n    if (params.wsCoordinate) {\n      this.wsCoordinate = params.wsCoordinate;\n    }\n  }\n\n  /**\n   * Gets the value pointed to by this node.\n   * It is the callers responsibility to check the node type to figure out what\n   * type of object they get back from this.\n   *\n   * @returns The current field, connection, workspace, or block the cursor is\n   *     on.\n   */\n  getLocation(): IASTNodeLocation {\n    return this.location;\n  }\n\n  /**\n   * The type of the current location.\n   * One of ASTNode.types\n   *\n   * @returns The type of the location.\n   */\n  getType(): string {\n    return this.type;\n  }\n\n  /**\n   * The coordinate on the workspace.\n   *\n   * @returns The workspace coordinate or null if the location is not a\n   *     workspace.\n   */\n  getWsCoordinate(): Coordinate {\n    return this.wsCoordinate;\n  }\n\n  /**\n   * Whether the node points to a connection.\n   *\n   * @returns [description]\n   * @internal\n   */\n  isConnection(): boolean {\n    return this.isConnectionLocation;\n  }\n\n  /**\n   * Given an input find the next editable field or an input with a non null\n   * connection in the same block. The current location must be an input\n   * connection.\n   *\n   * @returns The AST node holding the next field or connection or null if there\n   *     is no editable field or input connection after the given input.\n   */\n  private findNextForInput(): ASTNode | null {\n    const location = this.location as Connection;\n    const parentInput = location.getParentInput();\n    const block = parentInput!.getSourceBlock();\n    // AnyDuringMigration because:  Argument of type 'Input | null' is not\n    // assignable to parameter of type 'Input'.\n    const curIdx = block!.inputList.indexOf(parentInput as AnyDuringMigration);\n    for (let i = curIdx + 1; i < block!.inputList.length; i++) {\n      const input = block!.inputList[i];\n      const fieldRow = input.fieldRow;\n      for (let j = 0; j < fieldRow.length; j++) {\n        const field = fieldRow[j];\n        if (field.isClickable() || ASTNode.NAVIGATE_ALL_FIELDS) {\n          return ASTNode.createFieldNode(field);\n        }\n      }\n      if (input.connection) {\n        return ASTNode.createInputNode(input);\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Given a field find the next editable field or an input with a non null\n   * connection in the same block. The current location must be a field.\n   *\n   * @returns The AST node pointing to the next field or connection or null if\n   *     there is no editable field or input connection after the given input.\n   */\n  private findNextForField(): ASTNode | null {\n    const location = this.location as Field;\n    const input = location.getParentInput();\n    const block = location.getSourceBlock();\n    if (!block) {\n      throw new Error(\n        'The current AST location is not associated with a block',\n      );\n    }\n    const curIdx = block.inputList.indexOf(input);\n    let fieldIdx = input.fieldRow.indexOf(location) + 1;\n    for (let i = curIdx; i < block.inputList.length; i++) {\n      const newInput = block.inputList[i];\n      const fieldRow = newInput.fieldRow;\n      while (fieldIdx < fieldRow.length) {\n        if (fieldRow[fieldIdx].isClickable() || ASTNode.NAVIGATE_ALL_FIELDS) {\n          return ASTNode.createFieldNode(fieldRow[fieldIdx]);\n        }\n        fieldIdx++;\n      }\n      fieldIdx = 0;\n      if (newInput.connection) {\n        return ASTNode.createInputNode(newInput);\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Given an input find the previous editable field or an input with a non null\n   * connection in the same block. The current location must be an input\n   * connection.\n   *\n   * @returns The AST node holding the previous field or connection.\n   */\n  private findPrevForInput(): ASTNode | null {\n    const location = this.location as Connection;\n    const parentInput = location.getParentInput();\n    const block = parentInput!.getSourceBlock();\n    // AnyDuringMigration because:  Argument of type 'Input | null' is not\n    // assignable to parameter of type 'Input'.\n    const curIdx = block!.inputList.indexOf(parentInput as AnyDuringMigration);\n    for (let i = curIdx; i >= 0; i--) {\n      const input = block!.inputList[i];\n      if (input.connection && input !== parentInput) {\n        return ASTNode.createInputNode(input);\n      }\n      const fieldRow = input.fieldRow;\n      for (let j = fieldRow.length - 1; j >= 0; j--) {\n        const field = fieldRow[j];\n        if (field.isClickable() || ASTNode.NAVIGATE_ALL_FIELDS) {\n          return ASTNode.createFieldNode(field);\n        }\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Given a field find the previous editable field or an input with a non null\n   * connection in the same block. The current location must be a field.\n   *\n   * @returns The AST node holding the previous input or field.\n   */\n  private findPrevForField(): ASTNode | null {\n    const location = this.location as Field;\n    const parentInput = location.getParentInput();\n    const block = location.getSourceBlock();\n    if (!block) {\n      throw new Error(\n        'The current AST location is not associated with a block',\n      );\n    }\n    const curIdx = block.inputList.indexOf(parentInput);\n    let fieldIdx = parentInput.fieldRow.indexOf(location) - 1;\n    for (let i = curIdx; i >= 0; i--) {\n      const input = block.inputList[i];\n      if (input.connection && input !== parentInput) {\n        return ASTNode.createInputNode(input);\n      }\n      const fieldRow = input.fieldRow;\n      while (fieldIdx > -1) {\n        if (fieldRow[fieldIdx].isClickable() || ASTNode.NAVIGATE_ALL_FIELDS) {\n          return ASTNode.createFieldNode(fieldRow[fieldIdx]);\n        }\n        fieldIdx--;\n      }\n      // Reset the fieldIdx to the length of the field row of the previous\n      // input.\n      if (i - 1 >= 0) {\n        fieldIdx = block.inputList[i - 1].fieldRow.length - 1;\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Navigate between stacks of blocks on the workspace.\n   *\n   * @param forward True to go forward. False to go backwards.\n   * @returns The first block of the next stack or null if there are no blocks\n   *     on the workspace.\n   */\n  private navigateBetweenStacks(forward: boolean): ASTNode | null {\n    let curLocation = this.getLocation();\n    // TODO(#6097): Use instanceof checks to exit early for values of\n    // curLocation that don't make sense.\n    if ((curLocation as IASTNodeLocationWithBlock).getSourceBlock) {\n      const block = (curLocation as IASTNodeLocationWithBlock).getSourceBlock();\n      if (block) {\n        curLocation = block;\n      }\n    }\n    // TODO(#6097): Use instanceof checks to exit early for values of\n    // curLocation that don't make sense.\n    const curLocationAsBlock = curLocation as Block;\n    if (!curLocationAsBlock || curLocationAsBlock.isDeadOrDying()) {\n      return null;\n    }\n    const curRoot = curLocationAsBlock.getRootBlock();\n    const topBlocks = curRoot.workspace.getTopBlocks(true);\n    for (let i = 0; i < topBlocks.length; i++) {\n      const topBlock = topBlocks[i];\n      if (curRoot.id === topBlock.id) {\n        const offset = forward ? 1 : -1;\n        const resultIndex = i + offset;\n        if (resultIndex === -1 || resultIndex === topBlocks.length) {\n          return null;\n        }\n        return ASTNode.createStackNode(topBlocks[resultIndex]);\n      }\n    }\n    throw Error(\n      \"Couldn't find \" + (forward ? 'next' : 'previous') + ' stack?!',\n    );\n  }\n\n  /**\n   * Finds the top most AST node for a given block.\n   * This is either the previous connection, output connection or block\n   * depending on what kind of connections the block has.\n   *\n   * @param block The block that we want to find the top connection on.\n   * @returns The AST node containing the top connection.\n   */\n  private findTopASTNodeForBlock(block: Block): ASTNode | null {\n    const topConnection = getParentConnection(block);\n    if (topConnection) {\n      return ASTNode.createConnectionNode(topConnection);\n    } else {\n      return ASTNode.createBlockNode(block);\n    }\n  }\n\n  /**\n   * Get the AST node pointing to the input that the block is nested under or if\n   * the block is not nested then get the stack AST node.\n   *\n   * @param block The source block of the current location.\n   * @returns The AST node pointing to the input connection or the top block of\n   *     the stack this block is in.\n   */\n  private getOutAstNodeForBlock(block: Block): ASTNode | null {\n    if (!block) {\n      return null;\n    }\n    // If the block doesn't have a previous connection then it is the top of the\n    // substack.\n    const topBlock = block.getTopStackBlock();\n    const topConnection = getParentConnection(topBlock);\n    // If the top connection has a parentInput, create an AST node pointing to\n    // that input.\n    if (\n      topConnection &&\n      topConnection.targetConnection &&\n      topConnection.targetConnection.getParentInput()\n    ) {\n      // AnyDuringMigration because:  Argument of type 'Input | null' is not\n      // assignable to parameter of type 'Input'.\n      return ASTNode.createInputNode(\n        topConnection.targetConnection.getParentInput() as AnyDuringMigration,\n      );\n    } else {\n      // Go to stack level if you are not underneath an input.\n      return ASTNode.createStackNode(topBlock);\n    }\n  }\n\n  /**\n   * Find the first editable field or input with a connection on a given block.\n   *\n   * @param block The source block of the current location.\n   * @returns An AST node pointing to the first field or input.\n   * Null if there are no editable fields or inputs with connections on the\n   * block.\n   */\n  private findFirstFieldOrInput(block: Block): ASTNode | null {\n    const inputs = block.inputList;\n    for (let i = 0; i < inputs.length; i++) {\n      const input = inputs[i];\n      const fieldRow = input.fieldRow;\n      for (let j = 0; j < fieldRow.length; j++) {\n        const field = fieldRow[j];\n        if (field.isClickable() || ASTNode.NAVIGATE_ALL_FIELDS) {\n          return ASTNode.createFieldNode(field);\n        }\n      }\n      if (input.connection) {\n        return ASTNode.createInputNode(input);\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Finds the source block of the location of this node.\n   *\n   * @returns The source block of the location, or null if the node is of type\n   *     workspace.\n   */\n  getSourceBlock(): Block | null {\n    if (this.getType() === ASTNode.types.BLOCK) {\n      return this.getLocation() as Block;\n    } else if (this.getType() === ASTNode.types.STACK) {\n      return this.getLocation() as Block;\n    } else if (this.getType() === ASTNode.types.WORKSPACE) {\n      return null;\n    } else {\n      return (this.getLocation() as IASTNodeLocationWithBlock).getSourceBlock();\n    }\n  }\n\n  /**\n   * Find the element to the right of the current element in the AST.\n   *\n   * @returns An AST node that wraps the next field, connection, block, or\n   *     workspace. Or null if there is no node to the right.\n   */\n  next(): ASTNode | null {\n    switch (this.type) {\n      case ASTNode.types.STACK:\n        return this.navigateBetweenStacks(true);\n\n      case ASTNode.types.OUTPUT: {\n        const connection = this.location as Connection;\n        return ASTNode.createBlockNode(connection.getSourceBlock());\n      }\n      case ASTNode.types.FIELD:\n        return this.findNextForField();\n\n      case ASTNode.types.INPUT:\n        return this.findNextForInput();\n\n      case ASTNode.types.BLOCK: {\n        const block = this.location as Block;\n        const nextConnection = block.nextConnection;\n        if (!nextConnection) return null;\n        return ASTNode.createConnectionNode(nextConnection);\n      }\n      case ASTNode.types.PREVIOUS: {\n        const connection = this.location as Connection;\n        return ASTNode.createBlockNode(connection.getSourceBlock());\n      }\n      case ASTNode.types.NEXT: {\n        const connection = this.location as Connection;\n        const targetConnection = connection.targetConnection;\n        return ASTNode.createConnectionNode(targetConnection!);\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * Find the element one level below and all the way to the left of the current\n   * location.\n   *\n   * @returns An AST node that wraps the next field, connection, workspace, or\n   *     block. Or null if there is nothing below this node.\n   */\n  in(): ASTNode | null {\n    switch (this.type) {\n      case ASTNode.types.WORKSPACE: {\n        const workspace = this.location as Workspace;\n        const topBlocks = workspace.getTopBlocks(true);\n        if (topBlocks.length > 0) {\n          return ASTNode.createStackNode(topBlocks[0]);\n        }\n        break;\n      }\n      case ASTNode.types.STACK: {\n        const block = this.location as Block;\n        return this.findTopASTNodeForBlock(block);\n      }\n      case ASTNode.types.BLOCK: {\n        const block = this.location as Block;\n        return this.findFirstFieldOrInput(block);\n      }\n      case ASTNode.types.INPUT: {\n        const connection = this.location as Connection;\n        const targetConnection = connection.targetConnection;\n        return ASTNode.createConnectionNode(targetConnection!);\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * Find the element to the left of the current element in the AST.\n   *\n   * @returns An AST node that wraps the previous field, connection, workspace\n   *     or block. Or null if no node exists to the left. null.\n   */\n  prev(): ASTNode | null {\n    switch (this.type) {\n      case ASTNode.types.STACK:\n        return this.navigateBetweenStacks(false);\n\n      case ASTNode.types.OUTPUT:\n        return null;\n\n      case ASTNode.types.FIELD:\n        return this.findPrevForField();\n\n      case ASTNode.types.INPUT:\n        return this.findPrevForInput();\n\n      case ASTNode.types.BLOCK: {\n        const block = this.location as Block;\n        const topConnection = getParentConnection(block);\n        if (!topConnection) return null;\n        return ASTNode.createConnectionNode(topConnection);\n      }\n      case ASTNode.types.PREVIOUS: {\n        const connection = this.location as Connection;\n        const targetConnection = connection.targetConnection;\n        if (targetConnection && !targetConnection.getParentInput()) {\n          return ASTNode.createConnectionNode(targetConnection);\n        }\n        break;\n      }\n      case ASTNode.types.NEXT: {\n        const connection = this.location as Connection;\n        return ASTNode.createBlockNode(connection.getSourceBlock());\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * Find the next element that is one position above and all the way to the\n   * left of the current location.\n   *\n   * @returns An AST node that wraps the next field, connection, workspace or\n   *     block. Or null if we are at the workspace level.\n   */\n  out(): ASTNode | null {\n    switch (this.type) {\n      case ASTNode.types.STACK: {\n        const block = this.location as Block;\n        const blockPos = block.getRelativeToSurfaceXY();\n        // TODO: Make sure this is in the bounds of the workspace.\n        const wsCoordinate = new Coordinate(\n          blockPos.x,\n          blockPos.y + ASTNode.DEFAULT_OFFSET_Y,\n        );\n        return ASTNode.createWorkspaceNode(block.workspace, wsCoordinate);\n      }\n      case ASTNode.types.OUTPUT: {\n        const connection = this.location as Connection;\n        const target = connection.targetConnection;\n        if (target) {\n          return ASTNode.createConnectionNode(target);\n        }\n        return ASTNode.createStackNode(connection.getSourceBlock());\n      }\n      case ASTNode.types.FIELD: {\n        const field = this.location as Field;\n        const block = field.getSourceBlock();\n        if (!block) {\n          throw new Error(\n            'The current AST location is not associated with a block',\n          );\n        }\n        return ASTNode.createBlockNode(block);\n      }\n      case ASTNode.types.INPUT: {\n        const connection = this.location as Connection;\n        return ASTNode.createBlockNode(connection.getSourceBlock());\n      }\n      case ASTNode.types.BLOCK: {\n        const block = this.location as Block;\n        return this.getOutAstNodeForBlock(block);\n      }\n      case ASTNode.types.PREVIOUS: {\n        const connection = this.location as Connection;\n        return this.getOutAstNodeForBlock(connection.getSourceBlock());\n      }\n      case ASTNode.types.NEXT: {\n        const connection = this.location as Connection;\n        return this.getOutAstNodeForBlock(connection.getSourceBlock());\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * Whether an AST node of the given type points to a connection.\n   *\n   * @param type The type to check.  One of ASTNode.types.\n   * @returns True if a node of the given type points to a connection.\n   */\n  private static isConnectionType(type: string): boolean {\n    switch (type) {\n      case ASTNode.types.PREVIOUS:\n      case ASTNode.types.NEXT:\n      case ASTNode.types.INPUT:\n      case ASTNode.types.OUTPUT:\n        return true;\n    }\n    return false;\n  }\n\n  /**\n   * Create an AST node pointing to a field.\n   *\n   * @param field The location of the AST node.\n   * @returns An AST node pointing to a field.\n   */\n  static createFieldNode(field: Field): ASTNode | null {\n    if (!field) {\n      return null;\n    }\n    return new ASTNode(ASTNode.types.FIELD, field);\n  }\n\n  /**\n   * Creates an AST node pointing to a connection. If the connection has a\n   * parent input then create an AST node of type input that will hold the\n   * connection.\n   *\n   * @param connection This is the connection the node will point to.\n   * @returns An AST node pointing to a connection.\n   */\n  static createConnectionNode(connection: Connection): ASTNode | null {\n    if (!connection) {\n      return null;\n    }\n    const type = connection.type;\n    if (type === ConnectionType.INPUT_VALUE) {\n      // AnyDuringMigration because:  Argument of type 'Input | null' is not\n      // assignable to parameter of type 'Input'.\n      return ASTNode.createInputNode(\n        connection.getParentInput() as AnyDuringMigration,\n      );\n    } else if (\n      type === ConnectionType.NEXT_STATEMENT &&\n      connection.getParentInput()\n    ) {\n      // AnyDuringMigration because:  Argument of type 'Input | null' is not\n      // assignable to parameter of type 'Input'.\n      return ASTNode.createInputNode(\n        connection.getParentInput() as AnyDuringMigration,\n      );\n    } else if (type === ConnectionType.NEXT_STATEMENT) {\n      return new ASTNode(ASTNode.types.NEXT, connection);\n    } else if (type === ConnectionType.OUTPUT_VALUE) {\n      return new ASTNode(ASTNode.types.OUTPUT, connection);\n    } else if (type === ConnectionType.PREVIOUS_STATEMENT) {\n      return new ASTNode(ASTNode.types.PREVIOUS, connection);\n    }\n    return null;\n  }\n\n  /**\n   * Creates an AST node pointing to an input. Stores the input connection as\n   * the location.\n   *\n   * @param input The input used to create an AST node.\n   * @returns An AST node pointing to a input.\n   */\n  static createInputNode(input: Input): ASTNode | null {\n    if (!input || !input.connection) {\n      return null;\n    }\n    return new ASTNode(ASTNode.types.INPUT, input.connection);\n  }\n\n  /**\n   * Creates an AST node pointing to a block.\n   *\n   * @param block The block used to create an AST node.\n   * @returns An AST node pointing to a block.\n   */\n  static createBlockNode(block: Block): ASTNode | null {\n    if (!block) {\n      return null;\n    }\n    return new ASTNode(ASTNode.types.BLOCK, block);\n  }\n\n  /**\n   * Create an AST node of type stack. A stack, represented by its top block, is\n   *     the set of all blocks connected to a top block, including the top\n   * block.\n   *\n   * @param topBlock A top block has no parent and can be found in the list\n   *     returned by workspace.getTopBlocks().\n   * @returns An AST node of type stack that points to the top block on the\n   *     stack.\n   */\n  static createStackNode(topBlock: Block): ASTNode | null {\n    if (!topBlock) {\n      return null;\n    }\n    return new ASTNode(ASTNode.types.STACK, topBlock);\n  }\n\n  /**\n   * Creates an AST node pointing to a workspace.\n   *\n   * @param workspace The workspace that we are on.\n   * @param wsCoordinate The position on the workspace for this node.\n   * @returns An AST node pointing to a workspace and a position on the\n   *     workspace.\n   */\n  static createWorkspaceNode(\n    workspace: Workspace | null,\n    wsCoordinate: Coordinate | null,\n  ): ASTNode | null {\n    if (!wsCoordinate || !workspace) {\n      return null;\n    }\n    const params = {wsCoordinate};\n    return new ASTNode(ASTNode.types.WORKSPACE, workspace, params);\n  }\n\n  /**\n   * Creates an AST node for the top position on a block.\n   * This is either an output connection, previous connection, or block.\n   *\n   * @param block The block to find the top most AST node on.\n   * @returns The AST node holding the top most position on the block.\n   */\n  static createTopNode(block: Block): ASTNode | null {\n    let astNode;\n    const topConnection = getParentConnection(block);\n    if (topConnection) {\n      astNode = ASTNode.createConnectionNode(topConnection);\n    } else {\n      astNode = ASTNode.createBlockNode(block);\n    }\n    return astNode;\n  }\n}\n\nexport namespace ASTNode {\n  export interface Params {\n    wsCoordinate: Coordinate;\n  }\n\n  export enum types {\n    FIELD = 'field',\n    BLOCK = 'block',\n    INPUT = 'input',\n    OUTPUT = 'output',\n    NEXT = 'next',\n    PREVIOUS = 'previous',\n    STACK = 'stack',\n    WORKSPACE = 'workspace',\n  }\n}\n\nexport type Params = ASTNode.Params;\n// No need to export ASTNode.types from the module at this time because (1) it\n// wasn't automatically converted by the automatic migration script, (2) the\n// name doesn't follow the styleguide.\n\n/**\n * Gets the parent connection on a block.\n * This is either an output connection, previous connection or undefined.\n * If both connections exist return the one that is actually connected\n * to another block.\n *\n * @param block The block to find the parent connection on.\n * @returns The connection connecting to the parent of the block.\n */\nfunction getParentConnection(block: Block): Connection | null {\n  let topConnection = block.outputConnection;\n  if (\n    !topConnection ||\n    (block.previousConnection && block.previousConnection.isConnected())\n  ) {\n    topConnection = block.previousConnection;\n  }\n  return topConnection;\n}\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Components for creating connections between blocks.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Connection\n\nimport type {Block} from './block.js';\nimport {ConnectionType} from './connection_type.js';\nimport type {BlockMove} from './events/events_block_move.js';\nimport * as eventUtils from './events/utils.js';\nimport type {Input} from './inputs/input.js';\nimport type {IASTNodeLocationWithBlock} from './interfaces/i_ast_node_location_with_block.js';\nimport type {IConnectionChecker} from './interfaces/i_connection_checker.js';\nimport * as blocks from './serialization/blocks.js';\nimport * as Xml from './xml.js';\n\n/**\n * Class for a connection between blocks.\n */\nexport class Connection implements IASTNodeLocationWithBlock {\n  /** Constants for checking whether two connections are compatible. */\n  static CAN_CONNECT = 0;\n  static REASON_SELF_CONNECTION = 1;\n  static REASON_WRONG_TYPE = 2;\n  static REASON_TARGET_NULL = 3;\n  static REASON_CHECKS_FAILED = 4;\n  static REASON_DIFFERENT_WORKSPACES = 5;\n  static REASON_SHADOW_PARENT = 6;\n  static REASON_DRAG_CHECKS_FAILED = 7;\n  static REASON_PREVIOUS_AND_OUTPUT = 8;\n\n  protected sourceBlock_: Block;\n\n  /** Connection this connection connects to.  Null if not connected. */\n  targetConnection: Connection | null = null;\n\n  /**\n   * Has this connection been disposed of?\n   *\n   * @internal\n   */\n  disposed = false;\n\n  /** List of compatible value types.  Null if all types are compatible. */\n  private check: string[] | null = null;\n\n  /** DOM representation of a shadow block, or null if none. */\n  private shadowDom: Element | null = null;\n\n  /**\n   * Horizontal location of this connection.\n   *\n   * @internal\n   */\n  x = 0;\n\n  /**\n   * Vertical location of this connection.\n   *\n   * @internal\n   */\n  y = 0;\n\n  private shadowState: blocks.State | null = null;\n\n  /**\n   * @param source The block establishing this connection.\n   * @param type The type of the connection.\n   */\n  constructor(\n    source: Block,\n    public type: number,\n  ) {\n    this.sourceBlock_ = source;\n  }\n\n  /**\n   * Connect two connections together.  This is the connection on the superior\n   * block.\n   *\n   * @param childConnection Connection on inferior block.\n   */\n  protected connect_(childConnection: Connection) {\n    const INPUT = ConnectionType.INPUT_VALUE;\n    const parentBlock = this.getSourceBlock();\n    const childBlock = childConnection.getSourceBlock();\n\n    // Make sure the childConnection is available.\n    if (childConnection.isConnected()) {\n      childConnection.disconnectInternal(false);\n    }\n\n    // Make sure the parentConnection is available.\n    let orphan;\n    if (this.isConnected()) {\n      const shadowState = this.stashShadowState();\n      const target = this.targetBlock();\n      if (target!.isShadow()) {\n        target!.dispose(false);\n      } else {\n        this.disconnectInternal();\n        orphan = target;\n      }\n      this.applyShadowState(shadowState);\n    }\n\n    // Connect the new connection to the parent.\n    let event;\n    if (eventUtils.isEnabled()) {\n      event = new (eventUtils.get(eventUtils.BLOCK_MOVE))(\n        childBlock,\n      ) as BlockMove;\n      event.setReason(['connect']);\n    }\n    connectReciprocally(this, childConnection);\n    childBlock.setParent(parentBlock);\n    if (event) {\n      event.recordNew();\n      eventUtils.fire(event);\n    }\n\n    // Deal with the orphan if it exists.\n    if (orphan) {\n      const orphanConnection =\n        this.type === INPUT\n          ? orphan.outputConnection\n          : orphan.previousConnection;\n      if (!orphanConnection) return;\n      const connection = Connection.getConnectionForOrphanedConnection(\n        childBlock,\n        orphanConnection,\n      );\n      if (connection) {\n        orphanConnection.connect(connection);\n      } else {\n        orphanConnection.onFailedConnect(this);\n      }\n    }\n  }\n\n  /**\n   * Dispose of this connection and deal with connected blocks.\n   *\n   * @internal\n   */\n  dispose() {\n    // isConnected returns true for shadows and non-shadows.\n    if (this.isConnected()) {\n      // Destroy the attached shadow block & its children (if it exists).\n      this.setShadowStateInternal();\n\n      const targetBlock = this.targetBlock();\n      if (targetBlock && !targetBlock.isDeadOrDying()) {\n        // Disconnect the attached normal block.\n        targetBlock.unplug();\n      }\n    }\n\n    this.disposed = true;\n  }\n\n  /**\n   * Get the source block for this connection.\n   *\n   * @returns The source block.\n   */\n  getSourceBlock(): Block {\n    return this.sourceBlock_;\n  }\n\n  /**\n   * Does the connection belong to a superior block (higher in the source\n   * stack)?\n   *\n   * @returns True if connection faces down or right.\n   */\n  isSuperior(): boolean {\n    return (\n      this.type === ConnectionType.INPUT_VALUE ||\n      this.type === ConnectionType.NEXT_STATEMENT\n    );\n  }\n\n  /**\n   * Is the connection connected?\n   *\n   * @returns True if connection is connected to another connection.\n   */\n  isConnected(): boolean {\n    return !!this.targetConnection;\n  }\n\n  /**\n   * Get the workspace's connection type checker object.\n   *\n   * @returns The connection type checker for the source block's workspace.\n   * @internal\n   */\n  getConnectionChecker(): IConnectionChecker {\n    return this.sourceBlock_.workspace.connectionChecker;\n  }\n\n  /**\n   * Called when an attempted connection fails. NOP by default (i.e. for\n   * headless workspaces).\n   *\n   * @param _otherConnection Connection that this connection failed to connect\n   *     to.\n   * @internal\n   */\n  onFailedConnect(_otherConnection: Connection) {}\n  // NOP\n\n  /**\n   * Connect this connection to another connection.\n   *\n   * @param otherConnection Connection to connect to.\n   * @returns Whether the the blocks are now connected or not.\n   */\n  connect(otherConnection: Connection): boolean {\n    if (this.targetConnection === otherConnection) {\n      // Already connected together.  NOP.\n      return true;\n    }\n\n    const checker = this.getConnectionChecker();\n    if (checker.canConnect(this, otherConnection, false)) {\n      const existingGroup = eventUtils.getGroup();\n      if (!existingGroup) {\n        eventUtils.setGroup(true);\n      }\n      // Determine which block is superior (higher in the source stack).\n      if (this.isSuperior()) {\n        // Superior block.\n        this.connect_(otherConnection);\n      } else {\n        // Inferior block.\n        otherConnection.connect_(this);\n      }\n      eventUtils.setGroup(existingGroup);\n    }\n\n    return this.isConnected();\n  }\n\n  /**\n   * Disconnect this connection.\n   */\n  disconnect() {\n    this.disconnectInternal();\n  }\n\n  /**\n   * Disconnect two blocks that are connected by this connection.\n   *\n   * @param setParent Whether to set the parent of the disconnected block or\n   *     not, defaults to true.\n   *     If you do not set the parent, ensure that a subsequent action does,\n   *     otherwise the view and model will be out of sync.\n   */\n  protected disconnectInternal(setParent = true) {\n    const {parentConnection, childConnection} =\n      this.getParentAndChildConnections();\n    if (!parentConnection || !childConnection) {\n      throw Error('Source connection not connected.');\n    }\n\n    const existingGroup = eventUtils.getGroup();\n    if (!existingGroup) {\n      eventUtils.setGroup(true);\n    }\n\n    let event;\n    if (eventUtils.isEnabled()) {\n      event = new (eventUtils.get(eventUtils.BLOCK_MOVE))(\n        childConnection.getSourceBlock(),\n      ) as BlockMove;\n      event.setReason(['disconnect']);\n    }\n    const otherConnection = this.targetConnection;\n    if (otherConnection) {\n      otherConnection.targetConnection = null;\n    }\n    this.targetConnection = null;\n    if (setParent) childConnection.getSourceBlock().setParent(null);\n    if (event) {\n      event.recordNew();\n      eventUtils.fire(event);\n    }\n\n    if (!childConnection.getSourceBlock().isShadow()) {\n      // If we were disconnecting a shadow, no need to spawn a new one.\n      parentConnection.respawnShadow_();\n    }\n\n    eventUtils.setGroup(existingGroup);\n  }\n\n  /**\n   * Returns the parent connection (superior) and child connection (inferior)\n   * given this connection and the connection it is connected to.\n   *\n   * @returns The parent connection and child connection, given this connection\n   *     and the connection it is connected to.\n   */\n  protected getParentAndChildConnections(): {\n    parentConnection?: Connection;\n    childConnection?: Connection;\n  } {\n    if (!this.targetConnection) return {};\n    if (this.isSuperior()) {\n      return {\n        parentConnection: this,\n        childConnection: this.targetConnection,\n      };\n    }\n    return {\n      parentConnection: this.targetConnection,\n      childConnection: this,\n    };\n  }\n\n  /**\n   * Respawn the shadow block if there was one connected to the this connection.\n   */\n  protected respawnShadow_() {\n    // Have to keep respawnShadow_ for backwards compatibility.\n    this.createShadowBlock(true);\n  }\n\n  /**\n   * Reconnects this connection to the input with the given name on the given\n   * block. If there is already a connection connected to that input, that\n   * connection is disconnected.\n   *\n   * @param block The block to connect this connection to.\n   * @param inputName The name of the input to connect this connection to.\n   * @returns True if this connection was able to connect, false otherwise.\n   */\n  reconnect(block: Block, inputName: string): boolean {\n    // No need to reconnect if this connection's block is deleted.\n    if (this.getSourceBlock().isDeadOrDying()) return false;\n\n    const connectionParent = block.getInput(inputName)?.connection;\n    const currentParent = this.targetBlock();\n    if (\n      (!currentParent || currentParent === block) &&\n      connectionParent &&\n      connectionParent.targetConnection !== this\n    ) {\n      if (connectionParent.isConnected()) {\n        // There's already something connected here.  Get rid of it.\n        connectionParent.disconnect();\n      }\n      connectionParent.connect(this);\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Returns the block that this connection connects to.\n   *\n   * @returns The connected block or null if none is connected.\n   */\n  targetBlock(): Block | null {\n    if (this.isConnected()) {\n      return this.targetConnection?.getSourceBlock() ?? null;\n    }\n    return null;\n  }\n\n  /**\n   * Function to be called when this connection's compatible types have changed.\n   */\n  protected onCheckChanged_() {\n    // The new value type may not be compatible with the existing connection.\n    if (\n      this.isConnected() &&\n      (!this.targetConnection ||\n        !this.getConnectionChecker().canConnect(\n          this,\n          this.targetConnection,\n          false,\n        ))\n    ) {\n      const child = this.isSuperior() ? this.targetBlock() : this.sourceBlock_;\n      child!.unplug();\n    }\n  }\n\n  /**\n   * Change a connection's compatibility.\n   *\n   * @param check Compatible value type or list of value types. Null if all\n   *     types are compatible.\n   * @returns The connection being modified (to allow chaining).\n   */\n  setCheck(check: string | string[] | null): Connection {\n    if (check) {\n      if (!Array.isArray(check)) {\n        check = [check];\n      }\n      this.check = check;\n      this.onCheckChanged_();\n    } else {\n      this.check = null;\n    }\n    return this;\n  }\n\n  /**\n   * Get a connection's compatibility.\n   *\n   * @returns List of compatible value types.\n   *     Null if all types are compatible.\n   */\n  getCheck(): string[] | null {\n    return this.check;\n  }\n\n  /**\n   * Changes the connection's shadow block.\n   *\n   * @param shadowDom DOM representation of a block or null.\n   */\n  setShadowDom(shadowDom: Element | null) {\n    this.setShadowStateInternal({shadowDom});\n  }\n\n  /**\n   * Returns the xml representation of the connection's shadow block.\n   *\n   * @param returnCurrent If true, and the shadow block is currently attached to\n   *     this connection, this serializes the state of that block and returns it\n   *     (so that field values are correct). Otherwise the saved shadowDom is\n   *     just returned.\n   * @returns Shadow DOM representation of a block or null.\n   */\n  getShadowDom(returnCurrent?: boolean): Element | null {\n    return returnCurrent && this.targetBlock()!.isShadow()\n      ? (Xml.blockToDom(this.targetBlock() as Block) as Element)\n      : this.shadowDom;\n  }\n\n  /**\n   * Changes the connection's shadow block.\n   *\n   * @param shadowState An state represetation of the block or null.\n   */\n  setShadowState(shadowState: blocks.State | null) {\n    this.setShadowStateInternal({shadowState});\n  }\n\n  /**\n   * Returns the serialized object representation of the connection's shadow\n   * block.\n   *\n   * @param returnCurrent If true, and the shadow block is currently attached to\n   *     this connection, this serializes the state of that block and returns it\n   *     (so that field values are correct). Otherwise the saved state is just\n   *     returned.\n   * @returns Serialized object representation of the block, or null.\n   */\n  getShadowState(returnCurrent?: boolean): blocks.State | null {\n    if (returnCurrent && this.targetBlock() && this.targetBlock()!.isShadow()) {\n      return blocks.save(this.targetBlock() as Block);\n    }\n    return this.shadowState;\n  }\n\n  /**\n   * Find all nearby compatible connections to this connection.\n   * Type checking does not apply, since this function is used for bumping.\n   *\n   * Headless configurations (the default) do not have neighboring connection,\n   * and always return an empty list (the default).\n   * {@link RenderedConnection#neighbours} overrides this behavior with a list\n   * computed from the rendered positioning.\n   *\n   * @param _maxLimit The maximum radius to another connection.\n   * @returns List of connections.\n   * @internal\n   */\n  neighbours(_maxLimit: number): Connection[] {\n    return [];\n  }\n\n  /**\n   * Get the parent input of a connection.\n   *\n   * @returns The input that the connection belongs to or null if no parent\n   *     exists.\n   * @internal\n   */\n  getParentInput(): Input | null {\n    let parentInput = null;\n    const inputs = this.sourceBlock_.inputList;\n    for (let i = 0; i < inputs.length; i++) {\n      if (inputs[i].connection === this) {\n        parentInput = inputs[i];\n        break;\n      }\n    }\n    return parentInput;\n  }\n\n  /**\n   * This method returns a string describing this Connection in developer terms\n   * (English only). Intended to on be used in console logs and errors.\n   *\n   * @returns The description.\n   */\n  toString(): string {\n    const block = this.sourceBlock_;\n    if (!block) {\n      return 'Orphan Connection';\n    }\n    let msg;\n    if (block.outputConnection === this) {\n      msg = 'Output Connection of ';\n    } else if (block.previousConnection === this) {\n      msg = 'Previous Connection of ';\n    } else if (block.nextConnection === this) {\n      msg = 'Next Connection of ';\n    } else {\n      let parentInput = null;\n      for (let i = 0, input; (input = block.inputList[i]); i++) {\n        if (input.connection === this) {\n          parentInput = input;\n          break;\n        }\n      }\n      if (parentInput) {\n        msg = 'Input \"' + parentInput.name + '\" connection on ';\n      } else {\n        console.warn('Connection not actually connected to sourceBlock_');\n        return 'Orphan Connection';\n      }\n    }\n    return msg + block.toDevString();\n  }\n\n  /**\n   * Returns the state of the shadowDom_ and shadowState_ properties, then\n   * temporarily sets those properties to null so no shadow respawns.\n   *\n   * @returns The state of both the shadowDom_ and shadowState_ properties.\n   */\n  private stashShadowState(): {\n    shadowDom: Element | null;\n    shadowState: blocks.State | null;\n  } {\n    const shadowDom = this.getShadowDom(true);\n    const shadowState = this.getShadowState(true);\n    // Set to null so it doesn't respawn.\n    this.shadowDom = null;\n    this.shadowState = null;\n    return {shadowDom, shadowState};\n  }\n\n  /**\n   * Reapplies the stashed state of the shadowDom_ and shadowState_ properties.\n   *\n   * @param param0 The state to reapply to the shadowDom_ and shadowState_\n   *     properties.\n   */\n  private applyShadowState({\n    shadowDom,\n    shadowState,\n  }: {\n    shadowDom: Element | null;\n    shadowState: blocks.State | null;\n  }) {\n    this.shadowDom = shadowDom;\n    this.shadowState = shadowState;\n  }\n\n  /**\n   * Sets the state of the shadow of this connection.\n   *\n   * @param param0 The state to set the shadow of this connection to.\n   */\n  private setShadowStateInternal({\n    shadowDom = null,\n    shadowState = null,\n  }: {\n    shadowDom?: Element | null;\n    shadowState?: blocks.State | null;\n  } = {}) {\n    // One or both of these should always be null.\n    // If neither is null, the shadowState will get priority.\n    this.shadowDom = shadowDom;\n    this.shadowState = shadowState;\n\n    const target = this.targetBlock();\n    if (!target) {\n      this.respawnShadow_();\n      if (this.targetBlock() && this.targetBlock()!.isShadow()) {\n        this.serializeShadow(this.targetBlock());\n      }\n    } else if (target.isShadow()) {\n      target.dispose(false);\n      if (this.getSourceBlock().isDeadOrDying()) return;\n      this.respawnShadow_();\n      if (this.targetBlock() && this.targetBlock()!.isShadow()) {\n        this.serializeShadow(this.targetBlock());\n      }\n    } else {\n      const shadow = this.createShadowBlock(false);\n      this.serializeShadow(shadow);\n      if (shadow) {\n        shadow.dispose(false);\n      }\n    }\n  }\n\n  /**\n   * Creates a shadow block based on the current shadowState_ or shadowDom_.\n   * shadowState_ gets priority.\n   *\n   * @param attemptToConnect Whether to try to connect the shadow block to this\n   *     connection or not.\n   * @returns The shadow block that was created, or null if both the\n   *     shadowState_ and shadowDom_ are null.\n   */\n  private createShadowBlock(attemptToConnect: boolean): Block | null {\n    const parentBlock = this.getSourceBlock();\n    const shadowState = this.getShadowState();\n    const shadowDom = this.getShadowDom();\n    if (parentBlock.isDeadOrDying() || (!shadowState && !shadowDom)) {\n      return null;\n    }\n\n    let blockShadow;\n    if (shadowState) {\n      blockShadow = blocks.appendInternal(shadowState, parentBlock.workspace, {\n        parentConnection: attemptToConnect ? this : undefined,\n        isShadow: true,\n        recordUndo: false,\n      });\n      return blockShadow;\n    }\n\n    if (shadowDom) {\n      blockShadow = Xml.domToBlockInternal(shadowDom, parentBlock.workspace);\n      if (attemptToConnect) {\n        if (this.type === ConnectionType.INPUT_VALUE) {\n          if (!blockShadow.outputConnection) {\n            throw new Error('Shadow block is missing an output connection');\n          }\n          if (!this.connect(blockShadow.outputConnection)) {\n            throw new Error('Could not connect shadow block to connection');\n          }\n        } else if (this.type === ConnectionType.NEXT_STATEMENT) {\n          if (!blockShadow.previousConnection) {\n            throw new Error('Shadow block is missing previous connection');\n          }\n          if (!this.connect(blockShadow.previousConnection)) {\n            throw new Error('Could not connect shadow block to connection');\n          }\n        } else {\n          throw new Error(\n            'Cannot connect a shadow block to a previous/output connection',\n          );\n        }\n      }\n      return blockShadow;\n    }\n    return null;\n  }\n\n  /**\n   * Saves the given shadow block to both the shadowDom_ and shadowState_\n   * properties, in their respective serialized forms.\n   *\n   * @param shadow The shadow to serialize, or null.\n   */\n  private serializeShadow(shadow: Block | null) {\n    if (!shadow) {\n      return;\n    }\n    this.shadowDom = Xml.blockToDom(shadow) as Element;\n    this.shadowState = blocks.save(shadow);\n  }\n\n  /**\n   * Returns the connection (starting at the startBlock) which will accept\n   * the given connection. This includes compatible connection types and\n   * connection checks.\n   *\n   * @param startBlock The block on which to start the search.\n   * @param orphanConnection The connection that is looking for a home.\n   * @returns The suitable connection point on the chain of blocks, or null.\n   */\n  static getConnectionForOrphanedConnection(\n    startBlock: Block,\n    orphanConnection: Connection,\n  ): Connection | null {\n    if (orphanConnection.type === ConnectionType.OUTPUT_VALUE) {\n      return getConnectionForOrphanedOutput(\n        startBlock,\n        orphanConnection.getSourceBlock(),\n      );\n    }\n    // Otherwise we're dealing with a stack.\n    const connection = startBlock.lastConnectionInStack(true);\n    const checker = orphanConnection.getConnectionChecker();\n    if (connection && checker.canConnect(orphanConnection, connection, false)) {\n      return connection;\n    }\n    return null;\n  }\n}\n\n/**\n * Update two connections to target each other.\n *\n * @param first The first connection to update.\n * @param second The second connection to update.\n */\nfunction connectReciprocally(first: Connection, second: Connection) {\n  if (!first || !second) {\n    throw Error('Cannot connect null connections.');\n  }\n  first.targetConnection = second;\n  second.targetConnection = first;\n}\n/**\n * Returns the single connection on the block that will accept the orphaned\n * block, if one can be found. If the block has multiple compatible connections\n * (even if they are filled) this returns null. If the block has no compatible\n * connections, this returns null.\n *\n * @param block The superior block.\n * @param orphanBlock The inferior block.\n * @returns The suitable connection point on 'block', or null.\n */\nfunction getSingleConnection(\n  block: Block,\n  orphanBlock: Block,\n): Connection | null {\n  let foundConnection = null;\n  const output = orphanBlock.outputConnection;\n  const typeChecker = output?.getConnectionChecker();\n\n  for (let i = 0, input; (input = block.inputList[i]); i++) {\n    const connection = input.connection;\n    if (connection && typeChecker?.canConnect(output, connection, false)) {\n      if (foundConnection) {\n        return null; // More than one connection.\n      }\n      foundConnection = connection;\n    }\n  }\n  return foundConnection;\n}\n\n/**\n * Walks down a row a blocks, at each stage checking if there are any\n * connections that will accept the orphaned block.  If at any point there\n * are zero or multiple eligible connections, returns null.  Otherwise\n * returns the only input on the last block in the chain.\n * Terminates early for shadow blocks.\n *\n * @param startBlock The block on which to start the search.\n * @param orphanBlock The block that is looking for a home.\n * @returns The suitable connection point on the chain of blocks, or null.\n */\nfunction getConnectionForOrphanedOutput(\n  startBlock: Block,\n  orphanBlock: Block,\n): Connection | null {\n  let newBlock: Block | null = startBlock;\n  let connection;\n  while ((connection = getSingleConnection(newBlock, orphanBlock))) {\n    newBlock = connection.targetBlock();\n    if (!newBlock || newBlock.isShadow()) {\n      return connection;\n    }\n  }\n  return null;\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering\n\nimport * as registry from '../../registry.js';\nimport type {Theme} from '../../theme.js';\nimport {Measurable} from '../measurables/base.js';\nimport {BottomRow} from '../measurables/bottom_row.js';\nimport {Connection} from '../measurables/connection.js';\nimport {ExternalValueInput} from '../measurables/external_value_input.js';\nimport {Field} from '../measurables/field.js';\nimport {Hat} from '../measurables/hat.js';\nimport {Icon} from '../measurables/icon.js';\nimport {InRowSpacer} from '../measurables/in_row_spacer.js';\nimport {InlineInput} from '../measurables/inline_input.js';\nimport {InputConnection} from '../measurables/input_connection.js';\nimport {InputRow} from '../measurables/input_row.js';\nimport {JaggedEdge} from '../measurables/jagged_edge.js';\nimport {NextConnection} from '../measurables/next_connection.js';\nimport {OutputConnection} from '../measurables/output_connection.js';\nimport {PreviousConnection} from '../measurables/previous_connection.js';\nimport {RoundCorner} from '../measurables/round_corner.js';\nimport {Row} from '../measurables/row.js';\nimport {SpacerRow} from '../measurables/spacer_row.js';\nimport {SquareCorner} from '../measurables/square_corner.js';\nimport {StatementInput} from '../measurables/statement_input.js';\nimport {TopRow} from '../measurables/top_row.js';\nimport {Types} from '../measurables/types.js';\n\nimport {Drawer} from './drawer.js';\nimport type {IPathObject} from './i_path_object.js';\nimport {RenderInfo} from './info.js';\nimport {MarkerSvg} from './marker_svg.js';\nimport {PathObject} from './path_object.js';\nimport {Renderer} from './renderer.js';\n\n/**\n * Registers a new renderer.\n *\n * @param name The name of the renderer.\n * @param rendererClass The new renderer class to register.\n * @throws {Error} if a renderer with the same name has already been registered.\n */\nexport function register(name: string, rendererClass: Function) {\n  registry.register(registry.Type.RENDERER, name, rendererClass);\n}\n\n/**\n * Unregisters the renderer registered with the given name.\n *\n * @param name The name of the renderer.\n */\nexport function unregister(name: string) {\n  registry.unregister(registry.Type.RENDERER, name);\n}\n\n/**\n * Initialize anything needed for rendering (constants, etc).\n *\n * @param name Name of the renderer to initialize.\n * @param theme The workspace theme object.\n * @param opt_rendererOverrides Rendering constant overrides.\n * @returns The new instance of a renderer.\n *     Already initialized.\n * @internal\n */\nexport function init(\n  name: string,\n  theme: Theme,\n  opt_rendererOverrides?: {[rendererConstant: string]: any},\n): Renderer {\n  const rendererClass = registry.getClass(registry.Type.RENDERER, name);\n  const renderer = new rendererClass!(name);\n  renderer.init(theme, opt_rendererOverrides);\n  return renderer;\n}\nexport {BottomRow};\nexport {Connection};\nexport {Drawer};\nexport {ExternalValueInput};\nexport {Field};\nexport {Hat};\nexport {Icon};\nexport {InRowSpacer};\nexport {InlineInput};\nexport {InputConnection};\nexport {InputRow};\nexport {IPathObject};\nexport {JaggedEdge};\nexport {MarkerSvg};\nexport {Measurable};\nexport {NextConnection};\nexport {OutputConnection};\nexport {PathObject};\nexport {PreviousConnection};\nexport {Renderer};\nexport {RenderInfo};\nexport {RoundCorner};\nexport {Row};\nexport {SpacerRow};\nexport {SquareCorner};\nexport {StatementInput};\nexport {TopRow};\nexport {Types};\n\nexport {\n  OutsideCorners,\n  InsideCorners,\n  StartHat,\n  Notch,\n  PuzzleTab,\n  JaggedTeeth,\n  BaseShape,\n  DynamicShape,\n  ConstantProvider,\n} from './constants.js';\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.VariablesDynamic\n\nimport {Blocks} from './blocks.js';\nimport {Msg} from './msg.js';\nimport * as xml from './utils/xml.js';\nimport {VariableModel} from './variable_model.js';\nimport * as Variables from './variables.js';\nimport type {Workspace} from './workspace.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport type {FlyoutButton} from './flyout_button.js';\n\n/**\n * String for use in the \"custom\" attribute of a category in toolbox XML.\n * This string indicates that the category should be dynamically populated with\n * variable blocks.\n * See also Blockly.Variables.CATEGORY_NAME and\n * Blockly.Procedures.CATEGORY_NAME.\n */\nexport const CATEGORY_NAME = 'VARIABLE_DYNAMIC';\n\n/**\n * Click handler for a button that creates String variables.\n *\n * @param button\n */\nfunction stringButtonClickHandler(button: FlyoutButton) {\n  Variables.createVariableButtonHandler(\n    button.getTargetWorkspace(),\n    undefined,\n    'String',\n  );\n}\n// eslint-disable-next-line camelcase\nexport const onCreateVariableButtonClick_String = stringButtonClickHandler;\n\n/**\n * Click handler for a button that creates Number variables.\n *\n * @param button\n */\nfunction numberButtonClickHandler(button: FlyoutButton) {\n  Variables.createVariableButtonHandler(\n    button.getTargetWorkspace(),\n    undefined,\n    'Number',\n  );\n}\n// eslint-disable-next-line camelcase\nexport const onCreateVariableButtonClick_Number = numberButtonClickHandler;\n\n/**\n * Click handler for a button that creates Colour variables.\n *\n * @param button\n */\nfunction colourButtonClickHandler(button: FlyoutButton) {\n  Variables.createVariableButtonHandler(\n    button.getTargetWorkspace(),\n    undefined,\n    'Colour',\n  );\n}\n// eslint-disable-next-line camelcase\nexport const onCreateVariableButtonClick_Colour = colourButtonClickHandler;\n\n/**\n * Construct the elements (blocks and button) required by the flyout for the\n * variable category.\n *\n * @param workspace The workspace containing variables.\n * @returns Array of XML elements.\n */\nexport function flyoutCategory(workspace: WorkspaceSvg): Element[] {\n  let xmlList = new Array<Element>();\n  let button = document.createElement('button');\n  button.setAttribute('text', Msg['NEW_STRING_VARIABLE']);\n  button.setAttribute('callbackKey', 'CREATE_VARIABLE_STRING');\n  xmlList.push(button);\n  button = document.createElement('button');\n  button.setAttribute('text', Msg['NEW_NUMBER_VARIABLE']);\n  button.setAttribute('callbackKey', 'CREATE_VARIABLE_NUMBER');\n  xmlList.push(button);\n  button = document.createElement('button');\n  button.setAttribute('text', Msg['NEW_COLOUR_VARIABLE']);\n  button.setAttribute('callbackKey', 'CREATE_VARIABLE_COLOUR');\n  xmlList.push(button);\n\n  workspace.registerButtonCallback(\n    'CREATE_VARIABLE_STRING',\n    stringButtonClickHandler,\n  );\n  workspace.registerButtonCallback(\n    'CREATE_VARIABLE_NUMBER',\n    numberButtonClickHandler,\n  );\n  workspace.registerButtonCallback(\n    'CREATE_VARIABLE_COLOUR',\n    colourButtonClickHandler,\n  );\n\n  const blockList = flyoutCategoryBlocks(workspace);\n  xmlList = xmlList.concat(blockList);\n  return xmlList;\n}\n\n/**\n * Construct the blocks required by the flyout for the variable category.\n *\n * @param workspace The workspace containing variables.\n * @returns Array of XML block elements.\n */\nexport function flyoutCategoryBlocks(workspace: Workspace): Element[] {\n  const variableModelList = workspace.getAllVariables();\n\n  const xmlList = [];\n  if (variableModelList.length > 0) {\n    if (Blocks['variables_set_dynamic']) {\n      const firstVariable = variableModelList[variableModelList.length - 1];\n      const block = xml.createElement('block');\n      block.setAttribute('type', 'variables_set_dynamic');\n      block.setAttribute('gap', '24');\n      block.appendChild(Variables.generateVariableFieldDom(firstVariable));\n      xmlList.push(block);\n    }\n    if (Blocks['variables_get_dynamic']) {\n      variableModelList.sort(VariableModel.compareByName);\n      for (let i = 0, variable; (variable = variableModelList[i]); i++) {\n        const block = xml.createElement('block');\n        block.setAttribute('type', 'variables_get_dynamic');\n        block.setAttribute('gap', '8');\n        block.appendChild(Variables.generateVariableFieldDom(variable));\n        xmlList.push(block);\n      }\n    }\n  }\n  return xmlList;\n}\n","/**\n * @license\n * Copyright 2014 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a workspace rendered as SVG.\n *\n * @class\n */\n// Former goog.module ID: Blockly.WorkspaceSvg\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_create.js';\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_theme_change.js';\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_viewport.js';\n\nimport type {Block} from './block.js';\nimport type {BlockSvg} from './block_svg.js';\nimport type {BlocklyOptions} from './blockly_options.js';\nimport * as browserEvents from './browser_events.js';\nimport * as common from './common.js';\nimport {ComponentManager} from './component_manager.js';\nimport {config} from './config.js';\nimport {ConnectionDB} from './connection_db.js';\nimport * as ContextMenu from './contextmenu.js';\nimport {ContextMenuRegistry} from './contextmenu_registry.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport * as eventUtils from './events/utils.js';\nimport type {FlyoutButton} from './flyout_button.js';\nimport {Gesture} from './gesture.js';\nimport {Grid} from './grid.js';\nimport type {IASTNodeLocationSvg} from './interfaces/i_ast_node_location_svg.js';\nimport type {IBoundedElement} from './interfaces/i_bounded_element.js';\nimport type {ICopyData, ICopyable} from './interfaces/i_copyable.js';\nimport type {IDragTarget} from './interfaces/i_drag_target.js';\nimport type {IFlyout} from './interfaces/i_flyout.js';\nimport type {IMetricsManager} from './interfaces/i_metrics_manager.js';\nimport type {IToolbox} from './interfaces/i_toolbox.js';\nimport type {Cursor} from './keyboard_nav/cursor.js';\nimport type {Marker} from './keyboard_nav/marker.js';\nimport {MarkerManager} from './marker_manager.js';\nimport {Options} from './options.js';\nimport * as Procedures from './procedures.js';\nimport * as registry from './registry.js';\nimport * as blockRendering from './renderers/common/block_rendering.js';\nimport type {Renderer} from './renderers/common/renderer.js';\nimport type {ScrollbarPair} from './scrollbar_pair.js';\nimport * as blocks from './serialization/blocks.js';\nimport type {Theme} from './theme.js';\nimport {Classic} from './theme/classic.js';\nimport {ThemeManager} from './theme_manager.js';\nimport * as Tooltip from './tooltip.js';\nimport type {Trashcan} from './trashcan.js';\nimport * as arrayUtils from './utils/array.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport type {Metrics} from './utils/metrics.js';\nimport {Rect} from './utils/rect.js';\nimport {Size} from './utils/size.js';\nimport {Svg} from './utils/svg.js';\nimport * as svgMath from './utils/svg_math.js';\nimport * as toolbox from './utils/toolbox.js';\nimport * as userAgent from './utils/useragent.js';\nimport type {VariableModel} from './variable_model.js';\nimport * as Variables from './variables.js';\nimport * as VariablesDynamic from './variables_dynamic.js';\nimport * as WidgetDiv from './widgetdiv.js';\nimport {Workspace} from './workspace.js';\nimport {WorkspaceAudio} from './workspace_audio.js';\nimport {WorkspaceComment} from './workspace_comment.js';\nimport {WorkspaceCommentSvg} from './workspace_comment_svg.js';\nimport * as Xml from './xml.js';\nimport {ZoomControls} from './zoom_controls.js';\nimport {ContextMenuOption} from './contextmenu_registry.js';\nimport * as renderManagement from './render_management.js';\nimport * as deprecation from './utils/deprecation.js';\nimport {LayerManager} from './layer_manager.js';\n\n/** Margin around the top/bottom/left/right after a zoomToFit call. */\nconst ZOOM_TO_FIT_MARGIN = 20;\n\n/**\n * Class for a workspace.  This is an onscreen area with optional trashcan,\n * scrollbars, bubbles, and dragging.\n */\nexport class WorkspaceSvg extends Workspace implements IASTNodeLocationSvg {\n  /**\n   * A wrapper function called when a resize event occurs.\n   * You can pass the result to `eventHandling.unbind`.\n   */\n  private resizeHandlerWrapper: browserEvents.Data | null = null;\n\n  /**\n   * The render status of an SVG workspace.\n   * Returns `false` for headless workspaces and true for instances of\n   * `WorkspaceSvg`.\n   */\n  override rendered = true;\n\n  /**\n   * Whether the workspace is visible.  False if the workspace has been hidden\n   * by calling `setVisible(false)`.\n   */\n  private isVisible_ = true;\n\n  /**\n   * Whether this workspace has resizes enabled.\n   * Disable during batch operations for a performance improvement.\n   */\n  private resizesEnabled = true;\n\n  /**\n   * Current horizontal scrolling offset in pixel units, relative to the\n   * workspace origin.\n   *\n   * It is useful to think about a view, and a canvas moving beneath that\n   * view. As the canvas moves right, this value becomes more positive, and\n   * the view is now \"seeing\" the left side of the canvas. As the canvas moves\n   * left, this value becomes more negative, and the view is now \"seeing\" the\n   * right side of the canvas.\n   *\n   * The confusing thing about this value is that it does not, and must not\n   * include the absoluteLeft offset. This is because it is used to calculate\n   * the viewLeft value.\n   *\n   * The viewLeft is relative to the workspace origin (although in pixel\n   * units). The workspace origin is the top-left corner of the workspace (at\n   * least when it is enabled). It is shifted from the top-left of the\n   * blocklyDiv so as not to be beneath the toolbox.\n   *\n   * When the workspace is enabled the viewLeft and workspace origin are at\n   * the same X location. As the canvas slides towards the right beneath the\n   * view this value (scrollX) becomes more positive, and the viewLeft becomes\n   * more negative relative to the workspace origin (imagine the workspace\n   * origin as a dot on the canvas sliding to the right as the canvas moves).\n   *\n   * So if the scrollX were to include the absoluteLeft this would in a way\n   * \"unshift\" the workspace origin. This means that the viewLeft would be\n   * representing the left edge of the blocklyDiv, rather than the left edge\n   * of the workspace.\n   */\n  scrollX = 0;\n\n  /**\n   * Current vertical scrolling offset in pixel units, relative to the\n   * workspace origin.\n   *\n   * It is useful to think about a view, and a canvas moving beneath that\n   * view. As the canvas moves down, this value becomes more positive, and the\n   * view is now \"seeing\" the upper part of the canvas. As the canvas moves\n   * up, this value becomes more negative, and the view is \"seeing\" the lower\n   * part of the canvas.\n   *\n   * This confusing thing about this value is that it does not, and must not\n   * include the absoluteTop offset. This is because it is used to calculate\n   * the viewTop value.\n   *\n   * The viewTop is relative to the workspace origin (although in pixel\n   * units). The workspace origin is the top-left corner of the workspace (at\n   * least when it is enabled). It is shifted from the top-left of the\n   * blocklyDiv so as not to be beneath the toolbox.\n   *\n   * When the workspace is enabled the viewTop and workspace origin are at the\n   * same Y location. As the canvas slides towards the bottom this value\n   * (scrollY) becomes more positive, and the viewTop becomes more negative\n   * relative to the workspace origin (image in the workspace origin as a dot\n   * on the canvas sliding downwards as the canvas moves).\n   *\n   * So if the scrollY were to include the absoluteTop this would in a way\n   * \"unshift\" the workspace origin. This means that the viewTop would be\n   * representing the top edge of the blocklyDiv, rather than the top edge of\n   * the workspace.\n   */\n  scrollY = 0;\n\n  /** Horizontal scroll value when scrolling started in pixel units. */\n  startScrollX = 0;\n\n  /** Vertical scroll value when scrolling started in pixel units. */\n  startScrollY = 0;\n\n  /** Distance from mouse to object being dragged. */\n  private dragDeltaXY: Coordinate | null = null;\n\n  /** Current scale. */\n  scale = 1;\n\n  /** Cached scale value. Used to detect changes in viewport. */\n  private oldScale = 1;\n\n  /** Cached viewport top value. Used to detect changes in viewport. */\n  private oldTop = 0;\n\n  /** Cached viewport left value. Used to detect changes in viewport. */\n  private oldLeft = 0;\n\n  /** The workspace's trashcan (if any). */\n  trashcan: Trashcan | null = null;\n\n  /** This workspace's scrollbars, if they exist. */\n  scrollbar: ScrollbarPair | null = null;\n\n  /**\n   * Fixed flyout providing blocks which may be dragged into this workspace.\n   */\n  private flyout: IFlyout | null = null;\n\n  /**\n   * Category-based toolbox providing blocks which may be dragged into this\n   * workspace.\n   */\n  private toolbox_: IToolbox | null = null;\n\n  /**\n   * The current gesture in progress on this workspace, if any.\n   *\n   * @internal\n   */\n  currentGesture_: Gesture | null = null;\n\n  /**\n   * The first parent div with 'injectionDiv' in the name, or null if not set.\n   * Access this with getInjectionDiv.\n   */\n  private injectionDiv: Element | null = null;\n\n  /**\n   * Last known position of the page scroll.\n   * This is used to determine whether we have recalculated screen coordinate\n   * stuff since the page scrolled.\n   */\n  private lastRecordedPageScroll: Coordinate | null = null;\n\n  /**\n   * Developers may define this function to add custom menu options to the\n   * workspace's context menu or edit the workspace-created set of menu\n   * options.\n   *\n   * @param options List of menu options to add to.\n   * @param e The right-click event that triggered the context menu.\n   */\n  configureContextMenu:\n    | ((menuOptions: ContextMenuOption[], e: Event) => void)\n    | null = null;\n\n  /**\n   * A dummy wheel event listener used as a workaround for a Safari scrolling issue.\n   * Set in createDom and used for removal in dispose to ensure proper cleanup.\n   */\n  private dummyWheelListener: (() => void) | null = null;\n\n  /**\n   * In a flyout, the target workspace where blocks should be placed after a\n   * drag. Otherwise null.\n   *\n   * @internal\n   */\n  targetWorkspace: WorkspaceSvg | null = null;\n\n  /** Inverted screen CTM, for use in mouseToSvg. */\n  private inverseScreenCTM: SVGMatrix | null = null;\n\n  /** Inverted screen CTM is dirty, recalculate it. */\n  private inverseScreenCTMDirty = true;\n  private metricsManager: IMetricsManager;\n  /** @internal */\n  getMetrics: () => Metrics;\n  /** @internal */\n  setMetrics: (p1: {x?: number; y?: number}) => void;\n  private readonly componentManager: ComponentManager;\n\n  /**\n   * List of currently highlighted blocks.  Block highlighting is often used\n   * to visually mark blocks currently being executed.\n   */\n  private readonly highlightedBlocks: BlockSvg[] = [];\n  private audioManager: WorkspaceAudio;\n  private grid: Grid | null;\n  private markerManager: MarkerManager;\n\n  /**\n   * Map from function names to callbacks, for deciding what to do when a\n   * custom toolbox category is opened.\n   */\n  private toolboxCategoryCallbacks = new Map<\n    string,\n    (p1: WorkspaceSvg) => toolbox.FlyoutDefinition\n  >();\n\n  /**\n   * Map from function names to callbacks, for deciding what to do when a\n   * button is clicked.\n   */\n  private flyoutButtonCallbacks = new Map<string, (p1: FlyoutButton) => void>();\n  protected themeManager_: ThemeManager;\n  private readonly renderer: Renderer;\n\n  /** Cached parent SVG. */\n  private cachedParentSvg: SVGElement | null = null;\n\n  /** True if keyboard accessibility mode is on, false otherwise. */\n  keyboardAccessibilityMode = false;\n\n  /** The list of top-level bounded elements on the workspace. */\n  private topBoundedElements: IBoundedElement[] = [];\n\n  /** The recorded drag targets. */\n  private dragTargetAreas: Array<{component: IDragTarget; clientRect: Rect}> =\n    [];\n  private readonly cachedParentSvgSize: Size;\n  private layerManager: LayerManager | null = null;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  svgGroup_!: SVGElement;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  svgBackground_!: SVGElement;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  svgBlockCanvas_!: SVGElement;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  svgBubbleCanvas_!: SVGElement;\n  zoomControls_: ZoomControls | null = null;\n\n  /**\n   * @param options Dictionary of options.\n   */\n  constructor(options: Options) {\n    super(options);\n\n    const MetricsManagerClass = registry.getClassFromOptions(\n      registry.Type.METRICS_MANAGER,\n      options,\n      true,\n    );\n    /** Object in charge of calculating metrics for the workspace. */\n    this.metricsManager = new MetricsManagerClass!(this);\n\n    /** Method to get all the metrics that have to do with a workspace. */\n    this.getMetrics =\n      options.getMetrics ||\n      this.metricsManager.getMetrics.bind(this.metricsManager);\n\n    /** Translates the workspace. */\n    this.setMetrics =\n      options.setMetrics || WorkspaceSvg.setTopLevelWorkspaceMetrics_;\n\n    this.componentManager = new ComponentManager();\n\n    this.connectionDBList = ConnectionDB.init(this.connectionChecker);\n\n    /**\n     * Object in charge of loading, storing, and playing audio for a workspace.\n     */\n    this.audioManager = new WorkspaceAudio(\n      options.parentWorkspace as WorkspaceSvg,\n    );\n\n    /** This workspace's grid object or null. */\n    this.grid = this.options.gridPattern\n      ? new Grid(this.options.gridPattern, options.gridOptions)\n      : null;\n\n    /** Manager in charge of markers and cursors. */\n    this.markerManager = new MarkerManager(this);\n\n    if (Variables && Variables.flyoutCategory) {\n      this.registerToolboxCategoryCallback(\n        Variables.CATEGORY_NAME,\n        Variables.flyoutCategory,\n      );\n    }\n\n    if (VariablesDynamic && VariablesDynamic.flyoutCategory) {\n      this.registerToolboxCategoryCallback(\n        VariablesDynamic.CATEGORY_NAME,\n        VariablesDynamic.flyoutCategory,\n      );\n    }\n\n    if (Procedures && Procedures.flyoutCategory) {\n      this.registerToolboxCategoryCallback(\n        Procedures.CATEGORY_NAME,\n        Procedures.flyoutCategory,\n      );\n      this.addChangeListener(Procedures.mutatorOpenListener);\n    }\n\n    /** Object in charge of storing and updating the workspace theme. */\n    this.themeManager_ = this.options.parentWorkspace\n      ? this.options.parentWorkspace.getThemeManager()\n      : new ThemeManager(this, this.options.theme || Classic);\n    this.themeManager_.subscribeWorkspace(this);\n\n    /** The block renderer used for rendering blocks on this workspace. */\n    this.renderer = blockRendering.init(\n      this.options.renderer || 'geras',\n      this.getTheme(),\n      this.options.rendererOverrides ?? undefined,\n    );\n\n    /**\n     * The cached size of the parent svg element.\n     * Used to compute svg metrics.\n     */\n    this.cachedParentSvgSize = new Size(0, 0);\n  }\n\n  /**\n   * Get the marker manager for this workspace.\n   *\n   * @returns The marker manager.\n   */\n  getMarkerManager(): MarkerManager {\n    return this.markerManager;\n  }\n\n  /**\n   * Gets the metrics manager for this workspace.\n   *\n   * @returns The metrics manager.\n   */\n  getMetricsManager(): IMetricsManager {\n    return this.metricsManager;\n  }\n\n  /**\n   * Sets the metrics manager for the workspace.\n   *\n   * @param metricsManager The metrics manager.\n   * @internal\n   */\n  setMetricsManager(metricsManager: IMetricsManager) {\n    this.metricsManager = metricsManager;\n    this.getMetrics = this.metricsManager.getMetrics.bind(this.metricsManager);\n  }\n\n  /**\n   * Gets the component manager for this workspace.\n   *\n   * @returns The component manager.\n   */\n  getComponentManager(): ComponentManager {\n    return this.componentManager;\n  }\n\n  /**\n   * Add the cursor SVG to this workspaces SVG group.\n   *\n   * @param cursorSvg The SVG root of the cursor to be added to the workspace\n   *     SVG group.\n   * @internal\n   */\n  setCursorSvg(cursorSvg: SVGElement) {\n    this.markerManager.setCursorSvg(cursorSvg);\n  }\n\n  /**\n   * Add the marker SVG to this workspaces SVG group.\n   *\n   * @param markerSvg The SVG root of the marker to be added to the workspace\n   *     SVG group.\n   * @internal\n   */\n  setMarkerSvg(markerSvg: SVGElement) {\n    this.markerManager.setMarkerSvg(markerSvg);\n  }\n\n  /**\n   * Get the marker with the given ID.\n   *\n   * @param id The ID of the marker.\n   * @returns The marker with the given ID or null if no marker with the given\n   *     ID exists.\n   * @internal\n   */\n  getMarker(id: string): Marker | null {\n    if (this.markerManager) {\n      return this.markerManager.getMarker(id);\n    }\n    return null;\n  }\n\n  /**\n   * The cursor for this workspace.\n   *\n   * @returns The cursor for the workspace.\n   */\n  getCursor(): Cursor | null {\n    if (this.markerManager) {\n      return this.markerManager.getCursor();\n    }\n    return null;\n  }\n\n  /**\n   * Get the block renderer attached to this workspace.\n   *\n   * @returns The renderer attached to this workspace.\n   */\n  getRenderer(): Renderer {\n    return this.renderer;\n  }\n\n  /**\n   * Get the theme manager for this workspace.\n   *\n   * @returns The theme manager for this workspace.\n   * @internal\n   */\n  getThemeManager(): ThemeManager {\n    return this.themeManager_;\n  }\n\n  /**\n   * Get the workspace theme object.\n   *\n   * @returns The workspace theme object.\n   */\n  getTheme(): Theme {\n    return this.themeManager_.getTheme();\n  }\n\n  /**\n   * Set the workspace theme object.\n   * If no theme is passed, default to the `Classic` theme.\n   *\n   * @param theme The workspace theme object.\n   */\n  setTheme(theme: Theme) {\n    if (!theme) {\n      theme = Classic as Theme;\n    }\n    this.themeManager_.setTheme(theme);\n  }\n\n  /**\n   * Refresh all blocks on the workspace after a theme update.\n   */\n  refreshTheme() {\n    if (this.svgGroup_) {\n      this.renderer.refreshDom(this.svgGroup_, this.getTheme());\n    }\n\n    // Update all blocks in workspace that have a style name.\n    this.updateBlockStyles_(\n      this.getAllBlocks(false).filter(function (block) {\n        return !!block.getStyleName();\n      }),\n    );\n\n    // Update current toolbox selection.\n    this.refreshToolboxSelection();\n    if (this.toolbox_) {\n      this.toolbox_.refreshTheme();\n    }\n\n    // Re-render if workspace is visible\n    if (this.isVisible()) {\n      this.setVisible(true);\n    }\n\n    const event = new (eventUtils.get(eventUtils.THEME_CHANGE))(\n      this.getTheme().name,\n      this.id,\n    );\n    eventUtils.fire(event);\n  }\n\n  /**\n   * Updates all the blocks with new style.\n   *\n   * @param blocks List of blocks to update the style on.\n   */\n  private updateBlockStyles_(blocks: Block[]) {\n    for (let i = 0, block; (block = blocks[i]); i++) {\n      const blockStyleName = block.getStyleName();\n      if (blockStyleName) {\n        const blockSvg = block as BlockSvg;\n        blockSvg.setStyle(blockStyleName);\n      }\n    }\n  }\n\n  /**\n   * Getter for the inverted screen CTM.\n   *\n   * @returns The matrix to use in mouseToSvg\n   */\n  getInverseScreenCTM(): SVGMatrix | null {\n    // Defer getting the screen CTM until we actually need it, this should\n    // avoid forced reflows from any calls to updateInverseScreenCTM.\n    if (this.inverseScreenCTMDirty) {\n      const ctm = this.getParentSvg().getScreenCTM();\n      if (ctm) {\n        this.inverseScreenCTM = ctm.inverse();\n        this.inverseScreenCTMDirty = false;\n      }\n    }\n\n    return this.inverseScreenCTM;\n  }\n\n  /** Mark the inverse screen CTM as dirty. */\n  updateInverseScreenCTM() {\n    this.inverseScreenCTMDirty = true;\n  }\n\n  /**\n   * Getter for isVisible\n   *\n   * @returns Whether the workspace is visible.\n   *     False if the workspace has been hidden by calling `setVisible(false)`.\n   */\n  isVisible(): boolean {\n    return this.isVisible_;\n  }\n\n  /**\n   * Return the absolute coordinates of the top-left corner of this element,\n   * scales that after canvas SVG element, if it's a descendant.\n   * The origin (0,0) is the top-left corner of the Blockly SVG.\n   *\n   * @param element SVG element to find the coordinates of.\n   * @returns Object with .x and .y properties.\n   * @internal\n   */\n  getSvgXY(element: SVGElement): Coordinate {\n    let x = 0;\n    let y = 0;\n    let scale = 1;\n    if (\n      this.getCanvas().contains(element) ||\n      this.getBubbleCanvas().contains(element)\n    ) {\n      // Before the SVG canvas, scale the coordinates.\n      scale = this.scale;\n    }\n    do {\n      // Loop through this block and every parent.\n      const xy = svgMath.getRelativeXY(element);\n      if (element === this.getCanvas() || element === this.getBubbleCanvas()) {\n        // After the SVG canvas, don't scale the coordinates.\n        scale = 1;\n      }\n      x += xy.x * scale;\n      y += xy.y * scale;\n      element = element.parentNode as SVGElement;\n    } while (\n      element &&\n      element !== this.getParentSvg() &&\n      element !== this.getInjectionDiv()\n    );\n    return new Coordinate(x, y);\n  }\n\n  /**\n   * Gets the size of the workspace's parent SVG element.\n   *\n   * @returns The cached width and height of the workspace's parent SVG element.\n   * @internal\n   */\n  getCachedParentSvgSize(): Size {\n    const size = this.cachedParentSvgSize;\n    return new Size(size.width, size.height);\n  }\n\n  /**\n   * Return the position of the workspace origin relative to the injection div\n   * origin in pixels.\n   * The workspace origin is where a block would render at position (0, 0).\n   * It is not the upper left corner of the workspace SVG.\n   *\n   * @returns Offset in pixels.\n   * @internal\n   */\n  getOriginOffsetInPixels(): Coordinate {\n    return svgMath.getInjectionDivXY(this.getCanvas());\n  }\n\n  /**\n   * Return the injection div that is a parent of this workspace.\n   * Walks the DOM the first time it's called, then returns a cached value.\n   * Note: We assume this is only called after the workspace has been injected\n   * into the DOM.\n   *\n   * @returns The first parent div with 'injectionDiv' in the name.\n   * @internal\n   */\n  getInjectionDiv(): Element {\n    // NB: it would be better to pass this in at createDom, but is more likely\n    // to break existing uses of Blockly.\n    if (!this.injectionDiv) {\n      let element: Element = this.svgGroup_;\n      while (element) {\n        const classes = element.getAttribute('class') || '';\n        if ((' ' + classes + ' ').indexOf(' injectionDiv ') !== -1) {\n          this.injectionDiv = element;\n          break;\n        }\n        element = element.parentNode as Element;\n      }\n    }\n    return this.injectionDiv!;\n  }\n\n  /**\n   * Returns the SVG group for the workspace.\n   *\n   * @returns The SVG group for the workspace.\n   */\n  getSvgGroup(): Element {\n    return this.svgGroup_;\n  }\n\n  /**\n   * Get the SVG block canvas for the workspace.\n   *\n   * @returns The SVG group for the workspace.\n   * @internal\n   */\n  getBlockCanvas(): SVGElement | null {\n    return this.getCanvas();\n  }\n\n  /**\n   * Save resize handler data so we can delete it later in dispose.\n   *\n   * @param handler Data that can be passed to eventHandling.unbind.\n   */\n  setResizeHandlerWrapper(handler: browserEvents.Data) {\n    this.resizeHandlerWrapper = handler;\n  }\n\n  /**\n   * Create the workspace DOM elements.\n   *\n   * @param opt_backgroundClass Either 'blocklyMainBackground' or\n   *     'blocklyMutatorBackground'.\n   * @returns The workspace's SVG group.\n   */\n  createDom(opt_backgroundClass?: string, injectionDiv?: Element): Element {\n    if (!this.injectionDiv) {\n      this.injectionDiv = injectionDiv ?? null;\n    }\n\n    /**\n     * <g class=\"blocklyWorkspace\">\n     *   <rect class=\"blocklyMainBackground\" height=\"100%\" width=\"100%\"></rect>\n     *   [Trashcan and/or flyout may go here]\n     *   <g class=\"blocklyBlockCanvas\"></g>\n     *   <g class=\"blocklyBubbleCanvas\"></g>\n     * </g>\n     */\n    this.svgGroup_ = dom.createSvgElement(Svg.G, {'class': 'blocklyWorkspace'});\n\n    // Note that a <g> alone does not receive mouse events--it must have a\n    // valid target inside it.  If no background class is specified, as in the\n    // flyout, the workspace will not receive mouse events.\n    if (opt_backgroundClass) {\n      this.svgBackground_ = dom.createSvgElement(\n        Svg.RECT,\n        {'height': '100%', 'width': '100%', 'class': opt_backgroundClass},\n        this.svgGroup_,\n      );\n\n      if (opt_backgroundClass === 'blocklyMainBackground' && this.grid) {\n        this.svgBackground_.style.fill =\n          'url(#' + this.grid.getPatternId() + ')';\n      } else {\n        this.themeManager_.subscribe(\n          this.svgBackground_,\n          'workspaceBackgroundColour',\n          'fill',\n        );\n      }\n    }\n\n    this.layerManager = new LayerManager(this);\n    // Assign the canvases for backwards compatibility.\n    this.svgBlockCanvas_ = this.layerManager.getBlockLayer();\n    this.svgBubbleCanvas_ = this.layerManager.getBubbleLayer();\n\n    if (!this.isFlyout) {\n      browserEvents.conditionalBind(\n        this.svgGroup_,\n        'pointerdown',\n        this,\n        this.onMouseDown_,\n        false,\n      );\n      // This no-op works around https://bugs.webkit.org/show_bug.cgi?id=226683,\n      // which otherwise prevents zoom/scroll events from being observed in\n      // Safari. Once that bug is fixed it should be removed.\n      this.dummyWheelListener = () => {};\n      document.body.addEventListener('wheel', this.dummyWheelListener);\n      browserEvents.conditionalBind(\n        this.svgGroup_,\n        'wheel',\n        this,\n        this.onMouseWheel_,\n      );\n    }\n\n    // Determine if there needs to be a category tree, or a simple list of\n    // blocks.  This cannot be changed later, since the UI is very different.\n    if (this.options.hasCategories) {\n      const ToolboxClass = registry.getClassFromOptions(\n        registry.Type.TOOLBOX,\n        this.options,\n        true,\n      );\n      this.toolbox_ = new ToolboxClass!(this);\n    }\n    if (this.grid) {\n      this.grid.update(this.scale);\n    }\n    this.recordDragTargets();\n    const CursorClass = registry.getClassFromOptions(\n      registry.Type.CURSOR,\n      this.options,\n    );\n\n    CursorClass && this.markerManager.setCursor(new CursorClass());\n\n    this.renderer.createDom(this.svgGroup_, this.getTheme());\n    return this.svgGroup_;\n  }\n\n  /**\n   * Dispose of this workspace.\n   * Unlink from all DOM elements to prevent memory leaks.\n   */\n  override dispose() {\n    // Stop rerendering.\n    this.rendered = false;\n    if (this.currentGesture_) {\n      this.currentGesture_.cancel();\n    }\n    if (this.svgGroup_) {\n      dom.removeNode(this.svgGroup_);\n    }\n    if (this.toolbox_) {\n      this.toolbox_.dispose();\n      this.toolbox_ = null;\n    }\n    if (this.flyout) {\n      this.flyout.dispose();\n      this.flyout = null;\n    }\n    if (this.trashcan) {\n      this.trashcan.dispose();\n      this.trashcan = null;\n    }\n    if (this.scrollbar) {\n      this.scrollbar.dispose();\n      this.scrollbar = null;\n    }\n    if (this.zoomControls_) {\n      this.zoomControls_.dispose();\n    }\n\n    if (this.audioManager) {\n      this.audioManager.dispose();\n    }\n\n    if (this.grid) {\n      this.grid = null;\n    }\n\n    this.renderer.dispose();\n\n    if (this.markerManager) {\n      this.markerManager.dispose();\n    }\n\n    super.dispose();\n\n    // Dispose of theme manager after all blocks and mutators are disposed of.\n    if (this.themeManager_) {\n      this.themeManager_.unsubscribeWorkspace(this);\n      this.themeManager_.unsubscribe(this.svgBackground_);\n      if (!this.options.parentWorkspace) {\n        this.themeManager_.dispose();\n      }\n    }\n\n    this.connectionDBList.length = 0;\n\n    this.toolboxCategoryCallbacks.clear();\n    this.flyoutButtonCallbacks.clear();\n\n    if (!this.options.parentWorkspace) {\n      // Top-most workspace.  Dispose of the div that the\n      // SVG is injected into (i.e. injectionDiv).\n      const parentSvg = this.getParentSvg();\n      if (parentSvg && parentSvg.parentNode) {\n        dom.removeNode(parentSvg.parentNode);\n      }\n    }\n    if (this.resizeHandlerWrapper) {\n      browserEvents.unbind(this.resizeHandlerWrapper);\n      this.resizeHandlerWrapper = null;\n    }\n\n    // Remove the dummy wheel listener\n    if (this.dummyWheelListener) {\n      document.body.removeEventListener('wheel', this.dummyWheelListener);\n      this.dummyWheelListener = null;\n    }\n  }\n\n  /**\n   * Add a trashcan.\n   *\n   * @internal\n   */\n  addTrashcan() {\n    this.trashcan = WorkspaceSvg.newTrashcan(this);\n    const svgTrashcan = this.trashcan.createDom();\n    this.svgGroup_.insertBefore(svgTrashcan, this.getCanvas());\n  }\n\n  /**\n   * @param _workspace\n   * @internal\n   */\n  static newTrashcan(_workspace: WorkspaceSvg): Trashcan {\n    throw new Error(\n      'The implementation of newTrashcan should be ' +\n        'monkey-patched in by blockly.ts',\n    );\n  }\n\n  /**\n   * Add zoom controls.\n   *\n   * @internal\n   */\n  addZoomControls() {\n    this.zoomControls_ = new ZoomControls(this);\n    const svgZoomControls = this.zoomControls_.createDom();\n    this.svgGroup_.appendChild(svgZoomControls);\n  }\n\n  /**\n   * Add a flyout element in an element with the given tag name.\n   *\n   * @param tagName What type of tag the flyout belongs in.\n   * @returns The element containing the flyout DOM.\n   * @internal\n   */\n  addFlyout(tagName: string | Svg<SVGSVGElement> | Svg<SVGGElement>): Element {\n    const workspaceOptions = new Options({\n      'parentWorkspace': this,\n      'rtl': this.RTL,\n      'oneBasedIndex': this.options.oneBasedIndex,\n      'horizontalLayout': this.horizontalLayout,\n      'renderer': this.options.renderer,\n      'rendererOverrides': this.options.rendererOverrides,\n      'move': {\n        'scrollbars': true,\n      },\n    } as BlocklyOptions);\n    workspaceOptions.toolboxPosition = this.options.toolboxPosition;\n    if (this.horizontalLayout) {\n      const HorizontalFlyout = registry.getClassFromOptions(\n        registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX,\n        this.options,\n        true,\n      );\n      this.flyout = new HorizontalFlyout!(workspaceOptions);\n    } else {\n      const VerticalFlyout = registry.getClassFromOptions(\n        registry.Type.FLYOUTS_VERTICAL_TOOLBOX,\n        this.options,\n        true,\n      );\n      this.flyout = new VerticalFlyout!(workspaceOptions);\n    }\n    this.flyout.autoClose = false;\n    this.flyout.getWorkspace().setVisible(true);\n\n    // Return the element so that callers can place it in their desired\n    // spot in the DOM.  For example, mutator flyouts do not go in the same\n    // place as main workspace flyouts.\n    return this.flyout.createDom(tagName);\n  }\n\n  /**\n   * Getter for the flyout associated with this workspace.  This flyout may be\n   * owned by either the toolbox or the workspace, depending on toolbox\n   * configuration.  It will be null if there is no flyout.\n   *\n   * @param opt_own Whether to only return the workspace's own flyout.\n   * @returns The flyout on this workspace.\n   */\n  getFlyout(opt_own?: boolean): IFlyout | null {\n    if (this.flyout || opt_own) {\n      return this.flyout;\n    }\n    if (this.toolbox_) {\n      return this.toolbox_.getFlyout();\n    }\n    return null;\n  }\n\n  /**\n   * Getter for the toolbox associated with this workspace, if one exists.\n   *\n   * @returns The toolbox on this workspace.\n   */\n  getToolbox(): IToolbox | null {\n    return this.toolbox_;\n  }\n\n  /**\n   * Update items that use screen coordinate calculations\n   * because something has changed (e.g. scroll position, window size).\n   */\n  private updateScreenCalculations_() {\n    this.updateInverseScreenCTM();\n    this.recordDragTargets();\n  }\n\n  /**\n   * If enabled, resize the parts of the workspace that change when the\n   * workspace contents (e.g. block positions) change.  This will also scroll\n   * the workspace contents if needed.\n   *\n   * @internal\n   */\n  resizeContents() {\n    if (!this.resizesEnabled || !this.rendered) {\n      return;\n    }\n    if (this.scrollbar) {\n      this.scrollbar.resize();\n    }\n    this.updateInverseScreenCTM();\n  }\n\n  /**\n   * Resize and reposition all of the workspace chrome (toolbox,\n   * trash, scrollbars etc.)\n   * This should be called when something changes that\n   * requires recalculating dimensions and positions of the\n   * trash, zoom, toolbox, etc. (e.g. window resize).\n   */\n  resize() {\n    if (this.toolbox_) {\n      this.toolbox_.position();\n    }\n    if (this.flyout) {\n      this.flyout.position();\n    }\n\n    const positionables = this.componentManager.getComponents(\n      ComponentManager.Capability.POSITIONABLE,\n      true,\n    );\n    const metrics = this.getMetricsManager().getUiMetrics();\n    const savedPositions = [];\n    for (let i = 0, positionable; (positionable = positionables[i]); i++) {\n      positionable.position(metrics, savedPositions);\n      const boundingRect = positionable.getBoundingRectangle();\n      if (boundingRect) {\n        savedPositions.push(boundingRect);\n      }\n    }\n\n    if (this.scrollbar) {\n      this.scrollbar.resize();\n    }\n    this.updateScreenCalculations_();\n  }\n\n  /**\n   * Resizes and repositions workspace chrome if the page has a new\n   * scroll position.\n   *\n   * @internal\n   */\n  updateScreenCalculationsIfScrolled() {\n    /* eslint-disable indent */\n    const currScroll = svgMath.getDocumentScroll();\n    if (!Coordinate.equals(this.lastRecordedPageScroll, currScroll)) {\n      this.lastRecordedPageScroll = currScroll;\n      this.updateScreenCalculations_();\n    }\n  }\n  /* eslint-enable indent */\n\n  /**\n   * @returns The layer manager for this workspace.\n   *\n   * @internal\n   */\n  getLayerManager(): LayerManager | null {\n    return this.layerManager;\n  }\n\n  /**\n   * Get the SVG element that forms the drawing surface.\n   *\n   * @returns SVG group element.\n   */\n  getCanvas(): SVGGElement {\n    return this.layerManager!.getBlockLayer();\n  }\n\n  /**\n   * Caches the width and height of the workspace's parent SVG element for use\n   * with getSvgMetrics.\n   *\n   * @param width The width of the parent SVG element.\n   * @param height The height of the parent SVG element\n   * @internal\n   */\n  setCachedParentSvgSize(width: number | null, height: number | null) {\n    const svg = this.getParentSvg();\n    if (width != null) {\n      this.cachedParentSvgSize.width = width;\n      // This is set to support the public (but deprecated) Blockly.svgSize\n      // method.\n      svg.setAttribute('data-cached-width', `${width}`);\n    }\n    if (height != null) {\n      this.cachedParentSvgSize.height = height;\n      // This is set to support the public (but deprecated) Blockly.svgSize\n      // method.\n      svg.setAttribute('data-cached-height', `${height}`);\n    }\n  }\n\n  /**\n   * Get the SVG element that forms the bubble surface.\n   *\n   * @returns SVG group element.\n   */\n  getBubbleCanvas(): SVGGElement {\n    return this.layerManager!.getBubbleLayer();\n  }\n\n  /**\n   * Get the SVG element that contains this workspace.\n   * Note: We assume this is only called after the workspace has been injected\n   * into the DOM.\n   *\n   * @returns SVG element.\n   */\n  getParentSvg(): SVGSVGElement {\n    if (!this.cachedParentSvg) {\n      let element = this.svgGroup_;\n      while (element) {\n        if (element.tagName === 'svg') {\n          this.cachedParentSvg = element;\n          break;\n        }\n        element = element.parentNode as SVGSVGElement;\n      }\n    }\n    return this.cachedParentSvg as SVGSVGElement;\n  }\n\n  /**\n   * Fires a viewport event if events are enabled and there is a change in\n   * viewport values.\n   *\n   * @internal\n   */\n  maybeFireViewportChangeEvent() {\n    if (!eventUtils.isEnabled()) {\n      return;\n    }\n    const scale = this.scale;\n    const top = -this.scrollY;\n    const left = -this.scrollX;\n    if (\n      scale === this.oldScale &&\n      Math.abs(top - this.oldTop) < 1 &&\n      Math.abs(left - this.oldLeft) < 1\n    ) {\n      // Ignore sub-pixel changes in top and left. Due to #4192 there are a lot\n      // of negligible changes in viewport top/left.\n      return;\n    }\n    const event = new (eventUtils.get(eventUtils.VIEWPORT_CHANGE))(\n      top,\n      left,\n      scale,\n      this.id,\n      this.oldScale,\n    );\n    this.oldScale = scale;\n    this.oldTop = top;\n    this.oldLeft = left;\n    eventUtils.fire(event);\n  }\n\n  /**\n   * Translate this workspace to new coordinates.\n   *\n   * @param x Horizontal translation, in pixel units relative to the top left of\n   *     the Blockly div.\n   * @param y Vertical translation, in pixel units relative to the top left of\n   *     the Blockly div.\n   */\n  translate(x: number, y: number) {\n    this.layerManager?.translateLayers(new Coordinate(x, y), this.scale);\n    this.grid?.moveTo(x, y);\n    this.maybeFireViewportChangeEvent();\n  }\n\n  /**\n   * Returns the horizontal offset of the workspace.\n   * Intended for LTR/RTL compatibility in XML.\n   *\n   * @returns Width.\n   */\n  override getWidth(): number {\n    const metrics = this.getMetrics();\n    return metrics ? metrics.viewWidth / this.scale : 0;\n  }\n\n  /**\n   * Toggles the visibility of the workspace.\n   * Currently only intended for main workspace.\n   *\n   * @param isVisible True if workspace should be visible.\n   */\n  setVisible(isVisible: boolean) {\n    this.isVisible_ = isVisible;\n    if (!this.svgGroup_) {\n      return;\n    }\n\n    // Tell the scrollbar whether its container is visible so it can\n    // tell when to hide itself.\n    if (this.scrollbar) {\n      this.scrollbar.setContainerVisible(isVisible);\n    }\n\n    // Tell the flyout whether its container is visible so it can\n    // tell when to hide itself.\n    if (this.getFlyout()) {\n      this.getFlyout()!.setContainerVisible(isVisible);\n    }\n\n    this.getParentSvg().style.display = isVisible ? 'block' : 'none';\n    if (this.toolbox_) {\n      // Currently does not support toolboxes in mutators.\n      this.toolbox_.setVisible(isVisible);\n    }\n    if (!isVisible) {\n      this.hideChaff(true);\n    }\n  }\n\n  /**\n   * Render all blocks in workspace.\n   */\n  render() {\n    // Generate list of all blocks.\n    const blocks = this.getAllBlocks(false);\n    // Render each block.\n    for (let i = blocks.length - 1; i >= 0; i--) {\n      blocks[i].queueRender();\n    }\n\n    if (this.currentGesture_) {\n      const imList = this.currentGesture_.getInsertionMarkers();\n      for (let i = 0; i < imList.length; i++) {\n        imList[i].queueRender();\n      }\n    }\n\n    renderManagement\n      .finishQueuedRenders()\n      .then(() => void this.markerManager.updateMarkers());\n  }\n\n  /**\n   * Highlight or unhighlight a block in the workspace.  Block highlighting is\n   * often used to visually mark blocks currently being executed.\n   *\n   * @param id ID of block to highlight/unhighlight, or null for no block (used\n   *     to unhighlight all blocks).\n   * @param opt_state If undefined, highlight specified block and automatically\n   *     unhighlight all others.  If true or false, manually\n   *     highlight/unhighlight the specified block.\n   */\n  highlightBlock(id: string | null, opt_state?: boolean) {\n    if (opt_state === undefined) {\n      // Unhighlight all blocks.\n      for (let i = 0, block; (block = this.highlightedBlocks[i]); i++) {\n        block.setHighlighted(false);\n      }\n      this.highlightedBlocks.length = 0;\n    }\n    // Highlight/unhighlight the specified block.\n    const block = id ? this.getBlockById(id) : null;\n    if (block) {\n      const state = opt_state === undefined || opt_state;\n      // Using Set here would be great, but at the cost of IE10 support.\n      if (!state) {\n        arrayUtils.removeElem(this.highlightedBlocks, block);\n      } else if (this.highlightedBlocks.indexOf(block) === -1) {\n        this.highlightedBlocks.push(block);\n      }\n      block.setHighlighted(state);\n    }\n  }\n\n  /**\n   * Pastes the provided block or workspace comment onto the workspace.\n   * Does not check whether there is remaining capacity for the object, that\n   * should be done before calling this method.\n   *\n   * @param state The representation of the thing to paste.\n   * @returns The pasted thing, or null if the paste was not successful.\n   * @deprecated v10. Use `Blockly.clipboard.paste` instead. To be removed in\n   *     v11.\n   */\n  paste(\n    state: AnyDuringMigration | Element | DocumentFragment,\n  ): ICopyable<ICopyData> | null {\n    deprecation.warn(\n      'Blockly.WorkspaceSvg.prototype.paste',\n      'v10',\n      'v11',\n      'Blockly.clipboard.paste',\n    );\n    if (!this.rendered || (!state['type'] && !state['tagName'])) {\n      return null;\n    }\n    if (this.currentGesture_) {\n      // Dragging while pasting?  No.\n      this.currentGesture_.cancel();\n    }\n\n    const existingGroup = eventUtils.getGroup();\n    if (!existingGroup) {\n      eventUtils.setGroup(true);\n    }\n    let pastedThing;\n    try {\n      // Checks if this is JSON. JSON has a type property, while elements don't.\n      if (state['type']) {\n        pastedThing = this.pasteBlock_(null, state as blocks.State);\n      } else {\n        const xmlBlock = state as Element;\n        if (xmlBlock.tagName.toLowerCase() === 'comment') {\n          pastedThing = this.pasteWorkspaceComment_(xmlBlock);\n        } else {\n          pastedThing = this.pasteBlock_(xmlBlock, null);\n        }\n      }\n    } finally {\n      eventUtils.setGroup(existingGroup);\n    }\n    return pastedThing;\n  }\n\n  /**\n   * Paste the provided block onto the workspace.\n   *\n   * @param xmlBlock XML block element.\n   * @param jsonBlock JSON block representation.\n   * @returns The pasted block.\n   */\n  private pasteBlock_(\n    xmlBlock: Element | null,\n    jsonBlock: blocks.State | null,\n  ): BlockSvg {\n    eventUtils.disable();\n    let block: BlockSvg;\n    try {\n      let blockX = 0;\n      let blockY = 0;\n      if (xmlBlock) {\n        block = Xml.domToBlockInternal(xmlBlock, this) as BlockSvg;\n        blockX = parseInt(xmlBlock.getAttribute('x') ?? '0');\n        if (this.RTL) {\n          blockX = -blockX;\n        }\n        blockY = parseInt(xmlBlock.getAttribute('y') ?? '0');\n      } else if (jsonBlock) {\n        block = blocks.append(jsonBlock, this) as BlockSvg;\n        blockX = jsonBlock['x'] || 10;\n        if (this.RTL) {\n          blockX = this.getWidth() - blockX;\n        }\n        blockY = jsonBlock['y'] || 10;\n      }\n\n      // Move the duplicate to original position.\n      if (!isNaN(blockX) && !isNaN(blockY)) {\n        // Offset block until not clobbering another block and not in connection\n        // distance with neighbouring blocks.\n        let collide;\n        do {\n          collide = false;\n          const allBlocks = this.getAllBlocks(false);\n          for (let i = 0, otherBlock; (otherBlock = allBlocks[i]); i++) {\n            const otherXY = otherBlock.getRelativeToSurfaceXY();\n            if (\n              Math.abs(blockX - otherXY.x) <= 1 &&\n              Math.abs(blockY - otherXY.y) <= 1\n            ) {\n              collide = true;\n              break;\n            }\n          }\n          if (!collide) {\n            // Check for blocks in snap range to any of its connections.\n            const connections = block!.getConnections_(false);\n            for (let i = 0, connection; (connection = connections[i]); i++) {\n              const neighbour = connection.closest(\n                config.snapRadius,\n                // This code doesn't work because it's passing absolute coords\n                // instead of relative coords. But we're deprecating the `paste`\n                // function anyway so we're not going to fix it.\n                new Coordinate(blockX, blockY),\n              );\n              if (neighbour.connection) {\n                collide = true;\n                break;\n              }\n            }\n          }\n          if (collide) {\n            if (this.RTL) {\n              blockX -= config.snapRadius;\n            } else {\n              blockX += config.snapRadius;\n            }\n            blockY += config.snapRadius * 2;\n          }\n        } while (collide);\n        // No 'reason' provided since events are disabled.\n        block!.moveTo(new Coordinate(blockX, blockY));\n      }\n    } finally {\n      eventUtils.enable();\n    }\n    if (eventUtils.isEnabled() && !block!.isShadow()) {\n      eventUtils.fire(new (eventUtils.get(eventUtils.BLOCK_CREATE))(block!));\n    }\n    block!.select();\n    return block!;\n  }\n\n  /**\n   * Paste the provided comment onto the workspace.\n   *\n   * @param xmlComment XML workspace comment element.\n   * @returns The pasted workspace comment.\n   */\n  private pasteWorkspaceComment_(xmlComment: Element): WorkspaceCommentSvg {\n    eventUtils.disable();\n    let comment: WorkspaceCommentSvg;\n    try {\n      comment = WorkspaceCommentSvg.fromXmlRendered(xmlComment, this);\n      // Move the duplicate to original position.\n      let commentX = parseInt(xmlComment.getAttribute('x') ?? '0');\n      let commentY = parseInt(xmlComment.getAttribute('y') ?? '0');\n      if (!isNaN(commentX) && !isNaN(commentY)) {\n        if (this.RTL) {\n          commentX = -commentX;\n        }\n        // Offset workspace comment.\n        // TODO (#1719): Properly offset comment such that it's not interfering\n        // with any blocks.\n        commentX += 50;\n        commentY += 50;\n        // This code doesn't work because it's passing absolute coords\n        // instead of relative coords. But we're deprecating the `paste`\n        // function anyway so we're not going to fix it.\n        comment.moveBy(commentX, commentY);\n      }\n    } finally {\n      eventUtils.enable();\n    }\n    if (eventUtils.isEnabled()) {\n      WorkspaceComment.fireCreateEvent(comment);\n    }\n    comment.select();\n    return comment;\n  }\n\n  /**\n   * Refresh the toolbox unless there's a drag in progress.\n   *\n   * @internal\n   */\n  refreshToolboxSelection() {\n    const ws = this.isFlyout ? this.targetWorkspace : this;\n    if (ws && !ws.currentGesture_ && ws.toolbox_ && ws.toolbox_.getFlyout()) {\n      ws.toolbox_.refreshSelection();\n    }\n  }\n\n  /**\n   * Rename a variable by updating its name in the variable map.  Update the\n   *     flyout to show the renamed variable immediately.\n   *\n   * @param id ID of the variable to rename.\n   * @param newName New variable name.\n   */\n  override renameVariableById(id: string, newName: string) {\n    super.renameVariableById(id, newName);\n    this.refreshToolboxSelection();\n  }\n\n  /**\n   * Delete a variable by the passed in ID.   Update the flyout to show\n   *     immediately that the variable is deleted.\n   *\n   * @param id ID of variable to delete.\n   */\n  override deleteVariableById(id: string) {\n    super.deleteVariableById(id);\n    this.refreshToolboxSelection();\n  }\n\n  /**\n   * Create a new variable with the given name.  Update the flyout to show the\n   *     new variable immediately.\n   *\n   * @param name The new variable's name.\n   * @param opt_type The type of the variable like 'int' or 'string'.\n   *     Does not need to be unique. Field_variable can filter variables based\n   * on their type. This will default to '' which is a specific type.\n   * @param opt_id The unique ID of the variable. This will default to a UUID.\n   * @returns The newly created variable.\n   */\n  override createVariable(\n    name: string,\n    opt_type?: string | null,\n    opt_id?: string | null,\n  ): VariableModel {\n    const newVar = super.createVariable(name, opt_type, opt_id);\n    this.refreshToolboxSelection();\n    return newVar;\n  }\n\n  /** Make a list of all the delete areas for this workspace. */\n  recordDragTargets() {\n    const dragTargets = this.componentManager.getComponents(\n      ComponentManager.Capability.DRAG_TARGET,\n      true,\n    );\n\n    this.dragTargetAreas = [];\n    for (let i = 0, targetArea; (targetArea = dragTargets[i]); i++) {\n      const rect = targetArea.getClientRect();\n      if (rect) {\n        this.dragTargetAreas.push({\n          component: targetArea,\n          clientRect: rect,\n        });\n      }\n    }\n  }\n  /* eslint-disable jsdoc/require-returns-check */\n  /* eslint-disable @typescript-eslint/no-unused-vars */\n  /**\n   * Obtain a newly created block.\n   *\n   * @param prototypeName Name of the language object containing type-specific\n   *     functions for this block.\n   * @param opt_id Optional ID.  Use this ID if provided, otherwise create a new\n   *     ID.\n   * @returns The created block.\n   */\n  override newBlock(prototypeName: string, opt_id?: string): BlockSvg {\n    throw new Error(\n      'The implementation of newBlock should be ' +\n        'monkey-patched in by blockly.ts',\n    );\n  }\n  /* eslint-enable */\n\n  /**\n   * Returns the drag target the pointer event is over.\n   *\n   * @param e Pointer move event.\n   * @returns Null if not over a drag target, or the drag target the event is\n   *     over.\n   */\n  getDragTarget(e: PointerEvent): IDragTarget | null {\n    for (let i = 0, targetArea; (targetArea = this.dragTargetAreas[i]); i++) {\n      if (targetArea.clientRect.contains(e.clientX, e.clientY)) {\n        return targetArea.component;\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Handle a pointerdown on SVG drawing surface.\n   *\n   * @param e Pointer down event.\n   */\n  private onMouseDown_(e: PointerEvent) {\n    const gesture = this.getGesture(e);\n    if (gesture) {\n      gesture.handleWsStart(e, this);\n    }\n  }\n\n  /**\n   * Start tracking a drag of an object on this workspace.\n   *\n   * @param e Pointer down event.\n   * @param xy Starting location of object.\n   */\n  startDrag(e: PointerEvent, xy: Coordinate) {\n    // Record the starting offset between the bubble's location and the mouse.\n    const point = browserEvents.mouseToSvg(\n      e,\n      this.getParentSvg(),\n      this.getInverseScreenCTM(),\n    );\n    // Fix scale of mouse event.\n    point.x /= this.scale;\n    point.y /= this.scale;\n    this.dragDeltaXY = Coordinate.difference(xy, point);\n  }\n\n  /**\n   * Track a drag of an object on this workspace.\n   *\n   * @param e Pointer move event.\n   * @returns New location of object.\n   */\n  moveDrag(e: PointerEvent): Coordinate {\n    const point = browserEvents.mouseToSvg(\n      e,\n      this.getParentSvg(),\n      this.getInverseScreenCTM(),\n    );\n    // Fix scale of mouse event.\n    point.x /= this.scale;\n    point.y /= this.scale;\n    return Coordinate.sum(this.dragDeltaXY!, point);\n  }\n\n  /**\n   * Is the user currently dragging a block or scrolling the flyout/workspace?\n   *\n   * @returns True if currently dragging or scrolling.\n   */\n  isDragging(): boolean {\n    return this.currentGesture_ !== null && this.currentGesture_.isDragging();\n  }\n\n  /**\n   * Is this workspace draggable?\n   *\n   * @returns True if this workspace may be dragged.\n   */\n  isDraggable(): boolean {\n    return this.options.moveOptions && this.options.moveOptions.drag;\n  }\n\n  /**\n   * Is this workspace movable?\n   *\n   * This means the user can reposition the X Y coordinates of the workspace\n   * through input. This can be through scrollbars, scroll wheel, dragging, or\n   * through zooming with the scroll wheel or pinch (since the zoom is centered\n   * on the mouse position). This does not include zooming with the zoom\n   * controls since the X Y coordinates are decided programmatically.\n   *\n   * @returns True if the workspace is movable, false otherwise.\n   */\n  isMovable(): boolean {\n    return (\n      (this.options.moveOptions && !!this.options.moveOptions.scrollbars) ||\n      (this.options.moveOptions && this.options.moveOptions.wheel) ||\n      (this.options.moveOptions && this.options.moveOptions.drag) ||\n      (this.options.zoomOptions && this.options.zoomOptions.wheel) ||\n      (this.options.zoomOptions && this.options.zoomOptions.pinch)\n    );\n  }\n\n  /**\n   * Is this workspace movable horizontally?\n   *\n   * @returns True if the workspace is movable horizontally, false otherwise.\n   */\n  isMovableHorizontally(): boolean {\n    const hasScrollbars = !!this.scrollbar;\n    return (\n      this.isMovable() &&\n      (!hasScrollbars ||\n        (hasScrollbars && this.scrollbar!.canScrollHorizontally()))\n    );\n  }\n\n  /**\n   * Is this workspace movable vertically?\n   *\n   * @returns True if the workspace is movable vertically, false otherwise.\n   */\n  isMovableVertically(): boolean {\n    const hasScrollbars = !!this.scrollbar;\n    return (\n      this.isMovable() &&\n      (!hasScrollbars ||\n        (hasScrollbars && this.scrollbar!.canScrollVertically()))\n    );\n  }\n\n  /**\n   * Handle a mouse-wheel on SVG drawing surface.\n   *\n   * @param e Mouse wheel event.\n   */\n  private onMouseWheel_(e: WheelEvent) {\n    // Don't scroll or zoom anything if drag is in progress.\n    if (Gesture.inProgress()) {\n      e.preventDefault();\n      e.stopPropagation();\n      return;\n    }\n    const canWheelZoom =\n      this.options.zoomOptions && this.options.zoomOptions.wheel;\n    const canWheelMove =\n      this.options.moveOptions && this.options.moveOptions.wheel;\n    if (!canWheelZoom && !canWheelMove) {\n      return;\n    }\n\n    const scrollDelta = browserEvents.getScrollDeltaPixels(e);\n\n    // Zoom should also be enabled by the command key on Mac devices,\n    // but not super on Unix.\n    let commandKey;\n    if (userAgent.MAC) {\n      commandKey = e.metaKey;\n    }\n\n    if (canWheelZoom && (e.ctrlKey || commandKey || !canWheelMove)) {\n      // Zoom.\n      // The vertical scroll distance that corresponds to a click of a zoom\n      // button.\n      const PIXELS_PER_ZOOM_STEP = 50;\n      const delta = -scrollDelta.y / PIXELS_PER_ZOOM_STEP;\n      const position = browserEvents.mouseToSvg(\n        e,\n        this.getParentSvg(),\n        this.getInverseScreenCTM(),\n      );\n      this.zoom(position.x, position.y, delta);\n    } else {\n      // Scroll.\n      let x = this.scrollX - scrollDelta.x;\n      let y = this.scrollY - scrollDelta.y;\n\n      if (e.shiftKey && !scrollDelta.x) {\n        // Scroll horizontally (based on vertical scroll delta).\n        // This is needed as for some browser/system combinations which do not\n        // set deltaX.\n        x = this.scrollX - scrollDelta.y;\n        y = this.scrollY; // Don't scroll vertically.\n      }\n      this.scroll(x, y);\n    }\n    e.preventDefault();\n  }\n\n  /**\n   * Calculate the bounding box for the blocks on the workspace.\n   * Coordinate system: workspace coordinates.\n   *\n   * @returns Contains the position and size of the bounding box containing the\n   *     blocks on the workspace.\n   */\n  getBlocksBoundingBox(): Rect {\n    const topElements = this.getTopBoundedElements();\n    // There are no blocks, return empty rectangle.\n    if (!topElements.length) {\n      return new Rect(0, 0, 0, 0);\n    }\n\n    // Initialize boundary using the first block.\n    const boundary = topElements[0].getBoundingRectangle();\n\n    // Start at 1 since the 0th block was used for initialization.\n    for (let i = 1; i < topElements.length; i++) {\n      const topElement = topElements[i];\n      if (\n        (topElement as any).isInsertionMarker &&\n        (topElement as any).isInsertionMarker()\n      ) {\n        continue;\n      }\n      const blockBoundary = topElement.getBoundingRectangle();\n      if (blockBoundary.top < boundary.top) {\n        boundary.top = blockBoundary.top;\n      }\n      if (blockBoundary.bottom > boundary.bottom) {\n        boundary.bottom = blockBoundary.bottom;\n      }\n      if (blockBoundary.left < boundary.left) {\n        boundary.left = blockBoundary.left;\n      }\n      if (blockBoundary.right > boundary.right) {\n        boundary.right = blockBoundary.right;\n      }\n    }\n    return boundary;\n  }\n\n  /** Clean up the workspace by ordering all the blocks in a column. */\n  cleanUp() {\n    this.setResizesEnabled(false);\n    eventUtils.setGroup(true);\n    const topBlocks = this.getTopBlocks(true);\n    let cursorY = 0;\n    for (let i = 0, block; (block = topBlocks[i]); i++) {\n      if (!block.isMovable()) {\n        continue;\n      }\n      const xy = block.getRelativeToSurfaceXY();\n      block.moveBy(-xy.x, cursorY - xy.y, ['cleanup']);\n      block.snapToGrid();\n      cursorY =\n        block.getRelativeToSurfaceXY().y +\n        block.getHeightWidth().height +\n        this.renderer.getConstants().MIN_BLOCK_HEIGHT;\n    }\n    eventUtils.setGroup(false);\n    this.setResizesEnabled(true);\n  }\n\n  /**\n   * Show the context menu for the workspace.\n   *\n   * @param e Mouse event.\n   * @internal\n   */\n  showContextMenu(e: Event) {\n    if (this.options.readOnly || this.isFlyout) {\n      return;\n    }\n    const menuOptions = ContextMenuRegistry.registry.getContextMenuOptions(\n      ContextMenuRegistry.ScopeType.WORKSPACE,\n      {workspace: this},\n    );\n\n    // Allow the developer to add or modify menuOptions.\n    if (this.configureContextMenu) {\n      this.configureContextMenu(menuOptions, e);\n    }\n\n    ContextMenu.show(e, menuOptions, this.RTL);\n  }\n\n  /**\n   * Modify the block tree on the existing toolbox.\n   *\n   * @param toolboxDef DOM tree of toolbox contents, string of toolbox contents,\n   *     or JSON representing toolbox definition.\n   */\n  updateToolbox(toolboxDef: toolbox.ToolboxDefinition | null) {\n    const parsedToolboxDef = toolbox.convertToolboxDefToJson(toolboxDef);\n\n    if (!parsedToolboxDef) {\n      if (this.options.languageTree) {\n        throw Error(\"Can't nullify an existing toolbox.\");\n      }\n      return; // No change (null to null).\n    }\n    if (!this.options.languageTree) {\n      throw Error(\"Existing toolbox is null.  Can't create new toolbox.\");\n    }\n\n    if (toolbox.hasCategories(parsedToolboxDef)) {\n      if (!this.toolbox_) {\n        throw Error(\"Existing toolbox has no categories.  Can't change mode.\");\n      }\n      this.options.languageTree = parsedToolboxDef;\n      this.toolbox_.render(parsedToolboxDef);\n    } else {\n      if (!this.flyout) {\n        throw Error(\"Existing toolbox has categories.  Can't change mode.\");\n      }\n      this.options.languageTree = parsedToolboxDef;\n      this.flyout.show(parsedToolboxDef);\n    }\n  }\n\n  /** Mark this workspace as the currently focused main workspace. */\n  markFocused() {\n    if (this.options.parentWorkspace) {\n      this.options.parentWorkspace.markFocused();\n    } else {\n      common.setMainWorkspace(this);\n      // We call e.preventDefault in many event handlers which means we\n      // need to explicitly grab focus (e.g from a textarea) because\n      // the browser will not do it for us.\n      this.getParentSvg().focus({preventScroll: true});\n    }\n  }\n\n  /**\n   * Zooms the workspace in or out relative to/centered on the given (x, y)\n   * coordinate.\n   *\n   * @param x X coordinate of center, in pixel units relative to the top-left\n   *     corner of the parentSVG.\n   * @param y Y coordinate of center, in pixel units relative to the top-left\n   *     corner of the parentSVG.\n   * @param amount Amount of zooming. The formula for the new scale is newScale\n   *     = currentScale * (scaleSpeed^amount). scaleSpeed is set in the\n   *     workspace options. Negative amount values zoom out, and positive amount\n   *     values zoom in.\n   */\n  zoom(x: number, y: number, amount: number) {\n    // Scale factor.\n    const speed = this.options.zoomOptions.scaleSpeed;\n    let scaleChange = Math.pow(speed, amount);\n    const newScale = this.scale * scaleChange;\n    if (this.scale === newScale) {\n      return; // No change in zoom.\n    }\n\n    // Clamp scale within valid range.\n    if (newScale > this.options.zoomOptions.maxScale) {\n      scaleChange = this.options.zoomOptions.maxScale / this.scale;\n    } else if (newScale < this.options.zoomOptions.minScale) {\n      scaleChange = this.options.zoomOptions.minScale / this.scale;\n    }\n\n    // Transform the x/y coordinates from the parentSVG's space into the\n    // canvas' space, so that they are in workspace units relative to the top\n    // left of the visible portion of the workspace.\n    let matrix = this.getCanvas().getCTM();\n    let center = this.getParentSvg().createSVGPoint();\n    center.x = x;\n    center.y = y;\n    center = center.matrixTransform(matrix!.inverse());\n    x = center.x;\n    y = center.y;\n\n    // Find the new scrollX/scrollY so that the center remains in the same\n    // position (relative to the center) after we zoom.\n    // newScale and matrix.a should be identical (within a rounding error).\n    matrix = matrix!\n      .translate(x * (1 - scaleChange), y * (1 - scaleChange))\n      .scale(scaleChange);\n    // scrollX and scrollY are in pixels.\n    // The scrollX and scrollY still need to have absoluteLeft and absoluteTop\n    // subtracted from them, but we'll leave that for setScale so that they're\n    // correctly updated for the new flyout size if we have a simple toolbox.\n    this.scrollX = matrix.e;\n    this.scrollY = matrix.f;\n    this.setScale(newScale);\n  }\n\n  /**\n   * Zooming the blocks centered in the center of view with zooming in or out.\n   *\n   * @param type Type of zooming (-1 zooming out and 1 zooming in).\n   */\n  zoomCenter(type: number) {\n    const metrics = this.getMetrics();\n    let x;\n    let y;\n    if (this.flyout) {\n      // If you want blocks in the center of the view (visible portion of the\n      // workspace) to stay centered when the size of the view decreases (i.e.\n      // when the size of the flyout increases) you need the center of the\n      // *blockly div* to stay in the same pixel-position.\n      // Note: This only works because of how scrollCenter positions blocks.\n      x = metrics.svgWidth ? metrics.svgWidth / 2 : 0;\n      y = metrics.svgHeight ? metrics.svgHeight / 2 : 0;\n    } else {\n      x = metrics.viewWidth / 2 + metrics.absoluteLeft;\n      y = metrics.viewHeight / 2 + metrics.absoluteTop;\n    }\n    this.zoom(x, y, type);\n  }\n\n  /** Zoom the blocks to fit in the workspace if possible. */\n  zoomToFit() {\n    if (!this.isMovable()) {\n      console.warn(\n        'Tried to move a non-movable workspace. This could result' +\n          ' in blocks becoming inaccessible.',\n      );\n      return;\n    }\n\n    const metrics = this.getMetrics();\n    let workspaceWidth = metrics.viewWidth;\n    let workspaceHeight = metrics.viewHeight;\n    const blocksBox = this.getBlocksBoundingBox();\n    const doubleMargin = ZOOM_TO_FIT_MARGIN * 2;\n    let blocksWidth = blocksBox.right - blocksBox.left + doubleMargin;\n    let blocksHeight = blocksBox.bottom - blocksBox.top + doubleMargin;\n    if (!blocksWidth) {\n      return; // Prevents zooming to infinity.\n    }\n    if (this.flyout) {\n      // We have to add the flyout size to both the workspace size and the\n      // block size because the blocks we want to resize include the blocks in\n      // the flyout, and the area we want to fit them includes the portion of\n      // the workspace that is behind the flyout.\n      if (this.horizontalLayout) {\n        workspaceHeight += this.flyout.getHeight();\n        // Convert from pixels to workspace coordinates.\n        blocksHeight += this.flyout.getHeight() / this.scale;\n      } else {\n        workspaceWidth += this.flyout.getWidth();\n        // Convert from pixels to workspace coordinates.\n        blocksWidth += this.flyout.getWidth() / this.scale;\n      }\n    }\n\n    // Scale Units: (pixels / workspaceUnit)\n    const ratioX = workspaceWidth / blocksWidth;\n    const ratioY = workspaceHeight / blocksHeight;\n    eventUtils.disable();\n    try {\n      this.setScale(Math.min(ratioX, ratioY));\n      this.scrollCenter();\n    } finally {\n      eventUtils.enable();\n    }\n    this.maybeFireViewportChangeEvent();\n  }\n\n  /**\n   * Add a transition class to the block and bubble canvas, to animate any\n   * transform changes.\n   *\n   * @internal\n   */\n  beginCanvasTransition() {\n    dom.addClass(this.getCanvas(), 'blocklyCanvasTransitioning');\n    dom.addClass(this.getBubbleCanvas(), 'blocklyCanvasTransitioning');\n  }\n\n  /**\n   * Remove transition class from the block and bubble canvas.\n   *\n   * @internal\n   */\n  endCanvasTransition() {\n    dom.removeClass(this.getCanvas(), 'blocklyCanvasTransitioning');\n    dom.removeClass(this.getBubbleCanvas(), 'blocklyCanvasTransitioning');\n  }\n\n  /** Center the workspace. */\n  scrollCenter() {\n    if (!this.isMovable()) {\n      console.warn(\n        'Tried to move a non-movable workspace. This could result' +\n          ' in blocks becoming inaccessible.',\n      );\n      return;\n    }\n\n    const metrics = this.getMetrics();\n    let x = (metrics.scrollWidth - metrics.viewWidth) / 2;\n    let y = (metrics.scrollHeight - metrics.viewHeight) / 2;\n\n    // Convert from workspace directions to canvas directions.\n    x = -x - metrics.scrollLeft;\n    y = -y - metrics.scrollTop;\n    this.scroll(x, y);\n  }\n\n  /**\n   * Scroll the workspace to center on the given block. If the block has other\n   * blocks stacked below it, the workspace will be centered on the stack,\n   * unless blockOnly is true.\n   *\n   * @param id ID of block center on.\n   * @param blockOnly True to center only on the block itself, not its stack.\n   */\n  centerOnBlock(id: string | null, blockOnly?: boolean) {\n    if (!this.isMovable()) {\n      console.warn(\n        'Tried to move a non-movable workspace. This could result' +\n          ' in blocks becoming inaccessible.',\n      );\n      return;\n    }\n\n    const block = id ? this.getBlockById(id) : null;\n    if (!block) {\n      return;\n    }\n\n    // XY is in workspace coordinates.\n    const xy = block.getRelativeToSurfaceXY();\n    // Height/width is in workspace units.\n    const heightWidth = blockOnly\n      ? {height: block.height, width: block.width}\n      : block.getHeightWidth();\n\n    // Find the enter of the block in workspace units.\n    const blockCenterY = xy.y + heightWidth.height / 2;\n\n    // In RTL the block's position is the top right of the block, not top left.\n    const multiplier = this.RTL ? -1 : 1;\n    const blockCenterX = xy.x + (multiplier * heightWidth.width) / 2;\n\n    // Workspace scale, used to convert from workspace coordinates to pixels.\n    const scale = this.scale;\n\n    // Center of block in pixels, relative to workspace origin (center 0,0).\n    // Scrolling to here would put the block in the top-left corner of the\n    // visible workspace.\n    const pixelX = blockCenterX * scale;\n    const pixelY = blockCenterY * scale;\n\n    const metrics = this.getMetrics();\n\n    // viewHeight and viewWidth are in pixels.\n    const halfViewWidth = metrics.viewWidth / 2;\n    const halfViewHeight = metrics.viewHeight / 2;\n\n    // Put the block in the center of the visible workspace instead.\n    const scrollToCenterX = pixelX - halfViewWidth;\n    const scrollToCenterY = pixelY - halfViewHeight;\n\n    // Convert from workspace directions to canvas directions.\n    const x = -scrollToCenterX;\n    const y = -scrollToCenterY;\n\n    this.scroll(x, y);\n  }\n\n  /**\n   * Set the workspace's zoom factor.\n   *\n   * @param newScale Zoom factor. Units: (pixels / workspaceUnit).\n   */\n  setScale(newScale: number) {\n    if (\n      this.options.zoomOptions.maxScale &&\n      newScale > this.options.zoomOptions.maxScale\n    ) {\n      newScale = this.options.zoomOptions.maxScale;\n    } else if (\n      this.options.zoomOptions.minScale &&\n      newScale < this.options.zoomOptions.minScale\n    ) {\n      newScale = this.options.zoomOptions.minScale;\n    }\n    this.scale = newScale;\n\n    this.hideChaff(false);\n    // Get the flyout, if any, whether our own or owned by the toolbox.\n    const flyout = this.getFlyout(false);\n    if (flyout && flyout.isVisible()) {\n      flyout.reflow();\n      this.recordDragTargets();\n    }\n    if (this.grid) {\n      this.grid.update(this.scale);\n    }\n\n    // We call scroll instead of scrollbar.resize() so that we can center the\n    // zoom correctly without scrollbars, but scroll does not resize the\n    // scrollbars so we have to call resizeView/resizeContent as well.\n    const metrics = this.getMetrics();\n\n    this.scrollX -= metrics.absoluteLeft;\n    this.scrollY -= metrics.absoluteTop;\n    // The scroll values and the view values are additive inverses of\n    // each other, so when we subtract from one we have to add to the other.\n    metrics.viewLeft += metrics.absoluteLeft;\n    metrics.viewTop += metrics.absoluteTop;\n\n    this.scroll(this.scrollX, this.scrollY);\n    if (this.scrollbar) {\n      if (this.flyout) {\n        this.scrollbar.resizeView(metrics);\n      } else {\n        this.scrollbar.resizeContent(metrics);\n      }\n    }\n  }\n\n  /**\n   * Get the workspace's zoom factor.  If the workspace has a parent, we call\n   * into the parent to get the workspace scale.\n   *\n   * @returns The workspace zoom factor. Units: (pixels / workspaceUnit).\n   */\n  getScale(): number {\n    if (this.options.parentWorkspace) {\n      return this.options.parentWorkspace.getScale();\n    }\n    return this.scale;\n  }\n\n  /**\n   * Scroll the workspace to a specified offset (in pixels), keeping in the\n   * workspace bounds. See comment on workspaceSvg.scrollX for more detail on\n   * the meaning of these values.\n   *\n   * @param x Target X to scroll to.\n   * @param y Target Y to scroll to.\n   * @internal\n   */\n  scroll(x: number, y: number) {\n    this.hideChaff(/* opt_onlyClosePopups= */ true);\n\n    // Keep scrolling within the bounds of the content.\n    const metrics = this.getMetrics();\n    // Canvas coordinates (aka scroll coordinates) have inverse directionality\n    // to workspace coordinates so we have to inverse them.\n    x = Math.min(x, -metrics.scrollLeft);\n    y = Math.min(y, -metrics.scrollTop);\n    const maxXDisplacement = Math.max(\n      0,\n      metrics.scrollWidth - metrics.viewWidth,\n    );\n    const maxXScroll = metrics.scrollLeft + maxXDisplacement;\n    const maxYDisplacement = Math.max(\n      0,\n      metrics.scrollHeight - metrics.viewHeight,\n    );\n    const maxYScroll = metrics.scrollTop + maxYDisplacement;\n    x = Math.max(x, -maxXScroll);\n    y = Math.max(y, -maxYScroll);\n    this.scrollX = x;\n    this.scrollY = y;\n\n    if (this.scrollbar) {\n      // The content position (displacement from the content's top-left to the\n      // origin) plus the scroll position (displacement from the view's top-left\n      // to the origin) gives us the distance from the view's top-left to the\n      // content's top-left. Then we negate this so we get the displacement from\n      // the content's top-left to the view's top-left, matching the\n      // directionality of the scrollbars.\n      this.scrollbar.set(\n        -(x + metrics.scrollLeft),\n        -(y + metrics.scrollTop),\n        false,\n      );\n    }\n    // We have to shift the translation so that when the canvas is at 0, 0 the\n    // workspace origin is not underneath the toolbox.\n    x += metrics.absoluteLeft;\n    y += metrics.absoluteTop;\n    this.translate(x, y);\n  }\n\n  /**\n   * Find the block on this workspace with the specified ID.\n   *\n   * @param id ID of block to find.\n   * @returns The sought after block, or null if not found.\n   */\n  override getBlockById(id: string): BlockSvg | null {\n    return super.getBlockById(id) as BlockSvg;\n  }\n\n  /**\n   * Find all blocks in workspace.  Blocks are optionally sorted\n   * by position; top to bottom (with slight LTR or RTL bias).\n   *\n   * @param ordered Sort the list if true.\n   * @returns Array of blocks.\n   */\n  override getAllBlocks(ordered = false): BlockSvg[] {\n    return super.getAllBlocks(ordered) as BlockSvg[];\n  }\n\n  /**\n   * Finds the top-level blocks and returns them.  Blocks are optionally sorted\n   * by position; top to bottom (with slight LTR or RTL bias).\n   *\n   * @param ordered Sort the list if true.\n   * @returns The top-level block objects.\n   */\n  override getTopBlocks(ordered = false): BlockSvg[] {\n    return super.getTopBlocks(ordered) as BlockSvg[];\n  }\n\n  /**\n   * Adds a block to the list of top blocks.\n   *\n   * @param block Block to add.\n   */\n  override addTopBlock(block: Block) {\n    this.addTopBoundedElement(block as BlockSvg);\n    super.addTopBlock(block);\n  }\n\n  /**\n   * Removes a block from the list of top blocks.\n   *\n   * @param block Block to remove.\n   */\n  override removeTopBlock(block: Block) {\n    this.removeTopBoundedElement(block as BlockSvg);\n    super.removeTopBlock(block);\n  }\n\n  /**\n   * Adds a comment to the list of top comments.\n   *\n   * @param comment comment to add.\n   */\n  override addTopComment(comment: WorkspaceComment) {\n    this.addTopBoundedElement(comment as WorkspaceCommentSvg);\n    super.addTopComment(comment);\n  }\n\n  /**\n   * Removes a comment from the list of top comments.\n   *\n   * @param comment comment to remove.\n   */\n  override removeTopComment(comment: WorkspaceComment) {\n    this.removeTopBoundedElement(comment as WorkspaceCommentSvg);\n    super.removeTopComment(comment);\n  }\n\n  override getRootWorkspace(): WorkspaceSvg | null {\n    return super.getRootWorkspace() as WorkspaceSvg | null;\n  }\n\n  /**\n   * Adds a bounded element to the list of top bounded elements.\n   *\n   * @param element Bounded element to add.\n   */\n  addTopBoundedElement(element: IBoundedElement) {\n    this.topBoundedElements.push(element);\n  }\n\n  /**\n   * Removes a bounded element from the list of top bounded elements.\n   *\n   * @param element Bounded element to remove.\n   */\n  removeTopBoundedElement(element: IBoundedElement) {\n    arrayUtils.removeElem(this.topBoundedElements, element);\n  }\n\n  /**\n   * Finds the top-level bounded elements and returns them.\n   *\n   * @returns The top-level bounded elements.\n   */\n  getTopBoundedElements(): IBoundedElement[] {\n    return new Array<IBoundedElement>().concat(this.topBoundedElements);\n  }\n\n  /**\n   * Update whether this workspace has resizes enabled.\n   * If enabled, workspace will resize when appropriate.\n   * If disabled, workspace will not resize until re-enabled.\n   * Use to avoid resizing during a batch operation, for performance.\n   *\n   * @param enabled Whether resizes should be enabled.\n   */\n  setResizesEnabled(enabled: boolean) {\n    const reenabled = !this.resizesEnabled && enabled;\n    this.resizesEnabled = enabled;\n    if (reenabled) {\n      // Newly enabled.  Trigger a resize.\n      this.resizeContents();\n    }\n  }\n\n  /**\n   * Dispose of all blocks in workspace, with an optimization to prevent\n   * resizes.\n   */\n  override clear() {\n    this.setResizesEnabled(false);\n    super.clear();\n    this.topBoundedElements = [];\n    this.setResizesEnabled(true);\n  }\n\n  /**\n   * Register a callback function associated with a given key, for clicks on\n   * buttons and labels in the flyout.\n   * For instance, a button specified by the XML\n   * <button text=\"create variable\" callbackKey=\"CREATE_VARIABLE\"></button>\n   * should be matched by a call to\n   * registerButtonCallback(\"CREATE_VARIABLE\", yourCallbackFunction).\n   *\n   * @param key The name to use to look up this function.\n   * @param func The function to call when the given button is clicked.\n   */\n  registerButtonCallback(key: string, func: (p1: FlyoutButton) => void) {\n    if (typeof func !== 'function') {\n      throw TypeError('Button callbacks must be functions.');\n    }\n    this.flyoutButtonCallbacks.set(key, func);\n  }\n\n  /**\n   * Get the callback function associated with a given key, for clicks on\n   * buttons and labels in the flyout.\n   *\n   * @param key The name to use to look up the function.\n   * @returns The function corresponding to the given key for this workspace;\n   *     null if no callback is registered.\n   */\n  getButtonCallback(key: string): ((p1: FlyoutButton) => void) | null {\n    return this.flyoutButtonCallbacks.get(key) ?? null;\n  }\n\n  /**\n   * Remove a callback for a click on a button in the flyout.\n   *\n   * @param key The name associated with the callback function.\n   */\n  removeButtonCallback(key: string) {\n    this.flyoutButtonCallbacks.delete(key);\n  }\n\n  /**\n   * Register a callback function associated with a given key, for populating\n   * custom toolbox categories in this workspace.  See the variable and\n   * procedure categories as an example.\n   *\n   * @param key The name to use to look up this function.\n   * @param func The function to call when the given toolbox category is opened.\n   */\n  registerToolboxCategoryCallback(\n    key: string,\n    func: (p1: WorkspaceSvg) => toolbox.FlyoutDefinition,\n  ) {\n    if (typeof func !== 'function') {\n      throw TypeError('Toolbox category callbacks must be functions.');\n    }\n    this.toolboxCategoryCallbacks.set(key, func);\n  }\n\n  /**\n   * Get the callback function associated with a given key, for populating\n   * custom toolbox categories in this workspace.\n   *\n   * @param key The name to use to look up the function.\n   * @returns The function corresponding to the given key for this workspace, or\n   *     null if no function is registered.\n   */\n  getToolboxCategoryCallback(\n    key: string,\n  ): ((p1: WorkspaceSvg) => toolbox.FlyoutDefinition) | null {\n    return this.toolboxCategoryCallbacks.get(key) || null;\n  }\n\n  /**\n   * Remove a callback for a click on a custom category's name in the toolbox.\n   *\n   * @param key The name associated with the callback function.\n   */\n  removeToolboxCategoryCallback(key: string) {\n    this.toolboxCategoryCallbacks.delete(key);\n  }\n\n  /**\n   * Look up the gesture that is tracking this touch stream on this workspace.\n   * May create a new gesture.\n   *\n   * @param e Pointer event.\n   * @returns The gesture that is tracking this touch stream, or null if no\n   *     valid gesture exists.\n   * @internal\n   */\n  getGesture(e: PointerEvent): Gesture | null {\n    const isStart = e.type === 'pointerdown';\n\n    const gesture = this.currentGesture_;\n    if (gesture) {\n      if (isStart && gesture.hasStarted()) {\n        console.warn('Tried to start the same gesture twice.');\n        // That's funny.  We must have missed a mouse up.\n        // Cancel it, rather than try to retrieve all of the state we need.\n        gesture.cancel();\n        return null;\n      }\n      return gesture;\n    }\n\n    // No gesture existed on this workspace, but this looks like the start of a\n    // new gesture.\n    if (isStart) {\n      this.currentGesture_ = new Gesture(e, this);\n      return this.currentGesture_;\n    }\n    // No gesture existed and this event couldn't be the start of a new gesture.\n    return null;\n  }\n\n  /**\n   * Clear the reference to the current gesture.\n   *\n   * @internal\n   */\n  clearGesture() {\n    this.currentGesture_ = null;\n  }\n\n  /**\n   * Cancel the current gesture, if one exists.\n   *\n   * @internal\n   */\n  cancelCurrentGesture() {\n    if (this.currentGesture_) {\n      this.currentGesture_.cancel();\n    }\n  }\n\n  /**\n   * Get the audio manager for this workspace.\n   *\n   * @returns The audio manager for this workspace.\n   */\n  getAudioManager(): WorkspaceAudio {\n    return this.audioManager;\n  }\n\n  /**\n   * Get the grid object for this workspace, or null if there is none.\n   *\n   * @returns The grid object for this workspace.\n   */\n  getGrid(): Grid | null {\n    return this.grid;\n  }\n\n  /**\n   * Close tooltips, context menus, dropdown selections, etc.\n   *\n   * @param onlyClosePopups Whether only popups should be closed. Defaults to\n   *     false.\n   */\n  hideChaff(onlyClosePopups = false) {\n    Tooltip.hide();\n    WidgetDiv.hide();\n    dropDownDiv.hideWithoutAnimation();\n\n    this.hideComponents(onlyClosePopups);\n  }\n\n  /**\n   * Hide any autohideable components (like flyout, trashcan, and any\n   * user-registered components).\n   *\n   * @param onlyClosePopups Whether only popups should be closed. Defaults to\n   *     false.\n   */\n  hideComponents(onlyClosePopups = false) {\n    const autoHideables = this.getComponentManager().getComponents(\n      ComponentManager.Capability.AUTOHIDEABLE,\n      true,\n    );\n    autoHideables.forEach((autoHideable) =>\n      autoHideable.autoHide(onlyClosePopups),\n    );\n  }\n\n  /**\n   * Sets the X/Y translations of a top level workspace.\n   *\n   * @param xyRatio Contains an x and/or y property which is a float between 0\n   *     and 1 specifying the degree of scrolling.\n   */\n  private static setTopLevelWorkspaceMetrics_(\n    this: WorkspaceSvg,\n    xyRatio: {x?: number; y?: number},\n  ) {\n    const metrics = this.getMetrics();\n\n    if (typeof xyRatio.x === 'number') {\n      this.scrollX = -(\n        metrics.scrollLeft +\n        (metrics.scrollWidth - metrics.viewWidth) * xyRatio.x\n      );\n    }\n    if (typeof xyRatio.y === 'number') {\n      this.scrollY = -(\n        metrics.scrollTop +\n        (metrics.scrollHeight - metrics.viewHeight) * xyRatio.y\n      );\n    }\n    // We have to shift the translation so that when the canvas is at 0, 0 the\n    // workspace origin is not underneath the toolbox.\n    const x = this.scrollX + metrics.absoluteLeft;\n    const y = this.scrollY + metrics.absoluteTop;\n    // We could call scroll here, but that has extra checks we don't need to do.\n    this.translate(x, y);\n  }\n}\n\n/**\n * Size the workspace when the contents change.  This also updates\n * scrollbars accordingly.\n *\n * @param workspace The workspace to resize.\n * @internal\n */\nexport function resizeSvgContents(workspace: WorkspaceSvg) {\n  workspace.resizeContents();\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.ICopyable\n\nimport type {ISelectable} from './i_selectable.js';\n\nexport interface ICopyable<T extends ICopyData> extends ISelectable {\n  /**\n   * Encode for copying.\n   *\n   * @returns Copy metadata.\n   */\n  toCopyData(): T | null;\n}\n\nexport namespace ICopyable {\n  export interface ICopyData {\n    paster: string;\n  }\n}\n\nexport type ICopyData = ICopyable.ICopyData;\n\n/** @returns true if the given object is copyable. */\nexport function isCopyable(obj: any): obj is ICopyable<ICopyData> {\n  return obj.toCopyData !== undefined;\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.ShortcutItems\n\nimport {BlockSvg} from './block_svg.js';\nimport * as clipboard from './clipboard.js';\nimport * as common from './common.js';\nimport {Gesture} from './gesture.js';\nimport {ICopyData, isCopyable} from './interfaces/i_copyable.js';\nimport {KeyboardShortcut, ShortcutRegistry} from './shortcut_registry.js';\nimport {KeyCodes} from './utils/keycodes.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Object holding the names of the default shortcut items.\n */\nexport enum names {\n  ESCAPE = 'escape',\n  DELETE = 'delete',\n  COPY = 'copy',\n  CUT = 'cut',\n  PASTE = 'paste',\n  UNDO = 'undo',\n  REDO = 'redo',\n}\n\n/**\n * Keyboard shortcut to hide chaff on escape.\n */\nexport function registerEscape() {\n  const escapeAction: KeyboardShortcut = {\n    name: names.ESCAPE,\n    preconditionFn(workspace) {\n      return !workspace.options.readOnly;\n    },\n    callback(workspace) {\n      // AnyDuringMigration because:  Property 'hideChaff' does not exist on\n      // type 'Workspace'.\n      (workspace as AnyDuringMigration).hideChaff();\n      return true;\n    },\n    keyCodes: [KeyCodes.ESC],\n  };\n  ShortcutRegistry.registry.register(escapeAction);\n}\n\n/**\n * Keyboard shortcut to delete a block on delete or backspace\n */\nexport function registerDelete() {\n  const deleteShortcut: KeyboardShortcut = {\n    name: names.DELETE,\n    preconditionFn(workspace) {\n      const selected = common.getSelected();\n      return (\n        !workspace.options.readOnly &&\n        selected != null &&\n        selected.isDeletable()\n      );\n    },\n    callback(workspace, e) {\n      // Delete or backspace.\n      // Stop the browser from going back to the previous page.\n      // Do this first to prevent an error in the delete code from resulting in\n      // data loss.\n      e.preventDefault();\n      // Don't delete while dragging.  Jeez.\n      if (Gesture.inProgress()) {\n        return false;\n      }\n      (common.getSelected() as BlockSvg).checkAndDelete();\n      return true;\n    },\n    keyCodes: [KeyCodes.DELETE, KeyCodes.BACKSPACE],\n  };\n  ShortcutRegistry.registry.register(deleteShortcut);\n}\n\nlet copyData: ICopyData | null = null;\nlet copyWorkspace: WorkspaceSvg | null = null;\n\n/**\n * Keyboard shortcut to copy a block on ctrl+c, cmd+c, or alt+c.\n */\nexport function registerCopy() {\n  const ctrlC = ShortcutRegistry.registry.createSerializedKey(KeyCodes.C, [\n    KeyCodes.CTRL,\n  ]);\n  const altC = ShortcutRegistry.registry.createSerializedKey(KeyCodes.C, [\n    KeyCodes.ALT,\n  ]);\n  const metaC = ShortcutRegistry.registry.createSerializedKey(KeyCodes.C, [\n    KeyCodes.META,\n  ]);\n\n  const copyShortcut: KeyboardShortcut = {\n    name: names.COPY,\n    preconditionFn(workspace) {\n      const selected = common.getSelected();\n      return (\n        !workspace.options.readOnly &&\n        !Gesture.inProgress() &&\n        selected != null &&\n        selected.isDeletable() &&\n        selected.isMovable() &&\n        isCopyable(selected)\n      );\n    },\n    callback(workspace, e) {\n      // Prevent the default copy behavior, which may beep or otherwise indicate\n      // an error due to the lack of a selection.\n      e.preventDefault();\n      workspace.hideChaff();\n      const selected = common.getSelected();\n      if (!selected || !isCopyable(selected)) return false;\n      copyData = selected.toCopyData();\n      copyWorkspace = workspace;\n      return !!copyData;\n    },\n    keyCodes: [ctrlC, altC, metaC],\n  };\n  ShortcutRegistry.registry.register(copyShortcut);\n}\n\n/**\n * Keyboard shortcut to copy and delete a block on ctrl+x, cmd+x, or alt+x.\n */\nexport function registerCut() {\n  const ctrlX = ShortcutRegistry.registry.createSerializedKey(KeyCodes.X, [\n    KeyCodes.CTRL,\n  ]);\n  const altX = ShortcutRegistry.registry.createSerializedKey(KeyCodes.X, [\n    KeyCodes.ALT,\n  ]);\n  const metaX = ShortcutRegistry.registry.createSerializedKey(KeyCodes.X, [\n    KeyCodes.META,\n  ]);\n\n  const cutShortcut: KeyboardShortcut = {\n    name: names.CUT,\n    preconditionFn(workspace) {\n      const selected = common.getSelected();\n      return (\n        !workspace.options.readOnly &&\n        !Gesture.inProgress() &&\n        selected != null &&\n        selected instanceof BlockSvg &&\n        selected.isDeletable() &&\n        selected.isMovable() &&\n        !selected.workspace!.isFlyout\n      );\n    },\n    callback(workspace) {\n      const selected = common.getSelected();\n      if (!selected || !isCopyable(selected)) return false;\n      copyData = selected.toCopyData();\n      copyWorkspace = workspace;\n      (selected as BlockSvg).checkAndDelete();\n      return true;\n    },\n    keyCodes: [ctrlX, altX, metaX],\n  };\n\n  ShortcutRegistry.registry.register(cutShortcut);\n}\n\n/**\n * Keyboard shortcut to paste a block on ctrl+v, cmd+v, or alt+v.\n */\nexport function registerPaste() {\n  const ctrlV = ShortcutRegistry.registry.createSerializedKey(KeyCodes.V, [\n    KeyCodes.CTRL,\n  ]);\n  const altV = ShortcutRegistry.registry.createSerializedKey(KeyCodes.V, [\n    KeyCodes.ALT,\n  ]);\n  const metaV = ShortcutRegistry.registry.createSerializedKey(KeyCodes.V, [\n    KeyCodes.META,\n  ]);\n\n  const pasteShortcut: KeyboardShortcut = {\n    name: names.PASTE,\n    preconditionFn(workspace) {\n      return !workspace.options.readOnly && !Gesture.inProgress();\n    },\n    callback() {\n      if (!copyData || !copyWorkspace) return false;\n      return !!clipboard.paste(copyData, copyWorkspace);\n    },\n    keyCodes: [ctrlV, altV, metaV],\n  };\n\n  ShortcutRegistry.registry.register(pasteShortcut);\n}\n\n/**\n * Keyboard shortcut to undo the previous action on ctrl+z, cmd+z, or alt+z.\n */\nexport function registerUndo() {\n  const ctrlZ = ShortcutRegistry.registry.createSerializedKey(KeyCodes.Z, [\n    KeyCodes.CTRL,\n  ]);\n  const altZ = ShortcutRegistry.registry.createSerializedKey(KeyCodes.Z, [\n    KeyCodes.ALT,\n  ]);\n  const metaZ = ShortcutRegistry.registry.createSerializedKey(KeyCodes.Z, [\n    KeyCodes.META,\n  ]);\n\n  const undoShortcut: KeyboardShortcut = {\n    name: names.UNDO,\n    preconditionFn(workspace) {\n      return !workspace.options.readOnly && !Gesture.inProgress();\n    },\n    callback(workspace) {\n      // 'z' for undo 'Z' is for redo.\n      (workspace as WorkspaceSvg).hideChaff();\n      workspace.undo(false);\n      return true;\n    },\n    keyCodes: [ctrlZ, altZ, metaZ],\n  };\n  ShortcutRegistry.registry.register(undoShortcut);\n}\n\n/**\n * Keyboard shortcut to redo the previous action on ctrl+shift+z, cmd+shift+z,\n * or alt+shift+z.\n */\nexport function registerRedo() {\n  const ctrlShiftZ = ShortcutRegistry.registry.createSerializedKey(KeyCodes.Z, [\n    KeyCodes.SHIFT,\n    KeyCodes.CTRL,\n  ]);\n  const altShiftZ = ShortcutRegistry.registry.createSerializedKey(KeyCodes.Z, [\n    KeyCodes.SHIFT,\n    KeyCodes.ALT,\n  ]);\n  const metaShiftZ = ShortcutRegistry.registry.createSerializedKey(KeyCodes.Z, [\n    KeyCodes.SHIFT,\n    KeyCodes.META,\n  ]);\n  // Ctrl-y is redo in Windows.  Command-y is never valid on Macs.\n  const ctrlY = ShortcutRegistry.registry.createSerializedKey(KeyCodes.Y, [\n    KeyCodes.CTRL,\n  ]);\n\n  const redoShortcut: KeyboardShortcut = {\n    name: names.REDO,\n    preconditionFn(workspace) {\n      return !Gesture.inProgress() && !workspace.options.readOnly;\n    },\n    callback(workspace) {\n      // 'z' for undo 'Z' is for redo.\n      (workspace as WorkspaceSvg).hideChaff();\n      workspace.undo(true);\n      return true;\n    },\n    keyCodes: [ctrlShiftZ, altShiftZ, metaShiftZ, ctrlY],\n  };\n  ShortcutRegistry.registry.register(redoShortcut);\n}\n\n/**\n * Registers all default keyboard shortcut item. This should be called once per\n * instance of KeyboardShortcutRegistry.\n *\n * @internal\n */\nexport function registerDefaultShortcuts() {\n  registerEscape();\n  registerDelete();\n  registerCopy();\n  registerCut();\n  registerPaste();\n  registerUndo();\n  registerRedo();\n}\n\nregisterDefaultShortcuts();\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {IParameterModel} from '../interfaces/i_parameter_model.js';\nimport {IProcedureModel} from '../interfaces/i_procedure_model.js';\nimport type {ISerializer} from '../interfaces/i_serializer.js';\nimport * as priorities from './priorities.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Representation of a procedure data model.\n */\nexport interface State {\n  // TODO: This should also handle enabled.\n  id: string;\n  name: string;\n  returnTypes: string[] | null;\n  parameters?: ParameterState[];\n}\n\n/**\n * Representation of a parameter data model.\n */\nexport interface ParameterState {\n  id: string;\n  name: string;\n  types?: string[];\n}\n\n/**\n * A newable signature for an IProcedureModel.\n *\n * Refer to\n * https://www.typescriptlang.org/docs/handbook/2/generics.html#using-class-types-in-generics\n * for what is going on with this.\n */\ntype ProcedureModelConstructor<ProcedureModel extends IProcedureModel> = new (\n  workspace: Workspace,\n  name: string,\n  id: string,\n) => ProcedureModel;\n\n/**\n * A newable signature for an IParameterModel.\n *\n * Refer to\n * https://www.typescriptlang.org/docs/handbook/2/generics.html#using-class-types-in-generics\n * for what is going on with this.\n */\ntype ParameterModelConstructor<ParameterModel extends IParameterModel> = new (\n  workspace: Workspace,\n  name: string,\n  id: string,\n) => ParameterModel;\n\n/**\n * Serializes the given IProcedureModel to JSON.\n *\n * @internal\n */\nexport function saveProcedure(proc: IProcedureModel): State {\n  const state: State = {\n    id: proc.getId(),\n    name: proc.getName(),\n    returnTypes: proc.getReturnTypes(),\n  };\n  if (!proc.getParameters().length) return state;\n  state.parameters = proc.getParameters().map((param) => saveParameter(param));\n  return state;\n}\n\n/**\n * Serializes the given IParameterModel to JSON.\n *\n * @internal\n */\nexport function saveParameter(param: IParameterModel): ParameterState {\n  const state: ParameterState = {\n    id: param.getId(),\n    name: param.getName(),\n  };\n  if (!param.getTypes().length) return state;\n  state.types = param.getTypes();\n  return state;\n}\n\n/**\n * Deserializes the given procedure model State from JSON.\n *\n * @internal\n */\nexport function loadProcedure<\n  ProcedureModel extends IProcedureModel,\n  ParameterModel extends IParameterModel,\n>(\n  procedureModelClass: ProcedureModelConstructor<ProcedureModel>,\n  parameterModelClass: ParameterModelConstructor<ParameterModel>,\n  state: State,\n  workspace: Workspace,\n): ProcedureModel {\n  const proc = new procedureModelClass(\n    workspace,\n    state.name,\n    state.id,\n  ).setReturnTypes(state.returnTypes);\n  if (!state.parameters) return proc;\n  for (const [index, param] of state.parameters.entries()) {\n    proc.insertParameter(\n      loadParameter(parameterModelClass, param, workspace),\n      index,\n    );\n  }\n  return proc;\n}\n\n/**\n * Deserializes the given ParameterState from JSON.\n *\n * @internal\n */\nexport function loadParameter<ParameterModel extends IParameterModel>(\n  parameterModelClass: ParameterModelConstructor<ParameterModel>,\n  state: ParameterState,\n  workspace: Workspace,\n): ParameterModel {\n  const model = new parameterModelClass(workspace, state.name, state.id);\n  if (state.types) model.setTypes(state.types);\n  return model;\n}\n\n/** Serializer for saving and loading procedure state. */\nexport class ProcedureSerializer<\n  ProcedureModel extends IProcedureModel,\n  ParameterModel extends IParameterModel,\n> implements ISerializer\n{\n  public priority = priorities.PROCEDURES;\n\n  /**\n   * Constructs the procedure serializer.\n   *\n   * Example usage:\n   *   new ProcedureSerializer(MyProcedureModelClass, MyParameterModelClass)\n   *\n   * @param procedureModelClass The class (implementing IProcedureModel) that\n   *     you want this serializer to deserialize.\n   * @param parameterModelClass The class (implementing IParameterModel) that\n   *     you want this serializer to deserialize.\n   */\n  constructor(\n    private readonly procedureModelClass: ProcedureModelConstructor<ProcedureModel>,\n    private readonly parameterModelClass: ParameterModelConstructor<ParameterModel>,\n  ) {}\n\n  /** Serializes the procedure models of the given workspace. */\n  save(workspace: Workspace): State[] | null {\n    const save = workspace\n      .getProcedureMap()\n      .getProcedures()\n      .map((proc) => saveProcedure(proc));\n    return save.length ? save : null;\n  }\n\n  /**\n   * Deserializes the procedures models defined by the given state into the\n   * workspace.\n   */\n  load(state: State[], workspace: Workspace) {\n    const map = workspace.getProcedureMap();\n    for (const procState of state) {\n      map.add(\n        loadProcedure(\n          this.procedureModelClass,\n          this.parameterModelClass,\n          procState,\n          workspace,\n        ),\n      );\n    }\n  }\n\n  /** Disposes of any procedure models that exist on the workspace. */\n  clear(workspace: Workspace) {\n    workspace.getProcedureMap().clear();\n  }\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.serialization.workspaces\n\nimport * as eventUtils from '../events/utils.js';\nimport type {ISerializer} from '../interfaces/i_serializer.js';\nimport * as registry from '../registry.js';\nimport * as dom from '../utils/dom.js';\n// eslint-disable-next-line no-unused-vars\nimport type {Workspace} from '../workspace.js';\nimport {WorkspaceSvg} from '../workspace_svg.js';\n\n/**\n * Returns the state of the workspace as a plain JavaScript object.\n *\n * @param workspace The workspace to serialize.\n * @returns The serialized state of the workspace.\n */\nexport function save(workspace: Workspace): {\n  [key: string]: AnyDuringMigration;\n} {\n  const state = Object.create(null);\n  const serializerMap = registry.getAllItems(registry.Type.SERIALIZER, true);\n  for (const key in serializerMap) {\n    const save = (serializerMap[key] as ISerializer)?.save(workspace);\n    if (save) {\n      state[key] = save;\n    }\n  }\n  return state;\n}\n\n/**\n * Loads the variable represented by the given state into the given workspace.\n *\n * @param state The state of the workspace to deserialize into the workspace.\n * @param workspace The workspace to add the new state to.\n * @param param1 recordUndo: If true, events triggered by this function will be\n *     undo-able by the user. False by default.\n */\nexport function load(\n  state: {[key: string]: AnyDuringMigration},\n  workspace: Workspace,\n  {recordUndo = false}: {recordUndo?: boolean} = {},\n) {\n  const serializerMap = registry.getAllItems(registry.Type.SERIALIZER, true);\n  if (!serializerMap) {\n    return;\n  }\n\n  const deserializers = Object.entries(serializerMap).sort(\n    (a, b) => (b[1] as ISerializer)!.priority - (a[1] as ISerializer)!.priority,\n  );\n\n  const prevRecordUndo = eventUtils.getRecordUndo();\n  eventUtils.setRecordUndo(recordUndo);\n  const existingGroup = eventUtils.getGroup();\n  if (!existingGroup) {\n    eventUtils.setGroup(true);\n  }\n\n  dom.startTextWidthCache();\n  if (workspace instanceof WorkspaceSvg) {\n    workspace.setResizesEnabled(false);\n  }\n\n  // We want to trigger clearing in reverse priority order so plugins don't end\n  // up missing dependencies.\n  for (const [, deserializer] of deserializers.reverse()) {\n    (deserializer as ISerializer)?.clear(workspace);\n  }\n\n  // reverse() is destructive, so we have to re-reverse to correct the order.\n  for (let [name, deserializer] of deserializers.reverse()) {\n    name = name;\n    const pluginState = state[name];\n    if (pluginState) {\n      (deserializer as ISerializer)?.load(state[name], workspace);\n    }\n  }\n\n  if (workspace instanceof WorkspaceSvg) {\n    workspace.setResizesEnabled(true);\n  }\n  dom.stopTextWidthCache();\n\n  eventUtils.fire(new (eventUtils.get(eventUtils.FINISHED_LOADING))(workspace));\n\n  eventUtils.setGroup(existingGroup);\n  eventUtils.setRecordUndo(prevRecordUndo);\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.bumpObjects\n\nimport type {BlockSvg} from './block_svg.js';\nimport type {Abstract} from './events/events_abstract.js';\nimport type {BlockCreate} from './events/events_block_create.js';\nimport type {BlockMove} from './events/events_block_move.js';\nimport type {CommentCreate} from './events/events_comment_create.js';\nimport type {CommentMove} from './events/events_comment_move.js';\nimport type {ViewportChange} from './events/events_viewport.js';\nimport * as eventUtils from './events/utils.js';\nimport type {IBoundedElement} from './interfaces/i_bounded_element.js';\nimport type {ContainerRegion} from './metrics_manager.js';\nimport * as mathUtils from './utils/math.js';\nimport type {WorkspaceCommentSvg} from './workspace_comment_svg.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Bumps the given object that has passed out of bounds.\n *\n * @param workspace The workspace containing the object.\n * @param bounds The region to bump an object into. For example, pass\n *     ScrollMetrics to bump a block into the scrollable region of the\n *     workspace, or pass ViewMetrics to bump a block into the visible region of\n *     the workspace. This should be specified in workspace coordinates.\n * @param object The object to bump.\n * @returns True if object was bumped.\n */\nfunction bumpObjectIntoBounds(\n  workspace: WorkspaceSvg,\n  bounds: ContainerRegion,\n  object: IBoundedElement,\n): boolean {\n  // Compute new top/left position for object.\n  const objectMetrics = object.getBoundingRectangle();\n  const height = objectMetrics.bottom - objectMetrics.top;\n  const width = objectMetrics.right - objectMetrics.left;\n\n  const topClamp = bounds.top;\n  const boundsBottom = bounds.top + bounds.height;\n  const bottomClamp = boundsBottom - height;\n  // If the object is taller than the workspace we want to\n  // top-align the block\n  const newYPosition = mathUtils.clamp(\n    topClamp,\n    objectMetrics.top,\n    bottomClamp,\n  );\n  const deltaY = newYPosition - objectMetrics.top;\n\n  // Note: Even in RTL mode the \"anchor\" of the object is the\n  // top-left corner of the object.\n  let leftClamp = bounds.left;\n  const boundsRight = bounds.left + bounds.width;\n  let rightClamp = boundsRight - width;\n  if (workspace.RTL) {\n    // If the object is wider than the workspace and we're in RTL\n    // mode we want to right-align the block, which means setting\n    // the left clamp to match.\n    leftClamp = Math.min(rightClamp, leftClamp);\n  } else {\n    // If the object is wider than the workspace and we're in LTR\n    // mode we want to left-align the block, which means setting\n    // the right clamp to match.\n    rightClamp = Math.max(leftClamp, rightClamp);\n  }\n  const newXPosition = mathUtils.clamp(\n    leftClamp,\n    objectMetrics.left,\n    rightClamp,\n  );\n  const deltaX = newXPosition - objectMetrics.left;\n\n  if (deltaX || deltaY) {\n    object.moveBy(deltaX, deltaY, ['inbounds']);\n    return true;\n  }\n  return false;\n}\nexport const bumpIntoBounds = bumpObjectIntoBounds;\n\n/**\n * Creates a handler for bumping objects when they cross fixed bounds.\n *\n * @param workspace The workspace to handle.\n * @returns The event handler.\n */\nexport function bumpIntoBoundsHandler(\n  workspace: WorkspaceSvg,\n): (p1: Abstract) => void {\n  return (e) => {\n    const metricsManager = workspace.getMetricsManager();\n    if (!metricsManager.hasFixedEdges() || workspace.isDragging()) {\n      return;\n    }\n\n    if (eventUtils.BUMP_EVENTS.indexOf(e.type ?? '') !== -1) {\n      const scrollMetricsInWsCoords = metricsManager.getScrollMetrics(true);\n\n      // Triggered by move/create event\n      const object = extractObjectFromEvent(\n        workspace,\n        e as eventUtils.BumpEvent,\n      );\n      if (!object) {\n        return;\n      }\n      // Handle undo.\n      const existingGroup = eventUtils.getGroup() || false;\n      eventUtils.setGroup(e.group);\n\n      const wasBumped = bumpObjectIntoBounds(\n        workspace,\n        scrollMetricsInWsCoords,\n        object as IBoundedElement,\n      );\n\n      if (wasBumped && !e.group) {\n        console.warn(\n          'Moved object in bounds but there was no' +\n            ' event group. This may break undo.',\n        );\n      }\n      eventUtils.setGroup(existingGroup);\n    } else if (e.type === eventUtils.VIEWPORT_CHANGE) {\n      const viewportEvent = e as ViewportChange;\n      if (\n        viewportEvent.scale &&\n        viewportEvent.oldScale &&\n        viewportEvent.scale > viewportEvent.oldScale\n      ) {\n        bumpTopObjectsIntoBounds(workspace);\n      }\n    }\n  };\n}\n\n/**\n * Extracts the object from the given event.\n *\n * @param workspace The workspace the event originated\n *    from.\n * @param e An event containing an object.\n * @returns The extracted\n *    object.\n */\nfunction extractObjectFromEvent(\n  workspace: WorkspaceSvg,\n  e: eventUtils.BumpEvent,\n): BlockSvg | null | WorkspaceCommentSvg {\n  let object = null;\n  switch (e.type) {\n    case eventUtils.BLOCK_CREATE:\n    case eventUtils.BLOCK_MOVE:\n      object = workspace.getBlockById((e as BlockCreate | BlockMove).blockId!);\n      if (object) {\n        object = object.getRootBlock();\n      }\n      break;\n    case eventUtils.COMMENT_CREATE:\n    case eventUtils.COMMENT_MOVE:\n      object = workspace.getCommentById(\n        (e as CommentCreate | CommentMove).commentId!,\n      ) as WorkspaceCommentSvg | null;\n      break;\n  }\n  return object;\n}\n\n/**\n * Bumps the top objects in the given workspace into bounds.\n *\n * @param workspace The workspace.\n */\nexport function bumpTopObjectsIntoBounds(workspace: WorkspaceSvg) {\n  const metricsManager = workspace.getMetricsManager();\n  if (!metricsManager.hasFixedEdges() || workspace.isDragging()) {\n    return;\n  }\n\n  const scrollMetricsInWsCoords = metricsManager.getScrollMetrics(true);\n  const topBlocks = workspace.getTopBoundedElements();\n  for (let i = 0, block; (block = topBlocks[i]); i++) {\n    bumpObjectIntoBounds(workspace, scrollMetricsInWsCoords, block);\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Methods for dragging a block visually.\n *\n * @class\n */\n// Former goog.module ID: Blockly.BlockDragger\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_drag.js';\n\nimport * as blockAnimation from './block_animations.js';\nimport type {BlockSvg} from './block_svg.js';\nimport * as bumpObjects from './bump_objects.js';\nimport * as common from './common.js';\nimport type {BlockMove} from './events/events_block_move.js';\nimport * as eventUtils from './events/utils.js';\nimport type {Icon} from './icons/icon.js';\nimport type {IBlockDragger} from './interfaces/i_block_dragger.js';\nimport type {IDragTarget} from './interfaces/i_drag_target.js';\nimport * as registry from './registry.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport {hasBubble} from './interfaces/i_has_bubble.js';\nimport * as deprecation from './utils/deprecation.js';\nimport * as layers from './layers.js';\nimport {ConnectionType, IConnectionPreviewer} from './blockly.js';\nimport {RenderedConnection} from './rendered_connection.js';\nimport {config} from './config.js';\nimport {ComponentManager} from './component_manager.js';\nimport {IDeleteArea} from './interfaces/i_delete_area.js';\nimport {Connection} from './connection.js';\nimport {Block} from './block.js';\nimport {finishQueuedRenders} from './render_management.js';\n\n/** Represents a nearby valid connection. */\ninterface ConnectionCandidate {\n  /** A connection on the dragging stack that is compatible with neighbour. */\n  local: RenderedConnection;\n\n  /** A nearby connection that is compatible with local. */\n  neighbour: RenderedConnection;\n\n  /** The distance between the local connection and the neighbour connection. */\n  distance: number;\n}\n\n/**\n * Class for a block dragger.  It moves blocks around the workspace when they\n * are being dragged by a mouse or touch.\n */\nexport class BlockDragger implements IBlockDragger {\n  /** The top block in the stack that is being dragged. */\n  protected draggingBlock_: BlockSvg;\n\n  protected connectionPreviewer: IConnectionPreviewer;\n\n  /** The workspace on which the block is being dragged. */\n  protected workspace_: WorkspaceSvg;\n\n  /** Which drag area the mouse pointer is over, if any. */\n  private dragTarget_: IDragTarget | null = null;\n\n  private connectionCandidate: ConnectionCandidate | null = null;\n\n  /** Whether the block would be deleted if dropped immediately. */\n  protected wouldDeleteBlock_ = false;\n  protected startXY_: Coordinate;\n\n  /**\n   * @deprecated To be removed in v11. Updating icons is now handled by the\n   *     block's `moveDuringDrag` method.\n   */\n  protected dragIconData_: IconPositionData[] = [];\n\n  /**\n   * @param block The block to drag.\n   * @param workspace The workspace to drag on.\n   */\n  constructor(block: BlockSvg, workspace: WorkspaceSvg) {\n    this.draggingBlock_ = block;\n    this.workspace_ = workspace;\n\n    const previewerConstructor = registry.getClassFromOptions(\n      registry.Type.CONNECTION_PREVIEWER,\n      this.workspace_.options,\n    );\n    this.connectionPreviewer = new previewerConstructor!(block);\n\n    /**\n     * The location of the top left corner of the dragging block at the\n     * beginning of the drag in workspace coordinates.\n     */\n    this.startXY_ = this.draggingBlock_.getRelativeToSurfaceXY();\n\n    this.dragIconData_ = initIconData(block, this.startXY_);\n  }\n\n  /**\n   * Sever all links from this object.\n   *\n   * @internal\n   */\n  dispose() {\n    this.dragIconData_.length = 0;\n    this.connectionPreviewer.dispose();\n  }\n\n  /**\n   * Start dragging a block.\n   *\n   * @param currentDragDeltaXY How far the pointer has moved from the position\n   *     at mouse down, in pixel units.\n   * @param healStack Whether or not to heal the stack after disconnecting.\n   */\n  startDrag(currentDragDeltaXY: Coordinate, healStack: boolean) {\n    if (!eventUtils.getGroup()) {\n      eventUtils.setGroup(true);\n    }\n    this.fireDragStartEvent_();\n\n    // The z-order of blocks depends on their order in the SVG, so move the\n    // block being dragged to the front so that it will appear atop other blocks\n    // in the workspace.\n    this.draggingBlock_.bringToFront(true);\n\n    // During a drag there may be a lot of rerenders, but not field changes.\n    // Turn the cache on so we don't do spurious remeasures during the drag.\n    dom.startTextWidthCache();\n    this.workspace_.setResizesEnabled(false);\n    blockAnimation.disconnectUiStop();\n\n    if (this.shouldDisconnect_(healStack)) {\n      this.disconnectBlock_(healStack, currentDragDeltaXY);\n    }\n    this.draggingBlock_.setDragging(true);\n    this.workspace_.getLayerManager()?.moveToDragLayer(this.draggingBlock_);\n  }\n\n  /**\n   * Whether or not we should disconnect the block when a drag is started.\n   *\n   * @param healStack Whether or not to heal the stack after disconnecting.\n   * @returns True to disconnect the block, false otherwise.\n   */\n  protected shouldDisconnect_(healStack: boolean): boolean {\n    return !!(\n      this.draggingBlock_.getParent() ||\n      (healStack &&\n        this.draggingBlock_.nextConnection &&\n        this.draggingBlock_.nextConnection.targetBlock())\n    );\n  }\n\n  /**\n   * Disconnects the block and moves it to a new location.\n   *\n   * @param healStack Whether or not to heal the stack after disconnecting.\n   * @param currentDragDeltaXY How far the pointer has moved from the position\n   *     at mouse down, in pixel units.\n   */\n  protected disconnectBlock_(\n    healStack: boolean,\n    currentDragDeltaXY: Coordinate,\n  ) {\n    this.draggingBlock_.unplug(healStack);\n    const delta = this.pixelsToWorkspaceUnits_(currentDragDeltaXY);\n    const newLoc = Coordinate.sum(this.startXY_, delta);\n\n    this.draggingBlock_.translate(newLoc.x, newLoc.y);\n    blockAnimation.disconnectUiEffect(this.draggingBlock_);\n  }\n\n  /** Fire a UI event at the start of a block drag. */\n  protected fireDragStartEvent_() {\n    const event = new (eventUtils.get(eventUtils.BLOCK_DRAG))(\n      this.draggingBlock_,\n      true,\n      this.draggingBlock_.getDescendants(false),\n    );\n    eventUtils.fire(event);\n  }\n\n  /**\n   * Execute a step of block dragging, based on the given event.  Update the\n   * display accordingly.\n   *\n   * @param e The most recent move event.\n   * @param delta How far the pointer has moved from the position\n   *     at the start of the drag, in pixel units.\n   */\n  drag(e: PointerEvent, delta: Coordinate) {\n    const block = this.draggingBlock_;\n    this.moveBlock(block, delta);\n    this.updateDragTargets(e, block);\n    this.wouldDeleteBlock_ = this.wouldDeleteBlock(e, block, delta);\n    this.updateCursorDuringBlockDrag_();\n    this.updateConnectionPreview(block, delta);\n  }\n\n  /**\n   * @param draggingBlock The block being dragged.\n   * @param dragDelta How far the pointer has moved from the position\n   *     at the start of the drag, in pixel units.\n   */\n  private moveBlock(draggingBlock: BlockSvg, dragDelta: Coordinate) {\n    const delta = this.pixelsToWorkspaceUnits_(dragDelta);\n    const newLoc = Coordinate.sum(this.startXY_, delta);\n    draggingBlock.moveDuringDrag(newLoc);\n  }\n\n  private updateDragTargets(e: PointerEvent, draggingBlock: BlockSvg) {\n    const newDragTarget = this.workspace_.getDragTarget(e);\n    if (this.dragTarget_ !== newDragTarget) {\n      this.dragTarget_?.onDragExit(draggingBlock);\n      newDragTarget?.onDragEnter(draggingBlock);\n    }\n    newDragTarget?.onDragOver(draggingBlock);\n    this.dragTarget_ = newDragTarget;\n  }\n\n  /**\n   * Returns true if we would delete the block if it was dropped at this time,\n   * false otherwise.\n   *\n   * @param e The most recent move event.\n   * @param draggingBlock The block being dragged.\n   * @param delta How far the pointer has moved from the position\n   *     at the start of the drag, in pixel units.\n   */\n  private wouldDeleteBlock(\n    e: PointerEvent,\n    draggingBlock: BlockSvg,\n    delta: Coordinate,\n  ): boolean {\n    const dragTarget = this.workspace_.getDragTarget(e);\n    if (!dragTarget) return false;\n\n    const componentManager = this.workspace_.getComponentManager();\n    const isDeleteArea = componentManager.hasCapability(\n      dragTarget.id,\n      ComponentManager.Capability.DELETE_AREA,\n    );\n    if (!isDeleteArea) return false;\n\n    return (dragTarget as IDeleteArea).wouldDelete(\n      draggingBlock,\n      !!this.getConnectionCandidate(draggingBlock, delta),\n    );\n  }\n\n  /**\n   * @param draggingBlock The block being dragged.\n   * @param dragDelta How far the pointer has moved from the position\n   *     at the start of the drag, in pixel units.\n   */\n  private updateConnectionPreview(\n    draggingBlock: BlockSvg,\n    dragDelta: Coordinate,\n  ) {\n    const delta = this.pixelsToWorkspaceUnits_(dragDelta);\n    const currCandidate = this.connectionCandidate;\n    const newCandidate = this.getConnectionCandidate(draggingBlock, delta);\n    if (!newCandidate) {\n      this.connectionPreviewer.hidePreview();\n      this.connectionCandidate = null;\n      return;\n    }\n    const candidate =\n      currCandidate &&\n      this.currCandidateIsBetter(currCandidate, delta, newCandidate)\n        ? currCandidate\n        : newCandidate;\n    this.connectionCandidate = candidate;\n    const {local, neighbour} = candidate;\n    if (\n      (local.type === ConnectionType.OUTPUT_VALUE ||\n        local.type === ConnectionType.PREVIOUS_STATEMENT) &&\n      neighbour.isConnected() &&\n      !neighbour.targetBlock()!.isInsertionMarker() &&\n      !this.orphanCanConnectAtEnd(\n        draggingBlock,\n        neighbour.targetBlock()!,\n        local.type,\n      )\n    ) {\n      this.connectionPreviewer.previewReplacement(\n        local,\n        neighbour,\n        neighbour.targetBlock()!,\n      );\n      return;\n    }\n    this.connectionPreviewer.previewConnection(local, neighbour);\n  }\n\n  /**\n   * Returns true if the given orphan block can connect at the end of the\n   * top block's stack or row, false otherwise.\n   */\n  private orphanCanConnectAtEnd(\n    topBlock: BlockSvg,\n    orphanBlock: BlockSvg,\n    localType: number,\n  ): boolean {\n    const orphanConnection =\n      localType === ConnectionType.OUTPUT_VALUE\n        ? orphanBlock.outputConnection\n        : orphanBlock.previousConnection;\n    return !!Connection.getConnectionForOrphanedConnection(\n      topBlock as Block,\n      orphanConnection as Connection,\n    );\n  }\n\n  /**\n   * Returns true if the current candidate is better than the new candidate.\n   *\n   * We slightly prefer the current candidate even if it is farther away.\n   */\n  private currCandidateIsBetter(\n    currCandiate: ConnectionCandidate,\n    delta: Coordinate,\n    newCandidate: ConnectionCandidate,\n  ): boolean {\n    const {local: currLocal, neighbour: currNeighbour} = currCandiate;\n    const localPos = new Coordinate(currLocal.x, currLocal.y);\n    const neighbourPos = new Coordinate(currNeighbour.x, currNeighbour.y);\n    const distance = Coordinate.distance(\n      Coordinate.sum(localPos, delta),\n      neighbourPos,\n    );\n    return (\n      newCandidate.distance > distance - config.currentConnectionPreference\n    );\n  }\n\n  /**\n   * Returns the closest valid candidate connection, if one can be found.\n   *\n   * Valid neighbour connections are within the configured start radius, with a\n   * compatible type (input, output, etc) and connection check.\n   */\n  private getConnectionCandidate(\n    draggingBlock: BlockSvg,\n    delta: Coordinate,\n  ): ConnectionCandidate | null {\n    const localConns = this.getLocalConnections(draggingBlock);\n    let radius = this.connectionCandidate\n      ? config.connectingSnapRadius\n      : config.snapRadius;\n    let candidate = null;\n\n    for (const conn of localConns) {\n      const {connection: neighbour, radius: rad} = conn.closest(radius, delta);\n      if (neighbour) {\n        candidate = {\n          local: conn,\n          neighbour: neighbour,\n          distance: rad,\n        };\n        radius = rad;\n      }\n    }\n\n    return candidate;\n  }\n\n  /**\n   * Returns all of the connections we might connect to blocks on the workspace.\n   *\n   * Includes any connections on the dragging block, and any last next\n   * connection on the stack (if one exists).\n   */\n  private getLocalConnections(draggingBlock: BlockSvg): RenderedConnection[] {\n    const available = draggingBlock.getConnections_(false);\n    const lastOnStack = draggingBlock.lastConnectionInStack(true);\n    if (lastOnStack && lastOnStack !== draggingBlock.nextConnection) {\n      available.push(lastOnStack);\n    }\n    return available;\n  }\n\n  /**\n   * Finish a block drag and put the block back on the workspace.\n   *\n   * @param e The pointerup event.\n   * @param currentDragDeltaXY How far the pointer has moved from the position\n   *     at the start of the drag, in pixel units.\n   */\n  endDrag(e: PointerEvent, currentDragDeltaXY: Coordinate) {\n    // Make sure internal state is fresh.\n    this.drag(e, currentDragDeltaXY);\n    this.fireDragEndEvent_();\n\n    dom.stopTextWidthCache();\n\n    blockAnimation.disconnectUiStop();\n    this.connectionPreviewer.hidePreview();\n\n    const preventMove =\n      !!this.dragTarget_ &&\n      this.dragTarget_.shouldPreventMove(this.draggingBlock_);\n    let delta: Coordinate | null = null;\n    if (!preventMove) {\n      const newValues = this.getNewLocationAfterDrag_(currentDragDeltaXY);\n      delta = newValues.delta;\n    }\n\n    if (this.dragTarget_) {\n      this.dragTarget_.onDrop(this.draggingBlock_);\n    }\n\n    const deleted = this.maybeDeleteBlock_();\n    if (!deleted) {\n      // These are expensive and don't need to be done if we're deleting.\n      this.workspace_\n        .getLayerManager()\n        ?.moveOffDragLayer(this.draggingBlock_, layers.BLOCK);\n      this.draggingBlock_.setDragging(false);\n      if (delta) {\n        // !preventMove\n        this.updateBlockAfterMove_();\n      } else {\n        // Blocks dragged directly from a flyout may need to be bumped into\n        // bounds.\n        bumpObjects.bumpIntoBounds(\n          this.draggingBlock_.workspace,\n          this.workspace_.getMetricsManager().getScrollMetrics(true),\n          this.draggingBlock_,\n        );\n      }\n    }\n    // Must dispose after `updateBlockAfterMove_` is called to not break the\n    // dynamic connections plugin.\n    this.connectionPreviewer.dispose();\n    this.workspace_.setResizesEnabled(true);\n\n    eventUtils.setGroup(false);\n  }\n\n  /**\n   * Calculates the drag delta and new location values after a block is dragged.\n   *\n   * @param currentDragDeltaXY How far the pointer has moved from the start of\n   *     the drag, in pixel units.\n   * @returns New location after drag. delta is in workspace units. newLocation\n   *     is the new coordinate where the block should end up.\n   */\n  protected getNewLocationAfterDrag_(currentDragDeltaXY: Coordinate): {\n    delta: Coordinate;\n    newLocation: Coordinate;\n  } {\n    const delta = this.pixelsToWorkspaceUnits_(currentDragDeltaXY);\n    const newLocation = Coordinate.sum(this.startXY_, delta);\n    return {\n      delta,\n      newLocation,\n    };\n  }\n\n  /**\n   * May delete the dragging block, if allowed. If `this.wouldDeleteBlock_` is\n   * not true, the block will not be deleted. This should be called at the end\n   * of a block drag.\n   *\n   * @returns True if the block was deleted.\n   */\n  protected maybeDeleteBlock_(): boolean {\n    if (this.wouldDeleteBlock_) {\n      // Fire a move event, so we know where to go back to for an undo.\n      this.fireMoveEvent_();\n      this.draggingBlock_.dispose(false, true);\n      common.draggingConnections.length = 0;\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Updates the necessary information to place a block at a certain location.\n   */\n  protected updateBlockAfterMove_() {\n    this.fireMoveEvent_();\n    if (this.connectionCandidate) {\n      // Applying connections also rerenders the relevant blocks.\n      this.applyConnections(this.connectionCandidate);\n    } else {\n      this.draggingBlock_.queueRender();\n    }\n    this.draggingBlock_.scheduleSnapAndBump();\n  }\n\n  private applyConnections(candidate: ConnectionCandidate) {\n    const {local, neighbour} = candidate;\n    local.connect(neighbour);\n    // TODO: We can remove this `rendered` check when we reconcile with v11.\n    if (this.draggingBlock_.rendered) {\n      const inferiorConnection = local.isSuperior() ? neighbour : local;\n      const rootBlock = this.draggingBlock_.getRootBlock();\n\n      finishQueuedRenders().then(() => {\n        blockAnimation.connectionUiEffect(inferiorConnection.getSourceBlock());\n        // bringToFront is incredibly expensive. Delay until the next frame.\n        setTimeout(() => {\n          rootBlock.bringToFront();\n        }, 0);\n      });\n    }\n  }\n\n  /** Fire a UI event at the end of a block drag. */\n  protected fireDragEndEvent_() {\n    const event = new (eventUtils.get(eventUtils.BLOCK_DRAG))(\n      this.draggingBlock_,\n      false,\n      this.draggingBlock_.getDescendants(false),\n    );\n    eventUtils.fire(event);\n  }\n\n  /**\n   * Adds or removes the style of the cursor for the toolbox.\n   * This is what changes the cursor to display an x when a deletable block is\n   * held over the toolbox.\n   *\n   * @param isEnd True if we are at the end of a drag, false otherwise.\n   */\n  protected updateToolboxStyle_(isEnd: boolean) {\n    const toolbox = this.workspace_.getToolbox();\n\n    if (toolbox) {\n      const style = this.draggingBlock_.isDeletable()\n        ? 'blocklyToolboxDelete'\n        : 'blocklyToolboxGrab';\n\n      // AnyDuringMigration because:  Property 'removeStyle' does not exist on\n      // type 'IToolbox'.\n      if (\n        isEnd &&\n        typeof (toolbox as AnyDuringMigration).removeStyle === 'function'\n      ) {\n        // AnyDuringMigration because:  Property 'removeStyle' does not exist on\n        // type 'IToolbox'.\n        (toolbox as AnyDuringMigration).removeStyle(style);\n        // AnyDuringMigration because:  Property 'addStyle' does not exist on\n        // type 'IToolbox'.\n      } else if (\n        !isEnd &&\n        typeof (toolbox as AnyDuringMigration).addStyle === 'function'\n      ) {\n        // AnyDuringMigration because:  Property 'addStyle' does not exist on\n        // type 'IToolbox'.\n        (toolbox as AnyDuringMigration).addStyle(style);\n      }\n    }\n  }\n\n  /** Fire a move event at the end of a block drag. */\n  protected fireMoveEvent_() {\n    if (this.draggingBlock_.isDeadOrDying()) return;\n    const event = new (eventUtils.get(eventUtils.BLOCK_MOVE))(\n      this.draggingBlock_,\n    ) as BlockMove;\n    event.setReason(['drag']);\n    event.oldCoordinate = this.startXY_;\n    event.recordNew();\n    eventUtils.fire(event);\n  }\n\n  /**\n   * Update the cursor (and possibly the trash can lid) to reflect whether the\n   * dragging block would be deleted if released immediately.\n   */\n  protected updateCursorDuringBlockDrag_() {\n    this.draggingBlock_.setDeleteStyle(this.wouldDeleteBlock_);\n  }\n\n  /**\n   * Convert a coordinate object from pixels to workspace units, including a\n   * correction for mutator workspaces.\n   * This function does not consider differing origins.  It simply scales the\n   * input's x and y values.\n   *\n   * @param pixelCoord A coordinate with x and y values in CSS pixel units.\n   * @returns The input coordinate divided by the workspace scale.\n   */\n  protected pixelsToWorkspaceUnits_(pixelCoord: Coordinate): Coordinate {\n    const result = new Coordinate(\n      pixelCoord.x / this.workspace_.scale,\n      pixelCoord.y / this.workspace_.scale,\n    );\n    if (this.workspace_.isMutator) {\n      // If we're in a mutator, its scale is always 1, purely because of some\n      // oddities in our rendering optimizations.  The actual scale is the same\n      // as the scale on the parent workspace. Fix that for dragging.\n      const mainScale = this.workspace_.options.parentWorkspace!.scale;\n      result.scale(1 / mainScale);\n    }\n    return result;\n  }\n\n  /**\n   * Move all of the icons connected to this drag.\n   *\n   * @deprecated To be removed in v11. This is now handled by the block's\n   *     `moveDuringDrag` method.\n   */\n  protected dragIcons_() {\n    deprecation.warn('Blockly.BlockDragger.prototype.dragIcons_', 'v10', 'v11');\n  }\n\n  /**\n   * Get a list of the insertion markers that currently exist.  Drags have 0, 1,\n   * or 2 insertion markers.\n   *\n   * @returns A possibly empty list of insertion marker blocks.\n   */\n  getInsertionMarkers(): BlockSvg[] {\n    return this.workspace_\n      .getAllBlocks()\n      .filter((block) => block.isInsertionMarker());\n  }\n}\n\n/** Data about the position of a given icon. */\nexport interface IconPositionData {\n  location: Coordinate;\n  icon: Icon;\n}\n\n/**\n * Make a list of all of the icons (comment, warning, and mutator) that are\n * on this block and its descendants.  Moving an icon moves the bubble that\n * extends from it if that bubble is open.\n *\n * @param block The root block that is being dragged.\n * @param blockOrigin The top left of the given block in workspace coordinates.\n * @returns The list of all icons and their locations.\n */\nfunction initIconData(\n  block: BlockSvg,\n  blockOrigin: Coordinate,\n): IconPositionData[] {\n  // Build a list of icons that need to be moved and where they started.\n  const dragIconData = [];\n\n  for (const icon of block.getIcons()) {\n    // Only bother to track icons whose bubble is visible.\n    if (hasBubble(icon) && !icon.bubbleIsVisible()) continue;\n\n    dragIconData.push({location: blockOrigin, icon: icon});\n    icon.onLocationChange(blockOrigin);\n  }\n\n  for (const child of block.getChildren(false)) {\n    dragIconData.push(\n      ...initIconData(child, Coordinate.sum(blockOrigin, child.relativeCoords)),\n    );\n  }\n  // AnyDuringMigration because:  Type '{ location: Coordinate | null; icon:\n  // Icon; }[]' is not assignable to type 'IconPositionData[]'.\n  return dragIconData as AnyDuringMigration;\n}\n\nregistry.register(registry.Type.BLOCK_DRAGGER, registry.DEFAULT, BlockDragger);\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.ContextMenuItems\n\nimport type {BlockSvg} from './block_svg.js';\nimport * as clipboard from './clipboard.js';\nimport {\n  ContextMenuRegistry,\n  RegistryItem,\n  Scope,\n} from './contextmenu_registry.js';\nimport * as dialog from './dialog.js';\nimport * as Events from './events/events.js';\nimport * as eventUtils from './events/utils.js';\nimport {CommentIcon} from './icons/comment_icon.js';\nimport {Msg} from './msg.js';\nimport {StatementInput} from './renderers/zelos/zelos.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Option to undo previous action.\n */\nexport function registerUndo() {\n  const undoOption: RegistryItem = {\n    displayText() {\n      return Msg['UNDO'];\n    },\n    preconditionFn(scope: Scope) {\n      if (scope.workspace!.getUndoStack().length > 0) {\n        return 'enabled';\n      }\n      return 'disabled';\n    },\n    callback(scope: Scope) {\n      scope.workspace!.undo(false);\n    },\n    scopeType: ContextMenuRegistry.ScopeType.WORKSPACE,\n    id: 'undoWorkspace',\n    weight: 1,\n  };\n  ContextMenuRegistry.registry.register(undoOption);\n}\n\n/**\n * Option to redo previous action.\n */\nexport function registerRedo() {\n  const redoOption: RegistryItem = {\n    displayText() {\n      return Msg['REDO'];\n    },\n    preconditionFn(scope: Scope) {\n      if (scope.workspace!.getRedoStack().length > 0) {\n        return 'enabled';\n      }\n      return 'disabled';\n    },\n    callback(scope: Scope) {\n      scope.workspace!.undo(true);\n    },\n    scopeType: ContextMenuRegistry.ScopeType.WORKSPACE,\n    id: 'redoWorkspace',\n    weight: 2,\n  };\n  ContextMenuRegistry.registry.register(redoOption);\n}\n\n/**\n * Option to clean up blocks.\n */\nexport function registerCleanup() {\n  const cleanOption: RegistryItem = {\n    displayText() {\n      return Msg['CLEAN_UP'];\n    },\n    preconditionFn(scope: Scope) {\n      if (scope.workspace!.isMovable()) {\n        if (scope.workspace!.getTopBlocks(false).length > 1) {\n          return 'enabled';\n        }\n        return 'disabled';\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      scope.workspace!.cleanUp();\n    },\n    scopeType: ContextMenuRegistry.ScopeType.WORKSPACE,\n    id: 'cleanWorkspace',\n    weight: 3,\n  };\n  ContextMenuRegistry.registry.register(cleanOption);\n}\n/**\n * Creates a callback to collapse or expand top blocks.\n *\n * @param shouldCollapse Whether a block should collapse.\n * @param topBlocks Top blocks in the workspace.\n */\nfunction toggleOption_(shouldCollapse: boolean, topBlocks: BlockSvg[]) {\n  const DELAY = 10;\n  let ms = 0;\n  let timeoutCounter = 0;\n  function timeoutFn(block: BlockSvg) {\n    timeoutCounter--;\n    block.setCollapsed(shouldCollapse);\n    if (timeoutCounter === 0) {\n      Events.setGroup(false);\n    }\n  }\n  Events.setGroup(true);\n  for (let i = 0; i < topBlocks.length; i++) {\n    let block: BlockSvg | null = topBlocks[i];\n    while (block) {\n      timeoutCounter++;\n      setTimeout(timeoutFn.bind(null, block), ms);\n      block = block.getNextBlock();\n      ms += DELAY;\n    }\n  }\n}\n\n/**\n * Option to collapse all blocks.\n */\nexport function registerCollapse() {\n  const collapseOption: RegistryItem = {\n    displayText() {\n      return Msg['COLLAPSE_ALL'];\n    },\n    preconditionFn(scope: Scope) {\n      if (scope.workspace!.options.collapse) {\n        const topBlocks = scope.workspace!.getTopBlocks(false);\n        for (let i = 0; i < topBlocks.length; i++) {\n          let block: BlockSvg | null = topBlocks[i];\n          while (block) {\n            if (!block.isCollapsed()) {\n              return 'enabled';\n            }\n            block = block.getNextBlock();\n          }\n        }\n        return 'disabled';\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      toggleOption_(true, scope.workspace!.getTopBlocks(true));\n    },\n    scopeType: ContextMenuRegistry.ScopeType.WORKSPACE,\n    id: 'collapseWorkspace',\n    weight: 4,\n  };\n  ContextMenuRegistry.registry.register(collapseOption);\n}\n\n/**\n * Option to expand all blocks.\n */\nexport function registerExpand() {\n  const expandOption: RegistryItem = {\n    displayText() {\n      return Msg['EXPAND_ALL'];\n    },\n    preconditionFn(scope: Scope) {\n      if (scope.workspace!.options.collapse) {\n        const topBlocks = scope.workspace!.getTopBlocks(false);\n        for (let i = 0; i < topBlocks.length; i++) {\n          let block: BlockSvg | null = topBlocks[i];\n          while (block) {\n            if (block.isCollapsed()) {\n              return 'enabled';\n            }\n            block = block.getNextBlock();\n          }\n        }\n        return 'disabled';\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      toggleOption_(false, scope.workspace!.getTopBlocks(true));\n    },\n    scopeType: ContextMenuRegistry.ScopeType.WORKSPACE,\n    id: 'expandWorkspace',\n    weight: 5,\n  };\n  ContextMenuRegistry.registry.register(expandOption);\n}\n/**\n * Adds a block and its children to a list of deletable blocks.\n *\n * @param block to delete.\n * @param deleteList list of blocks that can be deleted.\n *     This will be modified in place with the given block and its descendants.\n */\nfunction addDeletableBlocks_(block: BlockSvg, deleteList: BlockSvg[]) {\n  if (block.isDeletable()) {\n    Array.prototype.push.apply(deleteList, block.getDescendants(false));\n  } else {\n    const children = block.getChildren(false);\n    for (let i = 0; i < children.length; i++) {\n      addDeletableBlocks_(children[i], deleteList);\n    }\n  }\n}\n\n/**\n * Constructs a list of blocks that can be deleted in the given workspace.\n *\n * @param workspace to delete all blocks from.\n * @returns list of blocks to delete.\n */\nfunction getDeletableBlocks_(workspace: WorkspaceSvg): BlockSvg[] {\n  const deleteList: BlockSvg[] = [];\n  const topBlocks = workspace.getTopBlocks(true);\n  for (let i = 0; i < topBlocks.length; i++) {\n    addDeletableBlocks_(topBlocks[i], deleteList);\n  }\n  return deleteList;\n}\n\n/**\n * Deletes the given blocks. Used to delete all blocks in the workspace.\n *\n * @param deleteList List of blocks to delete.\n * @param eventGroup Event group ID with which all delete events should be\n *     associated.  If not specified, create a new group.\n */\nfunction deleteNext_(deleteList: BlockSvg[], eventGroup?: string) {\n  const DELAY = 10;\n  if (eventGroup) {\n    eventUtils.setGroup(eventGroup);\n  } else {\n    eventUtils.setGroup(true);\n    eventGroup = eventUtils.getGroup();\n  }\n  const block = deleteList.shift();\n  if (block) {\n    if (!block.isDeadOrDying()) {\n      block.dispose(false, true);\n      setTimeout(deleteNext_, DELAY, deleteList, eventGroup);\n    } else {\n      deleteNext_(deleteList, eventGroup);\n    }\n  }\n  eventUtils.setGroup(false);\n}\n\n/**\n * Option to delete all blocks.\n */\nexport function registerDeleteAll() {\n  const deleteOption: RegistryItem = {\n    displayText(scope: Scope) {\n      if (!scope.workspace) {\n        return '';\n      }\n      const deletableBlocksLength = getDeletableBlocks_(scope.workspace).length;\n      if (deletableBlocksLength === 1) {\n        return Msg['DELETE_BLOCK'];\n      }\n      return Msg['DELETE_X_BLOCKS'].replace('%1', `${deletableBlocksLength}`);\n    },\n    preconditionFn(scope: Scope) {\n      if (!scope.workspace) {\n        return 'disabled';\n      }\n      const deletableBlocksLength = getDeletableBlocks_(scope.workspace).length;\n      return deletableBlocksLength > 0 ? 'enabled' : 'disabled';\n    },\n    callback(scope: Scope) {\n      if (!scope.workspace) {\n        return;\n      }\n      scope.workspace.cancelCurrentGesture();\n      const deletableBlocks = getDeletableBlocks_(scope.workspace);\n      if (deletableBlocks.length < 2) {\n        deleteNext_(deletableBlocks);\n      } else {\n        dialog.confirm(\n          Msg['DELETE_ALL_BLOCKS'].replace(\n            '%1',\n            String(deletableBlocks.length),\n          ),\n          function (ok) {\n            if (ok) {\n              deleteNext_(deletableBlocks);\n            }\n          },\n        );\n      }\n    },\n    scopeType: ContextMenuRegistry.ScopeType.WORKSPACE,\n    id: 'workspaceDelete',\n    weight: 6,\n  };\n  ContextMenuRegistry.registry.register(deleteOption);\n}\n/** Registers all workspace-scoped context menu items. */\nfunction registerWorkspaceOptions_() {\n  registerUndo();\n  registerRedo();\n  registerCleanup();\n  registerCollapse();\n  registerExpand();\n  registerDeleteAll();\n}\n\n/**\n * Option to duplicate a block.\n */\nexport function registerDuplicate() {\n  const duplicateOption: RegistryItem = {\n    displayText() {\n      return Msg['DUPLICATE_BLOCK'];\n    },\n    preconditionFn(scope: Scope) {\n      const block = scope.block;\n      if (!block!.isInFlyout && block!.isDeletable() && block!.isMovable()) {\n        if (block!.isDuplicatable()) {\n          return 'enabled';\n        }\n        return 'disabled';\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      if (!scope.block) return;\n      const data = scope.block.toCopyData();\n      if (!data) return;\n      clipboard.paste(data, scope.block.workspace);\n    },\n    scopeType: ContextMenuRegistry.ScopeType.BLOCK,\n    id: 'blockDuplicate',\n    weight: 1,\n  };\n  ContextMenuRegistry.registry.register(duplicateOption);\n}\n\n/**\n * Option to add or remove block-level comment.\n */\nexport function registerComment() {\n  const commentOption: RegistryItem = {\n    displayText(scope: Scope) {\n      if (scope.block!.hasIcon(CommentIcon.TYPE)) {\n        // If there's already a comment,  option is to remove.\n        return Msg['REMOVE_COMMENT'];\n      }\n      // If there's no comment yet, option is to add.\n      return Msg['ADD_COMMENT'];\n    },\n    preconditionFn(scope: Scope) {\n      const block = scope.block;\n      if (\n        !block!.isInFlyout &&\n        block!.workspace.options.comments &&\n        !block!.isCollapsed() &&\n        block!.isEditable()\n      ) {\n        return 'enabled';\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      const block = scope.block;\n      if (block!.hasIcon(CommentIcon.TYPE)) {\n        block!.setCommentText(null);\n      } else {\n        block!.setCommentText('');\n      }\n    },\n    scopeType: ContextMenuRegistry.ScopeType.BLOCK,\n    id: 'blockComment',\n    weight: 2,\n  };\n  ContextMenuRegistry.registry.register(commentOption);\n}\n\n/**\n * Option to inline variables.\n */\nexport function registerInline() {\n  const inlineOption: RegistryItem = {\n    displayText(scope: Scope) {\n      return scope.block!.getInputsInline()\n        ? Msg['EXTERNAL_INPUTS']\n        : Msg['INLINE_INPUTS'];\n    },\n    preconditionFn(scope: Scope) {\n      const block = scope.block;\n      if (!block!.isInFlyout && block!.isMovable() && !block!.isCollapsed()) {\n        for (let i = 1; i < block!.inputList.length; i++) {\n          // Only display this option if there are two value or dummy inputs\n          // next to each other.\n          if (\n            !(block!.inputList[i - 1] instanceof StatementInput) &&\n            !(block!.inputList[i] instanceof StatementInput)\n          ) {\n            return 'enabled';\n          }\n        }\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      scope.block!.setInputsInline(!scope.block!.getInputsInline());\n    },\n    scopeType: ContextMenuRegistry.ScopeType.BLOCK,\n    id: 'blockInline',\n    weight: 3,\n  };\n  ContextMenuRegistry.registry.register(inlineOption);\n}\n\n/**\n * Option to collapse or expand a block.\n */\nexport function registerCollapseExpandBlock() {\n  const collapseExpandOption: RegistryItem = {\n    displayText(scope: Scope) {\n      return scope.block!.isCollapsed()\n        ? Msg['EXPAND_BLOCK']\n        : Msg['COLLAPSE_BLOCK'];\n    },\n    preconditionFn(scope: Scope) {\n      const block = scope.block;\n      if (\n        !block!.isInFlyout &&\n        block!.isMovable() &&\n        block!.workspace.options.collapse\n      ) {\n        return 'enabled';\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      scope.block!.setCollapsed(!scope.block!.isCollapsed());\n    },\n    scopeType: ContextMenuRegistry.ScopeType.BLOCK,\n    id: 'blockCollapseExpand',\n    weight: 4,\n  };\n  ContextMenuRegistry.registry.register(collapseExpandOption);\n}\n\n/**\n * Option to disable or enable a block.\n */\nexport function registerDisable() {\n  const disableOption: RegistryItem = {\n    displayText(scope: Scope) {\n      return scope.block!.isEnabled()\n        ? Msg['DISABLE_BLOCK']\n        : Msg['ENABLE_BLOCK'];\n    },\n    preconditionFn(scope: Scope) {\n      const block = scope.block;\n      if (\n        !block!.isInFlyout &&\n        block!.workspace.options.disable &&\n        block!.isEditable()\n      ) {\n        if (block!.getInheritedDisabled()) {\n          return 'disabled';\n        }\n        return 'enabled';\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      const block = scope.block;\n      const existingGroup = eventUtils.getGroup();\n      if (!existingGroup) {\n        eventUtils.setGroup(true);\n      }\n      block!.setEnabled(!block!.isEnabled());\n      eventUtils.setGroup(existingGroup);\n    },\n    scopeType: ContextMenuRegistry.ScopeType.BLOCK,\n    id: 'blockDisable',\n    weight: 5,\n  };\n  ContextMenuRegistry.registry.register(disableOption);\n}\n\n/**\n * Option to delete a block.\n */\nexport function registerDelete() {\n  const deleteOption: RegistryItem = {\n    displayText(scope: Scope) {\n      const block = scope.block;\n      // Count the number of blocks that are nested in this block.\n      let descendantCount = block!.getDescendants(false).length;\n      const nextBlock = block!.getNextBlock();\n      if (nextBlock) {\n        // Blocks in the current stack would survive this block's deletion.\n        descendantCount -= nextBlock.getDescendants(false).length;\n      }\n      return descendantCount === 1\n        ? Msg['DELETE_BLOCK']\n        : Msg['DELETE_X_BLOCKS'].replace('%1', `${descendantCount}`);\n    },\n    preconditionFn(scope: Scope) {\n      if (!scope.block!.isInFlyout && scope.block!.isDeletable()) {\n        return 'enabled';\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      if (scope.block) {\n        scope.block.checkAndDelete();\n      }\n    },\n    scopeType: ContextMenuRegistry.ScopeType.BLOCK,\n    id: 'blockDelete',\n    weight: 6,\n  };\n  ContextMenuRegistry.registry.register(deleteOption);\n}\n\n/**\n * Option to open help for a block.\n */\nexport function registerHelp() {\n  const helpOption: RegistryItem = {\n    displayText() {\n      return Msg['HELP'];\n    },\n    preconditionFn(scope: Scope) {\n      const block = scope.block;\n      const url =\n        typeof block!.helpUrl === 'function'\n          ? block!.helpUrl()\n          : block!.helpUrl;\n      if (url) {\n        return 'enabled';\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      scope.block!.showHelp();\n    },\n    scopeType: ContextMenuRegistry.ScopeType.BLOCK,\n    id: 'blockHelp',\n    weight: 7,\n  };\n  ContextMenuRegistry.registry.register(helpOption);\n}\n\n/** Registers all block-scoped context menu items. */\nfunction registerBlockOptions_() {\n  registerDuplicate();\n  registerComment();\n  registerInline();\n  registerCollapseExpandBlock();\n  registerDisable();\n  registerDelete();\n  registerHelp();\n}\n\n/**\n * Registers all default context menu items. This should be called once per\n * instance of ContextMenuRegistry.\n *\n * @internal\n */\nexport function registerDefaultOptions() {\n  registerWorkspaceOptions_();\n  registerBlockOptions_();\n}\n\nregisterDefaultOptions();\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.inject\n\nimport type {BlocklyOptions} from './blockly_options.js';\nimport * as browserEvents from './browser_events.js';\nimport * as bumpObjects from './bump_objects.js';\nimport * as common from './common.js';\nimport * as Css from './css.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport {Grid} from './grid.js';\nimport {Msg} from './msg.js';\nimport {Options} from './options.js';\nimport {ScrollbarPair} from './scrollbar_pair.js';\nimport {ShortcutRegistry} from './shortcut_registry.js';\nimport * as Tooltip from './tooltip.js';\nimport * as Touch from './touch.js';\nimport * as aria from './utils/aria.js';\nimport * as dom from './utils/dom.js';\nimport {Svg} from './utils/svg.js';\nimport * as userAgent from './utils/useragent.js';\nimport * as WidgetDiv from './widgetdiv.js';\nimport {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Inject a Blockly editor into the specified container element (usually a div).\n *\n * @param container Containing element, or its ID, or a CSS selector.\n * @param opt_options Optional dictionary of options.\n * @returns Newly created main workspace.\n */\nexport function inject(\n  container: Element | string,\n  opt_options?: BlocklyOptions,\n): WorkspaceSvg {\n  let containerElement: Element | null = null;\n  if (typeof container === 'string') {\n    containerElement =\n      document.getElementById(container) || document.querySelector(container);\n  } else {\n    containerElement = container;\n  }\n  // Verify that the container is in document.\n  if (\n    !document.contains(containerElement) &&\n    document !== containerElement?.ownerDocument\n  ) {\n    throw Error('Error: container is not in current document');\n  }\n  const options = new Options(opt_options || ({} as BlocklyOptions));\n  const subContainer = document.createElement('div');\n  subContainer.className = 'injectionDiv';\n  subContainer.tabIndex = 0;\n  aria.setState(subContainer, aria.State.LABEL, Msg['WORKSPACE_ARIA_LABEL']);\n\n  containerElement!.appendChild(subContainer);\n  const svg = createDom(subContainer, options);\n\n  const workspace = createMainWorkspace(subContainer, svg, options);\n\n  init(workspace);\n\n  // Keep focus on the first workspace so entering keyboard navigation looks\n  // correct.\n  common.setMainWorkspace(workspace);\n\n  common.svgResize(workspace);\n\n  subContainer.addEventListener('focusin', function () {\n    common.setMainWorkspace(workspace);\n  });\n\n  return workspace;\n}\n\n/**\n * Create the SVG image.\n *\n * @param container Containing element.\n * @param options Dictionary of options.\n * @returns Newly created SVG image.\n */\nfunction createDom(container: Element, options: Options): SVGElement {\n  // Sadly browsers (Chrome vs Firefox) are currently inconsistent in laying\n  // out content in RTL mode.  Therefore Blockly forces the use of LTR,\n  // then manually positions content in RTL as needed.\n  container.setAttribute('dir', 'LTR');\n\n  // Load CSS.\n  Css.inject(options.hasCss, options.pathToMedia);\n\n  // Build the SVG DOM.\n  /*\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      xmlns:html=\"http://www.w3.org/1999/xhtml\"\n      xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n      version=\"1.1\"\n      class=\"blocklySvg\">\n      ...\n    </svg>\n    */\n  const svg = dom.createSvgElement(\n    Svg.SVG,\n    {\n      'xmlns': dom.SVG_NS,\n      'xmlns:html': dom.HTML_NS,\n      'xmlns:xlink': dom.XLINK_NS,\n      'version': '1.1',\n      'class': 'blocklySvg',\n      'tabindex': '0',\n    },\n    container,\n  );\n  /*\n    <defs>\n      ... filters go here ...\n    </defs>\n    */\n  const defs = dom.createSvgElement(Svg.DEFS, {}, svg);\n  // Each filter/pattern needs a unique ID for the case of multiple Blockly\n  // instances on a page.  Browser behaviour becomes undefined otherwise.\n  // https://neil.fraser.name/news/2015/11/01/\n  const rnd = String(Math.random()).substring(2);\n\n  options.gridPattern = Grid.createDom(rnd, options.gridOptions, defs);\n  return svg;\n}\n\n/**\n * Create a main workspace and add it to the SVG.\n *\n * @param svg SVG element with pattern defined.\n * @param options Dictionary of options.\n * @returns Newly created main workspace.\n */\nfunction createMainWorkspace(\n  injectionDiv: Element,\n  svg: SVGElement,\n  options: Options,\n): WorkspaceSvg {\n  options.parentWorkspace = null;\n  const mainWorkspace = new WorkspaceSvg(options);\n  const wsOptions = mainWorkspace.options;\n  mainWorkspace.scale = wsOptions.zoomOptions.startScale;\n  svg.appendChild(\n    mainWorkspace.createDom('blocklyMainBackground', injectionDiv),\n  );\n\n  // Set the theme name and renderer name onto the injection div.\n  const rendererClassName = mainWorkspace.getRenderer().getClassName();\n  if (rendererClassName) {\n    dom.addClass(injectionDiv, rendererClassName);\n  }\n  const themeClassName = mainWorkspace.getTheme().getClassName();\n  if (themeClassName) {\n    dom.addClass(injectionDiv, themeClassName);\n  }\n\n  if (!wsOptions.hasCategories && wsOptions.languageTree) {\n    // Add flyout as an <svg> that is a sibling of the workspace SVG.\n    const flyout = mainWorkspace.addFlyout(Svg.SVG);\n    dom.insertAfter(flyout, svg);\n  }\n  if (wsOptions.hasTrashcan) {\n    mainWorkspace.addTrashcan();\n  }\n  if (wsOptions.zoomOptions && wsOptions.zoomOptions.controls) {\n    mainWorkspace.addZoomControls();\n  }\n  // Register the workspace svg as a UI component.\n  mainWorkspace\n    .getThemeManager()\n    .subscribe(svg, 'workspaceBackgroundColour', 'background-color');\n\n  // A null translation will also apply the correct initial scale.\n  mainWorkspace.translate(0, 0);\n\n  mainWorkspace.addChangeListener(\n    bumpObjects.bumpIntoBoundsHandler(mainWorkspace),\n  );\n\n  // The SVG is now fully assembled.\n  common.svgResize(mainWorkspace);\n  WidgetDiv.createDom();\n  dropDownDiv.createDom();\n  Tooltip.createDom();\n  return mainWorkspace;\n}\n\n/**\n * Initialize Blockly with various handlers.\n *\n * @param mainWorkspace Newly created main workspace.\n */\nfunction init(mainWorkspace: WorkspaceSvg) {\n  const options = mainWorkspace.options;\n  const svg = mainWorkspace.getParentSvg();\n\n  // Suppress the browser's context menu.\n  browserEvents.conditionalBind(\n    svg.parentNode as Element,\n    'contextmenu',\n    null,\n    function (e: Event) {\n      if (!browserEvents.isTargetInput(e)) {\n        e.preventDefault();\n      }\n    },\n  );\n\n  const workspaceResizeHandler = browserEvents.conditionalBind(\n    window,\n    'resize',\n    null,\n    function () {\n      // Don't hide all the chaff. Leave the dropdown and widget divs open if\n      // possible.\n      Tooltip.hide();\n      mainWorkspace.hideComponents(true);\n      dropDownDiv.repositionForWindowResize();\n      WidgetDiv.repositionForWindowResize();\n      common.svgResize(mainWorkspace);\n      bumpObjects.bumpTopObjectsIntoBounds(mainWorkspace);\n    },\n  );\n  mainWorkspace.setResizeHandlerWrapper(workspaceResizeHandler);\n\n  bindDocumentEvents();\n\n  if (options.languageTree) {\n    const toolbox = mainWorkspace.getToolbox();\n    const flyout = mainWorkspace.getFlyout(true);\n    if (toolbox) {\n      toolbox.init();\n    } else if (flyout) {\n      // Build a fixed flyout with the root blocks.\n      flyout.init(mainWorkspace);\n      flyout.show(options.languageTree);\n      if (typeof flyout.scrollToStart === 'function') {\n        flyout.scrollToStart();\n      }\n    }\n  }\n\n  if (options.hasTrashcan) {\n    mainWorkspace.trashcan!.init();\n  }\n  if (options.zoomOptions && options.zoomOptions.controls) {\n    mainWorkspace.zoomControls_!.init();\n  }\n\n  if (options.moveOptions && options.moveOptions.scrollbars) {\n    const horizontalScroll =\n      options.moveOptions.scrollbars === true ||\n      !!options.moveOptions.scrollbars.horizontal;\n    const verticalScroll =\n      options.moveOptions.scrollbars === true ||\n      !!options.moveOptions.scrollbars.vertical;\n    mainWorkspace.scrollbar = new ScrollbarPair(\n      mainWorkspace,\n      horizontalScroll,\n      verticalScroll,\n      'blocklyMainWorkspaceScrollbar',\n    );\n    mainWorkspace.scrollbar.resize();\n  } else {\n    mainWorkspace.setMetrics({x: 0.5, y: 0.5});\n  }\n\n  // Load the sounds.\n  if (options.hasSounds) {\n    loadSounds(options.pathToMedia, mainWorkspace);\n  }\n}\n\n/**\n * Handle a key-down on SVG drawing surface. Does nothing if the main workspace\n * is not visible.\n *\n * @param e Key down event.\n */\n// TODO (https://github.com/google/blockly/issues/1998) handle cases where there\n// are multiple workspaces and non-main workspaces are able to accept input.\nfunction onKeyDown(e: KeyboardEvent) {\n  const mainWorkspace = common.getMainWorkspace() as WorkspaceSvg;\n  if (!mainWorkspace) {\n    return;\n  }\n\n  if (\n    browserEvents.isTargetInput(e) ||\n    (mainWorkspace.rendered && !mainWorkspace.isVisible())\n  ) {\n    // When focused on an HTML text input widget, don't trap any keys.\n    // Ignore keypresses on rendered workspaces that have been explicitly\n    // hidden.\n    return;\n  }\n  ShortcutRegistry.registry.onKeyDown(mainWorkspace, e);\n}\n\n/**\n * Whether event handlers have been bound. Document event handlers will only\n * be bound once, even if Blockly is destroyed and reinjected.\n */\nlet documentEventsBound = false;\n\n/**\n * Bind document events, but only once.  Destroying and reinjecting Blockly\n * should not bind again.\n * Bind events for scrolling the workspace.\n * Most of these events should be bound to the SVG's surface.\n * However, 'mouseup' has to be on the whole document so that a block dragged\n * out of bounds and released will know that it has been released.\n * Also, 'keydown' has to be on the whole document since the browser doesn't\n * understand a concept of focus on the SVG image.\n */\nfunction bindDocumentEvents() {\n  if (!documentEventsBound) {\n    browserEvents.conditionalBind(document, 'scroll', null, function () {\n      const workspaces = common.getAllWorkspaces();\n      for (let i = 0, workspace; (workspace = workspaces[i]); i++) {\n        if (workspace instanceof WorkspaceSvg) {\n          workspace.updateInverseScreenCTM();\n        }\n      }\n    });\n    browserEvents.conditionalBind(document, 'keydown', null, onKeyDown);\n    // longStop needs to run to stop the context menu from showing up.  It\n    // should run regardless of what other touch event handlers have run.\n    browserEvents.bind(document, 'touchend', null, Touch.longStop);\n    browserEvents.bind(document, 'touchcancel', null, Touch.longStop);\n    // Some iPad versions don't fire resize after portrait to landscape change.\n    if (userAgent.IPAD) {\n      browserEvents.conditionalBind(\n        window,\n        'orientationchange',\n        document,\n        function () {\n          // TODO (#397): Fix for multiple Blockly workspaces.\n          common.svgResize(common.getMainWorkspace() as WorkspaceSvg);\n        },\n      );\n    }\n  }\n  documentEventsBound = true;\n}\n\n/**\n * Load sounds for the given workspace.\n *\n * @param pathToMedia The path to the media directory.\n * @param workspace The workspace to load sounds for.\n */\nfunction loadSounds(pathToMedia: string, workspace: WorkspaceSvg) {\n  const audioMgr = workspace.getAudioManager();\n  audioMgr.load(\n    [\n      pathToMedia + 'click.mp3',\n      pathToMedia + 'click.wav',\n      pathToMedia + 'click.ogg',\n    ],\n    'click',\n  );\n  audioMgr.load(\n    [\n      pathToMedia + 'disconnect.wav',\n      pathToMedia + 'disconnect.mp3',\n      pathToMedia + 'disconnect.ogg',\n    ],\n    'disconnect',\n  );\n  audioMgr.load(\n    [\n      pathToMedia + 'delete.mp3',\n      pathToMedia + 'delete.ogg',\n      pathToMedia + 'delete.wav',\n    ],\n    'delete',\n  );\n\n  // Bind temporary hooks that preload the sounds.\n  const soundBinds: browserEvents.Data[] = [];\n  /**\n   *\n   */\n  function unbindSounds() {\n    while (soundBinds.length) {\n      const oldSoundBinding = soundBinds.pop();\n      if (oldSoundBinding) {\n        browserEvents.unbind(oldSoundBinding);\n      }\n    }\n    audioMgr.preload();\n  }\n\n  // These are bound on mouse/touch events with\n  // Blockly.browserEvents.conditionalBind, so they restrict the touch\n  // identifier that will be recognized.  But this is really something that\n  // happens on a click, not a drag, so that's not necessary.\n\n  // Android ignores any sound not loaded as a result of a user action.\n  soundBinds.push(\n    browserEvents.conditionalBind(\n      document,\n      'pointermove',\n      null,\n      unbindSounds,\n      true,\n    ),\n  );\n  soundBinds.push(\n    browserEvents.conditionalBind(\n      document,\n      'touchstart',\n      null,\n      unbindSounds,\n      true,\n    ),\n  );\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {IconType} from '../icons/icon_types.js';\nimport type {Coordinate} from '../utils/coordinate.js';\nimport type {Size} from '../utils/size.js';\n\nexport interface IIcon {\n  /**\n   * @returns the IconType representing the type of the icon. This value should\n   *     also be used to register the icon via `Blockly.icons.registry.register`.\n   */\n  getType(): IconType<IIcon>;\n\n  /**\n   * Creates the SVG elements for the icon that will live on the block.\n   *\n   * @param pointerdownListener An event listener that must be attached to the\n   *     root SVG element by the implementation of `initView`. Used by Blockly's\n   *     gesture system to properly handle clicks and drags.\n   */\n  initView(pointerdownListener: (e: PointerEvent) => void): void;\n\n  /**\n   * Disposes of any elements of the icon.\n   *\n   * @remarks\n   *\n   * In particular, if this icon is currently showing a bubble, this should be\n   * used to hide it.\n   */\n  dispose(): void;\n\n  /**\n   * @returns the \"weight\" of the icon, which determines the static order which\n   *     icons should be rendered in. More positive numbers are rendered farther\n   *     toward the end of the block.\n   */\n  getWeight(): number;\n\n  /** @returns The dimensions of the icon for use in rendering. */\n  getSize(): Size;\n\n  /** Updates the icon's color when the block's color changes.. */\n  applyColour(): void;\n\n  /** Hides the icon when it is part of an insertion marker. */\n  hideForInsertionMarker(): void;\n\n  /** Updates the icon's editability when the block's editability changes. */\n  updateEditable(): void;\n\n  /**\n   * Updates the icon's collapsed-ness/view when the block's collapsed-ness\n   * changes.\n   */\n  updateCollapsed(): void;\n\n  /**\n   * @returns Whether this icon is shown when the block is collapsed. Used\n   *     to allow renderers to account for padding.\n   */\n  isShownWhenCollapsed(): boolean;\n\n  /**\n   * Notifies the icon where it is relative to its block's top-start, in\n   * workspace units.\n   */\n  setOffsetInBlock(offset: Coordinate): void;\n\n  /**\n   * Notifies the icon that it has changed locations.\n   *\n   * @param blockOrigin The location of this icon's block's top-start corner\n   *     in workspace coordinates.\n   */\n  onLocationChange(blockOrigin: Coordinate): void;\n\n  /**\n   * Notifies the icon that it has been clicked.\n   */\n  onClick(): void;\n\n  /**\n   * Check whether the icon should be clickable while the block is in a flyout.\n   * If this function is not defined, the icon will be clickable in all flyouts.\n   *\n   * @param autoClosingFlyout true if the containing flyout is an auto-closing one.\n   * @returns Whether the icon should be clickable while the block is in a flyout.\n   */\n  isClickableInFlyout?(autoClosingFlyout: boolean): boolean;\n}\n\n/** Type guard that checks whether the given object is an IIcon. */\nexport function isIcon(obj: any): obj is IIcon {\n  return (\n    obj.getType !== undefined &&\n    obj.initView !== undefined &&\n    obj.dispose !== undefined &&\n    obj.getWeight !== undefined &&\n    obj.getSize !== undefined &&\n    obj.applyColour !== undefined &&\n    obj.hideForInsertionMarker !== undefined &&\n    obj.updateEditable !== undefined &&\n    obj.updateCollapsed !== undefined &&\n    obj.isShownWhenCollapsed !== undefined &&\n    obj.setOffsetInBlock !== undefined &&\n    obj.onLocationChange !== undefined &&\n    obj.onClick !== undefined\n  );\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {Coordinate} from '../utils/coordinate.js';\nimport {WorkspaceSvg} from '../workspace_svg.js';\nimport {ICopyable, ICopyData} from './i_copyable.js';\n\n/** An object that can paste data into a workspace. */\nexport interface IPaster<U extends ICopyData, T extends ICopyable<U>> {\n  paste(\n    copyData: U,\n    workspace: WorkspaceSvg,\n    coordinate?: Coordinate,\n  ): T | null;\n}\n\n/** @returns True if the given object is a paster. */\nexport function isPaster(\n  obj: any,\n): obj is IPaster<ICopyData, ICopyable<ICopyData>> {\n  return obj.paste !== undefined;\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {FlyoutItemInfoArray} from '../utils/toolbox';\n// Former goog.module ID: Blockly.ISelectableToolboxItem\n\nimport type {IToolboxItem} from './i_toolbox_item.js';\n\n/**\n * Interface for an item in the toolbox that can be selected.\n */\nexport interface ISelectableToolboxItem extends IToolboxItem {\n  /**\n   * Gets the name of the toolbox item. Used for emitting events.\n   *\n   * @returns The name of the toolbox item.\n   */\n  getName(): string;\n\n  /**\n   * Gets the contents of the toolbox item. These are items that are meant to be\n   * displayed in the flyout.\n   *\n   * @returns The definition of items to be displayed in the flyout.\n   */\n  getContents(): FlyoutItemInfoArray | string;\n\n  /**\n   * Sets the current toolbox item as selected.\n   *\n   * @param _isSelected True if this category is selected, false otherwise.\n   */\n  setSelected(_isSelected: boolean): void;\n\n  /**\n   * Gets the HTML element that is clickable.\n   * The parent toolbox element receives clicks. The parent toolbox will add an\n   * ID to this element so it can pass the onClick event to the correct\n   * toolboxItem.\n   *\n   * @returns The HTML element that receives clicks.\n   */\n  getClickTarget(): Element;\n\n  /**\n   * Handles when the toolbox item is clicked.\n   *\n   * @param _e Click event to handle.\n   */\n  onClick(_e: Event): void;\n}\n\n/**\n * Type guard that checks whether an IToolboxItem is an ISelectableToolboxItem.\n */\nexport function isSelectableToolboxItem(\n  toolboxItem: IToolboxItem,\n): toolboxItem is ISelectableToolboxItem {\n  return toolboxItem.isSelectable();\n}\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_create.js';\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/workspace_events.js';\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_ui_base.js';\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_var_create.js';\n\nimport {Block} from './block.js';\nimport * as blockAnimations from './block_animations.js';\nimport {BlockDragger} from './block_dragger.js';\nimport {BlockSvg} from './block_svg.js';\nimport {BlocklyOptions} from './blockly_options.js';\nimport {Blocks} from './blocks.js';\nimport * as browserEvents from './browser_events.js';\nimport {Bubble} from './bubbles/bubble.js';\nimport * as bubbles from './bubbles.js';\nimport {BubbleDragger} from './bubble_dragger.js';\nimport * as bumpObjects from './bump_objects.js';\nimport * as clipboard from './clipboard.js';\nimport * as common from './common.js';\nimport {ComponentManager} from './component_manager.js';\nimport {config} from './config.js';\nimport {Connection} from './connection.js';\nimport {ConnectionChecker} from './connection_checker.js';\nimport {ConnectionDB} from './connection_db.js';\nimport {ConnectionType} from './connection_type.js';\nimport * as ContextMenu from './contextmenu.js';\nimport * as ContextMenuItems from './contextmenu_items.js';\nimport {ContextMenuRegistry} from './contextmenu_registry.js';\nimport * as Css from './css.js';\nimport {DeleteArea} from './delete_area.js';\nimport * as dialog from './dialog.js';\nimport {DragTarget} from './drag_target.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport * as Events from './events/events.js';\nimport * as Extensions from './extensions.js';\nimport {\n  Field,\n  FieldConfig,\n  FieldValidator,\n  UnattachedFieldError,\n} from './field.js';\nimport {\n  FieldAngle,\n  FieldAngleConfig,\n  FieldAngleFromJsonConfig,\n  FieldAngleValidator,\n} from './field_angle.js';\nimport {\n  FieldCheckbox,\n  FieldCheckboxConfig,\n  FieldCheckboxFromJsonConfig,\n  FieldCheckboxValidator,\n} from './field_checkbox.js';\nimport {\n  FieldColour,\n  FieldColourConfig,\n  FieldColourFromJsonConfig,\n  FieldColourValidator,\n} from './field_colour.js';\nimport {\n  FieldDropdown,\n  FieldDropdownConfig,\n  FieldDropdownFromJsonConfig,\n  FieldDropdownValidator,\n  MenuGenerator,\n  MenuGeneratorFunction,\n  MenuOption,\n} from './field_dropdown.js';\nimport {\n  FieldImage,\n  FieldImageConfig,\n  FieldImageFromJsonConfig,\n} from './field_image.js';\nimport {\n  FieldLabel,\n  FieldLabelConfig,\n  FieldLabelFromJsonConfig,\n} from './field_label.js';\nimport {FieldLabelSerializable} from './field_label_serializable.js';\nimport {\n  FieldMultilineInput,\n  FieldMultilineInputConfig,\n  FieldMultilineInputFromJsonConfig,\n  FieldMultilineInputValidator,\n} from './field_multilineinput.js';\nimport {\n  FieldNumber,\n  FieldNumberConfig,\n  FieldNumberFromJsonConfig,\n  FieldNumberValidator,\n} from './field_number.js';\nimport * as fieldRegistry from './field_registry.js';\nimport {\n  FieldTextInput,\n  FieldTextInputConfig,\n  FieldTextInputFromJsonConfig,\n  FieldTextInputValidator,\n} from './field_textinput.js';\nimport {\n  FieldVariable,\n  FieldVariableConfig,\n  FieldVariableFromJsonConfig,\n  FieldVariableValidator,\n} from './field_variable.js';\nimport {Flyout} from './flyout_base.js';\nimport {FlyoutButton} from './flyout_button.js';\nimport {HorizontalFlyout} from './flyout_horizontal.js';\nimport {FlyoutMetricsManager} from './flyout_metrics_manager.js';\nimport {VerticalFlyout} from './flyout_vertical.js';\nimport {CodeGenerator} from './generator.js';\nimport {Gesture} from './gesture.js';\nimport {Grid} from './grid.js';\nimport * as icons from './icons.js';\nimport {inject} from './inject.js';\nimport {Align} from './inputs/align.js';\nimport {Input} from './inputs/input.js';\nimport {inputTypes} from './inputs/input_types.js';\nimport * as inputs from './inputs.js';\nimport {InsertionMarkerManager} from './insertion_marker_manager.js';\nimport {InsertionMarkerPreviewer} from './connection_previewers/insertion_marker_previewer.js';\nimport {IASTNodeLocation} from './interfaces/i_ast_node_location.js';\nimport {IASTNodeLocationSvg} from './interfaces/i_ast_node_location_svg.js';\nimport {IASTNodeLocationWithBlock} from './interfaces/i_ast_node_location_with_block.js';\nimport {IAutoHideable} from './interfaces/i_autohideable.js';\nimport {IBlockDragger} from './interfaces/i_block_dragger.js';\nimport {IBoundedElement} from './interfaces/i_bounded_element.js';\nimport {IBubble} from './interfaces/i_bubble.js';\nimport {ICollapsibleToolboxItem} from './interfaces/i_collapsible_toolbox_item.js';\nimport {IComponent} from './interfaces/i_component.js';\nimport {IConnectionChecker} from './interfaces/i_connection_checker.js';\nimport {IConnectionPreviewer} from './interfaces/i_connection_previewer.js';\nimport {IContextMenu} from './interfaces/i_contextmenu.js';\nimport {ICopyable, isCopyable} from './interfaces/i_copyable.js';\nimport {IDeletable} from './interfaces/i_deletable.js';\nimport {IDeleteArea} from './interfaces/i_delete_area.js';\nimport {IDragTarget} from './interfaces/i_drag_target.js';\nimport {IDraggable} from './interfaces/i_draggable.js';\nimport {IFlyout} from './interfaces/i_flyout.js';\nimport {IHasBubble, hasBubble} from './interfaces/i_has_bubble.js';\nimport {IIcon, isIcon} from './interfaces/i_icon.js';\nimport {IKeyboardAccessible} from './interfaces/i_keyboard_accessible.js';\nimport {IMetricsManager} from './interfaces/i_metrics_manager.js';\nimport {IMovable} from './interfaces/i_movable.js';\nimport {IObservable, isObservable} from './interfaces/i_observable.js';\nimport {IPaster, isPaster} from './interfaces/i_paster.js';\nimport {IPositionable} from './interfaces/i_positionable.js';\nimport {IRegistrable} from './interfaces/i_registrable.js';\nimport {ISelectable} from './interfaces/i_selectable.js';\nimport {ISelectableToolboxItem} from './interfaces/i_selectable_toolbox_item.js';\nimport {ISerializable, isSerializable} from './interfaces/i_serializable.js';\nimport {IStyleable} from './interfaces/i_styleable.js';\nimport {IToolbox} from './interfaces/i_toolbox.js';\nimport {IToolboxItem} from './interfaces/i_toolbox_item.js';\nimport {\n  IVariableBackedParameterModel,\n  isVariableBackedParameterModel,\n} from './interfaces/i_variable_backed_parameter_model.js';\nimport * as internalConstants from './internal_constants.js';\nimport {ASTNode} from './keyboard_nav/ast_node.js';\nimport {BasicCursor} from './keyboard_nav/basic_cursor.js';\nimport {Cursor} from './keyboard_nav/cursor.js';\nimport {Marker} from './keyboard_nav/marker.js';\nimport {TabNavigateCursor} from './keyboard_nav/tab_navigate_cursor.js';\nimport {MarkerManager} from './marker_manager.js';\nimport {Menu} from './menu.js';\nimport {MenuItem} from './menuitem.js';\nimport {MetricsManager} from './metrics_manager.js';\nimport {Msg, setLocale} from './msg.js';\nimport {MiniWorkspaceBubble} from './bubbles/mini_workspace_bubble.js';\nimport {Names} from './names.js';\nimport {Options} from './options.js';\nimport * as uiPosition from './positionable_helpers.js';\nimport * as Procedures from './procedures.js';\nimport * as registry from './registry.js';\nimport {RenderedConnection} from './rendered_connection.js';\nimport * as renderManagement from './render_management.js';\nimport * as blockRendering from './renderers/common/block_rendering.js';\nimport * as constants from './constants.js';\nimport * as geras from './renderers/geras/geras.js';\nimport * as minimalist from './renderers/minimalist/minimalist.js';\nimport * as thrasos from './renderers/thrasos/thrasos.js';\nimport * as zelos from './renderers/zelos/zelos.js';\nimport {Scrollbar} from './scrollbar.js';\nimport {ScrollbarPair} from './scrollbar_pair.js';\nimport * as serialization from './serialization.js';\nimport * as ShortcutItems from './shortcut_items.js';\nimport {ShortcutRegistry} from './shortcut_registry.js';\nimport {Theme} from './theme.js';\nimport * as Themes from './theme/themes.js';\nimport {ThemeManager} from './theme_manager.js';\nimport {ToolboxCategory} from './toolbox/category.js';\nimport {CollapsibleToolboxCategory} from './toolbox/collapsible_category.js';\nimport {ToolboxSeparator} from './toolbox/separator.js';\nimport {Toolbox} from './toolbox/toolbox.js';\nimport {ToolboxItem} from './toolbox/toolbox_item.js';\nimport * as Tooltip from './tooltip.js';\nimport * as Touch from './touch.js';\nimport {Trashcan} from './trashcan.js';\nimport * as utils from './utils.js';\nimport * as toolbox from './utils/toolbox.js';\nimport {VariableMap} from './variable_map.js';\nimport {VariableModel} from './variable_model.js';\nimport * as Variables from './variables.js';\nimport * as VariablesDynamic from './variables_dynamic.js';\nimport * as WidgetDiv from './widgetdiv.js';\nimport {Workspace} from './workspace.js';\nimport {WorkspaceAudio} from './workspace_audio.js';\nimport {WorkspaceComment} from './workspace_comment.js';\nimport {WorkspaceCommentSvg} from './workspace_comment_svg.js';\nimport {WorkspaceDragger} from './workspace_dragger.js';\nimport {WorkspaceSvg} from './workspace_svg.js';\nimport * as Xml from './xml.js';\nimport {ZoomControls} from './zoom_controls.js';\n\n/**\n * Blockly core version.\n * This constant is overridden by the build script (npm run build) to the value\n * of the version in package.json. This is done by the Closure Compiler in the\n * buildCompressed gulp task.\n * For local builds, you can pass --define='Blockly.VERSION=X.Y.Z' to the\n * compiler to override this constant.\n *\n * @define {string}\n */\nexport const VERSION = 'uncompiled';\n\n/*\n * Top-level functions and properties on the Blockly namespace.\n * These are used only in external code. Do not reference these\n * from internal code as importing from this file can cause circular\n * dependencies. Do not add new functions here. There is probably a better\n * namespace to put new functions on.\n */\n\n/*\n * Aliases for input alignments used in block defintions.\n */\n\n/**\n * @see Blockly.Input.Align.LEFT\n * @deprecated Use `Blockly.inputs.Align.LEFT`. To be removed in v11.\n */\nexport const ALIGN_LEFT = Align.LEFT;\n\n/**\n * @see Blockly.Input.Align.CENTRE\n * @deprecated Use `Blockly.inputs.Align.CENTER`. To be removed in v11.\n */\nexport const ALIGN_CENTRE = Align.CENTRE;\n\n/**\n * @see Blockly.Input.Align.RIGHT\n * @deprecated Use `Blockly.inputs.Align.RIGHT`. To be removed in v11.\n */\nexport const ALIGN_RIGHT = Align.RIGHT;\n/*\n * Aliases for constants used for connection and input types.\n */\n\n/**\n * @see ConnectionType.INPUT_VALUE\n */\nexport const INPUT_VALUE = ConnectionType.INPUT_VALUE;\n\n/**\n * @see ConnectionType.OUTPUT_VALUE\n */\nexport const OUTPUT_VALUE = ConnectionType.OUTPUT_VALUE;\n\n/**\n * @see ConnectionType.NEXT_STATEMENT\n */\nexport const NEXT_STATEMENT = ConnectionType.NEXT_STATEMENT;\n\n/**\n * @see ConnectionType.PREVIOUS_STATEMENT\n */\nexport const PREVIOUS_STATEMENT = ConnectionType.PREVIOUS_STATEMENT;\n\n/**\n * @see inputTypes.DUMMY_INPUT\n * @deprecated Use `Blockly.inputs.inputTypes.DUMMY`. To be removed in v11.\n */\nexport const DUMMY_INPUT = inputTypes.DUMMY;\n\n/** Aliases for toolbox positions. */\n\n/**\n * @see toolbox.Position.TOP\n */\nexport const TOOLBOX_AT_TOP = toolbox.Position.TOP;\n\n/**\n * @see toolbox.Position.BOTTOM\n */\nexport const TOOLBOX_AT_BOTTOM = toolbox.Position.BOTTOM;\n\n/**\n * @see toolbox.Position.LEFT\n */\nexport const TOOLBOX_AT_LEFT = toolbox.Position.LEFT;\n\n/**\n * @see toolbox.Position.RIGHT\n */\nexport const TOOLBOX_AT_RIGHT = toolbox.Position.RIGHT;\n\n/*\n * Other aliased functions.\n */\n\n/**\n * Size the SVG image to completely fill its container. Call this when the view\n * actually changes sizes (e.g. on a window resize/device orientation change).\n * See workspace.resizeContents to resize the workspace when the contents\n * change (e.g. when a block is added or removed).\n * Record the height/width of the SVG image.\n *\n * @param workspace Any workspace in the SVG.\n * @see Blockly.common.svgResize\n */\nexport const svgResize = common.svgResize;\n\n/**\n * Close tooltips, context menus, dropdown selections, etc.\n *\n * @param opt_onlyClosePopups Whether only popups should be closed.\n * @see Blockly.WorkspaceSvg.hideChaff\n */\nexport function hideChaff(opt_onlyClosePopups?: boolean) {\n  (common.getMainWorkspace() as WorkspaceSvg).hideChaff(opt_onlyClosePopups);\n}\n\n/**\n * Returns the main workspace.  Returns the last used main workspace (based on\n * focus).  Try not to use this function, particularly if there are multiple\n * Blockly instances on a page.\n *\n * @see Blockly.common.getMainWorkspace\n */\nexport const getMainWorkspace = common.getMainWorkspace;\n\n/**\n * Returns the currently selected copyable object.\n */\nexport const getSelected = common.getSelected;\n\n/**\n * Define blocks from an array of JSON block definitions, as might be generated\n * by the Blockly Developer Tools.\n *\n * @param jsonArray An array of JSON block definitions.\n * @see Blockly.common.defineBlocksWithJsonArray\n */\nexport const defineBlocksWithJsonArray = common.defineBlocksWithJsonArray;\n\n/**\n * Set the parent container.  This is the container element that the WidgetDiv,\n * dropDownDiv, and Tooltip are rendered into the first time `Blockly.inject`\n * is called.\n * This method is a NOP if called after the first `Blockly.inject`.\n *\n * @param container The container element.\n * @see Blockly.common.setParentContainer\n */\nexport const setParentContainer = common.setParentContainer;\n\n// Aliases to allow external code to access these values for legacy reasons.\nexport const COLLAPSE_CHARS = internalConstants.COLLAPSE_CHARS;\nexport const DRAG_STACK = internalConstants.DRAG_STACK;\nexport const OPPOSITE_TYPE = internalConstants.OPPOSITE_TYPE;\nexport const RENAME_VARIABLE_ID = internalConstants.RENAME_VARIABLE_ID;\nexport const DELETE_VARIABLE_ID = internalConstants.DELETE_VARIABLE_ID;\nexport const COLLAPSED_INPUT_NAME = constants.COLLAPSED_INPUT_NAME;\nexport const COLLAPSED_FIELD_NAME = constants.COLLAPSED_FIELD_NAME;\n\n/**\n * String for use in the \"custom\" attribute of a category in toolbox XML.\n * This string indicates that the category should be dynamically populated with\n * variable blocks.\n */\nexport const VARIABLE_CATEGORY_NAME: string = Variables.CATEGORY_NAME;\n\n/**\n * String for use in the \"custom\" attribute of a category in toolbox XML.\n * This string indicates that the category should be dynamically populated with\n * variable blocks.\n */\nexport const VARIABLE_DYNAMIC_CATEGORY_NAME: string =\n  VariablesDynamic.CATEGORY_NAME;\n/**\n * String for use in the \"custom\" attribute of a category in toolbox XML.\n * This string indicates that the category should be dynamically populated with\n * procedure blocks.\n */\nexport const PROCEDURE_CATEGORY_NAME: string = Procedures.CATEGORY_NAME;\n\n// Context for why we need to monkey-patch in these functions (internal):\n//   https://docs.google.com/document/d/1MbO0LEA-pAyx1ErGLJnyUqTLrcYTo-5zga9qplnxeXo/edit?usp=sharing&resourcekey=0-5h_32-i-dHwHjf_9KYEVKg\n\n// clang-format off\nWorkspace.prototype.newBlock = function (\n  prototypeName: string,\n  opt_id?: string,\n): Block {\n  return new Block(this, prototypeName, opt_id);\n};\n\nWorkspaceSvg.prototype.newBlock = function (\n  prototypeName: string,\n  opt_id?: string,\n): BlockSvg {\n  return new BlockSvg(this, prototypeName, opt_id);\n};\n\nWorkspaceSvg.newTrashcan = function (workspace: WorkspaceSvg): Trashcan {\n  return new Trashcan(workspace);\n};\n\nWorkspaceCommentSvg.prototype.showContextMenu = function (\n  this: WorkspaceCommentSvg,\n  e: Event,\n) {\n  if (this.workspace.options.readOnly) {\n    return;\n  }\n  const menuOptions = [];\n\n  if (this.isDeletable() && this.isMovable()) {\n    menuOptions.push(ContextMenu.commentDuplicateOption(this));\n    menuOptions.push(ContextMenu.commentDeleteOption(this));\n  }\n\n  ContextMenu.show(e, menuOptions, this.RTL);\n};\n\nMiniWorkspaceBubble.prototype.newWorkspaceSvg = function (\n  options: Options,\n): WorkspaceSvg {\n  return new WorkspaceSvg(options);\n};\n\nNames.prototype.populateProcedures = function (\n  this: Names,\n  workspace: Workspace,\n) {\n  const procedures = Procedures.allProcedures(workspace);\n  // Flatten the return vs no-return procedure lists.\n  const flattenedProcedures = procedures[0].concat(procedures[1]);\n  for (let i = 0; i < flattenedProcedures.length; i++) {\n    this.getName(flattenedProcedures[i][0], Names.NameType.PROCEDURE);\n  }\n};\n// clang-format on\n\n// Re-export submodules that no longer declareLegacyNamespace.\nexport {browserEvents};\nexport {ContextMenu};\nexport {ContextMenuItems};\nexport {Css};\nexport {Events};\nexport {Extensions};\nexport {Procedures};\nexport {Procedures as procedures};\nexport {ShortcutItems};\nexport {Themes};\nexport {Tooltip};\nexport {Touch};\nexport {Variables};\nexport {VariablesDynamic};\nexport {WidgetDiv};\nexport {Xml};\nexport {blockAnimations};\nexport {blockRendering};\nexport {bumpObjects};\nexport {clipboard};\nexport {common};\nexport {constants};\nexport {dialog};\nexport {fieldRegistry};\nexport {geras};\nexport {minimalist};\nexport {registry};\nexport {thrasos};\nexport {uiPosition};\nexport {utils};\nexport {zelos};\nexport {ASTNode};\nexport {BasicCursor};\nexport {Block};\nexport {BlocklyOptions};\nexport {BlockDragger};\nexport {BlockSvg};\nexport {Blocks};\nexport {bubbles};\n/** @deprecated Use Blockly.bubbles.Bubble instead. To be removed in v11. */\nexport {Bubble};\nexport {BubbleDragger};\nexport {CollapsibleToolboxCategory};\nexport {ComponentManager};\nexport {Connection};\nexport {ConnectionType};\nexport {ConnectionChecker};\nexport {ConnectionDB};\nexport {ContextMenuRegistry};\nexport {Cursor};\nexport {DeleteArea};\nexport {DragTarget};\nexport const DropDownDiv = dropDownDiv;\nexport {Field, FieldConfig, FieldValidator, UnattachedFieldError};\nexport {\n  FieldAngle,\n  FieldAngleConfig,\n  FieldAngleFromJsonConfig,\n  FieldAngleValidator,\n};\nexport {\n  FieldCheckbox,\n  FieldCheckboxConfig,\n  FieldCheckboxFromJsonConfig,\n  FieldCheckboxValidator,\n};\nexport {\n  FieldColour,\n  FieldColourConfig,\n  FieldColourFromJsonConfig,\n  FieldColourValidator,\n};\nexport {\n  FieldDropdown,\n  FieldDropdownConfig,\n  FieldDropdownFromJsonConfig,\n  FieldDropdownValidator,\n  MenuGenerator,\n  MenuGeneratorFunction,\n  MenuOption,\n};\nexport {FieldImage, FieldImageConfig, FieldImageFromJsonConfig};\nexport {FieldLabel, FieldLabelConfig, FieldLabelFromJsonConfig};\nexport {FieldLabelSerializable};\nexport {\n  FieldMultilineInput,\n  FieldMultilineInputConfig,\n  FieldMultilineInputFromJsonConfig,\n  FieldMultilineInputValidator,\n};\nexport {\n  FieldNumber,\n  FieldNumberConfig,\n  FieldNumberFromJsonConfig,\n  FieldNumberValidator,\n};\nexport {\n  FieldTextInput,\n  FieldTextInputConfig,\n  FieldTextInputFromJsonConfig,\n  FieldTextInputValidator,\n};\nexport {\n  FieldVariable,\n  FieldVariableConfig,\n  FieldVariableFromJsonConfig,\n  FieldVariableValidator,\n};\nexport {Flyout};\nexport {FlyoutButton};\nexport {FlyoutMetricsManager};\nexport {CodeGenerator};\nexport {CodeGenerator as Generator}; // Deprecated name, October 2022.\nexport {Gesture};\nexport {Grid};\nexport {HorizontalFlyout};\nexport {IASTNodeLocation};\nexport {IASTNodeLocationSvg};\nexport {IASTNodeLocationWithBlock};\nexport {IAutoHideable};\nexport {IBlockDragger};\nexport {IBoundedElement};\nexport {IBubble};\nexport {ICollapsibleToolboxItem};\nexport {IComponent};\nexport {IConnectionChecker};\nexport {IConnectionPreviewer};\nexport {IContextMenu};\nexport {icons};\nexport {ICopyable, isCopyable};\nexport {IDeletable};\nexport {IDeleteArea};\nexport {IDragTarget};\nexport {IDraggable};\nexport {IFlyout};\nexport {IHasBubble, hasBubble};\nexport {IIcon, isIcon};\nexport {IKeyboardAccessible};\nexport {IMetricsManager};\nexport {IMovable};\nexport {Input};\nexport {inputs};\nexport {InsertionMarkerManager};\nexport {InsertionMarkerPreviewer};\nexport {IObservable, isObservable};\nexport {IPaster, isPaster};\nexport {IPositionable};\nexport {IRegistrable};\nexport {ISelectable};\nexport {ISelectableToolboxItem};\nexport {ISerializable, isSerializable};\nexport {IStyleable};\nexport {IToolbox};\nexport {IToolboxItem};\nexport {IVariableBackedParameterModel, isVariableBackedParameterModel};\nexport {Marker};\nexport {MarkerManager};\nexport {Menu};\nexport {MenuItem};\nexport {MetricsManager};\nexport {Msg, setLocale};\nexport {Names};\nexport {Options};\nexport {RenderedConnection};\nexport {renderManagement};\nexport {Scrollbar};\nexport {ScrollbarPair};\nexport {ShortcutRegistry};\nexport {TabNavigateCursor};\nexport {Theme};\nexport {ThemeManager};\nexport {Toolbox};\nexport {ToolboxCategory};\nexport {ToolboxItem};\nexport {ToolboxSeparator};\nexport {Trashcan};\nexport {VariableMap};\nexport {VariableModel};\nexport {VerticalFlyout};\nexport {Workspace};\nexport {WorkspaceAudio};\nexport {WorkspaceComment};\nexport {WorkspaceCommentSvg};\nexport {WorkspaceDragger};\nexport {WorkspaceSvg};\nexport {ZoomControls};\nexport {config};\n/** @deprecated Use Blockly.ConnectionType instead. */\nexport const connectionTypes = ConnectionType;\nexport {inject};\n/** @deprecated Use Blockly.inputs.inputTypes instead. To be removed in v11. */\nexport {inputTypes};\nexport {serialization};\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/** @internal */\nexport interface IRenderedElement {\n  /**\n   * @returns The root SVG element of htis rendered element.\n   */\n  getSvgRoot(): SVGElement;\n}\n\n/**\n * @returns True if the given object is an IRenderedElement.\n *\n * @internal\n */\nexport function isRenderedElement(obj: any): obj is IRenderedElement {\n  return obj['getSvgRoot'] !== undefined;\n}\n",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"/**\n * @license\n * Copyright 2013 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blocks\n\n/**\n * A block definition.  For now this very loose, but it can potentially\n * be refined e.g. by replacing this typedef with a class definition.\n */\nexport type BlockDefinition = AnyDuringMigration;\n\n/**\n * A mapping of block type names to block prototype objects.\n */\nexport const Blocks: {[key: string]: BlockDefinition} = Object.create(null);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Abstract class for events fired as a result of actions in\n * Blockly's editor.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.Abstract\n\nimport * as common from '../common.js';\nimport type {Workspace} from '../workspace.js';\n\nimport * as eventUtils from './utils.js';\n\n/**\n * Abstract class for an event.\n */\nexport abstract class Abstract {\n  /**\n   * Whether or not the event was constructed without necessary parameters\n   * (to be populated by fromJson).\n   */\n  abstract isBlank: boolean;\n\n  /** The workspace identifier for this event. */\n  workspaceId?: string = undefined;\n\n  /**\n   * An ID for the group of events this block is associated with.\n   *\n   * Groups define events that should be treated as an single action from the\n   * user's perspective, and should be undone together.\n   */\n  group: string;\n\n  /** Whether this event is undoable or not. */\n  recordUndo: boolean;\n\n  /** Whether or not the event is a UI event. */\n  isUiEvent = false;\n\n  /** Type of this event. */\n  type = '';\n\n  constructor() {\n    this.group = eventUtils.getGroup();\n    this.recordUndo = eventUtils.getRecordUndo();\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  toJson(): AbstractEventJson {\n    return {\n      'type': this.type,\n      'group': this.group,\n    };\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of Abstract (like all events), but we can't specify that due to the\n   *     fact that parameters to static methods in subclasses must be\n   *     supertypes of parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: AbstractEventJson,\n    workspace: Workspace,\n    event: any,\n  ): Abstract {\n    event.isBlank = false;\n    event.group = json['group'] || '';\n    event.workspaceId = workspace.id;\n    return event;\n  }\n\n  /**\n   * Does this event record any change of state?\n   *\n   * @returns True if null, false if something changed.\n   */\n  isNull(): boolean {\n    return false;\n  }\n\n  /**\n   * Run an event.\n   *\n   * @param _forward True if run forward, false if run backward (undo).\n   */\n  run(_forward: boolean) {\n    // Defined by subclasses. Cannot be abstract b/c UI events do /not/ define\n    // this.\n  }\n\n  /**\n   * Get workspace the event belongs to.\n   *\n   * @returns The workspace the event belongs to.\n   * @throws {Error} if workspace is null.\n   * @internal\n   */\n  getEventWorkspace_(): Workspace {\n    let workspace;\n    if (this.workspaceId) {\n      workspace = common.getWorkspaceById(this.workspaceId);\n    }\n    if (!workspace) {\n      throw Error(\n        'Workspace is null. Event must have been generated from real' +\n          ' Blockly events.',\n      );\n    }\n    return workspace;\n  }\n}\n\nexport interface AbstractEventJson {\n  type: string;\n  group: string;\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Base class for events fired as a result of UI actions in\n * Blockly's editor.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.UiBase\n\nimport {Abstract as AbstractEvent} from './events_abstract.js';\n\n/**\n * Base class for a UI event.\n * UI events are events that don't need to be sent over the wire for multi-user\n * editing to work (e.g. scrolling the workspace, zooming, opening toolbox\n * categories).\n * UI events do not undo or redo.\n */\nexport class UiBase extends AbstractEvent {\n  override isBlank = true;\n  override workspaceId: string;\n\n  // UI events do not undo or redo.\n  override recordUndo = false;\n\n  /** Whether or not the event is a UI event. */\n  override isUiEvent = true;\n\n  /**\n   * @param opt_workspaceId The workspace identifier for this event.\n   *    Undefined for a blank event.\n   */\n  constructor(opt_workspaceId?: string) {\n    super();\n\n    /** Whether or not the event is blank (to be populated by fromJson). */\n    this.isBlank = typeof opt_workspaceId === 'undefined';\n\n    /** The workspace identifier for this event. */\n    this.workspaceId = opt_workspaceId ? opt_workspaceId : '';\n  }\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Events fired as a result of UI click in Blockly's editor.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.Click\n\nimport type {Block} from '../block.js';\nimport * as registry from '../registry.js';\nimport {AbstractEventJson} from './events_abstract.js';\n\nimport {UiBase} from './events_ui_base.js';\nimport * as eventUtils from './utils.js';\nimport {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners that ome blockly element was clicked.\n */\nexport class Click extends UiBase {\n  /** The ID of the block that was clicked, if a block was clicked. */\n  blockId?: string;\n\n  /**\n   * The type of element that was clicked; one of 'block', 'workspace',\n   * or 'zoom_controls'.\n   */\n  targetType?: ClickTarget;\n  override type = eventUtils.CLICK;\n\n  /**\n   * @param opt_block The affected block. Null for click events that do not have\n   *     an associated block (i.e. workspace click). Undefined for a blank\n   *     event.\n   * @param opt_workspaceId The workspace identifier for this event.\n   *    Not used if block is passed. Undefined for a blank event.\n   * @param opt_targetType The type of element targeted by this click event.\n   *     Undefined for a blank event.\n   */\n  constructor(\n    opt_block?: Block | null,\n    opt_workspaceId?: string | null,\n    opt_targetType?: ClickTarget,\n  ) {\n    let workspaceId = opt_block ? opt_block.workspace.id : opt_workspaceId;\n    if (workspaceId === null) {\n      workspaceId = undefined;\n    }\n    super(workspaceId);\n\n    this.blockId = opt_block ? opt_block.id : undefined;\n    this.targetType = opt_targetType;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): ClickJson {\n    const json = super.toJson() as ClickJson;\n    if (!this.targetType) {\n      throw new Error(\n        'The click target type is undefined. Either pass a block to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    json['targetType'] = this.targetType;\n    json['blockId'] = this.blockId;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of Click, but we can't specify that due to the fact that parameters to\n   *     static methods in subclasses must be supertypes of parameters to\n   *     static methods in superclasses.\n   * @internal\n   */\n  static fromJson(json: ClickJson, workspace: Workspace, event?: any): Click {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new Click(),\n    ) as Click;\n    newEvent.targetType = json['targetType'];\n    newEvent.blockId = json['blockId'];\n    return newEvent;\n  }\n}\n\nexport enum ClickTarget {\n  BLOCK = 'block',\n  WORKSPACE = 'workspace',\n  ZOOM_CONTROLS = 'zoom_controls',\n}\n\nexport interface ClickJson extends AbstractEventJson {\n  targetType: ClickTarget;\n  blockId?: string;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.CLICK, Click);\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.utils.userAgent\n\n/** The raw useragent string. */\nlet rawUserAgent: string;\n\nlet isJavaFx: boolean;\n\nlet isWebKit: boolean;\n\nlet isGecko: boolean;\n\nlet isAndroid: boolean;\n\nlet isIPad: boolean;\n\nlet isIPhone: boolean;\n\nlet isMac: boolean;\n\nlet isTablet: boolean;\n\nlet isMobile: boolean;\n\n(function (raw) {\n  rawUserAgent = raw;\n  const rawUpper = rawUserAgent.toUpperCase();\n  /**\n   * Case-insensitive test of whether name is in the useragent string.\n   *\n   * @param name Name to test.\n   * @returns True if name is present.\n   */\n  function has(name: string): boolean {\n    return rawUpper.indexOf(name.toUpperCase()) !== -1;\n  }\n\n  // Browsers.  Logic from:\n  // https://github.com/google/closure-library/blob/master/closure/goog/labs/useragent/browser.js\n  // Useragent for JavaFX:\n  // Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.44\n  //     (KHTML, like Gecko) JavaFX/8.0 Safari/537.44\n  isJavaFx = has('JavaFX');\n\n  // Engines.  Logic from:\n  // https://github.com/google/closure-library/blob/master/closure/goog/labs/useragent/engine.js\n  isWebKit = has('WebKit');\n  isGecko = has('Gecko') && !isWebKit;\n\n  // Platforms.  Logic from:\n  // https://github.com/google/closure-library/blob/master/closure/goog/labs/useragent/platform.js\n  // and\n  // https://github.com/google/closure-library/blob/master/closure/goog/labs/useragent/extra.js\n  isAndroid = has('Android');\n  const maxTouchPoints =\n    globalThis['navigator'] && globalThis['navigator']['maxTouchPoints'];\n  isIPad = has('iPad') || (has('Macintosh') && maxTouchPoints > 0);\n  isIPhone = has('iPhone') && !isIPad;\n  isMac = has('Macintosh');\n\n  // Devices.  Logic from:\n  // https://github.com/google/closure-library/blob/master/closure/goog/labs/useragent/device.js\n  isTablet = isIPad || (isAndroid && !has('Mobile')) || has('Silk');\n  isMobile = !isTablet && (isIPhone || isAndroid);\n})((globalThis['navigator'] && globalThis['navigator']['userAgent']) || '');\n\nexport const raw: string = rawUserAgent;\n\nexport const JavaFx: boolean = isJavaFx;\n\nexport const GECKO: boolean = isGecko;\n\nexport const ANDROID: boolean = isAndroid;\n\nexport const IPAD: boolean = isIPad;\n\nexport const IPHONE: boolean = isIPhone;\n\nexport const MAC: boolean = isMac;\n\nexport const MOBILE: boolean = isMobile;\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Manager for all items registered with the workspace.\n *\n * @class\n */\n// Former goog.module ID: Blockly.ComponentManager\n\nimport type {IAutoHideable} from './interfaces/i_autohideable.js';\nimport type {IComponent} from './interfaces/i_component.js';\nimport type {IDeleteArea} from './interfaces/i_delete_area.js';\nimport type {IDragTarget} from './interfaces/i_drag_target.js';\nimport type {IPositionable} from './interfaces/i_positionable.js';\nimport * as arrayUtils from './utils/array.js';\n\nclass Capability<_T> {\n  static POSITIONABLE = new Capability<IPositionable>('positionable');\n  static DRAG_TARGET = new Capability<IDragTarget>('drag_target');\n  static DELETE_AREA = new Capability<IDeleteArea>('delete_area');\n  static AUTOHIDEABLE = new Capability<IAutoHideable>('autohideable');\n  private readonly name_: string;\n  /** @param name The name of the component capability. */\n  constructor(name: string) {\n    this.name_ = name;\n  }\n\n  /**\n   * Returns the name of the capability.\n   *\n   * @returns The name.\n   */\n  toString(): string {\n    return this.name_;\n  }\n}\n\n/**\n * Manager for all items registered with the workspace.\n */\nexport class ComponentManager {\n  static Capability = Capability;\n\n  /**\n   * A map of the components registered with the workspace, mapped to id.\n   */\n  private readonly componentData = new Map<string, ComponentDatum>();\n\n  /** A map of capabilities to component IDs. */\n  private readonly capabilityToComponentIds = new Map<string, string[]>();\n\n  /**\n   * Adds a component.\n   *\n   * @param componentInfo The data for the component to register.\n   * @param opt_allowOverrides True to prevent an error when overriding an\n   *     already registered item.\n   */\n  addComponent(componentInfo: ComponentDatum, opt_allowOverrides?: boolean) {\n    // Don't throw an error if opt_allowOverrides is true.\n    const id = componentInfo.component.id;\n    if (!opt_allowOverrides && this.componentData.has(id)) {\n      throw Error(\n        'Plugin \"' +\n          id +\n          '\" with capabilities \"' +\n          this.componentData.get(id)?.capabilities +\n          '\" already added.',\n      );\n    }\n    this.componentData.set(id, componentInfo);\n    const stringCapabilities = [];\n    for (let i = 0; i < componentInfo.capabilities.length; i++) {\n      const capability = String(componentInfo.capabilities[i]).toLowerCase();\n      stringCapabilities.push(capability);\n      if (!this.capabilityToComponentIds.has(capability)) {\n        this.capabilityToComponentIds.set(capability, [id]);\n      } else {\n        this.capabilityToComponentIds.get(capability)?.push(id);\n      }\n    }\n    this.componentData.get(id)!.capabilities = stringCapabilities;\n  }\n\n  /**\n   * Removes a component.\n   *\n   * @param id The ID of the component to remove.\n   */\n  removeComponent(id: string) {\n    const componentInfo = this.componentData.get(id);\n    if (!componentInfo) {\n      return;\n    }\n    for (let i = 0; i < componentInfo.capabilities.length; i++) {\n      const capability = String(componentInfo.capabilities[i]).toLowerCase();\n      arrayUtils.removeElem(this.capabilityToComponentIds.get(capability)!, id);\n    }\n    this.componentData.delete(id);\n  }\n\n  /**\n   * Adds a capability to a existing registered component.\n   *\n   * @param id The ID of the component to add the capability to.\n   * @param capability The capability to add.\n   */\n  addCapability<T>(id: string, capability: string | Capability<T>) {\n    if (!this.getComponent(id)) {\n      throw Error(\n        'Cannot add capability, \"' +\n          capability +\n          '\". Plugin \"' +\n          id +\n          '\" has not been added to the ComponentManager',\n      );\n    }\n    if (this.hasCapability(id, capability)) {\n      console.warn(\n        'Plugin \"' + id + 'already has capability \"' + capability + '\"',\n      );\n      return;\n    }\n    capability = `${capability}`.toLowerCase();\n    this.componentData.get(id)?.capabilities.push(capability);\n    this.capabilityToComponentIds.get(capability)?.push(id);\n  }\n\n  /**\n   * Removes a capability from an existing registered component.\n   *\n   * @param id The ID of the component to remove the capability from.\n   * @param capability The capability to remove.\n   */\n  removeCapability<T>(id: string, capability: string | Capability<T>) {\n    if (!this.getComponent(id)) {\n      throw Error(\n        'Cannot remove capability, \"' +\n          capability +\n          '\". Plugin \"' +\n          id +\n          '\" has not been added to the ComponentManager',\n      );\n    }\n    if (!this.hasCapability(id, capability)) {\n      console.warn(\n        'Plugin \"' +\n          id +\n          'doesn\\'t have capability \"' +\n          capability +\n          '\" to remove',\n      );\n      return;\n    }\n    capability = `${capability}`.toLowerCase();\n    arrayUtils.removeElem(this.componentData.get(id)!.capabilities, capability);\n    arrayUtils.removeElem(this.capabilityToComponentIds.get(capability)!, id);\n  }\n\n  /**\n   * Returns whether the component with this id has the specified capability.\n   *\n   * @param id The ID of the component to check.\n   * @param capability The capability to check for.\n   * @returns Whether the component has the capability.\n   */\n  hasCapability<T>(id: string, capability: string | Capability<T>): boolean {\n    capability = `${capability}`.toLowerCase();\n    return (\n      this.componentData.has(id) &&\n      this.componentData.get(id)!.capabilities.indexOf(capability) !== -1\n    );\n  }\n\n  /**\n   * Gets the component with the given ID.\n   *\n   * @param id The ID of the component to get.\n   * @returns The component with the given name or undefined if not found.\n   */\n  getComponent(id: string): IComponent | undefined {\n    return this.componentData.get(id)?.component;\n  }\n\n  /**\n   * Gets all the components with the specified capability.\n   *\n   * @param capability The capability of the component.\n   * @param sorted Whether to return list ordered by weights.\n   * @returns The components that match the specified capability.\n   */\n  getComponents<T extends IComponent>(\n    capability: string | Capability<T>,\n    sorted: boolean,\n  ): T[] {\n    capability = `${capability}`.toLowerCase();\n    const componentIds = this.capabilityToComponentIds.get(capability);\n    if (!componentIds) {\n      return [];\n    }\n    const components: T[] = [];\n    if (sorted) {\n      const componentDataList: ComponentDatum[] = [];\n      componentIds.forEach((id) => {\n        componentDataList.push(this.componentData.get(id)!);\n      });\n      componentDataList.sort(function (a, b) {\n        return a.weight - b.weight;\n      });\n      componentDataList.forEach(function (componentDatum) {\n        components.push(componentDatum.component as T);\n      });\n    } else {\n      componentIds.forEach((id) => {\n        components.push(this.componentData.get(id)!.component as T);\n      });\n    }\n    return components;\n  }\n}\n\nexport namespace ComponentManager {\n  /** An object storing component information. */\n  export interface ComponentDatum {\n    component: IComponent;\n    capabilities: Array<string | Capability<IComponent>>;\n    weight: number;\n  }\n}\n\nexport type ComponentDatum = ComponentManager.ComponentDatum;\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Utility methods for coordinate manipulation.\n * These methods are not specific to Blockly, and could be factored out into\n * a JavaScript framework such as Closure.\n *\n * @class\n */\n// Former goog.module ID: Blockly.utils.Coordinate\n\n/**\n * Class for representing coordinates and positions.\n */\nexport class Coordinate {\n  /**\n   * @param x Left.\n   * @param y Top.\n   */\n  constructor(\n    public x: number,\n    public y: number,\n  ) {}\n\n  /**\n   * Creates a new copy of this coordinate.\n   *\n   * @returns A copy of this coordinate.\n   */\n  clone(): Coordinate {\n    return new Coordinate(this.x, this.y);\n  }\n\n  /**\n   * Scales this coordinate by the given scale factor.\n   *\n   * @param s The scale factor to use for both x and y dimensions.\n   * @returns This coordinate after scaling.\n   */\n  scale(s: number): Coordinate {\n    this.x *= s;\n    this.y *= s;\n    return this;\n  }\n\n  /**\n   * Translates this coordinate by the given offsets.\n   * respectively.\n   *\n   * @param tx The value to translate x by.\n   * @param ty The value to translate y by.\n   * @returns This coordinate after translating.\n   */\n  translate(tx: number, ty: number): Coordinate {\n    this.x += tx;\n    this.y += ty;\n    return this;\n  }\n\n  /**\n   * Compares coordinates for equality.\n   *\n   * @param a A Coordinate.\n   * @param b A Coordinate.\n   * @returns True iff the coordinates are equal, or if both are null.\n   */\n  static equals(a?: Coordinate | null, b?: Coordinate | null): boolean {\n    if (a === b) {\n      return true;\n    }\n    if (!a || !b) {\n      return false;\n    }\n    return a.x === b.x && a.y === b.y;\n  }\n\n  /**\n   * Returns the distance between two coordinates.\n   *\n   * @param a A Coordinate.\n   * @param b A Coordinate.\n   * @returns The distance between `a` and `b`.\n   */\n  static distance(a: Coordinate, b: Coordinate): number {\n    const dx = a.x - b.x;\n    const dy = a.y - b.y;\n    return Math.sqrt(dx * dx + dy * dy);\n  }\n\n  /**\n   * Returns the magnitude of a coordinate.\n   *\n   * @param a A Coordinate.\n   * @returns The distance between the origin and `a`.\n   */\n  static magnitude(a: Coordinate): number {\n    return Math.sqrt(a.x * a.x + a.y * a.y);\n  }\n\n  /**\n   * Returns the difference between two coordinates as a new\n   * Coordinate.\n   *\n   * @param a An x/y coordinate.\n   * @param b An x/y coordinate.\n   * @returns A Coordinate representing the difference between `a` and `b`.\n   */\n  static difference(\n    a: Coordinate | SVGPoint,\n    b: Coordinate | SVGPoint,\n  ): Coordinate {\n    return new Coordinate(a.x - b.x, a.y - b.y);\n  }\n\n  /**\n   * Returns the sum of two coordinates as a new Coordinate.\n   *\n   * @param a An x/y coordinate.\n   * @param b An x/y coordinate.\n   * @returns A Coordinate representing the sum of the two coordinates.\n   */\n  static sum(a: Coordinate | SVGPoint, b: Coordinate | SVGPoint): Coordinate {\n    return new Coordinate(a.x + b.x, a.y + b.y);\n  }\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Defines the Svg class. Its constants enumerate\n * all SVG tag names used by Blockly.\n *\n * @class\n */\n// Former goog.module ID: Blockly.utils.Svg\n\n/**\n * A name with the type of the SVG element stored in the generic.\n */\nexport class Svg<_T> {\n  /** @internal */\n  static ANIMATE = new Svg<SVGAnimateElement>('animate');\n  /** @internal */\n  static CIRCLE = new Svg<SVGCircleElement>('circle');\n  /** @internal */\n  static CLIPPATH = new Svg<SVGClipPathElement>('clipPath');\n  /** @internal */\n  static DEFS = new Svg<SVGDefsElement>('defs');\n  /** @internal */\n  static FECOMPOSITE = new Svg<SVGFECompositeElement>('feComposite');\n  /** @internal */\n  static FECOMPONENTTRANSFER = new Svg<SVGFEComponentTransferElement>(\n    'feComponentTransfer',\n  );\n  /** @internal */\n  static FEFLOOD = new Svg<SVGFEFloodElement>('feFlood');\n  /** @internal */\n  static FEFUNCA = new Svg<SVGFEFuncAElement>('feFuncA');\n  /** @internal */\n  static FEGAUSSIANBLUR = new Svg<SVGFEGaussianBlurElement>('feGaussianBlur');\n  /** @internal */\n  static FEPOINTLIGHT = new Svg<SVGFEPointLightElement>('fePointLight');\n  /** @internal */\n  static FESPECULARLIGHTING = new Svg<SVGFESpecularLightingElement>(\n    'feSpecularLighting',\n  );\n  /** @internal */\n  static FILTER = new Svg<SVGFilterElement>('filter');\n  /** @internal */\n  static FOREIGNOBJECT = new Svg<SVGForeignObjectElement>('foreignObject');\n  /** @internal */\n  static G = new Svg<SVGGElement>('g');\n  /** @internal */\n  static IMAGE = new Svg<SVGImageElement>('image');\n  /** @internal */\n  static LINE = new Svg<SVGLineElement>('line');\n  /** @internal */\n  static PATH = new Svg<SVGPathElement>('path');\n  /** @internal */\n  static PATTERN = new Svg<SVGPatternElement>('pattern');\n  /** @internal */\n  static POLYGON = new Svg<SVGPolygonElement>('polygon');\n  /** @internal */\n  static RECT = new Svg<SVGRectElement>('rect');\n  /** @internal */\n  static SVG = new Svg<SVGSVGElement>('svg');\n  /** @internal */\n  static TEXT = new Svg<SVGTextElement>('text');\n  /** @internal */\n  static TSPAN = new Svg<SVGTSpanElement>('tspan');\n\n  /**\n   * @param tagName The SVG element tag name.\n   * @internal\n   */\n  constructor(private readonly tagName: string) {}\n\n  /**\n   * Returns the SVG element tag name.\n   *\n   * @returns The name.\n   */\n  toString(): string {\n    return this.tagName;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Utility methods for rectangle manipulation.\n * These methods are not specific to Blockly, and could be factored out into\n * a JavaScript framework such as Closure.\n *\n * @class\n */\n// Former goog.module ID: Blockly.utils.Rect\n\n/**\n * Class for representing rectangular regions.\n */\nexport class Rect {\n  /**\n   * @param top Top.\n   * @param bottom Bottom.\n   * @param left Left.\n   * @param right Right.\n   */\n  constructor(\n    public top: number,\n    public bottom: number,\n    public left: number,\n    public right: number,\n  ) {}\n\n  getHeight(): number {\n    return this.bottom - this.top;\n  }\n\n  getWidth(): number {\n    return this.right - this.left;\n  }\n\n  /**\n   * Tests whether this rectangle contains a x/y coordinate.\n   *\n   * @param x The x coordinate to test for containment.\n   * @param y The y coordinate to test for containment.\n   * @returns Whether this rectangle contains given coordinate.\n   */\n  contains(x: number, y: number): boolean {\n    return (\n      x >= this.left && x <= this.right && y >= this.top && y <= this.bottom\n    );\n  }\n\n  /**\n   * Tests whether this rectangle intersects the provided rectangle.\n   * Assumes that the coordinate system increases going down and left.\n   *\n   * @param other The other rectangle to check for intersection with.\n   * @returns Whether this rectangle intersects the provided rectangle.\n   */\n  intersects(other: Rect): boolean {\n    return !(\n      this.left > other.right ||\n      this.right < other.left ||\n      this.top > other.bottom ||\n      this.bottom < other.top\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Utility methods for size calculation.\n * These methods are not specific to Blockly, and could be factored out into\n * a JavaScript framework such as Closure.\n *\n * @class\n */\n// Former goog.module ID: Blockly.utils.Size\n\n/**\n * Class for representing sizes consisting of a width and height.\n */\nexport class Size {\n  /**\n   * @param width Width.\n   * @param height Height.\n   */\n  constructor(\n    public width: number,\n    public height: number,\n  ) {}\n\n  /**\n   * Compares sizes for equality.\n   *\n   * @param a A Size.\n   * @param b A Size.\n   * @returns True iff the sizes have equal widths and equal heights, or if both\n   *     are null.\n   */\n  static equals(a: Size | null, b: Size | null): boolean {\n    if (a === b) {\n      return true;\n    }\n    if (!a || !b) {\n      return false;\n    }\n    return a.width === b.width && a.height === b.height;\n  }\n}\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a scrollbar.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Scrollbar\n\nimport * as browserEvents from './browser_events.js';\nimport * as Touch from './touch.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport type {Metrics} from './utils/metrics.js';\nimport {Svg} from './utils/svg.js';\nimport * as svgMath from './utils/svg_math.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * A note on units: most of the numbers that are in CSS pixels are scaled if the\n * scrollbar is in a mutator.\n */\n\n/**\n * Class for a pure SVG scrollbar.\n * This technique offers a scrollbar that is guaranteed to work, but may not\n * look or behave like the system's scrollbars.\n */\nexport class Scrollbar {\n  /**\n   * Width of vertical scrollbar or height of horizontal scrollbar in CSS\n   * pixels. Scrollbars should be larger on touch devices.\n   */\n  static scrollbarThickness = Touch.TOUCH_ENABLED ? 25 : 15;\n\n  /**\n   * Default margin around the scrollbar (between the scrollbar and the edge of\n   * the viewport in pixels).\n   *\n   * @internal\n   */\n  static readonly DEFAULT_SCROLLBAR_MARGIN = 0.5;\n\n  /** Whether this scrollbar is part of a pair. */\n  private readonly pair: boolean;\n\n  /**\n   * Margin around the scrollbar (between the scrollbar and the edge of the\n   * viewport in pixels).\n   */\n  private readonly margin: number;\n\n  /** Previously recorded metrics from the workspace. */\n  private oldHostMetrics: Metrics | null = null;\n\n  /**\n   * The ratio of handle position offset to workspace content displacement.\n   *\n   * @internal\n   */\n  ratio = 1;\n\n  /**\n   * The location of the origin of the workspace that the scrollbar is in,\n   * measured in CSS pixels relative to the injection div origin.  This is\n   * usually (0, 0).  When the scrollbar is in a flyout it may have a\n   * different origin.\n   */\n  private origin = new Coordinate(0, 0);\n\n  /**\n   * The position of the mouse along this scrollbar's major axis at the start\n   * of the most recent drag. Units are CSS pixels, with (0, 0) at the top\n   * left of the browser window. For a horizontal scrollbar this is the x\n   * coordinate of the mouse down event; for a vertical scrollbar it's the y\n   * coordinate of the mouse down event.\n   */\n  private startDragMouse = 0;\n\n  /**\n   * The length of the scrollbars (including the handle and the background),\n   * in CSS pixels. This is equivalent to scrollbar background length and the\n   * area within which the scrollbar handle can move.\n   */\n  private scrollbarLength = 0;\n\n  /** The length of the scrollbar handle in CSS pixels. */\n  private handleLength = 0;\n\n  /**\n   * The offset of the start of the handle from the scrollbar position, in CSS\n   * pixels.\n   */\n  private handlePosition = 0;\n\n  private startDragHandle = 0;\n\n  /** Whether the scrollbar handle is visible. */\n  private isHandleVisible = true;\n\n  /** Whether the workspace containing this scrollbar is visible. */\n  private containerVisible = true;\n\n  /** The transparent background behind the handle. */\n  private svgBackground: SVGRectElement;\n\n  /** The visible handle that can be dragged around. */\n  private svgHandle: SVGRectElement;\n\n  /** The outermost SVG element, which contains all parts of the scrollbar. */\n  private outerSvg: SVGSVGElement;\n\n  /**\n   * The upper left corner of the scrollbar's SVG group in CSS pixels relative\n   * to the scrollbar's origin.  This is usually relative to the injection div\n   * origin.\n   *\n   * @internal\n   */\n  position = new Coordinate(0, 0);\n\n  /**\n   * The DOM attribute that controls the length of the scrollbar. Different\n   * for horizontal and vertical scrollbars.\n   */\n  lengthAttribute_: string;\n\n  /**\n   * The DOM attribute that controls the position of the scrollbar.\n   * Different for horizontal and vertical scrollbars.\n   */\n  positionAttribute_: string;\n\n  /** Handler for mouse down events on the background of the scrollbar. */\n  onMouseDownBarWrapper_: browserEvents.Data;\n\n  /** Handler for mouse down events on the handle of the scrollbar. */\n  onMouseDownHandleWrapper_: browserEvents.Data;\n\n  /** Handler for mouse move events during scrollbar drags. */\n  onMouseUpWrapper_: browserEvents.Data | null = null;\n\n  /** Handler for mouse up events to end scrollbar drags. */\n  onMouseMoveWrapper_: browserEvents.Data | null = null;\n\n  /**\n   * @param workspace Workspace to bind the scrollbar to.\n   * @param horizontal True if horizontal, false if vertical.\n   * @param opt_pair True if scrollbar is part of a horiz/vert pair.\n   * @param opt_class A class to be applied to this scrollbar.\n   * @param opt_margin The margin to apply to this scrollbar.\n   */\n  constructor(\n    private workspace: WorkspaceSvg,\n    private readonly horizontal: boolean,\n    opt_pair?: boolean,\n    opt_class?: string,\n    opt_margin?: number,\n  ) {\n    this.pair = opt_pair || false;\n\n    this.margin =\n      opt_margin !== undefined\n        ? opt_margin\n        : Scrollbar.DEFAULT_SCROLLBAR_MARGIN;\n\n    let className =\n      'blocklyScrollbar' + (this.horizontal ? 'Horizontal' : 'Vertical');\n    if (opt_class) {\n      className += ' ' + opt_class;\n    }\n\n    /* Create the following DOM:\n      <svg class=\"blocklyScrollbarHorizontal optionalClass\">\n        <g>\n          <rect class=\"blocklyScrollbarBackground\" />\n          <rect class=\"blocklyScrollbarHandle\" rx=\"8\" ry=\"8\" />\n        </g>\n      </svg>\n    */\n    this.outerSvg = dom.createSvgElement(Svg.SVG, {'class': className});\n    // Child group to hold the handle and background together.\n    const group = dom.createSvgElement(Svg.G, {}, this.outerSvg);\n\n    this.svgBackground = dom.createSvgElement(\n      Svg.RECT,\n      {'class': 'blocklyScrollbarBackground'},\n      group,\n    );\n\n    const radius = Math.floor((Scrollbar.scrollbarThickness - 5) / 2);\n    this.svgHandle = dom.createSvgElement(\n      Svg.RECT,\n      {'class': 'blocklyScrollbarHandle', 'rx': radius, 'ry': radius},\n      group,\n    );\n\n    this.workspace\n      .getThemeManager()\n      .subscribe(this.svgHandle, 'scrollbarColour', 'fill');\n    this.workspace\n      .getThemeManager()\n      .subscribe(this.svgHandle, 'scrollbarOpacity', 'fill-opacity');\n\n    // Add everything to the DOM.\n    dom.insertAfter(this.outerSvg, this.workspace.getParentSvg());\n\n    this.setInitialThickness();\n\n    if (horizontal) {\n      this.lengthAttribute_ = 'width';\n      this.positionAttribute_ = 'x';\n    } else {\n      this.lengthAttribute_ = 'height';\n      this.positionAttribute_ = 'y';\n    }\n\n    this.onMouseDownBarWrapper_ = browserEvents.conditionalBind(\n      this.svgBackground,\n      'pointerdown',\n      this,\n      this.onMouseDownBar,\n    );\n    this.onMouseDownHandleWrapper_ = browserEvents.conditionalBind(\n      this.svgHandle,\n      'pointerdown',\n      this,\n      this.onMouseDownHandle,\n    );\n  }\n\n  /**\n   * Set the size of the scrollbar DOM elements along the minor axis.\n   */\n  private setInitialThickness() {\n    const scrollbarThickness = Scrollbar.scrollbarThickness;\n    if (this.horizontal) {\n      this.svgBackground.setAttribute('height', String(scrollbarThickness));\n      this.outerSvg.setAttribute('height', String(scrollbarThickness));\n      this.svgHandle.setAttribute('height', String(scrollbarThickness - 5));\n      this.svgHandle.setAttribute('y', '2.5');\n    } else {\n      this.svgBackground.setAttribute('width', String(scrollbarThickness));\n      this.outerSvg.setAttribute('width', String(scrollbarThickness));\n      this.svgHandle.setAttribute('width', String(scrollbarThickness - 5));\n      this.svgHandle.setAttribute('x', '2.5');\n    }\n  }\n\n  /**\n   * Dispose of this scrollbar. Remove DOM elements, event listeners,\n   * and theme subscriptions.\n   */\n  dispose() {\n    this.cleanUp();\n    browserEvents.unbind(this.onMouseDownBarWrapper_);\n    browserEvents.unbind(this.onMouseDownHandleWrapper_);\n\n    dom.removeNode(this.outerSvg);\n    this.workspace.getThemeManager().unsubscribe(this.svgHandle);\n  }\n\n  /**\n   * Constrain the handle's length within the minimum (0) and maximum\n   * (scrollbar background) values allowed for the scrollbar.\n   *\n   * @param value Value that is potentially out of bounds, in CSS pixels.\n   * @returns Constrained value, in CSS pixels.\n   */\n  private constrainHandleLength(value: number): number {\n    if (value <= 0 || isNaN(value)) {\n      value = 0;\n    } else {\n      value = Math.min(value, this.scrollbarLength);\n    }\n    return value;\n  }\n\n  /**\n   * Set the length of the scrollbar's handle and change the SVG attribute\n   * accordingly.\n   *\n   * @param newLength The new scrollbar handle length in CSS pixels.\n   */\n  private setHandleLength(newLength: number) {\n    this.handleLength = newLength;\n    this.svgHandle.setAttribute(\n      this.lengthAttribute_,\n      String(this.handleLength),\n    );\n  }\n\n  /**\n   * Constrain the handle's position within the minimum (0) and maximum values\n   * allowed for the scrollbar.\n   *\n   * @param value Value that is potentially out of bounds, in CSS pixels.\n   * @returns Constrained value, in CSS pixels.\n   */\n  private constrainHandlePosition(value: number): number {\n    if (value <= 0 || isNaN(value)) {\n      value = 0;\n    } else {\n      // Handle length should never be greater than this.scrollbarLength_.\n      // If the viewSize is greater than or equal to the scrollSize, the\n      // handleLength will end up equal to this.scrollbarLength_.\n      value = Math.min(value, this.scrollbarLength - this.handleLength);\n    }\n    return value;\n  }\n\n  /**\n   * Set the offset of the scrollbar's handle from the scrollbar's position, and\n   * change the SVG attribute accordingly.\n   *\n   * @param newPosition The new scrollbar handle offset in CSS pixels.\n   */\n  setHandlePosition(newPosition: number) {\n    this.handlePosition = newPosition;\n    this.svgHandle.setAttribute(\n      this.positionAttribute_,\n      String(this.handlePosition),\n    );\n  }\n\n  /**\n   * Set the size of the scrollbar's background and change the SVG attribute\n   * accordingly.\n   *\n   * @param newSize The new scrollbar background length in CSS pixels.\n   */\n  private setScrollbarLength(newSize: number) {\n    this.scrollbarLength = newSize;\n    this.outerSvg.setAttribute(\n      this.lengthAttribute_,\n      String(this.scrollbarLength),\n    );\n    this.svgBackground.setAttribute(\n      this.lengthAttribute_,\n      String(this.scrollbarLength),\n    );\n  }\n\n  /**\n   * Set the position of the scrollbar's SVG group in CSS pixels relative to the\n   * scrollbar's origin.  This sets the scrollbar's location within the\n   * workspace.\n   *\n   * @param x The new x coordinate.\n   * @param y The new y coordinate.\n   * @internal\n   */\n  setPosition(x: number, y: number) {\n    this.position.x = x;\n    this.position.y = y;\n\n    const tempX = this.position.x + this.origin.x;\n    const tempY = this.position.y + this.origin.y;\n    const transform = 'translate(' + tempX + 'px,' + tempY + 'px)';\n    dom.setCssTransform(this.outerSvg, transform);\n  }\n\n  /**\n   * Recalculate the scrollbar's location and its length.\n   *\n   * @param opt_metrics A data structure of from the describing all the required\n   *     dimensions.  If not provided, it will be fetched from the host object.\n   */\n  resize(opt_metrics?: Metrics) {\n    // Determine the location, height and width of the host element.\n    let hostMetrics = opt_metrics;\n    if (!hostMetrics) {\n      hostMetrics = this.workspace.getMetrics();\n      if (!hostMetrics) {\n        // Host element is likely not visible.\n        return;\n      }\n    }\n\n    if (\n      this.oldHostMetrics &&\n      Scrollbar.metricsAreEquivalent(hostMetrics, this.oldHostMetrics)\n    ) {\n      return;\n    }\n\n    if (this.horizontal) {\n      this.resizeHorizontal(hostMetrics);\n    } else {\n      this.resizeVertical(hostMetrics);\n    }\n\n    this.oldHostMetrics = hostMetrics;\n\n    // Resizing may have caused some scrolling.\n    this.updateMetrics();\n  }\n\n  /**\n   * Returns whether the a resizeView is necessary by comparing the passed\n   * hostMetrics with cached old host metrics.\n   *\n   * @param hostMetrics A data structure describing all the required dimensions,\n   *     possibly fetched from the host object.\n   * @returns Whether a resizeView is necessary.\n   */\n  private requiresViewResize(hostMetrics: Metrics): boolean {\n    if (!this.oldHostMetrics) {\n      return true;\n    }\n    return (\n      this.oldHostMetrics.viewWidth !== hostMetrics.viewWidth ||\n      this.oldHostMetrics.viewHeight !== hostMetrics.viewHeight ||\n      this.oldHostMetrics.absoluteLeft !== hostMetrics.absoluteLeft ||\n      this.oldHostMetrics.absoluteTop !== hostMetrics.absoluteTop\n    );\n  }\n\n  /**\n   * Recalculate a horizontal scrollbar's location and length.\n   *\n   * @param hostMetrics A data structure describing all the required dimensions,\n   *     possibly fetched from the host object.\n   */\n  private resizeHorizontal(hostMetrics: Metrics) {\n    if (this.requiresViewResize(hostMetrics)) {\n      this.resizeViewHorizontal(hostMetrics);\n    } else {\n      this.resizeContentHorizontal(hostMetrics);\n    }\n  }\n\n  /**\n   * Recalculate a horizontal scrollbar's location on the screen and path\n   * length. This should be called when the layout or size of the window has\n   * changed.\n   *\n   * @param hostMetrics A data structure describing all the required dimensions,\n   *     possibly fetched from the host object.\n   */\n  resizeViewHorizontal(hostMetrics: Metrics) {\n    let viewSize = hostMetrics.viewWidth - this.margin * 2;\n    if (this.pair) {\n      // Shorten the scrollbar to make room for the corner square.\n      viewSize -= Scrollbar.scrollbarThickness;\n    }\n    this.setScrollbarLength(Math.max(0, viewSize));\n\n    let xCoordinate = hostMetrics.absoluteLeft + this.margin;\n    if (this.pair && this.workspace.RTL) {\n      xCoordinate += Scrollbar.scrollbarThickness;\n    }\n\n    // Horizontal toolbar should always be just above the bottom of the\n    // workspace.\n    const yCoordinate =\n      hostMetrics.absoluteTop +\n      hostMetrics.viewHeight -\n      Scrollbar.scrollbarThickness -\n      this.margin;\n    this.setPosition(xCoordinate, yCoordinate);\n\n    // If the view has been resized, a content resize will also be necessary.\n    // The reverse is not true.\n    this.resizeContentHorizontal(hostMetrics);\n  }\n\n  /**\n   * Recalculate a horizontal scrollbar's location within its path and length.\n   * This should be called when the contents of the workspace have changed.\n   *\n   * @param hostMetrics A data structure describing all the required dimensions,\n   *     possibly fetched from the host object.\n   */\n  resizeContentHorizontal(hostMetrics: Metrics) {\n    if (hostMetrics.viewWidth >= hostMetrics.scrollWidth) {\n      // viewWidth is often greater than scrollWidth in flyouts and\n      // non-scrollable workspaces.\n      this.setHandleLength(this.scrollbarLength);\n      this.setHandlePosition(0);\n      if (!this.pair) {\n        // The scrollbar isn't needed.\n        // This doesn't apply to scrollbar pairs because interactions with the\n        // corner square aren't handled.\n        this.setVisible(false);\n      }\n      return;\n    } else if (!this.pair) {\n      // The scrollbar is needed. Only non-paired scrollbars are hidden/shown.\n      this.setVisible(true);\n    }\n\n    // Resize the handle.\n    let handleLength =\n      (this.scrollbarLength * hostMetrics.viewWidth) / hostMetrics.scrollWidth;\n    handleLength = this.constrainHandleLength(handleLength);\n    this.setHandleLength(handleLength);\n\n    // Compute the handle offset.\n    // The position of the handle can be between:\n    //     0 and this.scrollbarLength_ - handleLength\n    // If viewLeft === scrollLeft\n    //     then the offset should be 0\n    // If viewRight === scrollRight\n    //     then viewLeft = scrollLeft + scrollWidth - viewWidth\n    //     then the offset should be max offset\n\n    const maxScrollDistance = hostMetrics.scrollWidth - hostMetrics.viewWidth;\n    const contentDisplacement = hostMetrics.viewLeft - hostMetrics.scrollLeft;\n    // Percent of content to the left of our current position.\n    const offsetRatio = contentDisplacement / maxScrollDistance;\n    // Area available to scroll * percent to the left\n    const maxHandleOffset = this.scrollbarLength - this.handleLength;\n    let handleOffset = maxHandleOffset * offsetRatio;\n    handleOffset = this.constrainHandlePosition(handleOffset);\n    this.setHandlePosition(handleOffset);\n\n    // Compute ratio (for use with set calls, which pass in content\n    // displacement).\n    this.ratio = maxHandleOffset / maxScrollDistance;\n  }\n\n  /**\n   * Recalculate a vertical scrollbar's location and length.\n   *\n   * @param hostMetrics A data structure describing all the required dimensions,\n   *     possibly fetched from the host object.\n   */\n  private resizeVertical(hostMetrics: Metrics) {\n    if (this.requiresViewResize(hostMetrics)) {\n      this.resizeViewVertical(hostMetrics);\n    } else {\n      this.resizeContentVertical(hostMetrics);\n    }\n  }\n\n  /**\n   * Recalculate a vertical scrollbar's location on the screen and path length.\n   * This should be called when the layout or size of the window has changed.\n   *\n   * @param hostMetrics A data structure describing all the required dimensions,\n   *     possibly fetched from the host object.\n   */\n  resizeViewVertical(hostMetrics: Metrics) {\n    let viewSize = hostMetrics.viewHeight - this.margin * 2;\n    if (this.pair) {\n      // Shorten the scrollbar to make room for the corner square.\n      viewSize -= Scrollbar.scrollbarThickness;\n    }\n    this.setScrollbarLength(Math.max(0, viewSize));\n\n    const xCoordinate = this.workspace.RTL\n      ? hostMetrics.absoluteLeft + this.margin\n      : hostMetrics.absoluteLeft +\n        hostMetrics.viewWidth -\n        Scrollbar.scrollbarThickness -\n        this.margin;\n\n    const yCoordinate = hostMetrics.absoluteTop + this.margin;\n    this.setPosition(xCoordinate, yCoordinate);\n\n    // If the view has been resized, a content resize will also be necessary.\n    // The reverse is not true.\n    this.resizeContentVertical(hostMetrics);\n  }\n\n  /**\n   * Recalculate a vertical scrollbar's location within its path and length.\n   * This should be called when the contents of the workspace have changed.\n   *\n   * @param hostMetrics A data structure describing all the required dimensions,\n   *     possibly fetched from the host object.\n   */\n  resizeContentVertical(hostMetrics: Metrics) {\n    if (hostMetrics.viewHeight >= hostMetrics.scrollHeight) {\n      // viewHeight is often greater than scrollHeight in flyouts and\n      // non-scrollable workspaces.\n      this.setHandleLength(this.scrollbarLength);\n      this.setHandlePosition(0);\n      if (!this.pair) {\n        // The scrollbar isn't needed.\n        // This doesn't apply to scrollbar pairs because interactions with the\n        // corner square aren't handled.\n        this.setVisible(false);\n      }\n      return;\n    } else if (!this.pair) {\n      // The scrollbar is needed. Only non-paired scrollbars are hidden/shown.\n      this.setVisible(true);\n    }\n\n    // Resize the handle.\n    let handleLength =\n      (this.scrollbarLength * hostMetrics.viewHeight) /\n      hostMetrics.scrollHeight;\n    handleLength = this.constrainHandleLength(handleLength);\n    this.setHandleLength(handleLength);\n\n    // Compute the handle offset.\n    // The position of the handle can be between:\n    //     0 and this.scrollbarLength_ - handleLength\n    // If viewTop === scrollTop\n    //     then the offset should be 0\n    // If viewBottom === scrollBottom\n    //     then viewTop = scrollTop + scrollHeight - viewHeight\n    //     then the offset should be max offset\n\n    const maxScrollDistance = hostMetrics.scrollHeight - hostMetrics.viewHeight;\n    const contentDisplacement = hostMetrics.viewTop - hostMetrics.scrollTop;\n    // Percent of content to the left of our current position.\n    const offsetRatio = contentDisplacement / maxScrollDistance;\n    // Area available to scroll * percent to the left\n    const maxHandleOffset = this.scrollbarLength - this.handleLength;\n    let handleOffset = maxHandleOffset * offsetRatio;\n    handleOffset = this.constrainHandlePosition(handleOffset);\n    this.setHandlePosition(handleOffset);\n\n    // Compute ratio (for use with set calls, which pass in content\n    // displacement).\n    this.ratio = maxHandleOffset / maxScrollDistance;\n  }\n\n  /**\n   * Is the scrollbar visible.  Non-paired scrollbars disappear when they aren't\n   * needed.\n   *\n   * @returns True if visible.\n   */\n  isVisible(): boolean {\n    return this.isHandleVisible;\n  }\n\n  /**\n   * Set whether the scrollbar's container is visible and update\n   * display accordingly if visibility has changed.\n   *\n   * @param visible Whether the container is visible\n   */\n  setContainerVisible(visible: boolean) {\n    const visibilityChanged = visible !== this.containerVisible;\n\n    this.containerVisible = visible;\n    if (visibilityChanged) {\n      this.updateDisplay_();\n    }\n  }\n\n  /**\n   * Set whether the scrollbar is visible.\n   * Only applies to non-paired scrollbars.\n   *\n   * @param visible True if visible.\n   */\n  setVisible(visible: boolean) {\n    // Ideally this would also apply to scrollbar pairs, but that's a bigger\n    // headache (due to interactions with the corner square), and the fact\n    // that telling the pair to resize itself would cause circular dependencies.\n    if (this.pair) {\n      throw Error('Unable to toggle visibility of paired scrollbars.');\n    }\n    this.setVisibleInternal(visible);\n  }\n\n  /**\n   * Set whether the scrollbar is visible. Bypasses checking whether this\n   * scrollbar is part of a pair so that it can be toggled by the scrollbar\n   * pair.\n   *\n   * @param visible True if visible.\n   * @internal\n   */\n  setVisibleInternal(visible: boolean) {\n    const visibilityChanged = visible !== this.isVisible();\n    this.isHandleVisible = visible;\n    if (visibilityChanged) {\n      this.updateDisplay_();\n    }\n  }\n\n  /**\n   * Update visibility of scrollbar based on whether it thinks it should\n   * be visible and whether its containing workspace is visible.\n   * We cannot rely on the containing workspace being hidden to hide us\n   * because it is not necessarily our parent in the DOM.\n   */\n  updateDisplay_() {\n    let show = true;\n    // Check whether our parent/container is visible.\n    if (!this.containerVisible) {\n      show = false;\n    } else {\n      show = this.isVisible();\n    }\n    if (show) {\n      this.outerSvg.setAttribute('display', 'block');\n    } else {\n      this.outerSvg.setAttribute('display', 'none');\n    }\n  }\n\n  /**\n   * Scroll by one pageful.\n   * Called when scrollbar background is clicked.\n   *\n   * @param e Mouse down event.\n   */\n  private onMouseDownBar(e: MouseEvent) {\n    this.workspace.markFocused();\n    Touch.clearTouchIdentifier(); // This is really a click.\n    this.cleanUp();\n    if (browserEvents.isRightButton(e)) {\n      // Right-click.\n      // Scrollbars have no context menu.\n      e.stopPropagation();\n      return;\n    }\n    const mouseXY = browserEvents.mouseToSvg(\n      e,\n      this.workspace.getParentSvg(),\n      this.workspace.getInverseScreenCTM(),\n    );\n    const mouseLocation = this.horizontal ? mouseXY.x : mouseXY.y;\n\n    const handleXY = svgMath.getInjectionDivXY(this.svgHandle);\n    const handleStart = this.horizontal ? handleXY.x : handleXY.y;\n    let handlePosition = this.handlePosition;\n\n    const pageLength = this.handleLength * 0.95;\n    if (mouseLocation <= handleStart) {\n      // Decrease the scrollbar's value by a page.\n      handlePosition -= pageLength;\n    } else if (mouseLocation >= handleStart + this.handleLength) {\n      // Increase the scrollbar's value by a page.\n      handlePosition += pageLength;\n    }\n\n    this.setHandlePosition(this.constrainHandlePosition(handlePosition));\n\n    this.updateMetrics();\n    e.stopPropagation();\n    e.preventDefault();\n  }\n\n  /**\n   * Start a dragging operation.\n   * Called when scrollbar handle is clicked.\n   *\n   * @param e Mouse down event.\n   */\n  private onMouseDownHandle(e: PointerEvent) {\n    this.workspace.markFocused();\n    this.cleanUp();\n    if (browserEvents.isRightButton(e)) {\n      // Right-click.\n      // Scrollbars have no context menu.\n      e.stopPropagation();\n      return;\n    }\n    // Look up the current translation and record it.\n    this.startDragHandle = this.handlePosition;\n\n    // Record the current mouse position.\n    this.startDragMouse = this.horizontal ? e.clientX : e.clientY;\n    this.onMouseUpWrapper_ = browserEvents.conditionalBind(\n      document,\n      'pointerup',\n      this,\n      this.onMouseUpHandle,\n    );\n    this.onMouseMoveWrapper_ = browserEvents.conditionalBind(\n      document,\n      'pointermove',\n      this,\n      this.onMouseMoveHandle,\n    );\n    e.stopPropagation();\n    e.preventDefault();\n  }\n\n  /**\n   * Drag the scrollbar's handle.\n   *\n   * @param e Mouse move event.\n   */\n  private onMouseMoveHandle(e: PointerEvent) {\n    const currentMouse = this.horizontal ? e.clientX : e.clientY;\n    const mouseDelta = currentMouse - this.startDragMouse;\n    const handlePosition = this.startDragHandle + mouseDelta;\n    // Position the bar.\n    this.setHandlePosition(this.constrainHandlePosition(handlePosition));\n    this.updateMetrics();\n  }\n\n  /** Release the scrollbar handle and reset state accordingly. */\n  private onMouseUpHandle() {\n    Touch.clearTouchIdentifier();\n    this.cleanUp();\n  }\n\n  /**\n   * Hide chaff and stop binding to mouseup and mousemove events.  Call this to\n   * wrap up loose ends associated with the scrollbar.\n   */\n  private cleanUp() {\n    this.workspace.hideChaff(true);\n    if (this.onMouseUpWrapper_) {\n      browserEvents.unbind(this.onMouseUpWrapper_);\n      this.onMouseUpWrapper_ = null;\n    }\n    if (this.onMouseMoveWrapper_) {\n      browserEvents.unbind(this.onMouseMoveWrapper_);\n      this.onMouseMoveWrapper_ = null;\n    }\n  }\n\n  /**\n   * Helper to calculate the ratio of handle position to scrollbar view size.\n   *\n   * @returns Ratio.\n   * @internal\n   */\n  getRatio_(): number {\n    const scrollHandleRange = this.scrollbarLength - this.handleLength;\n    let ratio = this.handlePosition / scrollHandleRange;\n    if (isNaN(ratio)) {\n      ratio = 0;\n    }\n    return ratio;\n  }\n\n  /**\n   * Updates workspace metrics based on new scroll ratio. Called when scrollbar\n   * is moved.\n   */\n  private updateMetrics() {\n    const ratio = this.getRatio_();\n    if (this.horizontal) {\n      this.workspace.setMetrics({x: ratio});\n    } else {\n      this.workspace.setMetrics({y: ratio});\n    }\n  }\n\n  /**\n   * Set the scrollbar handle's position.\n   *\n   * @param value The content displacement, relative to the view in pixels.\n   * @param updateMetrics Whether to update metrics on this set call.\n   *    Defaults to true.\n   */\n  set(value: number, updateMetrics?: boolean) {\n    this.setHandlePosition(this.constrainHandlePosition(value * this.ratio));\n    if (updateMetrics || updateMetrics === undefined) {\n      this.updateMetrics();\n    }\n  }\n\n  /**\n   * Record the origin of the workspace that the scrollbar is in, in pixels\n   * relative to the injection div origin. This is for times when the scrollbar\n   * is used in an object whose origin isn't the same as the main workspace\n   * (e.g. in a flyout.)\n   *\n   * @param x The x coordinate of the scrollbar's origin, in CSS pixels.\n   * @param y The y coordinate of the scrollbar's origin, in CSS pixels.\n   */\n  setOrigin(x: number, y: number) {\n    this.origin = new Coordinate(x, y);\n  }\n\n  /**\n   * @param first An object containing computed measurements of a workspace.\n   * @param second Another object containing computed measurements of a\n   *     workspace.\n   * @returns Whether the two sets of metrics are equivalent.\n   */\n  private static metricsAreEquivalent(\n    first: Metrics,\n    second: Metrics,\n  ): boolean {\n    return (\n      first.viewWidth === second.viewWidth &&\n      first.viewHeight === second.viewHeight &&\n      first.viewLeft === second.viewLeft &&\n      first.viewTop === second.viewTop &&\n      first.absoluteTop === second.absoluteTop &&\n      first.absoluteLeft === second.absoluteLeft &&\n      first.scrollWidth === second.scrollWidth &&\n      first.scrollHeight === second.scrollHeight &&\n      first.scrollLeft === second.scrollLeft &&\n      first.scrollTop === second.scrollTop\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2022 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Contains the path to a single png tat holds the images for the trashcan\n * as well as the zoom controls.\n */\nexport const SPRITE = {\n  width: 96,\n  height: 124,\n  url: 'sprites.png',\n};\n","/**\n * @license\n * Copyright 2015 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a zoom icons.\n *\n * @class\n */\n// Former goog.module ID: Blockly.ZoomControls\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_click.js';\n\nimport * as browserEvents from './browser_events.js';\nimport {ComponentManager} from './component_manager.js';\nimport * as Css from './css.js';\nimport * as eventUtils from './events/utils.js';\nimport type {IPositionable} from './interfaces/i_positionable.js';\nimport type {UiMetrics} from './metrics_manager.js';\nimport * as uiPosition from './positionable_helpers.js';\nimport {SPRITE} from './sprites.js';\nimport * as Touch from './touch.js';\nimport * as dom from './utils/dom.js';\nimport {Rect} from './utils/rect.js';\nimport {Size} from './utils/size.js';\nimport {Svg} from './utils/svg.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Class for a zoom controls.\n */\nexport class ZoomControls implements IPositionable {\n  /**\n   * The unique ID for this component that is used to register with the\n   * ComponentManager.\n   */\n  id = 'zoomControls';\n\n  /**\n   * Array holding info needed to unbind events.\n   * Used for disposing.\n   * Ex: [[node, name, func], [node, name, func]].\n   */\n  private boundEvents: browserEvents.Data[] = [];\n\n  /** The zoom in svg <g> element. */\n  private zoomInGroup: SVGGElement | null = null;\n\n  /** The zoom out svg <g> element. */\n  private zoomOutGroup: SVGGElement | null = null;\n\n  /** The zoom reset svg <g> element. */\n  private zoomResetGroup: SVGGElement | null = null;\n\n  /** Width of the zoom controls. */\n  private readonly WIDTH = 32;\n\n  /** Height of each zoom control. */\n  private readonly HEIGHT = 32;\n\n  /** Small spacing used between the zoom in and out control, in pixels. */\n  private readonly SMALL_SPACING = 2;\n\n  /**\n   * Large spacing used between the zoom in and reset control, in pixels.\n   */\n  private readonly LARGE_SPACING = 11;\n\n  /** Distance between zoom controls and bottom or top edge of workspace. */\n  private readonly MARGIN_VERTICAL = 20;\n\n  /** Distance between zoom controls and right or left edge of workspace. */\n  private readonly MARGIN_HORIZONTAL = 20;\n\n  /** The SVG group containing the zoom controls. */\n  private svgGroup: SVGElement | null = null;\n\n  /** Left coordinate of the zoom controls. */\n  private left = 0;\n\n  /** Top coordinate of the zoom controls. */\n  private top = 0;\n\n  /** Whether this has been initialized. */\n  private initialized = false;\n\n  /** @param workspace The workspace to sit in. */\n  constructor(private readonly workspace: WorkspaceSvg) {}\n\n  /**\n   * Create the zoom controls.\n   *\n   * @returns The zoom controls SVG group.\n   */\n  createDom(): SVGElement {\n    this.svgGroup = dom.createSvgElement(Svg.G, {});\n\n    // Each filter/pattern needs a unique ID for the case of multiple Blockly\n    // instances on a page.  Browser behaviour becomes undefined otherwise.\n    // https://neil.fraser.name/news/2015/11/01/\n    const rnd = String(Math.random()).substring(2);\n    this.createZoomOutSvg(rnd);\n    this.createZoomInSvg(rnd);\n    if (this.workspace.isMovable()) {\n      // If we zoom to the center and the workspace isn't movable we could\n      // loose blocks at the edges of the workspace.\n      this.createZoomResetSvg(rnd);\n    }\n    return this.svgGroup;\n  }\n\n  /** Initializes the zoom controls. */\n  init() {\n    this.workspace.getComponentManager().addComponent({\n      component: this,\n      weight: 2,\n      capabilities: [ComponentManager.Capability.POSITIONABLE],\n    });\n    this.initialized = true;\n  }\n\n  /**\n   * Disposes of this zoom controls.\n   * Unlink from all DOM elements to prevent memory leaks.\n   */\n  dispose() {\n    this.workspace.getComponentManager().removeComponent('zoomControls');\n    if (this.svgGroup) {\n      dom.removeNode(this.svgGroup);\n    }\n    for (const event of this.boundEvents) {\n      browserEvents.unbind(event);\n    }\n    this.boundEvents.length = 0;\n  }\n\n  /**\n   * Returns the bounding rectangle of the UI element in pixel units relative to\n   * the Blockly injection div.\n   *\n   * @returns The UI elements's bounding box. Null if bounding box should be\n   *     ignored by other UI elements.\n   */\n  getBoundingRectangle(): Rect | null {\n    let height = this.SMALL_SPACING + 2 * this.HEIGHT;\n    if (this.zoomResetGroup) {\n      height += this.LARGE_SPACING + this.HEIGHT;\n    }\n    const bottom = this.top + height;\n    const right = this.left + this.WIDTH;\n    return new Rect(this.top, bottom, this.left, right);\n  }\n\n  /**\n   * Positions the zoom controls.\n   * It is positioned in the opposite corner to the corner the\n   * categories/toolbox starts at.\n   *\n   * @param metrics The workspace metrics.\n   * @param savedPositions List of rectangles that are already on the workspace.\n   */\n  position(metrics: UiMetrics, savedPositions: Rect[]) {\n    // Not yet initialized.\n    if (!this.initialized) {\n      return;\n    }\n\n    const cornerPosition = uiPosition.getCornerOppositeToolbox(\n      this.workspace,\n      metrics,\n    );\n    let height = this.SMALL_SPACING + 2 * this.HEIGHT;\n    if (this.zoomResetGroup) {\n      height += this.LARGE_SPACING + this.HEIGHT;\n    }\n    const startRect = uiPosition.getStartPositionRect(\n      cornerPosition,\n      new Size(this.WIDTH, height),\n      this.MARGIN_HORIZONTAL,\n      this.MARGIN_VERTICAL,\n      metrics,\n      this.workspace,\n    );\n\n    const verticalPosition = cornerPosition.vertical;\n    const bumpDirection =\n      verticalPosition === uiPosition.verticalPosition.TOP\n        ? uiPosition.bumpDirection.DOWN\n        : uiPosition.bumpDirection.UP;\n    const positionRect = uiPosition.bumpPositionRect(\n      startRect,\n      this.MARGIN_VERTICAL,\n      bumpDirection,\n      savedPositions,\n    );\n\n    if (verticalPosition === uiPosition.verticalPosition.TOP) {\n      const zoomInTranslateY = this.SMALL_SPACING + this.HEIGHT;\n      this.zoomInGroup?.setAttribute(\n        'transform',\n        'translate(0, ' + zoomInTranslateY + ')',\n      );\n      if (this.zoomResetGroup) {\n        const zoomResetTranslateY =\n          zoomInTranslateY + this.LARGE_SPACING + this.HEIGHT;\n        this.zoomResetGroup.setAttribute(\n          'transform',\n          'translate(0, ' + zoomResetTranslateY + ')',\n        );\n      }\n    } else {\n      const zoomInTranslateY = this.zoomResetGroup\n        ? this.LARGE_SPACING + this.HEIGHT\n        : 0;\n      this.zoomInGroup?.setAttribute(\n        'transform',\n        'translate(0, ' + zoomInTranslateY + ')',\n      );\n      const zoomOutTranslateY =\n        zoomInTranslateY + this.SMALL_SPACING + this.HEIGHT;\n      this.zoomOutGroup?.setAttribute(\n        'transform',\n        'translate(0, ' + zoomOutTranslateY + ')',\n      );\n    }\n\n    this.top = positionRect.top;\n    this.left = positionRect.left;\n    this.svgGroup?.setAttribute(\n      'transform',\n      'translate(' + this.left + ',' + this.top + ')',\n    );\n  }\n\n  /**\n   * Create the zoom in icon and its event handler.\n   *\n   * @param rnd The random string to use as a suffix in the clip path's ID.\n   *     These IDs must be unique in case there are multiple Blockly instances\n   *     on the same page.\n   */\n  private createZoomOutSvg(rnd: string) {\n    /* This markup will be generated and added to the .svgGroup:\n        <g class=\"blocklyZoom\">\n          <clipPath id=\"blocklyZoomoutClipPath837493\">\n            <rect width=\"32\" height=\"32></rect>\n          </clipPath>\n          <image width=\"96\" height=\"124\" x=\"-64\" y=\"-92\"\n        xlink:href=\"media/sprites.png\"\n              clip-path=\"url(#blocklyZoomoutClipPath837493)\"></image>\n        </g>\n        */\n    this.zoomOutGroup = dom.createSvgElement(\n      Svg.G,\n      {'class': 'blocklyZoom blocklyZoomOut'},\n      this.svgGroup,\n    );\n    const clip = dom.createSvgElement(\n      Svg.CLIPPATH,\n      {'id': 'blocklyZoomoutClipPath' + rnd},\n      this.zoomOutGroup,\n    );\n    dom.createSvgElement(\n      Svg.RECT,\n      {\n        'width': 32,\n        'height': 32,\n      },\n      clip,\n    );\n    const zoomoutSvg = dom.createSvgElement(\n      Svg.IMAGE,\n      {\n        'width': SPRITE.width,\n        'height': SPRITE.height,\n        'x': -64,\n        'y': -92,\n        'clip-path': 'url(#blocklyZoomoutClipPath' + rnd + ')',\n      },\n      this.zoomOutGroup,\n    );\n    zoomoutSvg.setAttributeNS(\n      dom.XLINK_NS,\n      'xlink:href',\n      this.workspace.options.pathToMedia + SPRITE.url,\n    );\n\n    // Attach listener.\n    this.boundEvents.push(\n      browserEvents.conditionalBind(\n        this.zoomOutGroup,\n        'pointerdown',\n        null,\n        this.zoom.bind(this, -1),\n      ),\n    );\n  }\n\n  /**\n   * Create the zoom out icon and its event handler.\n   *\n   * @param rnd The random string to use as a suffix in the clip path's ID.\n   *     These IDs must be unique in case there are multiple Blockly instances\n   *     on the same page.\n   */\n  private createZoomInSvg(rnd: string) {\n    /* This markup will be generated and added to the .svgGroup:\n        <g class=\"blocklyZoom\">\n          <clipPath id=\"blocklyZoominClipPath837493\">\n            <rect width=\"32\" height=\"32\"></rect>\n          </clipPath>\n          <image width=\"96\" height=\"124\" x=\"-32\" y=\"-92\"\n        xlink:href=\"media/sprites.png\"\n              clip-path=\"url(#blocklyZoominClipPath837493)\"></image>\n        </g>\n        */\n    this.zoomInGroup = dom.createSvgElement(\n      Svg.G,\n      {'class': 'blocklyZoom blocklyZoomIn'},\n      this.svgGroup,\n    );\n    const clip = dom.createSvgElement(\n      Svg.CLIPPATH,\n      {'id': 'blocklyZoominClipPath' + rnd},\n      this.zoomInGroup,\n    );\n    dom.createSvgElement(\n      Svg.RECT,\n      {\n        'width': 32,\n        'height': 32,\n      },\n      clip,\n    );\n    const zoominSvg = dom.createSvgElement(\n      Svg.IMAGE,\n      {\n        'width': SPRITE.width,\n        'height': SPRITE.height,\n        'x': -32,\n        'y': -92,\n        'clip-path': 'url(#blocklyZoominClipPath' + rnd + ')',\n      },\n      this.zoomInGroup,\n    );\n    zoominSvg.setAttributeNS(\n      dom.XLINK_NS,\n      'xlink:href',\n      this.workspace.options.pathToMedia + SPRITE.url,\n    );\n\n    // Attach listener.\n    this.boundEvents.push(\n      browserEvents.conditionalBind(\n        this.zoomInGroup,\n        'pointerdown',\n        null,\n        this.zoom.bind(this, 1),\n      ),\n    );\n  }\n\n  /**\n   * Handles a mouse down event on the zoom in or zoom out buttons on the\n   *    workspace.\n   *\n   * @param amount Amount of zooming. Negative amount values zoom out, and\n   *     positive amount values zoom in.\n   * @param e A mouse down event.\n   */\n  private zoom(amount: number, e: PointerEvent) {\n    this.workspace.markFocused();\n    this.workspace.zoomCenter(amount);\n    this.fireZoomEvent();\n    Touch.clearTouchIdentifier(); // Don't block future drags.\n    e.stopPropagation(); // Don't start a workspace scroll.\n    e.preventDefault(); // Stop double-clicking from selecting text.\n  }\n\n  /**\n   * Create the zoom reset icon and its event handler.\n   *\n   * @param rnd The random string to use as a suffix in the clip path's ID.\n   *     These IDs must be unique in case there are multiple Blockly instances\n   *     on the same page.\n   */\n  private createZoomResetSvg(rnd: string) {\n    /* This markup will be generated and added to the .svgGroup:\n        <g class=\"blocklyZoom\">\n          <clipPath id=\"blocklyZoomresetClipPath837493\">\n            <rect width=\"32\" height=\"32\"></rect>\n          </clipPath>\n          <image width=\"96\" height=\"124\" x=\"-32\" y=\"-92\"\n        xlink:href=\"media/sprites.png\"\n              clip-path=\"url(#blocklyZoomresetClipPath837493)\"></image>\n        </g>\n        */\n    this.zoomResetGroup = dom.createSvgElement(\n      Svg.G,\n      {'class': 'blocklyZoom blocklyZoomReset'},\n      this.svgGroup,\n    );\n    const clip = dom.createSvgElement(\n      Svg.CLIPPATH,\n      {'id': 'blocklyZoomresetClipPath' + rnd},\n      this.zoomResetGroup,\n    );\n    dom.createSvgElement(Svg.RECT, {'width': 32, 'height': 32}, clip);\n    const zoomresetSvg = dom.createSvgElement(\n      Svg.IMAGE,\n      {\n        'width': SPRITE.width,\n        'height': SPRITE.height,\n        'y': -92,\n        'clip-path': 'url(#blocklyZoomresetClipPath' + rnd + ')',\n      },\n      this.zoomResetGroup,\n    );\n    zoomresetSvg.setAttributeNS(\n      dom.XLINK_NS,\n      'xlink:href',\n      this.workspace.options.pathToMedia + SPRITE.url,\n    );\n\n    // Attach event listeners.\n    this.boundEvents.push(\n      browserEvents.conditionalBind(\n        this.zoomResetGroup,\n        'pointerdown',\n        null,\n        this.resetZoom.bind(this),\n      ),\n    );\n  }\n\n  /**\n   * Handles a mouse down event on the reset zoom button on the workspace.\n   *\n   * @param e A mouse down event.\n   */\n  private resetZoom(e: PointerEvent) {\n    this.workspace.markFocused();\n\n    // zoom is passed amount and computes the new scale using the formula:\n    // targetScale = currentScale * Math.pow(speed, amount)\n    const targetScale = this.workspace.options.zoomOptions.startScale;\n    const currentScale = this.workspace.scale;\n    const speed = this.workspace.options.zoomOptions.scaleSpeed;\n    // To compute amount:\n    // amount = log(speed, (targetScale / currentScale))\n    // Math.log computes natural logarithm (ln), to change the base, use\n    // formula: log(base, value) = ln(value) / ln(base)\n    const amount = Math.log(targetScale / currentScale) / Math.log(speed);\n    this.workspace.beginCanvasTransition();\n    this.workspace.zoomCenter(amount);\n    this.workspace.scrollCenter();\n\n    setTimeout(this.workspace.endCanvasTransition.bind(this.workspace), 500);\n    this.fireZoomEvent();\n    Touch.clearTouchIdentifier(); // Don't block future drags.\n    e.stopPropagation(); // Don't start a workspace scroll.\n    e.preventDefault(); // Stop double-clicking from selecting text.\n  }\n\n  /** Fires a zoom control UI event. */\n  private fireZoomEvent() {\n    const uiEvent = new (eventUtils.get(eventUtils.CLICK))(\n      null,\n      this.workspace.id,\n      'zoom_controls',\n    );\n    eventUtils.fire(uiEvent);\n  }\n}\n\n/** CSS for zoom controls.  See css.js for use. */\nCss.register(`\n.blocklyZoom>image, .blocklyZoom>svg>image {\n  opacity: .4;\n}\n\n.blocklyZoom>image:hover, .blocklyZoom>svg>image:hover {\n  opacity: .6;\n}\n\n.blocklyZoom>image:active, .blocklyZoom>svg>image:active {\n  opacity: .8;\n}\n`);\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {IIcon} from '../interfaces/i_icon.js';\nimport {CommentIcon} from './comment_icon.js';\nimport {MutatorIcon} from './mutator_icon.js';\nimport {WarningIcon} from './warning_icon.js';\n\n/**\n * Defines the type of an icon, so that it can be retrieved from block.getIcon\n */\nexport class IconType<_T extends IIcon> {\n  /** @param name The name of the registry type. */\n  constructor(private readonly name: string) {}\n\n  /** @returns the name of the type. */\n  toString(): string {\n    return this.name;\n  }\n\n  /** @returns true if this icon type is equivalent to the given icon type. */\n  equals(type: IconType<IIcon>): boolean {\n    return this.name === type.toString();\n  }\n\n  static MUTATOR = new IconType<MutatorIcon>('mutator');\n  static WARNING = new IconType<WarningIcon>('warning');\n  static COMMENT = new IconType<CommentIcon>('comment');\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.inputTypes\n\nimport {ConnectionType} from '../connection_type.js';\n\n/**\n * Enum for the type of a connection or input.\n */\nexport enum inputTypes {\n  // A right-facing value input.  E.g. 'set item to' or 'return'.\n  VALUE = ConnectionType.INPUT_VALUE,\n  // A down-facing block stack.  E.g. 'if-do' or 'else'.\n  STATEMENT = ConnectionType.NEXT_STATEMENT,\n  // A dummy input.  Used to add field(s) with no input.\n  DUMMY = 5,\n  // An unknown type of input defined by an external developer.\n  CUSTOM = 6,\n  // An input with no connections that is always the last input of a row. Any\n  // subsequent input will be rendered on the next row. Any newline character in\n  // a JSON block definition's message will be parsed as an end-row input.\n  END_ROW = 7,\n}\n","/**\n * @license\n * Copyright 2013 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.Msg\n\n/** A dictionary of localised messages. */\nexport const Msg: {[key: string]: string} = Object.create(null);\n\n/**\n * Sets the locale (i.e. the localized messages/block-text/etc) to the given\n * locale.\n *\n * This is not useful/necessary when loading from a script tag, because the\n * messages are automatically cluged into the Blockly.Msg object. But we provide\n * it in both the script-tag and non-script-tag contexts so that the tscompiler\n * can properly create our type definition files.\n *\n * @param locale An object defining the messages for a given language.\n */\nexport const setLocale = function (locale: {[key: string]: string}) {\n  Object.keys(locale).forEach(function (k) {\n    Msg[k] = locale[k];\n  });\n};\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Abstract class for a variable event.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.VarBase\n\nimport type {VariableModel} from '../variable_model.js';\n\nimport {\n  Abstract as AbstractEvent,\n  AbstractEventJson,\n} from './events_abstract.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Abstract class for a variable event.\n */\nexport class VarBase extends AbstractEvent {\n  override isBlank = true;\n  /** The ID of the variable this event references. */\n  varId?: string;\n\n  /**\n   * @param opt_variable The variable this event corresponds to.  Undefined for\n   *     a blank event.\n   */\n  constructor(opt_variable?: VariableModel) {\n    super();\n    this.isBlank = typeof opt_variable === 'undefined';\n    if (!opt_variable) return;\n\n    this.varId = opt_variable.getId();\n    this.workspaceId = opt_variable.workspace.id;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): VarBaseJson {\n    const json = super.toJson() as VarBaseJson;\n    if (!this.varId) {\n      throw new Error(\n        'The var ID is undefined. Either pass a variable to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    json['varId'] = this.varId;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of VarBase, but we can't specify that due to the fact that parameters\n   *     to static methods in subclasses must be supertypes of parameters to\n   *     static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: VarBaseJson,\n    workspace: Workspace,\n    event?: any,\n  ): VarBase {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new VarBase(),\n    ) as VarBase;\n    newEvent.varId = json['varId'];\n    return newEvent;\n  }\n}\n\nexport interface VarBaseJson extends AbstractEventJson {\n  varId: string;\n}\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for a variable creation event.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.VarCreate\n\nimport * as registry from '../registry.js';\nimport type {VariableModel} from '../variable_model.js';\n\nimport {VarBase, VarBaseJson} from './events_var_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners that a variable model has been created.\n */\nexport class VarCreate extends VarBase {\n  override type = eventUtils.VAR_CREATE;\n\n  /** The type of the variable that was created. */\n  varType?: string;\n\n  /** The name of the variable that was created. */\n  varName?: string;\n\n  /**\n   * @param opt_variable The created variable. Undefined for a blank event.\n   */\n  constructor(opt_variable?: VariableModel) {\n    super(opt_variable);\n\n    if (!opt_variable) {\n      return; // Blank event to be populated by fromJson.\n    }\n    this.varType = opt_variable.type;\n    this.varName = opt_variable.name;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): VarCreateJson {\n    const json = super.toJson() as VarCreateJson;\n    if (this.varType === undefined) {\n      throw new Error(\n        'The var type is undefined. Either pass a variable to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (!this.varName) {\n      throw new Error(\n        'The var name is undefined. Either pass a variable to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    json['varType'] = this.varType;\n    json['varName'] = this.varName;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of VarCreate, but we can't specify that due to the fact that parameters\n   *     to static methods in subclasses must be supertypes of parameters to\n   *     static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: VarCreateJson,\n    workspace: Workspace,\n    event?: any,\n  ): VarCreate {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new VarCreate(),\n    ) as VarCreate;\n    newEvent.varType = json['varType'];\n    newEvent.varName = json['varName'];\n    return newEvent;\n  }\n\n  /**\n   * Run a variable creation event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    if (!this.varId) {\n      throw new Error(\n        'The var ID is undefined. Either pass a variable to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (!this.varName) {\n      throw new Error(\n        'The var name is undefined. Either pass a variable to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (forward) {\n      workspace.createVariable(this.varName, this.varType, this.varId);\n    } else {\n      workspace.deleteVariableById(this.varId);\n    }\n  }\n}\n\nexport interface VarCreateJson extends VarBaseJson {\n  varType: string;\n  varName: string;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.VAR_CREATE, VarCreate);\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Components for the variable model.\n *\n * @class\n */\n// Former goog.module ID: Blockly.VariableModel\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_var_create.js';\n\nimport * as idGenerator from './utils/idgenerator.js';\nimport type {Workspace} from './workspace.js';\n\n/**\n * Class for a variable model.\n * Holds information for the variable including name, ID, and type.\n *\n * @see {Blockly.FieldVariable}\n */\nexport class VariableModel {\n  type: string;\n  private readonly id_: string;\n\n  /**\n   * @param workspace The variable's workspace.\n   * @param name The name of the variable.  This is the user-visible name (e.g.\n   *     'my var' or '私の変数'), not the generated name.\n   * @param opt_type The type of the variable like 'int' or 'string'.\n   *     Does not need to be unique. Field_variable can filter variables based\n   * on their type. This will default to '' which is a specific type.\n   * @param opt_id The unique ID of the variable. This will default to a UUID.\n   */\n  constructor(\n    public workspace: Workspace,\n    public name: string,\n    opt_type?: string,\n    opt_id?: string,\n  ) {\n    /**\n     * The type of the variable, such as 'int' or 'sound_effect'. This may be\n     * used to build a list of variables of a specific type. By default this is\n     * the empty string '', which is a specific type.\n     *\n     * @see {Blockly.FieldVariable}\n     */\n    this.type = opt_type || '';\n\n    /**\n     * A unique ID for the variable. This should be defined at creation and\n     * not change, even if the name changes. In most cases this should be a\n     * UUID.\n     */\n    this.id_ = opt_id || idGenerator.genUid();\n  }\n\n  /** @returns The ID for the variable. */\n  getId(): string {\n    return this.id_;\n  }\n\n  /**\n   * A custom compare function for the VariableModel objects.\n   *\n   * @param var1 First variable to compare.\n   * @param var2 Second variable to compare.\n   * @returns -1 if name of var1 is less than name of var2, 0 if equal, and 1 if\n   *     greater.\n   * @internal\n   */\n  static compareByName(var1: VariableModel, var2: VariableModel): number {\n    return var1.name.localeCompare(var2.name, undefined, {sensitivity: 'base'});\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a code comment on the workspace.\n *\n * @class\n */\n// Former goog.module ID: Blockly.WorkspaceComment\n\nimport type {CommentMove} from './events/events_comment_move.js';\nimport * as eventUtils from './events/utils.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as idGenerator from './utils/idgenerator.js';\nimport * as xml from './utils/xml.js';\nimport type {Workspace} from './workspace.js';\n\n/**\n * Class for a workspace comment.\n */\nexport class WorkspaceComment {\n  id: string;\n  protected xy_: Coordinate;\n  protected height_: number;\n  protected width_: number;\n  protected RTL: boolean;\n\n  private deletable = true;\n\n  private movable = true;\n\n  private editable = true;\n  protected content_: string;\n\n  /** Whether this comment has been disposed. */\n  protected disposed_ = false;\n  /** @internal */\n  isComment = true;\n\n  /**\n   * @param workspace The block's workspace.\n   * @param content The content of this workspace comment.\n   * @param height Height of the comment.\n   * @param width Width of the comment.\n   * @param opt_id Optional ID.  Use this ID if provided, otherwise create a new\n   *     ID.\n   */\n  constructor(\n    public workspace: Workspace,\n    content: string,\n    height: number,\n    width: number,\n    opt_id?: string,\n  ) {\n    this.id =\n      opt_id && !workspace.getCommentById(opt_id)\n        ? opt_id\n        : idGenerator.genUid();\n\n    workspace.addTopComment(this);\n\n    /**\n     * The comment's position in workspace units.  (0, 0) is at the workspace's\n     * origin; scale does not change this value.\n     */\n    this.xy_ = new Coordinate(0, 0);\n\n    /**\n     * The comment's height in workspace units.  Scale does not change this\n     * value.\n     */\n    this.height_ = height;\n\n    /**\n     * The comment's width in workspace units.  Scale does not change this\n     * value.\n     */\n    this.width_ = width;\n\n    this.RTL = workspace.RTL;\n\n    this.content_ = content;\n\n    WorkspaceComment.fireCreateEvent(this);\n  }\n\n  /**\n   * Dispose of this comment.\n   *\n   * @internal\n   */\n  dispose() {\n    if (this.disposed_) {\n      return;\n    }\n\n    if (eventUtils.isEnabled()) {\n      eventUtils.fire(new (eventUtils.get(eventUtils.COMMENT_DELETE))(this));\n    }\n    // Remove from the list of top comments and the comment database.\n    this.workspace.removeTopComment(this);\n    this.disposed_ = true;\n  }\n\n  // Height, width, x, and y are all stored on even non-rendered comments, to\n  // preserve state if you pass the contents through a headless workspace.\n\n  /**\n   * Get comment height.\n   *\n   * @returns Comment height.\n   * @internal\n   */\n  getHeight(): number {\n    return this.height_;\n  }\n\n  /**\n   * Set comment height.\n   *\n   * @param height Comment height.\n   * @internal\n   */\n  setHeight(height: number) {\n    this.height_ = height;\n  }\n\n  /**\n   * Get comment width.\n   *\n   * @returns Comment width.\n   * @internal\n   */\n  getWidth(): number {\n    return this.width_;\n  }\n\n  /**\n   * Set comment width.\n   *\n   * @param width comment width.\n   * @internal\n   */\n  setWidth(width: number) {\n    this.width_ = width;\n  }\n\n  /**\n   * Get stored location.\n   *\n   * @returns The comment's stored location.\n   *   This is not valid if the comment is currently being dragged.\n   * @internal\n   */\n  getRelativeToSurfaceXY(): Coordinate {\n    return new Coordinate(this.xy_.x, this.xy_.y);\n  }\n\n  /**\n   * Move a comment by a relative offset.\n   *\n   * @param dx Horizontal offset, in workspace units.\n   * @param dy Vertical offset, in workspace units.\n   * @internal\n   */\n  moveBy(dx: number, dy: number) {\n    const event = new (eventUtils.get(eventUtils.COMMENT_MOVE))(\n      this,\n    ) as CommentMove;\n    this.xy_.translate(dx, dy);\n    event.recordNew();\n    eventUtils.fire(event);\n  }\n\n  /**\n   * Get whether this comment is deletable or not.\n   *\n   * @returns True if deletable.\n   * @internal\n   */\n  isDeletable(): boolean {\n    return (\n      this.deletable && !(this.workspace && this.workspace.options.readOnly)\n    );\n  }\n\n  /**\n   * Set whether this comment is deletable or not.\n   *\n   * @param deletable True if deletable.\n   * @internal\n   */\n  setDeletable(deletable: boolean) {\n    this.deletable = deletable;\n  }\n\n  /**\n   * Get whether this comment is movable or not.\n   *\n   * @returns True if movable.\n   * @internal\n   */\n  isMovable(): boolean {\n    return this.movable && !(this.workspace && this.workspace.options.readOnly);\n  }\n\n  /**\n   * Set whether this comment is movable or not.\n   *\n   * @param movable True if movable.\n   * @internal\n   */\n  setMovable(movable: boolean) {\n    this.movable = movable;\n  }\n\n  /**\n   * Get whether this comment is editable or not.\n   *\n   * @returns True if editable.\n   */\n  isEditable(): boolean {\n    return (\n      this.editable && !(this.workspace && this.workspace.options.readOnly)\n    );\n  }\n\n  /**\n   * Set whether this comment is editable or not.\n   *\n   * @param editable True if editable.\n   */\n  setEditable(editable: boolean) {\n    this.editable = editable;\n  }\n\n  /**\n   * Returns this comment's text.\n   *\n   * @returns Comment text.\n   * @internal\n   */\n  getContent(): string {\n    return this.content_;\n  }\n\n  /**\n   * Set this comment's content.\n   *\n   * @param content Comment content.\n   * @internal\n   */\n  setContent(content: string) {\n    if (this.content_ !== content) {\n      eventUtils.fire(\n        new (eventUtils.get(eventUtils.COMMENT_CHANGE))(\n          this,\n          this.content_,\n          content,\n        ),\n      );\n      this.content_ = content;\n    }\n  }\n\n  /**\n   * Encode a comment subtree as XML with XY coordinates.\n   *\n   * @param opt_noId True if the encoder should skip the comment ID.\n   * @returns Tree of XML elements.\n   * @internal\n   */\n  toXmlWithXY(opt_noId?: boolean): Element {\n    const element = this.toXml(opt_noId);\n    element.setAttribute('x', String(Math.round(this.xy_.x)));\n    element.setAttribute('y', String(Math.round(this.xy_.y)));\n    element.setAttribute('h', String(this.height_));\n    element.setAttribute('w', String(this.width_));\n    return element;\n  }\n\n  /**\n   * Encode a comment subtree as XML, but don't serialize the XY coordinates.\n   * This method avoids some expensive metrics-related calls that are made in\n   * toXmlWithXY().\n   *\n   * @param opt_noId True if the encoder should skip the comment ID.\n   * @returns Tree of XML elements.\n   * @internal\n   */\n  toXml(opt_noId?: boolean): Element {\n    const commentElement = xml.createElement('comment');\n    if (!opt_noId) {\n      commentElement.id = this.id;\n    }\n    commentElement.textContent = this.getContent();\n    return commentElement;\n  }\n\n  /**\n   * Fire a create event for the given workspace comment, if comments are\n   * enabled.\n   *\n   * @param comment The comment that was just created.\n   * @internal\n   */\n  static fireCreateEvent(comment: WorkspaceComment) {\n    if (eventUtils.isEnabled()) {\n      const existingGroup = eventUtils.getGroup();\n      if (!existingGroup) {\n        eventUtils.setGroup(true);\n      }\n      try {\n        eventUtils.fire(\n          new (eventUtils.get(eventUtils.COMMENT_CREATE))(comment),\n        );\n      } finally {\n        eventUtils.setGroup(existingGroup);\n      }\n    }\n  }\n\n  /**\n   * Decode an XML comment tag and create a comment on the workspace.\n   *\n   * @param xmlComment XML comment element.\n   * @param workspace The workspace.\n   * @returns The created workspace comment.\n   * @internal\n   */\n  static fromXml(xmlComment: Element, workspace: Workspace): WorkspaceComment {\n    const info = WorkspaceComment.parseAttributes(xmlComment);\n\n    const comment = new WorkspaceComment(\n      workspace,\n      info.content,\n      info.h,\n      info.w,\n      info.id,\n    );\n\n    const xmlX = xmlComment.getAttribute('x');\n    const xmlY = xmlComment.getAttribute('y');\n    const commentX = xmlX ? parseInt(xmlX, 10) : NaN;\n    const commentY = xmlY ? parseInt(xmlY, 10) : NaN;\n    if (!isNaN(commentX) && !isNaN(commentY)) {\n      comment.moveBy(commentX, commentY);\n    }\n\n    WorkspaceComment.fireCreateEvent(comment);\n    return comment;\n  }\n\n  /**\n   * Decode an XML comment tag and return the results in an object.\n   *\n   * @param xml XML comment element.\n   * @returns An object containing the id, size, position, and comment string.\n   * @internal\n   */\n  static parseAttributes(xml: Element): {\n    id: string;\n    w: number;\n    h: number;\n    x: number;\n    y: number;\n    content: string;\n  } {\n    const xmlH = xml.getAttribute('h');\n    const xmlW = xml.getAttribute('w');\n    const xmlX = xml.getAttribute('x');\n    const xmlY = xml.getAttribute('y');\n    const xmlId = xml.getAttribute('id');\n\n    if (!xmlId) {\n      throw new Error('No ID present in XML comment definition.');\n    }\n\n    return {\n      id: xmlId,\n      // The height of the comment in workspace units, or 100 if not specified.\n      h: xmlH ? parseInt(xmlH) : 100,\n      // The width of the comment in workspace units, or 100 if not specified.\n      w: xmlW ? parseInt(xmlW) : 100,\n      // The x position of the comment in workspace coordinates, or NaN if not\n      // specified in the XML.\n      x: xmlX ? parseInt(xmlX) : NaN,\n      // The y position of the comment in workspace coordinates, or NaN if not\n      // specified in the XML.\n      y: xmlY ? parseInt(xmlY) : NaN,\n      content: xml.textContent ?? '',\n    };\n  }\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Events fired as a result of element select action.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.Selected\n\nimport * as registry from '../registry.js';\nimport {AbstractEventJson} from './events_abstract.js';\n\nimport {UiBase} from './events_ui_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Class for a selected event.\n * Notifies listeners that a new element has been selected.\n */\nexport class Selected extends UiBase {\n  /** The id of the last selected selectable element. */\n  oldElementId?: string;\n\n  /**\n   * The id of the newly selected selectable element,\n   * or undefined if unselected.\n   */\n  newElementId?: string;\n\n  override type = eventUtils.SELECTED;\n\n  /**\n   * @param opt_oldElementId The ID of the previously selected element. Null if\n   *     no element last selected. Undefined for a blank event.\n   * @param opt_newElementId The ID of the selected element. Null if no element\n   *     currently selected (deselect). Undefined for a blank event.\n   * @param opt_workspaceId The workspace identifier for this event.\n   *    Null if no element previously selected. Undefined for a blank event.\n   */\n  constructor(\n    opt_oldElementId?: string | null,\n    opt_newElementId?: string | null,\n    opt_workspaceId?: string,\n  ) {\n    super(opt_workspaceId);\n\n    this.oldElementId = opt_oldElementId ?? undefined;\n    this.newElementId = opt_newElementId ?? undefined;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): SelectedJson {\n    const json = super.toJson() as SelectedJson;\n    json['oldElementId'] = this.oldElementId;\n    json['newElementId'] = this.newElementId;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of Selected, but we can't specify that due to the fact that parameters\n   *     to static methods in subclasses must be supertypes of parameters to\n   *     static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: SelectedJson,\n    workspace: Workspace,\n    event?: any,\n  ): Selected {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new Selected(),\n    ) as Selected;\n    newEvent.oldElementId = json['oldElementId'];\n    newEvent.newElementId = json['newElementId'];\n    return newEvent;\n  }\n}\n\nexport interface SelectedJson extends AbstractEventJson {\n  oldElementId?: string;\n  newElementId?: string;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.SELECTED, Selected);\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {IPaster} from '../interfaces/i_paster.js';\nimport {ICopyData} from '../interfaces/i_copyable.js';\nimport {Coordinate} from '../utils/coordinate.js';\nimport {WorkspaceSvg} from '../workspace_svg.js';\nimport {WorkspaceCommentSvg} from '../workspace_comment_svg.js';\nimport * as registry from './registry.js';\n\nexport class WorkspaceCommentPaster\n  implements IPaster<WorkspaceCommentCopyData, WorkspaceCommentSvg>\n{\n  static TYPE = 'workspace-comment';\n\n  paste(\n    copyData: WorkspaceCommentCopyData,\n    workspace: WorkspaceSvg,\n    coordinate?: Coordinate,\n  ): WorkspaceCommentSvg {\n    const state = copyData.commentState;\n    if (coordinate) {\n      state.setAttribute('x', `${coordinate.x}`);\n      state.setAttribute('y', `${coordinate.y}`);\n    } else {\n      const x = parseInt(state.getAttribute('x') ?? '0') + 50;\n      const y = parseInt(state.getAttribute('y') ?? '0') + 50;\n      state.setAttribute('x', `${x}`);\n      state.setAttribute('y', `${y}`);\n    }\n    return WorkspaceCommentSvg.fromXmlRendered(\n      copyData.commentState,\n      workspace,\n    );\n  }\n}\n\nexport interface WorkspaceCommentCopyData extends ICopyData {\n  commentState: Element;\n}\n\nregistry.register(WorkspaceCommentPaster.TYPE, new WorkspaceCommentPaster());\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a code comment on a rendered workspace.\n *\n * @class\n */\n// Former goog.module ID: Blockly.WorkspaceCommentSvg\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_selected.js';\n\nimport * as browserEvents from './browser_events.js';\nimport * as common from './common.js';\n// import * as ContextMenu from './contextmenu.js';\nimport * as Css from './css.js';\nimport type {CommentMove} from './events/events_comment_move.js';\nimport * as eventUtils from './events/utils.js';\nimport type {IBoundedElement} from './interfaces/i_bounded_element.js';\nimport type {IBubble} from './interfaces/i_bubble.js';\nimport type {ICopyable} from './interfaces/i_copyable.js';\nimport * as Touch from './touch.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport {Rect} from './utils/rect.js';\nimport {Svg} from './utils/svg.js';\nimport * as svgMath from './utils/svg_math.js';\nimport {WorkspaceComment} from './workspace_comment.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport {\n  WorkspaceCommentCopyData,\n  WorkspaceCommentPaster,\n} from './clipboard/workspace_comment_paster.js';\n\n/** Size of the resize icon. */\nconst RESIZE_SIZE = 8;\n\n/** Radius of the border around the comment. */\nconst BORDER_RADIUS = 3;\n\n/** Offset from the foreignobject edge to the textarea edge. */\nconst TEXTAREA_OFFSET = 2;\n\n/**\n * Class for a workspace comment's SVG representation.\n */\nexport class WorkspaceCommentSvg\n  extends WorkspaceComment\n  implements IBoundedElement, IBubble, ICopyable<WorkspaceCommentCopyData>\n{\n  /**\n   * The width and height to use to size a workspace comment when it is first\n   * added, before it has been edited by the user.\n   *\n   * @internal\n   */\n  static DEFAULT_SIZE = 100;\n\n  /** Offset from the top to make room for a top bar. */\n  private static readonly TOP_OFFSET = 10;\n  override workspace: WorkspaceSvg;\n\n  /** Mouse up event data. */\n  private onMouseUpWrapper: browserEvents.Data | null = null;\n\n  /** Mouse move event data. */\n  private onMouseMoveWrapper: browserEvents.Data | null = null;\n\n  /** Whether event handlers have been initialized. */\n  private eventsInit = false;\n  private textarea: HTMLTextAreaElement | null = null;\n\n  private svgRectTarget: SVGRectElement | null = null;\n\n  private svgHandleTarget: SVGRectElement | null = null;\n\n  private foreignObject: SVGForeignObjectElement | null = null;\n\n  private resizeGroup: SVGGElement | null = null;\n\n  private deleteGroup: SVGGElement | null = null;\n\n  private deleteIconBorder: SVGCircleElement | null = null;\n\n  private focused = false;\n  private autoLayout = false;\n\n  // Create core elements for the block.\n  private readonly svgGroup: SVGElement;\n  svgRect_: SVGRectElement;\n\n  /** Whether the comment is rendered onscreen and is a part of the DOM. */\n  private rendered = false;\n\n  /**\n   * @param workspace The block's workspace.\n   * @param content The content of this workspace comment.\n   * @param height Height of the comment.\n   * @param width Width of the comment.\n   * @param opt_id Optional ID.  Use this ID if provided, otherwise create a new\n   *     ID.\n   */\n  constructor(\n    workspace: WorkspaceSvg,\n    content: string,\n    height: number,\n    width: number,\n    opt_id?: string,\n  ) {\n    super(workspace, content, height, width, opt_id);\n    this.svgGroup = dom.createSvgElement(Svg.G, {'class': 'blocklyComment'});\n    this.workspace = workspace;\n\n    this.svgRect_ = dom.createSvgElement(Svg.RECT, {\n      'class': 'blocklyCommentRect',\n      'x': 0,\n      'y': 0,\n      'rx': BORDER_RADIUS,\n      'ry': BORDER_RADIUS,\n    });\n    this.svgGroup.appendChild(this.svgRect_);\n\n    this.render();\n  }\n\n  /**\n   * Dispose of this comment.\n   *\n   * @internal\n   */\n  override dispose() {\n    if (this.disposed_) {\n      return;\n    }\n    // If this comment is being dragged, unlink the mouse events.\n    if (common.getSelected() === this) {\n      this.unselect();\n      this.workspace.cancelCurrentGesture();\n    }\n\n    if (eventUtils.isEnabled()) {\n      eventUtils.fire(new (eventUtils.get(eventUtils.COMMENT_DELETE))(this));\n    }\n\n    dom.removeNode(this.svgGroup);\n\n    eventUtils.disable();\n    super.dispose();\n    eventUtils.enable();\n  }\n\n  /**\n   * Create and initialize the SVG representation of a workspace comment.\n   * May be called more than once.\n   *\n   * @param opt_noSelect Text inside text area will be selected if false\n   * @internal\n   */\n  initSvg(opt_noSelect?: boolean) {\n    if (!this.workspace.rendered) {\n      throw TypeError('Workspace is headless.');\n    }\n    if (!this.workspace.options.readOnly && !this.eventsInit) {\n      browserEvents.conditionalBind(\n        this.svgRectTarget as SVGRectElement,\n        'pointerdown',\n        this,\n        this.pathMouseDown,\n      );\n      browserEvents.conditionalBind(\n        this.svgHandleTarget as SVGRectElement,\n        'pointerdown',\n        this,\n        this.pathMouseDown,\n      );\n    }\n    this.eventsInit = true;\n\n    this.updateMovable();\n    if (!this.getSvgRoot().parentNode) {\n      this.workspace.getBubbleCanvas().appendChild(this.getSvgRoot());\n    }\n\n    if (!opt_noSelect && this.textarea) {\n      this.textarea.select();\n    }\n  }\n\n  /**\n   * Handle a pointerdown on an SVG comment.\n   *\n   * @param e Pointer down event.\n   */\n  private pathMouseDown(e: PointerEvent) {\n    const gesture = this.workspace.getGesture(e);\n    if (gesture) {\n      gesture.handleBubbleStart(e, this);\n    }\n  }\n\n  /**\n   * Show the context menu for this workspace comment.\n   *\n   * @param e Pointer event.\n   * @internal\n   */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  showContextMenu(e: PointerEvent) {\n    throw new Error(\n      'The implementation of showContextMenu should be ' +\n        'monkey-patched in by blockly.ts',\n    );\n  }\n\n  /**\n   * Select this comment.  Highlight it visually.\n   *\n   * @internal\n   */\n  select() {\n    if (common.getSelected() === this) {\n      return;\n    }\n    let oldId = null;\n    if (common.getSelected()) {\n      oldId = common.getSelected()!.id;\n      // Unselect any previously selected block.\n      eventUtils.disable();\n      try {\n        common.getSelected()!.unselect();\n      } finally {\n        eventUtils.enable();\n      }\n    }\n    const event = new (eventUtils.get(eventUtils.SELECTED))(\n      oldId,\n      this.id,\n      this.workspace.id,\n    );\n    eventUtils.fire(event);\n    common.setSelected(this);\n    this.addSelect();\n  }\n\n  /**\n   * Unselect this comment.  Remove its highlighting.\n   *\n   * @internal\n   */\n  unselect() {\n    if (common.getSelected() !== this) {\n      return;\n    }\n    const event = new (eventUtils.get(eventUtils.SELECTED))(\n      this.id,\n      null,\n      this.workspace.id,\n    );\n    eventUtils.fire(event);\n    common.setSelected(null);\n    this.removeSelect();\n    this.blurFocus();\n  }\n\n  /**\n   * Select this comment.  Highlight it visually.\n   *\n   * @internal\n   */\n  addSelect() {\n    dom.addClass(this.svgGroup, 'blocklySelected');\n    this.setFocus();\n  }\n\n  /**\n   * Unselect this comment.  Remove its highlighting.\n   *\n   * @internal\n   */\n  removeSelect() {\n    dom.addClass(this.svgGroup, 'blocklySelected');\n    this.blurFocus();\n  }\n\n  /**\n   * Focus this comment.  Highlight it visually.\n   *\n   * @internal\n   */\n  addFocus() {\n    dom.addClass(this.svgGroup, 'blocklyFocused');\n  }\n\n  /**\n   * Unfocus this comment.  Remove its highlighting.\n   *\n   * @internal\n   */\n  removeFocus() {\n    dom.removeClass(this.svgGroup, 'blocklyFocused');\n  }\n\n  /**\n   * Return the coordinates of the top-left corner of this comment relative to\n   * the drawing surface's origin (0,0), in workspace units.\n   * If the comment is on the workspace, (0, 0) is the origin of the workspace\n   * coordinate system.\n   * This does not change with workspace scale.\n   *\n   * @returns Object with .x and .y properties in workspace coordinates.\n   * @internal\n   */\n  override getRelativeToSurfaceXY(): Coordinate {\n    const layerManger = this.workspace.getLayerManager();\n    if (!layerManger) {\n      throw new Error(\n        'Cannot calculate position because the workspace has not been appended',\n      );\n    }\n\n    let x = 0;\n    let y = 0;\n\n    let element: SVGElement | null = this.getSvgRoot();\n    if (element) {\n      do {\n        // Loop through this comment and every parent.\n        const xy = svgMath.getRelativeXY(element);\n        x += xy.x;\n        y += xy.y;\n        element = element.parentNode as SVGElement;\n      } while (element && !layerManger.hasLayer(element) && element !== null);\n    }\n    this.xy_ = new Coordinate(x, y);\n    return this.xy_;\n  }\n\n  /**\n   * Move a comment by a relative offset.\n   *\n   * @param dx Horizontal offset, in workspace units.\n   * @param dy Vertical offset, in workspace units.\n   * @internal\n   */\n  override moveBy(dx: number, dy: number) {\n    const event = new (eventUtils.get(eventUtils.COMMENT_MOVE))(\n      this,\n    ) as CommentMove;\n    // TODO: Do I need to look up the relative to surface XY position here?\n    const xy = this.getRelativeToSurfaceXY();\n    this.translate(xy.x + dx, xy.y + dy);\n    this.xy_ = new Coordinate(xy.x + dx, xy.y + dy);\n    event.recordNew();\n    eventUtils.fire(event);\n    this.workspace.resizeContents();\n  }\n\n  /**\n   * Transforms a comment by setting the translation on the transform attribute\n   * of the block's SVG.\n   *\n   * @param x The x coordinate of the translation in workspace units.\n   * @param y The y coordinate of the translation in workspace units.\n   * @internal\n   */\n  translate(x: number, y: number) {\n    this.xy_ = new Coordinate(x, y);\n    this.getSvgRoot().setAttribute(\n      'transform',\n      'translate(' + x + ',' + y + ')',\n    );\n  }\n\n  /**\n   * Move this comment during a drag.\n   *\n   * @param newLoc The location to translate to, in workspace coordinates.\n   * @internal\n   */\n  moveDuringDrag(newLoc: Coordinate) {\n    const translation = `translate(${newLoc.x}, ${newLoc.y})`;\n    this.getSvgRoot().setAttribute('transform', translation);\n  }\n\n  /**\n   * Move the bubble group to the specified location in workspace coordinates.\n   *\n   * @param x The x position to move to.\n   * @param y The y position to move to.\n   * @internal\n   */\n  moveTo(x: number, y: number) {\n    this.translate(x, y);\n  }\n\n  /**\n   * Clear the comment of transform=\"...\" attributes.\n   * Used when the comment is switching from 3d to 2d transform or vice versa.\n   */\n  private clearTransformAttributes() {\n    this.getSvgRoot().removeAttribute('transform');\n  }\n\n  /**\n   * Returns the coordinates of a bounding box describing the dimensions of this\n   * comment.\n   * Coordinate system: workspace coordinates.\n   *\n   * @returns Object with coordinates of the bounding box.\n   * @internal\n   */\n  getBoundingRectangle(): Rect {\n    const blockXY = this.getRelativeToSurfaceXY();\n    const commentBounds = this.getHeightWidth();\n    const top = blockXY.y;\n    const bottom = blockXY.y + commentBounds.height;\n    let left;\n    let right;\n    if (this.RTL) {\n      left = blockXY.x - commentBounds.width;\n      // Add the width of the tab/puzzle piece knob to the x coordinate\n      // since X is the corner of the rectangle, not the whole puzzle piece.\n      right = blockXY.x;\n    } else {\n      // Subtract the width of the tab/puzzle piece knob to the x coordinate\n      // since X is the corner of the rectangle, not the whole puzzle piece.\n      left = blockXY.x;\n      right = blockXY.x + commentBounds.width;\n    }\n    return new Rect(top, bottom, left, right);\n  }\n\n  /**\n   * Add or remove the UI indicating if this comment is movable or not.\n   *\n   * @internal\n   */\n  updateMovable() {\n    if (this.isMovable()) {\n      dom.addClass(this.svgGroup, 'blocklyDraggable');\n    } else {\n      dom.removeClass(this.svgGroup, 'blocklyDraggable');\n    }\n  }\n\n  /**\n   * Set whether this comment is movable or not.\n   *\n   * @param movable True if movable.\n   * @internal\n   */\n  override setMovable(movable: boolean) {\n    super.setMovable(movable);\n    this.updateMovable();\n  }\n\n  /**\n   * Set whether this comment is editable or not.\n   *\n   * @param editable True if editable.\n   */\n  override setEditable(editable: boolean) {\n    super.setEditable(editable);\n    if (this.textarea) {\n      this.textarea.readOnly = !editable;\n    }\n  }\n\n  /**\n   * Recursively adds or removes the dragging class to this node and its\n   * children.\n   *\n   * @param adding True if adding, false if removing.\n   * @internal\n   */\n  setDragging(adding: boolean) {\n    if (adding) {\n      dom.addClass(this.getSvgRoot(), 'blocklyDragging');\n    } else {\n      dom.removeClass(this.getSvgRoot(), 'blocklyDragging');\n    }\n  }\n\n  /**\n   * Return the root node of the SVG or null if none exists.\n   *\n   * @returns The root SVG node (probably a group).\n   * @internal\n   */\n  getSvgRoot(): SVGElement {\n    return this.svgGroup;\n  }\n\n  /**\n   * Returns this comment's text.\n   *\n   * @returns Comment text.\n   * @internal\n   */\n  override getContent(): string {\n    return this.textarea ? this.textarea.value : this.content_;\n  }\n\n  /**\n   * Set this comment's content.\n   *\n   * @param content Comment content.\n   * @internal\n   */\n  override setContent(content: string) {\n    super.setContent(content);\n    if (this.textarea) {\n      this.textarea.value = content;\n    }\n  }\n\n  /**\n   * Update the cursor over this comment by adding or removing a class.\n   *\n   * @param enable True if the delete cursor should be shown, false otherwise.\n   * @internal\n   */\n  setDeleteStyle(enable: boolean) {\n    if (enable) {\n      dom.addClass(this.svgGroup, 'blocklyDraggingDelete');\n    } else {\n      dom.removeClass(this.svgGroup, 'blocklyDraggingDelete');\n    }\n  }\n\n  /**\n   * Set whether auto-layout of this bubble is enabled.  The first time a bubble\n   * is shown it positions itself to not cover any blocks.  Once a user has\n   * dragged it to reposition, it renders where the user put it.\n   *\n   * @param _enable True if auto-layout should be enabled, false otherwise.\n   * @internal\n   */\n  setAutoLayout(_enable: boolean) {}\n  // NOP for compatibility with the bubble dragger.\n\n  /**\n   * Encode a comment subtree as XML with XY coordinates.\n   *\n   * @param opt_noId True if the encoder should skip the comment ID.\n   * @returns Tree of XML elements.\n   * @internal\n   */\n  override toXmlWithXY(opt_noId?: boolean): Element {\n    let width = 0; // Not used in LTR.\n    if (this.workspace.RTL) {\n      // Here be performance dragons: This calls getMetrics().\n      width = this.workspace.getWidth();\n    }\n    const element = this.toXml(opt_noId);\n    const xy = this.getRelativeToSurfaceXY();\n    element.setAttribute(\n      'x',\n      String(Math.round(this.workspace.RTL ? width - xy.x : xy.x)),\n    );\n    element.setAttribute('y', String(Math.round(xy.y)));\n    element.setAttribute('h', String(this.getHeight()));\n    element.setAttribute('w', String(this.getWidth()));\n    return element;\n  }\n\n  /**\n   * Encode a comment for copying.\n   *\n   * @returns Copy metadata.\n   */\n  toCopyData(): WorkspaceCommentCopyData {\n    return {\n      paster: WorkspaceCommentPaster.TYPE,\n      commentState: this.toXmlWithXY(),\n    };\n  }\n\n  /**\n   * Returns a bounding box describing the dimensions of this comment.\n   *\n   * @returns Object with height and width properties in workspace units.\n   * @internal\n   */\n  getHeightWidth(): {height: number; width: number} {\n    return {width: this.getWidth(), height: this.getHeight()};\n  }\n\n  /**\n   * Renders the workspace comment.\n   *\n   * @internal\n   */\n  render() {\n    if (this.rendered) {\n      return;\n    }\n\n    const size = this.getHeightWidth();\n\n    // Add text area\n    const foreignObject = this.createEditor();\n    this.svgGroup.appendChild(foreignObject);\n\n    this.svgHandleTarget = dom.createSvgElement(Svg.RECT, {\n      'class': 'blocklyCommentHandleTarget',\n      'x': 0,\n      'y': 0,\n    });\n    this.svgGroup.appendChild(this.svgHandleTarget);\n    this.svgRectTarget = dom.createSvgElement(Svg.RECT, {\n      'class': 'blocklyCommentTarget',\n      'x': 0,\n      'y': 0,\n      'rx': BORDER_RADIUS,\n      'ry': BORDER_RADIUS,\n    });\n    this.svgGroup.appendChild(this.svgRectTarget);\n\n    // Add the resize icon\n    this.addResizeDom();\n    if (this.isDeletable()) {\n      // Add the delete icon\n      this.addDeleteDom();\n    }\n\n    this.setSize(size.width, size.height);\n\n    // Set the content\n    this.textarea!.value = this.content_;\n\n    this.rendered = true;\n\n    if (this.resizeGroup) {\n      browserEvents.conditionalBind(\n        this.resizeGroup,\n        'pointerdown',\n        this,\n        this.resizeMouseDown,\n      );\n    }\n\n    if (this.isDeletable()) {\n      browserEvents.conditionalBind(\n        this.deleteGroup as SVGGElement,\n        'pointerdown',\n        this,\n        this.deleteMouseDown,\n      );\n      browserEvents.conditionalBind(\n        this.deleteGroup as SVGGElement,\n        'pointerout',\n        this,\n        this.deleteMouseOut,\n      );\n      browserEvents.conditionalBind(\n        this.deleteGroup as SVGGElement,\n        'pointerup',\n        this,\n        this.deleteMouseUp,\n      );\n    }\n  }\n\n  /**\n   * Create the text area for the comment.\n   *\n   * @returns The top-level node of the editor.\n   */\n  private createEditor(): Element {\n    /* Create the editor.  Here's the markup that will be generated:\n          <foreignObject class=\"blocklyCommentForeignObject\" x=\"0\" y=\"10\"\n          width=\"164\" height=\"164\"> <body xmlns=\"http://www.w3.org/1999/xhtml\"\n          class=\"blocklyMinimalBody\"> <textarea\n       xmlns=\"http://www.w3.org/1999/xhtml\" class=\"blocklyCommentTextarea\"\n                  style=\"height: 164px; width: 164px;\"></textarea>\n            </body>\n          </foreignObject>\n        */\n    this.foreignObject = dom.createSvgElement(Svg.FOREIGNOBJECT, {\n      'x': 0,\n      'y': WorkspaceCommentSvg.TOP_OFFSET,\n      'class': 'blocklyCommentForeignObject',\n    });\n    const body = document.createElementNS(dom.HTML_NS, 'body');\n    body.setAttribute('xmlns', dom.HTML_NS);\n    body.className = 'blocklyMinimalBody';\n    const textarea = document.createElementNS(\n      dom.HTML_NS,\n      'textarea',\n    ) as HTMLTextAreaElement;\n    textarea.className = 'blocklyCommentTextarea';\n    textarea.setAttribute('dir', this.RTL ? 'RTL' : 'LTR');\n    textarea.readOnly = !this.isEditable();\n    body.appendChild(textarea);\n    this.textarea = textarea;\n    this.foreignObject.appendChild(body);\n    // Don't zoom with mousewheel.\n    browserEvents.conditionalBind(\n      textarea,\n      'wheel',\n      this,\n      function (e: WheelEvent) {\n        e.stopPropagation();\n      },\n    );\n    browserEvents.conditionalBind(\n      textarea,\n      'change',\n      this,\n      function (this: WorkspaceCommentSvg, _e: Event) {\n        this.setContent(textarea.value);\n      },\n    );\n    return this.foreignObject;\n  }\n\n  /** Add the resize icon to the DOM */\n  private addResizeDom() {\n    this.resizeGroup = dom.createSvgElement(\n      Svg.G,\n      {'class': this.RTL ? 'blocklyResizeSW' : 'blocklyResizeSE'},\n      this.svgGroup,\n    );\n    dom.createSvgElement(\n      Svg.POLYGON,\n      {\n        'points': `0,${RESIZE_SIZE} ${RESIZE_SIZE},${RESIZE_SIZE} ${RESIZE_SIZE},0`,\n      },\n      this.resizeGroup,\n    );\n    dom.createSvgElement(\n      Svg.LINE,\n      {\n        'class': 'blocklyResizeLine',\n        'x1': RESIZE_SIZE / 3,\n        'y1': RESIZE_SIZE - 1,\n        'x2': RESIZE_SIZE - 1,\n        'y2': RESIZE_SIZE / 3,\n      },\n      this.resizeGroup,\n    );\n    dom.createSvgElement(\n      Svg.LINE,\n      {\n        'class': 'blocklyResizeLine',\n        'x1': (RESIZE_SIZE * 2) / 3,\n        'y1': RESIZE_SIZE - 1,\n        'x2': RESIZE_SIZE - 1,\n        'y2': (RESIZE_SIZE * 2) / 3,\n      },\n      this.resizeGroup,\n    );\n  }\n\n  /** Add the delete icon to the DOM */\n  private addDeleteDom() {\n    this.deleteGroup = dom.createSvgElement(\n      Svg.G,\n      {'class': 'blocklyCommentDeleteIcon'},\n      this.svgGroup,\n    );\n    this.deleteIconBorder = dom.createSvgElement(\n      Svg.CIRCLE,\n      {'class': 'blocklyDeleteIconShape', 'r': '7', 'cx': '7.5', 'cy': '7.5'},\n      this.deleteGroup,\n    );\n    // x icon.\n    dom.createSvgElement(\n      Svg.LINE,\n      {\n        'x1': '5',\n        'y1': '10',\n        'x2': '10',\n        'y2': '5',\n        'stroke': '#fff',\n        'stroke-width': '2',\n      },\n      this.deleteGroup,\n    );\n    dom.createSvgElement(\n      Svg.LINE,\n      {\n        'x1': '5',\n        'y1': '5',\n        'x2': '10',\n        'y2': '10',\n        'stroke': '#fff',\n        'stroke-width': '2',\n      },\n      this.deleteGroup,\n    );\n  }\n\n  /**\n   * Handle a pointerdown on comment's resize corner.\n   *\n   * @param e Pointer down event.\n   */\n  private resizeMouseDown(e: PointerEvent) {\n    this.unbindDragEvents();\n    if (browserEvents.isRightButton(e)) {\n      // No right-click.\n      e.stopPropagation();\n      return;\n    }\n    // Left-click (or middle click)\n    this.workspace.startDrag(\n      e,\n      new Coordinate(\n        this.workspace.RTL ? -this.width_ : this.width_,\n        this.height_,\n      ),\n    );\n\n    this.onMouseUpWrapper = browserEvents.conditionalBind(\n      document,\n      'pointerup',\n      this,\n      this.resizeMouseUp,\n    );\n    this.onMouseMoveWrapper = browserEvents.conditionalBind(\n      document,\n      'pointermove',\n      this,\n      this.resizeMouseMove,\n    );\n    this.workspace.hideChaff();\n    // This event has been handled.  No need to bubble up to the document.\n    e.stopPropagation();\n  }\n\n  /**\n   * Handle a pointerdown on comment's delete icon.\n   *\n   * @param e Pointer down event.\n   */\n  private deleteMouseDown(e: PointerEvent) {\n    // Highlight the delete icon.\n    if (this.deleteIconBorder) {\n      dom.addClass(this.deleteIconBorder, 'blocklyDeleteIconHighlighted');\n    }\n    // This event has been handled.  No need to bubble up to the document.\n    e.stopPropagation();\n  }\n\n  /**\n   * Handle a pointerout on comment's delete icon.\n   *\n   * @param _e Pointer out event.\n   */\n  private deleteMouseOut(_e: PointerEvent) {\n    // Restore highlight on the delete icon.\n    if (this.deleteIconBorder) {\n      dom.removeClass(this.deleteIconBorder, 'blocklyDeleteIconHighlighted');\n    }\n  }\n\n  /**\n   * Handle a pointerup on comment's delete icon.\n   *\n   * @param e Pointer up event.\n   */\n  private deleteMouseUp(e: PointerEvent) {\n    // Delete this comment.\n    this.dispose();\n    // This event has been handled.  No need to bubble up to the document.\n    e.stopPropagation();\n  }\n\n  /** Stop binding to the global pointerup and pointermove events. */\n  private unbindDragEvents() {\n    if (this.onMouseUpWrapper) {\n      browserEvents.unbind(this.onMouseUpWrapper);\n      this.onMouseUpWrapper = null;\n    }\n    if (this.onMouseMoveWrapper) {\n      browserEvents.unbind(this.onMouseMoveWrapper);\n      this.onMouseMoveWrapper = null;\n    }\n  }\n\n  /**\n   * Handle a pointerup event while dragging a comment's border or resize\n   * handle.\n   *\n   * @param _e Pointer up event.\n   */\n  private resizeMouseUp(_e: PointerEvent) {\n    Touch.clearTouchIdentifier();\n    this.unbindDragEvents();\n  }\n\n  /**\n   * Resize this comment to follow the pointer.\n   *\n   * @param e Pointer move event.\n   */\n  private resizeMouseMove(e: PointerEvent) {\n    this.autoLayout = false;\n    const newXY = this.workspace.moveDrag(e);\n    this.setSize(this.RTL ? -newXY.x : newXY.x, newXY.y);\n  }\n\n  /**\n   * Callback function triggered when the comment has resized.\n   * Resize the text area accordingly.\n   */\n  private resizeComment() {\n    const size = this.getHeightWidth();\n    const topOffset = WorkspaceCommentSvg.TOP_OFFSET;\n    const textOffset = TEXTAREA_OFFSET * 2;\n\n    this.foreignObject?.setAttribute('width', String(size.width));\n    this.foreignObject?.setAttribute('height', String(size.height - topOffset));\n    if (this.RTL) {\n      this.foreignObject?.setAttribute('x', String(-size.width));\n    }\n\n    if (!this.textarea) return;\n    this.textarea.style.width = size.width - textOffset + 'px';\n    this.textarea.style.height = size.height - textOffset - topOffset + 'px';\n  }\n\n  /**\n   * Set size\n   *\n   * @param width width of the container\n   * @param height height of the container\n   */\n  private setSize(width: number, height: number) {\n    // Minimum size of a comment.\n    width = Math.max(width, 45);\n    height = Math.max(height, 20 + WorkspaceCommentSvg.TOP_OFFSET);\n    this.width_ = width;\n    this.height_ = height;\n    this.svgRect_.setAttribute('width', `${width}`);\n    this.svgRect_.setAttribute('height', `${height}`);\n    this.svgRectTarget?.setAttribute('width', `${width}`);\n    this.svgRectTarget?.setAttribute('height', `${height}`);\n    this.svgHandleTarget?.setAttribute('width', `${width}`);\n    this.svgHandleTarget?.setAttribute(\n      'height',\n      String(WorkspaceCommentSvg.TOP_OFFSET),\n    );\n    if (this.RTL) {\n      this.svgRect_.setAttribute('transform', 'scale(-1 1)');\n      this.svgRectTarget?.setAttribute('transform', 'scale(-1 1)');\n    }\n\n    if (this.resizeGroup) {\n      if (this.RTL) {\n        // Mirror the resize group.\n        this.resizeGroup.setAttribute(\n          'transform',\n          'translate(' +\n            (-width + RESIZE_SIZE) +\n            ',' +\n            (height - RESIZE_SIZE) +\n            ') scale(-1 1)',\n        );\n        this.deleteGroup?.setAttribute(\n          'transform',\n          'translate(' +\n            (-width + RESIZE_SIZE) +\n            ',' +\n            -RESIZE_SIZE +\n            ') scale(-1 1)',\n        );\n      } else {\n        this.resizeGroup.setAttribute(\n          'transform',\n          'translate(' +\n            (width - RESIZE_SIZE) +\n            ',' +\n            (height - RESIZE_SIZE) +\n            ')',\n        );\n        this.deleteGroup?.setAttribute(\n          'transform',\n          'translate(' + (width - RESIZE_SIZE) + ',' + -RESIZE_SIZE + ')',\n        );\n      }\n    }\n\n    // Allow the contents to resize.\n    this.resizeComment();\n  }\n\n  /**\n   * Set the focus on the text area.\n   *\n   * @internal\n   */\n  setFocus() {\n    this.focused = true;\n    // Defer CSS changes.\n    setTimeout(() => {\n      if (this.disposed_) {\n        return;\n      }\n      this.textarea!.focus();\n      this.addFocus();\n      if (this.svgRectTarget) {\n        dom.addClass(this.svgRectTarget, 'blocklyCommentTargetFocused');\n      }\n      if (this.svgHandleTarget) {\n        dom.addClass(this.svgHandleTarget, 'blocklyCommentHandleTargetFocused');\n      }\n    }, 0);\n  }\n\n  /**\n   * Remove focus from the text area.\n   *\n   * @internal\n   */\n  blurFocus() {\n    this.focused = false;\n    // Defer CSS changes.\n    setTimeout(() => {\n      if (this.disposed_) {\n        return;\n      }\n\n      this.textarea!.blur();\n      this.removeFocus();\n      if (this.svgRectTarget) {\n        dom.removeClass(this.svgRectTarget, 'blocklyCommentTargetFocused');\n      }\n      if (this.svgHandleTarget) {\n        dom.removeClass(\n          this.svgHandleTarget,\n          'blocklyCommentHandleTargetFocused',\n        );\n      }\n    }, 0);\n  }\n\n  /**\n   * Decode an XML comment tag and create a rendered comment on the workspace.\n   *\n   * @param xmlComment XML comment element.\n   * @param workspace The workspace.\n   * @param opt_wsWidth The width of the workspace, which is used to position\n   *     comments correctly in RTL.\n   * @returns The created workspace comment.\n   * @internal\n   */\n  static fromXmlRendered(\n    xmlComment: Element,\n    workspace: WorkspaceSvg,\n    opt_wsWidth?: number,\n  ): WorkspaceCommentSvg {\n    eventUtils.disable();\n    let comment;\n    try {\n      const info = WorkspaceComment.parseAttributes(xmlComment);\n\n      comment = new WorkspaceCommentSvg(\n        workspace,\n        info.content,\n        info.h,\n        info.w,\n        info.id,\n      );\n      if (workspace.rendered) {\n        comment.initSvg(true);\n        comment.render();\n      }\n      // Position the comment correctly, taking into account the width of a\n      // rendered RTL workspace.\n      if (!isNaN(info.x) && !isNaN(info.y)) {\n        if (workspace.RTL) {\n          const wsWidth = opt_wsWidth || workspace.getWidth();\n          comment.moveBy(wsWidth - info.x, info.y);\n        } else {\n          comment.moveBy(info.x, info.y);\n        }\n      }\n    } finally {\n      eventUtils.enable();\n    }\n\n    WorkspaceComment.fireCreateEvent(comment);\n    return comment;\n  }\n}\n\n/** CSS for workspace comment.  See css.js for use. */\nCss.register(`\n.blocklyCommentForeignObject {\n  position: relative;\n  z-index: 0;\n}\n\n.blocklyCommentRect {\n  fill: #E7DE8E;\n  stroke: #bcA903;\n  stroke-width: 1px;\n}\n\n.blocklyCommentTarget {\n  fill: transparent;\n  stroke: #bcA903;\n}\n\n.blocklyCommentTargetFocused {\n  fill: none;\n}\n\n.blocklyCommentHandleTarget {\n  fill: none;\n}\n\n.blocklyCommentHandleTargetFocused {\n  fill: transparent;\n}\n\n.blocklyFocused>.blocklyCommentRect {\n  fill: #B9B272;\n  stroke: #B9B272;\n}\n\n.blocklySelected>.blocklyCommentTarget {\n  stroke: #fc3;\n  stroke-width: 3px;\n}\n\n.blocklyCommentDeleteIcon {\n  cursor: pointer;\n  fill: #000;\n  display: none;\n}\n\n.blocklySelected > .blocklyCommentDeleteIcon {\n  display: block;\n}\n\n.blocklyDeleteIconShape {\n  fill: #000;\n  stroke: #000;\n  stroke-width: 1px;\n}\n\n.blocklyDeleteIconShape.blocklyDeleteIconHighlighted {\n  stroke: #fc3;\n}\n`);\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.serialization.exceptions\n\nimport type {Block} from '../block.js';\nimport type {State} from './blocks.js';\n\nexport class DeserializationError extends Error {}\n\n/**\n * Represents an error where the serialized state is expected to provide a\n * block type, but it is not provided.\n *\n */\nexport class MissingBlockType extends DeserializationError {\n  /**\n   * @param state The state object which is missing the block type.\n   * @internal\n   */\n  constructor(public state: State) {\n    super(`Expected to find a 'type' property, defining the block type`);\n  }\n}\n\n/**\n * Represents an error where deserialization encountered a block that did\n * not have a connection that was defined in the serialized state.\n */\nexport class MissingConnection extends DeserializationError {\n  /**\n   * @param connection The name of the connection that is missing. E.g.\n   *     'IF0', or 'next'.\n   * @param block The block missing the connection.\n   * @param state The state object containing the bad connection.\n   * @internal\n   */\n  constructor(\n    connection: string,\n    public block: Block,\n    public state: State,\n  ) {\n    super(`The block ${block.toDevString()} is missing a(n) ${connection}\nconnection`);\n  }\n}\n\n/**\n * Represents an error where deserialization tried to connect two connections\n * that were not compatible.\n */\nexport class BadConnectionCheck extends DeserializationError {\n  /**\n   * @param reason The reason the connections were not compatible.\n   * @param childConnection The name of the incompatible child connection. E.g.\n   *     'output' or 'previous'.\n   * @param childBlock The child block that could not connect to its parent.\n   * @param childState The state object representing the child block.\n   * @internal\n   */\n  constructor(\n    reason: string,\n    childConnection: string,\n    public childBlock: Block,\n    public childState: State,\n  ) {\n    super(`The block ${childBlock.toDevString()} could not connect its\n${childConnection} to its parent, because: ${reason}`);\n  }\n}\n\n/**\n * Represents an error where deserialization encountered a real block as it\n * was deserializing children of a shadow.\n * This is an error because it is an invariant of Blockly that shadow blocks\n * do not have real children.\n */\nexport class RealChildOfShadow extends DeserializationError {\n  /**\n   * @param state The state object representing the real block.\n   * @internal\n   */\n  constructor(public state: State) {\n    super(`Encountered a real block which is defined as a child of a shadow\nblock. It is an invariant of Blockly that shadow blocks only have shadow\nchildren`);\n  }\n}\n\nexport class UnregisteredIcon extends DeserializationError {\n  /**\n   * @param iconType The type of the unregistered icon we are attempting to\n   *     deserialize.\n   * @param block The block we are attempting to add the unregistered icon to.\n   * @param state The state object representing the block.\n   */\n  constructor(\n    iconType: string,\n    public block: Block,\n    public state: State,\n  ) {\n    super(\n      `Cannot add an icon of type '${iconType}' to the block ` +\n        `${block.toDevString()}, because there is no icon registered with ` +\n        `type '${iconType}'. Make sure that all of your icons have been ` +\n        `registered.`,\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.serialization.priorities\n\n/**\n * The priority for deserializing variables.\n */\nexport const VARIABLES = 100;\n\n/**\n * The priority for deserializing variable data.\n */\nexport const PROCEDURES = 75;\n\n/**\n * The priority for deserializing blocks.\n */\nexport const BLOCKS = 50;\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Base class for all types of block events.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.BlockBase\n\nimport type {Block} from '../block.js';\nimport type {Workspace} from '../workspace.js';\n\nimport {\n  Abstract as AbstractEvent,\n  AbstractEventJson,\n} from './events_abstract.js';\n\n/**\n * Abstract class for any event related to blocks.\n */\nexport class BlockBase extends AbstractEvent {\n  override isBlank = true;\n\n  /** The ID of the block associated with this event. */\n  blockId?: string;\n\n  /**\n   * @param opt_block The block this event corresponds to.\n   *     Undefined for a blank event.\n   */\n  constructor(opt_block?: Block) {\n    super();\n    this.isBlank = !opt_block;\n\n    if (!opt_block) return;\n\n    this.blockId = opt_block.id;\n    this.workspaceId = opt_block.workspace.id;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): BlockBaseJson {\n    const json = super.toJson() as BlockBaseJson;\n    if (!this.blockId) {\n      throw new Error(\n        'The block ID is undefined. Either pass a block to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    json['blockId'] = this.blockId;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of BlockBase, but we can't specify that due to the fact that parameters\n   *     to static methods in subclasses must be supertypes of parameters to\n   *     static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: BlockBaseJson,\n    workspace: Workspace,\n    event?: any,\n  ): BlockBase {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new BlockBase(),\n    ) as BlockBase;\n    newEvent.blockId = json['blockId'];\n    return newEvent;\n  }\n}\n\nexport interface BlockBaseJson extends AbstractEventJson {\n  blockId: string;\n}\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for a block creation event.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.BlockCreate\n\nimport type {Block} from '../block.js';\nimport * as registry from '../registry.js';\nimport * as blocks from '../serialization/blocks.js';\nimport * as utilsXml from '../utils/xml.js';\nimport * as Xml from '../xml.js';\n\nimport {BlockBase, BlockBaseJson} from './events_block_base.js';\nimport * as eventUtils from './utils.js';\nimport {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners when a block (or connected stack of blocks) is\n * created.\n */\nexport class BlockCreate extends BlockBase {\n  override type = eventUtils.BLOCK_CREATE;\n\n  /** The XML representation of the created block(s). */\n  xml?: Element | DocumentFragment;\n\n  /** The JSON respresentation of the created block(s). */\n  json?: blocks.State;\n\n  /** All of the IDs of created blocks. */\n  ids?: string[];\n\n  /** @param opt_block The created block.  Undefined for a blank event. */\n  constructor(opt_block?: Block) {\n    super(opt_block);\n\n    if (!opt_block) {\n      return; // Blank event to be populated by fromJson.\n    }\n\n    if (opt_block.isShadow()) {\n      // Moving shadow blocks is handled via disconnection.\n      this.recordUndo = false;\n    }\n\n    this.xml = Xml.blockToDomWithXY(opt_block);\n    this.ids = eventUtils.getDescendantIds(opt_block);\n\n    this.json = blocks.save(opt_block, {addCoordinates: true}) as blocks.State;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): BlockCreateJson {\n    const json = super.toJson() as BlockCreateJson;\n    if (!this.xml) {\n      throw new Error(\n        'The block XML is undefined. Either pass a block to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (!this.ids) {\n      throw new Error(\n        'The block IDs are undefined. Either pass a block to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (!this.json) {\n      throw new Error(\n        'The block JSON is undefined. Either pass a block to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    json['xml'] = Xml.domToText(this.xml);\n    json['ids'] = this.ids;\n    json['json'] = this.json;\n    if (!this.recordUndo) {\n      json['recordUndo'] = this.recordUndo;\n    }\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of BlockCreate, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: BlockCreateJson,\n    workspace: Workspace,\n    event?: any,\n  ): BlockCreate {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new BlockCreate(),\n    ) as BlockCreate;\n    newEvent.xml = utilsXml.textToDom(json['xml']);\n    newEvent.ids = json['ids'];\n    newEvent.json = json['json'] as blocks.State;\n    if (json['recordUndo'] !== undefined) {\n      newEvent.recordUndo = json['recordUndo'];\n    }\n    return newEvent;\n  }\n\n  /**\n   * Run a creation event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    if (!this.json) {\n      throw new Error(\n        'The block JSON is undefined. Either pass a block to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (!this.ids) {\n      throw new Error(\n        'The block IDs are undefined. Either pass a block to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (allShadowBlocks(workspace, this.ids)) return;\n    if (forward) {\n      blocks.append(this.json, workspace);\n    } else {\n      for (let i = 0; i < this.ids.length; i++) {\n        const id = this.ids[i];\n        const block = workspace.getBlockById(id);\n        if (block) {\n          block.dispose(false);\n        } else if (id === this.blockId) {\n          // Only complain about root-level block.\n          console.warn(\"Can't uncreate non-existent block: \" + id);\n        }\n      }\n    }\n  }\n}\n/**\n * Returns true if all blocks in the list are shadow blocks. If so, that means\n * the top-level block being created is a shadow block. This only happens when a\n * block that was covering up a shadow block is removed. We don't need to create\n * an additional block in that case because the original block still has its\n * shadow block.\n *\n * @param workspace Workspace to check for blocks\n * @param ids A list of block ids that were created in this event\n * @returns True if all block ids in the list are shadow blocks\n */\nconst allShadowBlocks = function (\n  workspace: Workspace,\n  ids: string[],\n): boolean {\n  const shadows = ids\n    .map((id) => workspace.getBlockById(id))\n    .filter((block) => block && block.isShadow());\n  return shadows.length === ids.length;\n};\n\nexport interface BlockCreateJson extends BlockBaseJson {\n  xml: string;\n  ids: string[];\n  json: object;\n  recordUndo?: boolean;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.CREATE, BlockCreate);\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Events fired as a result of a theme update.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.ThemeChange\n\nimport * as registry from '../registry.js';\nimport {AbstractEventJson} from './events_abstract.js';\nimport {UiBase} from './events_ui_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners that the workspace theme has changed.\n */\nexport class ThemeChange extends UiBase {\n  /** The name of the new theme that has been set. */\n  themeName?: string;\n\n  override type = eventUtils.THEME_CHANGE;\n\n  /**\n   * @param opt_themeName The theme name. Undefined for a blank event.\n   * @param opt_workspaceId The workspace identifier for this event.\n   *    event. Undefined for a blank event.\n   */\n  constructor(opt_themeName?: string, opt_workspaceId?: string) {\n    super(opt_workspaceId);\n    this.themeName = opt_themeName;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): ThemeChangeJson {\n    const json = super.toJson() as ThemeChangeJson;\n    if (!this.themeName) {\n      throw new Error(\n        'The theme name is undefined. Either pass a theme name to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    json['themeName'] = this.themeName;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of ThemeChange, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: ThemeChangeJson,\n    workspace: Workspace,\n    event?: any,\n  ): ThemeChange {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new ThemeChange(),\n    ) as ThemeChange;\n    newEvent.themeName = json['themeName'];\n    return newEvent;\n  }\n}\n\nexport interface ThemeChangeJson extends AbstractEventJson {\n  themeName: string;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.THEME_CHANGE, ThemeChange);\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Events fired as a result of a viewport change.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.ViewportChange\n\nimport * as registry from '../registry.js';\nimport {AbstractEventJson} from './events_abstract.js';\nimport {UiBase} from './events_ui_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners that the workspace surface's position or scale has\n * changed.\n *\n * Does not notify when the workspace itself resizes.\n */\nexport class ViewportChange extends UiBase {\n  /**\n   * Top edge of the visible portion of the workspace, relative to the\n   * workspace origin.\n   */\n  viewTop?: number;\n\n  /**\n   * The left edge of the visible portion of the workspace, relative to\n   * the workspace origin.\n   */\n  viewLeft?: number;\n\n  /** The scale of the workpace. */\n  scale?: number;\n\n  /** The previous scale of the workspace. */\n  oldScale?: number;\n\n  override type = eventUtils.VIEWPORT_CHANGE;\n\n  /**\n   * @param opt_top Top-edge of the visible portion of the workspace, relative\n   *     to the workspace origin. Undefined for a blank event.\n   * @param opt_left Left-edge of the visible portion of the workspace relative\n   *     to the workspace origin. Undefined for a blank event.\n   * @param opt_scale The scale of the workspace. Undefined for a blank event.\n   * @param opt_workspaceId The workspace identifier for this event.\n   *    Undefined for a blank event.\n   * @param opt_oldScale The old scale of the workspace. Undefined for a blank\n   *     event.\n   */\n  constructor(\n    opt_top?: number,\n    opt_left?: number,\n    opt_scale?: number,\n    opt_workspaceId?: string,\n    opt_oldScale?: number,\n  ) {\n    super(opt_workspaceId);\n\n    this.viewTop = opt_top;\n    this.viewLeft = opt_left;\n    this.scale = opt_scale;\n    this.oldScale = opt_oldScale;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): ViewportChangeJson {\n    const json = super.toJson() as ViewportChangeJson;\n    if (this.viewTop === undefined) {\n      throw new Error(\n        'The view top is undefined. Either pass a value to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (this.viewLeft === undefined) {\n      throw new Error(\n        'The view left is undefined. Either pass a value to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (this.scale === undefined) {\n      throw new Error(\n        'The scale is undefined. Either pass a value to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (this.oldScale === undefined) {\n      throw new Error(\n        'The old scale is undefined. Either pass a value to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    json['viewTop'] = this.viewTop;\n    json['viewLeft'] = this.viewLeft;\n    json['scale'] = this.scale;\n    json['oldScale'] = this.oldScale;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of Viewport, but we can't specify that due to the fact that parameters\n   *     to static methods in subclasses must be supertypes of parameters to\n   *     static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: ViewportChangeJson,\n    workspace: Workspace,\n    event?: any,\n  ): ViewportChange {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new ViewportChange(),\n    ) as ViewportChange;\n    newEvent.viewTop = json['viewTop'];\n    newEvent.viewLeft = json['viewLeft'];\n    newEvent.scale = json['scale'];\n    newEvent.oldScale = json['oldScale'];\n    return newEvent;\n  }\n}\n\nexport interface ViewportChangeJson extends AbstractEventJson {\n  viewTop: number;\n  viewLeft: number;\n  scale: number;\n  oldScale: number;\n}\n\nregistry.register(\n  registry.Type.EVENT,\n  eventUtils.VIEWPORT_CHANGE,\n  ViewportChange,\n);\n","/**\n * @license\n * Copyright 2022 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.config\n\n/**\n * All the values that we expect developers to be able to change\n * before injecting Blockly.\n */\ninterface Config {\n  dragRadius: number;\n  flyoutDragRadius: number;\n  snapRadius: number;\n  currentConnectionPreference: number;\n  bumpDelay: number;\n  connectingSnapRadius: number;\n}\n\n/** Default snap radius. */\nconst DEFAULT_SNAP_RADIUS = 28;\n\n/**\n * Object holding all the values on Blockly that we expect developers to be\n * able to change.\n */\nexport const config: Config = {\n  /**\n   * Number of pixels the mouse must move before a drag starts.\n   *\n   */\n  dragRadius: 5,\n  /**\n   * Number of pixels the mouse must move before a drag/scroll starts from the\n   * flyout.  Because the drag-intention is determined when this is reached, it\n   * is larger than dragRadius so that the drag-direction is clearer.\n   *\n   */\n  flyoutDragRadius: 10,\n  /**\n   * Maximum misalignment between connections for them to snap together.\n   *\n   */\n  snapRadius: DEFAULT_SNAP_RADIUS,\n  /**\n   * Maximum misalignment between connections for them to snap together.\n   * This should be the same as the snap radius.\n   *\n   * @deprecated v11 - This is no longer used. Use snapRadius instead.\n   */\n  connectingSnapRadius: DEFAULT_SNAP_RADIUS,\n  /**\n   * How much to prefer staying connected to the current connection over moving\n   * to a new connection.  The current previewed connection is considered to be\n   * this much closer to the matching connection on the block than it actually\n   * is.\n   *\n   */\n  currentConnectionPreference: 8,\n  /**\n   * Delay in ms between trigger and bumping unconnected block out of alignment.\n   *\n   */\n  bumpDelay: 250,\n};\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.ConnectionType\n\n/**\n * Enum for the type of a connection or input.\n */\nexport enum ConnectionType {\n  // A right-facing value input.  E.g. 'set item to' or 'return'.\n  INPUT_VALUE = 1,\n  // A left-facing value output.  E.g. 'random fraction'.\n  OUTPUT_VALUE,\n  // A down-facing block stack.  E.g. 'if-do' or 'else'.\n  NEXT_STATEMENT,\n  // An up-facing block stack.  E.g. 'break out of loop'.\n  PREVIOUS_STATEMENT,\n}\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * A database of all the rendered connections that could\n *    possibly be connected to (i.e. not collapsed, etc).\n *    Sorted by y coordinate.\n *\n * @class\n */\n// Former goog.module ID: Blockly.ConnectionDB\n\nimport {ConnectionType} from './connection_type.js';\nimport type {IConnectionChecker} from './interfaces/i_connection_checker.js';\nimport type {RenderedConnection} from './rendered_connection.js';\nimport type {Coordinate} from './utils/coordinate.js';\n\n/**\n * Database of connections.\n * Connections are stored in order of their vertical component.  This way\n * connections in an area may be looked up quickly using a binary search.\n */\nexport class ConnectionDB {\n  /** Array of connections sorted by y position in workspace units. */\n  private readonly connections: RenderedConnection[] = [];\n\n  /**\n   * @param connectionChecker The workspace's connection type checker, used to\n   *     decide if connections are valid during a drag.\n   */\n  constructor(private readonly connectionChecker: IConnectionChecker) {}\n\n  /**\n   * Add a connection to the database. Should not already exist in the database.\n   *\n   * @param connection The connection to be added.\n   * @param yPos The y position used to decide where to insert the connection.\n   * @internal\n   */\n  addConnection(connection: RenderedConnection, yPos: number) {\n    const index = this.calculateIndexForYPos(yPos);\n    this.connections.splice(index, 0, connection);\n  }\n\n  /**\n   * Finds the index of the given connection.\n   *\n   * Starts by doing a binary search to find the approximate location, then\n   * linearly searches nearby for the exact connection.\n   *\n   * @param conn The connection to find.\n   * @param yPos The y position used to find the index of the connection.\n   * @returns The index of the connection, or -1 if the connection was not\n   *     found.\n   */\n  private findIndexOfConnection(\n    conn: RenderedConnection,\n    yPos: number,\n  ): number {\n    if (!this.connections.length) {\n      return -1;\n    }\n\n    const bestGuess = this.calculateIndexForYPos(yPos);\n    if (bestGuess >= this.connections.length) {\n      // Not in list\n      return -1;\n    }\n\n    yPos = conn.y;\n    // Walk forward and back on the y axis looking for the connection.\n    let pointer = bestGuess;\n    while (pointer >= 0 && this.connections[pointer].y === yPos) {\n      if (this.connections[pointer] === conn) {\n        return pointer;\n      }\n      pointer--;\n    }\n\n    pointer = bestGuess;\n    while (\n      pointer < this.connections.length &&\n      this.connections[pointer].y === yPos\n    ) {\n      if (this.connections[pointer] === conn) {\n        return pointer;\n      }\n      pointer++;\n    }\n    return -1;\n  }\n\n  /**\n   * Finds the correct index for the given y position.\n   *\n   * @param yPos The y position used to decide where to insert the connection.\n   * @returns The candidate index.\n   */\n  private calculateIndexForYPos(yPos: number): number {\n    if (!this.connections.length) {\n      return 0;\n    }\n    let pointerMin = 0;\n    let pointerMax = this.connections.length;\n    while (pointerMin < pointerMax) {\n      const pointerMid = Math.floor((pointerMin + pointerMax) / 2);\n      if (this.connections[pointerMid].y < yPos) {\n        pointerMin = pointerMid + 1;\n      } else if (this.connections[pointerMid].y > yPos) {\n        pointerMax = pointerMid;\n      } else {\n        pointerMin = pointerMid;\n        break;\n      }\n    }\n    return pointerMin;\n  }\n\n  /**\n   * Remove a connection from the database.  Must already exist in DB.\n   *\n   * @param connection The connection to be removed.\n   * @param yPos The y position used to find the index of the connection.\n   * @throws {Error} If the connection cannot be found in the database.\n   */\n  removeConnection(connection: RenderedConnection, yPos: number) {\n    const index = this.findIndexOfConnection(connection, yPos);\n    if (index === -1) {\n      throw Error('Unable to find connection in connectionDB.');\n    }\n    this.connections.splice(index, 1);\n  }\n\n  /**\n   * Find all nearby connections to the given connection.\n   * Type checking does not apply, since this function is used for bumping.\n   *\n   * @param connection The connection whose neighbours should be returned.\n   * @param maxRadius The maximum radius to another connection.\n   * @returns List of connections.\n   */\n  getNeighbours(\n    connection: RenderedConnection,\n    maxRadius: number,\n  ): RenderedConnection[] {\n    const db = this.connections;\n    const currentX = connection.x;\n    const currentY = connection.y;\n\n    // Binary search to find the closest y location.\n    let pointerMin = 0;\n    let pointerMax = db.length - 2;\n    let pointerMid = pointerMax;\n    while (pointerMin < pointerMid) {\n      if (db[pointerMid].y < currentY) {\n        pointerMin = pointerMid;\n      } else {\n        pointerMax = pointerMid;\n      }\n      pointerMid = Math.floor((pointerMin + pointerMax) / 2);\n    }\n\n    const neighbours: RenderedConnection[] = [];\n    /**\n     * Computes if the current connection is within the allowed radius of\n     * another connection. This function is a closure and has access to outside\n     * variables.\n     *\n     * @param yIndex The other connection's index in the database.\n     * @returns True if the current connection's vertical distance from the\n     *     other connection is less than the allowed radius.\n     */\n    function checkConnection(yIndex: number): boolean {\n      const dx = currentX - db[yIndex].x;\n      const dy = currentY - db[yIndex].y;\n      const r = Math.sqrt(dx * dx + dy * dy);\n      if (r <= maxRadius) {\n        neighbours.push(db[yIndex]);\n      }\n      return dy < maxRadius;\n    }\n\n    // Walk forward and back on the y axis looking for the closest x,y point.\n    pointerMin = pointerMid;\n    pointerMax = pointerMid;\n    if (db.length) {\n      while (pointerMin >= 0 && checkConnection(pointerMin)) {\n        pointerMin--;\n      }\n      do {\n        pointerMax++;\n      } while (pointerMax < db.length && checkConnection(pointerMax));\n    }\n\n    return neighbours;\n  }\n\n  /**\n   * Is the candidate connection close to the reference connection.\n   * Extremely fast; only looks at Y distance.\n   *\n   * @param index Index in database of candidate connection.\n   * @param baseY Reference connection's Y value.\n   * @param maxRadius The maximum radius to another connection.\n   * @returns True if connection is in range.\n   */\n  private isInYRange(index: number, baseY: number, maxRadius: number): boolean {\n    return Math.abs(this.connections[index].y - baseY) <= maxRadius;\n  }\n\n  /**\n   * Find the closest compatible connection to this connection.\n   *\n   * @param conn The connection searching for a compatible mate.\n   * @param maxRadius The maximum radius to another connection.\n   * @param dxy Offset between this connection's location in the database and\n   *     the current location (as a result of dragging).\n   * @returns Contains two properties: 'connection' which is either another\n   *     connection or null, and 'radius' which is the distance.\n   */\n  searchForClosest(\n    conn: RenderedConnection,\n    maxRadius: number,\n    dxy: Coordinate,\n  ): {connection: RenderedConnection | null; radius: number} {\n    if (!this.connections.length) {\n      // Don't bother.\n      return {connection: null, radius: maxRadius};\n    }\n\n    // Stash the values of x and y from before the drag.\n    const baseY = conn.y;\n    const baseX = conn.x;\n\n    conn.x = baseX + dxy.x;\n    conn.y = baseY + dxy.y;\n\n    // calculateIndexForYPos_ finds an index for insertion, which is always\n    // after any block with the same y index.  We want to search both forward\n    // and back, so search on both sides of the index.\n    const closestIndex = this.calculateIndexForYPos(conn.y);\n\n    let bestConnection = null;\n    let bestRadius = maxRadius;\n    let temp;\n\n    // Walk forward and back on the y axis looking for the closest x,y point.\n    let pointerMin = closestIndex - 1;\n    while (pointerMin >= 0 && this.isInYRange(pointerMin, conn.y, maxRadius)) {\n      temp = this.connections[pointerMin];\n      if (this.connectionChecker.canConnect(conn, temp, true, bestRadius)) {\n        bestConnection = temp;\n        bestRadius = temp.distanceFrom(conn);\n      }\n      pointerMin--;\n    }\n\n    let pointerMax = closestIndex;\n    while (\n      pointerMax < this.connections.length &&\n      this.isInYRange(pointerMax, conn.y, maxRadius)\n    ) {\n      temp = this.connections[pointerMax];\n      if (this.connectionChecker.canConnect(conn, temp, true, bestRadius)) {\n        bestConnection = temp;\n        bestRadius = temp.distanceFrom(conn);\n      }\n      pointerMax++;\n    }\n\n    // Reset the values of x and y.\n    conn.x = baseX;\n    conn.y = baseY;\n    // If there were no valid connections, bestConnection will be null.\n    return {connection: bestConnection, radius: bestRadius};\n  }\n\n  /**\n   * Initialize a set of connection DBs for a workspace.\n   *\n   * @param checker The workspace's connection checker, used to decide if\n   *     connections are valid during a drag.\n   * @returns Array of databases.\n   */\n  static init(checker: IConnectionChecker): ConnectionDB[] {\n    // Create four databases, one for each connection type.\n    const dbList = [];\n    dbList[ConnectionType.INPUT_VALUE] = new ConnectionDB(checker);\n    dbList[ConnectionType.OUTPUT_VALUE] = new ConnectionDB(checker);\n    dbList[ConnectionType.NEXT_STATEMENT] = new ConnectionDB(checker);\n    dbList[ConnectionType.PREVIOUS_STATEMENT] = new ConnectionDB(checker);\n    return dbList;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Blockly menu similar to Closure's goog.ui.Menu\n *\n * @class\n */\n// Former goog.module ID: Blockly.Menu\n\nimport * as browserEvents from './browser_events.js';\nimport type {MenuItem} from './menuitem.js';\nimport * as aria from './utils/aria.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport type {Size} from './utils/size.js';\nimport * as style from './utils/style.js';\n\n/**\n * A basic menu class.\n */\nexport class Menu {\n  /**\n   * Array of menu items.\n   * (Nulls are never in the array, but typing the array as nullable prevents\n   * the compiler from objecting to .indexOf(null))\n   */\n  private readonly menuItems: MenuItem[] = [];\n\n  /**\n   * Coordinates of the mousedown event that caused this menu to open. Used to\n   * prevent the consequent mouseup event due to a simple click from\n   * activating a menu item immediately.\n   */\n  openingCoords: Coordinate | null = null;\n\n  /**\n   * This is the element that we will listen to the real focus events on.\n   * A value of null means no menu item is highlighted.\n   */\n  private highlightedItem: MenuItem | null = null;\n\n  /** Mouse over event data. */\n  private mouseOverHandler: browserEvents.Data | null = null;\n\n  /** Click event data. */\n  private clickHandler: browserEvents.Data | null = null;\n\n  /** Mouse enter event data. */\n  private mouseEnterHandler: browserEvents.Data | null = null;\n\n  /** Mouse leave event data. */\n  private mouseLeaveHandler: browserEvents.Data | null = null;\n\n  /** Key down event data. */\n  private onKeyDownHandler: browserEvents.Data | null = null;\n\n  /** The menu's root DOM element. */\n  private element: HTMLDivElement | null = null;\n\n  /** ARIA name for this menu. */\n  private roleName: aria.Role | null = null;\n\n  /** Constructs a new Menu instance. */\n  constructor() {}\n\n  /**\n   * Add a new menu item to the bottom of this menu.\n   *\n   * @param menuItem Menu item to append.\n   * @internal\n   */\n  addChild(menuItem: MenuItem) {\n    this.menuItems.push(menuItem);\n  }\n\n  /**\n   * Creates the menu DOM.\n   *\n   * @param container Element upon which to append this menu.\n   * @returns The menu's root DOM element.\n   */\n  render(container: Element): HTMLDivElement {\n    const element = document.createElement('div');\n    // goog-menu is deprecated, use blocklyMenu.  May 2020.\n    element.className = 'blocklyMenu goog-menu blocklyNonSelectable';\n    element.tabIndex = 0;\n    if (this.roleName) {\n      aria.setRole(element, this.roleName);\n    }\n    this.element = element;\n\n    // Add menu items.\n    for (let i = 0, menuItem; (menuItem = this.menuItems[i]); i++) {\n      element.appendChild(menuItem.createDom());\n    }\n\n    // Add event handlers.\n    this.mouseOverHandler = browserEvents.conditionalBind(\n      element,\n      'pointerover',\n      this,\n      this.handleMouseOver,\n      true,\n    );\n    this.clickHandler = browserEvents.conditionalBind(\n      element,\n      'pointerup',\n      this,\n      this.handleClick,\n      true,\n    );\n    this.mouseEnterHandler = browserEvents.conditionalBind(\n      element,\n      'pointerenter',\n      this,\n      this.handleMouseEnter,\n      true,\n    );\n    this.mouseLeaveHandler = browserEvents.conditionalBind(\n      element,\n      'pointerleave',\n      this,\n      this.handleMouseLeave,\n      true,\n    );\n    this.onKeyDownHandler = browserEvents.conditionalBind(\n      element,\n      'keydown',\n      this,\n      this.handleKeyEvent,\n    );\n\n    container.appendChild(element);\n    return element;\n  }\n\n  /**\n   * Gets the menu's element.\n   *\n   * @returns The DOM element.\n   * @internal\n   */\n  getElement(): HTMLDivElement | null {\n    return this.element;\n  }\n\n  /**\n   * Focus the menu element.\n   *\n   * @internal\n   */\n  focus() {\n    const el = this.getElement();\n    if (el) {\n      el.focus({preventScroll: true});\n      dom.addClass(el, 'blocklyFocused');\n    }\n  }\n\n  /** Blur the menu element. */\n  private blur() {\n    const el = this.getElement();\n    if (el) {\n      el.blur();\n      dom.removeClass(el, 'blocklyFocused');\n    }\n  }\n\n  /**\n   * Set the menu accessibility role.\n   *\n   * @param roleName role name.\n   * @internal\n   */\n  setRole(roleName: aria.Role) {\n    this.roleName = roleName;\n  }\n\n  /** Dispose of this menu. */\n  dispose() {\n    // Remove event handlers.\n    if (this.mouseOverHandler) {\n      browserEvents.unbind(this.mouseOverHandler);\n      this.mouseOverHandler = null;\n    }\n    if (this.clickHandler) {\n      browserEvents.unbind(this.clickHandler);\n      this.clickHandler = null;\n    }\n    if (this.mouseEnterHandler) {\n      browserEvents.unbind(this.mouseEnterHandler);\n      this.mouseEnterHandler = null;\n    }\n    if (this.mouseLeaveHandler) {\n      browserEvents.unbind(this.mouseLeaveHandler);\n      this.mouseLeaveHandler = null;\n    }\n    if (this.onKeyDownHandler) {\n      browserEvents.unbind(this.onKeyDownHandler);\n      this.onKeyDownHandler = null;\n    }\n\n    // Remove menu items.\n    for (let i = 0, menuItem; (menuItem = this.menuItems[i]); i++) {\n      menuItem.dispose();\n    }\n    this.element = null;\n  }\n\n  // Child component management.\n\n  /**\n   * Returns the child menu item that owns the given DOM element,\n   * or null if no such menu item is found.\n   *\n   * @param elem DOM element whose owner is to be returned.\n   * @returns Menu item for which the DOM element belongs to.\n   */\n  private getMenuItem(elem: Element): MenuItem | null {\n    const menuElem = this.getElement();\n    // Node might be the menu border (resulting in no associated menu item), or\n    // a menu item's div, or some element within the menu item.\n    // Walk up parents until one meets either the menu's root element, or\n    // a menu item's div.\n    let currentElement: Element | null = elem;\n    while (currentElement && currentElement !== menuElem) {\n      if (currentElement.classList.contains('blocklyMenuItem')) {\n        // Having found a menu item's div, locate that menu item in this menu.\n        for (let i = 0, menuItem; (menuItem = this.menuItems[i]); i++) {\n          if (menuItem.getElement() === currentElement) {\n            return menuItem;\n          }\n        }\n      }\n      currentElement = currentElement.parentElement;\n    }\n    return null;\n  }\n\n  // Highlight management.\n\n  /**\n   * Highlights the given menu item, or clears highlighting if null.\n   *\n   * @param item Item to highlight, or null.\n   * @internal\n   */\n  setHighlighted(item: MenuItem | null) {\n    const currentHighlighted = this.highlightedItem;\n    if (currentHighlighted) {\n      currentHighlighted.setHighlighted(false);\n      this.highlightedItem = null;\n    }\n    if (item) {\n      item.setHighlighted(true);\n      this.highlightedItem = item;\n      // Bring the highlighted item into view. This has no effect if the menu is\n      // not scrollable.\n      const el = this.getElement() as Element;\n      style.scrollIntoContainerView(item.getElement() as Element, el);\n\n      aria.setState(el, aria.State.ACTIVEDESCENDANT, item.getId());\n    }\n  }\n\n  /**\n   * Highlights the next highlightable item (or the first if nothing is\n   * currently highlighted).\n   *\n   * @internal\n   */\n  highlightNext() {\n    const index = this.highlightedItem\n      ? this.menuItems.indexOf(this.highlightedItem)\n      : -1;\n    this.highlightHelper(index, 1);\n  }\n\n  /**\n   * Highlights the previous highlightable item (or the last if nothing is\n   * currently highlighted).\n   *\n   * @internal\n   */\n  highlightPrevious() {\n    const index = this.highlightedItem\n      ? this.menuItems.indexOf(this.highlightedItem)\n      : -1;\n    this.highlightHelper(index < 0 ? this.menuItems.length : index, -1);\n  }\n\n  /** Highlights the first highlightable item. */\n  private highlightFirst() {\n    this.highlightHelper(-1, 1);\n  }\n\n  /** Highlights the last highlightable item. */\n  private highlightLast() {\n    this.highlightHelper(this.menuItems.length, -1);\n  }\n\n  /**\n   * Helper function that manages the details of moving the highlight among\n   * child menuitems in response to keyboard events.\n   *\n   * @param startIndex Start index.\n   * @param delta Step direction: 1 to go down, -1 to go up.\n   */\n  private highlightHelper(startIndex: number, delta: number) {\n    let index = startIndex + delta;\n    let menuItem;\n    while ((menuItem = this.menuItems[index])) {\n      if (menuItem.isEnabled()) {\n        this.setHighlighted(menuItem);\n        break;\n      }\n      index += delta;\n    }\n  }\n\n  // Mouse events.\n\n  /**\n   * Handles mouseover events. Highlight menuitems as the user hovers over them.\n   *\n   * @param e Mouse event to handle.\n   */\n  private handleMouseOver(e: PointerEvent) {\n    const menuItem = this.getMenuItem(e.target as Element);\n\n    if (menuItem) {\n      if (menuItem.isEnabled()) {\n        if (this.highlightedItem !== menuItem) {\n          this.setHighlighted(menuItem);\n        }\n      } else {\n        this.setHighlighted(null);\n      }\n    }\n  }\n\n  /**\n   * Handles click events. Pass the event onto the child menuitem to handle.\n   *\n   * @param e Click event to handle.\n   */\n  private handleClick(e: PointerEvent) {\n    const oldCoords = this.openingCoords;\n    // Clear out the saved opening coords immediately so they're not used twice.\n    this.openingCoords = null;\n    if (oldCoords && typeof e.clientX === 'number') {\n      const newCoords = new Coordinate(e.clientX, e.clientY);\n      if (Coordinate.distance(oldCoords, newCoords) < 1) {\n        // This menu was opened by a mousedown and we're handling the consequent\n        // click event. The coords haven't changed, meaning this was the same\n        // opening event. Don't do the usual behavior because the menu just\n        // popped up under the mouse and the user didn't mean to activate this\n        // item.\n        return;\n      }\n    }\n\n    const menuItem = this.getMenuItem(e.target as Element);\n    if (menuItem) {\n      menuItem.performAction();\n    }\n  }\n\n  /**\n   * Handles mouse enter events. Focus the element.\n   *\n   * @param _e Mouse event to handle.\n   */\n  private handleMouseEnter(_e: PointerEvent) {\n    this.focus();\n  }\n\n  /**\n   * Handles mouse leave events. Blur and clear highlight.\n   *\n   * @param _e Mouse event to handle.\n   */\n  private handleMouseLeave(_e: PointerEvent) {\n    if (this.getElement()) {\n      this.blur();\n      this.setHighlighted(null);\n    }\n  }\n\n  // Keyboard events.\n\n  /**\n   * Attempts to handle a keyboard event, if the menu item is enabled, by\n   * calling\n   * {@link Menu#handleKeyEventInternal_}.\n   *\n   * @param e Key event to handle.\n   */\n  private handleKeyEvent(e: Event) {\n    if (!this.menuItems.length) {\n      // Empty menu.\n      return;\n    }\n    const keyboardEvent = e as KeyboardEvent;\n    if (\n      keyboardEvent.shiftKey ||\n      keyboardEvent.ctrlKey ||\n      keyboardEvent.metaKey ||\n      keyboardEvent.altKey\n    ) {\n      // Do not handle the key event if any modifier key is pressed.\n      return;\n    }\n\n    const highlighted = this.highlightedItem;\n    switch (keyboardEvent.key) {\n      case 'Enter':\n      case ' ':\n        if (highlighted) {\n          highlighted.performAction();\n        }\n        break;\n\n      case 'ArrowUp':\n        this.highlightPrevious();\n        break;\n\n      case 'ArrowDown':\n        this.highlightNext();\n        break;\n\n      case 'PageUp':\n      case 'Home':\n        this.highlightFirst();\n        break;\n\n      case 'PageDown':\n      case 'End':\n        this.highlightLast();\n        break;\n\n      default:\n        // Not a key the menu is interested in.\n        return;\n    }\n    // The menu used this key, don't let it have secondary effects.\n    e.preventDefault();\n    e.stopPropagation();\n  }\n\n  /**\n   * Get the size of a rendered menu.\n   *\n   * @returns Object with width and height properties.\n   * @internal\n   */\n  getSize(): Size {\n    const menuDom = this.getElement() as HTMLDivElement;\n    const menuSize = style.getSize(menuDom);\n    // Recalculate height for the total content, not only box height.\n    menuSize.height = menuDom.scrollHeight;\n    return menuSize;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Blockly menu item similar to Closure's goog.ui.MenuItem\n *\n * @class\n */\n// Former goog.module ID: Blockly.MenuItem\n\nimport * as aria from './utils/aria.js';\nimport * as dom from './utils/dom.js';\nimport * as idGenerator from './utils/idgenerator.js';\n\n/**\n * Class representing an item in a menu.\n */\nexport class MenuItem {\n  /** Is the menu item clickable, as opposed to greyed-out. */\n  private enabled = true;\n\n  /** The DOM element for the menu item. */\n  private element: HTMLDivElement | null = null;\n\n  /** Whether the menu item is rendered right-to-left. */\n  private rightToLeft = false;\n\n  /** ARIA name for this menu. */\n  private roleName: aria.Role | null = null;\n\n  /** Is this menu item checkable. */\n  private checkable = false;\n\n  /** Is this menu item currently checked. */\n  private checked = false;\n\n  /** Is this menu item currently highlighted. */\n  private highlight = false;\n\n  /** Bound function to call when this menu item is clicked. */\n  private actionHandler: Function | null = null;\n\n  /**\n   * @param content Text caption to display as the content of the item, or a\n   *     HTML element to display.\n   * @param opt_value Data/model associated with the menu item.\n   */\n  constructor(\n    private readonly content: string | HTMLElement,\n    private readonly opt_value?: string,\n  ) {}\n\n  /**\n   * Creates the menuitem's DOM.\n   *\n   * @returns Completed DOM.\n   */\n  createDom(): Element {\n    const element = document.createElement('div');\n    element.id = idGenerator.getNextUniqueId();\n    this.element = element;\n\n    // Set class and style\n    // goog-menuitem* is deprecated, use blocklyMenuItem*.  May 2020.\n    element.className =\n      'blocklyMenuItem goog-menuitem ' +\n      (this.enabled ? '' : 'blocklyMenuItemDisabled goog-menuitem-disabled ') +\n      (this.checked ? 'blocklyMenuItemSelected goog-option-selected ' : '') +\n      (this.highlight\n        ? 'blocklyMenuItemHighlight goog-menuitem-highlight '\n        : '') +\n      (this.rightToLeft ? 'blocklyMenuItemRtl goog-menuitem-rtl ' : '');\n\n    const content = document.createElement('div');\n    content.className = 'blocklyMenuItemContent goog-menuitem-content';\n    // Add a checkbox for checkable menu items.\n    if (this.checkable) {\n      const checkbox = document.createElement('div');\n      checkbox.className = 'blocklyMenuItemCheckbox goog-menuitem-checkbox';\n      content.appendChild(checkbox);\n    }\n\n    let contentDom: Node = this.content as HTMLElement;\n    if (typeof this.content === 'string') {\n      contentDom = document.createTextNode(this.content);\n    }\n    content.appendChild(contentDom);\n    element.appendChild(content);\n\n    // Initialize ARIA role and state.\n    if (this.roleName) {\n      aria.setRole(element, this.roleName);\n    }\n    aria.setState(\n      element,\n      aria.State.SELECTED,\n      (this.checkable && this.checked) || false,\n    );\n    aria.setState(element, aria.State.DISABLED, !this.enabled);\n\n    return element;\n  }\n\n  /** Dispose of this menu item. */\n  dispose() {\n    this.element = null;\n  }\n\n  /**\n   * Gets the menu item's element.\n   *\n   * @returns The DOM element.\n   * @internal\n   */\n  getElement(): Element | null {\n    return this.element;\n  }\n\n  /**\n   * Gets the unique ID for this menu item.\n   *\n   * @returns Unique component ID.\n   * @internal\n   */\n  getId(): string {\n    return this.element!.id;\n  }\n\n  /**\n   * Gets the value associated with the menu item.\n   *\n   * @returns value Value associated with the menu item.\n   * @internal\n   */\n  getValue(): string | null {\n    return this.opt_value ?? null;\n  }\n\n  /**\n   * Set menu item's rendering direction.\n   *\n   * @param rtl True if RTL, false if LTR.\n   * @internal\n   */\n  setRightToLeft(rtl: boolean) {\n    this.rightToLeft = rtl;\n  }\n\n  /**\n   * Set the menu item's accessibility role.\n   *\n   * @param roleName Role name.\n   * @internal\n   */\n  setRole(roleName: aria.Role) {\n    this.roleName = roleName;\n  }\n\n  /**\n   * Sets the menu item to be checkable or not. Set to true for menu items\n   * that represent checkable options.\n   *\n   * @param checkable Whether the menu item is checkable.\n   * @internal\n   */\n  setCheckable(checkable: boolean) {\n    this.checkable = checkable;\n  }\n\n  /**\n   * Checks or unchecks the component.\n   *\n   * @param checked Whether to check or uncheck the component.\n   * @internal\n   */\n  setChecked(checked: boolean) {\n    this.checked = checked;\n  }\n\n  /**\n   * Highlights or unhighlights the component.\n   *\n   * @param highlight Whether to highlight or unhighlight the component.\n   * @internal\n   */\n  setHighlighted(highlight: boolean) {\n    this.highlight = highlight;\n\n    const el = this.getElement();\n    if (el && this.isEnabled()) {\n      // goog-menuitem-highlight is deprecated, use blocklyMenuItemHighlight.\n      // May 2020.\n      const name = 'blocklyMenuItemHighlight';\n      const nameDep = 'goog-menuitem-highlight';\n      if (highlight) {\n        dom.addClass(el, name);\n        dom.addClass(el, nameDep);\n      } else {\n        dom.removeClass(el, name);\n        dom.removeClass(el, nameDep);\n      }\n    }\n  }\n\n  /**\n   * Returns true if the menu item is enabled, false otherwise.\n   *\n   * @returns Whether the menu item is enabled.\n   * @internal\n   */\n  isEnabled(): boolean {\n    return this.enabled;\n  }\n\n  /**\n   * Enables or disables the menu item.\n   *\n   * @param enabled Whether to enable or disable the menu item.\n   * @internal\n   */\n  setEnabled(enabled: boolean) {\n    this.enabled = enabled;\n  }\n\n  /**\n   * Performs the appropriate action when the menu item is activated\n   * by the user.\n   *\n   * @internal\n   */\n  performAction() {\n    if (this.isEnabled() && this.actionHandler) {\n      this.actionHandler(this);\n    }\n  }\n\n  /**\n   * Set the handler that's called when the menu item is activated by the user.\n   * `obj` will be used as the 'this' object in the function when called.\n   *\n   * @param fn The handler.\n   * @param obj Used as the 'this' object in fn when called.\n   * @internal\n   */\n  onAction(fn: (p1: MenuItem) => void, obj: object) {\n    this.actionHandler = fn.bind(obj);\n  }\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Registry for context menu option items.\n *\n * @class\n */\n// Former goog.module ID: Blockly.ContextMenuRegistry\n\nimport type {BlockSvg} from './block_svg.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Class for the registry of context menu items. This is intended to be a\n * singleton. You should not create a new instance, and only access this class\n * from ContextMenuRegistry.registry.\n */\nexport class ContextMenuRegistry {\n  static registry: ContextMenuRegistry;\n  /** Registry of all registered RegistryItems, keyed by ID. */\n  private registry_ = new Map<string, RegistryItem>();\n\n  /** Resets the existing singleton instance of ContextMenuRegistry. */\n  constructor() {\n    this.reset();\n  }\n\n  /** Clear and recreate the registry. */\n  reset() {\n    this.registry_.clear();\n  }\n\n  /**\n   * Registers a RegistryItem.\n   *\n   * @param item Context menu item to register.\n   * @throws {Error} if an item with the given ID already exists.\n   */\n  register(item: RegistryItem) {\n    if (this.registry_.has(item.id)) {\n      throw Error('Menu item with ID \"' + item.id + '\" is already registered.');\n    }\n    this.registry_.set(item.id, item);\n  }\n\n  /**\n   * Unregisters a RegistryItem with the given ID.\n   *\n   * @param id The ID of the RegistryItem to remove.\n   * @throws {Error} if an item with the given ID does not exist.\n   */\n  unregister(id: string) {\n    if (!this.registry_.has(id)) {\n      throw new Error('Menu item with ID \"' + id + '\" not found.');\n    }\n    this.registry_.delete(id);\n  }\n\n  /**\n   * @param id The ID of the RegistryItem to get.\n   * @returns RegistryItem or null if not found\n   */\n  getItem(id: string): RegistryItem | null {\n    return this.registry_.get(id) ?? null;\n  }\n\n  /**\n   * Gets the valid context menu options for the given scope type (e.g. block or\n   * workspace) and scope. Blocks are only shown if the preconditionFn shows\n   * they should not be hidden.\n   *\n   * @param scopeType Type of scope where menu should be shown (e.g. on a block\n   *     or on a workspace)\n   * @param scope Current scope of context menu (i.e., the exact workspace or\n   *     block being clicked on)\n   * @returns the list of ContextMenuOptions\n   */\n  getContextMenuOptions(\n    scopeType: ScopeType,\n    scope: Scope,\n  ): ContextMenuOption[] {\n    const menuOptions: ContextMenuOption[] = [];\n    for (const item of this.registry_.values()) {\n      if (scopeType === item.scopeType) {\n        const precondition = item.preconditionFn(scope);\n        if (precondition !== 'hidden') {\n          const displayText =\n            typeof item.displayText === 'function'\n              ? item.displayText(scope)\n              : item.displayText;\n          const menuOption: ContextMenuOption = {\n            text: displayText,\n            enabled: precondition === 'enabled',\n            callback: item.callback,\n            scope,\n            weight: item.weight,\n          };\n          menuOptions.push(menuOption);\n        }\n      }\n    }\n    menuOptions.sort(function (a, b) {\n      return a.weight - b.weight;\n    });\n    return menuOptions;\n  }\n}\n\nexport namespace ContextMenuRegistry {\n  /**\n   * Where this menu item should be rendered. If the menu item should be\n   * rendered in multiple scopes, e.g. on both a block and a workspace, it\n   * should be registered for each scope.\n   */\n  export enum ScopeType {\n    BLOCK = 'block',\n    WORKSPACE = 'workspace',\n  }\n\n  /**\n   * The actual workspace/block where the menu is being rendered. This is passed\n   * to callback and displayText functions that depend on this information.\n   */\n  export interface Scope {\n    block?: BlockSvg;\n    workspace?: WorkspaceSvg;\n  }\n\n  /**\n   * A menu item as entered in the registry.\n   */\n  export interface RegistryItem {\n    callback: (p1: Scope) => void;\n    scopeType: ScopeType;\n    displayText: ((p1: Scope) => string | HTMLElement) | string | HTMLElement;\n    preconditionFn: (p1: Scope) => string;\n    weight: number;\n    id: string;\n  }\n\n  /**\n   * A menu item as presented to contextmenu.js.\n   */\n  export interface ContextMenuOption {\n    text: string | HTMLElement;\n    enabled: boolean;\n    callback: (p1: Scope) => void;\n    scope: Scope;\n    weight: number;\n  }\n\n  /**\n   * A subset of ContextMenuOption corresponding to what was publicly\n   * documented.  ContextMenuOption should be preferred for new code.\n   */\n  export interface LegacyContextMenuOption {\n    text: string;\n    enabled: boolean;\n    callback: (p1: Scope) => void;\n  }\n\n  /**\n   * Singleton instance of this class. All interactions with this class should\n   * be done on this object.\n   */\n  ContextMenuRegistry.registry = new ContextMenuRegistry();\n}\n\nexport type ScopeType = ContextMenuRegistry.ScopeType;\nexport const ScopeType = ContextMenuRegistry.ScopeType;\nexport type Scope = ContextMenuRegistry.Scope;\nexport type RegistryItem = ContextMenuRegistry.RegistryItem;\nexport type ContextMenuOption = ContextMenuRegistry.ContextMenuOption;\nexport type LegacyContextMenuOption =\n  ContextMenuRegistry.LegacyContextMenuOption;\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The layer to place blocks on.\n *\n * @internal\n */\nexport const BLOCK = 50;\n\n/**\n * The layer to place bubbles on.\n *\n * @internal\n */\nexport const BUBBLE = 100;\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Methods for dragging a bubble visually.\n *\n * @class\n */\n// Former goog.module ID: Blockly.BubbleDragger\n\nimport {ComponentManager} from './component_manager.js';\nimport type {CommentMove} from './events/events_comment_move.js';\nimport * as eventUtils from './events/utils.js';\nimport type {IBubble} from './interfaces/i_bubble.js';\nimport type {IDeleteArea} from './interfaces/i_delete_area.js';\nimport type {IDragTarget} from './interfaces/i_drag_target.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport {WorkspaceCommentSvg} from './workspace_comment_svg.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport * as layers from './layers.js';\n\n/**\n * Class for a bubble dragger.  It moves things on the bubble canvas around the\n * workspace when they are being dragged by a mouse or touch.  These can be\n * block comments, mutators, warnings, or workspace comments.\n */\nexport class BubbleDragger {\n  /** Which drag target the mouse pointer is over, if any. */\n  private dragTarget_: IDragTarget | null = null;\n\n  /** Whether the bubble would be deleted if dropped immediately. */\n  private wouldDeleteBubble_ = false;\n  private readonly startXY_: Coordinate;\n\n  /**\n   * @param bubble The item on the bubble canvas to drag.\n   * @param workspace The workspace to drag on.\n   */\n  constructor(\n    private bubble: IBubble,\n    private workspace: WorkspaceSvg,\n  ) {\n    /**\n     * The location of the top left corner of the dragging bubble's body at the\n     * beginning of the drag, in workspace coordinates.\n     */\n    this.startXY_ = this.bubble.getRelativeToSurfaceXY();\n  }\n\n  /**\n   * Start dragging a bubble.\n   *\n   * @internal\n   */\n  startBubbleDrag() {\n    if (!eventUtils.getGroup()) {\n      eventUtils.setGroup(true);\n    }\n\n    this.workspace.setResizesEnabled(false);\n    if ((this.bubble as AnyDuringMigration).setAutoLayout) {\n      (this.bubble as AnyDuringMigration).setAutoLayout(false);\n    }\n\n    this.workspace.getLayerManager()?.moveToDragLayer(this.bubble);\n\n    this.bubble.setDragging && this.bubble.setDragging(true);\n  }\n\n  /**\n   * Execute a step of bubble dragging, based on the given event.  Update the\n   * display accordingly.\n   *\n   * @param e The most recent move event.\n   * @param currentDragDeltaXY How far the pointer has moved from the position\n   *     at the start of the drag, in pixel units.\n   * @internal\n   */\n  dragBubble(e: PointerEvent, currentDragDeltaXY: Coordinate) {\n    const delta = this.pixelsToWorkspaceUnits_(currentDragDeltaXY);\n    const newLoc = Coordinate.sum(this.startXY_, delta);\n    this.bubble.moveDuringDrag(newLoc);\n\n    const oldDragTarget = this.dragTarget_;\n    this.dragTarget_ = this.workspace.getDragTarget(e);\n\n    const oldWouldDeleteBubble = this.wouldDeleteBubble_;\n    this.wouldDeleteBubble_ = this.shouldDelete_(this.dragTarget_);\n    if (oldWouldDeleteBubble !== this.wouldDeleteBubble_) {\n      // Prevent unnecessary add/remove class calls.\n      this.updateCursorDuringBubbleDrag_();\n    }\n    // Call drag enter/exit/over after wouldDeleteBlock is called in\n    // shouldDelete_\n    if (this.dragTarget_ !== oldDragTarget) {\n      oldDragTarget && oldDragTarget.onDragExit(this.bubble);\n      this.dragTarget_ && this.dragTarget_.onDragEnter(this.bubble);\n    }\n    this.dragTarget_ && this.dragTarget_.onDragOver(this.bubble);\n  }\n\n  /**\n   * Whether ending the drag would delete the bubble.\n   *\n   * @param dragTarget The drag target that the bubblee is currently over.\n   * @returns Whether dropping the bubble immediately would delete the block.\n   */\n  private shouldDelete_(dragTarget: IDragTarget | null): boolean {\n    if (dragTarget) {\n      const componentManager = this.workspace.getComponentManager();\n      const isDeleteArea = componentManager.hasCapability(\n        dragTarget.id,\n        ComponentManager.Capability.DELETE_AREA,\n      );\n      if (isDeleteArea) {\n        return (dragTarget as IDeleteArea).wouldDelete(this.bubble, false);\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Update the cursor (and possibly the trash can lid) to reflect whether the\n   * dragging bubble would be deleted if released immediately.\n   */\n  private updateCursorDuringBubbleDrag_() {\n    this.bubble.setDeleteStyle(this.wouldDeleteBubble_);\n  }\n\n  /**\n   * Finish a bubble drag and put the bubble back on the workspace.\n   *\n   * @param e The pointerup event.\n   * @param currentDragDeltaXY How far the pointer has moved from the position\n   *     at the start of the drag, in pixel units.\n   * @internal\n   */\n  endBubbleDrag(e: PointerEvent, currentDragDeltaXY: Coordinate) {\n    // Make sure internal state is fresh.\n    this.dragBubble(e, currentDragDeltaXY);\n\n    const preventMove =\n      this.dragTarget_ && this.dragTarget_.shouldPreventMove(this.bubble);\n    let newLoc;\n    if (preventMove) {\n      newLoc = this.startXY_;\n    } else {\n      const delta = this.pixelsToWorkspaceUnits_(currentDragDeltaXY);\n      newLoc = Coordinate.sum(this.startXY_, delta);\n    }\n    // Move the bubble to its final location.\n    this.bubble.moveTo(newLoc.x, newLoc.y);\n\n    if (this.dragTarget_) {\n      this.dragTarget_.onDrop(this.bubble);\n    }\n\n    if (this.wouldDeleteBubble_) {\n      // Fire a move event, so we know where to go back to for an undo.\n      this.fireMoveEvent_();\n      this.bubble.dispose();\n    } else {\n      // Put everything back onto the bubble canvas.\n      if (this.bubble.setDragging) {\n        this.bubble.setDragging(false);\n        this.workspace\n          .getLayerManager()\n          ?.moveOffDragLayer(this.bubble, layers.BUBBLE);\n      }\n      this.fireMoveEvent_();\n    }\n    this.workspace.setResizesEnabled(true);\n\n    eventUtils.setGroup(false);\n  }\n\n  /** Fire a move event at the end of a bubble drag. */\n  private fireMoveEvent_() {\n    if (this.bubble instanceof WorkspaceCommentSvg) {\n      const event = new (eventUtils.get(eventUtils.COMMENT_MOVE))(\n        this.bubble,\n      ) as CommentMove;\n      event.setOldCoordinate(this.startXY_);\n      event.recordNew();\n      eventUtils.fire(event);\n    }\n    // TODO (fenichel): move events for comments.\n    return;\n  }\n\n  /**\n   * Convert a coordinate object from pixels to workspace units, including a\n   * correction for mutator workspaces.\n   * This function does not consider differing origins.  It simply scales the\n   * input's x and y values.\n   *\n   * @param pixelCoord A coordinate with x and y values in CSS pixel units.\n   * @returns The input coordinate divided by the workspace scale.\n   */\n  private pixelsToWorkspaceUnits_(pixelCoord: Coordinate): Coordinate {\n    const result = new Coordinate(\n      pixelCoord.x / this.workspace.scale,\n      pixelCoord.y / this.workspace.scale,\n    );\n    if (this.workspace.isMutator) {\n      // If we're in a mutator, its scale is always 1, purely because of some\n      // oddities in our rendering optimizations.  The actual scale is the same\n      // as the scale on the parent workspace. Fix that for dragging.\n      const mainScale = this.workspace.options.parentWorkspace!.scale;\n      result.scale(1 / mainScale);\n    }\n    return result;\n  }\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.internalConstants\n\nimport {ConnectionType} from './connection_type.js';\n\n/**\n * Number of characters to truncate a collapsed block to.\n *\n * @internal\n */\nexport const COLLAPSE_CHARS = 30;\n\n/**\n * When dragging a block out of a stack, split the stack in two (true), or drag\n * out the block healing the stack (false).\n *\n * @internal\n */\nexport const DRAG_STACK = true;\n\n/**\n * Lookup table for determining the opposite type of a connection.\n *\n * @internal\n */\nexport const OPPOSITE_TYPE: number[] = [];\nOPPOSITE_TYPE[ConnectionType.INPUT_VALUE] = ConnectionType.OUTPUT_VALUE;\nOPPOSITE_TYPE[ConnectionType.OUTPUT_VALUE] = ConnectionType.INPUT_VALUE;\nOPPOSITE_TYPE[ConnectionType.NEXT_STATEMENT] =\n  ConnectionType.PREVIOUS_STATEMENT;\nOPPOSITE_TYPE[ConnectionType.PREVIOUS_STATEMENT] =\n  ConnectionType.NEXT_STATEMENT;\n\n/**\n * String for use in the dropdown created in field_variable.\n * This string indicates that this option in the dropdown is 'Rename\n * variable...' and if selected, should trigger the prompt to rename a variable.\n *\n * @internal\n */\nexport const RENAME_VARIABLE_ID = 'RENAME_VARIABLE_ID';\n\n/**\n * String for use in the dropdown created in field_variable.\n * This string indicates that this option in the dropdown is 'Delete the \"%1\"\n * variable' and if selected, should trigger the prompt to delete a variable.\n *\n * @internal\n */\nexport const DELETE_VARIABLE_ID = 'DELETE_VARIABLE_ID';\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Methods for dragging a workspace visually.\n *\n * @class\n */\n// Former goog.module ID: Blockly.WorkspaceDragger\n\nimport * as common from './common.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Class for a workspace dragger.  It moves the workspace around when it is\n * being dragged by a mouse or touch.\n *\n */\nexport class WorkspaceDragger {\n  private readonly horizontalScrollEnabled_: boolean;\n  private readonly verticalScrollEnabled_: boolean;\n  protected startScrollXY_: Coordinate;\n\n  /** @param workspace The workspace to drag. */\n  constructor(private workspace: WorkspaceSvg) {\n    /** Whether horizontal scroll is enabled. */\n    this.horizontalScrollEnabled_ = this.workspace.isMovableHorizontally();\n\n    /** Whether vertical scroll is enabled. */\n    this.verticalScrollEnabled_ = this.workspace.isMovableVertically();\n\n    /**\n     * The scroll position of the workspace at the beginning of the drag.\n     * Coordinate system: pixel coordinates.\n     */\n    this.startScrollXY_ = new Coordinate(workspace.scrollX, workspace.scrollY);\n  }\n\n  /**\n   * Sever all links from this object.\n   *\n   * @internal\n   */\n  dispose() {\n    // AnyDuringMigration because:  Type 'null' is not assignable to type\n    // 'WorkspaceSvg'.\n    this.workspace = null as AnyDuringMigration;\n  }\n\n  /**\n   * Start dragging the workspace.\n   *\n   * @internal\n   */\n  startDrag() {\n    if (common.getSelected()) {\n      common.getSelected()!.unselect();\n    }\n  }\n\n  /**\n   * Finish dragging the workspace and put everything back where it belongs.\n   *\n   * @param currentDragDeltaXY How far the pointer has moved from the position\n   *     at the start of the drag, in pixel coordinates.\n   * @internal\n   */\n  endDrag(currentDragDeltaXY: Coordinate) {\n    // Make sure everything is up to date.\n    this.drag(currentDragDeltaXY);\n  }\n\n  /**\n   * Move the workspace based on the most recent mouse movements.\n   *\n   * @param currentDragDeltaXY How far the pointer has moved from the position\n   *     at the start of the drag, in pixel coordinates.\n   * @internal\n   */\n  drag(currentDragDeltaXY: Coordinate) {\n    const newXY = Coordinate.sum(this.startScrollXY_, currentDragDeltaXY);\n\n    if (this.horizontalScrollEnabled_ && this.verticalScrollEnabled_) {\n      this.workspace.scroll(newXY.x, newXY.y);\n    } else if (this.horizontalScrollEnabled_) {\n      this.workspace.scroll(newXY.x, this.workspace.scrollY);\n    } else if (this.verticalScrollEnabled_) {\n      this.workspace.scroll(this.workspace.scrollX, newXY.y);\n    } else {\n      throw new TypeError('Invalid state.');\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The class representing an in-progress gesture, e.g. a drag,\n * tap, or pinch to zoom.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Gesture\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_click.js';\n\nimport * as blockAnimations from './block_animations.js';\nimport type {BlockSvg} from './block_svg.js';\nimport * as browserEvents from './browser_events.js';\nimport {BubbleDragger} from './bubble_dragger.js';\nimport * as common from './common.js';\nimport {config} from './config.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport * as eventUtils from './events/utils.js';\nimport type {Field} from './field.js';\nimport type {IBlockDragger} from './interfaces/i_block_dragger.js';\nimport type {IBubble} from './interfaces/i_bubble.js';\nimport type {IFlyout} from './interfaces/i_flyout.js';\nimport * as internalConstants from './internal_constants.js';\nimport * as registry from './registry.js';\nimport * as Tooltip from './tooltip.js';\nimport * as Touch from './touch.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport {WorkspaceCommentSvg} from './workspace_comment_svg.js';\nimport {WorkspaceDragger} from './workspace_dragger.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport type {IIcon} from './interfaces/i_icon.js';\n\n/**\n * Note: In this file \"start\" refers to pointerdown\n * events.  \"End\" refers to pointerup events.\n */\n\n/** A multiplier used to convert the gesture scale to a zoom in delta. */\nconst ZOOM_IN_MULTIPLIER = 5;\n\n/** A multiplier used to convert the gesture scale to a zoom out delta. */\nconst ZOOM_OUT_MULTIPLIER = 6;\n\n/**\n * Class for one gesture.\n */\nexport class Gesture {\n  /**\n   * The position of the pointer when the gesture started.  Units are CSS\n   * pixels, with (0, 0) at the top left of the browser window (pointer event\n   * clientX/Y).\n   */\n  private mouseDownXY = new Coordinate(0, 0);\n  private currentDragDeltaXY: Coordinate;\n\n  /**\n   * The bubble that the gesture started on, or null if it did not start on a\n   * bubble.\n   */\n  private startBubble: IBubble | null = null;\n\n  /**\n   * The field that the gesture started on, or null if it did not start on a\n   * field.\n   */\n  private startField: Field | null = null;\n\n  /**\n   * The icon that the gesture started on, or null if it did not start on an\n   * icon.\n   */\n  private startIcon: IIcon | null = null;\n\n  /**\n   * The block that the gesture started on, or null if it did not start on a\n   * block.\n   */\n  private startBlock: BlockSvg | null = null;\n\n  /**\n   * The block that this gesture targets.  If the gesture started on a\n   * shadow block, this is the first non-shadow parent of the block.  If the\n   * gesture started in the flyout, this is the root block of the block group\n   * that was clicked or dragged.\n   */\n  private targetBlock: BlockSvg | null = null;\n\n  /**\n   * The workspace that the gesture started on.  There may be multiple\n   * workspaces on a page; this is more accurate than using\n   * Blockly.common.getMainWorkspace().\n   */\n  protected startWorkspace_: WorkspaceSvg | null = null;\n\n  /**\n   * Whether the pointer has at any point moved out of the drag radius.\n   * A gesture that exceeds the drag radius is a drag even if it ends exactly\n   * at its start point.\n   */\n  private hasExceededDragRadius = false;\n\n  /**\n   * Array holding info needed to unbind events.\n   * Used for disposing.\n   * Ex: [[node, name, func], [node, name, func]].\n   */\n  private boundEvents: browserEvents.Data[] = [];\n\n  /** The object tracking a bubble drag, or null if none is in progress. */\n  private bubbleDragger: BubbleDragger | null = null;\n\n  /** The object tracking a block drag, or null if none is in progress. */\n  private blockDragger: IBlockDragger | null = null;\n\n  /**\n   * The object tracking a workspace or flyout workspace drag, or null if none\n   * is in progress.\n   */\n  private workspaceDragger: WorkspaceDragger | null = null;\n\n  /** The flyout a gesture started in, if any. */\n  private flyout: IFlyout | null = null;\n\n  /** Boolean for sanity-checking that some code is only called once. */\n  private calledUpdateIsDragging = false;\n\n  /** Boolean for sanity-checking that some code is only called once. */\n  private gestureHasStarted = false;\n\n  /** Boolean used internally to break a cycle in disposal. */\n  protected isEnding_ = false;\n  private healStack: boolean;\n\n  /** The event that most recently updated this gesture. */\n  private mostRecentEvent: PointerEvent;\n\n  /** Boolean for whether or not this gesture is a multi-touch gesture. */\n  private isMultiTouch_ = false;\n\n  /** A map of cached points used for tracking multi-touch gestures. */\n  private cachedPoints = new Map<string, Coordinate | null>();\n\n  /**\n   * This is the ratio between the starting distance between the touch points\n   * and the most recent distance between the touch points.\n   * Scales between 0 and 1 mean the most recent zoom was a zoom out.\n   * Scales above 1.0 mean the most recent zoom was a zoom in.\n   */\n  private previousScale = 0;\n\n  /** The starting distance between two touch points. */\n  private startDistance = 0;\n\n  /** Boolean for whether or not the workspace supports pinch-zoom. */\n  private isPinchZoomEnabled: boolean | null = null;\n\n  /**\n   * The owner of the dropdownDiv when this gesture first starts.\n   * Needed because we'll close the dropdown before fields get to\n   * act on their events, and some fields care about who owns\n   * the dropdown.\n   */\n  currentDropdownOwner: Field | null = null;\n\n  /**\n   * @param e The event that kicked off this gesture.\n   * @param creatorWorkspace The workspace that created this gesture and has a\n   *     reference to it.\n   */\n  constructor(\n    e: PointerEvent,\n    private readonly creatorWorkspace: WorkspaceSvg,\n  ) {\n    this.mostRecentEvent = e;\n\n    /**\n     * How far the pointer has moved during this drag, in pixel units.\n     * (0, 0) is at this.mouseDownXY_.\n     */\n    this.currentDragDeltaXY = new Coordinate(0, 0);\n\n    /**\n     * Boolean used to indicate whether or not to heal the stack after\n     * disconnecting a block.\n     */\n    this.healStack = !internalConstants.DRAG_STACK;\n  }\n\n  /**\n   * Sever all links from this object.\n   *\n   * @internal\n   */\n  dispose() {\n    Touch.clearTouchIdentifier();\n    Tooltip.unblock();\n    // Clear the owner's reference to this gesture.\n    this.creatorWorkspace.clearGesture();\n\n    for (const event of this.boundEvents) {\n      browserEvents.unbind(event);\n    }\n    this.boundEvents.length = 0;\n\n    if (this.blockDragger) {\n      this.blockDragger.dispose();\n    }\n    if (this.workspaceDragger) {\n      this.workspaceDragger.dispose();\n    }\n  }\n\n  /**\n   * Update internal state based on an event.\n   *\n   * @param e The most recent pointer event.\n   */\n  private updateFromEvent(e: PointerEvent) {\n    const currentXY = new Coordinate(e.clientX, e.clientY);\n    const changed = this.updateDragDelta(currentXY);\n    // Exceeded the drag radius for the first time.\n    if (changed) {\n      this.updateIsDragging();\n      Touch.longStop();\n    }\n    this.mostRecentEvent = e;\n  }\n\n  /**\n   * DO MATH to set currentDragDeltaXY_ based on the most recent pointer\n   * position.\n   *\n   * @param currentXY The most recent pointer position, in pixel units,\n   *     with (0, 0) at the window's top left corner.\n   * @returns True if the drag just exceeded the drag radius for the first time.\n   */\n  private updateDragDelta(currentXY: Coordinate): boolean {\n    this.currentDragDeltaXY = Coordinate.difference(\n      currentXY,\n      this.mouseDownXY,\n    );\n\n    if (!this.hasExceededDragRadius) {\n      const currentDragDelta = Coordinate.magnitude(this.currentDragDeltaXY);\n\n      // The flyout has a different drag radius from the rest of Blockly.\n      const limitRadius = this.flyout\n        ? config.flyoutDragRadius\n        : config.dragRadius;\n\n      this.hasExceededDragRadius = currentDragDelta > limitRadius;\n      return this.hasExceededDragRadius;\n    }\n    return false;\n  }\n\n  /**\n   * Update this gesture to record whether a block is being dragged from the\n   * flyout.\n   * This function should be called on a pointermove event the first time\n   * the drag radius is exceeded.  It should be called no more than once per\n   * gesture. If a block should be dragged from the flyout this function creates\n   * the new block on the main workspace and updates targetBlock_ and\n   * startWorkspace_.\n   *\n   * @returns True if a block is being dragged from the flyout.\n   */\n  private updateIsDraggingFromFlyout(): boolean {\n    if (!this.targetBlock || !this.flyout?.isBlockCreatable(this.targetBlock)) {\n      return false;\n    }\n    if (!this.flyout.targetWorkspace) {\n      throw new Error(`Cannot update dragging from the flyout because the ' +\n          'flyout's target workspace is undefined`);\n    }\n    if (\n      !this.flyout.isScrollable() ||\n      this.flyout.isDragTowardWorkspace(this.currentDragDeltaXY)\n    ) {\n      this.startWorkspace_ = this.flyout.targetWorkspace;\n      this.startWorkspace_.updateScreenCalculationsIfScrolled();\n      // Start the event group now, so that the same event group is used for\n      // block creation and block dragging.\n      if (!eventUtils.getGroup()) {\n        eventUtils.setGroup(true);\n      }\n      // The start block is no longer relevant, because this is a drag.\n      this.startBlock = null;\n      this.targetBlock = this.flyout.createBlock(this.targetBlock);\n      this.targetBlock.select();\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Update this gesture to record whether a bubble is being dragged.\n   * This function should be called on a pointermove event the first time\n   * the drag radius is exceeded.  It should be called no more than once per\n   * gesture. If a bubble should be dragged this function creates the necessary\n   * BubbleDragger and starts the drag.\n   *\n   * @returns True if a bubble is being dragged.\n   */\n  private updateIsDraggingBubble(): boolean {\n    if (!this.startBubble) {\n      return false;\n    }\n\n    this.startDraggingBubble();\n    return true;\n  }\n\n  /**\n   * Check whether to start a block drag. If a block should be dragged, either\n   * from the flyout or in the workspace, create the necessary BlockDragger and\n   * start the drag.\n   *\n   * This function should be called on a pointermove event the first time\n   * the drag radius is exceeded.  It should be called no more than once per\n   * gesture. If a block should be dragged, either from the flyout or in the\n   * workspace, this function creates the necessary BlockDragger and starts the\n   * drag.\n   *\n   * @returns True if a block is being dragged.\n   */\n  private updateIsDraggingBlock(): boolean {\n    if (!this.targetBlock) {\n      return false;\n    }\n    if (this.flyout) {\n      if (this.updateIsDraggingFromFlyout()) {\n        this.startDraggingBlock();\n        return true;\n      }\n    } else if (this.targetBlock.isMovable()) {\n      this.startDraggingBlock();\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Check whether to start a workspace drag. If a workspace is being dragged,\n   * create the necessary WorkspaceDragger and start the drag.\n   *\n   * This function should be called on a pointermove event the first time\n   * the drag radius is exceeded.  It should be called no more than once per\n   * gesture. If a workspace is being dragged this function creates the\n   * necessary WorkspaceDragger and starts the drag.\n   */\n  private updateIsDraggingWorkspace() {\n    if (!this.startWorkspace_) {\n      throw new Error(\n        'Cannot update dragging the workspace because the ' +\n          'start workspace is undefined',\n      );\n    }\n\n    const wsMovable = this.flyout\n      ? this.flyout.isScrollable()\n      : this.startWorkspace_ && this.startWorkspace_.isDraggable();\n    if (!wsMovable) return;\n\n    this.workspaceDragger = new WorkspaceDragger(this.startWorkspace_);\n\n    this.workspaceDragger.startDrag();\n  }\n\n  /**\n   * Update this gesture to record whether anything is being dragged.\n   * This function should be called on a pointermove event the first time\n   * the drag radius is exceeded.  It should be called no more than once per\n   * gesture.\n   */\n  private updateIsDragging() {\n    // Sanity check.\n    if (this.calledUpdateIsDragging) {\n      throw Error('updateIsDragging_ should only be called once per gesture.');\n    }\n    this.calledUpdateIsDragging = true;\n\n    // First check if it was a bubble drag.  Bubbles always sit on top of\n    // blocks.\n    if (this.updateIsDraggingBubble()) {\n      return;\n    }\n    // Then check if it was a block drag.\n    if (this.updateIsDraggingBlock()) {\n      return;\n    }\n    // Then check if it's a workspace drag.\n    this.updateIsDraggingWorkspace();\n  }\n\n  /** Create a block dragger and start dragging the selected block. */\n  private startDraggingBlock() {\n    const BlockDraggerClass = registry.getClassFromOptions(\n      registry.Type.BLOCK_DRAGGER,\n      this.creatorWorkspace.options,\n      true,\n    );\n\n    this.blockDragger = new BlockDraggerClass!(\n      this.targetBlock,\n      this.startWorkspace_,\n    );\n    this.blockDragger!.startDrag(this.currentDragDeltaXY, this.healStack);\n    this.blockDragger!.drag(this.mostRecentEvent, this.currentDragDeltaXY);\n  }\n\n  /** Create a bubble dragger and start dragging the selected bubble. */\n  private startDraggingBubble() {\n    if (!this.startBubble) {\n      throw new Error(\n        'Cannot update dragging the bubble because the start ' +\n          'bubble is undefined',\n      );\n    }\n    if (!this.startWorkspace_) {\n      throw new Error(\n        'Cannot update dragging the bubble because the start ' +\n          'workspace is undefined',\n      );\n    }\n\n    this.bubbleDragger = new BubbleDragger(\n      this.startBubble,\n      this.startWorkspace_,\n    );\n    this.bubbleDragger.startBubbleDrag();\n    this.bubbleDragger.dragBubble(\n      this.mostRecentEvent,\n      this.currentDragDeltaXY,\n    );\n  }\n\n  /**\n   * Start a gesture: update the workspace to indicate that a gesture is in\n   * progress and bind pointermove and pointerup handlers.\n   *\n   * @param e A pointerdown event.\n   * @internal\n   */\n  doStart(e: PointerEvent) {\n    if (!this.startWorkspace_) {\n      throw new Error(\n        'Cannot start the touch gesture becauase the start ' +\n          'workspace is undefined',\n      );\n    }\n    this.isPinchZoomEnabled =\n      this.startWorkspace_.options.zoomOptions &&\n      this.startWorkspace_.options.zoomOptions.pinch;\n\n    if (browserEvents.isTargetInput(e)) {\n      this.cancel();\n      return;\n    }\n\n    this.gestureHasStarted = true;\n\n    blockAnimations.disconnectUiStop();\n\n    this.startWorkspace_.updateScreenCalculationsIfScrolled();\n    if (this.startWorkspace_.isMutator) {\n      // Mutator's coordinate system could be out of date because the bubble was\n      // dragged, the block was moved, the parent workspace zoomed, etc.\n      this.startWorkspace_.resize();\n    }\n\n    // Keep track of which field owns the dropdown before we close it.\n    this.currentDropdownOwner = dropDownDiv.getOwner();\n    // Hide chaff also hides the flyout, so don't do it if the click is in a\n    // flyout.\n    this.startWorkspace_.hideChaff(!!this.flyout);\n\n    this.startWorkspace_.markFocused();\n    this.mostRecentEvent = e;\n\n    Tooltip.block();\n\n    if (this.targetBlock) {\n      this.targetBlock.select();\n    }\n\n    if (browserEvents.isRightButton(e)) {\n      this.handleRightClick(e);\n      return;\n    }\n\n    if (e.type.toLowerCase() === 'pointerdown' && e.pointerType !== 'mouse') {\n      Touch.longStart(e, this);\n    }\n\n    this.mouseDownXY = new Coordinate(e.clientX, e.clientY);\n    this.healStack = e.altKey || e.ctrlKey || e.metaKey;\n\n    this.bindMouseEvents(e);\n\n    if (!this.isEnding_) {\n      this.handleTouchStart(e);\n    }\n  }\n\n  /**\n   * Bind gesture events.\n   *\n   * @param e A pointerdown event.\n   * @internal\n   */\n  bindMouseEvents(e: PointerEvent) {\n    this.boundEvents.push(\n      browserEvents.conditionalBind(\n        document,\n        'pointerdown',\n        null,\n        this.handleStart.bind(this),\n        /* opt_noCaptureIdentifier */ true,\n      ),\n    );\n    this.boundEvents.push(\n      browserEvents.conditionalBind(\n        document,\n        'pointermove',\n        null,\n        this.handleMove.bind(this),\n        /* opt_noCaptureIdentifier */ true,\n      ),\n    );\n    this.boundEvents.push(\n      browserEvents.conditionalBind(\n        document,\n        'pointerup',\n        null,\n        this.handleUp.bind(this),\n        /* opt_noCaptureIdentifier */ true,\n      ),\n    );\n\n    e.preventDefault();\n    e.stopPropagation();\n  }\n\n  /**\n   * Handle a pointerdown event.\n   *\n   * @param e A pointerdown event.\n   * @internal\n   */\n  handleStart(e: PointerEvent) {\n    if (this.isDragging()) {\n      // A drag has already started, so this can no longer be a pinch-zoom.\n      return;\n    }\n    this.handleTouchStart(e);\n\n    if (this.isMultiTouch()) {\n      Touch.longStop();\n    }\n  }\n\n  /**\n   * Handle a pointermove event.\n   *\n   * @param e A pointermove event.\n   * @internal\n   */\n  handleMove(e: PointerEvent) {\n    if (\n      (this.isDragging() && Touch.shouldHandleEvent(e)) ||\n      !this.isMultiTouch()\n    ) {\n      this.updateFromEvent(e);\n      if (this.workspaceDragger) {\n        this.workspaceDragger.drag(this.currentDragDeltaXY);\n      } else if (this.blockDragger) {\n        this.blockDragger.drag(this.mostRecentEvent, this.currentDragDeltaXY);\n      } else if (this.bubbleDragger) {\n        this.bubbleDragger.dragBubble(\n          this.mostRecentEvent,\n          this.currentDragDeltaXY,\n        );\n      }\n      e.preventDefault();\n      e.stopPropagation();\n    } else if (this.isMultiTouch()) {\n      this.handleTouchMove(e);\n      Touch.longStop();\n    }\n  }\n\n  /**\n   * Handle a pointerup event.\n   *\n   * @param e A pointerup event.\n   * @internal\n   */\n  handleUp(e: PointerEvent) {\n    if (!this.isDragging()) {\n      this.handleTouchEnd(e);\n    }\n    if (!this.isMultiTouch() || this.isDragging()) {\n      if (!Touch.shouldHandleEvent(e)) {\n        return;\n      }\n      this.updateFromEvent(e);\n      Touch.longStop();\n\n      if (this.isEnding_) {\n        console.log('Trying to end a gesture recursively.');\n        return;\n      }\n      this.isEnding_ = true;\n      // The ordering of these checks is important: drags have higher priority\n      // than clicks.  Fields and icons have higher priority than blocks; blocks\n      // have higher priority than workspaces. The ordering within drags does\n      // not matter, because the three types of dragging are exclusive.\n      if (this.bubbleDragger) {\n        this.bubbleDragger.endBubbleDrag(e, this.currentDragDeltaXY);\n      } else if (this.blockDragger) {\n        this.blockDragger.endDrag(e, this.currentDragDeltaXY);\n      } else if (this.workspaceDragger) {\n        this.workspaceDragger.endDrag(this.currentDragDeltaXY);\n      } else if (this.isBubbleClick()) {\n        // Bubbles are in front of all fields and blocks.\n        this.doBubbleClick();\n      } else if (this.isFieldClick()) {\n        this.doFieldClick();\n      } else if (this.isIconClick()) {\n        this.doIconClick();\n      } else if (this.isBlockClick()) {\n        this.doBlockClick();\n      } else if (this.isWorkspaceClick()) {\n        this.doWorkspaceClick(e);\n      }\n\n      e.preventDefault();\n      e.stopPropagation();\n\n      this.dispose();\n    } else {\n      e.preventDefault();\n      e.stopPropagation();\n\n      this.dispose();\n    }\n  }\n\n  /**\n   * Handle a pointerdown event and keep track of current\n   * pointers.\n   *\n   * @param e A pointerdown event.\n   * @internal\n   */\n  handleTouchStart(e: PointerEvent) {\n    const pointerId = Touch.getTouchIdentifierFromEvent(e);\n    // store the pointerId in the current list of pointers\n    this.cachedPoints.set(pointerId, this.getTouchPoint(e));\n    const pointers = Array.from(this.cachedPoints.keys());\n    // If two pointers are down, store info\n    if (pointers.length === 2) {\n      const point0 = this.cachedPoints.get(pointers[0])!;\n      const point1 = this.cachedPoints.get(pointers[1])!;\n      this.startDistance = Coordinate.distance(point0, point1);\n      this.isMultiTouch_ = true;\n      e.preventDefault();\n    }\n  }\n\n  /**\n   * Handle a pointermove event and zoom in/out if two pointers\n   * are on the screen.\n   *\n   * @param e A pointermove event.\n   * @internal\n   */\n  handleTouchMove(e: PointerEvent) {\n    const pointerId = Touch.getTouchIdentifierFromEvent(e);\n    // Update the cache\n    this.cachedPoints.set(pointerId, this.getTouchPoint(e));\n\n    if (this.isPinchZoomEnabled && this.cachedPoints.size === 2) {\n      this.handlePinch(e);\n    } else {\n      this.handleMove(e);\n    }\n  }\n\n  /**\n   * Handle pinch zoom gesture.\n   *\n   * @param e A pointermove event.\n   */\n  private handlePinch(e: PointerEvent) {\n    const pointers = Array.from(this.cachedPoints.keys());\n    // Calculate the distance between the two pointers\n    const point0 = this.cachedPoints.get(pointers[0])!;\n    const point1 = this.cachedPoints.get(pointers[1])!;\n    const moveDistance = Coordinate.distance(point0, point1);\n    const scale = moveDistance / this.startDistance;\n\n    if (this.previousScale > 0 && this.previousScale < Infinity) {\n      const gestureScale = scale - this.previousScale;\n      const delta =\n        gestureScale > 0\n          ? gestureScale * ZOOM_IN_MULTIPLIER\n          : gestureScale * ZOOM_OUT_MULTIPLIER;\n      if (!this.startWorkspace_) {\n        throw new Error(\n          'Cannot handle a pinch because the start workspace ' + 'is undefined',\n        );\n      }\n      const workspace = this.startWorkspace_;\n      const position = browserEvents.mouseToSvg(\n        e,\n        workspace.getParentSvg(),\n        workspace.getInverseScreenCTM(),\n      );\n      workspace.zoom(position.x, position.y, delta);\n    }\n    this.previousScale = scale;\n    e.preventDefault();\n  }\n\n  /**\n   * Handle a pointerup event and end the gesture.\n   *\n   * @param e A pointerup event.\n   * @internal\n   */\n  handleTouchEnd(e: PointerEvent) {\n    const pointerId = Touch.getTouchIdentifierFromEvent(e);\n    if (this.cachedPoints.has(pointerId)) {\n      this.cachedPoints.delete(pointerId);\n    }\n    if (this.cachedPoints.size < 2) {\n      this.cachedPoints.clear();\n      this.previousScale = 0;\n    }\n  }\n\n  /**\n   * Helper function returning the current touch point coordinate.\n   *\n   * @param e A pointer event.\n   * @returns The current touch point coordinate\n   * @internal\n   */\n  getTouchPoint(e: PointerEvent): Coordinate | null {\n    if (!this.startWorkspace_) {\n      return null;\n    }\n    return new Coordinate(e.pageX, e.pageY);\n  }\n\n  /**\n   * Whether this gesture is part of a multi-touch gesture.\n   *\n   * @returns Whether this gesture is part of a multi-touch gesture.\n   * @internal\n   */\n  isMultiTouch(): boolean {\n    return this.isMultiTouch_;\n  }\n\n  /**\n   * Cancel an in-progress gesture.  If a workspace or block drag is in\n   * progress, end the drag at the most recent location.\n   *\n   * @internal\n   */\n  cancel() {\n    // Disposing of a block cancels in-progress drags, but dragging to a delete\n    // area disposes of a block and leads to recursive disposal. Break that\n    // cycle.\n    if (this.isEnding_) {\n      return;\n    }\n    Touch.longStop();\n    if (this.bubbleDragger) {\n      this.bubbleDragger.endBubbleDrag(\n        this.mostRecentEvent,\n        this.currentDragDeltaXY,\n      );\n    } else if (this.blockDragger) {\n      this.blockDragger.endDrag(this.mostRecentEvent, this.currentDragDeltaXY);\n    } else if (this.workspaceDragger) {\n      this.workspaceDragger.endDrag(this.currentDragDeltaXY);\n    }\n    this.dispose();\n  }\n\n  /**\n   * Handle a real or faked right-click event by showing a context menu.\n   *\n   * @param e A pointerdown event.\n   * @internal\n   */\n  handleRightClick(e: PointerEvent) {\n    if (this.targetBlock) {\n      this.bringBlockToFront();\n      this.targetBlock.workspace.hideChaff(!!this.flyout);\n      this.targetBlock.showContextMenu(e);\n    } else if (this.startBubble) {\n      this.startBubble.showContextMenu(e);\n    } else if (this.startWorkspace_ && !this.flyout) {\n      this.startWorkspace_.hideChaff();\n      this.startWorkspace_.showContextMenu(e);\n    }\n\n    // TODO: Handle right-click on a bubble.\n    e.preventDefault();\n    e.stopPropagation();\n\n    this.dispose();\n  }\n\n  /**\n   * Handle a pointerdown event on a workspace.\n   *\n   * @param e A pointerdown event.\n   * @param ws The workspace the event hit.\n   * @internal\n   */\n  handleWsStart(e: PointerEvent, ws: WorkspaceSvg) {\n    if (this.gestureHasStarted) {\n      throw Error(\n        'Tried to call gesture.handleWsStart, ' +\n          'but the gesture had already been started.',\n      );\n    }\n    this.setStartWorkspace(ws);\n    this.mostRecentEvent = e;\n    this.doStart(e);\n  }\n\n  /**\n   * Fires a workspace click event.\n   *\n   * @param ws The workspace that a user clicks on.\n   */\n  private fireWorkspaceClick(ws: WorkspaceSvg) {\n    eventUtils.fire(\n      new (eventUtils.get(eventUtils.CLICK))(null, ws.id, 'workspace'),\n    );\n  }\n\n  /**\n   * Handle a pointerdown event on a flyout.\n   *\n   * @param e A pointerdown event.\n   * @param flyout The flyout the event hit.\n   * @internal\n   */\n  handleFlyoutStart(e: PointerEvent, flyout: IFlyout) {\n    if (this.gestureHasStarted) {\n      throw Error(\n        'Tried to call gesture.handleFlyoutStart, ' +\n          'but the gesture had already been started.',\n      );\n    }\n    this.setStartFlyout(flyout);\n    this.handleWsStart(e, flyout.getWorkspace());\n  }\n\n  /**\n   * Handle a pointerdown event on a block.\n   *\n   * @param e A pointerdown event.\n   * @param block The block the event hit.\n   * @internal\n   */\n  handleBlockStart(e: PointerEvent, block: BlockSvg) {\n    if (this.gestureHasStarted) {\n      throw Error(\n        'Tried to call gesture.handleBlockStart, ' +\n          'but the gesture had already been started.',\n      );\n    }\n    this.setStartBlock(block);\n    this.mostRecentEvent = e;\n  }\n\n  /**\n   * Handle a pointerdown event on a bubble.\n   *\n   * @param e A pointerdown event.\n   * @param bubble The bubble the event hit.\n   * @internal\n   */\n  handleBubbleStart(e: PointerEvent, bubble: IBubble) {\n    if (this.gestureHasStarted) {\n      throw Error(\n        'Tried to call gesture.handleBubbleStart, ' +\n          'but the gesture had already been started.',\n      );\n    }\n    this.setStartBubble(bubble);\n    this.mostRecentEvent = e;\n  }\n\n  /* Begin functions defining what actions to take to execute clicks on each\n   * type of target.  Any developer wanting to add behaviour on clicks should\n   * modify only this code. */\n\n  /** Execute a bubble click. */\n  private doBubbleClick() {\n    // TODO (#1673): Consistent handling of single clicks.\n    if (this.startBubble instanceof WorkspaceCommentSvg) {\n      this.startBubble.setFocus();\n      this.startBubble.select();\n    }\n  }\n\n  /** Execute a field click. */\n  private doFieldClick() {\n    if (!this.startField) {\n      throw new Error(\n        'Cannot do a field click because the start field is undefined',\n      );\n    }\n\n    // Only show the editor if the field's editor wasn't already open\n    // right before this gesture started.\n    const dropdownAlreadyOpen = this.currentDropdownOwner === this.startField;\n    if (!dropdownAlreadyOpen) {\n      this.startField.showEditor(this.mostRecentEvent);\n    }\n    this.bringBlockToFront();\n  }\n\n  /** Execute an icon click. */\n  private doIconClick() {\n    if (!this.startIcon) {\n      throw new Error(\n        'Cannot do an icon click because the start icon is undefined',\n      );\n    }\n    this.bringBlockToFront();\n    this.startIcon.onClick();\n  }\n\n  /** Execute a block click. */\n  private doBlockClick() {\n    // Block click in an autoclosing flyout.\n    if (this.flyout && this.flyout.autoClose) {\n      if (!this.targetBlock) {\n        throw new Error(\n          'Cannot do a block click because the target block is ' + 'undefined',\n        );\n      }\n      if (this.targetBlock.isEnabled()) {\n        if (!eventUtils.getGroup()) {\n          eventUtils.setGroup(true);\n        }\n        const newBlock = this.flyout.createBlock(this.targetBlock);\n        newBlock.scheduleSnapAndBump();\n      }\n    } else {\n      if (!this.startWorkspace_) {\n        throw new Error(\n          'Cannot do a block click because the start workspace ' +\n            'is undefined',\n        );\n      }\n      // Clicks events are on the start block, even if it was a shadow.\n      const event = new (eventUtils.get(eventUtils.CLICK))(\n        this.startBlock,\n        this.startWorkspace_.id,\n        'block',\n      );\n      eventUtils.fire(event);\n    }\n    this.bringBlockToFront();\n    eventUtils.setGroup(false);\n  }\n\n  /**\n   * Execute a workspace click. When in accessibility mode shift clicking will\n   * move the cursor.\n   *\n   * @param _e A pointerup event.\n   */\n  private doWorkspaceClick(_e: PointerEvent) {\n    const ws = this.creatorWorkspace;\n    if (common.getSelected()) {\n      common.getSelected()!.unselect();\n    }\n    this.fireWorkspaceClick(this.startWorkspace_ || ws);\n  }\n\n  /* End functions defining what actions to take to execute clicks on each type\n   * of target. */\n\n  // TODO (fenichel): Move bubbles to the front.\n\n  /**\n   * Move the dragged/clicked block to the front of the workspace so that it is\n   * not occluded by other blocks.\n   */\n  private bringBlockToFront() {\n    // Blocks in the flyout don't overlap, so skip the work.\n    if (this.targetBlock && !this.flyout) {\n      this.targetBlock.bringToFront();\n    }\n  }\n\n  /* Begin functions for populating a gesture at pointerdown. */\n\n  /**\n   * Record the field that a gesture started on.\n   *\n   * @param field The field the gesture started on.\n   * @internal\n   */\n  setStartField<T>(field: Field<T>) {\n    if (this.gestureHasStarted) {\n      throw Error(\n        'Tried to call gesture.setStartField, ' +\n          'but the gesture had already been started.',\n      );\n    }\n    if (!this.startField) {\n      this.startField = field as Field;\n    }\n  }\n\n  /**\n   * Record the icon that a gesture started on.\n   *\n   * @param icon The icon the gesture started on.\n   * @internal\n   */\n  setStartIcon(icon: IIcon) {\n    if (this.gestureHasStarted) {\n      throw Error(\n        'Tried to call gesture.setStartIcon, ' +\n          'but the gesture had already been started.',\n      );\n    }\n\n    if (!this.startIcon) this.startIcon = icon;\n  }\n\n  /**\n   * Record the bubble that a gesture started on\n   *\n   * @param bubble The bubble the gesture started on.\n   * @internal\n   */\n  setStartBubble(bubble: IBubble) {\n    if (!this.startBubble) {\n      this.startBubble = bubble;\n    }\n  }\n\n  /**\n   * Record the block that a gesture started on, and set the target block\n   * appropriately.\n   *\n   * @param block The block the gesture started on.\n   * @internal\n   */\n  setStartBlock(block: BlockSvg) {\n    // If the gesture already went through a bubble, don't set the start block.\n    if (!this.startBlock && !this.startBubble) {\n      this.startBlock = block;\n      if (block.isInFlyout && block !== block.getRootBlock()) {\n        this.setTargetBlock(block.getRootBlock());\n      } else {\n        this.setTargetBlock(block);\n      }\n    }\n  }\n\n  /**\n   * Record the block that a gesture targets, meaning the block that will be\n   * dragged if this turns into a drag.  If this block is a shadow, that will be\n   * its first non-shadow parent.\n   *\n   * @param block The block the gesture targets.\n   */\n  private setTargetBlock(block: BlockSvg) {\n    if (block.isShadow()) {\n      // Non-null assertion is fine b/c it is an invariant that shadows always\n      // have parents.\n      this.setTargetBlock(block.getParent()!);\n    } else {\n      this.targetBlock = block;\n    }\n  }\n\n  /**\n   * Record the workspace that a gesture started on.\n   *\n   * @param ws The workspace the gesture started on.\n   */\n  private setStartWorkspace(ws: WorkspaceSvg) {\n    if (!this.startWorkspace_) {\n      this.startWorkspace_ = ws;\n    }\n  }\n\n  /**\n   * Record the flyout that a gesture started on.\n   *\n   * @param flyout The flyout the gesture started on.\n   */\n  private setStartFlyout(flyout: IFlyout) {\n    if (!this.flyout) {\n      this.flyout = flyout;\n    }\n  }\n\n  /* End functions for populating a gesture at pointerdown. */\n\n  /* Begin helper functions defining types of clicks.  Any developer wanting\n   * to change the definition of a click should modify only this code. */\n\n  /**\n   * Whether this gesture is a click on a bubble.  This should only be called\n   * when ending a gesture (pointerup).\n   *\n   * @returns Whether this gesture was a click on a bubble.\n   */\n  private isBubbleClick(): boolean {\n    // A bubble click starts on a bubble and never escapes the drag radius.\n    const hasStartBubble = !!this.startBubble;\n    return hasStartBubble && !this.hasExceededDragRadius;\n  }\n\n  /**\n   * Whether this gesture is a click on a block.  This should only be called\n   * when ending a gesture (pointerup).\n   *\n   * @returns Whether this gesture was a click on a block.\n   */\n  private isBlockClick(): boolean {\n    // A block click starts on a block, never escapes the drag radius, and is\n    // not a field click.\n    const hasStartBlock = !!this.startBlock;\n    return (\n      hasStartBlock &&\n      !this.hasExceededDragRadius &&\n      !this.isFieldClick() &&\n      !this.isIconClick()\n    );\n  }\n\n  /**\n   * Whether this gesture is a click on a field that should be handled.  This should only be called\n   * when ending a gesture (pointerup).\n   *\n   * @returns Whether this gesture was a click on a field.\n   */\n  private isFieldClick(): boolean {\n    if (!this.startField) return false;\n    return (\n      this.startField.isClickable() &&\n      !this.hasExceededDragRadius &&\n      (!this.flyout ||\n        this.startField.isClickableInFlyout(this.flyout.autoClose))\n    );\n  }\n\n  /** @returns Whether this gesture is a click on an icon that should be handled. */\n  private isIconClick(): boolean {\n    if (!this.startIcon) return false;\n    const handleInFlyout =\n      !this.flyout ||\n      !this.startIcon.isClickableInFlyout ||\n      this.startIcon.isClickableInFlyout(this.flyout.autoClose);\n    return !this.hasExceededDragRadius && handleInFlyout;\n  }\n\n  /**\n   * Whether this gesture is a click on a workspace.  This should only be called\n   * when ending a gesture (pointerup).\n   *\n   * @returns Whether this gesture was a click on a workspace.\n   */\n  private isWorkspaceClick(): boolean {\n    const onlyTouchedWorkspace =\n      !this.startBlock && !this.startBubble && !this.startField;\n    return onlyTouchedWorkspace && !this.hasExceededDragRadius;\n  }\n\n  /* End helper functions defining types of clicks. */\n\n  /**\n   * Whether this gesture is a drag of either a workspace or block.\n   * This function is called externally to block actions that cannot be taken\n   * mid-drag (e.g. using the keyboard to delete the selected blocks).\n   *\n   * @returns True if this gesture is a drag of a workspace or block.\n   * @internal\n   */\n  isDragging(): boolean {\n    return (\n      !!this.workspaceDragger || !!this.blockDragger || !!this.bubbleDragger\n    );\n  }\n\n  /**\n   * Whether this gesture has already been started.  In theory every pointerdown\n   * has a corresponding pointerup, but in reality it is possible to lose a\n   * pointerup, leaving an in-process gesture hanging.\n   *\n   * @returns Whether this gesture was a click on a workspace.\n   * @internal\n   */\n  hasStarted(): boolean {\n    return this.gestureHasStarted;\n  }\n\n  /**\n   * Get a list of the insertion markers that currently exist.  Block drags have\n   * 0, 1, or 2 insertion markers.\n   *\n   * @returns A possibly empty list of insertion marker blocks.\n   * @internal\n   */\n  getInsertionMarkers(): BlockSvg[] {\n    if (this.blockDragger) {\n      return this.blockDragger.getInsertionMarkers();\n    }\n    return [];\n  }\n\n  /**\n   * Gets the current dragger if an item is being dragged. Null if nothing is\n   * being dragged.\n   *\n   * @returns The dragger that is currently in use or null if no drag is in\n   *     progress.\n   */\n  getCurrentDragger(): WorkspaceDragger | BubbleDragger | IBlockDragger | null {\n    return this.blockDragger ?? this.workspaceDragger ?? this.bubbleDragger;\n  }\n\n  /**\n   * Is a drag or other gesture currently in progress on any workspace?\n   *\n   * @returns True if gesture is occurring.\n   */\n  static inProgress(): boolean {\n    const workspaces = common.getAllWorkspaces();\n    for (let i = 0, workspace; (workspace = workspaces[i]); i++) {\n      // Not actually necessarily a WorkspaceSvg, but it doesn't matter b/c\n      // we're just checking if the property exists. Theoretically we would\n      // want to use instanceof, but that causes a circular dependency.\n      if ((workspace as WorkspaceSvg).currentGesture_) {\n        return true;\n      }\n    }\n    return false;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object for configuring and updating a workspace grid in\n * Blockly.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Grid\n\nimport * as dom from './utils/dom.js';\nimport {Svg} from './utils/svg.js';\nimport {GridOptions} from './options.js';\n\n/**\n * Class for a workspace's grid.\n */\nexport class Grid {\n  private spacing: number;\n  private length: number;\n  private scale: number = 1;\n  private readonly line1: SVGElement;\n  private readonly line2: SVGElement;\n  private snapToGrid: boolean;\n\n  /**\n   * @param pattern The grid's SVG pattern, created during injection.\n   * @param options A dictionary of normalized options for the grid.\n   *     See grid documentation:\n   *     https://developers.google.com/blockly/guides/configure/web/grid\n   */\n  constructor(\n    private pattern: SVGElement,\n    options: GridOptions,\n  ) {\n    /** The spacing of the grid lines (in px). */\n    this.spacing = options['spacing'] ?? 0;\n\n    /** How long the grid lines should be (in px). */\n    this.length = options['length'] ?? 1;\n\n    /** The horizontal grid line, if it exists. */\n    this.line1 = pattern.firstChild as SVGElement;\n\n    /** The vertical grid line, if it exists. */\n    this.line2 = this.line1 && (this.line1.nextSibling as SVGElement);\n\n    /** Whether blocks should snap to the grid. */\n    this.snapToGrid = options['snap'] ?? false;\n  }\n\n  /**\n   * Sets the spacing between the centers of the grid lines.\n   *\n   * This does not trigger snapping to the newly spaced grid. If you want to\n   * snap blocks to the grid programmatically that needs to be triggered\n   * on individual top-level blocks. The next time a block is dragged and\n   * dropped it will snap to the grid if snapping to the grid is enabled.\n   */\n  setSpacing(spacing: number) {\n    this.spacing = spacing;\n    this.update(this.scale);\n  }\n\n  /** Sets the length of the grid lines. */\n  setLength(length: number) {\n    this.length = length;\n    this.update(this.scale);\n  }\n\n  /**\n   * Sets whether blocks should snap to the grid or not.\n   *\n   * Setting this to true does not trigger snapping. If you want to snap blocks\n   * to the grid programmatically that needs to be triggered on individual\n   * top-level blocks. The next time a block is dragged and dropped it will\n   * snap to the grid.\n   */\n  setSnapToGrid(snap: boolean) {\n    this.snapToGrid = snap;\n  }\n\n  /**\n   * Whether blocks should snap to the grid, based on the initial configuration.\n   *\n   * @returns True if blocks should snap, false otherwise.\n   * @internal\n   */\n  shouldSnap(): boolean {\n    return this.snapToGrid;\n  }\n\n  /**\n   * Get the spacing of the grid points (in px).\n   *\n   * @returns The spacing of the grid points.\n   * @internal\n   */\n  getSpacing(): number {\n    return this.spacing;\n  }\n\n  /**\n   * Get the ID of the pattern element, which should be randomized to avoid\n   * conflicts with other Blockly instances on the page.\n   *\n   * @returns The pattern ID.\n   * @internal\n   */\n  getPatternId(): string {\n    return this.pattern.id;\n  }\n\n  /**\n   * Update the grid with a new scale.\n   *\n   * @param scale The new workspace scale.\n   * @internal\n   */\n  update(scale: number) {\n    this.scale = scale;\n    const safeSpacing = this.spacing * scale;\n\n    this.pattern.setAttribute('width', `${safeSpacing}`);\n    this.pattern.setAttribute('height', `${safeSpacing}`);\n\n    let half = Math.floor(this.spacing / 2) + 0.5;\n    let start = half - this.length / 2;\n    let end = half + this.length / 2;\n\n    half *= scale;\n    start *= scale;\n    end *= scale;\n\n    this.setLineAttributes(this.line1, scale, start, end, half, half);\n    this.setLineAttributes(this.line2, scale, half, half, start, end);\n  }\n\n  /**\n   * Set the attributes on one of the lines in the grid.  Use this to update the\n   * length and stroke width of the grid lines.\n   *\n   * @param line Which line to update.\n   * @param width The new stroke size (in px).\n   * @param x1 The new x start position of the line (in px).\n   * @param x2 The new x end position of the line (in px).\n   * @param y1 The new y start position of the line (in px).\n   * @param y2 The new y end position of the line (in px).\n   */\n  private setLineAttributes(\n    line: SVGElement,\n    width: number,\n    x1: number,\n    x2: number,\n    y1: number,\n    y2: number,\n  ) {\n    if (line) {\n      line.setAttribute('stroke-width', `${width}`);\n      line.setAttribute('x1', `${x1}`);\n      line.setAttribute('y1', `${y1}`);\n      line.setAttribute('x2', `${x2}`);\n      line.setAttribute('y2', `${y2}`);\n    }\n  }\n\n  /**\n   * Move the grid to a new x and y position, and make sure that change is\n   * visible.\n   *\n   * @param x The new x position of the grid (in px).\n   * @param y The new y position of the grid (in px).\n   * @internal\n   */\n  moveTo(x: number, y: number) {\n    this.pattern.setAttribute('x', `${x}`);\n    this.pattern.setAttribute('y', `${y}`);\n  }\n\n  /**\n   * Create the DOM for the grid described by options.\n   *\n   * @param rnd A random ID to append to the pattern's ID.\n   * @param gridOptions The object containing grid configuration.\n   * @param defs The root SVG element for this workspace's defs.\n   * @returns The SVG element for the grid pattern.\n   * @internal\n   */\n  static createDom(\n    rnd: string,\n    gridOptions: GridOptions,\n    defs: SVGElement,\n  ): SVGElement {\n    /*\n          <pattern id=\"blocklyGridPattern837493\" patternUnits=\"userSpaceOnUse\">\n            <rect stroke=\"#888\" />\n            <rect stroke=\"#888\" />\n          </pattern>\n        */\n    const gridPattern = dom.createSvgElement(\n      Svg.PATTERN,\n      {'id': 'blocklyGridPattern' + rnd, 'patternUnits': 'userSpaceOnUse'},\n      defs,\n    );\n    // x1, y1, x1, x2 properties will be set later in update.\n    if ((gridOptions['length'] ?? 1) > 0 && (gridOptions['spacing'] ?? 0) > 0) {\n      dom.createSvgElement(\n        Svg.LINE,\n        {'stroke': gridOptions['colour']},\n        gridPattern,\n      );\n      if (gridOptions['length'] ?? 1 > 1) {\n        dom.createSvgElement(\n          Svg.LINE,\n          {'stroke': gridOptions['colour']},\n          gridPattern,\n        );\n      }\n    } else {\n      // Edge 16 doesn't handle empty patterns\n      dom.createSvgElement(Svg.LINE, {}, gridPattern);\n    }\n    return gridPattern;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object in charge of managing markers and the cursor.\n *\n * @class\n */\n// Former goog.module ID: Blockly.MarkerManager\n\nimport type {Cursor} from './keyboard_nav/cursor.js';\nimport type {Marker} from './keyboard_nav/marker.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Class to manage the multiple markers and the cursor on a workspace.\n */\nexport class MarkerManager {\n  /** The name of the local marker. */\n  static readonly LOCAL_MARKER = 'local_marker_1';\n\n  /** The cursor. */\n  private cursor_: Cursor | null = null;\n\n  /** The cursor's SVG element. */\n  private cursorSvg_: SVGElement | null = null;\n\n  /** The map of markers for the workspace. */\n  private markers = new Map<string, Marker>();\n\n  /** The marker's SVG element. */\n  private markerSvg_: SVGElement | null = null;\n\n  /**\n   * @param workspace The workspace for the marker manager.\n   * @internal\n   */\n  constructor(private readonly workspace: WorkspaceSvg) {}\n\n  /**\n   * Register the marker by adding it to the map of markers.\n   *\n   * @param id A unique identifier for the marker.\n   * @param marker The marker to register.\n   */\n  registerMarker(id: string, marker: Marker) {\n    if (this.markers.has(id)) {\n      this.unregisterMarker(id);\n    }\n    marker.setDrawer(\n      this.workspace.getRenderer().makeMarkerDrawer(this.workspace, marker),\n    );\n    this.setMarkerSvg(marker.getDrawer().createDom());\n    this.markers.set(id, marker);\n  }\n\n  /**\n   * Unregister the marker by removing it from the map of markers.\n   *\n   * @param id The ID of the marker to unregister.\n   */\n  unregisterMarker(id: string) {\n    const marker = this.markers.get(id);\n    if (marker) {\n      marker.dispose();\n      this.markers.delete(id);\n    } else {\n      throw Error(\n        'Marker with ID ' +\n          id +\n          ' does not exist. ' +\n          'Can only unregister markers that exist.',\n      );\n    }\n  }\n\n  /**\n   * Get the cursor for the workspace.\n   *\n   * @returns The cursor for this workspace.\n   */\n  getCursor(): Cursor | null {\n    return this.cursor_;\n  }\n\n  /**\n   * Get a single marker that corresponds to the given ID.\n   *\n   * @param id A unique identifier for the marker.\n   * @returns The marker that corresponds to the given ID, or null if none\n   *     exists.\n   */\n  getMarker(id: string): Marker | null {\n    return this.markers.get(id) || null;\n  }\n\n  /**\n   * Sets the cursor and initializes the drawer for use with keyboard\n   * navigation.\n   *\n   * @param cursor The cursor used to move around this workspace.\n   */\n  setCursor(cursor: Cursor) {\n    if (this.cursor_ && this.cursor_.getDrawer()) {\n      this.cursor_.getDrawer().dispose();\n    }\n    this.cursor_ = cursor;\n    if (this.cursor_) {\n      const drawer = this.workspace\n        .getRenderer()\n        .makeMarkerDrawer(this.workspace, this.cursor_);\n      this.cursor_.setDrawer(drawer);\n      this.setCursorSvg(this.cursor_.getDrawer().createDom());\n    }\n  }\n\n  /**\n   * Add the cursor SVG to this workspace SVG group.\n   *\n   * @param cursorSvg The SVG root of the cursor to be added to the workspace\n   *     SVG group.\n   * @internal\n   */\n  setCursorSvg(cursorSvg: SVGElement | null) {\n    if (!cursorSvg) {\n      this.cursorSvg_ = null;\n      return;\n    }\n\n    this.workspace.getBlockCanvas()!.appendChild(cursorSvg);\n    this.cursorSvg_ = cursorSvg;\n  }\n\n  /**\n   * Add the marker SVG to this workspaces SVG group.\n   *\n   * @param markerSvg The SVG root of the marker to be added to the workspace\n   *     SVG group.\n   * @internal\n   */\n  setMarkerSvg(markerSvg: SVGElement | null) {\n    if (!markerSvg) {\n      this.markerSvg_ = null;\n      return;\n    }\n\n    if (this.workspace.getBlockCanvas()) {\n      if (this.cursorSvg_) {\n        this.workspace\n          .getBlockCanvas()!\n          .insertBefore(markerSvg, this.cursorSvg_);\n      } else {\n        this.workspace.getBlockCanvas()!.appendChild(markerSvg);\n      }\n    }\n  }\n\n  /**\n   * Redraw the attached cursor SVG if needed.\n   *\n   * @internal\n   */\n  updateMarkers() {\n    if (this.workspace.keyboardAccessibilityMode && this.cursorSvg_) {\n      this.workspace.getCursor()!.draw();\n    }\n  }\n\n  /**\n   * Dispose of the marker manager.\n   * Go through and delete all markers associated with this marker manager.\n   *\n   * @internal\n   */\n  dispose() {\n    const markerIds = Object.keys(this.markers);\n    for (let i = 0, markerId; (markerId = markerIds[i]); i++) {\n      this.unregisterMarker(markerId);\n    }\n    this.markers.clear();\n    if (this.cursor_) {\n      this.cursor_.dispose();\n      this.cursor_ = null;\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The class representing a theme.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Theme\n\nimport * as registry from './registry.js';\nimport * as object from './utils/object.js';\n\nexport interface ITheme {\n  blockStyles?: {[key: string]: Partial<BlockStyle>};\n  categoryStyles?: {[key: string]: CategoryStyle};\n  componentStyles?: ComponentStyle;\n  fontStyle?: FontStyle;\n  startHats?: boolean;\n  base?: string | Theme;\n  name: string;\n}\n\n/**\n * Class for a theme.\n */\nexport class Theme implements ITheme {\n  /** @internal */\n  blockStyles: {[key: string]: BlockStyle};\n  /** @internal */\n  categoryStyles: {[key: string]: CategoryStyle};\n  /** @internal */\n  componentStyles: ComponentStyle;\n  /** @internal */\n  fontStyle: FontStyle;\n\n  /**\n   * Whether or not to add a 'hat' on top of all blocks with no previous or\n   * output connections.\n   *\n   * @internal\n   */\n  startHats?: boolean = false;\n\n  /**\n   * @param name Theme name.\n   * @param opt_blockStyles A map from style names (strings) to objects with\n   *     style attributes for blocks.\n   * @param opt_categoryStyles A map from style names (strings) to objects with\n   *     style attributes for categories.\n   * @param opt_componentStyles A map of Blockly component names to style value.\n   */\n  constructor(\n    public name: string,\n    opt_blockStyles?: {[key: string]: Partial<BlockStyle>},\n    opt_categoryStyles?: {[key: string]: CategoryStyle},\n    opt_componentStyles?: ComponentStyle,\n  ) {\n    /** The block styles map. */\n    this.blockStyles = opt_blockStyles || Object.create(null);\n\n    /** The category styles map. */\n    this.categoryStyles = opt_categoryStyles || Object.create(null);\n\n    /** The UI components styles map. */\n    this.componentStyles =\n      opt_componentStyles || (Object.create(null) as ComponentStyle);\n\n    /** The font style. */\n    this.fontStyle = Object.create(null) as FontStyle;\n\n    // Register the theme by name.\n    registry.register(registry.Type.THEME, name, this, true);\n  }\n\n  /**\n   * Gets the class name that identifies this theme.\n   *\n   * @returns The CSS class name.\n   * @internal\n   */\n  getClassName(): string {\n    return this.name + '-theme';\n  }\n\n  /**\n   * Overrides or adds a style to the blockStyles map.\n   *\n   * @param blockStyleName The name of the block style.\n   * @param blockStyle The block style.\n   */\n  setBlockStyle(blockStyleName: string, blockStyle: BlockStyle) {\n    this.blockStyles[blockStyleName] = blockStyle;\n  }\n\n  /**\n   * Overrides or adds a style to the categoryStyles map.\n   *\n   * @param categoryStyleName The name of the category style.\n   * @param categoryStyle The category style.\n   */\n  setCategoryStyle(categoryStyleName: string, categoryStyle: CategoryStyle) {\n    this.categoryStyles[categoryStyleName] = categoryStyle;\n  }\n\n  /**\n   * Gets the style for a given Blockly UI component.  If the style value is a\n   * string, we attempt to find the value of any named references.\n   *\n   * @param componentName The name of the component.\n   * @returns The style value.\n   */\n  getComponentStyle(componentName: string): string | null {\n    const style = (this.componentStyles as AnyDuringMigration)[componentName];\n    if (!style) {\n      return null;\n    }\n    if (typeof style === 'string') {\n      const recursiveStyle = this.getComponentStyle(style);\n      if (recursiveStyle) {\n        return recursiveStyle;\n      }\n    }\n    return `${style}`;\n  }\n\n  /**\n   * Configure a specific Blockly UI component with a style value.\n   *\n   * @param componentName The name of the component.\n   * @param styleValue The style value.\n   */\n  setComponentStyle(componentName: string, styleValue: AnyDuringMigration) {\n    (this.componentStyles as AnyDuringMigration)[componentName] = styleValue;\n  }\n\n  /**\n   * Configure a theme's font style.\n   *\n   * @param fontStyle The font style.\n   */\n  setFontStyle(fontStyle: FontStyle) {\n    this.fontStyle = fontStyle;\n  }\n\n  /**\n   * Configure a theme's start hats.\n   *\n   * @param startHats True if the theme enables start hats, false otherwise.\n   */\n  setStartHats(startHats: boolean) {\n    this.startHats = startHats;\n  }\n\n  /**\n   * Define a new Blockly theme.\n   *\n   * @param name The name of the theme.\n   * @param themeObj An object containing theme properties.\n   * @returns A new Blockly theme.\n   */\n  static defineTheme(name: string, themeObj: ITheme): Theme {\n    name = name.toLowerCase();\n    const theme = new Theme(name);\n    let base = themeObj['base'];\n    if (base) {\n      if (typeof base === 'string') {\n        base = registry.getObject(registry.Type.THEME, base) ?? undefined;\n      }\n      if (base instanceof Theme) {\n        object.deepMerge(theme, base);\n        theme.name = name;\n      }\n    }\n\n    object.deepMerge(theme.blockStyles, themeObj['blockStyles']);\n    object.deepMerge(theme.categoryStyles, themeObj['categoryStyles']);\n    object.deepMerge(theme.componentStyles, themeObj['componentStyles']);\n    object.deepMerge(theme.fontStyle, themeObj['fontStyle']);\n    if (themeObj['startHats'] !== null) {\n      theme.startHats = themeObj['startHats'];\n    }\n\n    return theme;\n  }\n}\n\nexport namespace Theme {\n  export interface BlockStyle {\n    colourPrimary: string;\n    colourSecondary: string;\n    colourTertiary: string;\n    hat: string;\n  }\n\n  export interface CategoryStyle {\n    colour: string;\n  }\n\n  export interface ComponentStyle {\n    workspaceBackgroundColour?: string;\n    toolboxBackgroundColour?: string;\n    toolboxForegroundColour?: string;\n    flyoutBackgroundColour?: string;\n    flyoutForegroundColour?: string;\n    flyoutOpacity?: number;\n    scrollbarColour?: string;\n    scrollbarOpacity?: number;\n    insertionMarkerColour?: string;\n    insertionMarkerOpacity?: number;\n    markerColour?: string;\n    cursorColour?: string;\n    selectedGlowColour?: string;\n    selectedGlowOpacity?: number;\n    replacementGlowColour?: string;\n    replacementGlowOpacity?: number;\n  }\n\n  export interface FontStyle {\n    family?: string;\n    weight?: string;\n    size?: number;\n  }\n}\n\nexport type BlockStyle = Theme.BlockStyle;\nexport type CategoryStyle = Theme.CategoryStyle;\nexport type ComponentStyle = Theme.ComponentStyle;\nexport type FontStyle = Theme.FontStyle;\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.Themes.Classic\n\nimport {Theme} from '../theme.js';\n\nconst defaultBlockStyles = {\n  'colour_blocks': {'colourPrimary': '20'},\n  'list_blocks': {'colourPrimary': '260'},\n  'logic_blocks': {'colourPrimary': '210'},\n  'loop_blocks': {'colourPrimary': '120'},\n  'math_blocks': {'colourPrimary': '230'},\n  'procedure_blocks': {'colourPrimary': '290'},\n  'text_blocks': {'colourPrimary': '160'},\n  'variable_blocks': {'colourPrimary': '330'},\n  'variable_dynamic_blocks': {'colourPrimary': '310'},\n  'hat_blocks': {'colourPrimary': '330', 'hat': 'cap'},\n};\n\nconst categoryStyles = {\n  'colour_category': {'colour': '20'},\n  'list_category': {'colour': '260'},\n  'logic_category': {'colour': '210'},\n  'loop_category': {'colour': '120'},\n  'math_category': {'colour': '230'},\n  'procedure_category': {'colour': '290'},\n  'text_category': {'colour': '160'},\n  'variable_category': {'colour': '330'},\n  'variable_dynamic_category': {'colour': '310'},\n};\n\n/**\n * Classic theme.\n * Contains multi-coloured border to create shadow effect.\n */\nexport const Classic = new Theme('classic', defaultBlockStyles, categoryStyles);\n","/**\n * @license\n * Copyright 2016 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object that controls settings for the workspace.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Options\n\nimport type {BlocklyOptions} from './blockly_options.js';\nimport * as deprecation from './utils/deprecation.js';\nimport * as registry from './registry.js';\nimport {Theme} from './theme.js';\nimport {Classic} from './theme/classic.js';\nimport * as idGenerator from './utils/idgenerator.js';\nimport type {Metrics} from './utils/metrics.js';\nimport * as toolbox from './utils/toolbox.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Parse the user-specified options, using reasonable defaults where behaviour\n * is unspecified.\n */\nexport class Options {\n  RTL: boolean;\n  oneBasedIndex: boolean;\n  collapse: boolean;\n  comments: boolean;\n  disable: boolean;\n  readOnly: boolean;\n  maxBlocks: number;\n  maxInstances: {[key: string]: number} | null;\n  modalInputs: boolean;\n  pathToMedia: string;\n  hasCategories: boolean;\n  moveOptions: MoveOptions;\n  hasScrollbars: boolean;\n  hasTrashcan: boolean;\n  maxTrashcanContents: number;\n  hasSounds: boolean;\n  hasCss: boolean;\n  horizontalLayout: boolean;\n  languageTree: toolbox.ToolboxInfo | null;\n  gridOptions: GridOptions;\n  zoomOptions: ZoomOptions;\n  toolboxPosition: toolbox.Position;\n  theme: Theme;\n  renderer: string;\n  rendererOverrides: {[rendererConstant: string]: any} | null;\n\n  /**\n   * The SVG element for the grid pattern.\n   * Created during injection.\n   */\n  gridPattern: SVGElement | null = null;\n  parentWorkspace: WorkspaceSvg | null;\n  plugins: {[key: string]: (new (...p1: any[]) => any) | string};\n\n  /**\n   * If set, sets the translation of the workspace to match the scrollbars.\n   * A function that\n   *     sets the translation of the workspace to match the scrollbars. The\n   *     argument Contains an x and/or y property which is a float between 0\n   *     and 1 specifying the degree of scrolling.\n   */\n  setMetrics?: (p1: {x?: number; y?: number}) => void = undefined;\n\n  /**\n   * A function that returns a metrics\n   *     object that describes the current workspace.\n   */\n  getMetrics?: () => Metrics = undefined;\n\n  /**\n   * @param options Dictionary of options.\n   *     Specification:\n   * https://developers.google.com/blockly/guides/get-started/web#configuration\n   */\n  constructor(options: BlocklyOptions) {\n    let toolboxJsonDef = null;\n    let hasCategories = false;\n    let hasTrashcan = false;\n    let hasCollapse = false;\n    let hasComments = false;\n    let hasDisable = false;\n    let hasSounds = false;\n    const readOnly = !!options['readOnly'];\n    if (!readOnly) {\n      toolboxJsonDef = toolbox.convertToolboxDefToJson(\n        options['toolbox'] ?? null,\n      );\n      hasCategories = toolbox.hasCategories(toolboxJsonDef);\n      const rawHasTrashcan = options['trashcan'];\n      hasTrashcan =\n        rawHasTrashcan === undefined ? hasCategories : rawHasTrashcan;\n      const rawHasCollapse = options['collapse'];\n      hasCollapse =\n        rawHasCollapse === undefined ? hasCategories : rawHasCollapse;\n      const rawHasComments = options['comments'];\n      hasComments =\n        rawHasComments === undefined ? hasCategories : rawHasComments;\n      const rawHasDisable = options['disable'];\n      hasDisable = rawHasDisable === undefined ? hasCategories : rawHasDisable;\n      const rawHasSounds = options['sounds'];\n      hasSounds = rawHasSounds === undefined ? true : rawHasSounds;\n    }\n\n    let maxTrashcanContents = options['maxTrashcanContents'];\n    if (hasTrashcan) {\n      if (maxTrashcanContents === undefined) {\n        maxTrashcanContents = 32;\n      }\n    } else {\n      maxTrashcanContents = 0;\n    }\n    const rtl = !!options['rtl'];\n    let horizontalLayout = options['horizontalLayout'];\n    if (horizontalLayout === undefined) {\n      horizontalLayout = false;\n    }\n    const toolboxAtStart = options['toolboxPosition'] !== 'end';\n\n    let toolboxPosition: toolbox.Position;\n    if (horizontalLayout) {\n      toolboxPosition = toolboxAtStart\n        ? toolbox.Position.TOP\n        : toolbox.Position.BOTTOM;\n    } else {\n      toolboxPosition =\n        toolboxAtStart === rtl ? toolbox.Position.RIGHT : toolbox.Position.LEFT;\n    }\n\n    let hasCss = options['css'];\n    if (hasCss === undefined) {\n      hasCss = true;\n    }\n    let pathToMedia = 'https://blockly-demo.appspot.com/static/media/';\n    if (options['media']) {\n      pathToMedia = options['media'].endsWith('/')\n        ? options['media']\n        : options['media'] + '/';\n    } else if ('path' in options) {\n      // 'path' is a deprecated option which has been replaced by 'media'.\n      deprecation.warn('path', 'Nov 2014', 'Jul 2023', 'media');\n      pathToMedia = (options as any)['path'] + 'media/';\n    }\n    const rawOneBasedIndex = options['oneBasedIndex'];\n    const oneBasedIndex =\n      rawOneBasedIndex === undefined ? true : rawOneBasedIndex;\n    const renderer = options['renderer'] || 'geras';\n\n    const plugins = options['plugins'] || {};\n\n    let modalInputs = options['modalInputs'];\n    if (modalInputs === undefined) {\n      modalInputs = true;\n    }\n\n    this.RTL = rtl;\n    this.oneBasedIndex = oneBasedIndex;\n    this.collapse = hasCollapse;\n    this.comments = hasComments;\n    this.disable = hasDisable;\n    this.readOnly = readOnly;\n    this.maxBlocks = options['maxBlocks'] || Infinity;\n    this.maxInstances = options['maxInstances'] ?? null;\n    this.modalInputs = modalInputs;\n    this.pathToMedia = pathToMedia;\n    this.hasCategories = hasCategories;\n    this.moveOptions = Options.parseMoveOptions_(options, hasCategories);\n    /** @deprecated  January 2019 */\n    this.hasScrollbars = !!this.moveOptions.scrollbars;\n    this.hasTrashcan = hasTrashcan;\n    this.maxTrashcanContents = maxTrashcanContents;\n    this.hasSounds = hasSounds;\n    this.hasCss = hasCss;\n    this.horizontalLayout = horizontalLayout;\n    this.languageTree = toolboxJsonDef;\n    this.gridOptions = Options.parseGridOptions_(options);\n    this.zoomOptions = Options.parseZoomOptions_(options);\n    this.toolboxPosition = toolboxPosition;\n    this.theme = Options.parseThemeOptions_(options);\n    this.renderer = renderer;\n    this.rendererOverrides = options['rendererOverrides'] ?? null;\n\n    /**\n     * The parent of the current workspace, or null if there is no parent\n     * workspace.  We can assert that this is of type WorkspaceSvg as opposed to\n     * Workspace as this is only used in a rendered workspace.\n     */\n    this.parentWorkspace = options['parentWorkspace'] ?? null;\n\n    /** Map of plugin type to name of registered plugin or plugin class. */\n    this.plugins = plugins;\n  }\n\n  /**\n   * Parse the user-specified move options, using reasonable defaults where\n   *    behaviour is unspecified.\n   *\n   * @param options Dictionary of options.\n   * @param hasCategories Whether the workspace has categories or not.\n   * @returns Normalized move options.\n   */\n  private static parseMoveOptions_(\n    options: BlocklyOptions,\n    hasCategories: boolean,\n  ): MoveOptions {\n    const move = options['move'] || {};\n    const moveOptions = {} as MoveOptions;\n    if (\n      move['scrollbars'] === undefined &&\n      options['scrollbars'] === undefined\n    ) {\n      moveOptions.scrollbars = hasCategories;\n    } else if (typeof move['scrollbars'] === 'object') {\n      moveOptions.scrollbars = {\n        'horizontal': !!move['scrollbars']['horizontal'],\n        'vertical': !!move['scrollbars']['vertical'],\n      };\n      // Convert scrollbars object to boolean if they have the same value.\n      // This allows us to easily check for whether any scrollbars exist using\n      // !!moveOptions.scrollbars.\n      if (\n        moveOptions.scrollbars.horizontal &&\n        moveOptions.scrollbars.vertical\n      ) {\n        moveOptions.scrollbars = true;\n      } else if (\n        !moveOptions.scrollbars.horizontal &&\n        !moveOptions.scrollbars.vertical\n      ) {\n        moveOptions.scrollbars = false;\n      }\n    } else {\n      moveOptions.scrollbars = !!move['scrollbars'] || !!options['scrollbars'];\n    }\n\n    if (!moveOptions.scrollbars || move['wheel'] === undefined) {\n      // Defaults to true if single-direction scroll is enabled.\n      moveOptions.wheel = typeof moveOptions.scrollbars === 'object';\n    } else {\n      moveOptions.wheel = !!move['wheel'];\n    }\n    if (!moveOptions.scrollbars) {\n      moveOptions.drag = false;\n    } else if (move['drag'] === undefined) {\n      // Defaults to true if scrollbars is true.\n      moveOptions.drag = true;\n    } else {\n      moveOptions.drag = !!move['drag'];\n    }\n    return moveOptions;\n  }\n\n  /**\n   * Parse the user-specified zoom options, using reasonable defaults where\n   * behaviour is unspecified.  See zoom documentation:\n   *   https://developers.google.com/blockly/guides/configure/web/zoom\n   *\n   * @param options Dictionary of options.\n   * @returns Normalized zoom options.\n   */\n  private static parseZoomOptions_(options: BlocklyOptions): ZoomOptions {\n    const zoom = options['zoom'] || {};\n    const zoomOptions = {} as ZoomOptions;\n    if (zoom['controls'] === undefined) {\n      zoomOptions.controls = false;\n    } else {\n      zoomOptions.controls = !!zoom['controls'];\n    }\n    if (zoom['wheel'] === undefined) {\n      zoomOptions.wheel = false;\n    } else {\n      zoomOptions.wheel = !!zoom['wheel'];\n    }\n    if (zoom['startScale'] === undefined) {\n      zoomOptions.startScale = 1;\n    } else {\n      zoomOptions.startScale = Number(zoom['startScale']);\n    }\n    if (zoom['maxScale'] === undefined) {\n      zoomOptions.maxScale = 3;\n    } else {\n      zoomOptions.maxScale = Number(zoom['maxScale']);\n    }\n    if (zoom['minScale'] === undefined) {\n      zoomOptions.minScale = 0.3;\n    } else {\n      zoomOptions.minScale = Number(zoom['minScale']);\n    }\n    if (zoom['scaleSpeed'] === undefined) {\n      zoomOptions.scaleSpeed = 1.2;\n    } else {\n      zoomOptions.scaleSpeed = Number(zoom['scaleSpeed']);\n    }\n    if (zoom['pinch'] === undefined) {\n      zoomOptions.pinch = zoomOptions.wheel || zoomOptions.controls;\n    } else {\n      zoomOptions.pinch = !!zoom['pinch'];\n    }\n    return zoomOptions;\n  }\n\n  /**\n   * Parse the user-specified grid options, using reasonable defaults where\n   * behaviour is unspecified. See grid documentation:\n   *   https://developers.google.com/blockly/guides/configure/web/grid\n   *\n   * @param options Dictionary of options.\n   * @returns Normalized grid options.\n   */\n  private static parseGridOptions_(options: BlocklyOptions): GridOptions {\n    const grid = options['grid'] || {};\n    const gridOptions = {} as GridOptions;\n    gridOptions.spacing = Number(grid['spacing']) || 0;\n    gridOptions.colour = grid['colour'] || '#888';\n    gridOptions.length =\n      grid['length'] === undefined ? 1 : Number(grid['length']);\n    gridOptions.snap = gridOptions.spacing > 0 && !!grid['snap'];\n    return gridOptions;\n  }\n\n  /**\n   * Parse the user-specified theme options, using the classic theme as a\n   * default. https://developers.google.com/blockly/guides/configure/web/themes\n   *\n   * @param options Dictionary of options.\n   * @returns A Blockly Theme.\n   */\n  private static parseThemeOptions_(options: BlocklyOptions): Theme {\n    const theme = options['theme'] || Classic;\n    if (typeof theme === 'string') {\n      return registry.getObject(registry.Type.THEME, theme) as Theme;\n    } else if (theme instanceof Theme) {\n      return theme;\n    }\n    return Theme.defineTheme(\n      theme.name || 'builtin' + idGenerator.getNextUniqueId(),\n      theme,\n    );\n  }\n}\n\nexport namespace Options {\n  export interface GridOptions {\n    colour: string;\n    length: number;\n    snap: boolean;\n    spacing: number;\n  }\n\n  export interface MoveOptions {\n    drag: boolean;\n    scrollbars: boolean | ScrollbarOptions;\n    wheel: boolean;\n  }\n\n  export interface ScrollbarOptions {\n    horizontal: boolean;\n    vertical: boolean;\n  }\n\n  export interface ZoomOptions {\n    controls: boolean;\n    maxScale: number;\n    minScale: number;\n    pinch: boolean;\n    scaleSpeed: number;\n    startScale: number;\n    wheel: boolean;\n  }\n}\n\nexport type GridOptions = Options.GridOptions;\nexport type MoveOptions = Options.MoveOptions;\nexport type ScrollbarOptions = Options.ScrollbarOptions;\nexport type ZoomOptions = Options.ZoomOptions;\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for a block change event.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.BlockChange\n\nimport type {Block} from '../block.js';\nimport type {BlockSvg} from '../block_svg.js';\nimport {IconType} from '../icons/icon_types.js';\nimport {hasBubble} from '../interfaces/i_has_bubble.js';\nimport * as registry from '../registry.js';\nimport * as utilsXml from '../utils/xml.js';\nimport {Workspace} from '../workspace.js';\nimport * as Xml from '../xml.js';\n\nimport {BlockBase, BlockBaseJson} from './events_block_base.js';\nimport * as eventUtils from './utils.js';\n\n/**\n * Notifies listeners when some element of a block has changed (e.g.\n * field values, comments, etc).\n */\nexport class BlockChange extends BlockBase {\n  override type = eventUtils.BLOCK_CHANGE;\n  /**\n   * The element that changed; one of 'field', 'comment', 'collapsed',\n   * 'disabled', 'inline', or 'mutation'\n   */\n  element?: string;\n\n  /** The name of the field that changed, if this is a change to a field. */\n  name?: string;\n\n  /** The original value of the element. */\n  oldValue: unknown;\n\n  /** The new value of the element. */\n  newValue: unknown;\n\n  /**\n   * @param opt_block The changed block.  Undefined for a blank event.\n   * @param opt_element One of 'field', 'comment', 'disabled', etc.\n   * @param opt_name Name of input or field affected, or null.\n   * @param opt_oldValue Previous value of element.\n   * @param opt_newValue New value of element.\n   */\n  constructor(\n    opt_block?: Block,\n    opt_element?: string,\n    opt_name?: string | null,\n    opt_oldValue?: unknown,\n    opt_newValue?: unknown,\n  ) {\n    super(opt_block);\n\n    if (!opt_block) {\n      return; // Blank event to be populated by fromJson.\n    }\n    this.element = opt_element;\n    this.name = opt_name || undefined;\n    this.oldValue = opt_oldValue;\n    this.newValue = opt_newValue;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): BlockChangeJson {\n    const json = super.toJson() as BlockChangeJson;\n    if (!this.element) {\n      throw new Error(\n        'The changed element is undefined. Either pass an ' +\n          'element to the constructor, or call fromJson',\n      );\n    }\n    json['element'] = this.element;\n    json['name'] = this.name;\n    json['oldValue'] = this.oldValue;\n    json['newValue'] = this.newValue;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of BlockChange, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: BlockChangeJson,\n    workspace: Workspace,\n    event?: any,\n  ): BlockChange {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new BlockChange(),\n    ) as BlockChange;\n    newEvent.element = json['element'];\n    newEvent.name = json['name'];\n    newEvent.oldValue = json['oldValue'];\n    newEvent.newValue = json['newValue'];\n    return newEvent;\n  }\n\n  /**\n   * Does this event record any change of state?\n   *\n   * @returns False if something changed.\n   */\n  override isNull(): boolean {\n    return this.oldValue === this.newValue;\n  }\n\n  /**\n   * Run a change event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    if (!this.blockId) {\n      throw new Error(\n        'The block ID is undefined. Either pass a block to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    const block = workspace.getBlockById(this.blockId);\n    if (!block) {\n      throw new Error(\n        'The associated block is undefined. Either pass a ' +\n          'block to the constructor, or call fromJson',\n      );\n    }\n    // Assume the block is rendered so that then we can check.\n    const icon = block.getIcon(IconType.MUTATOR);\n    if (icon && hasBubble(icon) && icon.bubbleIsVisible()) {\n      // Close the mutator (if open) since we don't want to update it.\n      icon.setBubbleVisible(false);\n    }\n    const value = forward ? this.newValue : this.oldValue;\n    switch (this.element) {\n      case 'field': {\n        const field = block.getField(this.name!);\n        if (field) {\n          field.setValue(value);\n        } else {\n          console.warn(\"Can't set non-existent field: \" + this.name);\n        }\n        break;\n      }\n      case 'comment':\n        block.setCommentText((value as string) || null);\n        break;\n      case 'collapsed':\n        block.setCollapsed(!!value);\n        break;\n      case 'disabled':\n        block.setEnabled(!value);\n        break;\n      case 'inline':\n        block.setInputsInline(!!value);\n        break;\n      case 'mutation': {\n        const oldState = BlockChange.getExtraBlockState_(block as BlockSvg);\n        if (block.loadExtraState) {\n          block.loadExtraState(JSON.parse((value as string) || '{}'));\n        } else if (block.domToMutation) {\n          block.domToMutation(\n            utilsXml.textToDom((value as string) || '<mutation/>'),\n          );\n        }\n        eventUtils.fire(\n          new BlockChange(block, 'mutation', null, oldState, value),\n        );\n        break;\n      }\n      default:\n        console.warn('Unknown change type: ' + this.element);\n    }\n  }\n\n  // TODO (#5397): Encapsulate this in the BlocklyMutationChange event when\n  //    refactoring change events.\n  /**\n   * Returns the extra state of the given block (either as XML or a JSO,\n   * depending on the block's definition).\n   *\n   * @param block The block to get the extra state of.\n   * @returns A stringified version of the extra state of the given block.\n   * @internal\n   */\n  static getExtraBlockState_(block: BlockSvg): string {\n    if (block.saveExtraState) {\n      const state = block.saveExtraState(true);\n      return state ? JSON.stringify(state) : '';\n    } else if (block.mutationToDom) {\n      const state = block.mutationToDom();\n      return state ? Xml.domToText(state) : '';\n    }\n    return '';\n  }\n}\n\nexport interface BlockChangeJson extends BlockBaseJson {\n  element: string;\n  name?: string;\n  newValue: unknown;\n  oldValue: unknown;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.CHANGE, BlockChange);\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Field.  Used for editable titles, variables, etc.\n * This is an abstract class that defines the UI on the block.  Actual\n * instances would be FieldTextInput, FieldDropdown, etc.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Field\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_change.js';\n\nimport type {Block} from './block.js';\nimport type {BlockSvg} from './block_svg.js';\nimport * as browserEvents from './browser_events.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport * as eventUtils from './events/utils.js';\nimport type {Input} from './inputs/input.js';\nimport type {IASTNodeLocationSvg} from './interfaces/i_ast_node_location_svg.js';\nimport type {IASTNodeLocationWithBlock} from './interfaces/i_ast_node_location_with_block.js';\nimport type {IKeyboardAccessible} from './interfaces/i_keyboard_accessible.js';\nimport type {IRegistrable} from './interfaces/i_registrable.js';\nimport {MarkerManager} from './marker_manager.js';\nimport type {ConstantProvider} from './renderers/common/constants.js';\nimport type {KeyboardShortcut} from './shortcut_registry.js';\nimport * as Tooltip from './tooltip.js';\nimport type {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport * as parsing from './utils/parsing.js';\nimport {Rect} from './utils/rect.js';\nimport {Size} from './utils/size.js';\nimport * as style from './utils/style.js';\nimport {Svg} from './utils/svg.js';\nimport * as userAgent from './utils/useragent.js';\nimport * as utilsXml from './utils/xml.js';\nimport * as WidgetDiv from './widgetdiv.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport {ISerializable} from './interfaces/i_serializable.js';\n\n/**\n * A function that is called to validate changes to the field's value before\n * they are set.\n *\n * @see {@link https://developers.google.com/blockly/guides/create-custom-blocks/fields/validators#return_values}\n * @param newValue The value to be validated.\n * @returns One of three instructions for setting the new value: `T`, `null`,\n * or `undefined`.\n *\n * - `T` to set this function's returned value instead of `newValue`.\n *\n * - `null` to invoke `doValueInvalid_` and not set a value.\n *\n * - `undefined` to set `newValue` as is.\n */\nexport type FieldValidator<T = any> = (newValue: T) => T | null | undefined;\n\n/**\n * Abstract class for an editable field.\n *\n * @typeParam T - The value stored on the field.\n */\nexport abstract class Field<T = any>\n  implements\n    IASTNodeLocationSvg,\n    IASTNodeLocationWithBlock,\n    IKeyboardAccessible,\n    IRegistrable,\n    ISerializable\n{\n  /**\n   * To overwrite the default value which is set in **Field**, directly update\n   * the prototype.\n   *\n   * Example:\n   * `FieldImage.prototype.DEFAULT_VALUE = null;`\n   */\n  DEFAULT_VALUE: T | null = null;\n\n  /** Non-breaking space. */\n  static readonly NBSP = '\\u00A0';\n\n  /**\n   * A value used to signal when a field's constructor should *not* set the\n   * field's value or run configure_, and should allow a subclass to do that\n   * instead.\n   */\n  static readonly SKIP_SETUP = Symbol('SKIP_SETUP');\n\n  /**\n   * Name of field.  Unique within each block.\n   * Static labels are usually unnamed.\n   */\n  name?: string = undefined;\n  protected value_: T | null;\n\n  /** Validation function called when user edits an editable field. */\n  protected validator_: FieldValidator<T> | null = null;\n\n  /**\n   * Used to cache the field's tooltip value if setTooltip is called when the\n   * field is not yet initialized. Is *not* guaranteed to be accurate.\n   */\n  private tooltip_: Tooltip.TipInfo | null = null;\n  protected size_: Size;\n\n  /**\n   * Holds the cursors svg element when the cursor is attached to the field.\n   * This is null if there is no cursor on the field.\n   */\n  private cursorSvg_: SVGElement | null = null;\n\n  /**\n   * Holds the markers svg element when the marker is attached to the field.\n   * This is null if there is no marker on the field.\n   */\n  private markerSvg_: SVGElement | null = null;\n\n  /** The rendered field's SVG group element. */\n  protected fieldGroup_: SVGGElement | null = null;\n\n  /** The rendered field's SVG border element. */\n  protected borderRect_: SVGRectElement | null = null;\n\n  /** The rendered field's SVG text element. */\n  protected textElement_: SVGTextElement | null = null;\n\n  /** The rendered field's text content element. */\n  protected textContent_: Text | null = null;\n\n  /** Mouse down event listener data. */\n  private mouseDownWrapper_: browserEvents.Data | null = null;\n\n  /** Constants associated with the source block's renderer. */\n  protected constants_: ConstantProvider | null = null;\n\n  /**\n   * Has this field been disposed of?\n   *\n   * @internal\n   */\n  disposed = false;\n\n  /** Maximum characters of text to display before adding an ellipsis. */\n  maxDisplayLength = 50;\n\n  /** Block this field is attached to.  Starts as null, then set in init. */\n  protected sourceBlock_: Block | null = null;\n\n  /** Does this block need to be re-rendered? */\n  protected isDirty_ = true;\n\n  /** Is the field visible, or hidden due to the block being collapsed? */\n  protected visible_ = true;\n\n  /**\n   * Can the field value be changed using the editor on an editable block?\n   */\n  protected enabled_ = true;\n\n  /** The element the click handler is bound to. */\n  protected clickTarget_: Element | null = null;\n\n  /**\n   * The prefix field.\n   *\n   * @internal\n   */\n  prefixField: string | null = null;\n\n  /**\n   * The suffix field.\n   *\n   * @internal\n   */\n  suffixField: string | null = null;\n\n  /**\n   * Editable fields usually show some sort of UI indicating they are\n   * editable. They will also be saved by the serializer.\n   */\n  EDITABLE = true;\n\n  /**\n   * Serializable fields are saved by the serializer, non-serializable fields\n   * are not. Editable fields should also be serializable. This is not the\n   * case by default so that SERIALIZABLE is backwards compatible.\n   */\n  SERIALIZABLE = false;\n\n  /** Mouse cursor style when over the hotspot that initiates the editor. */\n  CURSOR = '';\n\n  /**\n   * @param value The initial value of the field.\n   *     Also accepts Field.SKIP_SETUP if you wish to skip setup (only used by\n   * subclasses that want to handle configuration and setting the field value\n   * after their own constructors have run).\n   * @param validator  A function that is called to validate changes to the\n   *     field's value. Takes in a value & returns a validated value, or null to\n   *     abort the change.\n   * @param config A map of options used to configure the field.\n   *    Refer to the individual field's documentation for a list of properties\n   * this parameter supports.\n   */\n  constructor(\n    value: T | typeof Field.SKIP_SETUP,\n    validator?: FieldValidator<T> | null,\n    config?: FieldConfig,\n  ) {\n    /**\n     * A generic value possessed by the field.\n     * Should generally be non-null, only null when the field is created.\n     */\n    this.value_ =\n      'DEFAULT_VALUE' in new.target.prototype\n        ? new.target.prototype.DEFAULT_VALUE\n        : this.DEFAULT_VALUE;\n\n    /** The size of the area rendered by the field. */\n    this.size_ = new Size(0, 0);\n\n    if (value === Field.SKIP_SETUP) return;\n    if (config) {\n      this.configure_(config);\n    }\n    this.setValue(value);\n    if (validator) {\n      this.setValidator(validator);\n    }\n  }\n\n  /**\n   * Process the configuration map passed to the field.\n   *\n   * @param config A map of options used to configure the field. See the\n   *     individual field's documentation for a list of properties this\n   *     parameter supports.\n   */\n  protected configure_(config: FieldConfig) {\n    // TODO (#2884): Possibly add CSS class config option.\n    // TODO (#2885): Possibly add cursor config option.\n    if (config.tooltip) {\n      this.setTooltip(parsing.replaceMessageReferences(config.tooltip));\n    }\n  }\n\n  /**\n   * Attach this field to a block.\n   *\n   * @param block The block containing this field.\n   */\n  setSourceBlock(block: Block) {\n    if (this.sourceBlock_) {\n      throw Error('Field already bound to a block');\n    }\n    this.sourceBlock_ = block;\n  }\n\n  /**\n   * Get the renderer constant provider.\n   *\n   * @returns The renderer constant provider.\n   */\n  getConstants(): ConstantProvider | null {\n    if (\n      !this.constants_ &&\n      this.sourceBlock_ &&\n      !this.sourceBlock_.isDeadOrDying() &&\n      this.sourceBlock_.workspace.rendered\n    ) {\n      this.constants_ = (this.sourceBlock_.workspace as WorkspaceSvg)\n        .getRenderer()\n        .getConstants();\n    }\n    return this.constants_;\n  }\n\n  /**\n   * Get the block this field is attached to.\n   *\n   * @returns The block containing this field.\n   * @throws An error if the source block is not defined.\n   */\n  getSourceBlock(): Block | null {\n    return this.sourceBlock_;\n  }\n\n  /**\n   * Initialize everything to render this field. Override\n   * methods initModel and initView rather than this method.\n   *\n   * @sealed\n   * @internal\n   */\n  init() {\n    if (this.fieldGroup_) {\n      // Field has already been initialized once.\n      return;\n    }\n    this.fieldGroup_ = dom.createSvgElement(Svg.G, {});\n    if (!this.isVisible()) {\n      this.fieldGroup_.style.display = 'none';\n    }\n    const sourceBlockSvg = this.sourceBlock_ as BlockSvg;\n    sourceBlockSvg.getSvgRoot().appendChild(this.fieldGroup_);\n    this.initView();\n    this.updateEditable();\n    this.setTooltip(this.tooltip_);\n    this.bindEvents_();\n    this.initModel();\n  }\n\n  /**\n   * Create the block UI for this field.\n   */\n  protected initView() {\n    this.createBorderRect_();\n    this.createTextElement_();\n  }\n\n  /**\n   * Initializes the model of the field after it has been installed on a block.\n   * No-op by default.\n   */\n  initModel() {}\n\n  /**\n   * Defines whether this field should take up the full block or not.\n   *\n   * Be cautious when overriding this function. It may not work as you expect /\n   * intend because the behavior was kind of hacked in. If you are thinking\n   * about overriding this function, post on the forum with your intended\n   * behavior to see if there's another approach.\n   */\n  protected isFullBlockField(): boolean {\n    return !this.borderRect_;\n  }\n\n  /**\n   * Create a field border rect element. Not to be overridden by subclasses.\n   * Instead modify the result of the function inside initView, or create a\n   * separate function to call.\n   */\n  protected createBorderRect_() {\n    this.borderRect_ = dom.createSvgElement(\n      Svg.RECT,\n      {\n        'rx': this.getConstants()!.FIELD_BORDER_RECT_RADIUS,\n        'ry': this.getConstants()!.FIELD_BORDER_RECT_RADIUS,\n        'x': 0,\n        'y': 0,\n        'height': this.size_.height,\n        'width': this.size_.width,\n        'class': 'blocklyFieldRect',\n      },\n      this.fieldGroup_,\n    );\n  }\n\n  /**\n   * Create a field text element. Not to be overridden by subclasses. Instead\n   * modify the result of the function inside initView, or create a separate\n   * function to call.\n   */\n  protected createTextElement_() {\n    this.textElement_ = dom.createSvgElement(\n      Svg.TEXT,\n      {\n        'class': 'blocklyText',\n      },\n      this.fieldGroup_,\n    );\n    if (this.getConstants()!.FIELD_TEXT_BASELINE_CENTER) {\n      this.textElement_.setAttribute('dominant-baseline', 'central');\n    }\n    this.textContent_ = document.createTextNode('');\n    this.textElement_.appendChild(this.textContent_);\n  }\n\n  /**\n   * Bind events to the field. Can be overridden by subclasses if they need to\n   * do custom input handling.\n   */\n  protected bindEvents_() {\n    const clickTarget = this.getClickTarget_();\n    if (!clickTarget) throw new Error('A click target has not been set.');\n    Tooltip.bindMouseEvents(clickTarget);\n    this.mouseDownWrapper_ = browserEvents.conditionalBind(\n      clickTarget,\n      'pointerdown',\n      this,\n      this.onMouseDown_,\n    );\n  }\n\n  /**\n   * Sets the field's value based on the given XML element. Should only be\n   * called by Blockly.Xml.\n   *\n   * @param fieldElement The element containing info about the field's state.\n   * @internal\n   */\n  fromXml(fieldElement: Element) {\n    // Any because gremlins live here. No touchie!\n    this.setValue(fieldElement.textContent as any);\n  }\n\n  /**\n   * Serializes this field's value to XML. Should only be called by Blockly.Xml.\n   *\n   * @param fieldElement The element to populate with info about the field's\n   *     state.\n   * @returns The element containing info about the field's state.\n   * @internal\n   */\n  toXml(fieldElement: Element): Element {\n    // Any because gremlins live here. No touchie!\n    fieldElement.textContent = this.getValue() as any;\n    return fieldElement;\n  }\n\n  /**\n   * Saves this fields value as something which can be serialized to JSON.\n   * Should only be called by the serialization system.\n   *\n   * @param _doFullSerialization If true, this signals to the field that if it\n   *     normally just saves a reference to some state (eg variable fields) it\n   *     should instead serialize the full state of the thing being referenced.\n   *     See the\n   *     {@link https://developers.devsite.google.com/blockly/guides/create-custom-blocks/fields/customizing-fields/creating#full_serialization_and_backing_data | field serialization docs}\n   *     for more information.\n   * @returns JSON serializable state.\n   * @internal\n   */\n  saveState(_doFullSerialization?: boolean): AnyDuringMigration {\n    const legacyState = this.saveLegacyState(Field);\n    if (legacyState !== null) {\n      return legacyState;\n    }\n    return this.getValue();\n  }\n\n  /**\n   * Sets the field's state based on the given state value. Should only be\n   * called by the serialization system.\n   *\n   * @param state The state we want to apply to the field.\n   * @internal\n   */\n  loadState(state: AnyDuringMigration) {\n    if (this.loadLegacyState(Field, state)) {\n      return;\n    }\n    this.setValue(state);\n  }\n\n  /**\n   * Returns a stringified version of the XML state, if it should be used.\n   * Otherwise this returns null, to signal the field should use its own\n   * serialization.\n   *\n   * @param callingClass The class calling this method.\n   *     Used to see if `this` has overridden any relevant hooks.\n   * @returns The stringified version of the XML state, or null.\n   */\n  protected saveLegacyState(callingClass: FieldProto): string | null {\n    if (\n      callingClass.prototype.saveState === this.saveState &&\n      callingClass.prototype.toXml !== this.toXml\n    ) {\n      const elem = utilsXml.createElement('field');\n      elem.setAttribute('name', this.name || '');\n      const text = utilsXml.domToText(this.toXml(elem));\n      return text.replace(\n        ' xmlns=\"https://developers.google.com/blockly/xml\"',\n        '',\n      );\n    }\n    // Either they called this on purpose from their saveState, or they have\n    // no implementations of either hook. Just do our thing.\n    return null;\n  }\n\n  /**\n   * Loads the given state using either the old XML hooks, if they should be\n   * used. Returns true to indicate loading has been handled, false otherwise.\n   *\n   * @param callingClass The class calling this method.\n   *     Used to see if `this` has overridden any relevant hooks.\n   * @param state The state to apply to the field.\n   * @returns Whether the state was applied or not.\n   */\n  loadLegacyState(\n    callingClass: FieldProto,\n    state: AnyDuringMigration,\n  ): boolean {\n    if (\n      callingClass.prototype.loadState === this.loadState &&\n      callingClass.prototype.fromXml !== this.fromXml\n    ) {\n      this.fromXml(utilsXml.textToDom(state as string));\n      return true;\n    }\n    // Either they called this on purpose from their loadState, or they have\n    // no implementations of either hook. Just do our thing.\n    return false;\n  }\n\n  /**\n   * Dispose of all DOM objects and events belonging to this editable field.\n   *\n   * @internal\n   */\n  dispose() {\n    dropDownDiv.hideIfOwner(this);\n    WidgetDiv.hideIfOwner(this);\n\n    if (!this.getSourceBlock()?.isDeadOrDying()) {\n      dom.removeNode(this.fieldGroup_);\n    }\n\n    this.disposed = true;\n  }\n\n  /** Add or remove the UI indicating if this field is editable or not. */\n  updateEditable() {\n    const group = this.fieldGroup_;\n    const block = this.getSourceBlock();\n    if (!this.EDITABLE || !group || !block) {\n      return;\n    }\n    if (this.enabled_ && block.isEditable()) {\n      dom.addClass(group, 'blocklyEditableText');\n      dom.removeClass(group, 'blocklyNonEditableText');\n      group.style.cursor = this.CURSOR;\n    } else {\n      dom.addClass(group, 'blocklyNonEditableText');\n      dom.removeClass(group, 'blocklyEditableText');\n      group.style.cursor = '';\n    }\n  }\n\n  /**\n   * Set whether this field's value can be changed using the editor when the\n   *     source block is editable.\n   *\n   * @param enabled True if enabled.\n   */\n  setEnabled(enabled: boolean) {\n    this.enabled_ = enabled;\n    this.updateEditable();\n  }\n\n  /**\n   * Check whether this field's value can be changed using the editor when the\n   *     source block is editable.\n   *\n   * @returns Whether this field is enabled.\n   */\n  isEnabled(): boolean {\n    return this.enabled_;\n  }\n\n  /**\n   * Check whether this field defines the showEditor_ function.\n   *\n   * @returns Whether this field is clickable.\n   */\n  isClickable(): boolean {\n    return (\n      this.enabled_ &&\n      !!this.sourceBlock_ &&\n      this.sourceBlock_.isEditable() &&\n      this.showEditor_ !== Field.prototype.showEditor_\n    );\n  }\n\n  /**\n   * Check whether the field should be clickable while the block is in a flyout.\n   * The default is that fields are clickable in always-open flyouts such as the\n   * simple toolbox, but not in autoclosing flyouts such as the category toolbox.\n   * Subclasses may override this function to change this behavior. Note that\n   * `isClickable` must also return true for this to have any effect.\n   *\n   * @param autoClosingFlyout true if the containing flyout is an auto-closing one.\n   * @returns Whether the field should be clickable while the block is in a flyout.\n   */\n  isClickableInFlyout(autoClosingFlyout: boolean): boolean {\n    return !autoClosingFlyout;\n  }\n\n  /**\n   * Check whether this field is currently editable.  Some fields are never\n   * EDITABLE (e.g. text labels). Other fields may be EDITABLE but may exist on\n   * non-editable blocks or be currently disabled.\n   *\n   * @returns Whether this field is currently enabled, editable and on an\n   *     editable block.\n   */\n  isCurrentlyEditable(): boolean {\n    return (\n      this.enabled_ &&\n      this.EDITABLE &&\n      !!this.sourceBlock_ &&\n      this.sourceBlock_.isEditable()\n    );\n  }\n\n  /**\n   * Check whether this field should be serialized by the XML renderer.\n   * Handles the logic for backwards compatibility and incongruous states.\n   *\n   * @returns Whether this field should be serialized or not.\n   */\n  isSerializable(): boolean {\n    let isSerializable = false;\n    if (this.name) {\n      if (this.SERIALIZABLE) {\n        isSerializable = true;\n      } else if (this.EDITABLE) {\n        console.warn(\n          'Detected an editable field that was not serializable.' +\n            ' Please define SERIALIZABLE property as true on all editable custom' +\n            ' fields. Proceeding with serialization.',\n        );\n        isSerializable = true;\n      }\n    }\n    return isSerializable;\n  }\n\n  /**\n   * Gets whether this editable field is visible or not.\n   *\n   * @returns True if visible.\n   */\n  isVisible(): boolean {\n    return this.visible_;\n  }\n\n  /**\n   * Sets whether this editable field is visible or not. Should only be called\n   * by input.setVisible.\n   *\n   * @param visible True if visible.\n   * @internal\n   */\n  setVisible(visible: boolean) {\n    if (this.visible_ === visible) {\n      return;\n    }\n    this.visible_ = visible;\n    const root = this.fieldGroup_;\n    if (root) {\n      root.style.display = visible ? 'block' : 'none';\n    }\n  }\n\n  /**\n   * Sets a new validation function for editable fields, or clears a previously\n   * set validator.\n   *\n   * The validator function takes in the new field value, and returns\n   * validated value. The validated value could be the input value, a modified\n   * version of the input value, or null to abort the change.\n   *\n   * If the function does not return anything (or returns undefined) the new\n   * value is accepted as valid. This is to allow for fields using the\n   * validated function as a field-level change event notification.\n   *\n   * @param handler The validator function or null to clear a previous\n   *     validator.\n   */\n  setValidator(handler: FieldValidator<T>) {\n    this.validator_ = handler;\n  }\n\n  /**\n   * Gets the validation function for editable fields, or null if not set.\n   *\n   * @returns Validation function, or null.\n   */\n  getValidator(): FieldValidator<T> | null {\n    return this.validator_;\n  }\n\n  /**\n   * Gets the group element for this editable field.\n   * Used for measuring the size and for positioning.\n   *\n   * @returns The group element.\n   */\n  getSvgRoot(): SVGGElement | null {\n    return this.fieldGroup_;\n  }\n\n  /**\n   * Gets the border rectangle element.\n   *\n   * @returns The border rectangle element.\n   * @throws An error if the border rectangle element is not defined.\n   */\n  protected getBorderRect(): SVGRectElement {\n    if (!this.borderRect_) {\n      throw new Error(`The border rectangle is ${this.borderRect_}.`);\n    }\n    return this.borderRect_;\n  }\n\n  /**\n   * Gets the text element.\n   *\n   * @returns The text element.\n   * @throws An error if the text element is not defined.\n   */\n  protected getTextElement(): SVGTextElement {\n    if (!this.textElement_) {\n      throw new Error(`The text element is ${this.textElement_}.`);\n    }\n    return this.textElement_;\n  }\n\n  /**\n   * Gets the text content.\n   *\n   * @returns The text content.\n   * @throws An error if the text content is not defined.\n   */\n  protected getTextContent(): Text {\n    if (!this.textContent_) {\n      throw new Error(`The text content is ${this.textContent_}.`);\n    }\n    return this.textContent_;\n  }\n\n  /**\n   * Updates the field to match the colour/style of the block.\n   *\n   * Non-abstract sub-classes may wish to implement this if the colour of the\n   * field depends on the colour of the block. It will automatically be called\n   * at relevant times, such as when the parent block or renderer changes.\n   *\n   * See {@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/customizing-fields/creating#matching_block_colours\n   * | the field documentation} for more information, or FieldDropdown for an\n   * example.\n   */\n  applyColour() {}\n\n  /**\n   * Used by getSize() to move/resize any DOM elements, and get the new size.\n   *\n   * All rendering that has an effect on the size/shape of the block should be\n   * done here, and should be triggered by getSize().\n   */\n  protected render_() {\n    if (this.textContent_) {\n      this.textContent_.nodeValue = this.getDisplayText_();\n    }\n    this.updateSize_();\n  }\n\n  /**\n   * Calls showEditor_ when the field is clicked if the field is clickable.\n   * Do not override.\n   *\n   * @param e Optional mouse event that triggered the field to open, or\n   *     undefined if triggered programmatically.\n   * @sealed\n   * @internal\n   */\n  showEditor(e?: Event) {\n    if (this.isClickable()) {\n      this.showEditor_(e);\n    }\n  }\n\n  /**\n   * A developer hook to create an editor for the field. This is no-op by\n   * default, and must be overriden to create an editor.\n   *\n   * @param _e Optional mouse event that triggered the field to open, or\n   *     undefined if triggered programmatically.\n   */\n  protected showEditor_(_e?: Event): void {}\n  // NOP\n\n  /**\n   * A developer hook to reposition the WidgetDiv during a window resize. You\n   * need to define this hook if your field has a WidgetDiv that needs to\n   * reposition itself when the window is resized. For example, text input\n   * fields define this hook so that the input WidgetDiv can reposition itself\n   * on a window resize event. This is especially important when modal inputs\n   * have been disabled, as Android devices will fire a window resize event when\n   * the soft keyboard opens.\n   *\n   * If you want the WidgetDiv to hide itself instead of repositioning, return\n   * false. This is the default behavior.\n   *\n   * DropdownDivs already handle their own positioning logic, so you do not need\n   * to override this function if your field only has a DropdownDiv.\n   *\n   * @returns True if the field should be repositioned,\n   *    false if the WidgetDiv should hide itself instead.\n   */\n  repositionForWindowResize(): boolean {\n    return false;\n  }\n\n  /**\n   * Updates the size of the field based on the text.\n   *\n   * @param margin margin to use when positioning the text element.\n   */\n  protected updateSize_(margin?: number) {\n    const constants = this.getConstants();\n    const xOffset =\n      margin !== undefined\n        ? margin\n        : !this.isFullBlockField()\n          ? this.getConstants()!.FIELD_BORDER_RECT_X_PADDING\n          : 0;\n    let totalWidth = xOffset * 2;\n    let totalHeight = constants!.FIELD_TEXT_HEIGHT;\n\n    let contentWidth = 0;\n    if (this.textElement_) {\n      contentWidth = dom.getFastTextWidth(\n        this.textElement_,\n        constants!.FIELD_TEXT_FONTSIZE,\n        constants!.FIELD_TEXT_FONTWEIGHT,\n        constants!.FIELD_TEXT_FONTFAMILY,\n      );\n      totalWidth += contentWidth;\n    }\n    if (!this.isFullBlockField()) {\n      totalHeight = Math.max(totalHeight, constants!.FIELD_BORDER_RECT_HEIGHT);\n    }\n\n    this.size_.height = totalHeight;\n    this.size_.width = totalWidth;\n\n    this.positionTextElement_(xOffset, contentWidth);\n    this.positionBorderRect_();\n  }\n\n  /**\n   * Position a field's text element after a size change.  This handles both LTR\n   * and RTL positioning.\n   *\n   * @param xOffset x offset to use when positioning the text element.\n   * @param contentWidth The content width.\n   */\n  protected positionTextElement_(xOffset: number, contentWidth: number) {\n    if (!this.textElement_) {\n      return;\n    }\n    const constants = this.getConstants();\n    const halfHeight = this.size_.height / 2;\n\n    this.textElement_.setAttribute(\n      'x',\n      String(\n        this.getSourceBlock()?.RTL\n          ? this.size_.width - contentWidth - xOffset\n          : xOffset,\n      ),\n    );\n    this.textElement_.setAttribute(\n      'y',\n      String(\n        constants!.FIELD_TEXT_BASELINE_CENTER\n          ? halfHeight\n          : halfHeight -\n              constants!.FIELD_TEXT_HEIGHT / 2 +\n              constants!.FIELD_TEXT_BASELINE,\n      ),\n    );\n  }\n\n  /** Position a field's border rect after a size change. */\n  protected positionBorderRect_() {\n    if (!this.borderRect_) {\n      return;\n    }\n    this.borderRect_.setAttribute('width', String(this.size_.width));\n    this.borderRect_.setAttribute('height', String(this.size_.height));\n    this.borderRect_.setAttribute(\n      'rx',\n      String(this.getConstants()!.FIELD_BORDER_RECT_RADIUS),\n    );\n    this.borderRect_.setAttribute(\n      'ry',\n      String(this.getConstants()!.FIELD_BORDER_RECT_RADIUS),\n    );\n  }\n\n  /**\n   * Returns the height and width of the field.\n   *\n   * This should *in general* be the only place render_ gets called from.\n   *\n   * @returns Height and width.\n   */\n  getSize(): Size {\n    if (!this.isVisible()) {\n      return new Size(0, 0);\n    }\n\n    if (this.isDirty_) {\n      this.render_();\n      this.isDirty_ = false;\n    } else if (this.visible_ && this.size_.width === 0) {\n      // If the field is not visible the width will be 0 as well, one of the\n      // problems with the old system.\n      this.render_();\n      // Don't issue a warning if the field is actually zero width.\n      if (this.size_.width !== 0) {\n        console.warn(\n          'Deprecated use of setting size_.width to 0 to rerender a' +\n            ' field. Set field.isDirty_ to true instead.',\n        );\n      }\n    }\n    return this.size_;\n  }\n\n  /**\n   * Returns the bounding box of the rendered field, accounting for workspace\n   * scaling.\n   *\n   * @returns An object with top, bottom, left, and right in pixels relative to\n   *     the top left corner of the page (window coordinates).\n   * @internal\n   */\n  getScaledBBox(): Rect {\n    let scaledWidth;\n    let scaledHeight;\n    let xy;\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n\n    if (this.isFullBlockField()) {\n      // Browsers are inconsistent in what they return for a bounding box.\n      // - Webkit / Blink: fill-box / object bounding box\n      // - Gecko: stroke-box\n      const bBox = (this.sourceBlock_ as BlockSvg).getHeightWidth();\n      const scale = (block.workspace as WorkspaceSvg).scale;\n      xy = this.getAbsoluteXY_();\n      scaledWidth = (bBox.width + 1) * scale;\n      scaledHeight = (bBox.height + 1) * scale;\n\n      if (userAgent.GECKO) {\n        xy.x += 1.5 * scale;\n        xy.y += 1.5 * scale;\n      } else {\n        xy.x -= 0.5 * scale;\n        xy.y -= 0.5 * scale;\n      }\n    } else {\n      const bBox = this.borderRect_!.getBoundingClientRect();\n      xy = style.getPageOffset(this.borderRect_!);\n      scaledWidth = bBox.width;\n      scaledHeight = bBox.height;\n    }\n    return new Rect(xy.y, xy.y + scaledHeight, xy.x, xy.x + scaledWidth);\n  }\n\n  /**\n   * Notifies the field that it has changed locations.\n   *\n   * @param _ The location of this field's block's top-start corner\n   *     in workspace coordinates.\n   */\n  onLocationChange(_: Coordinate) {}\n\n  /**\n   * Get the text from this field to display on the block. May differ from\n   * `getText` due to ellipsis, and other formatting.\n   *\n   * @returns Text to display.\n   */\n  protected getDisplayText_(): string {\n    let text = this.getText();\n    if (!text) {\n      // Prevent the field from disappearing if empty.\n      return Field.NBSP;\n    }\n    if (text.length > this.maxDisplayLength) {\n      // Truncate displayed string and add an ellipsis ('...').\n      text = text.substring(0, this.maxDisplayLength - 2) + '…';\n    }\n    // Replace whitespace with non-breaking spaces so the text doesn't collapse.\n    text = text.replace(/\\s/g, Field.NBSP);\n    if (this.sourceBlock_ && this.sourceBlock_.RTL) {\n      // The SVG is LTR, force text to be RTL by adding an RLM.\n      text += '\\u200F';\n    }\n    return text;\n  }\n\n  /**\n   * Get the text from this field.\n   * Override getText_ to provide a different behavior than simply casting the\n   * value to a string.\n   *\n   * @returns Current text.\n   * @sealed\n   */\n  getText(): string {\n    // this.getText_ was intended so that devs don't have to remember to call\n    // super when overriding how the text of the field is generated. (#2910)\n    const text = this.getText_();\n    if (text !== null) {\n      return String(text);\n    }\n    return String(this.getValue());\n  }\n\n  /**\n   * A developer hook to override the returned text of this field.\n   * Override if the text representation of the value of this field\n   * is not just a string cast of its value.\n   * Return null to resort to a string cast.\n   *\n   * @returns Current text or null.\n   */\n  protected getText_(): string | null {\n    return null;\n  }\n\n  /**\n   * Force a rerender of the block that this field is installed on, which will\n   * rerender this field and adjust for any sizing changes.\n   * Other fields on the same block will not rerender, because their sizes have\n   * already been recorded.\n   *\n   * @internal\n   */\n  markDirty() {\n    this.isDirty_ = true;\n    this.constants_ = null;\n  }\n\n  /**\n   * Force a rerender of the block that this field is installed on, which will\n   * rerender this field and adjust for any sizing changes.\n   * Other fields on the same block will not rerender, because their sizes have\n   * already been recorded.\n   *\n   * @internal\n   */\n  forceRerender() {\n    this.isDirty_ = true;\n    if (this.sourceBlock_ && this.sourceBlock_.rendered) {\n      (this.sourceBlock_ as BlockSvg).queueRender();\n      (this.sourceBlock_ as BlockSvg).bumpNeighbours();\n    }\n  }\n\n  /**\n   * Used to change the value of the field. Handles validation and events.\n   * Subclasses should override doClassValidation_ and doValueUpdate_ rather\n   * than this method.\n   *\n   * @param newValue New value.\n   * @param fireChangeEvent Whether to fire a change event. Defaults to true.\n   *     Should usually be true unless the change will be reported some other\n   *     way, e.g. an intermediate field change event.\n   * @sealed\n   */\n  setValue(newValue: AnyDuringMigration, fireChangeEvent = true) {\n    const doLogging = false;\n    if (newValue === null) {\n      doLogging && console.log('null, return');\n      // Not a valid value to check.\n      return;\n    }\n\n    const classValidation = this.doClassValidation_(newValue);\n    const classValue = this.processValidation_(newValue, classValidation);\n    if (classValue instanceof Error) {\n      doLogging && console.log('invalid class validation, return');\n      return;\n    }\n\n    const localValidation = this.getValidator()?.call(this, classValue);\n    const localValue = this.processValidation_(classValue, localValidation);\n    if (localValue instanceof Error) {\n      doLogging && console.log('invalid local validation, return');\n      return;\n    }\n\n    const source = this.sourceBlock_;\n    if (source && source.disposed) {\n      doLogging && console.log('source disposed, return');\n      return;\n    }\n\n    const oldValue = this.getValue();\n    if (oldValue === localValue) {\n      doLogging && console.log('same, doValueUpdate_, return');\n      this.doValueUpdate_(localValue);\n      return;\n    }\n\n    this.doValueUpdate_(localValue);\n    if (fireChangeEvent && source && eventUtils.isEnabled()) {\n      eventUtils.fire(\n        new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n          source,\n          'field',\n          this.name || null,\n          oldValue,\n          localValue,\n        ),\n      );\n    }\n    if (this.isDirty_) {\n      this.forceRerender();\n    }\n    doLogging && console.log(this.value_);\n  }\n\n  /**\n   * Process the result of validation.\n   *\n   * @param newValue New value.\n   * @param validatedValue Validated value.\n   * @returns New value, or an Error object.\n   */\n  private processValidation_(\n    newValue: AnyDuringMigration,\n    validatedValue: T | null | undefined,\n  ): T | Error {\n    if (validatedValue === null) {\n      this.doValueInvalid_(newValue);\n      if (this.isDirty_) {\n        this.forceRerender();\n      }\n      return Error();\n    }\n    return validatedValue === undefined ? (newValue as T) : validatedValue;\n  }\n\n  /**\n   * Get the current value of the field.\n   *\n   * @returns Current value.\n   */\n  getValue(): T | null {\n    return this.value_;\n  }\n\n  /**\n   * Validate the changes to a field's value before they are set. See\n   * **FieldDropdown** for an example of subclass implementation.\n   *\n   * **NOTE:** Validation returns one option between `T`, `null`, and\n   * `undefined`. **Field**'s implementation will never return `undefined`, but\n   * it is valid for a subclass to return `undefined` if the new value is\n   * compatible with `T`.\n   *\n   * @see {@link https://developers.google.com/blockly/guides/create-custom-blocks/fields/validators#return_values}\n   * @param newValue - The value to be validated.\n   * @returns One of three instructions for setting the new value: `T`, `null`,\n   * or `undefined`.\n   *\n   * - `T` to set this function's returned value instead of `newValue`.\n   *\n   * - `null` to invoke `doValueInvalid_` and not set a value.\n   *\n   * - `undefined` to set `newValue` as is.\n   */\n  protected doClassValidation_(newValue: T): T | null | undefined;\n  protected doClassValidation_(newValue?: AnyDuringMigration): T | null;\n  protected doClassValidation_(\n    newValue?: T | AnyDuringMigration,\n  ): T | null | undefined {\n    if (newValue === null || newValue === undefined) {\n      return null;\n    }\n\n    return newValue as T;\n  }\n\n  /**\n   * Used to update the value of a field. Can be overridden by subclasses to do\n   * custom storage of values/updating of external things.\n   *\n   * @param newValue The value to be saved.\n   */\n  protected doValueUpdate_(newValue: T) {\n    this.value_ = newValue;\n    this.isDirty_ = true;\n  }\n\n  /**\n   * Used to notify the field an invalid value was input. Can be overridden by\n   * subclasses, see FieldTextInput.\n   * No-op by default.\n   *\n   * @param _invalidValue The input value that was determined to be invalid.\n   */\n  protected doValueInvalid_(_invalidValue: AnyDuringMigration) {}\n  // NOP\n\n  /**\n   * Handle a pointerdown event on a field.\n   *\n   * @param e Pointer down event.\n   */\n  protected onMouseDown_(e: PointerEvent) {\n    if (!this.sourceBlock_ || this.sourceBlock_.isDeadOrDying()) {\n      return;\n    }\n    const gesture = (this.sourceBlock_.workspace as WorkspaceSvg).getGesture(e);\n    if (gesture) {\n      gesture.setStartField(this);\n    }\n  }\n\n  /**\n   * Sets the tooltip for this field.\n   *\n   * @param newTip The text for the tooltip, a function that returns the text\n   *     for the tooltip, a parent object whose tooltip will be used, or null to\n   *     display the tooltip of the parent block. To not display a tooltip pass\n   *     the empty string.\n   */\n  setTooltip(newTip: Tooltip.TipInfo | null) {\n    if (!newTip && newTip !== '') {\n      // If null or undefined.\n      newTip = this.sourceBlock_;\n    }\n    const clickTarget = this.getClickTarget_();\n    if (clickTarget) {\n      (clickTarget as AnyDuringMigration).tooltip = newTip;\n    } else {\n      // Field has not been initialized yet.\n      this.tooltip_ = newTip;\n    }\n  }\n\n  /**\n   * Returns the tooltip text for this field.\n   *\n   * @returns The tooltip text for this field.\n   */\n  getTooltip(): string {\n    const clickTarget = this.getClickTarget_();\n    if (clickTarget) {\n      return Tooltip.getTooltipOfObject(clickTarget);\n    }\n    // Field has not been initialized yet. Return stashed this.tooltip_ value.\n    return Tooltip.getTooltipOfObject({tooltip: this.tooltip_});\n  }\n\n  /**\n   * The element to bind the click handler to. If not set explicitly, defaults\n   * to the SVG root of the field. When this element is\n   * clicked on an editable field, the editor will open.\n   *\n   * @returns Element to bind click handler to.\n   */\n  protected getClickTarget_(): Element | null {\n    return this.clickTarget_ || this.getSvgRoot();\n  }\n\n  /**\n   * Return the absolute coordinates of the top-left corner of this field.\n   * The origin (0,0) is the top-left corner of the page body.\n   *\n   * @returns Object with .x and .y properties.\n   */\n  protected getAbsoluteXY_(): Coordinate {\n    return style.getPageOffset(this.getClickTarget_() as SVGRectElement);\n  }\n\n  /**\n   * Whether this field references any Blockly variables.  If true it may need\n   * to be handled differently during serialization and deserialization.\n   * Subclasses may override this.\n   *\n   * @returns True if this field has any variable references.\n   * @internal\n   */\n  referencesVariables(): boolean {\n    return false;\n  }\n\n  /**\n   * Refresh the variable name referenced by this field if this field references\n   * variables.\n   *\n   * @internal\n   */\n  refreshVariableName() {}\n  // NOP\n\n  /**\n   * Search through the list of inputs and their fields in order to find the\n   * parent input of a field.\n   *\n   * @returns The input that the field belongs to.\n   * @internal\n   */\n  getParentInput(): Input {\n    let parentInput = null;\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    const inputs = block.inputList;\n\n    for (let idx = 0; idx < block.inputList.length; idx++) {\n      const input = inputs[idx];\n      const fieldRows = input.fieldRow;\n      for (let j = 0; j < fieldRows.length; j++) {\n        if (fieldRows[j] === this) {\n          parentInput = input;\n          break;\n        }\n      }\n    }\n    return parentInput!;\n  }\n\n  /**\n   * Returns whether or not we should flip the field in RTL.\n   *\n   * @returns True if we should flip in RTL.\n   */\n  getFlipRtl(): boolean {\n    return false;\n  }\n\n  /**\n   * Returns whether or not the field is tab navigable.\n   *\n   * @returns True if the field is tab navigable.\n   */\n  isTabNavigable(): boolean {\n    return false;\n  }\n\n  /**\n   * Handles the given keyboard shortcut.\n   *\n   * @param _shortcut The shortcut to be handled.\n   * @returns True if the shortcut has been handled, false otherwise.\n   */\n  onShortcut(_shortcut: KeyboardShortcut): boolean {\n    return false;\n  }\n\n  /**\n   * Add the cursor SVG to this fields SVG group.\n   *\n   * @param cursorSvg The SVG root of the cursor to be added to the field group.\n   * @internal\n   */\n  setCursorSvg(cursorSvg: SVGElement) {\n    if (!cursorSvg) {\n      this.cursorSvg_ = null;\n      return;\n    }\n\n    if (!this.fieldGroup_) {\n      throw new Error(`The field group is ${this.fieldGroup_}.`);\n    }\n    this.fieldGroup_.appendChild(cursorSvg);\n    this.cursorSvg_ = cursorSvg;\n  }\n\n  /**\n   * Add the marker SVG to this fields SVG group.\n   *\n   * @param markerSvg The SVG root of the marker to be added to the field group.\n   * @internal\n   */\n  setMarkerSvg(markerSvg: SVGElement) {\n    if (!markerSvg) {\n      this.markerSvg_ = null;\n      return;\n    }\n\n    if (!this.fieldGroup_) {\n      throw new Error(`The field group is ${this.fieldGroup_}.`);\n    }\n    this.fieldGroup_.appendChild(markerSvg);\n    this.markerSvg_ = markerSvg;\n  }\n\n  /**\n   * Redraw any attached marker or cursor svgs if needed.\n   *\n   * @internal\n   */\n  updateMarkers_() {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    const workspace = block.workspace as WorkspaceSvg;\n    if (workspace.keyboardAccessibilityMode && this.cursorSvg_) {\n      workspace.getCursor()!.draw();\n    }\n    if (workspace.keyboardAccessibilityMode && this.markerSvg_) {\n      // TODO(#4592): Update all markers on the field.\n      workspace.getMarker(MarkerManager.LOCAL_MARKER)!.draw();\n    }\n  }\n}\n\n/**\n * Extra configuration options for the base field.\n */\nexport interface FieldConfig {\n  tooltip?: string;\n}\n\n/**\n * For use by Field and descendants of Field. Constructors can change\n * in descendants, though they should contain all of Field's prototype methods.\n *\n * @internal\n */\nexport type FieldProto = Pick<typeof Field, 'prototype'>;\n\n/**\n * Represents an error where the field is trying to access its block or\n * information about its block before it has actually been attached to said\n * block.\n */\nexport class UnattachedFieldError extends Error {\n  /** @internal */\n  constructor() {\n    super(\n      'The field has not yet been attached to its input. ' +\n        'Call appendField to attach it.',\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Utility functions for handling variable and procedure names.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Names\n\nimport {Msg} from './msg.js';\n// import * as Procedures from './procedures.js';\nimport type {VariableMap} from './variable_map.js';\nimport * as Variables from './variables.js';\nimport type {Workspace} from './workspace.js';\n\n/**\n * Class for a database of entity names (variables, procedures, etc).\n */\nexport class Names {\n  static DEVELOPER_VARIABLE_TYPE: NameType;\n  private readonly variablePrefix: string;\n\n  /** A set of reserved words. */\n  private readonly reservedWords: Set<string>;\n\n  /**\n   * A map from type (e.g. name, procedure) to maps from names to generated\n   * names.\n   */\n  private readonly db = new Map<string, Map<string, string>>();\n\n  /** A set of used names to avoid collisions. */\n  private readonly dbReverse = new Set<string>();\n\n  /**\n   * The variable map from the workspace, containing Blockly variable models.\n   */\n  private variableMap: VariableMap | null = null;\n\n  /**\n   * @param reservedWordsList A comma-separated string of words that are illegal\n   *     for use as names in a language (e.g. 'new,if,this,...').\n   * @param opt_variablePrefix Some languages need a '$' or a namespace before\n   *     all variable names (but not procedure names).\n   */\n  constructor(reservedWordsList: string, opt_variablePrefix?: string) {\n    /** The prefix to attach to variable names in generated code. */\n    this.variablePrefix = opt_variablePrefix || '';\n\n    this.reservedWords = new Set<string>(\n      reservedWordsList ? reservedWordsList.split(',') : [],\n    );\n  }\n\n  /**\n   * Empty the database and start from scratch.  The reserved words are kept.\n   */\n  reset() {\n    this.db.clear();\n    this.dbReverse.clear();\n    this.variableMap = null;\n  }\n\n  /**\n   * Set the variable map that maps from variable name to variable object.\n   *\n   * @param map The map to track.\n   */\n  setVariableMap(map: VariableMap) {\n    this.variableMap = map;\n  }\n\n  /**\n   * Get the name for a user-defined variable, based on its ID.\n   * This should only be used for variables of NameType VARIABLE.\n   *\n   * @param id The ID to look up in the variable map.\n   * @returns The name of the referenced variable, or null if there was no\n   *     variable map or the variable was not found in the map.\n   */\n  private getNameForUserVariable(id: string): string | null {\n    if (!this.variableMap) {\n      console.warn(\n        'Deprecated call to Names.prototype.getName without ' +\n          'defining a variable map. To fix, add the following code in your ' +\n          \"generator's init() function:\\n\" +\n          'Blockly.YourGeneratorName.nameDB_.setVariableMap(' +\n          'workspace.getVariableMap());',\n      );\n      return null;\n    }\n    const variable = this.variableMap.getVariableById(id);\n    if (variable) {\n      return variable.name;\n    }\n    return null;\n  }\n\n  /**\n   * Generate names for user variables, but only ones that are being used.\n   *\n   * @param workspace Workspace to generate variables from.\n   */\n  populateVariables(workspace: Workspace) {\n    const variables = Variables.allUsedVarModels(workspace);\n    for (let i = 0; i < variables.length; i++) {\n      this.getName(variables[i].getId(), NameType.VARIABLE);\n    }\n  }\n\n  /**\n   * Generate names for procedures.\n   *\n   * @param workspace Workspace to generate procedures from.\n   */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  populateProcedures(workspace: Workspace) {\n    throw new Error(\n      'The implementation of populateProcedures should be ' +\n        'monkey-patched in by blockly.ts',\n    );\n  }\n\n  /**\n   * Convert a Blockly entity name to a legal exportable entity name.\n   *\n   * @param nameOrId The Blockly entity name (no constraints) or variable ID.\n   * @param type The type of the name in Blockly ('VARIABLE', 'PROCEDURE',\n   *     'DEVELOPER_VARIABLE', etc...).\n   * @returns An entity name that is legal in the exported language.\n   */\n  getName(nameOrId: string, type: NameType | string): string {\n    let name = nameOrId;\n    if (type === NameType.VARIABLE) {\n      const varName = this.getNameForUserVariable(nameOrId);\n      if (varName) {\n        // Successful ID lookup.\n        name = varName;\n      }\n    }\n    const normalizedName = name.toLowerCase();\n\n    const isVar =\n      type === NameType.VARIABLE || type === NameType.DEVELOPER_VARIABLE;\n\n    const prefix = isVar ? this.variablePrefix : '';\n    if (!this.db.has(type)) {\n      this.db.set(type, new Map<string, string>());\n    }\n    const typeDb = this.db.get(type);\n    if (typeDb!.has(normalizedName)) {\n      return prefix + typeDb!.get(normalizedName);\n    }\n    const safeName = this.getDistinctName(name, type);\n    typeDb!.set(normalizedName, safeName.substr(prefix.length));\n    return safeName;\n  }\n\n  /**\n   * Return a list of all known user-created names of a specified name type.\n   *\n   * @param type The type of entity in Blockly ('VARIABLE', 'PROCEDURE',\n   *     'DEVELOPER_VARIABLE', etc...).\n   * @returns A list of Blockly entity names (no constraints).\n   */\n  getUserNames(type: NameType | string): string[] {\n    const userNames = this.db.get(type)?.keys();\n    return userNames ? Array.from(userNames) : [];\n  }\n\n  /**\n   * Convert a Blockly entity name to a legal exportable entity name.\n   * Ensure that this is a new name not overlapping any previously defined name.\n   * Also check against list of reserved words for the current language and\n   * ensure name doesn't collide.\n   *\n   * @param name The Blockly entity name (no constraints).\n   * @param type The type of entity in Blockly ('VARIABLE', 'PROCEDURE',\n   *     'DEVELOPER_VARIABLE', etc...).\n   * @returns An entity name that is legal in the exported language.\n   */\n  getDistinctName(name: string, type: NameType | string): string {\n    let safeName = this.safeName(name);\n    let i: number | null = null;\n    while (\n      this.dbReverse.has(safeName + (i ?? '')) ||\n      this.reservedWords.has(safeName + (i ?? ''))\n    ) {\n      // Collision with existing name.  Create a unique name.\n      i = i ? i + 1 : 2;\n    }\n    safeName += i ?? '';\n    this.dbReverse.add(safeName);\n    const isVar =\n      type === NameType.VARIABLE || type === NameType.DEVELOPER_VARIABLE;\n    const prefix = isVar ? this.variablePrefix : '';\n    return prefix + safeName;\n  }\n\n  /**\n   * Given a proposed entity name, generate a name that conforms to the\n   * [_A-Za-z][_A-Za-z0-9]* format that most languages consider legal for\n   * variable and function names.\n   *\n   * @param name Potentially illegal entity name.\n   * @returns Safe entity name.\n   */\n  private safeName(name: string): string {\n    if (!name) {\n      name = Msg['UNNAMED_KEY'] || 'unnamed';\n    } else {\n      // Unfortunately names in non-latin characters will look like\n      // _E9_9F_B3_E4_B9_90 which is pretty meaningless.\n      // https://github.com/google/blockly/issues/1654\n      name = encodeURI(name.replace(/ /g, '_')).replace(/[^\\w]/g, '_');\n      // Most languages don't allow names with leading numbers.\n      if ('0123456789'.indexOf(name[0]) !== -1) {\n        name = 'my_' + name;\n      }\n    }\n    return name;\n  }\n\n  /**\n   * Do the given two entity names refer to the same entity?\n   * Blockly names are case-insensitive.\n   *\n   * @param name1 First name.\n   * @param name2 Second name.\n   * @returns True if names are the same.\n   */\n  static equals(name1: string, name2: string): boolean {\n    // name1.localeCompare(name2) is slower.\n    return name1.toLowerCase() === name2.toLowerCase();\n  }\n}\n\nexport namespace Names {\n  /**\n   * Enum for the type of a name. Different name types may have different rules\n   * about collisions.\n   * When JavaScript (or most other languages) is generated, variable 'foo' and\n   * procedure 'foo' would collide.  However, Blockly has no such problems since\n   * variable get 'foo' and procedure call 'foo' are unambiguous.\n   * Therefore, Blockly keeps a separate name type to disambiguate.\n   * getName('foo', 'VARIABLE') = 'foo'\n   * getName('foo', 'PROCEDURE') = 'foo2'\n   *\n   */\n  export enum NameType {\n    DEVELOPER_VARIABLE = 'DEVELOPER_VARIABLE',\n    VARIABLE = 'VARIABLE',\n    PROCEDURE = 'PROCEDURE',\n  }\n}\n\nexport type NameType = Names.NameType;\nexport const NameType = Names.NameType;\n\n/**\n * Constant to separate developer variable names from user-defined variable\n * names when running generators.\n * A developer variable will be declared as a global in the generated code, but\n * will never be shown to the user in the workspace or stored in the variable\n * map.\n */\nNames.DEVELOPER_VARIABLE_TYPE = NameType.DEVELOPER_VARIABLE;\n","/**\n * @license\n * Copyright 2022 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {IProcedureMap} from './interfaces/i_procedure_map.js';\nimport type {IProcedureModel} from './interfaces/i_procedure_model.js';\nimport {isObservable} from './interfaces/i_observable.js';\n\nexport class ObservableProcedureMap\n  extends Map<string, IProcedureModel>\n  implements IProcedureMap\n{\n  /** @internal */\n  constructor() {\n    super();\n  }\n\n  /**\n   * Adds the given procedure model to the procedure map.\n   */\n  override set(id: string, proc: IProcedureModel): this {\n    if (this.get(id) === proc) return this;\n    super.set(id, proc);\n    if (isObservable(proc)) proc.startPublishing();\n    return this;\n  }\n\n  /**\n   * Deletes the ProcedureModel with the given ID from the procedure map (if it\n   * exists).\n   */\n  override delete(id: string): boolean {\n    const proc = this.get(id);\n    const existed = super.delete(id);\n    if (!existed) return existed;\n    if (isObservable(proc)) proc.stopPublishing();\n    return existed;\n  }\n\n  /**\n   * Removes all ProcedureModels from the procedure map.\n   */\n  override clear() {\n    if (!this.size) return;\n    for (const id of this.keys()) {\n      this.delete(id);\n    }\n  }\n\n  /**\n   * Adds the given ProcedureModel to the map of procedure models, so that\n   * blocks can find it.\n   */\n  add(proc: IProcedureModel): this {\n    return this.set(proc.getId(), proc);\n  }\n\n  /**\n   * Returns all of the procedures stored in this map.\n   */\n  getProcedures(): IProcedureModel[] {\n    return [...this.values()];\n  }\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {Block} from '../block.js';\nimport type {BlockSvg} from '../block_svg.js';\nimport * as browserEvents from '../browser_events.js';\nimport {hasBubble} from '../interfaces/i_has_bubble.js';\nimport type {IIcon} from '../interfaces/i_icon.js';\nimport {Coordinate} from '../utils/coordinate.js';\nimport * as dom from '../utils/dom.js';\nimport {Size} from '../utils/size.js';\nimport {Svg} from '../utils/svg.js';\nimport type {IconType} from './icon_types.js';\nimport * as deprecation from '../utils/deprecation.js';\nimport * as tooltip from '../tooltip.js';\n\n/**\n * The abstract icon class. Icons are visual elements that live in the top-start\n * corner of the block. Usually they provide more \"meta\" information about a\n * block (such as warnings or comments) as opposed to fields, which provide\n * \"actual\" information, related to how a block functions.\n */\nexport abstract class Icon implements IIcon {\n  /**\n   * The position of this icon relative to its blocks top-start,\n   * in workspace units.\n   */\n  protected offsetInBlock: Coordinate = new Coordinate(0, 0);\n\n  /** The position of this icon in workspace coordinates. */\n  protected workspaceLocation: Coordinate = new Coordinate(0, 0);\n\n  /** The root svg element visually representing this icon. */\n  protected svgRoot: SVGGElement | null = null;\n\n  /** The tooltip for this icon. */\n  protected tooltip: tooltip.TipInfo;\n\n  constructor(protected sourceBlock: Block) {\n    this.tooltip = sourceBlock;\n  }\n\n  getType(): IconType<IIcon> {\n    throw new Error('Icons must implement getType');\n  }\n\n  initView(pointerdownListener: (e: PointerEvent) => void): void {\n    if (this.svgRoot) return; // The icon has already been initialized.\n\n    const svgBlock = this.sourceBlock as BlockSvg;\n    this.svgRoot = dom.createSvgElement(Svg.G, {'class': 'blocklyIconGroup'});\n    svgBlock.getSvgRoot().appendChild(this.svgRoot);\n    this.updateSvgRootOffset();\n    browserEvents.conditionalBind(\n      this.svgRoot,\n      'pointerdown',\n      this,\n      pointerdownListener,\n    );\n    (this.svgRoot as any).tooltip = this;\n    tooltip.bindMouseEvents(this.svgRoot);\n  }\n\n  dispose(): void {\n    tooltip.unbindMouseEvents(this.svgRoot);\n    dom.removeNode(this.svgRoot);\n  }\n\n  getWeight(): number {\n    return -1;\n  }\n\n  getSize(): Size {\n    return new Size(0, 0);\n  }\n\n  /**\n   * Sets the tooltip for this icon to the given value. Null to show the\n   * tooltip of the block.\n   */\n  setTooltip(tip: tooltip.TipInfo | null) {\n    this.tooltip = tip ?? this.sourceBlock;\n  }\n\n  /** Returns the tooltip for this icon. */\n  getTooltip(): tooltip.TipInfo {\n    return this.tooltip;\n  }\n\n  applyColour(): void {}\n\n  updateEditable(): void {}\n\n  updateCollapsed(): void {\n    if (!this.svgRoot) return;\n    if (this.sourceBlock.isCollapsed()) {\n      this.svgRoot.style.display = 'none';\n    } else {\n      this.svgRoot.style.display = 'block';\n    }\n    if (hasBubble(this)) {\n      this.setBubbleVisible(false);\n    }\n  }\n\n  hideForInsertionMarker(): void {\n    if (!this.svgRoot) return;\n    this.svgRoot.style.display = 'none';\n  }\n\n  isShownWhenCollapsed(): boolean {\n    return false;\n  }\n\n  setOffsetInBlock(offset: Coordinate): void {\n    this.offsetInBlock = offset;\n    this.updateSvgRootOffset();\n  }\n\n  private updateSvgRootOffset(): void {\n    this.svgRoot?.setAttribute(\n      'transform',\n      `translate(${this.offsetInBlock.x}, ${this.offsetInBlock.y})`,\n    );\n  }\n\n  onLocationChange(blockOrigin: Coordinate): void {\n    this.workspaceLocation = Coordinate.sum(blockOrigin, this.offsetInBlock);\n  }\n\n  onClick(): void {}\n\n  /**\n   * Check whether the icon should be clickable while the block is in a flyout.\n   * The default is that icons are clickable in all flyouts (auto-closing or not).\n   * Subclasses may override this function to change this behavior.\n   *\n   * @param autoClosingFlyout true if the containing flyout is an auto-closing one.\n   * @returns Whether the icon should be clickable while the block is in a flyout.\n   */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  isClickableInFlyout(autoClosingFlyout: boolean): boolean {\n    return true;\n  }\n\n  /**\n   * Sets the visibility of the icon's bubble if one exists.\n   *\n   * @deprecated Use `setBubbleVisible` instead. To be removed in v11.\n   */\n  setVisible(visibility: boolean): void {\n    deprecation.warn('setVisible', 'v10', 'v11', 'setBubbleVisible');\n    if (hasBubble(this)) this.setBubbleVisible(visibility);\n  }\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as browserEvents from '../browser_events.js';\nimport {IBubble} from '../interfaces/i_bubble.js';\nimport {ContainerRegion} from '../metrics_manager.js';\nimport {Scrollbar} from '../scrollbar.js';\nimport {Coordinate} from '../utils/coordinate.js';\nimport * as dom from '../utils/dom.js';\nimport * as math from '../utils/math.js';\nimport {Rect} from '../utils/rect.js';\nimport {Size} from '../utils/size.js';\nimport {Svg} from '../utils/svg.js';\nimport {WorkspaceSvg} from '../workspace_svg.js';\n\n/**\n * The abstract pop-up bubble class. This creates a UI that looks like a speech\n * bubble, where it has a \"tail\" that points to the block, and a \"head\" that\n * displays arbitrary svg elements.\n */\nexport abstract class Bubble implements IBubble {\n  /** The width of the border around the bubble. */\n  static readonly BORDER_WIDTH = 6;\n\n  /** Double the width of the border around the bubble. */\n  static readonly DOUBLE_BORDER = this.BORDER_WIDTH * 2;\n\n  /** The minimum size the bubble can have. */\n  static readonly MIN_SIZE = this.DOUBLE_BORDER;\n\n  /**\n   * The thickness of the base of the tail in relation to the size of the\n   * bubble. Higher numbers result in thinner tails.\n   */\n  static readonly TAIL_THICKNESS = 1;\n\n  /** The number of degrees that the tail bends counter-clockwise. */\n  static readonly TAIL_ANGLE = 20;\n\n  /**\n   * The sharpness of the tail's bend. Higher numbers result in smoother\n   * tails.\n   */\n  static readonly TAIL_BEND = 4;\n\n  /** Distance between arrow point and anchor point. */\n  static readonly ANCHOR_RADIUS = 8;\n\n  /** The SVG group containing all parts of the bubble. */\n  protected svgRoot: SVGGElement;\n\n  /** The SVG path for the arrow from the anchor to the bubble. */\n  private tail: SVGPathElement;\n\n  /** The SVG background rect for the main body of the bubble. */\n  private background: SVGRectElement;\n\n  /** The SVG group containing the contents of the bubble. */\n  protected contentContainer: SVGGElement;\n\n  /**\n   * The size of the bubble (including background and contents but not tail).\n   */\n  private size = new Size(0, 0);\n\n  /** The colour of the background of the bubble. */\n  private colour = '#ffffff';\n\n  /** True if the bubble has been disposed, false otherwise. */\n  public disposed = false;\n\n  /** The position of the top of the bubble relative to its anchor. */\n  private relativeTop = 0;\n\n  /** The position of the left of the bubble realtive to its anchor. */\n  private relativeLeft = 0;\n\n  /**\n   * @param workspace The workspace this bubble belongs to.\n   * @param anchor The anchor location of the thing this bubble is attached to.\n   *     The tail of the bubble will point to this location.\n   * @param ownerRect An optional rect we don't want the bubble to overlap with\n   *     when automatically positioning.\n   */\n  constructor(\n    protected readonly workspace: WorkspaceSvg,\n    protected anchor: Coordinate,\n    protected ownerRect?: Rect,\n  ) {\n    this.svgRoot = dom.createSvgElement(Svg.G, {}, workspace.getBubbleCanvas());\n    const embossGroup = dom.createSvgElement(\n      Svg.G,\n      {\n        'filter': `url(#${\n          this.workspace.getRenderer().getConstants().embossFilterId\n        })`,\n      },\n      this.svgRoot,\n    );\n    this.tail = dom.createSvgElement(Svg.PATH, {}, embossGroup);\n    this.background = dom.createSvgElement(\n      Svg.RECT,\n      {\n        'class': 'blocklyDraggable',\n        'x': 0,\n        'y': 0,\n        'rx': Bubble.BORDER_WIDTH,\n        'ry': Bubble.BORDER_WIDTH,\n      },\n      embossGroup,\n    );\n    this.contentContainer = dom.createSvgElement(Svg.G, {}, this.svgRoot);\n\n    browserEvents.conditionalBind(\n      this.background,\n      'pointerdown',\n      this,\n      this.onMouseDown,\n    );\n  }\n\n  /** Dispose of this bubble. */\n  dispose() {\n    dom.removeNode(this.svgRoot);\n    this.disposed = true;\n  }\n\n  /**\n   * Set the location the tail of this bubble points to.\n   *\n   * @param anchor The location the tail of this bubble points to.\n   * @param relayout If true, reposition the bubble from scratch so that it is\n   *     optimally visible. If false, reposition it so it maintains the same\n   *     position relative to the anchor.\n   */\n  setAnchorLocation(anchor: Coordinate, relayout = false) {\n    this.anchor = anchor;\n    if (relayout) {\n      this.positionByRect(this.ownerRect);\n    } else {\n      this.positionRelativeToAnchor();\n    }\n    this.renderTail();\n  }\n\n  /** Sets the position of this bubble relative to its anchor. */\n  setPositionRelativeToAnchor(left: number, top: number) {\n    this.relativeLeft = left;\n    this.relativeTop = top;\n    this.positionRelativeToAnchor();\n    this.renderTail();\n  }\n\n  /** @returns the size of this bubble. */\n  protected getSize() {\n    return this.size;\n  }\n\n  /**\n   * Sets the size of this bubble, including the border.\n   *\n   * @param size Sets the size of this bubble, including the border.\n   * @param relayout If true, reposition the bubble from scratch so that it is\n   *     optimally visible. If false, reposition it so it maintains the same\n   *     position relative to the anchor.\n   */\n  protected setSize(size: Size, relayout = false) {\n    size.width = Math.max(size.width, Bubble.MIN_SIZE);\n    size.height = Math.max(size.height, Bubble.MIN_SIZE);\n    this.size = size;\n\n    this.background.setAttribute('width', `${size.width}`);\n    this.background.setAttribute('height', `${size.height}`);\n\n    if (relayout) {\n      this.positionByRect(this.ownerRect);\n    } else {\n      this.positionRelativeToAnchor();\n    }\n    this.renderTail();\n  }\n\n  /** Returns the colour of the background and tail of this bubble. */\n  protected getColour(): string {\n    return this.colour;\n  }\n\n  /** Sets the colour of the background and tail of this bubble. */\n  public setColour(colour: string) {\n    this.colour = colour;\n    this.tail.setAttribute('fill', colour);\n    this.background.setAttribute('fill', colour);\n  }\n\n  /** Passes the pointer event off to the gesture system. */\n  private onMouseDown(e: PointerEvent) {\n    this.workspace.getGesture(e)?.handleBubbleStart(e, this);\n  }\n\n  /** Positions the bubble relative to its anchor. Does not render its tail. */\n  protected positionRelativeToAnchor() {\n    let left = this.anchor.x;\n    if (this.workspace.RTL) {\n      left -= this.relativeLeft + this.size.width;\n    } else {\n      left += this.relativeLeft;\n    }\n    const top = this.relativeTop + this.anchor.y;\n    this.moveTo(left, top);\n  }\n\n  /**\n   * Moves the bubble to the given coordinates.\n   *\n   * @internal\n   */\n  moveTo(x: number, y: number) {\n    this.svgRoot.setAttribute('transform', `translate(${x}, ${y})`);\n  }\n\n  /**\n   * Positions the bubble \"optimally\" so that the most of it is visible and\n   * it does not overlap the rect (if provided).\n   */\n  protected positionByRect(rect = new Rect(0, 0, 0, 0)) {\n    const viewMetrics = this.workspace.getMetricsManager().getViewMetrics(true);\n\n    const optimalLeft = this.getOptimalRelativeLeft(viewMetrics);\n    const optimalTop = this.getOptimalRelativeTop(viewMetrics);\n\n    const topPosition = {\n      x: optimalLeft,\n      y: (-this.size.height -\n        this.workspace.getRenderer().getConstants().MIN_BLOCK_HEIGHT) as number,\n    };\n    const startPosition = {x: -this.size.width - 30, y: optimalTop};\n    const endPosition = {x: rect.getWidth(), y: optimalTop};\n    const bottomPosition = {x: optimalLeft, y: rect.getHeight()};\n\n    const closerPosition =\n      rect.getWidth() < rect.getHeight() ? endPosition : bottomPosition;\n    const fartherPosition =\n      rect.getWidth() < rect.getHeight() ? bottomPosition : endPosition;\n\n    const topPositionOverlap = this.getOverlap(topPosition, viewMetrics);\n    const startPositionOverlap = this.getOverlap(startPosition, viewMetrics);\n    const closerPositionOverlap = this.getOverlap(closerPosition, viewMetrics);\n    const fartherPositionOverlap = this.getOverlap(\n      fartherPosition,\n      viewMetrics,\n    );\n\n    // Set the position to whichever position shows the most of the bubble,\n    // with tiebreaks going in the order: top > start > close > far.\n    const mostOverlap = Math.max(\n      topPositionOverlap,\n      startPositionOverlap,\n      closerPositionOverlap,\n      fartherPositionOverlap,\n    );\n    if (topPositionOverlap === mostOverlap) {\n      this.relativeLeft = topPosition.x;\n      this.relativeTop = topPosition.y;\n      this.positionRelativeToAnchor();\n      return;\n    }\n    if (startPositionOverlap === mostOverlap) {\n      this.relativeLeft = startPosition.x;\n      this.relativeTop = startPosition.y;\n      this.positionRelativeToAnchor();\n      return;\n    }\n    if (closerPositionOverlap === mostOverlap) {\n      this.relativeLeft = closerPosition.x;\n      this.relativeTop = closerPosition.y;\n      this.positionRelativeToAnchor();\n      return;\n    }\n    // TODO: I believe relativeLeft_ should actually be called relativeStart_\n    //  and then the math should be fixed to reflect this. (hopefully it'll\n    //  make it look simpler)\n    this.relativeLeft = fartherPosition.x;\n    this.relativeTop = fartherPosition.y;\n    this.positionRelativeToAnchor();\n  }\n\n  /**\n   * Calculate the what percentage of the bubble overlaps with the visible\n   * workspace (what percentage of the bubble is visible).\n   *\n   * @param relativeMin The position of the top-left corner of the bubble\n   *     relative to the anchor point.\n   * @param viewMetrics The view metrics of the workspace the bubble will appear\n   *     in.\n   * @returns The percentage of the bubble that is visible.\n   */\n  private getOverlap(\n    relativeMin: {x: number; y: number},\n    viewMetrics: ContainerRegion,\n  ): number {\n    // The position of the top-left corner of the bubble in workspace units.\n    const bubbleMin = {\n      x: this.workspace.RTL\n        ? this.anchor.x - relativeMin.x - this.size.width\n        : relativeMin.x + this.anchor.x,\n      y: relativeMin.y + this.anchor.y,\n    };\n    // The position of the bottom-right corner of the bubble in workspace units.\n    const bubbleMax = {\n      x: bubbleMin.x + this.size.width,\n      y: bubbleMin.y + this.size.height,\n    };\n\n    // We could adjust these values to account for the scrollbars, but the\n    // bubbles should have been adjusted to not collide with them anyway, so\n    // giving the workspace a slightly larger \"bounding box\" shouldn't affect\n    // the calculation.\n\n    // The position of the top-left corner of the workspace.\n    const workspaceMin = {x: viewMetrics.left, y: viewMetrics.top};\n    // The position of the bottom-right corner of the workspace.\n    const workspaceMax = {\n      x: viewMetrics.left + viewMetrics.width,\n      y: viewMetrics.top + viewMetrics.height,\n    };\n\n    const overlapWidth =\n      Math.min(bubbleMax.x, workspaceMax.x) -\n      Math.max(bubbleMin.x, workspaceMin.x);\n    const overlapHeight =\n      Math.min(bubbleMax.y, workspaceMax.y) -\n      Math.max(bubbleMin.y, workspaceMin.y);\n    return Math.max(\n      0,\n      Math.min(\n        1,\n        (overlapWidth * overlapHeight) / (this.size.width * this.size.height),\n      ),\n    );\n  }\n\n  /**\n   * Calculate what the optimal horizontal position of the top-left corner of\n   * the bubble is (relative to the anchor point) so that the most area of the\n   * bubble is shown.\n   *\n   * @param viewMetrics The view metrics of the workspace the bubble will appear\n   *     in.\n   * @returns The optimal horizontal position of the top-left corner of the\n   *     bubble.\n   */\n  private getOptimalRelativeLeft(viewMetrics: ContainerRegion): number {\n    // By default, show the bubble just a bit to the left of the anchor.\n    let relativeLeft = -this.size.width / 4;\n\n    // No amount of sliding left or right will give us better overlap.\n    if (this.size.width > viewMetrics.width) return relativeLeft;\n\n    const workspaceRect = this.getWorkspaceViewRect(viewMetrics);\n\n    if (this.workspace.RTL) {\n      // Bubble coordinates are flipped in RTL.\n      const bubbleRight = this.anchor.x - relativeLeft;\n      const bubbleLeft = bubbleRight - this.size.width;\n\n      if (bubbleLeft < workspaceRect.left) {\n        // Slide the bubble right until it is onscreen.\n        relativeLeft = -(workspaceRect.left - this.anchor.x + this.size.width);\n      } else if (bubbleRight > workspaceRect.right) {\n        // Slide the bubble left until it is onscreen.\n        relativeLeft = -(workspaceRect.right - this.anchor.x);\n      }\n    } else {\n      const bubbleLeft = relativeLeft + this.anchor.x;\n      const bubbleRight = bubbleLeft + this.size.width;\n\n      if (bubbleLeft < workspaceRect.left) {\n        // Slide the bubble right until it is onscreen.\n        relativeLeft = workspaceRect.left - this.anchor.x;\n      } else if (bubbleRight > workspaceRect.right) {\n        // Slide the bubble left until it is onscreen.\n        relativeLeft = workspaceRect.right - this.anchor.x - this.size.width;\n      }\n    }\n\n    return relativeLeft;\n  }\n\n  /**\n   * Calculate what the optimal vertical position of the top-left corner of\n   * the bubble is (relative to the anchor point) so that the most area of the\n   * bubble is shown.\n   *\n   * @param viewMetrics The view metrics of the workspace the bubble will appear\n   *     in.\n   * @returns The optimal vertical position of the top-left corner of the\n   *     bubble.\n   */\n  private getOptimalRelativeTop(viewMetrics: ContainerRegion): number {\n    // By default, show the bubble just a bit higher than the anchor.\n    let relativeTop = -this.size.height / 4;\n\n    // No amount of sliding up or down will give us better overlap.\n    if (this.size.height > viewMetrics.height) return relativeTop;\n\n    const top = this.anchor.y + relativeTop;\n    const bottom = top + this.size.height;\n    const workspaceRect = this.getWorkspaceViewRect(viewMetrics);\n\n    if (top < workspaceRect.top) {\n      // Slide the bubble down until it is onscreen.\n      relativeTop = workspaceRect.top - this.anchor.y;\n    } else if (bottom > workspaceRect.bottom) {\n      // Slide the bubble up until it is onscreen.\n      relativeTop = workspaceRect.bottom - this.anchor.y - this.size.height;\n    }\n\n    return relativeTop;\n  }\n\n  /**\n   * @returns a rect defining the bounds of the workspace's view in workspace\n   * coordinates.\n   */\n  private getWorkspaceViewRect(viewMetrics: ContainerRegion): Rect {\n    const top = viewMetrics.top;\n    let bottom = viewMetrics.top + viewMetrics.height;\n    let left = viewMetrics.left;\n    let right = viewMetrics.left + viewMetrics.width;\n\n    bottom -= this.getScrollbarThickness();\n    if (this.workspace.RTL) {\n      left -= this.getScrollbarThickness();\n    } else {\n      right -= this.getScrollbarThickness();\n    }\n\n    return new Rect(top, bottom, left, right);\n  }\n\n  /** @returns the scrollbar thickness in workspace units. */\n  private getScrollbarThickness() {\n    return Scrollbar.scrollbarThickness / this.workspace.scale;\n  }\n\n  /** Draws the tail of the bubble. */\n  private renderTail() {\n    const steps = [];\n    // Find the relative coordinates of the center of the bubble.\n    const relBubbleX = this.size.width / 2;\n    const relBubbleY = this.size.height / 2;\n    // Find the relative coordinates of the center of the anchor.\n    let relAnchorX = -this.relativeLeft;\n    let relAnchorY = -this.relativeTop;\n    if (relBubbleX === relAnchorX && relBubbleY === relAnchorY) {\n      // Null case.  Bubble is directly on top of the anchor.\n      // Short circuit this rather than wade through divide by zeros.\n      steps.push('M ' + relBubbleX + ',' + relBubbleY);\n    } else {\n      // Compute the angle of the tail's line.\n      const rise = relAnchorY - relBubbleY;\n      let run = relAnchorX - relBubbleX;\n      if (this.workspace.RTL) {\n        run *= -1;\n      }\n      const hypotenuse = Math.sqrt(rise * rise + run * run);\n      let angle = Math.acos(run / hypotenuse);\n      if (rise < 0) {\n        angle = 2 * Math.PI - angle;\n      }\n      // Compute a line perpendicular to the tail.\n      let rightAngle = angle + Math.PI / 2;\n      if (rightAngle > Math.PI * 2) {\n        rightAngle -= Math.PI * 2;\n      }\n      const rightRise = Math.sin(rightAngle);\n      const rightRun = Math.cos(rightAngle);\n\n      // Calculate the thickness of the base of the tail.\n      let thickness =\n        (this.size.width + this.size.height) / Bubble.TAIL_THICKNESS;\n      thickness = Math.min(thickness, this.size.width, this.size.height) / 4;\n\n      // Back the tip of the tail off of the anchor.\n      const backoffRatio = 1 - Bubble.ANCHOR_RADIUS / hypotenuse;\n      relAnchorX = relBubbleX + backoffRatio * run;\n      relAnchorY = relBubbleY + backoffRatio * rise;\n\n      // Coordinates for the base of the tail.\n      const baseX1 = relBubbleX + thickness * rightRun;\n      const baseY1 = relBubbleY + thickness * rightRise;\n      const baseX2 = relBubbleX - thickness * rightRun;\n      const baseY2 = relBubbleY - thickness * rightRise;\n\n      // Distortion to curve the tail.\n      const radians = math.toRadians(\n        this.workspace.RTL ? -Bubble.TAIL_ANGLE : Bubble.TAIL_ANGLE,\n      );\n      let swirlAngle = angle + radians;\n      if (swirlAngle > Math.PI * 2) {\n        swirlAngle -= Math.PI * 2;\n      }\n      const swirlRise = (Math.sin(swirlAngle) * hypotenuse) / Bubble.TAIL_BEND;\n      const swirlRun = (Math.cos(swirlAngle) * hypotenuse) / Bubble.TAIL_BEND;\n\n      steps.push('M' + baseX1 + ',' + baseY1);\n      steps.push(\n        'C' +\n          (baseX1 + swirlRun) +\n          ',' +\n          (baseY1 + swirlRise) +\n          ' ' +\n          relAnchorX +\n          ',' +\n          relAnchorY +\n          ' ' +\n          relAnchorX +\n          ',' +\n          relAnchorY,\n      );\n      steps.push(\n        'C' +\n          relAnchorX +\n          ',' +\n          relAnchorY +\n          ' ' +\n          (baseX2 + swirlRun) +\n          ',' +\n          (baseY2 + swirlRise) +\n          ' ' +\n          baseX2 +\n          ',' +\n          baseY2,\n      );\n    }\n    steps.push('z');\n    this.tail?.setAttribute('d', steps.join(' '));\n  }\n  /**\n   * Move this bubble to the front of the visible workspace.\n   *\n   * @returns Whether or not the bubble has been moved.\n   * @internal\n   */\n  bringToFront(): boolean {\n    const svgGroup = this.svgRoot?.parentNode;\n    if (this.svgRoot && svgGroup?.lastChild !== this.svgRoot) {\n      svgGroup?.appendChild(this.svgRoot);\n      return true;\n    }\n    return false;\n  }\n\n  /** @internal */\n  getRelativeToSurfaceXY(): Coordinate {\n    return new Coordinate(\n      this.workspace.RTL\n        ? -this.relativeLeft + this.anchor.x - this.size.width\n        : this.anchor.x + this.relativeLeft,\n      this.anchor.y + this.relativeTop,\n    );\n  }\n\n  /** @internal */\n  getSvgRoot(): SVGElement {\n    return this.svgRoot;\n  }\n\n  /**\n   * Move this bubble during a drag.\n   *\n   * @param newLoc The location to translate to, in workspace coordinates.\n   * @internal\n   */\n  moveDuringDrag(newLoc: Coordinate) {\n    this.moveTo(newLoc.x, newLoc.y);\n    if (this.workspace.RTL) {\n      this.relativeLeft = this.anchor.x - newLoc.x - this.size.width;\n    } else {\n      this.relativeLeft = newLoc.x - this.anchor.x;\n    }\n    this.relativeTop = newLoc.y - this.anchor.y;\n    this.renderTail();\n  }\n\n  setDragging(_start: boolean) {\n    // NOOP in base class.\n  }\n\n  /** @internal */\n  setDeleteStyle(_enable: boolean) {\n    // NOOP in base class.\n  }\n\n  /** @internal */\n  isDeletable(): boolean {\n    return false;\n  }\n\n  /** @internal */\n  showContextMenu(_e: Event) {\n    // NOOP in base class.\n  }\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {Abstract as AbstractEvent} from '../events/events_abstract.js';\nimport type {BlocklyOptions} from '../blockly_options.js';\nimport {Bubble} from './bubble.js';\nimport {Coordinate} from '../utils/coordinate.js';\nimport * as dom from '../utils/dom.js';\nimport {Options} from '../options.js';\nimport {Svg} from '../utils/svg.js';\nimport type {Rect} from '../utils/rect.js';\nimport {Size} from '../utils/size.js';\nimport type {WorkspaceSvg} from '../workspace_svg.js';\n\n/**\n * A bubble that contains a mini-workspace which can hold arbitrary blocks.\n * Used by the mutator icon.\n */\nexport class MiniWorkspaceBubble extends Bubble {\n  /**\n   * The minimum amount of change to the mini workspace view to trigger\n   * resizing the bubble.\n   */\n  private static readonly MINIMUM_VIEW_CHANGE = 10;\n\n  /**\n   * An arbitrary margin of whitespace to put around the blocks in the\n   * workspace.\n   */\n  private static readonly MARGIN = Bubble.DOUBLE_BORDER * 3;\n\n  /** The root svg element containing the workspace. */\n  private svgDialog: SVGElement;\n\n  /** The workspace that gets shown within this bubble. */\n  private miniWorkspace: WorkspaceSvg;\n\n  /**\n   * Should this bubble automatically reposition itself when it resizes?\n   * Becomes false after this bubble is first dragged.\n   */\n  private autoLayout = true;\n\n  /** @internal */\n  constructor(\n    workspaceOptions: BlocklyOptions,\n    protected readonly workspace: WorkspaceSvg,\n    protected anchor: Coordinate,\n    protected ownerRect?: Rect,\n  ) {\n    super(workspace, anchor, ownerRect);\n    const options = new Options(workspaceOptions);\n    this.validateWorkspaceOptions(options);\n\n    this.svgDialog = dom.createSvgElement(\n      Svg.SVG,\n      {\n        'x': Bubble.BORDER_WIDTH,\n        'y': Bubble.BORDER_WIDTH,\n      },\n      this.contentContainer,\n    );\n    workspaceOptions.parentWorkspace = this.workspace;\n    this.miniWorkspace = this.newWorkspaceSvg(new Options(workspaceOptions));\n    // TODO (#7422): Change this to `internalIsMiniWorkspace` or something. Not\n    //   all mini workspaces are necessarily mutators.\n    this.miniWorkspace.internalIsMutator = true;\n    const background = this.miniWorkspace.createDom('blocklyMutatorBackground');\n    this.svgDialog.appendChild(background);\n    if (options.languageTree) {\n      background.insertBefore(\n        this.miniWorkspace.addFlyout(Svg.G),\n        this.miniWorkspace.getCanvas(),\n      );\n      const flyout = this.miniWorkspace.getFlyout();\n      flyout?.init(this.miniWorkspace);\n      flyout?.show(options.languageTree);\n    }\n\n    this.miniWorkspace.addChangeListener(this.onWorkspaceChange.bind(this));\n    this.miniWorkspace\n      .getFlyout()\n      ?.getWorkspace()\n      ?.addChangeListener(this.onWorkspaceChange.bind(this));\n    this.updateBubbleSize();\n  }\n\n  dispose() {\n    this.miniWorkspace.dispose();\n    super.dispose();\n  }\n\n  /** @internal */\n  getWorkspace(): WorkspaceSvg {\n    return this.miniWorkspace;\n  }\n\n  /** Adds a change listener to the mini workspace. */\n  addWorkspaceChangeListener(listener: (e: AbstractEvent) => void) {\n    this.miniWorkspace.addChangeListener(listener);\n  }\n\n  /**\n   * Validates the workspace options to make sure folks aren't trying to\n   * enable things the miniworkspace doesn't support.\n   */\n  private validateWorkspaceOptions(options: Options) {\n    if (options.hasCategories) {\n      throw new Error(\n        'The miniworkspace bubble does not support toolboxes with categories',\n      );\n    }\n    if (options.hasTrashcan) {\n      throw new Error('The miniworkspace bubble does not support trashcans');\n    }\n    if (\n      options.zoomOptions.controls ||\n      options.zoomOptions.wheel ||\n      options.zoomOptions.pinch\n    ) {\n      throw new Error('The miniworkspace bubble does not support zooming');\n    }\n    if (\n      options.moveOptions.scrollbars ||\n      options.moveOptions.wheel ||\n      options.moveOptions.drag\n    ) {\n      throw new Error(\n        'The miniworkspace bubble does not scrolling/moving the workspace',\n      );\n    }\n    if (options.horizontalLayout) {\n      throw new Error(\n        'The miniworkspace bubble does not support horizontal layouts',\n      );\n    }\n  }\n\n  private onWorkspaceChange() {\n    this.bumpBlocksIntoBounds();\n    this.updateBubbleSize();\n  }\n\n  /**\n   * Bumps blocks that are above the top or outside the start-side of the\n   * workspace back within the workspace.\n   *\n   * Blocks that are below the bottom or outside the end-side of the workspace\n   * are dealt with by resizing the workspace to show them.\n   */\n  private bumpBlocksIntoBounds() {\n    if (this.miniWorkspace.isDragging()) return;\n\n    const MARGIN = 20;\n\n    for (const block of this.miniWorkspace.getTopBlocks(false)) {\n      const blockXY = block.getRelativeToSurfaceXY();\n\n      // Bump any block that's above the top back inside.\n      if (blockXY.y < MARGIN) {\n        block.moveBy(0, MARGIN - blockXY.y);\n      }\n      // Bump any block overlapping the flyout back inside.\n      if (block.RTL) {\n        let right = -MARGIN;\n        const flyout = this.miniWorkspace.getFlyout();\n        if (flyout) {\n          right -= flyout.getWidth();\n        }\n        if (blockXY.x > right) {\n          block.moveBy(right - blockXY.x, 0);\n        }\n      } else if (blockXY.x < MARGIN) {\n        block.moveBy(MARGIN - blockXY.x, 0);\n      }\n    }\n  }\n\n  /**\n   * Updates the size of this bubble to account for the size of the\n   * mini workspace.\n   */\n  private updateBubbleSize() {\n    if (this.miniWorkspace.isDragging()) return;\n\n    const currSize = this.getSize();\n    const newSize = this.calculateWorkspaceSize();\n    if (\n      Math.abs(currSize.width - newSize.width) <\n        MiniWorkspaceBubble.MINIMUM_VIEW_CHANGE &&\n      Math.abs(currSize.height - newSize.height) <\n        MiniWorkspaceBubble.MINIMUM_VIEW_CHANGE\n    ) {\n      // Only resize if the size has noticeably changed.\n      return;\n    }\n    this.svgDialog.setAttribute('width', `${newSize.width}px`);\n    this.svgDialog.setAttribute('height', `${newSize.height}px`);\n    this.miniWorkspace.setCachedParentSvgSize(newSize.width, newSize.height);\n    if (this.miniWorkspace.RTL) {\n      // Scroll the workspace to always left-align.\n      this.miniWorkspace\n        .getCanvas()\n        .setAttribute('transform', `translate(${newSize.width}, 0)`);\n    }\n    this.setSize(\n      new Size(\n        newSize.width + Bubble.DOUBLE_BORDER,\n        newSize.height + Bubble.DOUBLE_BORDER,\n      ),\n      this.autoLayout,\n    );\n    this.miniWorkspace.resize();\n    this.miniWorkspace.recordDragTargets();\n  }\n\n  /**\n   * Calculates the size of the mini workspace for use in resizing the bubble.\n   */\n  private calculateWorkspaceSize(): Size {\n    const workspaceSize = this.miniWorkspace.getCanvas().getBBox();\n    let width = workspaceSize.width + MiniWorkspaceBubble.MARGIN;\n    let height = workspaceSize.height + MiniWorkspaceBubble.MARGIN;\n\n    const flyout = this.miniWorkspace.getFlyout();\n    if (flyout) {\n      const flyoutScrollMetrics = flyout\n        .getWorkspace()\n        .getMetricsManager()\n        .getScrollMetrics();\n      height = Math.max(height, flyoutScrollMetrics.height + 20);\n      width += flyout.getWidth();\n    }\n    return new Size(width, height);\n  }\n\n  /** Reapplies styles to all of the blocks in the mini workspace. */\n  updateBlockStyles() {\n    for (const block of this.miniWorkspace.getAllBlocks(false)) {\n      block.setStyle(block.getStyleName());\n    }\n\n    const flyoutWs = this.miniWorkspace.getFlyout()?.getWorkspace();\n    if (flyoutWs) {\n      for (const block of flyoutWs.getAllBlocks(false)) {\n        block.setStyle(block.getStyleName());\n      }\n    }\n  }\n\n  /**\n   * Move this bubble during a drag.\n   *\n   * @param newLoc The location to translate to, in workspace coordinates.\n   * @internal\n   */\n  moveDuringDrag(newLoc: Coordinate): void {\n    super.moveDuringDrag(newLoc);\n    this.autoLayout = false;\n  }\n\n  /** @internal */\n  moveTo(x: number, y: number): void {\n    super.moveTo(x, y);\n    this.miniWorkspace.recordDragTargets();\n  }\n\n  /** @internal */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  newWorkspaceSvg(options: Options): WorkspaceSvg {\n    throw new Error(\n      'The implementation of newWorkspaceSvg should be ' +\n        'monkey-patched in by blockly.ts',\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.Mutator\n\nimport type {Abstract} from '../events/events_abstract.js';\nimport type {Block} from '../block.js';\nimport {BlockChange} from '../events/events_block_change.js';\nimport type {BlocklyOptions} from '../blockly_options.js';\nimport type {BlockSvg} from '../block_svg.js';\nimport type {Connection} from '../connection.js';\nimport {Coordinate} from '../utils/coordinate.js';\nimport * as dom from '../utils/dom.js';\nimport * as eventUtils from '../events/utils.js';\nimport type {IHasBubble} from '../interfaces/i_has_bubble.js';\nimport {Icon} from './icon.js';\nimport {MiniWorkspaceBubble} from '../bubbles/mini_workspace_bubble.js';\nimport {Rect} from '../utils/rect.js';\nimport {Size} from '../utils/size.js';\nimport {Svg} from '../utils/svg.js';\nimport type {WorkspaceSvg} from '../workspace_svg.js';\nimport * as deprecation from '../utils/deprecation.js';\nimport {IconType} from './icon_types.js';\n\n/** The size of the mutator icon in workspace-scale units. */\nconst SIZE = 17;\n\n/**\n * The distance between the root block in the mini workspace and that\n * workspace's edges.\n */\nconst WORKSPACE_MARGIN = 16;\n\n/**\n * An icon that allows the user to change the shape of the block.\n *\n * For example, it could be used to add additional fields or inputs to\n * the block.\n */\nexport class MutatorIcon extends Icon implements IHasBubble {\n  /** The type string used to identify this icon. */\n  static readonly TYPE = IconType.MUTATOR;\n\n  /**\n   * The weight this icon has relative to other icons. Icons with more positive\n   * weight values are rendered farther toward the end of the block.\n   */\n  static readonly WEIGHT = 1;\n\n  /** The bubble used to show the mini workspace to the user. */\n  private miniWorkspaceBubble: MiniWorkspaceBubble | null = null;\n\n  /** The root block in the mini workspace. */\n  private rootBlock: BlockSvg | null = null;\n\n  /** The PID tracking updating the workkspace in response to user events. */\n  private updateWorkspacePid: ReturnType<typeof setTimeout> | null = null;\n\n  /**\n   * The change listener in the main workspace that triggers the saveConnections\n   * method when anything in the main workspace changes.\n   *\n   * Only actually registered to listen for events while the mutator bubble is\n   * open.\n   */\n  private saveConnectionsListener: (() => void) | null = null;\n\n  constructor(\n    private readonly flyoutBlockTypes: string[],\n    protected readonly sourceBlock: BlockSvg,\n  ) {\n    super(sourceBlock);\n  }\n\n  override getType(): IconType<MutatorIcon> {\n    return MutatorIcon.TYPE;\n  }\n\n  override initView(pointerdownListener: (e: PointerEvent) => void): void {\n    if (this.svgRoot) return; // Already initialized.\n\n    super.initView(pointerdownListener);\n\n    // Square with rounded corners.\n    dom.createSvgElement(\n      Svg.RECT,\n      {\n        'class': 'blocklyIconShape',\n        'rx': '4',\n        'ry': '4',\n        'height': '16',\n        'width': '16',\n      },\n      this.svgRoot,\n    );\n    // Gear teeth.\n    dom.createSvgElement(\n      Svg.PATH,\n      {\n        'class': 'blocklyIconSymbol',\n        'd':\n          'm4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,' +\n          '0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,' +\n          '-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,' +\n          '-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,' +\n          '-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 ' +\n          '-0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,' +\n          '0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z',\n      },\n      this.svgRoot,\n    );\n    // Axle hole.\n    dom.createSvgElement(\n      Svg.CIRCLE,\n      {'class': 'blocklyIconShape', 'r': '2.7', 'cx': '8', 'cy': '8'},\n      this.svgRoot,\n    );\n    dom.addClass(this.svgRoot!, 'blockly-icon-mutator');\n  }\n\n  override dispose(): void {\n    super.dispose();\n    this.miniWorkspaceBubble?.dispose();\n  }\n\n  override getWeight(): number {\n    return MutatorIcon.WEIGHT;\n  }\n\n  override getSize(): Size {\n    return new Size(SIZE, SIZE);\n  }\n\n  override applyColour(): void {\n    super.applyColour();\n    this.miniWorkspaceBubble?.setColour(this.sourceBlock.style.colourPrimary);\n    this.miniWorkspaceBubble?.updateBlockStyles();\n  }\n\n  override updateCollapsed(): void {\n    super.updateCollapsed();\n    if (this.sourceBlock.isCollapsed()) this.setBubbleVisible(false);\n  }\n\n  override onLocationChange(blockOrigin: Coordinate): void {\n    super.onLocationChange(blockOrigin);\n    this.miniWorkspaceBubble?.setAnchorLocation(this.getAnchorLocation());\n  }\n\n  override onClick(): void {\n    super.onClick();\n    if (this.sourceBlock.isEditable()) {\n      this.setBubbleVisible(!this.bubbleIsVisible());\n    }\n  }\n\n  override isClickableInFlyout(): boolean {\n    return false;\n  }\n\n  bubbleIsVisible(): boolean {\n    return !!this.miniWorkspaceBubble;\n  }\n\n  setBubbleVisible(visible: boolean): void {\n    if (this.bubbleIsVisible() === visible) return;\n\n    if (visible) {\n      this.miniWorkspaceBubble = new MiniWorkspaceBubble(\n        this.getMiniWorkspaceConfig(),\n        this.sourceBlock.workspace,\n        this.getAnchorLocation(),\n        this.getBubbleOwnerRect(),\n      );\n      this.applyColour();\n      this.createRootBlock();\n      this.addSaveConnectionsListener();\n      this.miniWorkspaceBubble?.addWorkspaceChangeListener(\n        this.createMiniWorkspaceChangeListener(),\n      );\n    } else {\n      this.miniWorkspaceBubble?.dispose();\n      this.miniWorkspaceBubble = null;\n      if (this.saveConnectionsListener) {\n        this.sourceBlock.workspace.removeChangeListener(\n          this.saveConnectionsListener,\n        );\n      }\n      this.saveConnectionsListener = null;\n    }\n\n    eventUtils.fire(\n      new (eventUtils.get(eventUtils.BUBBLE_OPEN))(\n        this.sourceBlock,\n        visible,\n        'mutator',\n      ),\n    );\n  }\n\n  /** @returns the configuration the mini workspace should have. */\n  private getMiniWorkspaceConfig() {\n    const options: BlocklyOptions = {\n      'disable': false,\n      'media': this.sourceBlock.workspace.options.pathToMedia,\n      'rtl': this.sourceBlock.RTL,\n      'renderer': this.sourceBlock.workspace.options.renderer,\n      'rendererOverrides':\n        this.sourceBlock.workspace.options.rendererOverrides ?? undefined,\n    };\n\n    if (this.flyoutBlockTypes.length) {\n      options.toolbox = {\n        'kind': 'flyoutToolbox',\n        'contents': this.flyoutBlockTypes.map((type) => ({\n          'kind': 'block',\n          'type': type,\n        })),\n      };\n    }\n\n    return options;\n  }\n\n  /**\n   * @returns the location the bubble should be anchored to.\n   *     I.E. the middle of this icon.\n   */\n  private getAnchorLocation(): Coordinate {\n    const midIcon = SIZE / 2;\n    return Coordinate.sum(\n      this.workspaceLocation,\n      new Coordinate(midIcon, midIcon),\n    );\n  }\n\n  /**\n   * @returns the rect the bubble should avoid overlapping.\n   *     I.E. the block that owns this icon.\n   */\n  private getBubbleOwnerRect(): Rect {\n    const bbox = this.sourceBlock.getSvgRoot().getBBox();\n    return new Rect(bbox.y, bbox.y + bbox.height, bbox.x, bbox.x + bbox.width);\n  }\n\n  /** Decomposes the source block to create blocks in the mini workspace. */\n  private createRootBlock() {\n    if (!this.sourceBlock.decompose) {\n      throw new Error(\n        'Blocks with mutator icons must include a decompose method',\n      );\n    }\n    this.rootBlock = this.sourceBlock.decompose(\n      this.miniWorkspaceBubble!.getWorkspace(),\n    )!;\n\n    for (const child of this.rootBlock.getDescendants(false)) {\n      child.queueRender();\n    }\n\n    this.rootBlock.setMovable(false);\n    this.rootBlock.setDeletable(false);\n\n    const flyoutWidth =\n      this.miniWorkspaceBubble?.getWorkspace()?.getFlyout()?.getWidth() ?? 0;\n    this.rootBlock.moveBy(\n      this.rootBlock.RTL ? -(flyoutWidth + WORKSPACE_MARGIN) : WORKSPACE_MARGIN,\n      WORKSPACE_MARGIN,\n    );\n  }\n\n  /** Adds a listen to the source block that triggers saving connections. */\n  private addSaveConnectionsListener() {\n    if (!this.sourceBlock.saveConnections || !this.rootBlock) return;\n    this.saveConnectionsListener = () => {\n      if (!this.sourceBlock.saveConnections || !this.rootBlock) return;\n      this.sourceBlock.saveConnections(this.rootBlock);\n    };\n    this.saveConnectionsListener();\n    this.sourceBlock.workspace.addChangeListener(this.saveConnectionsListener);\n  }\n\n  /**\n   * Creates a change listener to add to the mini workspace which recomposes\n   * the block.\n   */\n  private createMiniWorkspaceChangeListener() {\n    return (e: Abstract) => {\n      if (!MutatorIcon.isIgnorableMutatorEvent(e) && !this.updateWorkspacePid) {\n        this.updateWorkspacePid = setTimeout(() => {\n          this.updateWorkspacePid = null;\n          this.recomposeSourceBlock();\n        }, 0);\n      }\n    };\n  }\n\n  /**\n   * Returns true if the given event is not one the mutator needs to\n   * care about.\n   *\n   * @internal\n   */\n  static isIgnorableMutatorEvent(e: Abstract) {\n    return (\n      e.isUiEvent ||\n      e.type === eventUtils.CREATE ||\n      (e.type === eventUtils.CHANGE &&\n        (e as BlockChange).element === 'disabled')\n    );\n  }\n\n  /** Recomposes the source block based on changes to the mini workspace. */\n  private recomposeSourceBlock() {\n    if (!this.rootBlock) return;\n    if (!this.sourceBlock.compose) {\n      throw new Error(\n        'Blocks with mutator icons must include a compose method',\n      );\n    }\n\n    const existingGroup = eventUtils.getGroup();\n    if (!existingGroup) eventUtils.setGroup(true);\n\n    const oldExtraState = BlockChange.getExtraBlockState_(this.sourceBlock);\n    this.sourceBlock.compose(this.rootBlock);\n    const newExtraState = BlockChange.getExtraBlockState_(this.sourceBlock);\n\n    if (oldExtraState !== newExtraState) {\n      eventUtils.fire(\n        new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n          this.sourceBlock,\n          'mutation',\n          null,\n          oldExtraState,\n          newExtraState,\n        ),\n      );\n    }\n\n    eventUtils.setGroup(existingGroup);\n  }\n\n  /**\n   * @returns The workspace of the mini workspace bubble, if the bubble is\n   *     currently open.\n   */\n  getWorkspace(): WorkspaceSvg | undefined {\n    return this.miniWorkspaceBubble?.getWorkspace();\n  }\n\n  /**\n   * Reconnects the given connection to the mutated input on the given block.\n   *\n   * @deprecated Use connection.reconnect instead. To be removed in v11.\n   */\n  static reconnect(\n    connectionChild: Connection | null,\n    block: Block,\n    inputName: string,\n  ): boolean {\n    deprecation.warn(\n      'MutatorIcon.reconnect',\n      'v10',\n      'v11',\n      'connection.reconnect',\n    );\n    if (!connectionChild) return false;\n    return connectionChild.reconnect(block, inputName);\n  }\n\n  /**\n   * Returns the parent workspace of a workspace that is inside a mini workspace\n   * bubble, taking into account whether the workspace is a flyout.\n   *\n   * @deprecated Use workspace.getRootWorkspace. To be removed in v11.\n   */\n  static findParentWs(workspace: WorkspaceSvg): WorkspaceSvg | null {\n    deprecation.warn(\n      'MutatorIcon.findParentWs',\n      'v10',\n      'v11',\n      'workspace.getRootWorkspace',\n    );\n    return workspace.getRootWorkspace();\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.utils.KeyCodes\n\n/* eslint-disable @typescript-eslint/no-duplicate-enum-values */\n\n/**\n * Key codes for common characters.\n *\n * Copied from Closure's goog.events.KeyCodes\n *\n * This list is not localized and therefore some of the key codes are not\n * correct for non US keyboard layouts. See comments below.\n */\nexport enum KeyCodes {\n  WIN_KEY_FF_LINUX = 0,\n  MAC_ENTER = 3,\n  BACKSPACE = 8,\n  TAB = 9,\n  NUM_CENTER = 12, // NUMLOCK on FF/Safari Mac\n  ENTER = 13,\n  SHIFT = 16,\n  CTRL = 17,\n  ALT = 18,\n  PAUSE = 19,\n  CAPS_LOCK = 20,\n  ESC = 27,\n  SPACE = 32,\n  PAGE_UP = 33, // also NUM_NORTH_EAST\n  PAGE_DOWN = 34, // also NUM_SOUTH_EAST\n  END = 35, // also NUM_SOUTH_WEST\n  HOME = 36, // also NUM_NORTH_WEST\n  LEFT = 37, // also NUM_WEST\n  UP = 38, // also NUM_NORTH\n  RIGHT = 39, // also NUM_EAST\n  DOWN = 40, // also NUM_SOUTH\n  PLUS_SIGN = 43, // NOT numpad plus\n  PRINT_SCREEN = 44,\n  INSERT = 45, // also NUM_INSERT\n  DELETE = 46, // also NUM_DELETE\n  ZERO = 48,\n  ONE = 49,\n  TWO = 50,\n  THREE = 51,\n  FOUR = 52,\n  FIVE = 53,\n  SIX = 54,\n  SEVEN = 55,\n  EIGHT = 56,\n  NINE = 57,\n  FF_SEMICOLON = 59, // Firefox (Gecko) fires this for semicolon instead of 186\n  FF_EQUALS = 61, // Firefox (Gecko) fires this for equals instead of 187\n  FF_DASH = 173, // Firefox (Gecko) fires this for dash instead of 189\n  // Firefox (Gecko) fires this for # on UK keyboards, rather than\n  // Shift+SINGLE_QUOTE.\n  FF_HASH = 163,\n  QUESTION_MARK = 63, // needs localization\n  AT_SIGN = 64,\n  A = 65,\n  B = 66,\n  C = 67,\n  D = 68,\n  E = 69,\n  F = 70,\n  G = 71,\n  H = 72,\n  I = 73,\n  J = 74,\n  K = 75,\n  L = 76,\n  M = 77,\n  N = 78,\n  O = 79,\n  P = 80,\n  Q = 81,\n  R = 82,\n  S = 83,\n  T = 84,\n  U = 85,\n  V = 86,\n  W = 87,\n  X = 88,\n  Y = 89,\n  Z = 90,\n  META = 91, // WIN_KEY_LEFT\n  WIN_KEY_RIGHT = 92,\n  CONTEXT_MENU = 93,\n  NUM_ZERO = 96,\n  NUM_ONE = 97,\n  NUM_TWO = 98,\n  NUM_THREE = 99,\n  NUM_FOUR = 100,\n  NUM_FIVE = 101,\n  NUM_SIX = 102,\n  NUM_SEVEN = 103,\n  NUM_EIGHT = 104,\n  NUM_NINE = 105,\n  NUM_MULTIPLY = 106,\n  NUM_PLUS = 107,\n  NUM_MINUS = 109,\n  NUM_PERIOD = 110,\n  NUM_DIVISION = 111,\n  F1 = 112,\n  F2 = 113,\n  F3 = 114,\n  F4 = 115,\n  F5 = 116,\n  F6 = 117,\n  F7 = 118,\n  F8 = 119,\n  F9 = 120,\n  F10 = 121,\n  F11 = 122,\n  F12 = 123,\n  NUMLOCK = 144,\n  SCROLL_LOCK = 145,\n\n  // OS-specific media keys like volume controls and browser controls.\n  FIRST_MEDIA_KEY = 166,\n  LAST_MEDIA_KEY = 183,\n\n  SEMICOLON = 186, // needs localization\n  DASH = 189, // needs localization\n  EQUALS = 187, // needs localization\n  COMMA = 188, // needs localization\n  PERIOD = 190, // needs localization\n  SLASH = 191, // needs localization\n  APOSTROPHE = 192, // needs localization\n  TILDE = 192, // needs localization\n  SINGLE_QUOTE = 222, // needs localization\n  OPEN_SQUARE_BRACKET = 219, // needs localization\n  BACKSLASH = 220, // needs localization\n  CLOSE_SQUARE_BRACKET = 221, // needs localization\n  WIN_KEY = 224,\n  MAC_FF_META = 224, // Firefox (Gecko) fires this for the meta key instead of 91\n  MAC_WK_CMD_LEFT = 91, // WebKit Left Command key fired, same as META\n  MAC_WK_CMD_RIGHT = 93, // WebKit Right Command key fired, different from META\n  WIN_IME = 229,\n\n  // \"Reserved for future use\". Some programs (e.g. the SlingPlayer 2.4 ActiveX\n  // control) fire this as a hacky way to disable screensavers.\n  VK_NONAME = 252,\n\n  // We've seen users whose machines fire this keycode at regular one\n  // second intervals. The common thread among these users is that\n  // they're all using Dell Inspiron laptops, so we suspect that this\n  // indicates a hardware/bios problem.\n  // http://en.community.dell.com/support-forums/laptop/f/3518/p/19285957/19523128.aspx\n  PHANTOM = 255,\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.utils\n\nimport * as browserEvents from './browser_events.js';\nimport * as extensions from './extensions.js';\nimport * as aria from './utils/aria.js';\nimport * as arrayUtils from './utils/array.js';\nimport * as colour from './utils/colour.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as deprecation from './utils/deprecation.js';\nimport * as dom from './utils/dom.js';\nimport * as idGenerator from './utils/idgenerator.js';\nimport {KeyCodes} from './utils/keycodes.js';\nimport * as math from './utils/math.js';\nimport type {Metrics} from './utils/metrics.js';\nimport * as object from './utils/object.js';\nimport * as parsing from './utils/parsing.js';\nimport {Rect} from './utils/rect.js';\nimport {Size} from './utils/size.js';\nimport * as stringUtils from './utils/string.js';\nimport * as style from './utils/style.js';\nimport {Svg} from './utils/svg.js';\nimport * as svgMath from './utils/svg_math.js';\nimport * as svgPaths from './utils/svg_paths.js';\nimport * as toolbox from './utils/toolbox.js';\nimport * as userAgent from './utils/useragent.js';\nimport * as xml from './utils/xml.js';\n\nexport {\n  aria,\n  arrayUtils as array,\n  browserEvents,\n  colour,\n  Coordinate,\n  deprecation,\n  dom,\n  extensions,\n  idGenerator,\n  KeyCodes,\n  math,\n  Metrics,\n  object,\n  parsing,\n  Rect,\n  Size,\n  stringUtils as string,\n  style,\n  Svg,\n  svgMath,\n  svgPaths,\n  toolbox,\n  userAgent,\n  xml,\n};\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {Bubble} from './bubble.js';\nimport {Coordinate} from '../utils/coordinate.js';\nimport * as dom from '../utils/dom.js';\nimport {Rect} from '../utils/rect.js';\nimport {Size} from '../utils/size.js';\nimport {Svg} from '../utils/svg.js';\nimport {WorkspaceSvg} from '../workspace_svg.js';\n\n/**\n * A bubble that displays non-editable text. Used by the warning icon.\n */\nexport class TextBubble extends Bubble {\n  private paragraph: SVGTextElement;\n\n  constructor(\n    private text: string,\n    protected readonly workspace: WorkspaceSvg,\n    protected anchor: Coordinate,\n    protected ownerRect?: Rect,\n  ) {\n    super(workspace, anchor, ownerRect);\n    this.paragraph = this.stringToSvg(text, this.contentContainer);\n    this.updateBubbleSize();\n  }\n\n  /** @returns the current text of this text bubble. */\n  getText(): string {\n    return this.text;\n  }\n\n  /** Sets the current text of this text bubble, and updates the display. */\n  setText(text: string) {\n    this.text = text;\n    dom.removeNode(this.paragraph);\n    this.paragraph = this.stringToSvg(text, this.contentContainer);\n    this.updateBubbleSize();\n  }\n\n  /**\n   * Converts the given string into an svg containing that string,\n   * broken up by newlines.\n   */\n  private stringToSvg(text: string, container: SVGGElement) {\n    const paragraph = this.createParagraph(container);\n    const spans = this.createSpans(paragraph, text);\n    if (this.workspace.RTL)\n      this.rightAlignSpans(paragraph.getBBox().width, spans);\n    return paragraph;\n  }\n\n  /** Creates the paragraph container for this bubble's view's spans. */\n  private createParagraph(container: SVGGElement): SVGTextElement {\n    return dom.createSvgElement(\n      Svg.TEXT,\n      {\n        'class': 'blocklyText blocklyBubbleText blocklyNoPointerEvents',\n        'y': Bubble.BORDER_WIDTH,\n      },\n      container,\n    );\n  }\n\n  /** Creates the spans visualizing the text of this bubble. */\n  private createSpans(parent: SVGTextElement, text: string): SVGTSpanElement[] {\n    return text.split('\\n').map((line) => {\n      const tspan = dom.createSvgElement(\n        Svg.TSPAN,\n        {'dy': '1em', 'x': Bubble.BORDER_WIDTH},\n        parent,\n      );\n      const textNode = document.createTextNode(line);\n      tspan.appendChild(textNode);\n      return tspan;\n    });\n  }\n\n  /** Right aligns the given spans. */\n  private rightAlignSpans(maxWidth: number, spans: SVGTSpanElement[]) {\n    for (const span of spans) {\n      span.setAttribute('text-anchor', 'end');\n      span.setAttribute('x', `${maxWidth + Bubble.BORDER_WIDTH}`);\n    }\n  }\n\n  /** Updates the size of this bubble to account for the size of the text. */\n  private updateBubbleSize() {\n    const bbox = this.paragraph.getBBox();\n    this.setSize(\n      new Size(\n        bbox.width + Bubble.BORDER_WIDTH * 2,\n        bbox.height + Bubble.BORDER_WIDTH * 2,\n      ),\n      true,\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {Bubble} from './bubble.js';\nimport {Coordinate} from '../utils/coordinate.js';\nimport * as Css from '../css.js';\nimport * as dom from '../utils/dom.js';\nimport {Rect} from '../utils/rect.js';\nimport {Size} from '../utils/size.js';\nimport {Svg} from '../utils/svg.js';\nimport * as touch from '../touch.js';\nimport {WorkspaceSvg} from '../workspace_svg.js';\nimport {browserEvents} from '../utils.js';\n\n/**\n * A bubble that displays editable text. It can also be resized by the user.\n * Used by the comment icon.\n */\nexport class TextInputBubble extends Bubble {\n  /** The root of the elements specific to the text element. */\n  private inputRoot: SVGForeignObjectElement;\n\n  /** The text input area element. */\n  private textArea: HTMLTextAreaElement;\n\n  /** The group containing the lines indicating the bubble is resizable. */\n  private resizeGroup: SVGGElement;\n\n  /**\n   * Event data associated with the listener for pointer up events on the\n   * resize group.\n   */\n  private resizePointerUpListener: browserEvents.Data | null = null;\n\n  /**\n   * Event data associated with the listener for pointer move events on the\n   * resize group.\n   */\n  private resizePointerMoveListener: browserEvents.Data | null = null;\n\n  /** Functions listening for changes to the text of this bubble. */\n  private textChangeListeners: (() => void)[] = [];\n\n  /** Functions listening for changes to the size of this bubble. */\n  private sizeChangeListeners: (() => void)[] = [];\n\n  /** The text of this bubble. */\n  private text = '';\n\n  /** The default size of this bubble, including borders. */\n  private readonly DEFAULT_SIZE = new Size(\n    160 + Bubble.DOUBLE_BORDER,\n    80 + Bubble.DOUBLE_BORDER,\n  );\n\n  /** The minimum size of this bubble, including borders. */\n  private readonly MIN_SIZE = new Size(\n    45 + Bubble.DOUBLE_BORDER,\n    20 + Bubble.DOUBLE_BORDER,\n  );\n\n  /**\n   * @param workspace The workspace this bubble belongs to.\n   * @param anchor The anchor location of the thing this bubble is attached to.\n   *     The tail of the bubble will point to this location.\n   * @param ownerRect An optional rect we don't want the bubble to overlap with\n   *     when automatically positioning.\n   */\n  constructor(\n    protected readonly workspace: WorkspaceSvg,\n    protected anchor: Coordinate,\n    protected ownerRect?: Rect,\n  ) {\n    super(workspace, anchor, ownerRect);\n    ({inputRoot: this.inputRoot, textArea: this.textArea} = this.createEditor(\n      this.contentContainer,\n    ));\n    this.resizeGroup = this.createResizeHandle(this.svgRoot);\n    this.setSize(this.DEFAULT_SIZE, true);\n  }\n\n  /** @returns the text of this bubble. */\n  getText(): string {\n    return this.text;\n  }\n\n  /** Sets the text of this bubble. Calls change listeners. */\n  setText(text: string) {\n    this.text = text;\n    this.textArea.value = text;\n    this.onTextChange();\n  }\n\n  /** Adds a change listener to be notified when this bubble's text changes. */\n  addTextChangeListener(listener: () => void) {\n    this.textChangeListeners.push(listener);\n  }\n\n  /** Adds a change listener to be notified when this bubble's size changes. */\n  addSizeChangeListener(listener: () => void) {\n    this.sizeChangeListeners.push(listener);\n  }\n\n  /** Creates the editor UI for this bubble. */\n  private createEditor(container: SVGGElement): {\n    inputRoot: SVGForeignObjectElement;\n    textArea: HTMLTextAreaElement;\n  } {\n    const inputRoot = dom.createSvgElement(\n      Svg.FOREIGNOBJECT,\n      {\n        'x': Bubble.BORDER_WIDTH,\n        'y': Bubble.BORDER_WIDTH,\n      },\n      container,\n    );\n\n    const body = document.createElementNS(dom.HTML_NS, 'body');\n    body.setAttribute('xmlns', dom.HTML_NS);\n    body.className = 'blocklyMinimalBody';\n\n    const textArea = document.createElementNS(\n      dom.HTML_NS,\n      'textarea',\n    ) as HTMLTextAreaElement;\n    textArea.className = 'blocklyCommentTextarea';\n    textArea.setAttribute('dir', this.workspace.RTL ? 'RTL' : 'LTR');\n\n    body.appendChild(textArea);\n    inputRoot.appendChild(body);\n\n    this.bindTextAreaEvents(textArea);\n    setTimeout(() => {\n      textArea.focus();\n    }, 0);\n\n    return {inputRoot, textArea};\n  }\n\n  /** Binds events to the text area element. */\n  private bindTextAreaEvents(textArea: HTMLTextAreaElement) {\n    // Don't zoom with mousewheel.\n    browserEvents.conditionalBind(textArea, 'wheel', this, (e: Event) => {\n      e.stopPropagation();\n    });\n\n    browserEvents.conditionalBind(\n      textArea,\n      'focus',\n      this,\n      this.onStartEdit,\n      true,\n    );\n    browserEvents.conditionalBind(textArea, 'change', this, this.onTextChange);\n  }\n\n  /** Creates the resize handler elements and binds events to them. */\n  private createResizeHandle(container: SVGGElement): SVGGElement {\n    const resizeGroup = dom.createSvgElement(\n      Svg.G,\n      {\n        'class': this.workspace.RTL ? 'blocklyResizeSW' : 'blocklyResizeSE',\n      },\n      container,\n    );\n    const size = 2 * Bubble.BORDER_WIDTH;\n    dom.createSvgElement(\n      Svg.POLYGON,\n      {'points': `0,${size} ${size},${size} ${size},0`},\n      resizeGroup,\n    );\n    dom.createSvgElement(\n      Svg.LINE,\n      {\n        'class': 'blocklyResizeLine',\n        'x1': size / 3,\n        'y1': size - 1,\n        'x2': size - 1,\n        'y2': size / 3,\n      },\n      resizeGroup,\n    );\n    dom.createSvgElement(\n      Svg.LINE,\n      {\n        'class': 'blocklyResizeLine',\n        'x1': (size * 2) / 3,\n        'y1': size - 1,\n        'x2': size - 1,\n        'y2': (size * 2) / 3,\n      },\n      resizeGroup,\n    );\n\n    browserEvents.conditionalBind(\n      resizeGroup,\n      'pointerdown',\n      this,\n      this.onResizePointerDown,\n    );\n\n    return resizeGroup;\n  }\n\n  /**\n   * Sets the size of this bubble, including the border.\n   *\n   * @param size Sets the size of this bubble, including the border.\n   * @param relayout If true, reposition the bubble from scratch so that it is\n   *     optimally visible. If false, reposition it so it maintains the same\n   *     position relative to the anchor.\n   */\n  setSize(size: Size, relayout = false) {\n    size.width = Math.max(size.width, this.MIN_SIZE.width);\n    size.height = Math.max(size.height, this.MIN_SIZE.height);\n\n    const widthMinusBorder = size.width - Bubble.DOUBLE_BORDER;\n    const heightMinusBorder = size.height - Bubble.DOUBLE_BORDER;\n    this.inputRoot.setAttribute('width', `${widthMinusBorder}`);\n    this.inputRoot.setAttribute('height', `${heightMinusBorder}`);\n    this.textArea.style.width = `${widthMinusBorder - 4}px`;\n    this.textArea.style.height = `${heightMinusBorder - 4}px`;\n\n    if (this.workspace.RTL) {\n      this.resizeGroup.setAttribute(\n        'transform',\n        `translate(${Bubble.DOUBLE_BORDER}, ${heightMinusBorder}) scale(-1 1)`,\n      );\n    } else {\n      this.resizeGroup.setAttribute(\n        'transform',\n        `translate(${widthMinusBorder}, ${heightMinusBorder})`,\n      );\n    }\n\n    super.setSize(size, relayout);\n    this.onSizeChange();\n  }\n\n  /** @returns the size of this bubble. */\n  getSize(): Size {\n    // Overriden to be public.\n    return super.getSize();\n  }\n\n  /** Handles mouse down events on the resize target. */\n  private onResizePointerDown(e: PointerEvent) {\n    this.bringToFront();\n    if (browserEvents.isRightButton(e)) {\n      e.stopPropagation();\n      return;\n    }\n\n    this.workspace.startDrag(\n      e,\n      new Coordinate(\n        this.workspace.RTL ? -this.getSize().width : this.getSize().width,\n        this.getSize().height,\n      ),\n    );\n\n    this.resizePointerUpListener = browserEvents.conditionalBind(\n      document,\n      'pointerup',\n      this,\n      this.onResizePointerUp,\n    );\n    this.resizePointerMoveListener = browserEvents.conditionalBind(\n      document,\n      'pointermove',\n      this,\n      this.onResizePointerMove,\n    );\n    this.workspace.hideChaff();\n    // This event has been handled.  No need to bubble up to the document.\n    e.stopPropagation();\n  }\n\n  /** Handles pointer up events on the resize target. */\n  private onResizePointerUp(_e: PointerEvent) {\n    touch.clearTouchIdentifier();\n    if (this.resizePointerUpListener) {\n      browserEvents.unbind(this.resizePointerUpListener);\n      this.resizePointerUpListener = null;\n    }\n    if (this.resizePointerMoveListener) {\n      browserEvents.unbind(this.resizePointerMoveListener);\n      this.resizePointerMoveListener = null;\n    }\n  }\n\n  /** Handles pointer move events on the resize target. */\n  private onResizePointerMove(e: PointerEvent) {\n    const delta = this.workspace.moveDrag(e);\n    this.setSize(\n      new Size(this.workspace.RTL ? -delta.x : delta.x, delta.y),\n      false,\n    );\n    this.onSizeChange();\n  }\n\n  /**\n   * Handles starting an edit of the text area. Brings the bubble to the front.\n   */\n  private onStartEdit() {\n    if (this.bringToFront()) {\n      // Since the act of moving this node within the DOM causes a loss of\n      // focus, we need to reapply the focus.\n      this.textArea.focus();\n    }\n  }\n\n  /** Handles a text change event for the text area. Calls event listeners. */\n  private onTextChange() {\n    this.text = this.textArea.value;\n    for (const listener of this.textChangeListeners) {\n      listener();\n    }\n  }\n\n  /** Handles a size change event for the text area. Calls event listeners. */\n  private onSizeChange() {\n    for (const listener of this.sizeChangeListeners) {\n      listener();\n    }\n  }\n}\n\nCss.register(`\n.blocklyCommentTextarea {\n  background-color: #fef49c;\n  border: 0;\n  display: block;\n  margin: 0;\n  outline: 0;\n  padding: 3px;\n  resize: none;\n  text-overflow: hidden;\n}\n`);\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.Comment\n\nimport type {Block} from '../block.js';\nimport type {BlockSvg} from '../block_svg.js';\nimport {IconType} from './icon_types.js';\nimport {Coordinate} from '../utils.js';\nimport * as dom from '../utils/dom.js';\nimport * as eventUtils from '../events/utils.js';\nimport {Icon} from './icon.js';\nimport type {IHasBubble} from '../interfaces/i_has_bubble.js';\nimport type {ISerializable} from '../interfaces/i_serializable.js';\nimport {Rect} from '../utils/rect.js';\nimport * as registry from './registry.js';\nimport {Size} from '../utils/size.js';\nimport {Svg} from '../utils/svg.js';\nimport {TextBubble} from '../bubbles/text_bubble.js';\nimport {TextInputBubble} from '../bubbles/textinput_bubble.js';\nimport type {WorkspaceSvg} from '../workspace_svg.js';\n\n/** The size of the comment icon in workspace-scale units. */\nconst SIZE = 17;\n\n/** The default width in workspace-scale units of the text input bubble. */\nconst DEFAULT_BUBBLE_WIDTH = 160;\n\n/** The default height in workspace-scale units of the text input bubble. */\nconst DEFAULT_BUBBLE_HEIGHT = 80;\n\n/**\n * An icon which allows the user to add comment text to a block.\n */\nexport class CommentIcon extends Icon implements IHasBubble, ISerializable {\n  /** The type string used to identify this icon. */\n  static readonly TYPE = IconType.COMMENT;\n\n  /**\n   * The weight this icon has relative to other icons. Icons with more positive\n   * weight values are rendered farther toward the end of the block.\n   */\n  static readonly WEIGHT = 3;\n\n  /** The bubble used to show editable text to the user. */\n  private textInputBubble: TextInputBubble | null = null;\n\n  /** The bubble used to show non-editable text to the user. */\n  private textBubble: TextBubble | null = null;\n\n  /** The text of this comment. */\n  private text = '';\n\n  /** The size of this comment (which is applied to the editable bubble). */\n  private bubbleSize = new Size(DEFAULT_BUBBLE_WIDTH, DEFAULT_BUBBLE_HEIGHT);\n\n  /**\n   * The visibility of the bubble for this comment.\n   *\n   * This is used to track what the visibile state /should/ be, not necessarily\n   * what it currently /is/. E.g. sometimes this will be true, but the block\n   * hasn't been rendered yet, so the bubble will not currently be visible.\n   */\n  private bubbleVisiblity = false;\n\n  constructor(protected readonly sourceBlock: Block) {\n    super(sourceBlock);\n  }\n\n  override getType(): IconType<CommentIcon> {\n    return CommentIcon.TYPE;\n  }\n\n  override initView(pointerdownListener: (e: PointerEvent) => void): void {\n    if (this.svgRoot) return; // Already initialized.\n\n    super.initView(pointerdownListener);\n\n    // Circle.\n    dom.createSvgElement(\n      Svg.CIRCLE,\n      {'class': 'blocklyIconShape', 'r': '8', 'cx': '8', 'cy': '8'},\n      this.svgRoot,\n    );\n    // Can't use a real '?' text character since different browsers and\n    // operating systems render it differently. Body of question mark.\n    dom.createSvgElement(\n      Svg.PATH,\n      {\n        'class': 'blocklyIconSymbol',\n        'd':\n          'm6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.405' +\n          '0.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25' +\n          '-1.201,0.998 -1.201,1.528 -1.204,2.19z',\n      },\n      this.svgRoot,\n    );\n    // Dot of question mark.\n    dom.createSvgElement(\n      Svg.RECT,\n      {\n        'class': 'blocklyIconSymbol',\n        'x': '6.8',\n        'y': '10.78',\n        'height': '2',\n        'width': '2',\n      },\n      this.svgRoot,\n    );\n    dom.addClass(this.svgRoot!, 'blockly-icon-comment');\n  }\n\n  override dispose() {\n    super.dispose();\n    this.textInputBubble?.dispose();\n    this.textBubble?.dispose();\n  }\n\n  override getWeight(): number {\n    return CommentIcon.WEIGHT;\n  }\n\n  override getSize(): Size {\n    return new Size(SIZE, SIZE);\n  }\n\n  override applyColour(): void {\n    super.applyColour();\n    const colour = (this.sourceBlock as BlockSvg).style.colourPrimary;\n    this.textInputBubble?.setColour(colour);\n    this.textBubble?.setColour(colour);\n  }\n\n  /**\n   * Updates the state of the bubble (editable / noneditable) to reflect the\n   * state of the bubble if the bubble is currently shown.\n   */\n  override updateEditable(): void {\n    super.updateEditable();\n    if (this.bubbleIsVisible()) {\n      // Close and reopen the bubble to display the correct UI.\n      this.setBubbleVisible(false);\n      this.setBubbleVisible(true);\n    }\n  }\n\n  override onLocationChange(blockOrigin: Coordinate): void {\n    super.onLocationChange(blockOrigin);\n    const anchorLocation = this.getAnchorLocation();\n    this.textInputBubble?.setAnchorLocation(anchorLocation);\n    this.textBubble?.setAnchorLocation(anchorLocation);\n  }\n\n  /** Sets the text of this comment. Updates any bubbles if they are visible. */\n  setText(text: string) {\n    const oldText = this.text;\n    eventUtils.fire(\n      new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n        this.sourceBlock,\n        'comment',\n        null,\n        oldText,\n        text,\n      ),\n    );\n    this.text = text;\n    this.textInputBubble?.setText(this.text);\n    this.textBubble?.setText(this.text);\n  }\n\n  /** Returns the text of this comment. */\n  getText(): string {\n    return this.text;\n  }\n\n  /**\n   * Sets the size of the editable bubble for this comment. Resizes the\n   * bubble if it is visible.\n   */\n  setBubbleSize(size: Size) {\n    this.bubbleSize = size;\n    this.textInputBubble?.setSize(this.bubbleSize, true);\n  }\n\n  /** @returns the size of the editable bubble for this comment. */\n  getBubbleSize(): Size {\n    return this.bubbleSize;\n  }\n\n  /**\n   * @returns the state of the comment as a JSON serializable value if the\n   * comment has text. Otherwise returns null.\n   */\n  saveState(): CommentState | null {\n    if (this.text) {\n      return {\n        'text': this.text,\n        'pinned': this.bubbleIsVisible(),\n        'height': this.bubbleSize.height,\n        'width': this.bubbleSize.width,\n      };\n    }\n    return null;\n  }\n\n  /** Applies the given state to this comment. */\n  loadState(state: CommentState) {\n    this.text = state['text'] ?? '';\n    this.bubbleSize = new Size(\n      state['width'] ?? DEFAULT_BUBBLE_WIDTH,\n      state['height'] ?? DEFAULT_BUBBLE_HEIGHT,\n    );\n    this.bubbleVisiblity = state['pinned'] ?? false;\n    // Give the block a chance to be positioned and rendered before showing.\n    setTimeout(() => this.setBubbleVisible(this.bubbleVisiblity), 1);\n  }\n\n  override onClick(): void {\n    super.onClick();\n    this.setBubbleVisible(!this.bubbleIsVisible());\n  }\n\n  override isClickableInFlyout(): boolean {\n    return false;\n  }\n\n  /**\n   * Updates the text of this comment in response to changes in the text of\n   * the input bubble.\n   */\n  onTextChange(): void {\n    if (!this.textInputBubble) return;\n\n    const newText = this.textInputBubble.getText();\n    if (this.text === newText) return;\n\n    eventUtils.fire(\n      new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n        this.sourceBlock,\n        'comment',\n        null,\n        this.text,\n        newText,\n      ),\n    );\n    this.text = newText;\n  }\n\n  /**\n   * Updates the size of this icon in response to changes in the size of the\n   * input bubble.\n   */\n  onSizeChange(): void {\n    if (this.textInputBubble) {\n      this.bubbleSize = this.textInputBubble.getSize();\n    }\n  }\n\n  bubbleIsVisible(): boolean {\n    return this.bubbleVisiblity;\n  }\n\n  setBubbleVisible(visible: boolean): void {\n    if (visible && (this.textBubble || this.textInputBubble)) return;\n    if (!visible && !(this.textBubble || this.textInputBubble)) return;\n\n    this.bubbleVisiblity = visible;\n\n    if (!this.sourceBlock.rendered || this.sourceBlock.isInFlyout) return;\n\n    if (visible) {\n      if (this.sourceBlock.isEditable()) {\n        this.showEditableBubble();\n      } else {\n        this.showNonEditableBubble();\n      }\n      this.applyColour();\n    } else {\n      this.hideBubble();\n    }\n\n    eventUtils.fire(\n      new (eventUtils.get(eventUtils.BUBBLE_OPEN))(\n        this.sourceBlock,\n        visible,\n        'comment',\n      ),\n    );\n  }\n\n  /**\n   * Shows the editable text bubble for this comment, and adds change listeners\n   * to update the state of this icon in response to changes in the bubble.\n   */\n  private showEditableBubble() {\n    this.textInputBubble = new TextInputBubble(\n      this.sourceBlock.workspace as WorkspaceSvg,\n      this.getAnchorLocation(),\n      this.getBubbleOwnerRect(),\n    );\n    this.textInputBubble.setText(this.getText());\n    this.textInputBubble.setSize(this.bubbleSize, true);\n    this.textInputBubble.addTextChangeListener(() => this.onTextChange());\n    this.textInputBubble.addSizeChangeListener(() => this.onSizeChange());\n  }\n\n  /** Shows the non editable text bubble for this comment. */\n  private showNonEditableBubble() {\n    this.textBubble = new TextBubble(\n      this.getText(),\n      this.sourceBlock.workspace as WorkspaceSvg,\n      this.getAnchorLocation(),\n      this.getBubbleOwnerRect(),\n    );\n  }\n\n  /** Hides any open bubbles owned by this comment. */\n  private hideBubble() {\n    this.textInputBubble?.dispose();\n    this.textInputBubble = null;\n    this.textBubble?.dispose();\n    this.textBubble = null;\n  }\n\n  /**\n   * @returns the location the bubble should be anchored to.\n   *     I.E. the middle of this icon.\n   */\n  private getAnchorLocation(): Coordinate {\n    const midIcon = SIZE / 2;\n    return Coordinate.sum(\n      this.workspaceLocation,\n      new Coordinate(midIcon, midIcon),\n    );\n  }\n\n  /**\n   * @returns the rect the bubble should avoid overlapping.\n   *     I.E. the block that owns this icon.\n   */\n  private getBubbleOwnerRect(): Rect {\n    const bbox = (this.sourceBlock as BlockSvg).getSvgRoot().getBBox();\n    return new Rect(bbox.y, bbox.y + bbox.height, bbox.x, bbox.x + bbox.width);\n  }\n}\n\nexport interface CommentState {\n  text?: string;\n  pinned?: boolean;\n  height?: number;\n  width?: number;\n}\n\nregistry.register(CommentIcon.TYPE, CommentIcon);\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.Warning\n\nimport type {BlockSvg} from '../block_svg.js';\nimport {Coordinate} from '../utils/coordinate.js';\nimport * as dom from '../utils/dom.js';\nimport * as eventUtils from '../events/utils.js';\nimport {Icon} from './icon.js';\nimport type {IHasBubble} from '../interfaces/i_has_bubble.js';\nimport {Rect} from '../utils/rect.js';\nimport {Size} from '../utils.js';\nimport {Svg} from '../utils/svg.js';\nimport {TextBubble} from '../bubbles/text_bubble.js';\nimport {IconType} from './icon_types.js';\n\n/** The size of the warning icon in workspace-scale units. */\nconst SIZE = 17;\n\n/**\n * An icon that warns the user that something is wrong with their block.\n *\n * For example, this could be used to warn them about incorrect field values,\n * or incorrect placement of the block (putting it somewhere it doesn't belong).\n */\nexport class WarningIcon extends Icon implements IHasBubble {\n  /** The type string used to identify this icon. */\n  static readonly TYPE = IconType.WARNING;\n\n  /**\n   * The weight this icon has relative to other icons. Icons with more positive\n   * weight values are rendered farther toward the end of the block.\n   */\n  static readonly WEIGHT = 2;\n\n  /** A map of warning IDs to warning text. */\n  private textMap: Map<string, string> = new Map();\n\n  /** The bubble used to display the warnings to the user. */\n  private textBubble: TextBubble | null = null;\n\n  /** @internal */\n  constructor(protected readonly sourceBlock: BlockSvg) {\n    super(sourceBlock);\n  }\n\n  override getType(): IconType<WarningIcon> {\n    return WarningIcon.TYPE;\n  }\n\n  override initView(pointerdownListener: (e: PointerEvent) => void): void {\n    if (this.svgRoot) return; // Already initialized.\n\n    super.initView(pointerdownListener);\n\n    // Triangle with rounded corners.\n    dom.createSvgElement(\n      Svg.PATH,\n      {\n        'class': 'blocklyIconShape',\n        'd': 'M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z',\n      },\n      this.svgRoot,\n    );\n    // Can't use a real '!' text character since different browsers and\n    // operating systems render it differently. Body of exclamation point.\n    dom.createSvgElement(\n      Svg.PATH,\n      {\n        'class': 'blocklyIconSymbol',\n        'd': 'm7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z',\n      },\n      this.svgRoot,\n    );\n    // Dot of exclamation point.\n    dom.createSvgElement(\n      Svg.RECT,\n      {\n        'class': 'blocklyIconSymbol',\n        'x': '7',\n        'y': '11',\n        'height': '2',\n        'width': '2',\n      },\n      this.svgRoot,\n    );\n    dom.addClass(this.svgRoot!, 'blockly-icon-warning');\n  }\n\n  override dispose() {\n    super.dispose();\n    this.textBubble?.dispose();\n  }\n\n  override getWeight(): number {\n    return WarningIcon.WEIGHT;\n  }\n\n  override getSize(): Size {\n    return new Size(SIZE, SIZE);\n  }\n\n  override applyColour(): void {\n    super.applyColour();\n    this.textBubble?.setColour(this.sourceBlock.style.colourPrimary);\n  }\n\n  override updateCollapsed(): void {\n    // We are shown when collapsed, so do nothing! I.e. skip the default\n    // behavior of hiding.\n  }\n\n  /** Tells blockly that this icon is shown when the block is collapsed. */\n  override isShownWhenCollapsed(): boolean {\n    return true;\n  }\n\n  /** Updates the location of the icon's bubble if it is open. */\n  override onLocationChange(blockOrigin: Coordinate): void {\n    super.onLocationChange(blockOrigin);\n    this.textBubble?.setAnchorLocation(this.getAnchorLocation());\n  }\n\n  /**\n   * Adds a warning message to this warning icon.\n   *\n   * @param text The text of the message to add.\n   * @param id The id of the message to add.\n   * @internal\n   */\n  addMessage(text: string, id: string): this {\n    if (this.textMap.get(id) === text) return this;\n\n    if (text) {\n      this.textMap.set(id, text);\n    } else {\n      this.textMap.delete(id);\n    }\n\n    this.textBubble?.setText(this.getText());\n    return this;\n  }\n\n  /**\n   * @returns the display text for this icon. Includes all warning messages\n   *     concatenated together with newlines.\n   * @internal\n   */\n  getText(): string {\n    return [...this.textMap.values()].join('\\n');\n  }\n\n  /** Toggles the visibility of the bubble. */\n  override onClick(): void {\n    super.onClick();\n    this.setBubbleVisible(!this.bubbleIsVisible());\n  }\n\n  override isClickableInFlyout(): boolean {\n    return false;\n  }\n\n  bubbleIsVisible(): boolean {\n    return !!this.textBubble;\n  }\n\n  setBubbleVisible(visible: boolean): void {\n    if (this.bubbleIsVisible() === visible) return;\n\n    if (visible) {\n      this.textBubble = new TextBubble(\n        this.getText(),\n        this.sourceBlock.workspace,\n        this.getAnchorLocation(),\n        this.getBubbleOwnerRect(),\n      );\n      this.applyColour();\n    } else {\n      this.textBubble?.dispose();\n      this.textBubble = null;\n    }\n\n    eventUtils.fire(\n      new (eventUtils.get(eventUtils.BUBBLE_OPEN))(\n        this.sourceBlock,\n        visible,\n        'warning',\n      ),\n    );\n  }\n\n  /**\n   * @returns the location the bubble should be anchored to.\n   *     I.E. the middle of this icon.\n   */\n  private getAnchorLocation(): Coordinate {\n    const midIcon = SIZE / 2;\n    return Coordinate.sum(\n      this.workspaceLocation,\n      new Coordinate(midIcon, midIcon),\n    );\n  }\n\n  /**\n   * @returns the rect the bubble should avoid overlapping.\n   *     I.E. the block that owns this icon.\n   */\n  private getBubbleOwnerRect(): Rect {\n    const bbox = this.sourceBlock.getSvgRoot().getBBox();\n    return new Rect(bbox.y, bbox.y + bbox.height, bbox.x, bbox.x + bbox.width);\n  }\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {IIcon} from '../interfaces/i_icon.js';\n\n/**\n * Thrown when you add more than one icon of the same type to a block.\n */\nexport class DuplicateIconType extends Error {\n  /**\n   * @internal\n   */\n  constructor(public icon: IIcon) {\n    super(\n      `Tried to append an icon of type ${icon.getType()} when an icon of ` +\n        `that type already exists on the block. ` +\n        `Use getIcon to access the existing icon.`,\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {Icon} from './icons/icon.js';\nimport {CommentIcon, CommentState} from './icons/comment_icon.js';\nimport {MutatorIcon} from './icons/mutator_icon.js';\nimport {WarningIcon} from './icons/warning_icon.js';\nimport {IconType} from './icons/icon_types.js';\nimport * as exceptions from './icons/exceptions.js';\nimport * as registry from './icons/registry.js';\n\nexport {\n  Icon,\n  CommentIcon,\n  CommentState,\n  MutatorIcon,\n  WarningIcon,\n  IconType,\n  exceptions,\n  registry,\n};\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.Types\n\nimport type {Measurable} from './base.js';\nimport type {Row} from './row.js';\n\n/**\n * Types of rendering elements.\n */\nclass TypesContainer {\n  [index: string]: number | Function;\n\n  NONE = 0; // None\n  FIELD = 1 << 0; // Field.\n  HAT = 1 << 1; // Hat.\n  ICON = 1 << 2; // Icon.\n  SPACER = 1 << 3; // Spacer.\n  BETWEEN_ROW_SPACER = 1 << 4; // Between Row Spacer.\n  IN_ROW_SPACER = 1 << 5; // In Row Spacer.\n  EXTERNAL_VALUE_INPUT = 1 << 6; // External Value Input.\n  INPUT = 1 << 7; // Input.\n  INLINE_INPUT = 1 << 8; // Inline Input.\n  STATEMENT_INPUT = 1 << 9; // Statement Input.\n  CONNECTION = 1 << 10; // Connection.\n  PREVIOUS_CONNECTION = 1 << 11; // Previous Connection.\n  NEXT_CONNECTION = 1 << 12; // Next Connection.\n  OUTPUT_CONNECTION = 1 << 13; // Output Connection.\n  CORNER = 1 << 14; // Corner.\n  LEFT_SQUARE_CORNER = 1 << 15; // Square Corner.\n  LEFT_ROUND_CORNER = 1 << 16; // Round Corner.\n  RIGHT_SQUARE_CORNER = 1 << 17; // Right Square Corner.\n  RIGHT_ROUND_CORNER = 1 << 18; // Right Round Corner.\n  JAGGED_EDGE = 1 << 19; // Jagged Edge.\n  ROW = 1 << 20; // Row.\n  TOP_ROW = 1 << 21; // Top Row.\n  BOTTOM_ROW = 1 << 22; // Bottom Row.\n  INPUT_ROW = 1 << 23; // Input Row.\n\n  /**\n   * A Left Corner Union Type.\n   */\n  LEFT_CORNER = this.LEFT_SQUARE_CORNER | this.LEFT_ROUND_CORNER;\n\n  /**\n   * A Right Corner Union Type.\n   */\n  RIGHT_CORNER = this.RIGHT_SQUARE_CORNER | this.RIGHT_ROUND_CORNER;\n\n  /**\n   * Next flag value to use for custom rendering element types.\n   * This must be updated to reflect the next enum flag value\n   * to use if additional elements are added to\n   * `Types`.\n   */\n  nextTypeValue_ = 1 << 24;\n\n  /**\n   * Get the enum flag value of an existing type or register a new type.\n   *\n   * @param type The name of the type.\n   * @returns The enum flag value associated with that type.\n   */\n  getType(type: string): number {\n    if (!Object.prototype.hasOwnProperty.call(this, type)) {\n      this[type] = this.nextTypeValue_;\n      this.nextTypeValue_ <<= 1;\n    }\n    return this[type] as number;\n  }\n\n  /**\n   * Whether a measurable stores information about a field.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a field.\n   */\n  isField(elem: Measurable): number {\n    return elem.type & this.FIELD;\n  }\n\n  /**\n   * Whether a measurable stores information about a hat.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a hat.\n   */\n  isHat(elem: Measurable): number {\n    return elem.type & this.HAT;\n  }\n\n  /**\n   * Whether a measurable stores information about an icon.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about an icon.\n   */\n  isIcon(elem: Measurable): number {\n    return elem.type & this.ICON;\n  }\n\n  /**\n   * Whether a measurable stores information about a spacer.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a spacer.\n   */\n  isSpacer(elem: Measurable | Row): number {\n    return elem.type & this.SPACER;\n  }\n\n  /**\n   * Whether a measurable stores information about an in-row spacer.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about an in-row spacer.\n   */\n  isInRowSpacer(elem: Measurable): number {\n    return elem.type & this.IN_ROW_SPACER;\n  }\n\n  /**\n   * Whether a measurable stores information about an input.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about an input.\n   */\n  isInput(elem: Measurable): number {\n    return elem.type & this.INPUT;\n  }\n\n  /**\n   * Whether a measurable stores information about an external input.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about an external input.\n   */\n  isExternalInput(elem: Measurable): number {\n    return elem.type & this.EXTERNAL_VALUE_INPUT;\n  }\n\n  /**\n   * Whether a measurable stores information about an inline input.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about an inline input.\n   */\n  isInlineInput(elem: Measurable): number {\n    return elem.type & this.INLINE_INPUT;\n  }\n\n  /**\n   * Whether a measurable stores information about a statement input.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a statement input.\n   */\n  isStatementInput(elem: Measurable): number {\n    return elem.type & this.STATEMENT_INPUT;\n  }\n\n  /**\n   * Whether a measurable stores information about a previous connection.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a previous connection.\n   */\n  isPreviousConnection(elem: Measurable): number {\n    return elem.type & this.PREVIOUS_CONNECTION;\n  }\n\n  /**\n   * Whether a measurable stores information about a next connection.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a next connection.\n   */\n  isNextConnection(elem: Measurable): number {\n    return elem.type & this.NEXT_CONNECTION;\n  }\n\n  /**\n   * Whether a measurable stores information about a previous or next\n   * connection.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a previous or next\n   *     connection.\n   */\n  isPreviousOrNextConnection(elem: Measurable): number {\n    return elem.type & (this.PREVIOUS_CONNECTION | this.NEXT_CONNECTION);\n  }\n\n  /**\n   * Whether a measurable stores information about a left round corner.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a left round corner.\n   */\n  isLeftRoundedCorner(elem: Measurable): number {\n    return elem.type & this.LEFT_ROUND_CORNER;\n  }\n\n  /**\n   * Whether a measurable stores information about a right round corner.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a right round corner.\n   */\n  isRightRoundedCorner(elem: Measurable): number {\n    return elem.type & this.RIGHT_ROUND_CORNER;\n  }\n\n  /**\n   * Whether a measurable stores information about a left square corner.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a left square corner.\n   */\n  isLeftSquareCorner(elem: Measurable): number {\n    return elem.type & this.LEFT_SQUARE_CORNER;\n  }\n\n  /**\n   * Whether a measurable stores information about a right square corner.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a right square corner.\n   */\n  isRightSquareCorner(elem: Measurable): number {\n    return elem.type & this.RIGHT_SQUARE_CORNER;\n  }\n\n  /**\n   * Whether a measurable stores information about a corner.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a corner.\n   */\n  isCorner(elem: Measurable): number {\n    return elem.type & this.CORNER;\n  }\n\n  /**\n   * Whether a measurable stores information about a jagged edge.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a jagged edge.\n   */\n  isJaggedEdge(elem: Measurable): number {\n    return elem.type & this.JAGGED_EDGE;\n  }\n\n  /**\n   * Whether a measurable stores information about a row.\n   *\n   * @param row The row to check.\n   * @returns 1 if the object stores information about a row.\n   */\n  isRow(row: Row): number {\n    return row.type & this.ROW;\n  }\n\n  /**\n   * Whether a measurable stores information about a between-row spacer.\n   *\n   * @param row The row to check.\n   * @returns 1 if the object stores information about a between-row spacer.\n   */\n  isBetweenRowSpacer(row: Row): number {\n    return row.type & this.BETWEEN_ROW_SPACER;\n  }\n\n  /**\n   * Whether a measurable stores information about a top row.\n   *\n   * @param row The row to check.\n   * @returns 1 if the object stores information about a top row.\n   */\n  isTopRow(row: Row): number {\n    return row.type & this.TOP_ROW;\n  }\n\n  /**\n   * Whether a measurable stores information about a bottom row.\n   *\n   * @param row The row to check.\n   * @returns 1 if the object stores information about a bottom row.\n   */\n  isBottomRow(row: Row): number {\n    return row.type & this.BOTTOM_ROW;\n  }\n\n  /**\n   * Whether a measurable stores information about a top or bottom row.\n   *\n   * @param row The row to check.\n   * @returns 1 if the object stores information about a top or bottom row.\n   */\n  isTopOrBottomRow(row: Row): number {\n    return row.type & (this.TOP_ROW | this.BOTTOM_ROW);\n  }\n\n  /**\n   * Whether a measurable stores information about an input row.\n   *\n   * @param row The row to check.\n   * @returns 1 if the object stores information about an input row.\n   */\n  isInputRow(row: Row): number {\n    return row.type & this.INPUT_ROW;\n  }\n}\n\nexport const Types = new TypesContainer();\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.Measurable\n\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Types} from './types.js';\n\n/**\n * The base class to represent a part of a block that takes up space during\n * rendering.  The constructor for each non-spacer Measurable records the size\n * of the block element (e.g. field, statement input).\n */\nexport class Measurable {\n  width = 0;\n\n  height = 0;\n  type: number;\n  xPos = 0;\n\n  centerline = 0;\n  notchOffset: number;\n\n  /** The renderer's constant provider. */\n  protected readonly constants_: ConstantProvider;\n\n  /**\n   * @param constants The rendering constants provider.\n   */\n  constructor(constants: ConstantProvider) {\n    this.constants_ = constants;\n\n    this.type = Types.NONE;\n\n    this.notchOffset = this.constants_.NOTCH_OFFSET_LEFT;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.Row\n\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport type {Measurable} from './base.js';\nimport type {InRowSpacer} from './in_row_spacer.js';\nimport type {InputConnection} from './input_connection.js';\nimport {Types} from './types.js';\n\n/**\n * An object representing a single row on a rendered block and all of its\n * subcomponents.\n */\nexport class Row {\n  type: number;\n\n  /**\n   * An array of elements contained in this row.\n   */\n  elements: Measurable[] = [];\n\n  /**\n   * The height of the row.\n   */\n  height = 0;\n\n  /**\n   * The width of the row, from the left edge of the block to the right.\n   * Does not include child blocks unless they are inline.\n   */\n  width = 0;\n\n  /**\n   * The minimum height of the row.\n   */\n  minHeight = 0;\n\n  /**\n   * The minimum width of the row, from the left edge of the block to the\n   * right. Does not include child blocks unless they are inline.\n   */\n  minWidth = 0;\n\n  /**\n   * The width of the row, from the left edge of the block to the edge of the\n   * block or any connected child blocks.\n   */\n  widthWithConnectedBlocks = 0;\n\n  /**\n   * The Y position of the row relative to the origin of the block's svg\n   * group.\n   */\n  yPos = 0;\n\n  /**\n   * The X position of the row relative to the origin of the block's svg\n   * group.\n   */\n  xPos = 0;\n\n  /**\n   * Whether the row has any external inputs.\n   */\n  hasExternalInput = false;\n\n  /**\n   * Whether the row has any statement inputs.\n   */\n  hasStatement = false;\n\n  /**\n   * Where the left edge of all of the statement inputs on the block should\n   * be. This makes sure that statement inputs which are proceded by fields\n   * of varius widths are all aligned.\n   */\n  statementEdge = 0;\n\n  /**\n   * Whether the row has any inline inputs.\n   */\n  hasInlineInput = false;\n\n  /**\n   * Whether the row has any dummy inputs or end-row inputs.\n   */\n  hasDummyInput = false;\n\n  /**\n   * Whether the row has a jagged edge.\n   */\n  hasJaggedEdge = false;\n  notchOffset: number;\n\n  /**\n   * Alignment of the row.\n   */\n  align: number | null = null;\n\n  protected readonly constants_: ConstantProvider;\n\n  /**\n   * @param constants The rendering constants provider.\n   */\n  constructor(constants: ConstantProvider) {\n    /** The renderer's constant provider. */\n    this.constants_ = constants;\n\n    /** The type of this rendering object. */\n    this.type = Types.ROW;\n\n    this.notchOffset = this.constants_.NOTCH_OFFSET_LEFT;\n  }\n\n  /**\n   * Get the last input on this row, if it has one.\n   *\n   * @returns The last input on the row, or null.\n   */\n  getLastInput(): InputConnection | null {\n    // TODO: Consider moving this to InputRow, if possible.\n    for (let i = this.elements.length - 1; i >= 0; i--) {\n      const elem = this.elements[i];\n      if (Types.isInput(elem)) {\n        return elem as InputConnection;\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Inspect all subcomponents and populate all size properties on the row.\n   */\n  measure() {\n    throw Error('Unexpected attempt to measure a base Row.');\n  }\n\n  /**\n   * Determines whether this row should start with an element spacer.\n   *\n   * @returns Whether the row should start with a spacer.\n   */\n  startsWithElemSpacer(): boolean {\n    return true;\n  }\n\n  /**\n   * Determines whether this row should end with an element spacer.\n   *\n   * @returns Whether the row should end with a spacer.\n   */\n  endsWithElemSpacer(): boolean {\n    return true;\n  }\n\n  /**\n   * Convenience method to get the first spacer element on this row.\n   *\n   * @returns The first spacer element on this row.\n   */\n  getFirstSpacer(): InRowSpacer | null {\n    for (let i = 0; i < this.elements.length; i++) {\n      const elem = this.elements[i];\n      if (Types.isSpacer(elem)) {\n        return elem as InRowSpacer;\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Convenience method to get the last spacer element on this row.\n   *\n   * @returns The last spacer element on this row.\n   */\n  getLastSpacer(): InRowSpacer | null {\n    for (let i = this.elements.length - 1; i >= 0; i--) {\n      const elem = this.elements[i];\n      if (Types.isSpacer(elem)) {\n        return elem as InRowSpacer;\n      }\n    }\n    return null;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.BottomRow\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport type {NextConnection} from './next_connection.js';\nimport {Row} from './row.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about what elements are in the bottom row of\n * a block as well as spacing information for the bottom row.\n * Elements in a bottom row can consist of corners, spacers and next\n * connections.\n */\nexport class BottomRow extends Row {\n  /**\n   * Whether this row has a next connection.\n   */\n  hasNextConnection = false;\n\n  /**\n   * The next connection on the row, if any.\n   */\n  connection: NextConnection | null = null;\n\n  /**\n   * The amount that the bottom of the block extends below the horizontal\n   * edge, e.g. because of a next connection.  Must be non-negative (see\n   * #2820).\n   */\n  descenderHeight = 0;\n\n  /**\n   * The Y position of the bottom edge of the block, relative to the origin\n   * of the block rendering.\n   */\n  baseline = 0;\n\n  /**\n   * @param constants The rendering constants provider.\n   */\n  constructor(constants: ConstantProvider) {\n    super(constants);\n    this.type |= Types.BOTTOM_ROW;\n  }\n\n  /**\n   * Returns whether or not the bottom row has a left square corner.\n   *\n   * @param block The block whose bottom row this represents.\n   * @returns Whether or not the bottom row has a left square corner.\n   */\n  hasLeftSquareCorner(block: BlockSvg): boolean {\n    return !!block.outputConnection || !!block.getNextBlock();\n  }\n\n  /**\n   * Returns whether or not the bottom row has a right square corner.\n   *\n   * @param _block The block whose bottom row this represents.\n   * @returns Whether or not the bottom row has a right square corner.\n   */\n  hasRightSquareCorner(_block: BlockSvg): boolean {\n    return true;\n  }\n\n  override measure() {\n    let height = 0;\n    let width = 0;\n    let descenderHeight = 0;\n    for (let i = 0; i < this.elements.length; i++) {\n      const elem = this.elements[i];\n      width += elem.width;\n      if (!Types.isSpacer(elem)) {\n        // Note: this assumes that next connections have *only* descenderHeight,\n        // with no height above the baseline.\n        if (Types.isNextConnection(elem)) {\n          descenderHeight = Math.max(descenderHeight, elem.height);\n        } else {\n          height = Math.max(height, elem.height);\n        }\n      }\n    }\n    this.width = Math.max(this.minWidth, width);\n    this.height = Math.max(this.minHeight, height) + descenderHeight;\n    this.descenderHeight = descenderHeight;\n    this.widthWithConnectedBlocks = this.width;\n  }\n\n  override startsWithElemSpacer() {\n    return false;\n  }\n\n  override endsWithElemSpacer() {\n    return false;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.Connection\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {ConstantProvider, Shape} from '../common/constants.js';\n\nimport {Measurable} from './base.js';\nimport {Types} from './types.js';\n\n/**\n * The base class to represent a connection and the space that it takes up on\n * the block.\n */\nexport class Connection extends Measurable {\n  shape: Shape;\n  isDynamicShape: boolean;\n  highlighted: boolean;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param connectionModel The connection object on the block that this\n   *     represents.\n   */\n  constructor(\n    constants: ConstantProvider,\n    public connectionModel: RenderedConnection,\n  ) {\n    super(constants);\n\n    this.type |= Types.CONNECTION;\n\n    this.shape = this.constants_.shapeFor(connectionModel);\n    this.isDynamicShape = 'isDynamic' in this.shape && this.shape.isDynamic;\n\n    this.highlighted = connectionModel.isHighlighted();\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.InputConnection\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {Input} from '../../inputs/input.js';\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Connection} from './connection.js';\nimport {Types} from './types.js';\n\n/**\n * The base class to represent an input that takes up space on a block\n * during rendering.\n */\nexport class InputConnection extends Connection {\n  align: number;\n  connectedBlock: BlockSvg | null;\n  connectedBlockWidth: number;\n  connectedBlockHeight: number;\n  connectionOffsetX = 0;\n  connectionOffsetY = 0;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param input The input to measure and store information for.\n   */\n  constructor(\n    constants: ConstantProvider,\n    public input: Input,\n  ) {\n    super(constants, input.connection as RenderedConnection);\n\n    this.type |= Types.INPUT;\n\n    this.align = input.align;\n\n    this.connectedBlock =\n      input.connection && input.connection.targetBlock()\n        ? (input.connection.targetBlock() as BlockSvg)\n        : null;\n\n    if (this.connectedBlock) {\n      const bBox = this.connectedBlock.getHeightWidth();\n      this.connectedBlockWidth = bBox.width;\n      this.connectedBlockHeight = bBox.height;\n    } else {\n      this.connectedBlockWidth = 0;\n      this.connectedBlockHeight = 0;\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.ExternalValueInput\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {Input} from '../../inputs/input.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {InputConnection} from './input_connection.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about the space an external value input\n * takes up during rendering\n */\nexport class ExternalValueInput extends InputConnection {\n  override height = 0;\n  override width: number;\n  override connectionOffsetY: number;\n  connectionHeight: number;\n  connectionWidth: number;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param input The external value input to measure and store information for.\n   */\n  constructor(constants: ConstantProvider, input: Input) {\n    super(constants, input);\n    this.type |= Types.EXTERNAL_VALUE_INPUT;\n    if (!this.connectedBlock) {\n      this.height = this.shape.height as number;\n    } else {\n      this.height =\n        this.connectedBlockHeight -\n        this.constants_.TAB_OFFSET_FROM_TOP -\n        this.constants_.MEDIUM_PADDING;\n    }\n\n    this.width =\n      (this.shape.width as number) +\n      this.constants_.EXTERNAL_VALUE_INPUT_PADDING;\n\n    this.connectionOffsetY = this.constants_.TAB_OFFSET_FROM_TOP;\n\n    this.connectionHeight = this.shape.height as number;\n\n    this.connectionWidth = this.shape.width as number;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.Field\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {Field as BlocklyField} from '../../field.js';\nimport type {Input} from '../../inputs/input.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Measurable} from './base.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about the space a field takes up during\n * rendering\n */\nexport class Field extends Measurable {\n  isEditable: boolean;\n  flipRtl: boolean;\n  override height: number;\n  override width: number;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param field The field to measure and store information for.\n   * @param parentInput The parent input for the field.\n   */\n  constructor(\n    constants: ConstantProvider,\n    public field: BlocklyField,\n    public parentInput: Input,\n  ) {\n    super(constants);\n\n    this.isEditable = field.EDITABLE;\n\n    this.flipRtl = field.getFlipRtl();\n    this.type |= Types.FIELD;\n\n    const size = this.field.getSize();\n\n    this.height = size.height;\n\n    this.width = size.width;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.Hat\n\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Measurable} from './base.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about the space a hat takes up during\n * rendering.\n */\nexport class Hat extends Measurable {\n  ascenderHeight: number;\n\n  /**\n   * @param constants The rendering constants provider.\n   */\n  constructor(constants: ConstantProvider) {\n    super(constants);\n    this.type |= Types.HAT;\n\n    this.height = this.constants_.START_HAT.height;\n    this.width = this.constants_.START_HAT.width;\n\n    this.ascenderHeight = this.height;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.Icon\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {IIcon as BlocklyIcon} from '../../interfaces/i_icon.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Measurable} from './base.js';\nimport {Types} from './types.js';\nimport {hasBubble} from '../../interfaces/i_has_bubble.js';\n\n/**\n * An object containing information about the space an icon takes up during\n * rendering.\n */\nexport class Icon extends Measurable {\n  /**\n   * @deprecated Will be removed in v11. Create a subclass of the Icon\n   *     measurable if this data is necessary for you.\n   */\n  isVisible: boolean;\n  flipRtl = false;\n\n  /**\n   * An object containing information about the space an icon takes up during\n   * rendering.\n   *\n   * @param constants The rendering constants provider.\n   * @param icon The icon to measure and store information for.\n   */\n  constructor(\n    constants: ConstantProvider,\n    public icon: BlocklyIcon,\n  ) {\n    super(constants);\n\n    this.isVisible = hasBubble(icon) && icon.bubbleIsVisible();\n    this.type |= Types.ICON;\n\n    const size = icon.getSize();\n    this.height = size.height;\n    this.width = size.width;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.InRowSpacer\n\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Measurable} from './base.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about a spacer between two elements on a\n * row.\n */\nexport class InRowSpacer extends Measurable {\n  /**\n   * @param constants The rendering constants provider.\n   * @param width The width of the spacer.\n   */\n  constructor(constants: ConstantProvider, width: number) {\n    super(constants);\n    this.type |= Types.SPACER | Types.IN_ROW_SPACER;\n    this.width = width;\n    this.height = this.constants_.SPACER_DEFAULT_HEIGHT;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.InlineInput\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {Input} from '../../inputs/input.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {InputConnection} from './input_connection.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about the space an inline input takes up\n * during rendering.\n */\nexport class InlineInput extends InputConnection {\n  connectionHeight: number;\n  connectionWidth: number;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param input The inline input to measure and store information for.\n   */\n  constructor(constants: ConstantProvider, input: Input) {\n    super(constants, input);\n    this.type |= Types.INLINE_INPUT;\n\n    if (!this.connectedBlock) {\n      this.height = this.constants_.EMPTY_INLINE_INPUT_HEIGHT;\n      this.width = this.constants_.EMPTY_INLINE_INPUT_PADDING;\n    } else {\n      // We allow the dark path to show on the parent block so that the child\n      // block looks embossed.  This takes up an extra pixel in both x and y.\n      this.width = this.connectedBlockWidth;\n      this.height = this.connectedBlockHeight;\n    }\n\n    this.connectionHeight = !this.isDynamicShape\n      ? (this.shape.height as number)\n      : (this.shape.height as (p1: number) => number)(this.height);\n\n    this.connectionWidth = !this.isDynamicShape\n      ? (this.shape.width as number)\n      : (this.shape.width as (p1: number) => number)(this.height);\n    if (!this.connectedBlock) {\n      this.width += this.connectionWidth * (this.isDynamicShape ? 2 : 1);\n    }\n\n    this.connectionOffsetY =\n      'connectionOffsetY' in this.shape\n        ? this.shape.connectionOffsetY(this.connectionHeight)\n        : this.constants_.TAB_OFFSET_FROM_TOP;\n\n    this.connectionOffsetX =\n      'connectionOffsetX' in this.shape\n        ? this.shape.connectionOffsetX(this.connectionWidth)\n        : 0;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.StatementInput\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {Input} from '../../inputs/input.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {InputConnection} from './input_connection.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about the space a statement input takes up\n * during rendering\n */\nexport class StatementInput extends InputConnection {\n  /**\n   * @param constants The rendering constants provider.\n   * @param input The statement input to measure and store information for.\n   */\n  constructor(constants: ConstantProvider, input: Input) {\n    super(constants, input);\n    this.type |= Types.STATEMENT_INPUT;\n\n    if (!this.connectedBlock) {\n      this.height = this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT;\n    } else {\n      // We allow the dark path to show on the parent block so that the child\n      // block looks embossed.  This takes up an extra pixel in both x and y.\n      this.height =\n        this.connectedBlockHeight + this.constants_.STATEMENT_BOTTOM_SPACER;\n    }\n    this.width =\n      this.constants_.STATEMENT_INPUT_NOTCH_OFFSET +\n      (this.shape.width as number);\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.InputRow\n\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {ExternalValueInput} from './external_value_input.js';\nimport {InputConnection} from './input_connection.js';\nimport {Row} from './row.js';\nimport {StatementInput} from './statement_input.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about a row that holds one or more inputs.\n */\nexport class InputRow extends Row {\n  /**\n   * The total width of all blocks connected to this row.\n   */\n  connectedBlockWidths = 0;\n\n  /**\n   * @param constants The rendering constants provider.\n   */\n  constructor(constants: ConstantProvider) {\n    super(constants);\n    this.type |= Types.INPUT_ROW;\n  }\n\n  /**\n   * Inspect all subcomponents and populate all size properties on the row.\n   */\n  override measure() {\n    this.width = this.minWidth;\n    this.height = this.minHeight;\n    let connectedBlockWidths = 0;\n    for (let i = 0; i < this.elements.length; i++) {\n      const elem = this.elements[i];\n      this.width += elem.width;\n      if (Types.isInput(elem) && elem instanceof InputConnection) {\n        if (Types.isStatementInput(elem) && elem instanceof StatementInput) {\n          connectedBlockWidths += elem.connectedBlockWidth;\n        } else if (\n          Types.isExternalInput(elem) &&\n          elem instanceof ExternalValueInput &&\n          elem.connectedBlockWidth !== 0\n        ) {\n          connectedBlockWidths +=\n            elem.connectedBlockWidth - elem.connectionWidth;\n        }\n      }\n      if (!Types.isSpacer(elem)) {\n        this.height = Math.max(this.height, elem.height);\n      }\n    }\n    this.connectedBlockWidths = connectedBlockWidths;\n    this.widthWithConnectedBlocks = this.width + connectedBlockWidths;\n  }\n\n  override endsWithElemSpacer() {\n    return !this.hasExternalInput && !this.hasStatement;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.JaggedEdge\n\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Measurable} from './base.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about the space the jagged edge of a\n * collapsed block takes up during rendering.\n */\nexport class JaggedEdge extends Measurable {\n  /**\n   * @param constants The rendering constants provider.\n   */\n  constructor(constants: ConstantProvider) {\n    super(constants);\n    this.type |= Types.JAGGED_EDGE;\n    this.height = this.constants_.JAGGED_TEETH.height;\n    this.width = this.constants_.JAGGED_TEETH.width;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.NextConnection\n\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Connection} from './connection.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about the space a next connection takes\n * up during rendering.\n */\nexport class NextConnection extends Connection {\n  /**\n   * @param constants The rendering constants provider.\n   * @param connectionModel The connection object on the block that this\n   *     represents.\n   */\n  constructor(\n    constants: ConstantProvider,\n    connectionModel: RenderedConnection,\n  ) {\n    super(constants, connectionModel);\n    this.type |= Types.NEXT_CONNECTION;\n    this.height = this.shape.height as number;\n    this.width = this.shape.width as number;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.OutputConnection\n\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Connection} from './connection.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about the space an output connection takes\n * up during rendering.\n */\nexport class OutputConnection extends Connection {\n  startX: number;\n  connectionOffsetY: number;\n  connectionOffsetX = 0;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param connectionModel The connection object on the block that this\n   *     represents.\n   */\n  constructor(\n    constants: ConstantProvider,\n    connectionModel: RenderedConnection,\n  ) {\n    super(constants, connectionModel);\n    this.type |= Types.OUTPUT_CONNECTION;\n\n    this.height = !this.isDynamicShape ? (this.shape.height as number) : 0;\n    this.width = !this.isDynamicShape ? (this.shape.width as number) : 0;\n\n    this.startX = this.width;\n\n    this.connectionOffsetY = this.constants_.TAB_OFFSET_FROM_TOP;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.PreviousConnection\n\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Connection} from './connection.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about the space a previous connection takes\n * up during rendering.\n */\nexport class PreviousConnection extends Connection {\n  /**\n   * @param constants The rendering constants provider.\n   * @param connectionModel The connection object on the block that this\n   *     represents.\n   */\n  constructor(\n    constants: ConstantProvider,\n    connectionModel: RenderedConnection,\n  ) {\n    super(constants, connectionModel);\n    this.type |= Types.PREVIOUS_CONNECTION;\n    this.height = this.shape.height as number;\n    this.width = this.shape.width as number;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.RoundCorner\n\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Measurable} from './base.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about the space a rounded corner takes up\n * during rendering.\n */\nexport class RoundCorner extends Measurable {\n  /**\n   * @param constants The rendering constants provider.\n   * @param opt_position The position of this corner.\n   */\n  constructor(constants: ConstantProvider, opt_position?: string) {\n    super(constants);\n    this.type =\n      (!opt_position || opt_position === 'left'\n        ? Types.LEFT_ROUND_CORNER\n        : Types.RIGHT_ROUND_CORNER) | Types.CORNER;\n    this.width = this.constants_.CORNER_RADIUS;\n    // The rounded corner extends into the next row by 4 so we only take the\n    // height that is aligned with this row.\n    this.height = this.constants_.CORNER_RADIUS / 2;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.SpacerRow\n\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {InRowSpacer} from './in_row_spacer.js';\nimport {Row} from './row.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about a spacer between two rows.\n */\nexport class SpacerRow extends Row {\n  followsStatement = false;\n\n  precedesStatement = false;\n\n  override widthWithConnectedBlocks = 0;\n  override elements: InRowSpacer[];\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param height The height of the spacer.\n   * @param width The width of the spacer.\n   */\n  constructor(\n    constants: ConstantProvider,\n    public override height: number,\n    public override width: number,\n  ) {\n    super(constants);\n    this.type |= Types.SPACER | Types.BETWEEN_ROW_SPACER;\n\n    this.elements = [new InRowSpacer(this.constants_, width)];\n  }\n\n  override measure() {}\n}\n// NOP.  Width and height were set at creation.\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.SquareCorner\n\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Measurable} from './base.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about the space a square corner takes up\n * during rendering.\n */\nexport class SquareCorner extends Measurable {\n  /**\n   * @param constants The rendering constants provider.\n   * @param opt_position The position of this corner.\n   */\n  constructor(constants: ConstantProvider, opt_position?: string) {\n    super(constants);\n    this.type =\n      (!opt_position || opt_position === 'left'\n        ? Types.LEFT_SQUARE_CORNER\n        : Types.RIGHT_SQUARE_CORNER) | Types.CORNER;\n    this.height = this.constants_.NO_PADDING;\n    this.width = this.constants_.NO_PADDING;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.TopRow\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Hat} from './hat.js';\nimport type {PreviousConnection} from './previous_connection.js';\nimport {Row} from './row.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about what elements are in the top row of a\n * block as well as sizing information for the top row.\n * Elements in a top row can consist of corners, hats, spacers, and previous\n * connections.\n * After this constructor is called, the row will contain all non-spacer\n * elements it needs.\n */\nexport class TopRow extends Row {\n  /**\n   * The starting point for drawing the row, in the y direction.\n   * This allows us to draw hats and similar shapes that don't start at the\n   * origin. Must be non-negative (see #2820).\n   */\n  capline = 0;\n\n  /** How much the row extends up above its capline. */\n  ascenderHeight = 0;\n\n  /** Whether the block has a previous connection. */\n  hasPreviousConnection = false;\n\n  /** The previous connection on the block, if any. */\n  connection: PreviousConnection | null = null;\n\n  /**\n   * @param constants The rendering constants provider.\n   */\n  constructor(constants: ConstantProvider) {\n    super(constants);\n\n    this.type |= Types.TOP_ROW;\n  }\n\n  /**\n   * Returns whether or not the top row has a left square corner.\n   *\n   * @param block The block whose top row this represents.\n   * @returns Whether or not the top row has a left square corner.\n   */\n  hasLeftSquareCorner(block: BlockSvg): boolean {\n    const hasHat =\n      (block.hat ? block.hat === 'cap' : this.constants_.ADD_START_HATS) &&\n      !block.outputConnection &&\n      !block.previousConnection;\n    const prevBlock = block.getPreviousBlock();\n\n    return (\n      !!block.outputConnection ||\n      hasHat ||\n      (prevBlock ? prevBlock.getNextBlock() === block : false)\n    );\n  }\n\n  /**\n   * Returns whether or not the top row has a right square corner.\n   *\n   * @param _block The block whose top row this represents.\n   * @returns Whether or not the top row has a right square corner.\n   */\n  hasRightSquareCorner(_block: BlockSvg): boolean {\n    return true;\n  }\n\n  override measure() {\n    let height = 0;\n    let width = 0;\n    let ascenderHeight = 0;\n    for (let i = 0; i < this.elements.length; i++) {\n      const elem = this.elements[i];\n      width += elem.width;\n      if (!Types.isSpacer(elem)) {\n        if (Types.isHat(elem) && elem instanceof Hat) {\n          ascenderHeight = Math.max(ascenderHeight, elem.ascenderHeight);\n        } else {\n          height = Math.max(height, elem.height);\n        }\n      }\n    }\n    this.width = Math.max(this.minWidth, width);\n    this.height = Math.max(this.minHeight, height) + ascenderHeight;\n    this.ascenderHeight = ascenderHeight;\n    this.capline = this.ascenderHeight;\n    this.widthWithConnectedBlocks = this.width;\n  }\n\n  override startsWithElemSpacer() {\n    return false;\n  }\n\n  override endsWithElemSpacer() {\n    return false;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.Drawer\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport {Coordinate} from '../../utils.js';\nimport * as svgPaths from '../../utils/svg_paths.js';\nimport {Connection} from '../measurables/connection.js';\nimport type {ExternalValueInput} from '../measurables/external_value_input.js';\nimport type {Field} from '../measurables/field.js';\nimport type {Icon} from '../measurables/icon.js';\nimport type {InlineInput} from '../measurables/inline_input.js';\nimport type {PreviousConnection} from '../measurables/previous_connection.js';\nimport type {Row} from '../measurables/row.js';\nimport {Types} from '../measurables/types.js';\n\nimport {isDynamicShape, isNotch, isPuzzleTab} from './constants.js';\nimport type {ConstantProvider, Notch, PuzzleTab} from './constants.js';\nimport type {RenderInfo} from './info.js';\nimport * as deprecation from '../../utils/deprecation.js';\nimport {ConnectionType} from '../../connection_type.js';\n\n/**\n * An object that draws a block based on the given rendering information.\n */\nexport class Drawer {\n  block_: BlockSvg;\n  info_: RenderInfo;\n  topLeft_: Coordinate;\n  outlinePath_ = '';\n  inlinePath_ = '';\n  protected constants_: ConstantProvider;\n\n  /**\n   * @param block The block to render.\n   * @param info An object containing all information needed to render this\n   *     block.\n   */\n  constructor(block: BlockSvg, info: RenderInfo) {\n    this.block_ = block;\n    this.info_ = info;\n    this.topLeft_ = block.getRelativeToSurfaceXY();\n\n    /** The renderer's constant provider. */\n    this.constants_ = info.getRenderer().getConstants();\n  }\n\n  /**\n   * Draw the block to the workspace. Here \"drawing\" means setting SVG path\n   * elements and moving fields, icons, and connections on the screen.\n   *\n   * The pieces of the paths are pushed into arrays of \"steps\", which are then\n   * joined with spaces and set directly on the block.  This guarantees that\n   * the steps are separated by spaces for improved readability, but isn't\n   * required.\n   */\n  draw() {\n    this.drawOutline_();\n    this.drawInternals_();\n    this.updateConnectionHighlights();\n\n    this.block_.pathObject.setPath(this.outlinePath_ + '\\n' + this.inlinePath_);\n    if (this.info_.RTL) {\n      this.block_.pathObject.flipRTL();\n    }\n    this.recordSizeOnBlock_();\n  }\n\n  /**\n   * Hide icons that were marked as hidden.\n   *\n   * @deprecated Manually hiding icons is no longer necessary. To be removed\n   *     in v11.\n   */\n  protected hideHiddenIcons_() {\n    deprecation.warn('hideHiddenIcons_', 'v10', 'v11');\n  }\n\n  /**\n   * Save sizing information back to the block\n   * Most of the rendering information can be thrown away at the end of the\n   * render. Anything that needs to be kept around should be set in this\n   * function.\n   */\n  protected recordSizeOnBlock_() {\n    // This is used when the block is reporting its size to anyone else.\n    // The dark path adds to the size of the block in both X and Y.\n    this.block_.height = this.info_.height;\n    this.block_.width = this.info_.widthWithChildren;\n  }\n\n  /** Create the outline of the block.  This is a single continuous path. */\n  protected drawOutline_() {\n    this.drawTop_();\n    for (let r = 1; r < this.info_.rows.length - 1; r++) {\n      const row = this.info_.rows[r];\n      if (row.hasJaggedEdge) {\n        this.drawJaggedEdge_(row);\n      } else if (row.hasStatement) {\n        this.drawStatementInput_(row);\n      } else if (row.hasExternalInput) {\n        this.drawValueInput_(row);\n      } else {\n        this.drawRightSideRow_(row);\n      }\n    }\n    this.drawBottom_();\n    this.drawLeft_();\n  }\n\n  /**\n   * Add steps for the top corner of the block, taking into account\n   * details such as hats and rounded corners.\n   */\n  protected drawTop_() {\n    const topRow = this.info_.topRow;\n    const elements = topRow.elements;\n\n    this.positionPreviousConnection_();\n    this.outlinePath_ += svgPaths.moveBy(topRow.xPos, this.info_.startY);\n    for (let i = 0, elem; (elem = elements[i]); i++) {\n      if (Types.isLeftRoundedCorner(elem)) {\n        this.outlinePath_ += this.constants_.OUTSIDE_CORNERS.topLeft;\n      } else if (Types.isRightRoundedCorner(elem)) {\n        this.outlinePath_ += this.constants_.OUTSIDE_CORNERS.topRight;\n      } else if (\n        Types.isPreviousConnection(elem) &&\n        elem instanceof Connection\n      ) {\n        this.outlinePath_ += (\n          (elem as PreviousConnection).shape as Notch\n        ).pathLeft;\n      } else if (Types.isHat(elem)) {\n        this.outlinePath_ += this.constants_.START_HAT.path;\n      } else if (Types.isSpacer(elem)) {\n        this.outlinePath_ += svgPaths.lineOnAxis('h', elem.width);\n      }\n    }\n    // No branch for a square corner, because it's a no-op.\n    this.outlinePath_ += svgPaths.lineOnAxis('v', topRow.height);\n  }\n\n  /**\n   * Add steps for the jagged edge of a row on a collapsed block.\n   *\n   * @param row The row to draw the side of.\n   */\n  protected drawJaggedEdge_(row: Row) {\n    const remainder = row.height - this.constants_.JAGGED_TEETH.height;\n    this.outlinePath_ +=\n      this.constants_.JAGGED_TEETH.path + svgPaths.lineOnAxis('v', remainder);\n  }\n\n  /**\n   * Add steps for an external value input, rendered as a notch in the side\n   * of the block.\n   *\n   * @param row The row that this input belongs to.\n   */\n  protected drawValueInput_(row: Row) {\n    const input = row.getLastInput() as ExternalValueInput | InlineInput;\n    this.positionExternalValueConnection_(row);\n\n    const pathDown = isDynamicShape(input.shape)\n      ? input.shape.pathDown(input.height)\n      : (input.shape as PuzzleTab).pathDown;\n\n    this.outlinePath_ +=\n      svgPaths.lineOnAxis('H', input.xPos + input.width) +\n      pathDown +\n      svgPaths.lineOnAxis('v', row.height - input.connectionHeight);\n  }\n\n  /**\n   * Add steps for a statement input.\n   *\n   * @param row The row that this input belongs to.\n   */\n  protected drawStatementInput_(row: Row) {\n    const input = row.getLastInput();\n    if (!input) return;\n    // Where to start drawing the notch, which is on the right side in LTR.\n    const x = input.xPos + input.notchOffset + (input.shape as Notch).width;\n\n    const innerTopLeftCorner =\n      (input.shape as Notch).pathRight +\n      svgPaths.lineOnAxis(\n        'h',\n        -(input.notchOffset - this.constants_.INSIDE_CORNERS.width),\n      ) +\n      this.constants_.INSIDE_CORNERS.pathTop;\n\n    const innerHeight = row.height - 2 * this.constants_.INSIDE_CORNERS.height;\n\n    this.outlinePath_ +=\n      svgPaths.lineOnAxis('H', x) +\n      innerTopLeftCorner +\n      svgPaths.lineOnAxis('v', innerHeight) +\n      this.constants_.INSIDE_CORNERS.pathBottom +\n      svgPaths.lineOnAxis('H', row.xPos + row.width);\n\n    this.positionStatementInputConnection_(row);\n  }\n\n  /**\n   * Add steps for the right side of a row that does not have value or\n   * statement input connections.\n   *\n   * @param row The row to draw the side of.\n   */\n  protected drawRightSideRow_(row: Row) {\n    this.outlinePath_ += svgPaths.lineOnAxis('V', row.yPos + row.height);\n  }\n\n  /**\n   * Add steps for the bottom edge of a block, possibly including a notch\n   * for the next connection.\n   */\n  protected drawBottom_() {\n    const bottomRow = this.info_.bottomRow;\n    const elems = bottomRow.elements;\n    this.positionNextConnection_();\n\n    let rightCornerYOffset = 0;\n    let outlinePath = '';\n    for (let i = elems.length - 1, elem; (elem = elems[i]); i--) {\n      if (Types.isNextConnection(elem) && elem instanceof Connection) {\n        outlinePath += (elem.shape as Notch).pathRight;\n      } else if (Types.isLeftSquareCorner(elem)) {\n        outlinePath += svgPaths.lineOnAxis('H', bottomRow.xPos);\n      } else if (Types.isLeftRoundedCorner(elem)) {\n        outlinePath += this.constants_.OUTSIDE_CORNERS.bottomLeft;\n      } else if (Types.isRightRoundedCorner(elem)) {\n        outlinePath += this.constants_.OUTSIDE_CORNERS.bottomRight;\n        rightCornerYOffset = this.constants_.OUTSIDE_CORNERS.rightHeight;\n      } else if (Types.isSpacer(elem)) {\n        outlinePath += svgPaths.lineOnAxis('h', elem.width * -1);\n      }\n    }\n\n    this.outlinePath_ += svgPaths.lineOnAxis(\n      'V',\n      bottomRow.baseline - rightCornerYOffset,\n    );\n    this.outlinePath_ += outlinePath;\n  }\n\n  /**\n   * Add steps for the left side of the block, which may include an output\n   * connection\n   */\n  protected drawLeft_() {\n    const outputConnection = this.info_.outputConnection;\n    this.positionOutputConnection_();\n\n    if (outputConnection) {\n      const tabBottom =\n        outputConnection.connectionOffsetY + outputConnection.height;\n      const pathUp = isDynamicShape(outputConnection.shape)\n        ? outputConnection.shape.pathUp(outputConnection.height)\n        : (outputConnection.shape as PuzzleTab).pathUp;\n\n      // Draw a line up to the bottom of the tab.\n      this.outlinePath_ += svgPaths.lineOnAxis('V', tabBottom) + pathUp;\n    }\n    // Close off the path.  This draws a vertical line up to the start of the\n    // block's path, which may be either a rounded or a sharp corner.\n    this.outlinePath_ += 'z';\n  }\n\n  /**\n   * Draw the internals of the block: inline inputs, fields, and icons.  These\n   * do not depend on the outer path for placement.\n   */\n  protected drawInternals_() {\n    for (let i = 0, row; (row = this.info_.rows[i]); i++) {\n      for (let j = 0, elem; (elem = row.elements[j]); j++) {\n        if (Types.isInlineInput(elem)) {\n          this.drawInlineInput_(elem as InlineInput);\n        } else if (Types.isIcon(elem) || Types.isField(elem)) {\n          this.layoutField_(elem as Field | Icon);\n        }\n      }\n    }\n  }\n\n  /**\n   * Push a field or icon's new position to its SVG root.\n   *\n   * @param fieldInfo The rendering information for the field or icon.\n   */\n  protected layoutField_(fieldInfo: Icon | Field) {\n    const yPos = fieldInfo.centerline - fieldInfo.height / 2;\n    let xPos = fieldInfo.xPos;\n    let scale = '';\n    if (this.info_.RTL) {\n      xPos = -(xPos + fieldInfo.width);\n      if (fieldInfo.flipRtl) {\n        xPos += fieldInfo.width;\n        scale = 'scale(-1 1)';\n      }\n    }\n\n    if (Types.isIcon(fieldInfo)) {\n      const icon = (fieldInfo as Icon).icon;\n      icon.setOffsetInBlock(new Coordinate(xPos, yPos));\n      if (this.info_.isInsertionMarker) {\n        icon.hideForInsertionMarker();\n      }\n    } else {\n      const svgGroup = (fieldInfo as Field).field.getSvgRoot()!;\n      svgGroup.setAttribute(\n        'transform',\n        'translate(' + xPos + ',' + yPos + ')' + scale,\n      );\n      if (this.info_.isInsertionMarker) {\n        svgGroup.setAttribute('display', 'none');\n      }\n    }\n  }\n\n  /**\n   * Add steps for an inline input.\n   *\n   * @param input The information about the input to render.\n   */\n  protected drawInlineInput_(input: InlineInput) {\n    const width = input.width;\n    const height = input.height;\n    const yPos = input.centerline - height / 2;\n\n    const connectionTop = input.connectionOffsetY;\n    const connectionBottom = input.connectionHeight + connectionTop;\n    const connectionRight = input.xPos + input.connectionWidth;\n\n    this.inlinePath_ +=\n      svgPaths.moveTo(connectionRight, yPos) +\n      svgPaths.lineOnAxis('v', connectionTop) +\n      (input.shape as PuzzleTab).pathDown +\n      svgPaths.lineOnAxis('v', height - connectionBottom) +\n      svgPaths.lineOnAxis('h', width - input.connectionWidth) +\n      svgPaths.lineOnAxis('v', -height) +\n      'z';\n\n    this.positionInlineInputConnection_(input);\n  }\n\n  /**\n   * Position the connection on an inline value input, taking into account\n   * RTL and the small gap between the parent block and child block which lets\n   * the parent block's dark path show through.\n   *\n   * @param input The information about the input that the connection is on.\n   */\n  protected positionInlineInputConnection_(input: InlineInput) {\n    const yPos = input.centerline - input.height / 2;\n    // Move the connection.\n    if (input.connectionModel) {\n      // xPos already contains info about startX\n      let connX = input.xPos + input.connectionWidth + input.connectionOffsetX;\n      if (this.info_.RTL) {\n        connX *= -1;\n      }\n      input.connectionModel.setOffsetInBlock(\n        connX,\n        yPos + input.connectionOffsetY,\n      );\n    }\n  }\n\n  /**\n   * Position the connection on a statement input, taking into account\n   * RTL and the small gap between the parent block and child block which lets\n   * the parent block's dark path show through.\n   *\n   * @param row The row that the connection is on.\n   */\n  protected positionStatementInputConnection_(row: Row) {\n    const input = row.getLastInput();\n    if (input?.connectionModel) {\n      let connX = row.xPos + row.statementEdge + input.notchOffset;\n      if (this.info_.RTL) {\n        connX *= -1;\n      }\n      input.connectionModel.setOffsetInBlock(connX, row.yPos);\n    }\n  }\n\n  /**\n   * Position the connection on an external value input, taking into account\n   * RTL and the small gap between the parent block and child block which lets\n   * the parent block's dark path show through.\n   *\n   * @param row The row that the connection is on.\n   */\n  protected positionExternalValueConnection_(row: Row) {\n    const input = row.getLastInput();\n    if (input && input.connectionModel) {\n      let connX = row.xPos + row.width;\n      if (this.info_.RTL) {\n        connX *= -1;\n      }\n      input.connectionModel.setOffsetInBlock(connX, row.yPos);\n    }\n  }\n\n  /** Position the previous connection on a block. */\n  protected positionPreviousConnection_() {\n    const topRow = this.info_.topRow;\n    if (topRow.connection) {\n      const x = topRow.xPos + topRow.notchOffset;\n      const connX = this.info_.RTL ? -x : x;\n      topRow.connection.connectionModel.setOffsetInBlock(connX, 0);\n    }\n  }\n\n  /** Position the next connection on a block. */\n  protected positionNextConnection_() {\n    const bottomRow = this.info_.bottomRow;\n\n    if (bottomRow.connection) {\n      const connInfo = bottomRow.connection;\n      const x = connInfo.xPos; // Already contains info about startX.\n      const connX = this.info_.RTL ? -x : x;\n      connInfo.connectionModel.setOffsetInBlock(connX, bottomRow.baseline);\n    }\n  }\n\n  /** Position the output connection on a block. */\n  protected positionOutputConnection_() {\n    if (this.info_.outputConnection) {\n      const x =\n        this.info_.startX + this.info_.outputConnection.connectionOffsetX;\n      const connX = this.info_.RTL ? -x : x;\n      this.block_.outputConnection.setOffsetInBlock(\n        connX,\n        this.info_.outputConnection.connectionOffsetY,\n      );\n    }\n  }\n\n  /**\n   * Updates the path object to reflect which connections on the block are\n   * highlighted.\n   */\n  protected updateConnectionHighlights() {\n    for (const row of this.info_.rows) {\n      for (const elem of row.elements) {\n        if (!(elem instanceof Connection)) continue;\n\n        if (elem.highlighted) {\n          this.drawConnectionHighlightPath(elem);\n        } else {\n          this.block_.pathObject.removeConnectionHighlight?.(\n            elem.connectionModel,\n          );\n        }\n      }\n    }\n  }\n\n  /** Returns a path to highlight the given connection. */\n  drawConnectionHighlightPath(measurable: Connection) {\n    const conn = measurable.connectionModel;\n    let path = '';\n    if (\n      conn.type === ConnectionType.INPUT_VALUE ||\n      conn.type === ConnectionType.OUTPUT_VALUE\n    ) {\n      path = this.getExpressionConnectionHighlightPath(measurable);\n    } else {\n      path = this.getStatementConnectionHighlightPath(measurable);\n    }\n    const block = conn.getSourceBlock();\n    block.pathObject.addConnectionHighlight?.(\n      conn,\n      path,\n      conn.getOffsetInBlock(),\n      block.RTL,\n    );\n  }\n\n  /**\n   * Returns a path to highlight the given conneciton, assuming it is an\n   * input or output connection.\n   */\n  private getExpressionConnectionHighlightPath(connection: Connection): string {\n    let connPath = '';\n    if (isDynamicShape(connection.shape)) {\n      connPath = connection.shape.pathDown(connection.height);\n    } else if (isPuzzleTab(connection.shape)) {\n      connPath = connection.shape.pathDown;\n    }\n\n    // We are assuming that there is room for the tab offset above and below\n    // the tab.\n    const yLen = this.constants_.TAB_OFFSET_FROM_TOP;\n    return (\n      svgPaths.moveBy(0, -yLen) +\n      svgPaths.lineOnAxis('v', yLen) +\n      connPath +\n      svgPaths.lineOnAxis('v', yLen)\n    );\n  }\n\n  /**\n   * Returns a path to highlight the given conneciton, assuming it is a\n   * next or previous connection.\n   */\n  private getStatementConnectionHighlightPath(connection: Connection): string {\n    if (!isNotch(connection.shape)) {\n      throw new Error('Statement connections should have notch shapes');\n    }\n\n    const xLen =\n      this.constants_.NOTCH_OFFSET_LEFT - this.constants_.CORNER_RADIUS;\n    return (\n      svgPaths.moveBy(-xLen, 0) +\n      svgPaths.lineOnAxis('h', xLen) +\n      connection.shape.pathLeft +\n      svgPaths.lineOnAxis('h', xLen)\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Enum for alignment of inputs.\n */\nexport enum Align {\n  LEFT = -1,\n  CENTRE = 0,\n  RIGHT = 1,\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Non-editable, non-serializable text field.  Used for titles,\n *    labels, etc.\n *\n * @class\n */\n// Former goog.module ID: Blockly.FieldLabel\n\nimport * as dom from './utils/dom.js';\nimport {Field, FieldConfig} from './field.js';\nimport * as fieldRegistry from './field_registry.js';\nimport * as parsing from './utils/parsing.js';\n\n/**\n * Class for a non-editable, non-serializable text field.\n */\nexport class FieldLabel extends Field<string> {\n  /** The HTML class name to use for this field. */\n  private class: string | null = null;\n\n  /**\n   * Editable fields usually show some sort of UI indicating they are\n   * editable. This field should not.\n   */\n  override EDITABLE = false;\n\n  /** Text labels should not truncate. */\n  override maxDisplayLength = Infinity;\n\n  /**\n   * @param value The initial value of the field. Should cast to a string.\n   *     Defaults to an empty string if null or undefined. Also accepts\n   *     Field.SKIP_SETUP if you wish to skip setup (only used by subclasses\n   *     that want to handle configuration and setting the field value after\n   *     their own constructors have run).\n   * @param textClass Optional CSS class for the field's text.\n   * @param config A map of options used to configure the field.\n   *    See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/label#creation}\n   * for a list of properties this parameter supports.\n   */\n  constructor(\n    value?: string | typeof Field.SKIP_SETUP,\n    textClass?: string,\n    config?: FieldLabelConfig,\n  ) {\n    super(Field.SKIP_SETUP);\n\n    if (value === Field.SKIP_SETUP) return;\n    if (config) {\n      this.configure_(config);\n    } else {\n      this.class = textClass || null;\n    }\n    this.setValue(value);\n  }\n\n  protected override configure_(config: FieldLabelConfig) {\n    super.configure_(config);\n    if (config.class) this.class = config.class;\n  }\n\n  /**\n   * Create block UI for this label.\n   */\n  override initView() {\n    this.createTextElement_();\n    if (this.class) {\n      dom.addClass(this.getTextElement(), this.class);\n    }\n  }\n\n  /**\n   * Ensure that the input value casts to a valid string.\n   *\n   * @param newValue The input value.\n   * @returns A valid string, or null if invalid.\n   */\n  protected override doClassValidation_(\n    newValue?: AnyDuringMigration,\n  ): string | null {\n    if (newValue === null || newValue === undefined) {\n      return null;\n    }\n    return `${newValue}`;\n  }\n\n  /**\n   * Set the CSS class applied to the field's textElement_.\n   *\n   * @param cssClass The new CSS class name, or null to remove.\n   */\n  setClass(cssClass: string | null) {\n    if (this.textElement_) {\n      if (this.class) {\n        dom.removeClass(this.textElement_, this.class);\n      }\n      if (cssClass) {\n        dom.addClass(this.textElement_, cssClass);\n      }\n    }\n    this.class = cssClass;\n  }\n\n  /**\n   * Construct a FieldLabel from a JSON arg object,\n   * dereferencing any string table references.\n   *\n   * @param options A JSON object with options (text, and class).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static fromJson(options: FieldLabelFromJsonConfig): FieldLabel {\n    const text = parsing.replaceMessageReferences(options.text);\n    // `this` might be a subclass of FieldLabel if that class doesn't override\n    // the static fromJson method.\n    return new this(text, undefined, options);\n  }\n}\n\nfieldRegistry.register('field_label', FieldLabel);\n\nFieldLabel.prototype.DEFAULT_VALUE = '';\n\n// clang-format off\n// Clang does not like the 'class' keyword being used as a property.\n/**\n * Config options for the label field.\n */\nexport interface FieldLabelConfig extends FieldConfig {\n  class?: string;\n}\n// clang-format on\n\n/**\n * fromJson config options for the label field.\n */\nexport interface FieldLabelFromJsonConfig extends FieldLabelConfig {\n  text?: string;\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing an input (value, statement, or dummy).\n *\n * @class\n */\n// Former goog.module ID: Blockly.Input\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport '../field_label.js';\n\nimport type {Block} from '../block.js';\nimport type {BlockSvg} from '../block_svg.js';\nimport type {Connection} from '../connection.js';\nimport type {ConnectionType} from '../connection_type.js';\nimport type {Field} from '../field.js';\nimport * as fieldRegistry from '../field_registry.js';\nimport type {RenderedConnection} from '../rendered_connection.js';\nimport {inputTypes} from './input_types.js';\n\n/** Class for an input with optional fields. */\nexport class Input {\n  fieldRow: Field[] = [];\n  /** Alignment of input's fields (left, right or centre). */\n  align = Align.LEFT;\n\n  /** Is the input visible? */\n  private visible = true;\n\n  public readonly type: inputTypes = inputTypes.CUSTOM;\n\n  public connection: Connection | null = null;\n\n  /**\n   * @param name Language-neutral identifier which may used to find this input\n   *     again.\n   * @param sourceBlock The block containing this input.\n   */\n  constructor(\n    public name: string,\n    private sourceBlock: Block,\n  ) {}\n\n  /**\n   * Get the source block for this input.\n   *\n   * @returns The block this input is part of.\n   */\n  getSourceBlock(): Block {\n    return this.sourceBlock;\n  }\n\n  /**\n   * Add a field (or label from string), and all prefix and suffix fields, to\n   * the end of the input's field row.\n   *\n   * @param field Something to add as a field.\n   * @param opt_name Language-neutral identifier which may used to find this\n   *     field again.  Should be unique to the host block.\n   * @returns The input being append to (to allow chaining).\n   */\n  appendField<T>(field: string | Field<T>, opt_name?: string): Input {\n    this.insertFieldAt(this.fieldRow.length, field, opt_name);\n    return this;\n  }\n\n  /**\n   * Inserts a field (or label from string), and all prefix and suffix fields,\n   * at the location of the input's field row.\n   *\n   * @param index The index at which to insert field.\n   * @param field Something to add as a field.\n   * @param opt_name Language-neutral identifier which may used to find this\n   *     field again.  Should be unique to the host block.\n   * @returns The index following the last inserted field.\n   */\n  insertFieldAt<T>(\n    index: number,\n    field: string | Field<T>,\n    opt_name?: string,\n  ): number {\n    if (index < 0 || index > this.fieldRow.length) {\n      throw Error('index ' + index + ' out of bounds.');\n    }\n    // Falsy field values don't generate a field, unless the field is an empty\n    // string and named.\n    if (!field && !(field === '' && opt_name)) {\n      return index;\n    }\n\n    // Generate a FieldLabel when given a plain text field.\n    if (typeof field === 'string') {\n      field = fieldRegistry.fromJson({\n        type: 'field_label',\n        text: field,\n      })!;\n    }\n\n    field.setSourceBlock(this.sourceBlock);\n    if (this.sourceBlock.rendered) {\n      field.init();\n      field.applyColour();\n    }\n    field.name = opt_name;\n    field.setVisible(this.isVisible());\n\n    if (field.prefixField) {\n      // Add any prefix.\n      index = this.insertFieldAt(index, field.prefixField);\n    }\n    // Add the field to the field row.\n    this.fieldRow.splice(index, 0, field as Field);\n    index++;\n    if (field.suffixField) {\n      // Add any suffix.\n      index = this.insertFieldAt(index, field.suffixField);\n    }\n\n    if (this.sourceBlock.rendered) {\n      (this.sourceBlock as BlockSvg).queueRender();\n      // Adding a field will cause the block to change shape.\n      this.sourceBlock.bumpNeighbours();\n    }\n    return index;\n  }\n\n  /**\n   * Remove a field from this input.\n   *\n   * @param name The name of the field.\n   * @param opt_quiet True to prevent an error if field is not present.\n   * @returns True if operation succeeds, false if field is not present and\n   *     opt_quiet is true.\n   * @throws {Error} if the field is not present and opt_quiet is false.\n   */\n  removeField(name: string, opt_quiet?: boolean): boolean {\n    for (let i = 0, field; (field = this.fieldRow[i]); i++) {\n      if (field.name === name) {\n        field.dispose();\n        this.fieldRow.splice(i, 1);\n        if (this.sourceBlock.rendered) {\n          (this.sourceBlock as BlockSvg).queueRender();\n          // Removing a field will cause the block to change shape.\n          this.sourceBlock.bumpNeighbours();\n        }\n        return true;\n      }\n    }\n    if (opt_quiet) {\n      return false;\n    }\n    throw Error('Field \"' + name + '\" not found.');\n  }\n\n  /**\n   * Gets whether this input is visible or not.\n   *\n   * @returns True if visible.\n   */\n  isVisible(): boolean {\n    return this.visible;\n  }\n\n  /**\n   * Sets whether this input is visible or not.\n   * Should only be used to collapse/uncollapse a block.\n   *\n   * @param visible True if visible.\n   * @returns List of blocks to render.\n   * @internal\n   */\n  setVisible(visible: boolean): BlockSvg[] {\n    // Note: Currently there are only unit tests for block.setCollapsed()\n    // because this function is package. If this function goes back to being a\n    // public API tests (lots of tests) should be added.\n    let renderList: AnyDuringMigration[] = [];\n    if (this.visible === visible) {\n      return renderList;\n    }\n    this.visible = visible;\n\n    for (let y = 0, field; (field = this.fieldRow[y]); y++) {\n      field.setVisible(visible);\n    }\n    if (this.connection) {\n      const renderedConnection = this.connection as RenderedConnection;\n      // Has a connection.\n      if (visible) {\n        renderList = renderedConnection.startTrackingAll();\n      } else {\n        renderedConnection.stopTrackingAll();\n      }\n      const child = renderedConnection.targetBlock();\n      if (child) {\n        child.getSvgRoot().style.display = visible ? 'block' : 'none';\n      }\n    }\n    return renderList;\n  }\n\n  /**\n   * Mark all fields on this input as dirty.\n   *\n   * @internal\n   */\n  markDirty() {\n    for (let y = 0, field; (field = this.fieldRow[y]); y++) {\n      field.markDirty();\n    }\n  }\n\n  /**\n   * Change a connection's compatibility.\n   *\n   * @param check Compatible value type or list of value types.  Null if all\n   *     types are compatible.\n   * @returns The input being modified (to allow chaining).\n   */\n  setCheck(check: string | string[] | null): Input {\n    if (!this.connection) {\n      throw Error('This input does not have a connection.');\n    }\n    this.connection.setCheck(check);\n    return this;\n  }\n\n  /**\n   * Change the alignment of the connection's field(s).\n   *\n   * @param align One of the values of Align.  In RTL mode directions\n   *     are reversed, and Align.RIGHT aligns to the left.\n   * @returns The input being modified (to allow chaining).\n   */\n  setAlign(align: Align): Input {\n    this.align = align;\n    if (this.sourceBlock.rendered) {\n      const sourceBlock = this.sourceBlock as BlockSvg;\n      sourceBlock.queueRender();\n    }\n    return this;\n  }\n\n  /**\n   * Changes the connection's shadow block.\n   *\n   * @param shadow DOM representation of a block or null.\n   * @returns The input being modified (to allow chaining).\n   */\n  setShadowDom(shadow: Element | null): Input {\n    if (!this.connection) {\n      throw Error('This input does not have a connection.');\n    }\n    this.connection.setShadowDom(shadow);\n    return this;\n  }\n\n  /**\n   * Returns the XML representation of the connection's shadow block.\n   *\n   * @returns Shadow DOM representation of a block or null.\n   */\n  getShadowDom(): Element | null {\n    if (!this.connection) {\n      throw Error('This input does not have a connection.');\n    }\n    return this.connection.getShadowDom();\n  }\n\n  /** Initialize the fields on this input. */\n  init() {\n    if (!this.sourceBlock.workspace.rendered) {\n      return; // Headless blocks don't need fields initialized.\n    }\n    for (let i = 0; i < this.fieldRow.length; i++) {\n      this.fieldRow[i].init();\n    }\n  }\n\n  /**\n   * Sever all links to this input.\n   */\n  dispose() {\n    for (let i = 0, field; (field = this.fieldRow[i]); i++) {\n      field.dispose();\n    }\n    if (this.connection) {\n      this.connection.dispose();\n    }\n  }\n\n  /**\n   * Constructs a connection based on the type of this input's source block.\n   * Properly handles constructing headless connections for headless blocks\n   * and rendered connections for rendered blocks.\n   *\n   * @returns a connection of the given type, which is either a headless\n   *     or rendered connection, based on the type of this input's source block.\n   */\n  protected makeConnection(type: ConnectionType): Connection {\n    return this.sourceBlock.makeConnection_(type);\n  }\n}\n\nexport namespace Input {\n  // TODO(v11): When this is removed in v11, also re-enable errors on access\n  //     of deprecated things (in build_tasks.js).\n  /**\n   * Enum for alignment of inputs.\n   *\n   * @deprecated Use Blockly.inputs.Align. To be removed in v11.\n   */\n  export enum Align {\n    LEFT = -1,\n    CENTRE = 0,\n    RIGHT = 1,\n  }\n}\n\n/** @deprecated Use Blockly.inputs.Align. To be removed in v11. */\n/** @suppress {deprecated} */\nexport type Align = Input.Align;\n/** @deprecated Use Blockly.inputs.Align. To be removed in v11. */\n/** @suppress {deprecated} */\nexport const Align = Input.Align;\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {Block} from '../block.js';\nimport {Input} from './input.js';\nimport {inputTypes} from './input_types.js';\n\n/** Represents an input on a block with no connection. */\nexport class DummyInput extends Input {\n  readonly type = inputTypes.DUMMY;\n\n  /**\n   * @param name Language-neutral identifier which may used to find this input\n   *     again.\n   * @param block The block containing this input.\n   */\n  constructor(\n    public name: string,\n    block: Block,\n  ) {\n    super(name, block);\n  }\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {Block} from '../block.js';\nimport {Input} from './input.js';\nimport {inputTypes} from './input_types.js';\n\n/**\n * Represents an input on a block that is always the last input in the row. Any\n * following input will be rendered on the next row even if the block has inline\n * inputs. Any newline character in a JSON block definition's message will\n * automatically be parsed as an end-row input.\n */\nexport class EndRowInput extends Input {\n  readonly type = inputTypes.END_ROW;\n\n  /**\n   * @param name Language-neutral identifier which may used to find this input\n   *     again.\n   * @param block The block containing this input.\n   */\n  constructor(\n    public name: string,\n    block: Block,\n  ) {\n    super(name, block);\n  }\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {Block} from '../block.js';\nimport type {Connection} from '../connection.js';\nimport {ConnectionType} from '../connection_type.js';\nimport {Input} from './input.js';\nimport {inputTypes} from './input_types.js';\n\n/** Represents an input on a block with a statement connection. */\nexport class StatementInput extends Input {\n  readonly type = inputTypes.STATEMENT;\n\n  public connection: Connection;\n\n  /**\n   * @param name Language-neutral identifier which may used to find this input\n   *     again.\n   * @param block The block containing this input.\n   */\n  constructor(\n    public name: string,\n    block: Block,\n  ) {\n    // Errors are maintained for people not using typescript.\n    if (!name) throw new Error('Statement inputs must have a non-empty name');\n\n    super(name, block);\n    this.connection = this.makeConnection(ConnectionType.NEXT_STATEMENT);\n  }\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {Block} from '../block.js';\nimport {ConnectionType} from '../connection_type.js';\nimport {Input} from './input.js';\nimport {inputTypes} from './input_types.js';\n\n/** Represents an input on a block with a value connection. */\nexport class ValueInput extends Input {\n  readonly type = inputTypes.VALUE;\n\n  /**\n   * @param name Language-neutral identifier which may used to find this input\n   *     again.\n   * @param block The block containing this input.\n   */\n  constructor(\n    public name: string,\n    block: Block,\n  ) {\n    // Errors are maintained for people not using typescript.\n    if (!name) throw new Error('Value inputs must have a non-empty name');\n    super(name, block);\n    this.connection = this.makeConnection(ConnectionType.INPUT_VALUE);\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.RenderInfo\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport {Input} from '../../inputs/input.js';\nimport {Align} from '../../inputs/align.js';\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {Measurable} from '../measurables/base.js';\nimport {BottomRow} from '../measurables/bottom_row.js';\nimport {DummyInput} from '../../inputs/dummy_input.js';\nimport {EndRowInput} from '../../inputs/end_row_input.js';\nimport {ExternalValueInput} from '../measurables/external_value_input.js';\nimport {Field} from '../measurables/field.js';\nimport {Hat} from '../measurables/hat.js';\nimport {Icon} from '../measurables/icon.js';\nimport {InRowSpacer} from '../measurables/in_row_spacer.js';\nimport {InlineInput} from '../measurables/inline_input.js';\nimport {InputRow} from '../measurables/input_row.js';\nimport {JaggedEdge} from '../measurables/jagged_edge.js';\nimport {NextConnection} from '../measurables/next_connection.js';\nimport {OutputConnection} from '../measurables/output_connection.js';\nimport {PreviousConnection} from '../measurables/previous_connection.js';\nimport {RoundCorner} from '../measurables/round_corner.js';\nimport type {Row} from '../measurables/row.js';\nimport {SpacerRow} from '../measurables/spacer_row.js';\nimport {SquareCorner} from '../measurables/square_corner.js';\nimport {StatementInput as StatementInputMeasurable} from '../measurables/statement_input.js';\nimport {StatementInput} from '../../inputs/statement_input.js';\nimport {TopRow} from '../measurables/top_row.js';\nimport {Types} from '../measurables/types.js';\nimport {ValueInput} from '../../inputs/value_input.js';\n\nimport type {ConstantProvider} from './constants.js';\nimport type {Renderer} from './renderer.js';\nimport {Connection} from '../measurables/connection.js';\n\n/**\n * An object containing all sizing information needed to draw this block.\n *\n * This measure pass does not propagate changes to the block (although fields\n * may choose to rerender when getSize() is called).  However, calling it\n * repeatedly may be expensive.\n */\nexport class RenderInfo {\n  block_: BlockSvg;\n  protected constants_: ConstantProvider;\n  outputConnection: OutputConnection | null;\n  isInline: boolean;\n  isCollapsed: boolean;\n  isInsertionMarker: boolean;\n  RTL: boolean;\n\n  /** The block renderer in use. */\n  protected readonly renderer_!: Renderer;\n\n  /** The height of the rendered block, including child blocks. */\n  height = 0;\n\n  /** The width of the rendered block, including child blocks. */\n  widthWithChildren = 0;\n\n  /**\n   * The width of the rendered block, excluding child blocks.  This is the\n   * right edge of the block when rendered LTR.\n   */\n  width = 0;\n  statementEdge = 0;\n\n  /** An array of Row objects containing sizing information. */\n  rows: Row[] = [];\n\n  /** An array of input rows on the block. */\n  inputRows: InputRow[] = [];\n\n  topRow: TopRow;\n  bottomRow: BottomRow;\n\n  // The position of the start point for drawing, relative to the block's\n  // location.\n  startX = 0;\n  startY = 0;\n\n  /**\n   * @param renderer The renderer in use.\n   * @param block The block to measure.\n   */\n  constructor(renderer: Renderer, block: BlockSvg) {\n    this.renderer_ = renderer;\n\n    this.block_ = block;\n\n    /** The renderer's constant provider. */\n    this.constants_ = this.renderer_.getConstants();\n\n    /**\n     * A measurable representing the output connection if the block has one.\n     * Otherwise null.\n     */\n    this.outputConnection = block.outputConnection\n      ? new OutputConnection(this.constants_, block.outputConnection)\n      : null;\n\n    /**\n     * Whether the block should be rendered as a single line, either because\n     * it's inline or because it has been collapsed.\n     */\n    this.isInline = block.getInputsInline() && !block.isCollapsed();\n\n    /** Whether the block is collapsed. */\n    this.isCollapsed = block.isCollapsed();\n\n    /**\n     * Whether the block is an insertion marker.  Insertion markers are the same\n     * shape as normal blocks, but don't show fields.\n     */\n    this.isInsertionMarker = block.isInsertionMarker();\n\n    /** True if the block should be rendered right-to-left. */\n    this.RTL = block.RTL;\n\n    /**\n     * An object with rendering information about the top row of the block.\n     */\n    this.topRow = new TopRow(this.constants_);\n\n    /**\n     * An object with rendering information about the bottom row of the block.\n     */\n    this.bottomRow = new BottomRow(this.constants_);\n  }\n\n  /**\n   * Get the block renderer in use.\n   *\n   * @returns The block renderer in use.\n   */\n  getRenderer(): Renderer {\n    return this.renderer_;\n  }\n\n  /**\n   * Populate this object with all sizing information needed to draw the block.\n   *\n   * This measure pass does not propagate changes to the block (although fields\n   * may choose to rerender when getSize() is called).  However, calling it\n   * repeatedly may be expensive.\n   */\n  measure() {\n    this.createRows_();\n    this.addElemSpacing_();\n    this.addRowSpacing_();\n    this.computeBounds_();\n    this.alignRowElements_();\n    this.finalize_();\n  }\n\n  /**\n   * Create rows of Measurable objects representing all renderable parts of the\n   * block.\n   */\n  protected createRows_() {\n    this.populateTopRow_();\n    this.rows.push(this.topRow);\n    let activeRow = new InputRow(this.constants_);\n    this.inputRows.push(activeRow);\n\n    // Icons always go on the first row, before anything else.\n    const icons = this.block_.getIcons();\n    for (let i = 0, icon; (icon = icons[i]); i++) {\n      const iconInfo = new Icon(this.constants_, icon);\n      if (!this.isCollapsed || icon.isShownWhenCollapsed()) {\n        activeRow.elements.push(iconInfo);\n      }\n    }\n\n    let lastInput = undefined;\n    // Loop across all of the inputs on the block, creating objects for anything\n    // that needs to be rendered and breaking the block up into visual rows.\n    for (let i = 0, input; (input = this.block_.inputList[i]); i++) {\n      if (!input.isVisible()) {\n        continue;\n      }\n      if (this.shouldStartNewRow_(input, lastInput)) {\n        // Finish this row and create a new one.\n        this.rows.push(activeRow);\n        activeRow = new InputRow(this.constants_);\n        this.inputRows.push(activeRow);\n      }\n\n      // All of the fields in an input go on the same row.\n      for (let j = 0, field; (field = input.fieldRow[j]); j++) {\n        activeRow.elements.push(new Field(this.constants_, field, input));\n      }\n      this.addInput_(input, activeRow);\n      lastInput = input;\n    }\n\n    if (this.isCollapsed) {\n      activeRow.hasJaggedEdge = true;\n      activeRow.elements.push(new JaggedEdge(this.constants_));\n    }\n\n    if (activeRow.elements.length || activeRow.hasDummyInput) {\n      this.rows.push(activeRow);\n    }\n    this.populateBottomRow_();\n    this.rows.push(this.bottomRow);\n  }\n\n  /**\n   * Create all non-spacer elements that belong on the top row.\n   */\n  protected populateTopRow_() {\n    const hasPrevious = !!this.block_.previousConnection;\n    const hasHat =\n      (this.block_.hat\n        ? this.block_.hat === 'cap'\n        : this.constants_.ADD_START_HATS) &&\n      !this.outputConnection &&\n      !hasPrevious;\n\n    let cornerClass = this.topRow.hasLeftSquareCorner(this.block_)\n      ? SquareCorner\n      : RoundCorner;\n    this.topRow.elements.push(new cornerClass(this.constants_));\n\n    if (hasHat) {\n      const hat = new Hat(this.constants_);\n      this.topRow.elements.push(hat);\n      this.topRow.capline = hat.ascenderHeight;\n    } else if (hasPrevious) {\n      this.topRow.hasPreviousConnection = true;\n      this.topRow.connection = new PreviousConnection(\n        this.constants_,\n        this.block_.previousConnection as RenderedConnection,\n      );\n      this.topRow.elements.push(this.topRow.connection);\n    }\n\n    const precedesStatement =\n      this.block_.inputList.length &&\n      this.block_.inputList[0] instanceof StatementInput;\n\n    // This is the minimum height for the row. If one of its elements has a\n    // greater height it will be overwritten in the compute pass.\n    if (precedesStatement && !this.block_.isCollapsed()) {\n      this.topRow.minHeight =\n        this.constants_.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT;\n    } else {\n      this.topRow.minHeight = this.constants_.TOP_ROW_MIN_HEIGHT;\n    }\n\n    cornerClass = this.topRow.hasRightSquareCorner(this.block_)\n      ? SquareCorner\n      : RoundCorner;\n    this.topRow.elements.push(new cornerClass(this.constants_, 'right'));\n  }\n\n  /**\n   * Create all non-spacer elements that belong on the bottom row.\n   */\n  protected populateBottomRow_() {\n    this.bottomRow.hasNextConnection = !!this.block_.nextConnection;\n\n    const followsStatement =\n      this.block_.inputList.length &&\n      this.block_.inputList[this.block_.inputList.length - 1] instanceof\n        StatementInput;\n\n    // This is the minimum height for the row. If one of its elements has a\n    // greater height it will be overwritten in the compute pass.\n    if (followsStatement) {\n      this.bottomRow.minHeight =\n        this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT;\n    } else {\n      this.bottomRow.minHeight = this.constants_.BOTTOM_ROW_MIN_HEIGHT;\n    }\n\n    const leftSquareCorner = this.bottomRow.hasLeftSquareCorner(this.block_);\n\n    if (leftSquareCorner) {\n      this.bottomRow.elements.push(new SquareCorner(this.constants_));\n    } else {\n      this.bottomRow.elements.push(new RoundCorner(this.constants_));\n    }\n\n    if (this.bottomRow.hasNextConnection) {\n      this.bottomRow.connection = new NextConnection(\n        this.constants_,\n        this.block_.nextConnection as RenderedConnection,\n      );\n      this.bottomRow.elements.push(this.bottomRow.connection);\n    }\n\n    const rightSquareCorner = this.bottomRow.hasRightSquareCorner(this.block_);\n\n    if (rightSquareCorner) {\n      this.bottomRow.elements.push(new SquareCorner(this.constants_, 'right'));\n    } else {\n      this.bottomRow.elements.push(new RoundCorner(this.constants_, 'right'));\n    }\n  }\n\n  /**\n   * Add an input element to the active row, if needed, and record the type of\n   * the input on the row.\n   *\n   * @param input The input to record information about.\n   * @param activeRow The row that is currently being populated.\n   */\n  protected addInput_(input: Input, activeRow: Row) {\n    // Non-dummy inputs have visual representations onscreen.\n    if (this.isInline && input instanceof ValueInput) {\n      activeRow.elements.push(new InlineInput(this.constants_, input));\n      activeRow.hasInlineInput = true;\n    } else if (input instanceof StatementInput) {\n      activeRow.elements.push(\n        new StatementInputMeasurable(this.constants_, input),\n      );\n      activeRow.hasStatement = true;\n    } else if (input instanceof ValueInput) {\n      activeRow.elements.push(new ExternalValueInput(this.constants_, input));\n      activeRow.hasExternalInput = true;\n    } else if (input instanceof DummyInput || input instanceof EndRowInput) {\n      // Dummy and end-row inputs have no visual representation, but the\n      // information is still important.\n      activeRow.minHeight = Math.max(\n        activeRow.minHeight,\n        input.getSourceBlock() && input.getSourceBlock()!.isShadow()\n          ? this.constants_.DUMMY_INPUT_SHADOW_MIN_HEIGHT\n          : this.constants_.DUMMY_INPUT_MIN_HEIGHT,\n      );\n      activeRow.hasDummyInput = true;\n    }\n    if (activeRow.align === null) {\n      activeRow.align = input.align;\n    }\n  }\n\n  /**\n   * Decide whether to start a new row between the two Blockly.Inputs.\n   *\n   * @param currInput The current input.\n   * @param prevInput The previous input.\n   * @returns True if the current input should be rendered on a new row.\n   */\n  protected shouldStartNewRow_(currInput: Input, prevInput?: Input): boolean {\n    // If this is the first input, just add to the existing row.\n    // That row is either empty or has some icons in it.\n    if (!prevInput) {\n      return false;\n    }\n    // If the previous input was an end-row input, then any following input\n    // should always be rendered on the next row.\n    if (prevInput instanceof EndRowInput) {\n      return true;\n    }\n    // A statement input or an input following one always gets a new row.\n    if (\n      currInput instanceof StatementInput ||\n      prevInput instanceof StatementInput\n    ) {\n      return true;\n    }\n    // Value inputs, dummy inputs, and any input following an external value\n    // input get a new row if inputs are not inlined.\n    if (\n      currInput instanceof ValueInput ||\n      currInput instanceof DummyInput ||\n      prevInput instanceof ValueInput\n    ) {\n      return !this.isInline;\n    }\n    return false;\n  }\n\n  /** Add horizontal spacing between and around elements within each row. */\n  protected addElemSpacing_() {\n    for (let i = 0, row; (row = this.rows[i]); i++) {\n      const oldElems = row.elements;\n      row.elements = [];\n      // No spacing needed before the corner on the top row or the bottom row.\n      if (row.startsWithElemSpacer()) {\n        // There's a spacer before the first element in the row.\n        row.elements.push(\n          new InRowSpacer(\n            this.constants_,\n            this.getInRowSpacing_(null, oldElems[0]),\n          ),\n        );\n      }\n      if (!oldElems.length) {\n        continue;\n      }\n      for (let e = 0; e < oldElems.length - 1; e++) {\n        row.elements.push(oldElems[e]);\n        const spacing = this.getInRowSpacing_(oldElems[e], oldElems[e + 1]);\n        row.elements.push(new InRowSpacer(this.constants_, spacing));\n      }\n      row.elements.push(oldElems[oldElems.length - 1]);\n      if (row.endsWithElemSpacer()) {\n        // There's a spacer after the last element in the row.\n        row.elements.push(\n          new InRowSpacer(\n            this.constants_,\n            this.getInRowSpacing_(oldElems[oldElems.length - 1], null),\n          ),\n        );\n      }\n    }\n  }\n\n  /**\n   * Calculate the width of a spacer element in a row based on the previous and\n   * next elements in that row.  For instance, extra padding is added between\n   * two editable fields.\n   *\n   * @param prev The element before the spacer.\n   * @param next The element after the spacer.\n   * @returns The size of the spacing between the two elements.\n   */\n  protected getInRowSpacing_(\n    prev: Measurable | null,\n    next: Measurable | null,\n  ): number {\n    if (!prev) {\n      // Statement input padding.\n      if (next && Types.isStatementInput(next)) {\n        return this.constants_.STATEMENT_INPUT_PADDING_LEFT;\n      }\n    }\n    // Between inputs and the end of the row.\n    if (prev && Types.isInput(prev) && !next) {\n      if (Types.isExternalInput(prev)) {\n        return this.constants_.NO_PADDING;\n      } else if (Types.isInlineInput(prev)) {\n        return this.constants_.LARGE_PADDING;\n      } else if (Types.isStatementInput(prev)) {\n        return this.constants_.NO_PADDING;\n      }\n    }\n\n    // Spacing between a square corner and a previous or next connection\n    if (prev && Types.isLeftSquareCorner(prev) && next) {\n      if (Types.isPreviousConnection(next) || Types.isNextConnection(next)) {\n        return next.notchOffset;\n      }\n    }\n\n    // Spacing between a rounded corner and a previous or next connection.\n    if (prev && Types.isLeftRoundedCorner(prev) && next) {\n      if (Types.isPreviousConnection(next) || Types.isNextConnection(next)) {\n        return next.notchOffset - this.constants_.CORNER_RADIUS;\n      }\n    }\n\n    return this.constants_.MEDIUM_PADDING;\n  }\n\n  /**\n   * Figure out where the right edge of the block and right edge of statement\n   * inputs should be placed.\n   */\n  protected computeBounds_() {\n    let widestStatementRowFields = 0;\n    let blockWidth = 0;\n    let widestRowWithConnectedBlocks = 0;\n    for (let i = 0, row; (row = this.rows[i]); i++) {\n      row.measure();\n      blockWidth = Math.max(blockWidth, row.width);\n      if (row.hasStatement) {\n        const statementInput = row.getLastInput();\n        const innerWidth = row.width - (statementInput?.width ?? 0);\n        widestStatementRowFields = Math.max(\n          widestStatementRowFields,\n          innerWidth,\n        );\n      }\n      widestRowWithConnectedBlocks = Math.max(\n        widestRowWithConnectedBlocks,\n        row.widthWithConnectedBlocks,\n      );\n    }\n\n    this.statementEdge = widestStatementRowFields;\n    this.width = blockWidth;\n\n    for (let i = 0, row; (row = this.rows[i]); i++) {\n      if (row.hasStatement) {\n        row.statementEdge = this.statementEdge;\n      }\n    }\n\n    this.widthWithChildren = Math.max(blockWidth, widestRowWithConnectedBlocks);\n\n    if (this.outputConnection) {\n      this.startX = this.outputConnection.width;\n      this.width += this.outputConnection.width;\n      this.widthWithChildren += this.outputConnection.width;\n    }\n  }\n\n  /**\n   * Extra spacing may be necessary to make sure that the right sides of all\n   * rows line up.  This can only be calculated after a first pass to calculate\n   * the sizes of all rows.\n   */\n  protected alignRowElements_() {\n    for (let i = 0, row; (row = this.rows[i]); i++) {\n      if (row.hasStatement) {\n        this.alignStatementRow_(row as InputRow);\n      } else {\n        const currentWidth = row.width;\n        const desiredWidth = this.getDesiredRowWidth_(row);\n        const missingSpace = desiredWidth - currentWidth;\n        if (missingSpace > 0) {\n          this.addAlignmentPadding_(row, missingSpace);\n        }\n        if (Types.isTopOrBottomRow(row)) {\n          row.widthWithConnectedBlocks = row.width;\n        }\n      }\n    }\n  }\n\n  /**\n   * Calculate the desired width of an input row.\n   *\n   * @param _row The input row.\n   * @returns The desired width of the input row.\n   */\n  protected getDesiredRowWidth_(_row: Row): number {\n    return this.width - this.startX;\n  }\n\n  /**\n   * Modify the given row to add the given amount of padding around its fields.\n   * The exact location of the padding is based on the alignment property of the\n   * last input in the field.\n   *\n   * @param row The row to add padding to.\n   * @param missingSpace How much padding to add.\n   */\n  protected addAlignmentPadding_(row: Row, missingSpace: number) {\n    const firstSpacer = row.getFirstSpacer();\n    const lastSpacer = row.getLastSpacer();\n    if (row.hasExternalInput || row.hasStatement) {\n      row.widthWithConnectedBlocks += missingSpace;\n    }\n\n    // Decide where the extra padding goes.\n    if (row.align === Align.LEFT && lastSpacer) {\n      // Add padding to the end of the row.\n      lastSpacer.width += missingSpace;\n    } else if (row.align === Align.CENTRE && firstSpacer && lastSpacer) {\n      // Split the padding between the beginning and end of the row.\n      firstSpacer.width += missingSpace / 2;\n      lastSpacer.width += missingSpace / 2;\n    } else if (row.align === Align.RIGHT && firstSpacer) {\n      // Add padding at the beginning of the row.\n      firstSpacer.width += missingSpace;\n    } else if (lastSpacer) {\n      // Default to left-aligning.\n      lastSpacer.width += missingSpace;\n    } else {\n      return;\n    }\n    row.width += missingSpace;\n  }\n\n  /**\n   * Align the elements of a statement row based on computed bounds.\n   * Unlike other types of rows, statement rows add space in multiple places.\n   *\n   * @param row The statement row to resize.\n   */\n  protected alignStatementRow_(row: InputRow) {\n    const statementInput = row.getLastInput();\n    if (!statementInput) return;\n    let currentWidth = row.width - statementInput.width;\n    let desiredWidth = this.statementEdge;\n    // Add padding before the statement input.\n    const missingSpace = desiredWidth - currentWidth;\n    if (missingSpace > 0) {\n      this.addAlignmentPadding_(row, missingSpace);\n    }\n    // Also widen the statement input to reach to the right side of the\n    // block. Note that this does not add padding.\n    currentWidth = row.width;\n    desiredWidth = this.getDesiredRowWidth_(row);\n    statementInput.width += desiredWidth - currentWidth;\n    statementInput.height = Math.max(statementInput.height, row.height);\n    row.width += desiredWidth - currentWidth;\n    row.widthWithConnectedBlocks = Math.max(\n      row.width,\n      this.statementEdge + row.connectedBlockWidths,\n    );\n  }\n\n  /** Add spacers between rows and set their sizes. */\n  protected addRowSpacing_() {\n    const oldRows = this.rows;\n    this.rows = [];\n\n    for (let r = 0; r < oldRows.length; r++) {\n      this.rows.push(oldRows[r]);\n      if (r !== oldRows.length - 1) {\n        this.rows.push(this.makeSpacerRow_(oldRows[r], oldRows[r + 1]));\n      }\n    }\n  }\n\n  /**\n   * Create a spacer row to go between prev and next, and set its size.\n   *\n   * @param prev The previous row.\n   * @param next The next row.\n   * @returns The newly created spacer row.\n   */\n  protected makeSpacerRow_(prev: Row, next: Row): SpacerRow {\n    const height = this.getSpacerRowHeight_(prev, next);\n    const width = this.getSpacerRowWidth_(prev, next);\n    const spacer = new SpacerRow(this.constants_, height, width);\n    if (prev.hasStatement) {\n      spacer.followsStatement = true;\n    }\n    if (next.hasStatement) {\n      spacer.precedesStatement = true;\n    }\n    return spacer;\n  }\n\n  /**\n   * Calculate the width of a spacer row.\n   *\n   * @param _prev The row before the spacer.\n   * @param _next The row after the spacer.\n   * @returns The desired width of the spacer row between these two rows.\n   */\n  protected getSpacerRowWidth_(_prev: Row, _next: Row): number {\n    return this.width - this.startX;\n  }\n\n  /**\n   * Calculate the height of a spacer row.\n   *\n   * @param _prev The row before the spacer.\n   * @param _next The row after the spacer.\n   * @returns The desired height of the spacer row between these two rows.\n   */\n  protected getSpacerRowHeight_(_prev: Row, _next: Row): number {\n    return this.constants_.MEDIUM_PADDING;\n  }\n\n  /**\n   * Calculate the centerline of an element in a rendered row.\n   * This base implementation puts the centerline at the middle of the row\n   * vertically, with no special cases.  You will likely need extra logic to\n   * handle (at minimum) top and bottom rows.\n   *\n   * @param row The row containing the element.\n   * @param elem The element to place.\n   * @returns The desired centerline of the given element, as an offset from the\n   *     top left of the block.\n   */\n  protected getElemCenterline_(row: Row, elem: Measurable): number {\n    if (Types.isSpacer(elem)) {\n      return row.yPos + elem.height / 2;\n    }\n    if (Types.isBottomRow(row)) {\n      const bottomRow = row as BottomRow;\n      const baseline =\n        bottomRow.yPos + bottomRow.height - bottomRow.descenderHeight;\n      if (Types.isNextConnection(elem)) {\n        return baseline + elem.height / 2;\n      }\n      return baseline - elem.height / 2;\n    }\n    if (Types.isTopRow(row)) {\n      const topRow = row as TopRow;\n      if (Types.isHat(elem)) {\n        return topRow.capline - elem.height / 2;\n      }\n      return topRow.capline + elem.height / 2;\n    }\n    return row.yPos + row.height / 2;\n  }\n\n  /**\n   * Record final position information on elements on the given row, for use in\n   * drawing.  At minimum this records xPos and centerline on each element.\n   *\n   * @param row The row containing the elements.\n   */\n  protected recordElemPositions_(row: Row) {\n    let xCursor = row.xPos;\n    for (let j = 0, elem; (elem = row.elements[j]); j++) {\n      // Now that row heights are finalized, make spacers use the row height.\n      if (Types.isSpacer(elem)) {\n        elem.height = row.height;\n      }\n      elem.xPos = xCursor;\n      elem.centerline = this.getElemCenterline_(row, elem);\n      xCursor += elem.width;\n    }\n  }\n\n  /**\n   * Make any final changes to the rendering information object.  In particular,\n   * store the y position of each row, and record the height of the full block.\n   */\n  protected finalize_() {\n    // Performance note: this could be combined with the draw pass, if the time\n    // that this takes is excessive.  But it shouldn't be, because it only\n    // accesses and sets properties that already exist on the objects.\n    let widestRowWithConnectedBlocks = 0;\n    let yCursor = 0;\n    for (let i = 0, row; (row = this.rows[i]); i++) {\n      row.yPos = yCursor;\n      row.xPos = this.startX;\n      yCursor += row.height;\n\n      widestRowWithConnectedBlocks = Math.max(\n        widestRowWithConnectedBlocks,\n        row.widthWithConnectedBlocks,\n      );\n      this.recordElemPositions_(row);\n    }\n    if (this.outputConnection && this.block_.nextConnection) {\n      const target = this.block_.nextConnection.targetBlock();\n      if (target) {\n        // Include width of connected block in value to stack width measurement.\n        widestRowWithConnectedBlocks = Math.max(\n          widestRowWithConnectedBlocks,\n          target.getHeightWidth().width,\n        );\n      }\n    }\n\n    this.widthWithChildren = widestRowWithConnectedBlocks + this.startX;\n\n    this.height = yCursor;\n    this.startY = this.topRow.capline;\n    this.bottomRow.baseline = yCursor - this.bottomRow.descenderHeight;\n  }\n\n  /** Returns the connection measurable associated with the given connection. */\n  getMeasureableForConnection(conn: RenderedConnection): Connection | null {\n    if (this.outputConnection?.connectionModel === conn) {\n      return this.outputConnection;\n    }\n\n    for (const row of this.rows) {\n      for (const elem of row.elements) {\n        if (elem instanceof Connection && elem.connectionModel === conn) {\n          return elem;\n        }\n      }\n    }\n\n    return null;\n  }\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Events fired as a result of a marker move.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.MarkerMove\n\nimport type {Block} from '../block.js';\nimport {ASTNode} from '../keyboard_nav/ast_node.js';\nimport * as registry from '../registry.js';\nimport type {Workspace} from '../workspace.js';\nimport {AbstractEventJson} from './events_abstract.js';\n\nimport {UiBase} from './events_ui_base.js';\nimport * as eventUtils from './utils.js';\n\n/**\n * Notifies listeners that a marker (used for keyboard navigation) has\n * moved.\n */\nexport class MarkerMove extends UiBase {\n  /** The ID of the block the marker is now on, if any. */\n  blockId?: string;\n\n  /** The old node the marker used to be on, if any. */\n  oldNode?: ASTNode;\n\n  /** The new node the marker is now on. */\n  newNode?: ASTNode;\n\n  /**\n   * True if this is a cursor event, false otherwise.\n   * For information about cursors vs markers see {@link\n   * https://blocklycodelabs.dev/codelabs/keyboard-navigation/index.html?index=..%2F..index#1}.\n   */\n  isCursor?: boolean;\n\n  override type = eventUtils.MARKER_MOVE;\n\n  /**\n   * @param opt_block The affected block. Null if current node is of type\n   *     workspace. Undefined for a blank event.\n   * @param isCursor Whether this is a cursor event. Undefined for a blank\n   *     event.\n   * @param opt_oldNode The old node the marker used to be on.\n   *    Undefined for a blank event.\n   * @param opt_newNode The new node the marker is now on.\n   *    Undefined for a blank event.\n   */\n  constructor(\n    opt_block?: Block | null,\n    isCursor?: boolean,\n    opt_oldNode?: ASTNode | null,\n    opt_newNode?: ASTNode,\n  ) {\n    let workspaceId = opt_block ? opt_block.workspace.id : undefined;\n    if (opt_newNode && opt_newNode.getType() === ASTNode.types.WORKSPACE) {\n      workspaceId = (opt_newNode.getLocation() as Workspace).id;\n    }\n    super(workspaceId);\n\n    this.blockId = opt_block?.id;\n    this.oldNode = opt_oldNode || undefined;\n    this.newNode = opt_newNode;\n    this.isCursor = isCursor;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): MarkerMoveJson {\n    const json = super.toJson() as MarkerMoveJson;\n    if (this.isCursor === undefined) {\n      throw new Error(\n        'Whether this is a cursor event or not is undefined. Either pass ' +\n          'a value to the constructor, or call fromJson',\n      );\n    }\n    if (!this.newNode) {\n      throw new Error(\n        'The new node is undefined. Either pass a node to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    json['isCursor'] = this.isCursor;\n    json['blockId'] = this.blockId;\n    json['oldNode'] = this.oldNode;\n    json['newNode'] = this.newNode;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of MarkerMove, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: MarkerMoveJson,\n    workspace: Workspace,\n    event?: any,\n  ): MarkerMove {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new MarkerMove(),\n    ) as MarkerMove;\n    newEvent.isCursor = json['isCursor'];\n    newEvent.blockId = json['blockId'];\n    newEvent.oldNode = json['oldNode'];\n    newEvent.newNode = json['newNode'];\n    return newEvent;\n  }\n}\n\nexport interface MarkerMoveJson extends AbstractEventJson {\n  isCursor: boolean;\n  blockId?: string;\n  oldNode?: ASTNode;\n  newNode: ASTNode;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.MARKER_MOVE, MarkerMove);\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.MarkerSvg\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport '../../events/events_marker_move.js';\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {Connection} from '../../connection.js';\nimport {ConnectionType} from '../../connection_type.js';\nimport * as eventUtils from '../../events/utils.js';\nimport type {Field} from '../../field.js';\nimport type {IASTNodeLocationSvg} from '../../interfaces/i_ast_node_location_svg.js';\nimport {ASTNode} from '../../keyboard_nav/ast_node.js';\nimport type {Marker} from '../../keyboard_nav/marker.js';\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport * as dom from '../../utils/dom.js';\nimport {Svg} from '../../utils/svg.js';\nimport * as svgPaths from '../../utils/svg_paths.js';\nimport type {WorkspaceSvg} from '../../workspace_svg.js';\n\nimport type {ConstantProvider, Notch, PuzzleTab} from './constants.js';\n\n/** The name of the CSS class for a cursor. */\nconst CURSOR_CLASS = 'blocklyCursor';\n\n/** The name of the CSS class for a marker. */\nconst MARKER_CLASS = 'blocklyMarker';\n\n/**\n * What we multiply the height by to get the height of the marker.\n * Only used for the block and block connections.\n */\nconst HEIGHT_MULTIPLIER = 3 / 4;\n\n/**\n * Class for a marker, containing methods for graphically rendering a marker as\n * SVG.\n */\nexport class MarkerSvg {\n  /**\n   * The workspace, field, or block that the marker SVG element should be\n   * attached to.\n   */\n  private parent: IASTNodeLocationSvg | null = null;\n\n  /** The current SVG element for the marker. */\n  currentMarkerSvg: SVGElement | null = null;\n  colour_: string;\n\n  /** The root SVG group containing the marker. */\n  protected markerSvg_: SVGGElement | null = null;\n  protected svgGroup_: SVGGElement | null = null;\n\n  protected markerBlock_: SVGPathElement | null = null;\n\n  protected markerInput_: SVGPathElement | null = null;\n  protected markerSvgLine_: SVGRectElement | null = null;\n\n  protected markerSvgRect_: SVGRectElement | null = null;\n\n  /** The constants necessary to draw the marker. */\n  protected constants_: ConstantProvider;\n\n  /**\n   * @param workspace The workspace the marker belongs to.\n   * @param constants The constants for the renderer.\n   * @param marker The marker to draw.\n   */\n  constructor(\n    private readonly workspace: WorkspaceSvg,\n    constants: ConstantProvider,\n    private readonly marker: Marker,\n  ) {\n    this.constants_ = constants;\n\n    const defaultColour = this.isCursor()\n      ? this.constants_.CURSOR_COLOUR\n      : this.constants_.MARKER_COLOUR;\n\n    /** The colour of the marker. */\n    this.colour_ = marker.colour || defaultColour;\n  }\n\n  /**\n   * Return the root node of the SVG or null if none exists.\n   *\n   * @returns The root SVG node.\n   */\n  getSvgRoot(): SVGElement | null {\n    return this.svgGroup_;\n  }\n\n  /**\n   * Get the marker.\n   *\n   * @returns The marker to draw for.\n   */\n  getMarker(): Marker {\n    return this.marker;\n  }\n\n  /**\n   * True if the marker should be drawn as a cursor, false otherwise.\n   * A cursor is drawn as a flashing line. A marker is drawn as a solid line.\n   *\n   * @returns True if the marker is a cursor, false otherwise.\n   */\n  isCursor(): boolean {\n    return this.marker.type === 'cursor';\n  }\n\n  /**\n   * Create the DOM element for the marker.\n   *\n   * @returns The marker controls SVG group.\n   */\n  createDom(): SVGElement {\n    const className = this.isCursor() ? CURSOR_CLASS : MARKER_CLASS;\n\n    this.svgGroup_ = dom.createSvgElement(Svg.G, {'class': className});\n\n    this.createDomInternal_();\n    return this.svgGroup_;\n  }\n\n  /**\n   * Attaches the SVG root of the marker to the SVG group of the parent.\n   *\n   * @param newParent The workspace, field, or block that the marker SVG element\n   *     should be attached to.\n   */\n  protected setParent_(newParent: IASTNodeLocationSvg) {\n    if (!this.isCursor()) {\n      if (this.parent) {\n        this.parent.setMarkerSvg(null);\n      }\n      newParent.setMarkerSvg(this.getSvgRoot());\n    } else {\n      if (this.parent) {\n        this.parent.setCursorSvg(null);\n      }\n      newParent.setCursorSvg(this.getSvgRoot());\n    }\n    this.parent = newParent;\n  }\n\n  /**\n   * Update the marker.\n   *\n   * @param oldNode The previous node the marker was on or null.\n   * @param curNode The node that we want to draw the marker for.\n   */\n  draw(oldNode: ASTNode, curNode: ASTNode) {\n    if (!curNode) {\n      this.hide();\n      return;\n    }\n\n    this.constants_ = this.workspace.getRenderer().getConstants();\n\n    const defaultColour = this.isCursor()\n      ? this.constants_.CURSOR_COLOUR\n      : this.constants_.MARKER_COLOUR;\n    this.colour_ = this.marker.colour || defaultColour;\n    this.applyColour_(curNode);\n\n    this.showAtLocation_(curNode);\n\n    this.fireMarkerEvent(oldNode, curNode);\n\n    // Ensures the marker will be visible immediately after the move.\n    const animate = this.currentMarkerSvg!.childNodes[0];\n    if (animate !== undefined) {\n      (animate as SVGAnimationElement).beginElement &&\n        (animate as SVGAnimationElement).beginElement();\n    }\n  }\n\n  /**\n   * Update the marker's visible state based on the type of curNode..\n   *\n   * @param curNode The node that we want to draw the marker for.\n   */\n  protected showAtLocation_(curNode: ASTNode) {\n    const curNodeAsConnection = curNode.getLocation() as Connection;\n    const connectionType = curNodeAsConnection.type;\n    if (curNode.getType() === ASTNode.types.BLOCK) {\n      this.showWithBlock_(curNode);\n    } else if (curNode.getType() === ASTNode.types.OUTPUT) {\n      this.showWithOutput_(curNode);\n    } else if (connectionType === ConnectionType.INPUT_VALUE) {\n      this.showWithInput_(curNode);\n    } else if (connectionType === ConnectionType.NEXT_STATEMENT) {\n      this.showWithNext_(curNode);\n    } else if (curNode.getType() === ASTNode.types.PREVIOUS) {\n      this.showWithPrevious_(curNode);\n    } else if (curNode.getType() === ASTNode.types.FIELD) {\n      this.showWithField_(curNode);\n    } else if (curNode.getType() === ASTNode.types.WORKSPACE) {\n      this.showWithCoordinates_(curNode);\n    } else if (curNode.getType() === ASTNode.types.STACK) {\n      this.showWithStack_(curNode);\n    }\n  }\n\n  /**************************\n   * Display\n   **************************/\n\n  /**\n   * Show the marker as a combination of the previous connection and block,\n   * the output connection and block, or just the block.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  private showWithBlockPrevOutput(curNode: ASTNode) {\n    const block = curNode.getSourceBlock() as BlockSvg;\n    const width = block.width;\n    const height = block.height;\n    const markerHeight = height * HEIGHT_MULTIPLIER;\n    const markerOffset = this.constants_.CURSOR_BLOCK_PADDING;\n\n    if (block.previousConnection) {\n      const connectionShape = this.constants_.shapeFor(\n        block.previousConnection,\n      ) as Notch;\n      this.positionPrevious_(\n        width,\n        markerOffset,\n        markerHeight,\n        connectionShape,\n      );\n    } else if (block.outputConnection) {\n      const connectionShape = this.constants_.shapeFor(\n        block.outputConnection,\n      ) as PuzzleTab;\n      this.positionOutput_(width, height, connectionShape);\n    } else {\n      this.positionBlock_(width, markerOffset, markerHeight);\n    }\n    this.setParent_(block);\n    this.showCurrent_();\n  }\n\n  /**\n   * Position and display the marker for a block.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  protected showWithBlock_(curNode: ASTNode) {\n    this.showWithBlockPrevOutput(curNode);\n  }\n\n  /**\n   * Position and display the marker for a previous connection.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  protected showWithPrevious_(curNode: ASTNode) {\n    this.showWithBlockPrevOutput(curNode);\n  }\n\n  /**\n   * Position and display the marker for an output connection.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  protected showWithOutput_(curNode: ASTNode) {\n    this.showWithBlockPrevOutput(curNode);\n  }\n\n  /**\n   * Position and display the marker for a workspace coordinate.\n   * This is a horizontal line.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  protected showWithCoordinates_(curNode: ASTNode) {\n    const wsCoordinate = curNode.getWsCoordinate();\n    let x = wsCoordinate.x;\n    const y = wsCoordinate.y;\n\n    if (this.workspace.RTL) {\n      x -= this.constants_.CURSOR_WS_WIDTH;\n    }\n\n    this.positionLine_(x, y, this.constants_.CURSOR_WS_WIDTH);\n    this.setParent_(this.workspace);\n    this.showCurrent_();\n  }\n\n  /**\n   * Position and display the marker for a field.\n   * This is a box around the field.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  protected showWithField_(curNode: ASTNode) {\n    const field = curNode.getLocation() as Field;\n    const width = field.getSize().width;\n    const height = field.getSize().height;\n\n    this.positionRect_(0, 0, width, height);\n    this.setParent_(field);\n    this.showCurrent_();\n  }\n\n  /**\n   * Position and display the marker for an input.\n   * This is a puzzle piece.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  protected showWithInput_(curNode: ASTNode) {\n    const connection = curNode.getLocation() as RenderedConnection;\n    const sourceBlock = connection.getSourceBlock();\n\n    this.positionInput_(connection);\n    this.setParent_(sourceBlock);\n    this.showCurrent_();\n  }\n\n  /**\n   * Position and display the marker for a next connection.\n   * This is a horizontal line.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  protected showWithNext_(curNode: ASTNode) {\n    const connection = curNode.getLocation() as RenderedConnection;\n    const targetBlock = connection.getSourceBlock();\n    let x = 0;\n    const y = connection.getOffsetInBlock().y;\n    const width = targetBlock.getHeightWidth().width;\n    if (this.workspace.RTL) {\n      x = -width;\n    }\n    this.positionLine_(x, y, width);\n    this.setParent_(targetBlock);\n    this.showCurrent_();\n  }\n\n  /**\n   * Position and display the marker for a stack.\n   * This is a box with extra padding around the entire stack of blocks.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  protected showWithStack_(curNode: ASTNode) {\n    const block = curNode.getLocation() as BlockSvg;\n\n    // Gets the height and width of entire stack.\n    const heightWidth = block.getHeightWidth();\n\n    // Add padding so that being on a stack looks different than being on a\n    // block.\n    const width = heightWidth.width + this.constants_.CURSOR_STACK_PADDING;\n    const height = heightWidth.height + this.constants_.CURSOR_STACK_PADDING;\n\n    // Shift the rectangle slightly to upper left so padding is equal on all\n    // sides.\n    const xPadding = -this.constants_.CURSOR_STACK_PADDING / 2;\n    const yPadding = -this.constants_.CURSOR_STACK_PADDING / 2;\n\n    let x = xPadding;\n    const y = yPadding;\n\n    if (this.workspace.RTL) {\n      x = -(width + xPadding);\n    }\n    this.positionRect_(x, y, width, height);\n    this.setParent_(block);\n    this.showCurrent_();\n  }\n\n  /** Show the current marker. */\n  protected showCurrent_() {\n    this.hide();\n    if (this.currentMarkerSvg) {\n      this.currentMarkerSvg.style.display = '';\n    }\n  }\n\n  /**************************\n   * Position\n   **************************/\n\n  /**\n   * Position the marker for a block.\n   * Displays an outline of the top half of a rectangle around a block.\n   *\n   * @param width The width of the block.\n   * @param markerOffset The extra padding for around the block.\n   * @param markerHeight The height of the marker.\n   */\n  protected positionBlock_(\n    width: number,\n    markerOffset: number,\n    markerHeight: number,\n  ) {\n    const markerPath =\n      svgPaths.moveBy(-markerOffset, markerHeight) +\n      svgPaths.lineOnAxis('V', -markerOffset) +\n      svgPaths.lineOnAxis('H', width + markerOffset * 2) +\n      svgPaths.lineOnAxis('V', markerHeight);\n    if (!this.markerBlock_) {\n      throw new Error(\n        'createDom should be called before positioning the marker',\n      );\n    }\n    this.markerBlock_.setAttribute('d', markerPath);\n    if (this.workspace.RTL) {\n      this.flipRtl(this.markerBlock_);\n    }\n    this.currentMarkerSvg = this.markerBlock_;\n  }\n\n  /**\n   * Position the marker for an input connection.\n   * Displays a filled in puzzle piece.\n   *\n   * @param connection The connection to position marker around.\n   */\n  protected positionInput_(connection: RenderedConnection) {\n    const x = connection.getOffsetInBlock().x;\n    const y = connection.getOffsetInBlock().y;\n\n    const path =\n      svgPaths.moveTo(0, 0) +\n      (this.constants_.shapeFor(connection) as PuzzleTab).pathDown;\n\n    this.markerInput_!.setAttribute('d', path);\n    this.markerInput_!.setAttribute(\n      'transform',\n      'translate(' +\n        x +\n        ',' +\n        y +\n        ')' +\n        (this.workspace.RTL ? ' scale(-1 1)' : ''),\n    );\n    this.currentMarkerSvg = this.markerInput_;\n  }\n\n  /**\n   * Move and show the marker at the specified coordinate in workspace units.\n   * Displays a horizontal line.\n   *\n   * @param x The new x, in workspace units.\n   * @param y The new y, in workspace units.\n   * @param width The new width, in workspace units.\n   */\n  protected positionLine_(x: number, y: number, width: number) {\n    if (!this.markerSvgLine_) {\n      throw new Error('createDom should be called before positioning the line');\n    }\n    this.markerSvgLine_.setAttribute('x', `${x}`);\n    this.markerSvgLine_.setAttribute('y', `${y}`);\n    this.markerSvgLine_.setAttribute('width', `${width}`);\n    this.currentMarkerSvg = this.markerSvgLine_;\n  }\n\n  /**\n   * Position the marker for an output connection.\n   * Displays a puzzle outline and the top and bottom path.\n   *\n   * @param width The width of the block.\n   * @param height The height of the block.\n   * @param connectionShape The shape object for the connection.\n   */\n  protected positionOutput_(\n    width: number,\n    height: number,\n    connectionShape: PuzzleTab,\n  ) {\n    if (!this.markerBlock_) {\n      throw new Error(\n        'createDom should be called before positioning the output',\n      );\n    }\n    const markerPath =\n      svgPaths.moveBy(width, 0) +\n      svgPaths.lineOnAxis('h', -(width - connectionShape.width)) +\n      svgPaths.lineOnAxis('v', this.constants_.TAB_OFFSET_FROM_TOP) +\n      connectionShape.pathDown +\n      svgPaths.lineOnAxis('V', height) +\n      svgPaths.lineOnAxis('H', width);\n    this.markerBlock_.setAttribute('d', markerPath);\n    if (this.workspace.RTL) {\n      this.flipRtl(this.markerBlock_);\n    }\n    this.currentMarkerSvg = this.markerBlock_;\n  }\n\n  /**\n   * Position the marker for a previous connection.\n   * Displays a half rectangle with a notch in the top to represent the previous\n   * connection.\n   *\n   * @param width The width of the block.\n   * @param markerOffset The offset of the marker from around the block.\n   * @param markerHeight The height of the marker.\n   * @param connectionShape The shape object for the connection.\n   */\n  protected positionPrevious_(\n    width: number,\n    markerOffset: number,\n    markerHeight: number,\n    connectionShape: Notch,\n  ) {\n    if (!this.markerBlock_) {\n      throw new Error(\n        'createDom should be called before positioning the previous connection marker',\n      );\n    }\n    const markerPath =\n      svgPaths.moveBy(-markerOffset, markerHeight) +\n      svgPaths.lineOnAxis('V', -markerOffset) +\n      svgPaths.lineOnAxis('H', this.constants_.NOTCH_OFFSET_LEFT) +\n      connectionShape.pathLeft +\n      svgPaths.lineOnAxis('H', width + markerOffset * 2) +\n      svgPaths.lineOnAxis('V', markerHeight);\n    this.markerBlock_.setAttribute('d', markerPath);\n    if (this.workspace.RTL) {\n      this.flipRtl(this.markerBlock_);\n    }\n    this.currentMarkerSvg = this.markerBlock_;\n  }\n\n  /**\n   * Move and show the marker at the specified coordinate in workspace units.\n   * Displays a filled in rectangle.\n   *\n   * @param x The new x, in workspace units.\n   * @param y The new y, in workspace units.\n   * @param width The new width, in workspace units.\n   * @param height The new height, in workspace units.\n   */\n  protected positionRect_(x: number, y: number, width: number, height: number) {\n    if (!this.markerSvgRect_) {\n      throw new Error('createDom should be called before positioning the rect');\n    }\n    this.markerSvgRect_.setAttribute('x', `${x}`);\n    this.markerSvgRect_.setAttribute('y', `${y}`);\n    this.markerSvgRect_.setAttribute('width', `${width}`);\n    this.markerSvgRect_.setAttribute('height', `${height}`);\n    this.currentMarkerSvg = this.markerSvgRect_;\n  }\n\n  /**\n   * Flip the SVG paths in RTL.\n   *\n   * @param markerSvg The marker that we want to flip.\n   */\n  private flipRtl(markerSvg: SVGElement) {\n    markerSvg.setAttribute('transform', 'scale(-1 1)');\n  }\n\n  /** Hide the marker. */\n  hide() {\n    if (\n      !this.markerSvgLine_ ||\n      !this.markerSvgRect_ ||\n      !this.markerInput_ ||\n      !this.markerBlock_\n    ) {\n      throw new Error('createDom should be called before hiding the marker');\n    }\n    this.markerSvgLine_.style.display = 'none';\n    this.markerSvgRect_.style.display = 'none';\n    this.markerInput_.style.display = 'none';\n    this.markerBlock_.style.display = 'none';\n  }\n\n  /**\n   * Fire event for the marker or marker.\n   *\n   * @param oldNode The old node the marker used to be on.\n   * @param curNode The new node the marker is currently on.\n   */\n  private fireMarkerEvent(oldNode: ASTNode, curNode: ASTNode) {\n    const curBlock = curNode.getSourceBlock();\n    const event = new (eventUtils.get(eventUtils.MARKER_MOVE))(\n      curBlock,\n      this.isCursor(),\n      oldNode,\n      curNode,\n    );\n    eventUtils.fire(event);\n  }\n\n  /**\n   * Get the properties to make a marker blink.\n   *\n   * @returns The object holding attributes to make the marker blink.\n   */\n  protected getBlinkProperties_(): {[key: string]: string} {\n    return {\n      'attributeType': 'XML',\n      'attributeName': 'fill',\n      'dur': '1s',\n      'values': this.colour_ + ';transparent;transparent;',\n      'repeatCount': 'indefinite',\n    };\n  }\n\n  /**\n   * Create the marker SVG.\n   *\n   * @returns The SVG node created.\n   */\n  protected createDomInternal_(): Element {\n    /* This markup will be generated and added to the .svgGroup_:\n        <g>\n          <rect width=\"100\" height=\"5\">\n            <animate attributeType=\"XML\" attributeName=\"fill\" dur=\"1s\"\n              values=\"transparent;transparent;#fff;transparent\"\n        repeatCount=\"indefinite\" />\n          </rect>\n        </g>\n        */\n\n    this.markerSvg_ = dom.createSvgElement(\n      Svg.G,\n      {\n        'width': this.constants_.CURSOR_WS_WIDTH,\n        'height': this.constants_.WS_CURSOR_HEIGHT,\n      },\n      this.svgGroup_,\n    );\n\n    // A horizontal line used to represent a workspace coordinate or next\n    // connection.\n    this.markerSvgLine_ = dom.createSvgElement(\n      Svg.RECT,\n      {\n        'width': this.constants_.CURSOR_WS_WIDTH,\n        'height': this.constants_.WS_CURSOR_HEIGHT,\n      },\n      this.markerSvg_,\n    );\n\n    // A filled in rectangle used to represent a stack.\n    this.markerSvgRect_ = dom.createSvgElement(\n      Svg.RECT,\n      {\n        'class': 'blocklyVerticalMarker',\n        'rx': 10,\n        'ry': 10,\n      },\n      this.markerSvg_,\n    );\n\n    // A filled in puzzle piece used to represent an input value.\n    this.markerInput_ = dom.createSvgElement(\n      Svg.PATH,\n      {'transform': ''},\n      this.markerSvg_,\n    );\n\n    // A path used to represent a previous connection and a block, an output\n    // connection and a block, or a block.\n    this.markerBlock_ = dom.createSvgElement(\n      Svg.PATH,\n      {\n        'transform': '',\n        'fill': 'none',\n        'stroke-width': this.constants_.CURSOR_STROKE_WIDTH,\n      },\n      this.markerSvg_,\n    );\n\n    this.hide();\n\n    // Markers and stack markers don't blink.\n    if (this.isCursor()) {\n      const blinkProperties = this.getBlinkProperties_();\n      dom.createSvgElement(Svg.ANIMATE, blinkProperties, this.markerSvgLine_);\n      dom.createSvgElement(Svg.ANIMATE, blinkProperties, this.markerInput_);\n      dom.createSvgElement(\n        Svg.ANIMATE,\n        {...blinkProperties, attributeName: 'stroke'},\n        this.markerBlock_,\n      );\n    }\n\n    return this.markerSvg_;\n  }\n\n  /**\n   * Apply the marker's colour.\n   *\n   * @param _curNode The node that we want to draw the marker for.\n   */\n  protected applyColour_(_curNode: ASTNode) {\n    if (\n      !this.markerSvgLine_ ||\n      !this.markerSvgRect_ ||\n      !this.markerInput_ ||\n      !this.markerBlock_\n    ) {\n      throw new Error(\n        'createDom should be called before applying color to the markerj',\n      );\n    }\n    this.markerSvgLine_.setAttribute('fill', this.colour_);\n    this.markerSvgRect_.setAttribute('stroke', this.colour_);\n    this.markerInput_.setAttribute('fill', this.colour_);\n    this.markerBlock_.setAttribute('stroke', this.colour_);\n\n    if (this.isCursor()) {\n      const values = this.colour_ + ';transparent;transparent;';\n      this.markerSvgLine_.firstElementChild!.setAttribute('values', values);\n      this.markerInput_.firstElementChild!.setAttribute('values', values);\n      this.markerBlock_.firstElementChild!.setAttribute('values', values);\n    }\n  }\n\n  /** Dispose of this marker. */\n  dispose() {\n    if (this.svgGroup_) {\n      dom.removeNode(this.svgGroup_);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.PathObject\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {Connection} from '../../connection.js';\nimport {RenderedConnection} from '../../rendered_connection.js';\nimport type {BlockStyle} from '../../theme.js';\nimport {Coordinate} from '../../utils/coordinate.js';\nimport * as dom from '../../utils/dom.js';\nimport {Svg} from '../../utils/svg.js';\n\nimport type {ConstantProvider} from './constants.js';\nimport type {IPathObject} from './i_path_object.js';\n\n/**\n * An object that handles creating and setting each of the SVG elements\n * used by the renderer.\n */\nexport class PathObject implements IPathObject {\n  svgRoot: SVGElement;\n  svgPath: SVGElement;\n\n  /**\n   * Holds the cursors svg element when the cursor is attached to the block.\n   * This is null if there is no cursor on the block.\n   */\n  cursorSvg: SVGElement | null = null;\n\n  /**\n   * Holds the markers svg element when the marker is attached to the block.\n   * This is null if there is no marker on the block.\n   */\n  markerSvg: SVGElement | null = null;\n\n  constants: ConstantProvider;\n  style: BlockStyle;\n\n  /** Highlight paths associated with connections. */\n  private connectionHighlights = new WeakMap<RenderedConnection, SVGElement>();\n\n  /** Locations of connection highlights. */\n  private highlightOffsets = new WeakMap<RenderedConnection, Coordinate>();\n\n  /**\n   * @param root The root SVG element.\n   * @param style The style object to use for colouring.\n   * @param constants The renderer's constants.\n   */\n  constructor(\n    root: SVGElement,\n    style: BlockStyle,\n    constants: ConstantProvider,\n  ) {\n    this.constants = constants;\n    this.style = style;\n    this.svgRoot = root;\n\n    /** The primary path of the block. */\n    this.svgPath = dom.createSvgElement(\n      Svg.PATH,\n      {'class': 'blocklyPath'},\n      this.svgRoot,\n    );\n  }\n\n  /**\n   * Set the path generated by the renderer onto the respective SVG element.\n   *\n   * @param pathString The path.\n   */\n  setPath(pathString: string) {\n    this.svgPath.setAttribute('d', pathString);\n  }\n\n  /**\n   * Flip the SVG paths in RTL.\n   */\n  flipRTL() {\n    // Mirror the block's path.\n    this.svgPath.setAttribute('transform', 'scale(-1 1)');\n  }\n\n  /**\n   * Add the cursor SVG to this block's SVG group.\n   *\n   * @param cursorSvg The SVG root of the cursor to be added to the block SVG\n   *     group.\n   */\n  setCursorSvg(cursorSvg: SVGElement) {\n    if (!cursorSvg) {\n      this.cursorSvg = null;\n      return;\n    }\n\n    this.svgRoot.appendChild(cursorSvg);\n    this.cursorSvg = cursorSvg;\n  }\n\n  /**\n   * Add the marker SVG to this block's SVG group.\n   *\n   * @param markerSvg The SVG root of the marker to be added to the block SVG\n   *     group.\n   */\n  setMarkerSvg(markerSvg: SVGElement) {\n    if (!markerSvg) {\n      this.markerSvg = null;\n      return;\n    }\n\n    if (this.cursorSvg) {\n      this.svgRoot.insertBefore(markerSvg, this.cursorSvg);\n    } else {\n      this.svgRoot.appendChild(markerSvg);\n    }\n    this.markerSvg = markerSvg;\n  }\n\n  /**\n   * Apply the stored colours to the block's path, taking into account whether\n   * the paths belong to a shadow block.\n   *\n   * @param block The source block.\n   */\n  applyColour(block: BlockSvg) {\n    this.svgPath.setAttribute('stroke', this.style.colourTertiary);\n    this.svgPath.setAttribute('fill', this.style.colourPrimary);\n\n    this.updateShadow_(block.isShadow());\n    this.updateDisabled_(!block.isEnabled() || block.getInheritedDisabled());\n  }\n\n  /**\n   * Set the style.\n   *\n   * @param blockStyle The block style to use.\n   */\n  setStyle(blockStyle: BlockStyle) {\n    this.style = blockStyle;\n  }\n\n  /**\n   * Add or remove the given CSS class on the path object's root SVG element.\n   *\n   * @param className The name of the class to add or remove\n   * @param add True if the class should be added.  False if it should be\n   *     removed.\n   */\n  protected setClass_(className: string, add: boolean) {\n    if (!className) {\n      return;\n    }\n    if (add) {\n      dom.addClass(this.svgRoot, className);\n    } else {\n      dom.removeClass(this.svgRoot, className);\n    }\n  }\n\n  /**\n   * Set whether the block shows a highlight or not.  Block highlighting is\n   * often used to visually mark blocks currently being executed.\n   *\n   * @param enable True if highlighted.\n   */\n  updateHighlighted(enable: boolean) {\n    if (enable) {\n      this.svgPath.setAttribute(\n        'filter',\n        'url(#' + this.constants.embossFilterId + ')',\n      );\n    } else {\n      this.svgPath.setAttribute('filter', 'none');\n    }\n  }\n\n  /**\n   * Updates the look of the block to reflect a shadow state.\n   *\n   * @param shadow True if the block is a shadow block.\n   */\n  protected updateShadow_(shadow: boolean) {\n    if (shadow) {\n      this.svgPath.setAttribute('stroke', 'none');\n      this.svgPath.setAttribute('fill', this.style.colourSecondary);\n    }\n  }\n\n  /**\n   * Updates the look of the block to reflect a disabled state.\n   *\n   * @param disabled True if disabled.\n   */\n  protected updateDisabled_(disabled: boolean) {\n    this.setClass_('blocklyDisabled', disabled);\n    if (disabled) {\n      this.svgPath.setAttribute(\n        'fill',\n        'url(#' + this.constants.disabledPatternId + ')',\n      );\n    }\n  }\n\n  /**\n   * Add or remove styling showing that a block is selected.\n   *\n   * @param enable True if selection is enabled, false otherwise.\n   */\n  updateSelected(enable: boolean) {\n    this.setClass_('blocklySelected', enable);\n  }\n\n  /**\n   * Add or remove styling showing that a block is dragged over a delete area.\n   *\n   * @param enable True if the block is being dragged over a delete area, false\n   *     otherwise.\n   */\n  updateDraggingDelete(enable: boolean) {\n    this.setClass_('blocklyDraggingDelete', enable);\n  }\n\n  /**\n   * Add or remove styling showing that a block is an insertion marker.\n   *\n   * @param enable True if the block is an insertion marker, false otherwise.\n   */\n  updateInsertionMarker(enable: boolean) {\n    this.setClass_('blocklyInsertionMarker', enable);\n  }\n\n  /**\n   * Add or remove styling showing that a block is movable.\n   *\n   * @param enable True if the block is movable, false otherwise.\n   */\n  updateMovable(enable: boolean) {\n    this.setClass_('blocklyDraggable', enable);\n  }\n\n  /**\n   * Add or remove styling that shows that if the dragging block is dropped,\n   * this block will be replaced.  If a shadow block, it will disappear.\n   * Otherwise it will bump.\n   *\n   * @param enable True if styling should be added.\n   */\n  updateReplacementFade(enable: boolean) {\n    this.setClass_('blocklyReplaceable', enable);\n  }\n\n  /**\n   * Add or remove styling that shows that if the dragging block is dropped,\n   * this block will be connected to the input.\n   *\n   * @param _conn The connection on the input to highlight.\n   * @param _enable True if styling should be added.\n   */\n  updateShapeForInputHighlight(_conn: Connection, _enable: boolean) {\n    // NOOP\n  }\n\n  /** Adds the given path as a connection highlight for the given connection. */\n  addConnectionHighlight(\n    connection: RenderedConnection,\n    connectionPath: string,\n    offset: Coordinate,\n    rtl: boolean,\n  ) {\n    if (this.connectionHighlights.has(connection)) {\n      if (this.currentHighlightMatchesNew(connection, connectionPath, offset)) {\n        return;\n      }\n      this.removeConnectionHighlight(connection);\n    }\n\n    const highlight = dom.createSvgElement(\n      Svg.PATH,\n      {\n        'class': 'blocklyHighlightedConnectionPath',\n        'd': connectionPath,\n        'transform':\n          `translate(${offset.x}, ${offset.y})` + (rtl ? ' scale(-1 1)' : ''),\n      },\n      this.svgRoot,\n    );\n    this.connectionHighlights.set(connection, highlight);\n  }\n\n  private currentHighlightMatchesNew(\n    connection: RenderedConnection,\n    newPath: string,\n    newOffset: Coordinate,\n  ): boolean {\n    const currPath = this.connectionHighlights\n      .get(connection)\n      ?.getAttribute('d');\n    const currOffset = this.highlightOffsets.get(connection);\n    return currPath === newPath && Coordinate.equals(currOffset, newOffset);\n  }\n\n  /**\n   * Removes any highlight associated with the given connection, if it exists.\n   */\n  removeConnectionHighlight(connection: RenderedConnection) {\n    const highlight = this.connectionHighlights.get(connection);\n    if (!highlight) return;\n    dom.removeNode(highlight);\n    this.connectionHighlights.delete(connection);\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.constants\n\n/**\n * The language-neutral ID given to the collapsed input.\n */\nexport const COLLAPSED_INPUT_NAME = '_TEMP_COLLAPSED_INPUT';\n\n/**\n * The language-neutral ID given to the collapsed field.\n */\nexport const COLLAPSED_FIELD_NAME = '_TEMP_COLLAPSED_FIELD';\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class that controls updates to connections during drags.\n *\n * @class\n */\n// Former goog.module ID: Blockly.InsertionMarkerManager\n\nimport {finishQueuedRenders} from './render_management.js';\nimport * as blockAnimations from './block_animations.js';\nimport type {BlockSvg} from './block_svg.js';\nimport * as common from './common.js';\nimport {ComponentManager} from './component_manager.js';\nimport {config} from './config.js';\nimport * as constants from './constants.js';\nimport * as eventUtils from './events/utils.js';\nimport type {IDeleteArea} from './interfaces/i_delete_area.js';\nimport type {IDragTarget} from './interfaces/i_drag_target.js';\nimport type {RenderedConnection} from './rendered_connection.js';\nimport type {Coordinate} from './utils/coordinate.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport * as renderManagement from './render_management.js';\n\n/** Represents a nearby valid connection. */\ninterface CandidateConnection {\n  /**\n   * A nearby valid connection that is compatible with local.\n   * This is not on any of the blocks that are being dragged.\n   */\n  closest: RenderedConnection;\n  /**\n   * A connection on the dragging stack that is compatible with closest. This is\n   * on the top block that is being dragged or the last block in the dragging\n   * stack.\n   */\n  local: RenderedConnection;\n  radius: number;\n}\n\n/**\n * An error message to throw if the block created by createMarkerBlock_ is\n * missing any components.\n */\nconst DUPLICATE_BLOCK_ERROR =\n  'The insertion marker ' +\n  'manager tried to create a marker but the result is missing %1. If ' +\n  'you are using a mutator, make sure your domToMutation method is ' +\n  'properly defined.';\n\n/**\n * Class that controls updates to connections during drags.  It is primarily\n * responsible for finding the closest eligible connection and highlighting or\n * unhighlighting it as needed during a drag.\n *\n * @deprecated v10 - Use an IConnectionPreviewer instead.\n */\nexport class InsertionMarkerManager {\n  /**\n   * The top block in the stack being dragged.\n   * Does not change during a drag.\n   */\n  private readonly topBlock: BlockSvg;\n\n  /**\n   * The workspace on which these connections are being dragged.\n   * Does not change during a drag.\n   */\n  private readonly workspace: WorkspaceSvg;\n\n  /**\n   * The last connection on the stack, if it's not the last connection on the\n   * first block.\n   * Set in initAvailableConnections, if at all.\n   */\n  private lastOnStack: RenderedConnection | null = null;\n\n  /**\n   * The insertion marker corresponding to the last block in the stack, if\n   * that's not the same as the first block in the stack.\n   * Set in initAvailableConnections, if at all\n   */\n  private lastMarker: BlockSvg | null = null;\n\n  /**\n   * The insertion marker that shows up between blocks to show where a block\n   * would go if dropped immediately.\n   */\n  private firstMarker: BlockSvg;\n\n  /**\n   * Information about the connection that would be made if the dragging block\n   * were released immediately. Updated on every mouse move.\n   */\n  private activeCandidate: CandidateConnection | null = null;\n\n  /**\n   * Whether the block would be deleted if it were dropped immediately.\n   * Updated on every mouse move.\n   *\n   * @internal\n   */\n  public wouldDeleteBlock = false;\n\n  /**\n   * Connection on the insertion marker block that corresponds to\n   * the active candidate's local connection on the currently dragged block.\n   */\n  private markerConnection: RenderedConnection | null = null;\n\n  /** The block that currently has an input being highlighted, or null. */\n  private highlightedBlock: BlockSvg | null = null;\n\n  /** The block being faded to indicate replacement, or null. */\n  private fadedBlock: BlockSvg | null = null;\n\n  /**\n   * The connections on the dragging blocks that are available to connect to\n   * other blocks.  This includes all open connections on the top block, as\n   * well as the last connection on the block stack.\n   */\n  private availableConnections: RenderedConnection[];\n\n  /** @param block The top block in the stack being dragged. */\n  constructor(block: BlockSvg) {\n    common.setSelected(block);\n    this.topBlock = block;\n\n    this.workspace = block.workspace;\n\n    this.firstMarker = this.createMarkerBlock(this.topBlock);\n\n    this.availableConnections = this.initAvailableConnections();\n\n    if (this.lastOnStack) {\n      this.lastMarker = this.createMarkerBlock(\n        this.lastOnStack.getSourceBlock(),\n      );\n    }\n  }\n\n  /**\n   * Sever all links from this object.\n   *\n   * @internal\n   */\n  dispose() {\n    this.availableConnections.length = 0;\n    this.disposeInsertionMarker(this.firstMarker);\n    this.disposeInsertionMarker(this.lastMarker);\n  }\n\n  /**\n   * Update the available connections for the top block. These connections can\n   * change if a block is unplugged and the stack is healed.\n   *\n   * @internal\n   */\n  updateAvailableConnections() {\n    this.availableConnections = this.initAvailableConnections();\n  }\n\n  /**\n   * Return whether the block would be connected if dropped immediately, based\n   * on information from the most recent move event.\n   *\n   * @returns True if the block would be connected if dropped immediately.\n   * @internal\n   */\n  wouldConnectBlock(): boolean {\n    return !!this.activeCandidate;\n  }\n\n  /**\n   * Connect to the closest connection and render the results.\n   * This should be called at the end of a drag.\n   *\n   * @internal\n   */\n  applyConnections() {\n    if (!this.activeCandidate) return;\n    eventUtils.disable();\n    this.hidePreview();\n    eventUtils.enable();\n    const {local, closest} = this.activeCandidate;\n    local.connect(closest);\n    if (this.topBlock.rendered) {\n      const inferiorConnection = local.isSuperior() ? closest : local;\n      const rootBlock = this.topBlock.getRootBlock();\n\n      finishQueuedRenders().then(() => {\n        blockAnimations.connectionUiEffect(inferiorConnection.getSourceBlock());\n        // bringToFront is incredibly expensive. Delay until the next frame.\n        setTimeout(() => {\n          rootBlock.bringToFront();\n        }, 0);\n      });\n    }\n  }\n\n  /**\n   * Update connections based on the most recent move location.\n   *\n   * @param dxy Position relative to drag start, in workspace units.\n   * @param dragTarget The drag target that the block is currently over.\n   * @internal\n   */\n  update(dxy: Coordinate, dragTarget: IDragTarget | null) {\n    const newCandidate = this.getCandidate(dxy);\n\n    this.wouldDeleteBlock = this.shouldDelete(!!newCandidate, dragTarget);\n\n    const shouldUpdate =\n      this.wouldDeleteBlock || this.shouldUpdatePreviews(newCandidate, dxy);\n\n    if (shouldUpdate) {\n      // Don't fire events for insertion marker creation or movement.\n      eventUtils.disable();\n      this.maybeHidePreview(newCandidate);\n      this.maybeShowPreview(newCandidate);\n      eventUtils.enable();\n    }\n  }\n\n  /**\n   * Create an insertion marker that represents the given block.\n   *\n   * @param sourceBlock The block that the insertion marker will represent.\n   * @returns The insertion marker that represents the given block.\n   */\n  private createMarkerBlock(sourceBlock: BlockSvg): BlockSvg {\n    const imType = sourceBlock.type;\n\n    eventUtils.disable();\n    let result: BlockSvg;\n    try {\n      result = this.workspace.newBlock(imType);\n      result.setInsertionMarker(true);\n      if (sourceBlock.saveExtraState) {\n        const state = sourceBlock.saveExtraState(true);\n        if (state && result.loadExtraState) {\n          result.loadExtraState(state);\n        }\n      } else if (sourceBlock.mutationToDom) {\n        const oldMutationDom = sourceBlock.mutationToDom();\n        if (oldMutationDom && result.domToMutation) {\n          result.domToMutation(oldMutationDom);\n        }\n      }\n      // Copy field values from the other block.  These values may impact the\n      // rendered size of the insertion marker.  Note that we do not care about\n      // child blocks here.\n      for (let i = 0; i < sourceBlock.inputList.length; i++) {\n        const sourceInput = sourceBlock.inputList[i];\n        if (sourceInput.name === constants.COLLAPSED_INPUT_NAME) {\n          continue; // Ignore the collapsed input.\n        }\n        const resultInput = result.inputList[i];\n        if (!resultInput) {\n          throw new Error(DUPLICATE_BLOCK_ERROR.replace('%1', 'an input'));\n        }\n        for (let j = 0; j < sourceInput.fieldRow.length; j++) {\n          const sourceField = sourceInput.fieldRow[j];\n          const resultField = resultInput.fieldRow[j];\n          if (!resultField) {\n            throw new Error(DUPLICATE_BLOCK_ERROR.replace('%1', 'a field'));\n          }\n          resultField.setValue(sourceField.getValue());\n        }\n      }\n\n      for (const block of result.getDescendants(false)) {\n        block.setInsertionMarker(true);\n      }\n\n      result.setCollapsed(sourceBlock.isCollapsed());\n      result.setInputsInline(sourceBlock.getInputsInline());\n\n      result.initSvg();\n      result.getSvgRoot().setAttribute('visibility', 'hidden');\n    } finally {\n      eventUtils.enable();\n    }\n\n    return result;\n  }\n\n  /**\n   * Populate the list of available connections on this block stack. If the\n   * stack has more than one block, this function will also update lastOnStack.\n   *\n   * @returns A list of available connections.\n   */\n  private initAvailableConnections(): RenderedConnection[] {\n    const available = this.topBlock.getConnections_(false);\n    // Also check the last connection on this stack\n    const lastOnStack = this.topBlock.lastConnectionInStack(true);\n    if (lastOnStack && lastOnStack !== this.topBlock.nextConnection) {\n      available.push(lastOnStack);\n      this.lastOnStack = lastOnStack;\n    }\n    return available;\n  }\n\n  /**\n   * Whether the previews (insertion marker and replacement marker) should be\n   * updated based on the closest candidate and the current drag distance.\n   *\n   * @param newCandidate A new candidate connection that may replace the current\n   *     best candidate.\n   * @param dxy Position relative to drag start, in workspace units.\n   * @returns Whether the preview should be updated.\n   */\n  private shouldUpdatePreviews(\n    newCandidate: CandidateConnection | null,\n    dxy: Coordinate,\n  ): boolean {\n    // Only need to update if we were showing a preview before.\n    if (!newCandidate) return !!this.activeCandidate;\n\n    // We weren't showing a preview before, but we should now.\n    if (!this.activeCandidate) return true;\n\n    // We're already showing an insertion marker.\n    // Decide whether the new connection has higher priority.\n    const {local: activeLocal, closest: activeClosest} = this.activeCandidate;\n    if (\n      activeClosest === newCandidate.closest &&\n      activeLocal === newCandidate.local\n    ) {\n      // The connection was the same as the current connection.\n      return false;\n    }\n\n    const xDiff = activeLocal.x + dxy.x - activeClosest.x;\n    const yDiff = activeLocal.y + dxy.y - activeClosest.y;\n    const curDistance = Math.sqrt(xDiff * xDiff + yDiff * yDiff);\n    // Slightly prefer the existing preview over a new preview.\n    return (\n      newCandidate.radius < curDistance - config.currentConnectionPreference\n    );\n  }\n\n  /**\n   * Find the nearest valid connection, which may be the same as the current\n   * closest connection.\n   *\n   * @param dxy Position relative to drag start, in workspace units.\n   * @returns An object containing a local connection, a closest connection, and\n   *     a radius.\n   */\n  private getCandidate(dxy: Coordinate): CandidateConnection | null {\n    // It's possible that a block has added or removed connections during a\n    // drag, (e.g. in a drag/move event handler), so let's update the available\n    // connections. Note that this will be called on every move while dragging,\n    // so it might cause slowness, especially if the block stack is large.  If\n    // so, maybe it could be made more efficient. Also note that we won't update\n    // the connections if we've already connected the insertion marker to a\n    // block.\n    if (!this.markerConnection || !this.markerConnection.isConnected()) {\n      this.updateAvailableConnections();\n    }\n\n    let radius = this.getStartRadius();\n    let candidate = null;\n    for (let i = 0; i < this.availableConnections.length; i++) {\n      const myConnection = this.availableConnections[i];\n      const neighbour = myConnection.closest(radius, dxy);\n      if (neighbour.connection) {\n        candidate = {\n          closest: neighbour.connection,\n          local: myConnection,\n          radius: neighbour.radius,\n        };\n        radius = neighbour.radius;\n      }\n    }\n    return candidate;\n  }\n\n  /**\n   * Decide the radius at which to start searching for the closest connection.\n   *\n   * @returns The radius at which to start the search for the closest\n   *     connection.\n   */\n  private getStartRadius(): number {\n    // If there is already a connection highlighted,\n    // increase the radius we check for making new connections.\n    // When a connection is highlighted, blocks move around when the\n    // insertion marker is created, which could cause the connection became out\n    // of range. By increasing radiusConnection when a connection already\n    // exists, we never \"lose\" the connection from the offset.\n    return this.activeCandidate\n      ? config.connectingSnapRadius\n      : config.snapRadius;\n  }\n\n  /**\n   * Whether ending the drag would delete the block.\n   *\n   * @param newCandidate Whether there is a candidate connection that the\n   *     block could connect to if the drag ended immediately.\n   * @param dragTarget The drag target that the block is currently over.\n   * @returns Whether dropping the block immediately would delete the block.\n   */\n  private shouldDelete(\n    newCandidate: boolean,\n    dragTarget: IDragTarget | null,\n  ): boolean {\n    if (dragTarget) {\n      const componentManager = this.workspace.getComponentManager();\n      const isDeleteArea = componentManager.hasCapability(\n        dragTarget.id,\n        ComponentManager.Capability.DELETE_AREA,\n      );\n      if (isDeleteArea) {\n        return (dragTarget as IDeleteArea).wouldDelete(\n          this.topBlock,\n          newCandidate,\n        );\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Show an insertion marker or replacement highlighting during a drag, if\n   * needed.\n   * At the beginning of this function, this.activeConnection should be null.\n   *\n   * @param newCandidate A new candidate connection that may replace the current\n   *     best candidate.\n   */\n  private maybeShowPreview(newCandidate: CandidateConnection | null) {\n    if (this.wouldDeleteBlock) return; // Nope, don't add a marker.\n    if (!newCandidate) return; // Nothing to connect to.\n\n    const closest = newCandidate.closest;\n\n    // Something went wrong and we're trying to connect to an invalid\n    // connection.\n    if (\n      closest === this.activeCandidate?.closest ||\n      closest.getSourceBlock().isInsertionMarker()\n    ) {\n      console.log('Trying to connect to an insertion marker');\n      return;\n    }\n    this.activeCandidate = newCandidate;\n    // Add an insertion marker or replacement marker.\n    this.showPreview(this.activeCandidate);\n  }\n\n  /**\n   * A preview should be shown.  This function figures out if it should be a\n   * block highlight or an insertion marker, and shows the appropriate one.\n   *\n   * @param activeCandidate The connection that will be made if the drag ends\n   *     immediately.\n   */\n  private showPreview(activeCandidate: CandidateConnection) {\n    const renderer = this.workspace.getRenderer();\n    const method = renderer.getConnectionPreviewMethod(\n      activeCandidate.closest,\n      activeCandidate.local,\n      this.topBlock,\n    );\n\n    switch (method) {\n      case InsertionMarkerManager.PREVIEW_TYPE.INPUT_OUTLINE:\n        this.showInsertionInputOutline(activeCandidate);\n        break;\n      case InsertionMarkerManager.PREVIEW_TYPE.INSERTION_MARKER:\n        this.showInsertionMarker(activeCandidate);\n        break;\n      case InsertionMarkerManager.PREVIEW_TYPE.REPLACEMENT_FADE:\n        this.showReplacementFade(activeCandidate);\n        break;\n    }\n\n    // Optionally highlight the actual connection, as a nod to previous\n    // behaviour.\n    if (renderer.shouldHighlightConnection(activeCandidate.closest)) {\n      activeCandidate.closest.highlight();\n    }\n  }\n\n  /**\n   * Hide an insertion marker or replacement highlighting during a drag, if\n   * needed.\n   * At the end of this function, this.activeCandidate will be null.\n   *\n   * @param newCandidate A new candidate connection that may replace the current\n   *     best candidate.\n   */\n  private maybeHidePreview(newCandidate: CandidateConnection | null) {\n    // If there's no new preview, remove the old one but don't bother deleting\n    // it. We might need it later, and this saves disposing of it and recreating\n    // it.\n    if (!newCandidate) {\n      this.hidePreview();\n    } else {\n      if (this.activeCandidate) {\n        const closestChanged =\n          this.activeCandidate.closest !== newCandidate.closest;\n        const localChanged = this.activeCandidate.local !== newCandidate.local;\n\n        // If there's a new preview and there was a preview before, and either\n        // connection has changed, remove the old preview.\n        // Also hide if we had a preview before but now we're going to delete\n        // instead.\n        if (closestChanged || localChanged || this.wouldDeleteBlock) {\n          this.hidePreview();\n        }\n      }\n    }\n\n    // Either way, clear out old state.\n    this.markerConnection = null;\n    this.activeCandidate = null;\n  }\n\n  /**\n   * A preview should be hidden. Loop through all possible preview modes\n   * and hide everything.\n   */\n  private hidePreview() {\n    const closest = this.activeCandidate?.closest;\n    if (\n      closest &&\n      closest.targetBlock() &&\n      this.workspace.getRenderer().shouldHighlightConnection(closest)\n    ) {\n      closest.unhighlight();\n    }\n    this.hideReplacementFade();\n    this.hideInsertionInputOutline();\n    this.hideInsertionMarker();\n  }\n\n  /**\n   * Shows an insertion marker connected to the appropriate blocks (based on\n   * manager state).\n   *\n   * @param activeCandidate The connection that will be made if the drag ends\n   *     immediately.\n   */\n  private showInsertionMarker(activeCandidate: CandidateConnection) {\n    const {local, closest} = activeCandidate;\n\n    const isLastInStack = this.lastOnStack && local === this.lastOnStack;\n    let insertionMarker = isLastInStack ? this.lastMarker : this.firstMarker;\n    if (!insertionMarker) {\n      throw new Error(\n        'Cannot show the insertion marker because there is no insertion ' +\n          'marker block',\n      );\n    }\n    let imConn;\n    try {\n      imConn = insertionMarker.getMatchingConnection(\n        local.getSourceBlock(),\n        local,\n      );\n    } catch (e) {\n      // It's possible that the number of connections on the local block has\n      // changed since the insertion marker was originally created.  Let's\n      // recreate the insertion marker and try again. In theory we could\n      // probably recreate the marker block (e.g. in getCandidate_), which is\n      // called more often during the drag, but creating a block that often\n      // might be too slow, so we only do it if necessary.\n      if (isLastInStack && this.lastOnStack) {\n        this.disposeInsertionMarker(this.lastMarker);\n        this.lastMarker = this.createMarkerBlock(\n          this.lastOnStack.getSourceBlock(),\n        );\n        insertionMarker = this.lastMarker;\n      } else {\n        this.disposeInsertionMarker(this.firstMarker);\n        this.firstMarker = this.createMarkerBlock(this.topBlock);\n        insertionMarker = this.firstMarker;\n      }\n\n      if (!insertionMarker) {\n        throw new Error(\n          'Cannot show the insertion marker because there is no insertion ' +\n            'marker block',\n        );\n      }\n      imConn = insertionMarker.getMatchingConnection(\n        local.getSourceBlock(),\n        local,\n      );\n    }\n\n    if (!imConn) {\n      throw new Error(\n        'Cannot show the insertion marker because there is no ' +\n          'associated connection',\n      );\n    }\n\n    if (imConn === this.markerConnection) {\n      throw new Error(\n        \"Made it to showInsertionMarker_ even though the marker isn't \" +\n          'changing',\n      );\n    }\n\n    // Render disconnected from everything else so that we have a valid\n    // connection location.\n    insertionMarker.queueRender();\n    renderManagement.triggerQueuedRenders();\n\n    // Connect() also renders the insertion marker.\n    imConn.connect(closest);\n\n    const originalOffsetToTarget = {\n      x: closest.x - imConn.x,\n      y: closest.y - imConn.y,\n    };\n    const originalOffsetInBlock = imConn.getOffsetInBlock().clone();\n    const imConnConst = imConn;\n    renderManagement.finishQueuedRenders().then(() => {\n      // Position so that the existing block doesn't move.\n      insertionMarker?.positionNearConnection(\n        imConnConst,\n        originalOffsetToTarget,\n        originalOffsetInBlock,\n      );\n      insertionMarker?.getSvgRoot().setAttribute('visibility', 'visible');\n    });\n\n    this.markerConnection = imConn;\n  }\n\n  /**\n   * Disconnects and hides the current insertion marker. Should return the\n   * blocks to their original state.\n   */\n  private hideInsertionMarker() {\n    if (!this.markerConnection) return;\n\n    const markerConn = this.markerConnection;\n    const imBlock = markerConn.getSourceBlock();\n    const markerPrev = imBlock.previousConnection;\n    const markerOutput = imBlock.outputConnection;\n\n    if (!markerPrev?.targetConnection && !markerOutput?.targetConnection) {\n      // If we are the top block, unplugging doesn't do anything.\n      // The marker connection may not have a target block if we are hiding\n      // as part of applying connections.\n      markerConn.targetBlock()?.unplug(false);\n    } else {\n      imBlock.unplug(true);\n    }\n\n    if (markerConn.targetConnection) {\n      throw Error(\n        'markerConnection still connected at the end of ' +\n          'disconnectInsertionMarker',\n      );\n    }\n\n    this.markerConnection = null;\n    const svg = imBlock.getSvgRoot();\n    if (svg) {\n      svg.setAttribute('visibility', 'hidden');\n    }\n  }\n\n  /**\n   * Shows an outline around the input the closest connection belongs to.\n   *\n   * @param activeCandidate The connection that will be made if the drag ends\n   *     immediately.\n   */\n  private showInsertionInputOutline(activeCandidate: CandidateConnection) {\n    const closest = activeCandidate.closest;\n    this.highlightedBlock = closest.getSourceBlock();\n    this.highlightedBlock.highlightShapeForInput(closest, true);\n  }\n\n  /** Hides any visible input outlines. */\n  private hideInsertionInputOutline() {\n    if (!this.highlightedBlock) return;\n\n    if (!this.activeCandidate) {\n      throw new Error(\n        'Cannot hide the insertion marker outline because ' +\n          'there is no active candidate',\n      );\n    }\n    this.highlightedBlock.highlightShapeForInput(\n      this.activeCandidate.closest,\n      false,\n    );\n    this.highlightedBlock = null;\n  }\n\n  /**\n   * Shows a replacement fade affect on the closest connection's target block\n   * (the block that is currently connected to it).\n   *\n   * @param activeCandidate The connection that will be made if the drag ends\n   *     immediately.\n   */\n  private showReplacementFade(activeCandidate: CandidateConnection) {\n    this.fadedBlock = activeCandidate.closest.targetBlock();\n    if (!this.fadedBlock) {\n      throw new Error(\n        'Cannot show the replacement fade because the ' +\n          'closest connection does not have a target block',\n      );\n    }\n    this.fadedBlock.fadeForReplacement(true);\n  }\n\n  /**\n   * Hides/Removes any visible fade affects.\n   */\n  private hideReplacementFade() {\n    if (!this.fadedBlock) return;\n\n    this.fadedBlock.fadeForReplacement(false);\n    this.fadedBlock = null;\n  }\n\n  /**\n   * Get a list of the insertion markers that currently exist.  Drags have 0, 1,\n   * or 2 insertion markers.\n   *\n   * @returns A possibly empty list of insertion marker blocks.\n   * @internal\n   */\n  getInsertionMarkers(): BlockSvg[] {\n    const result = [];\n    if (this.firstMarker) {\n      result.push(this.firstMarker);\n    }\n    if (this.lastMarker) {\n      result.push(this.lastMarker);\n    }\n    return result;\n  }\n\n  /**\n   * Safely disposes of an insertion marker.\n   */\n  private disposeInsertionMarker(marker: BlockSvg | null) {\n    if (marker) {\n      eventUtils.disable();\n      try {\n        marker.dispose();\n      } finally {\n        eventUtils.enable();\n      }\n    }\n  }\n}\n\nexport namespace InsertionMarkerManager {\n  /**\n   * An enum describing different kinds of previews the InsertionMarkerManager\n   * could display.\n   */\n  export enum PREVIEW_TYPE {\n    INSERTION_MARKER = 0,\n    INPUT_OUTLINE = 1,\n    REPLACEMENT_FADE = 2,\n  }\n}\n\nexport type PreviewType = InsertionMarkerManager.PREVIEW_TYPE;\nexport const PreviewType = InsertionMarkerManager.PREVIEW_TYPE;\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.Renderer\n\nimport type {Block} from '../../block.js';\nimport type {BlockSvg} from '../../block_svg.js';\nimport {Connection} from '../../connection.js';\nimport {ConnectionType} from '../../connection_type.js';\nimport {\n  InsertionMarkerManager,\n  PreviewType,\n} from '../../insertion_marker_manager.js';\nimport type {IRegistrable} from '../../interfaces/i_registrable.js';\nimport type {Marker} from '../../keyboard_nav/marker.js';\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {BlockStyle, Theme} from '../../theme.js';\nimport type {WorkspaceSvg} from '../../workspace_svg.js';\n\nimport {ConstantProvider} from './constants.js';\nimport {Drawer} from './drawer.js';\nimport type {IPathObject} from './i_path_object.js';\nimport {RenderInfo} from './info.js';\nimport {MarkerSvg} from './marker_svg.js';\nimport {PathObject} from './path_object.js';\nimport * as deprecation from '../../utils/deprecation.js';\n\n/**\n * The base class for a block renderer.\n */\nexport class Renderer implements IRegistrable {\n  /** The renderer's constant provider. */\n  protected constants_!: ConstantProvider;\n\n  protected name: string;\n\n  /**\n   * Rendering constant overrides, passed in through options.\n   */\n  protected overrides: object | null = null;\n\n  /**\n   * @param name The renderer name.\n   */\n  constructor(name: string) {\n    this.name = name;\n  }\n\n  /**\n   * Gets the class name that identifies this renderer.\n   *\n   * @returns The CSS class name.\n   */\n  getClassName(): string {\n    return this.name + '-renderer';\n  }\n\n  /**\n   * Initialize the renderer.\n   *\n   * @param theme The workspace theme object.\n   * @param opt_rendererOverrides Rendering constant overrides.\n   */\n  init(\n    theme: Theme,\n    opt_rendererOverrides?: {[rendererConstant: string]: any},\n  ) {\n    this.constants_ = this.makeConstants_();\n    if (opt_rendererOverrides) {\n      this.overrides = opt_rendererOverrides;\n      Object.assign(this.constants_, opt_rendererOverrides);\n    }\n    this.constants_.setTheme(theme);\n    this.constants_.init();\n  }\n\n  /**\n   * Create any DOM elements that this renderer needs.\n   * If you need to create additional DOM elements, override the\n   * {@link ConstantProvider#createDom} method instead.\n   *\n   * @param svg The root of the workspace's SVG.\n   * @param theme The workspace theme object.\n   * @internal\n   */\n  createDom(svg: SVGElement, theme: Theme) {\n    this.constants_.createDom(\n      svg,\n      this.name + '-' + theme.name,\n      '.' + this.getClassName() + '.' + theme.getClassName(),\n    );\n  }\n\n  /**\n   * Refresh the renderer after a theme change.\n   *\n   * @param svg The root of the workspace's SVG.\n   * @param theme The workspace theme object.\n   */\n  refreshDom(svg: SVGElement, theme: Theme) {\n    const previousConstants = this.getConstants();\n    previousConstants.dispose();\n    this.constants_ = this.makeConstants_();\n    if (this.overrides) {\n      Object.assign(this.constants_, this.overrides);\n    }\n    // Ensure the constant provider's random identifier does not change.\n    this.constants_.randomIdentifier = previousConstants.randomIdentifier;\n    this.constants_.setTheme(theme);\n    this.constants_.init();\n    this.createDom(svg, theme);\n  }\n\n  /**\n   * Dispose of this renderer.\n   * Delete all DOM elements that this renderer and its constants created.\n   */\n  dispose() {\n    if (this.constants_) {\n      this.constants_.dispose();\n    }\n  }\n\n  /**\n   * Create a new instance of the renderer's constant provider.\n   *\n   * @returns The constant provider.\n   */\n  protected makeConstants_(): ConstantProvider {\n    return new ConstantProvider();\n  }\n\n  /**\n   * Create a new instance of the renderer's render info object.\n   *\n   * @param block The block to measure.\n   * @returns The render info object.\n   */\n  protected makeRenderInfo_(block: BlockSvg): RenderInfo {\n    return new RenderInfo(this, block);\n  }\n\n  /**\n   * Create a new instance of the renderer's drawer.\n   *\n   * @param block The block to render.\n   * @param info An object containing all information needed to render this\n   *     block.\n   * @returns The drawer.\n   */\n  protected makeDrawer_(block: BlockSvg, info: RenderInfo): Drawer {\n    return new Drawer(block, info);\n  }\n\n  /**\n   * Create a new instance of the renderer's marker drawer.\n   *\n   * @param workspace The workspace the marker belongs to.\n   * @param marker The marker.\n   * @returns The object in charge of drawing the marker.\n   */\n  makeMarkerDrawer(workspace: WorkspaceSvg, marker: Marker): MarkerSvg {\n    return new MarkerSvg(workspace, this.getConstants(), marker);\n  }\n\n  /**\n   * Create a new instance of a renderer path object.\n   *\n   * @param root The root SVG element.\n   * @param style The style object to use for colouring.\n   * @returns The renderer path object.\n   */\n  makePathObject(root: SVGElement, style: BlockStyle): IPathObject {\n    return new PathObject(root, style, this.constants_);\n  }\n\n  /**\n   * Get the current renderer's constant provider.  We assume that when this is\n   * called, the renderer has already been initialized.\n   *\n   * @returns The constant provider.\n   */\n  getConstants(): ConstantProvider {\n    return this.constants_;\n  }\n\n  /**\n   * Determine whether or not to highlight a connection.\n   *\n   * @param _conn The connection to determine whether or not to highlight.\n   * @returns True if we should highlight the connection.\n   */\n  shouldHighlightConnection(_conn: Connection): boolean {\n    return true;\n  }\n\n  /**\n   * Checks if an orphaned block can connect to the \"end\" of the topBlock's\n   * block-clump. If the clump is a row the end is the last input. If the clump\n   * is a stack, the end is the last next connection. If the clump is neither,\n   * then this returns false.\n   *\n   * @param topBlock The top block of the block clump we want to try and connect\n   *     to.\n   * @param orphanBlock The orphan block that wants to find a home.\n   * @param localType The type of the connection being dragged.\n   * @returns Whether there is a home for the orphan or not.\n   */\n  protected orphanCanConnectAtEnd(\n    topBlock: BlockSvg,\n    orphanBlock: BlockSvg,\n    localType: number,\n  ): boolean {\n    const orphanConnection =\n      localType === ConnectionType.OUTPUT_VALUE\n        ? orphanBlock.outputConnection\n        : orphanBlock.previousConnection;\n    return !!Connection.getConnectionForOrphanedConnection(\n      topBlock as Block,\n      orphanConnection as Connection,\n    );\n  }\n\n  /**\n   * Chooses a connection preview method based on the available connection, the\n   * current dragged connection, and the block being dragged.\n   *\n   * @param closest The available connection.\n   * @param local The connection currently being dragged.\n   * @param topBlock The block currently being dragged.\n   * @returns The preview type to display.\n   *\n   * @deprecated v10 - This function is no longer respected. A custom\n   *    IConnectionPreviewer may be able to fulfill the functionality.\n   */\n  getConnectionPreviewMethod(\n    closest: RenderedConnection,\n    local: RenderedConnection,\n    topBlock: BlockSvg,\n  ): PreviewType {\n    deprecation.warn(\n      'getConnectionPreviewMethod',\n      'v10',\n      'v12',\n      'an IConnectionPreviewer, if it fulfills your use case.',\n    );\n    if (\n      local.type === ConnectionType.OUTPUT_VALUE ||\n      local.type === ConnectionType.PREVIOUS_STATEMENT\n    ) {\n      if (\n        !closest.isConnected() ||\n        this.orphanCanConnectAtEnd(\n          topBlock,\n          closest.targetBlock() as BlockSvg,\n          local.type,\n        )\n      ) {\n        return InsertionMarkerManager.PREVIEW_TYPE.INSERTION_MARKER;\n      }\n      return InsertionMarkerManager.PREVIEW_TYPE.REPLACEMENT_FADE;\n    }\n\n    return InsertionMarkerManager.PREVIEW_TYPE.INSERTION_MARKER;\n  }\n\n  /**\n   * Render the block.\n   *\n   * @param block The block to render.\n   * @internal\n   */\n  render(block: BlockSvg) {\n    const info = this.makeRenderInfo_(block);\n    info.measure();\n    this.makeDrawer_(block, info).draw();\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object in charge of storing and updating a workspace theme\n *     and UI components.\n *\n * @class\n */\n// Former goog.module ID: Blockly.ThemeManager\n\nimport type {Theme} from './theme.js';\nimport * as arrayUtils from './utils/array.js';\nimport * as dom from './utils/dom.js';\nimport type {Workspace} from './workspace.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Class for storing and updating a workspace's theme and UI components.\n */\nexport class ThemeManager {\n  /** A list of workspaces that are subscribed to this theme. */\n  private subscribedWorkspaces_: Workspace[] = [];\n  private componentDB = new Map<string, Component[]>();\n\n  /**\n   * @param workspace The main workspace.\n   * @param theme The workspace theme.\n   * @internal\n   */\n  constructor(\n    private readonly workspace: WorkspaceSvg,\n    private theme: Theme,\n  ) {}\n\n  /**\n   * Get the workspace theme.\n   *\n   * @returns The workspace theme.\n   * @internal\n   */\n  getTheme(): Theme {\n    return this.theme;\n  }\n\n  /**\n   * Set the workspace theme, and refresh the workspace and all components.\n   *\n   * @param theme The workspace theme.\n   * @internal\n   */\n  setTheme(theme: Theme) {\n    const prevTheme = this.theme;\n    this.theme = theme;\n    // Set the theme name onto the injection div.\n    const injectionDiv = this.workspace.getInjectionDiv();\n    if (injectionDiv) {\n      if (prevTheme) {\n        const oldClassName = prevTheme.getClassName();\n        if (oldClassName) {\n          dom.removeClass(injectionDiv, oldClassName);\n        }\n      }\n      const newClassName = this.theme.getClassName();\n      if (newClassName) {\n        dom.addClass(injectionDiv, newClassName);\n      }\n    }\n\n    // Refresh all subscribed workspaces.\n    for (\n      let i = 0, workspace;\n      (workspace = this.subscribedWorkspaces_[i]);\n      i++\n    ) {\n      (workspace as WorkspaceSvg).refreshTheme();\n    }\n\n    // Refresh all registered Blockly UI components.\n    for (const [key, componentList] of this.componentDB) {\n      for (const component of componentList) {\n        const element = component.element;\n        const propertyName = component.propertyName;\n        const style = this.theme && this.theme.getComponentStyle(key);\n        element.style.setProperty(propertyName, style || '');\n      }\n    }\n\n    for (const workspace of this.subscribedWorkspaces_) {\n      (workspace as WorkspaceSvg).hideChaff();\n    }\n  }\n\n  /**\n   * Subscribe a workspace to changes to the selected theme.  If a new theme is\n   * set, the workspace is called to refresh its blocks.\n   *\n   * @param workspace The workspace to subscribe.\n   * @internal\n   */\n  subscribeWorkspace(workspace: Workspace) {\n    this.subscribedWorkspaces_.push(workspace);\n  }\n\n  /**\n   * Unsubscribe a workspace to changes to the selected theme.\n   *\n   * @param workspace The workspace to unsubscribe.\n   * @internal\n   */\n  unsubscribeWorkspace(workspace: Workspace) {\n    if (!arrayUtils.removeElem(this.subscribedWorkspaces_, workspace)) {\n      throw Error(\n        \"Cannot unsubscribe a workspace that hasn't been subscribed.\",\n      );\n    }\n  }\n\n  /**\n   * Subscribe an element to changes to the selected theme.  If a new theme is\n   * selected, the element's style is refreshed with the new theme's style.\n   *\n   * @param element The element to subscribe.\n   * @param componentName The name used to identify the component. This must be\n   *     the same name used to configure the style in the Theme object.\n   * @param propertyName The inline style property name to update.\n   * @internal\n   */\n  subscribe(\n    element: HTMLElement | SVGElement,\n    componentName: string,\n    propertyName: string,\n  ) {\n    if (!this.componentDB.has(componentName)) {\n      this.componentDB.set(componentName, []);\n    }\n\n    // Add the element to our component map.\n    this.componentDB.get(componentName)!.push({element, propertyName});\n\n    // Initialize the element with its corresponding theme style.\n    const style = this.theme && this.theme.getComponentStyle(componentName);\n    element.style.setProperty(propertyName, style || '');\n  }\n\n  /**\n   * Unsubscribe an element to changes to the selected theme.\n   *\n   * @param element The element to unsubscribe.\n   * @internal\n   */\n  unsubscribe(element: HTMLElement | SVGElement) {\n    if (!element) {\n      return;\n    }\n    // Go through all component, and remove any references to this element.\n    for (const [componentName, elements] of this.componentDB) {\n      for (let i = elements.length - 1; i >= 0; i--) {\n        if (elements[i].element === element) {\n          elements.splice(i, 1);\n        }\n      }\n      // Clean up the component map entry if the list is empty.\n      if (!elements.length) {\n        this.componentDB.delete(componentName);\n      }\n    }\n  }\n\n  /**\n   * Dispose of this theme manager.\n   *\n   * @internal\n   */\n  dispose() {\n    this.subscribedWorkspaces_.length = 0;\n    this.componentDB.clear();\n  }\n}\n\nexport namespace ThemeManager {\n  /** The type for a Blockly UI Component. */\n  export interface Component {\n    element: HTMLElement | SVGElement;\n    propertyName: string;\n  }\n}\n\nexport type Component = ThemeManager.Component;\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * An object that encapsulates logic for checking whether a\n * potential connection is safe and valid.\n *\n * @class\n */\n// Former goog.module ID: Blockly.ConnectionChecker\n\nimport * as common from './common.js';\nimport {Connection} from './connection.js';\nimport {ConnectionType} from './connection_type.js';\nimport type {IConnectionChecker} from './interfaces/i_connection_checker.js';\nimport * as internalConstants from './internal_constants.js';\nimport * as registry from './registry.js';\nimport type {RenderedConnection} from './rendered_connection.js';\n\n/**\n * Class for connection type checking logic.\n */\nexport class ConnectionChecker implements IConnectionChecker {\n  /**\n   * Check whether the current connection can connect with the target\n   * connection.\n   *\n   * @param a Connection to check compatibility with.\n   * @param b Connection to check compatibility with.\n   * @param isDragging True if the connection is being made by dragging a block.\n   * @param opt_distance The max allowable distance between the connections for\n   *     drag checks.\n   * @returns Whether the connection is legal.\n   */\n  canConnect(\n    a: Connection | null,\n    b: Connection | null,\n    isDragging: boolean,\n    opt_distance?: number,\n  ): boolean {\n    return (\n      this.canConnectWithReason(a, b, isDragging, opt_distance) ===\n      Connection.CAN_CONNECT\n    );\n  }\n\n  /**\n   * Checks whether the current connection can connect with the target\n   * connection, and return an error code if there are problems.\n   *\n   * @param a Connection to check compatibility with.\n   * @param b Connection to check compatibility with.\n   * @param isDragging True if the connection is being made by dragging a block.\n   * @param opt_distance The max allowable distance between the connections for\n   *     drag checks.\n   * @returns Connection.CAN_CONNECT if the connection is legal, an error code\n   *     otherwise.\n   */\n  canConnectWithReason(\n    a: Connection | null,\n    b: Connection | null,\n    isDragging: boolean,\n    opt_distance?: number,\n  ): number {\n    const safety = this.doSafetyChecks(a, b);\n    if (safety !== Connection.CAN_CONNECT) {\n      return safety;\n    }\n\n    // If the safety checks passed, both connections are non-null.\n    const connOne = a!;\n    const connTwo = b!;\n    if (!this.doTypeChecks(connOne, connTwo)) {\n      return Connection.REASON_CHECKS_FAILED;\n    }\n\n    if (\n      isDragging &&\n      !this.doDragChecks(\n        a as RenderedConnection,\n        b as RenderedConnection,\n        opt_distance || 0,\n      )\n    ) {\n      return Connection.REASON_DRAG_CHECKS_FAILED;\n    }\n\n    return Connection.CAN_CONNECT;\n  }\n\n  /**\n   * Helper method that translates a connection error code into a string.\n   *\n   * @param errorCode The error code.\n   * @param a One of the two connections being checked.\n   * @param b The second of the two connections being checked.\n   * @returns A developer-readable error string.\n   */\n  getErrorMessage(\n    errorCode: number,\n    a: Connection | null,\n    b: Connection | null,\n  ): string {\n    switch (errorCode) {\n      case Connection.REASON_SELF_CONNECTION:\n        return 'Attempted to connect a block to itself.';\n      case Connection.REASON_DIFFERENT_WORKSPACES:\n        // Usually this means one block has been deleted.\n        return 'Blocks not on same workspace.';\n      case Connection.REASON_WRONG_TYPE:\n        return 'Attempt to connect incompatible types.';\n      case Connection.REASON_TARGET_NULL:\n        return 'Target connection is null.';\n      case Connection.REASON_CHECKS_FAILED: {\n        const connOne = a!;\n        const connTwo = b!;\n        let msg = 'Connection checks failed. ';\n        msg +=\n          connOne +\n          ' expected ' +\n          connOne.getCheck() +\n          ', found ' +\n          connTwo.getCheck();\n        return msg;\n      }\n      case Connection.REASON_SHADOW_PARENT:\n        return 'Connecting non-shadow to shadow block.';\n      case Connection.REASON_DRAG_CHECKS_FAILED:\n        return 'Drag checks failed.';\n      case Connection.REASON_PREVIOUS_AND_OUTPUT:\n        return 'Block would have an output and a previous connection.';\n      default:\n        return 'Unknown connection failure: this should never happen!';\n    }\n  }\n\n  /**\n   * Check that connecting the given connections is safe, meaning that it would\n   * not break any of Blockly's basic assumptions (e.g. no self connections).\n   *\n   * @param a The first of the connections to check.\n   * @param b The second of the connections to check.\n   * @returns An enum with the reason this connection is safe or unsafe.\n   */\n  doSafetyChecks(a: Connection | null, b: Connection | null): number {\n    if (!a || !b) {\n      return Connection.REASON_TARGET_NULL;\n    }\n    let superiorBlock;\n    let inferiorBlock;\n    let superiorConnection;\n    let inferiorConnection;\n    if (a.isSuperior()) {\n      superiorBlock = a.getSourceBlock();\n      inferiorBlock = b.getSourceBlock();\n      superiorConnection = a;\n      inferiorConnection = b;\n    } else {\n      inferiorBlock = a.getSourceBlock();\n      superiorBlock = b.getSourceBlock();\n      inferiorConnection = a;\n      superiorConnection = b;\n    }\n    if (superiorBlock === inferiorBlock) {\n      return Connection.REASON_SELF_CONNECTION;\n    } else if (\n      inferiorConnection.type !==\n      internalConstants.OPPOSITE_TYPE[superiorConnection.type]\n    ) {\n      return Connection.REASON_WRONG_TYPE;\n    } else if (superiorBlock.workspace !== inferiorBlock.workspace) {\n      return Connection.REASON_DIFFERENT_WORKSPACES;\n    } else if (superiorBlock.isShadow() && !inferiorBlock.isShadow()) {\n      return Connection.REASON_SHADOW_PARENT;\n    } else if (\n      inferiorConnection.type === ConnectionType.OUTPUT_VALUE &&\n      inferiorBlock.previousConnection &&\n      inferiorBlock.previousConnection.isConnected()\n    ) {\n      return Connection.REASON_PREVIOUS_AND_OUTPUT;\n    } else if (\n      inferiorConnection.type === ConnectionType.PREVIOUS_STATEMENT &&\n      inferiorBlock.outputConnection &&\n      inferiorBlock.outputConnection.isConnected()\n    ) {\n      return Connection.REASON_PREVIOUS_AND_OUTPUT;\n    }\n    return Connection.CAN_CONNECT;\n  }\n\n  /**\n   * Check whether this connection is compatible with another connection with\n   * respect to the value type system.  E.g. square_root(\"Hello\") is not\n   * compatible.\n   *\n   * @param a Connection to compare.\n   * @param b Connection to compare against.\n   * @returns True if the connections share a type.\n   */\n  doTypeChecks(a: Connection, b: Connection): boolean {\n    const checkArrayOne = a.getCheck();\n    const checkArrayTwo = b.getCheck();\n\n    if (!checkArrayOne || !checkArrayTwo) {\n      // One or both sides are promiscuous enough that anything will fit.\n      return true;\n    }\n    // Find any intersection in the check lists.\n    for (let i = 0; i < checkArrayOne.length; i++) {\n      if (checkArrayTwo.indexOf(checkArrayOne[i]) !== -1) {\n        return true;\n      }\n    }\n    // No intersection.\n    return false;\n  }\n\n  /**\n   * Check whether this connection can be made by dragging.\n   *\n   * @param a Connection to compare (on the block that's being dragged).\n   * @param b Connection to compare against.\n   * @param distance The maximum allowable distance between connections.\n   * @returns True if the connection is allowed during a drag.\n   */\n  doDragChecks(\n    a: RenderedConnection,\n    b: RenderedConnection,\n    distance: number,\n  ): boolean {\n    if (a.distanceFrom(b) > distance) {\n      return false;\n    }\n\n    // Don't consider insertion markers.\n    if (b.getSourceBlock().isInsertionMarker()) {\n      return false;\n    }\n\n    switch (b.type) {\n      case ConnectionType.PREVIOUS_STATEMENT:\n        return this.canConnectToPrevious_(a, b);\n      case ConnectionType.OUTPUT_VALUE: {\n        // Don't offer to connect an already connected left (male) value plug to\n        // an available right (female) value plug.\n        if (\n          (b.isConnected() && !b.targetBlock()!.isInsertionMarker()) ||\n          a.isConnected()\n        ) {\n          return false;\n        }\n        break;\n      }\n      case ConnectionType.INPUT_VALUE: {\n        // Offering to connect the left (male) of a value block to an already\n        // connected value pair is ok, we'll splice it in.\n        // However, don't offer to splice into an immovable block.\n        if (\n          b.isConnected() &&\n          !b.targetBlock()!.isMovable() &&\n          !b.targetBlock()!.isShadow()\n        ) {\n          return false;\n        }\n        break;\n      }\n      case ConnectionType.NEXT_STATEMENT: {\n        // Don't let a block with no next connection bump other blocks out of\n        // the stack.  But covering up a shadow block or stack of shadow blocks\n        // is fine.  Similarly, replacing a terminal statement with another\n        // terminal statement is allowed.\n        if (\n          b.isConnected() &&\n          !a.getSourceBlock().nextConnection &&\n          !b.targetBlock()!.isShadow() &&\n          b.targetBlock()!.nextConnection\n        ) {\n          return false;\n        }\n\n        // Don't offer to splice into a stack where the connected block is\n        // immovable, unless the block is a shadow block.\n        if (\n          b.targetBlock() &&\n          !b.targetBlock()!.isMovable() &&\n          !b.targetBlock()!.isShadow()\n        ) {\n          return false;\n        }\n        break;\n      }\n      default:\n        // Unexpected connection type.\n        return false;\n    }\n\n    // Don't let blocks try to connect to themselves or ones they nest.\n    if (common.draggingConnections.indexOf(b) !== -1) {\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Helper function for drag checking.\n   *\n   * @param a The connection to check, which must be a statement input or next\n   *     connection.\n   * @param b A nearby connection to check, which must be a previous connection.\n   * @returns True if the connection is allowed, false otherwise.\n   */\n  protected canConnectToPrevious_(a: Connection, b: Connection): boolean {\n    if (a.targetConnection) {\n      // This connection is already occupied.\n      // A next connection will never disconnect itself mid-drag.\n      return false;\n    }\n\n    // Don't let blocks try to connect to themselves or ones they nest.\n    if (common.draggingConnections.indexOf(b) !== -1) {\n      return false;\n    }\n\n    if (!b.targetConnection) {\n      return true;\n    }\n\n    const targetBlock = b.targetBlock();\n    // If it is connected to a real block, game over.\n    if (!targetBlock!.isInsertionMarker()) {\n      return false;\n    }\n    // If it's connected to an insertion marker but that insertion marker\n    // is the first block in a stack, it's still fine.  If that insertion\n    // marker is in the middle of a stack, it won't work.\n    return !targetBlock!.getPreviousBlock();\n  }\n}\n\nregistry.register(\n  registry.Type.CONNECTION_CHECKER,\n  registry.DEFAULT,\n  ConnectionChecker,\n);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.Events.VarDelete\n\nimport * as registry from '../registry.js';\nimport type {VariableModel} from '../variable_model.js';\n\nimport {VarBase, VarBaseJson} from './events_var_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners that a variable model has been deleted.\n *\n * @class\n */\nexport class VarDelete extends VarBase {\n  override type = eventUtils.VAR_DELETE;\n  /** The type of the variable that was deleted. */\n  varType?: string;\n  /** The name of the variable that was deleted. */\n  varName?: string;\n\n  /**\n   * @param opt_variable The deleted variable. Undefined for a blank event.\n   */\n  constructor(opt_variable?: VariableModel) {\n    super(opt_variable);\n\n    if (!opt_variable) {\n      return; // Blank event to be populated by fromJson.\n    }\n    this.varType = opt_variable.type;\n    this.varName = opt_variable.name;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): VarDeleteJson {\n    const json = super.toJson() as VarDeleteJson;\n    if (this.varType === undefined) {\n      throw new Error(\n        'The var type is undefined. Either pass a variable to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (!this.varName) {\n      throw new Error(\n        'The var name is undefined. Either pass a variable to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    json['varType'] = this.varType;\n    json['varName'] = this.varName;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of VarDelete, but we can't specify that due to the fact that parameters\n   *     to static methods in subclasses must be supertypes of parameters to\n   *     static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: VarDeleteJson,\n    workspace: Workspace,\n    event?: any,\n  ): VarDelete {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new VarDelete(),\n    ) as VarDelete;\n    newEvent.varType = json['varType'];\n    newEvent.varName = json['varName'];\n    return newEvent;\n  }\n\n  /**\n   * Run a variable deletion event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    if (!this.varId) {\n      throw new Error(\n        'The var ID is undefined. Either pass a variable to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (!this.varName) {\n      throw new Error(\n        'The var name is undefined. Either pass a variable to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (forward) {\n      workspace.deleteVariableById(this.varId);\n    } else {\n      workspace.createVariable(this.varName, this.varType, this.varId);\n    }\n  }\n}\n\nexport interface VarDeleteJson extends VarBaseJson {\n  varType: string;\n  varName: string;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.VAR_DELETE, VarDelete);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.Events.VarRename\n\nimport * as registry from '../registry.js';\nimport type {VariableModel} from '../variable_model.js';\n\nimport {VarBase, VarBaseJson} from './events_var_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners that a variable model was renamed.\n *\n * @class\n */\nexport class VarRename extends VarBase {\n  override type = eventUtils.VAR_RENAME;\n\n  /** The previous name of the variable. */\n  oldName?: string;\n\n  /** The new name of the variable. */\n  newName?: string;\n\n  /**\n   * @param opt_variable The renamed variable. Undefined for a blank event.\n   * @param newName The new name the variable will be changed to.\n   */\n  constructor(opt_variable?: VariableModel, newName?: string) {\n    super(opt_variable);\n\n    if (!opt_variable) {\n      return; // Blank event to be populated by fromJson.\n    }\n    this.oldName = opt_variable.name;\n    this.newName = typeof newName === 'undefined' ? '' : newName;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): VarRenameJson {\n    const json = super.toJson() as VarRenameJson;\n    if (!this.oldName) {\n      throw new Error(\n        'The old var name is undefined. Either pass a variable to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (!this.newName) {\n      throw new Error(\n        'The new var name is undefined. Either pass a value to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    json['oldName'] = this.oldName;\n    json['newName'] = this.newName;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of VarRename, but we can't specify that due to the fact that parameters\n   *     to static methods in subclasses must be supertypes of parameters to\n   *     static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: VarRenameJson,\n    workspace: Workspace,\n    event?: any,\n  ): VarRename {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new VarRename(),\n    ) as VarRename;\n    newEvent.oldName = json['oldName'];\n    newEvent.newName = json['newName'];\n    return newEvent;\n  }\n\n  /**\n   * Run a variable rename event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    if (!this.varId) {\n      throw new Error(\n        'The var ID is undefined. Either pass a variable to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (!this.oldName) {\n      throw new Error(\n        'The old var name is undefined. Either pass a variable to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (!this.newName) {\n      throw new Error(\n        'The new var name is undefined. Either pass a value to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (forward) {\n      workspace.renameVariableById(this.varId, this.newName);\n    } else {\n      workspace.renameVariableById(this.varId, this.oldName);\n    }\n  }\n}\n\nexport interface VarRenameJson extends VarBaseJson {\n  oldName: string;\n  newName: string;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.VAR_RENAME, VarRename);\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a map of variables and their types.\n *\n * @class\n */\n// Former goog.module ID: Blockly.VariableMap\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_var_delete.js';\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_var_rename.js';\n\nimport type {Block} from './block.js';\nimport * as dialog from './dialog.js';\nimport * as eventUtils from './events/utils.js';\nimport {Msg} from './msg.js';\nimport {Names} from './names.js';\nimport * as arrayUtils from './utils/array.js';\nimport * as idGenerator from './utils/idgenerator.js';\nimport {VariableModel} from './variable_model.js';\nimport type {Workspace} from './workspace.js';\n\n/**\n * Class for a variable map.  This contains a dictionary data structure with\n * variable types as keys and lists of variables as values.  The list of\n * variables are the type indicated by the key.\n */\nexport class VariableMap {\n  /**\n   * A map from variable type to list of variable names.  The lists contain\n   * all of the named variables in the workspace, including variables that are\n   * not currently in use.\n   */\n  private variableMap = new Map<string, VariableModel[]>();\n\n  /** @param workspace The workspace this map belongs to. */\n  constructor(public workspace: Workspace) {}\n\n  /** Clear the variable map.  Fires events for every deletion. */\n  clear() {\n    for (const variables of this.variableMap.values()) {\n      while (variables.length > 0) {\n        this.deleteVariable(variables[0]);\n      }\n    }\n    if (this.variableMap.size !== 0) {\n      throw Error('Non-empty variable map');\n    }\n  }\n\n  /* Begin functions for renaming variables. */\n  /**\n   * Rename the given variable by updating its name in the variable map.\n   *\n   * @param variable Variable to rename.\n   * @param newName New variable name.\n   * @internal\n   */\n  renameVariable(variable: VariableModel, newName: string) {\n    if (variable.name === newName) return;\n    const type = variable.type;\n    const conflictVar = this.getVariable(newName, type);\n    const blocks = this.workspace.getAllBlocks(false);\n    const existingGroup = eventUtils.getGroup();\n    if (!existingGroup) {\n      eventUtils.setGroup(true);\n    }\n    try {\n      // The IDs may match if the rename is a simple case change (name1 ->\n      // Name1).\n      if (!conflictVar || conflictVar.getId() === variable.getId()) {\n        this.renameVariableAndUses_(variable, newName, blocks);\n      } else {\n        this.renameVariableWithConflict_(\n          variable,\n          newName,\n          conflictVar,\n          blocks,\n        );\n      }\n    } finally {\n      eventUtils.setGroup(existingGroup);\n    }\n  }\n\n  /**\n   * Rename a variable by updating its name in the variable map. Identify the\n   * variable to rename with the given ID.\n   *\n   * @param id ID of the variable to rename.\n   * @param newName New variable name.\n   */\n  renameVariableById(id: string, newName: string) {\n    const variable = this.getVariableById(id);\n    if (!variable) {\n      throw Error(\"Tried to rename a variable that didn't exist. ID: \" + id);\n    }\n\n    this.renameVariable(variable, newName);\n  }\n\n  /**\n   * Update the name of the given variable and refresh all references to it.\n   * The new name must not conflict with any existing variable names.\n   *\n   * @param variable Variable to rename.\n   * @param newName New variable name.\n   * @param blocks The list of all blocks in the workspace.\n   */\n  private renameVariableAndUses_(\n    variable: VariableModel,\n    newName: string,\n    blocks: Block[],\n  ) {\n    eventUtils.fire(\n      new (eventUtils.get(eventUtils.VAR_RENAME))(variable, newName),\n    );\n    variable.name = newName;\n    for (let i = 0; i < blocks.length; i++) {\n      blocks[i].updateVarName(variable);\n    }\n  }\n\n  /**\n   * Update the name of the given variable to the same name as an existing\n   * variable.  The two variables are coalesced into a single variable with the\n   * ID of the existing variable that was already using newName. Refresh all\n   * references to the variable.\n   *\n   * @param variable Variable to rename.\n   * @param newName New variable name.\n   * @param conflictVar The variable that was already using newName.\n   * @param blocks The list of all blocks in the workspace.\n   */\n  private renameVariableWithConflict_(\n    variable: VariableModel,\n    newName: string,\n    conflictVar: VariableModel,\n    blocks: Block[],\n  ) {\n    const type = variable.type;\n    const oldCase = conflictVar.name;\n\n    if (newName !== oldCase) {\n      // Simple rename to change the case and update references.\n      this.renameVariableAndUses_(conflictVar, newName, blocks);\n    }\n\n    // These blocks now refer to a different variable.\n    // These will fire change events.\n    for (let i = 0; i < blocks.length; i++) {\n      blocks[i].renameVarById(variable.getId(), conflictVar.getId());\n    }\n    // Finally delete the original variable, which is now unreferenced.\n    eventUtils.fire(new (eventUtils.get(eventUtils.VAR_DELETE))(variable));\n    // And remove it from the list.\n    arrayUtils.removeElem(this.variableMap.get(type)!, variable);\n  }\n\n  /* End functions for renaming variables. */\n  /**\n   * Create a variable with a given name, optional type, and optional ID.\n   *\n   * @param name The name of the variable. This must be unique across variables\n   *     and procedures.\n   * @param opt_type The type of the variable like 'int' or 'string'.\n   *     Does not need to be unique. Field_variable can filter variables based\n   * on their type. This will default to '' which is a specific type.\n   * @param opt_id The unique ID of the variable. This will default to a UUID.\n   * @returns The newly created variable.\n   */\n  createVariable(\n    name: string,\n    opt_type?: string | null,\n    opt_id?: string | null,\n  ): VariableModel {\n    let variable = this.getVariable(name, opt_type);\n    if (variable) {\n      if (opt_id && variable.getId() !== opt_id) {\n        throw Error(\n          'Variable \"' +\n            name +\n            '\" is already in use and its id is \"' +\n            variable.getId() +\n            '\" which conflicts with the passed in ' +\n            'id, \"' +\n            opt_id +\n            '\".',\n        );\n      }\n      // The variable already exists and has the same ID.\n      return variable;\n    }\n    if (opt_id && this.getVariableById(opt_id)) {\n      throw Error('Variable id, \"' + opt_id + '\", is already in use.');\n    }\n    const id = opt_id || idGenerator.genUid();\n    const type = opt_type || '';\n    variable = new VariableModel(this.workspace, name, type, id);\n\n    const variables = this.variableMap.get(type) || [];\n    variables.push(variable);\n    // Delete the list of variables of this type, and re-add it so that\n    // the most recent addition is at the end.\n    // This is used so the toolbox's set block is set to the most recent\n    // variable.\n    this.variableMap.delete(type);\n    this.variableMap.set(type, variables);\n\n    eventUtils.fire(new (eventUtils.get(eventUtils.VAR_CREATE))(variable));\n\n    return variable;\n  }\n\n  /* Begin functions for variable deletion. */\n  /**\n   * Delete a variable.\n   *\n   * @param variable Variable to delete.\n   */\n  deleteVariable(variable: VariableModel) {\n    const variableId = variable.getId();\n    const variableList = this.variableMap.get(variable.type);\n    if (variableList) {\n      for (let i = 0; i < variableList.length; i++) {\n        const tempVar = variableList[i];\n        if (tempVar.getId() === variableId) {\n          variableList.splice(i, 1);\n          eventUtils.fire(\n            new (eventUtils.get(eventUtils.VAR_DELETE))(variable),\n          );\n          if (variableList.length === 0) {\n            this.variableMap.delete(variable.type);\n          }\n          return;\n        }\n      }\n    }\n  }\n\n  /**\n   * Delete a variables by the passed in ID and all of its uses from this\n   * workspace. May prompt the user for confirmation.\n   *\n   * @param id ID of variable to delete.\n   */\n  deleteVariableById(id: string) {\n    const variable = this.getVariableById(id);\n    if (variable) {\n      // Check whether this variable is a function parameter before deleting.\n      const variableName = variable.name;\n      const uses = this.getVariableUsesById(id);\n      for (let i = 0, block; (block = uses[i]); i++) {\n        if (\n          block.type === 'procedures_defnoreturn' ||\n          block.type === 'procedures_defreturn'\n        ) {\n          const procedureName = String(block.getFieldValue('NAME'));\n          const deleteText = Msg['CANNOT_DELETE_VARIABLE_PROCEDURE']\n            .replace('%1', variableName)\n            .replace('%2', procedureName);\n          dialog.alert(deleteText);\n          return;\n        }\n      }\n\n      if (uses.length > 1) {\n        // Confirm before deleting multiple blocks.\n        const confirmText = Msg['DELETE_VARIABLE_CONFIRMATION']\n          .replace('%1', String(uses.length))\n          .replace('%2', variableName);\n        dialog.confirm(confirmText, (ok) => {\n          if (ok && variable) {\n            this.deleteVariableInternal(variable, uses);\n          }\n        });\n      } else {\n        // No confirmation necessary for a single block.\n        this.deleteVariableInternal(variable, uses);\n      }\n    } else {\n      console.warn(\"Can't delete non-existent variable: \" + id);\n    }\n  }\n\n  /**\n   * Deletes a variable and all of its uses from this workspace without asking\n   * the user for confirmation.\n   *\n   * @param variable Variable to delete.\n   * @param uses An array of uses of the variable.\n   * @internal\n   */\n  deleteVariableInternal(variable: VariableModel, uses: Block[]) {\n    const existingGroup = eventUtils.getGroup();\n    if (!existingGroup) {\n      eventUtils.setGroup(true);\n    }\n    try {\n      for (let i = 0; i < uses.length; i++) {\n        uses[i].dispose(true);\n      }\n      this.deleteVariable(variable);\n    } finally {\n      eventUtils.setGroup(existingGroup);\n    }\n  }\n  /* End functions for variable deletion. */\n  /**\n   * Find the variable by the given name and type and return it.  Return null if\n   *     it is not found.\n   *\n   * @param name The name to check for.\n   * @param opt_type The type of the variable.  If not provided it defaults to\n   *     the empty string, which is a specific type.\n   * @returns The variable with the given name, or null if it was not found.\n   */\n  getVariable(name: string, opt_type?: string | null): VariableModel | null {\n    const type = opt_type || '';\n    const list = this.variableMap.get(type);\n    if (list) {\n      for (let j = 0, variable; (variable = list[j]); j++) {\n        if (Names.equals(variable.name, name)) {\n          return variable;\n        }\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Find the variable by the given ID and return it.  Return null if not found.\n   *\n   * @param id The ID to check for.\n   * @returns The variable with the given ID.\n   */\n  getVariableById(id: string): VariableModel | null {\n    for (const variables of this.variableMap.values()) {\n      for (const variable of variables) {\n        if (variable.getId() === id) {\n          return variable;\n        }\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Get a list containing all of the variables of a specified type. If type is\n   *     null, return list of variables with empty string type.\n   *\n   * @param type Type of the variables to find.\n   * @returns The sought after variables of the passed in type. An empty array\n   *     if none are found.\n   */\n  getVariablesOfType(type: string | null): VariableModel[] {\n    type = type || '';\n    const variableList = this.variableMap.get(type);\n    if (variableList) {\n      return variableList.slice();\n    }\n    return [];\n  }\n\n  /**\n   * Return all variable and potential variable types.  This list always\n   * contains the empty string.\n   *\n   * @param ws The workspace used to look for potential variables. This can be\n   *     different than the workspace stored on this object if the passed in ws\n   *     is a flyout workspace.\n   * @returns List of variable types.\n   * @internal\n   */\n  getVariableTypes(ws: Workspace | null): string[] {\n    const variableTypes = new Set<string>(this.variableMap.keys());\n    if (ws && ws.getPotentialVariableMap()) {\n      for (const key of ws.getPotentialVariableMap()!.variableMap.keys()) {\n        variableTypes.add(key);\n      }\n    }\n    if (!variableTypes.has('')) {\n      variableTypes.add('');\n    }\n    return Array.from(variableTypes.values());\n  }\n\n  /**\n   * Return all variables of all types.\n   *\n   * @returns List of variable models.\n   */\n  getAllVariables(): VariableModel[] {\n    let allVariables: VariableModel[] = [];\n    for (const variables of this.variableMap.values()) {\n      allVariables = allVariables.concat(variables);\n    }\n    return allVariables;\n  }\n\n  /**\n   * Returns all of the variable names of all types.\n   *\n   * @returns All of the variable names of all types.\n   */\n  getAllVariableNames(): string[] {\n    return Array.from(this.variableMap.values())\n      .flat()\n      .map((variable) => variable.name);\n  }\n\n  /**\n   * Find all the uses of a named variable.\n   *\n   * @param id ID of the variable to find.\n   * @returns Array of block usages.\n   */\n  getVariableUsesById(id: string): Block[] {\n    const uses = [];\n    const blocks = this.workspace.getAllBlocks(false);\n    // Iterate through every block and check the name.\n    for (let i = 0; i < blocks.length; i++) {\n      const blockVariables = blocks[i].getVarModels();\n      if (blockVariables) {\n        for (let j = 0; j < blockVariables.length; j++) {\n          if (blockVariables[j].getId() === id) {\n            uses.push(blocks[i]);\n          }\n        }\n      }\n    }\n    return uses;\n  }\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a workspace.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Workspace\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './connection_checker.js';\n\nimport type {Block} from './block.js';\nimport type {BlocklyOptions} from './blockly_options.js';\nimport type {ConnectionDB} from './connection_db.js';\nimport type {Abstract} from './events/events_abstract.js';\nimport * as common from './common.js';\nimport * as eventUtils from './events/utils.js';\nimport type {IASTNodeLocation} from './interfaces/i_ast_node_location.js';\nimport type {IConnectionChecker} from './interfaces/i_connection_checker.js';\nimport {Options} from './options.js';\nimport * as registry from './registry.js';\nimport * as arrayUtils from './utils/array.js';\nimport * as idGenerator from './utils/idgenerator.js';\nimport * as math from './utils/math.js';\nimport type * as toolbox from './utils/toolbox.js';\nimport {VariableMap} from './variable_map.js';\nimport type {VariableModel} from './variable_model.js';\nimport type {WorkspaceComment} from './workspace_comment.js';\nimport {IProcedureMap} from './interfaces/i_procedure_map.js';\nimport {ObservableProcedureMap} from './observable_procedure_map.js';\n\n/**\n * Class for a workspace.  This is a data structure that contains blocks.\n * There is no UI, and can be created headlessly.\n */\nexport class Workspace implements IASTNodeLocation {\n  /**\n   * Angle away from the horizontal to sweep for blocks.  Order of execution is\n   * generally top to bottom, but a small angle changes the scan to give a bit\n   * of a left to right bias (reversed in RTL).  Units are in degrees. See:\n   * https://tvtropes.org/pmwiki/pmwiki.php/Main/DiagonalBilling\n   */\n  static SCAN_ANGLE = 3;\n  id: string;\n  options: Options;\n  RTL: boolean;\n  horizontalLayout: boolean;\n  toolboxPosition: toolbox.Position;\n\n  /**\n   * Returns `true` if the workspace is visible and `false` if it's headless.\n   */\n  rendered = false;\n\n  /**\n   * Is this workspace the surface for a flyout?\n   *\n   * @internal\n   */\n  internalIsFlyout = false;\n\n  /** Is this workspace the surface for a flyout? */\n  get isFlyout(): boolean {\n    return this.internalIsFlyout;\n  }\n\n  /**\n   * Is this workspace the surface for a mutator?\n   *\n   * @internal\n   */\n  internalIsMutator = false;\n\n  /** Is this workspace the surface for a mutator? */\n  get isMutator(): boolean {\n    return this.internalIsMutator;\n  }\n\n  /**\n   * Returns `true` if the workspace is currently in the process of a bulk\n   * clear.\n   *\n   * @internal\n   */\n  isClearing = false;\n\n  /**\n   * Maximum number of undo events in stack. `0` turns off undo, `Infinity`\n   * sets it to unlimited.\n   */\n  MAX_UNDO = 1024;\n\n  /** Set of databases for rapid lookup of connection locations. */\n  connectionDBList: ConnectionDB[] = [];\n  connectionChecker: IConnectionChecker;\n\n  private readonly topBlocks: Block[] = [];\n  private readonly topComments: WorkspaceComment[] = [];\n  private readonly commentDB = new Map<string, WorkspaceComment>();\n  private readonly listeners: Function[] = [];\n  protected undoStack_: Abstract[] = [];\n  protected redoStack_: Abstract[] = [];\n  private readonly blockDB = new Map<string, Block>();\n  private readonly typedBlocksDB = new Map<string, Block[]>();\n  private variableMap: VariableMap;\n  private procedureMap: IProcedureMap = new ObservableProcedureMap();\n\n  /**\n   * Blocks in the flyout can refer to variables that don't exist in the main\n   * workspace.  For instance, the \"get item in list\" block refers to an\n   * \"item\" variable regardless of whether the variable has been created yet.\n   * A FieldVariable must always refer to a VariableModel.  We reconcile\n   * these by tracking \"potential\" variables in the flyout.  These variables\n   * become real when references to them are dragged into the main workspace.\n   */\n  private potentialVariableMap: VariableMap | null = null;\n\n  /** @param opt_options Dictionary of options. */\n  constructor(opt_options?: Options) {\n    this.id = idGenerator.genUid();\n    common.registerWorkspace(this);\n    this.options = opt_options || new Options({} as BlocklyOptions);\n    this.RTL = !!this.options.RTL;\n    this.horizontalLayout = !!this.options.horizontalLayout;\n    this.toolboxPosition = this.options.toolboxPosition;\n\n    const connectionCheckerClass = registry.getClassFromOptions(\n      registry.Type.CONNECTION_CHECKER,\n      this.options,\n      true,\n    );\n    /**\n     * An object that encapsulates logic for safety, type, and dragging checks.\n     */\n    this.connectionChecker = new connectionCheckerClass!(this);\n\n    /**\n     * A map from variable type to list of variable names.  The lists contain\n     * all of the named variables in the workspace, including variables that are\n     * not currently in use.\n     */\n    this.variableMap = new VariableMap(this);\n  }\n\n  /**\n   * Dispose of this workspace.\n   * Unlink from all DOM elements to prevent memory leaks.\n   */\n  dispose() {\n    this.listeners.length = 0;\n    this.clear();\n    // Remove from workspace database.\n    common.unregisterWorkpace(this);\n  }\n\n  /**\n   * Compare function for sorting objects (blocks, comments, etc) by position;\n   *    top to bottom (with slight LTR or RTL bias).\n   *\n   * @param a The first object to compare.\n   * @param b The second object to compare.\n   * @returns The comparison value. This tells Array.sort() how to change object\n   *     a's index.\n   */\n  private sortObjects_(\n    a: Block | WorkspaceComment,\n    b: Block | WorkspaceComment,\n  ): number {\n    const offset =\n      Math.sin(math.toRadians(Workspace.SCAN_ANGLE)) * (this.RTL ? -1 : 1);\n    const aXY = a.getRelativeToSurfaceXY();\n    const bXY = b.getRelativeToSurfaceXY();\n    return aXY.y + offset * aXY.x - (bXY.y + offset * bXY.x);\n  }\n\n  /**\n   * Adds a block to the list of top blocks.\n   *\n   * @param block Block to add.\n   */\n  addTopBlock(block: Block) {\n    this.topBlocks.push(block);\n  }\n\n  /**\n   * Removes a block from the list of top blocks.\n   *\n   * @param block Block to remove.\n   */\n  removeTopBlock(block: Block) {\n    if (!arrayUtils.removeElem(this.topBlocks, block)) {\n      throw Error(\"Block not present in workspace's list of top-most blocks.\");\n    }\n  }\n\n  /**\n   * Finds the top-level blocks and returns them.  Blocks are optionally sorted\n   * by position; top to bottom (with slight LTR or RTL bias).\n   *\n   * @param ordered Sort the list if true.\n   * @returns The top-level block objects.\n   */\n  getTopBlocks(ordered = false): Block[] {\n    // Copy the topBlocks list.\n    const blocks = new Array<Block>().concat(this.topBlocks);\n    if (ordered && blocks.length > 1) {\n      blocks.sort(this.sortObjects_.bind(this));\n    }\n    return blocks;\n  }\n\n  /**\n   * Add a block to the list of blocks keyed by type.\n   *\n   * @param block Block to add.\n   */\n  addTypedBlock(block: Block) {\n    if (!this.typedBlocksDB.has(block.type)) {\n      this.typedBlocksDB.set(block.type, []);\n    }\n    this.typedBlocksDB.get(block.type)!.push(block);\n  }\n\n  /**\n   * Remove a block from the list of blocks keyed by type.\n   *\n   * @param block Block to remove.\n   */\n  removeTypedBlock(block: Block) {\n    arrayUtils.removeElem(this.typedBlocksDB.get(block.type)!, block);\n    if (!this.typedBlocksDB.get(block.type)!.length) {\n      this.typedBlocksDB.delete(block.type);\n    }\n  }\n\n  /**\n   * Finds the blocks with the associated type and returns them. Blocks are\n   * optionally sorted by position; top to bottom (with slight LTR or RTL bias).\n   *\n   * @param type The type of block to search for.\n   * @param ordered Sort the list if true.\n   * @returns The blocks of the given type.\n   */\n  getBlocksByType(type: string, ordered = false): Block[] {\n    if (!this.typedBlocksDB.has(type)) {\n      return [];\n    }\n    const blocks = this.typedBlocksDB.get(type)!.slice(0);\n    if (ordered && blocks && blocks.length > 1) {\n      blocks.sort(this.sortObjects_.bind(this));\n    }\n\n    return blocks.filter(function (block: Block) {\n      return !block.isInsertionMarker();\n    });\n  }\n\n  /**\n   * Adds a comment to the list of top comments.\n   *\n   * @param comment comment to add.\n   * @internal\n   */\n  addTopComment(comment: WorkspaceComment) {\n    this.topComments.push(comment);\n\n    // Note: If the comment database starts to hold block comments, this may\n    // need to move to a separate function.\n    if (this.commentDB.has(comment.id)) {\n      console.warn(\n        'Overriding an existing comment on this workspace, with id \"' +\n          comment.id +\n          '\"',\n      );\n    }\n    this.commentDB.set(comment.id, comment);\n  }\n\n  /**\n   * Removes a comment from the list of top comments.\n   *\n   * @param comment comment to remove.\n   * @internal\n   */\n  removeTopComment(comment: WorkspaceComment) {\n    if (!arrayUtils.removeElem(this.topComments, comment)) {\n      throw Error(\n        \"Comment not present in workspace's list of top-most \" + 'comments.',\n      );\n    }\n    // Note: If the comment database starts to hold block comments, this may\n    // need to move to a separate function.\n    this.commentDB.delete(comment.id);\n  }\n\n  /**\n   * Finds the top-level comments and returns them.  Comments are optionally\n   * sorted by position; top to bottom (with slight LTR or RTL bias).\n   *\n   * @param ordered Sort the list if true.\n   * @returns The top-level comment objects.\n   * @internal\n   */\n  getTopComments(ordered = false): WorkspaceComment[] {\n    // Copy the topComments list.\n    const comments = new Array<WorkspaceComment>().concat(this.topComments);\n    if (ordered && comments.length > 1) {\n      comments.sort(this.sortObjects_.bind(this));\n    }\n    return comments;\n  }\n\n  /**\n   * Find all blocks in workspace.  Blocks are optionally sorted\n   * by position; top to bottom (with slight LTR or RTL bias).\n   *\n   * @param ordered Sort the list if true.\n   * @returns Array of blocks.\n   */\n  getAllBlocks(ordered = false): Block[] {\n    let blocks: Block[];\n    if (ordered) {\n      // Slow, but ordered.\n      const topBlocks = this.getTopBlocks(true);\n      blocks = [];\n      for (let i = 0; i < topBlocks.length; i++) {\n        blocks.push(...topBlocks[i].getDescendants(true));\n      }\n    } else {\n      // Fast, but in no particular order.\n      blocks = this.getTopBlocks(false);\n      for (let i = 0; i < blocks.length; i++) {\n        blocks.push(...blocks[i].getChildren(false));\n      }\n    }\n\n    // Insertion markers exist on the workspace for rendering reasons, but\n    // aren't \"real\" blocks from a developer perspective.\n    const filtered = blocks.filter(function (block) {\n      return !block.isInsertionMarker();\n    });\n\n    return filtered;\n  }\n\n  /** Dispose of all blocks and comments in workspace. */\n  clear() {\n    this.isClearing = true;\n    try {\n      const existingGroup = eventUtils.getGroup();\n      if (!existingGroup) {\n        eventUtils.setGroup(true);\n      }\n      while (this.topBlocks.length) {\n        this.topBlocks[0].dispose(false);\n      }\n      while (this.topComments.length) {\n        this.topComments[this.topComments.length - 1].dispose();\n      }\n      eventUtils.setGroup(existingGroup);\n      this.variableMap.clear();\n      if (this.potentialVariableMap) {\n        this.potentialVariableMap.clear();\n      }\n    } finally {\n      this.isClearing = false;\n    }\n  }\n\n  /* Begin functions that are just pass-throughs to the variable map. */\n  /**\n   * Rename a variable by updating its name in the variable map. Identify the\n   * variable to rename with the given ID.\n   *\n   * @param id ID of the variable to rename.\n   * @param newName New variable name.\n   */\n  renameVariableById(id: string, newName: string) {\n    this.variableMap.renameVariableById(id, newName);\n  }\n\n  /**\n   * Create a variable with a given name, optional type, and optional ID.\n   *\n   * @param name The name of the variable. This must be unique across variables\n   *     and procedures.\n   * @param opt_type The type of the variable like 'int' or 'string'.\n   *     Does not need to be unique. Field_variable can filter variables based\n   * on their type. This will default to '' which is a specific type.\n   * @param opt_id The unique ID of the variable. This will default to a UUID.\n   * @returns The newly created variable.\n   */\n  createVariable(\n    name: string,\n    opt_type?: string | null,\n    opt_id?: string | null,\n  ): VariableModel {\n    return this.variableMap.createVariable(name, opt_type, opt_id);\n  }\n\n  /**\n   * Find all the uses of the given variable, which is identified by ID.\n   *\n   * @param id ID of the variable to find.\n   * @returns Array of block usages.\n   */\n  getVariableUsesById(id: string): Block[] {\n    return this.variableMap.getVariableUsesById(id);\n  }\n\n  /**\n   * Delete a variables by the passed in ID and all of its uses from this\n   * workspace. May prompt the user for confirmation.\n   *\n   * @param id ID of variable to delete.\n   */\n  deleteVariableById(id: string) {\n    this.variableMap.deleteVariableById(id);\n  }\n\n  /**\n   * Find the variable by the given name and return it. Return null if not\n   * found.\n   *\n   * @param name The name to check for.\n   * @param opt_type The type of the variable.  If not provided it defaults to\n   *     the empty string, which is a specific type.\n   * @returns The variable with the given name.\n   */\n  getVariable(name: string, opt_type?: string): VariableModel | null {\n    // TODO (#1559): Possibly delete this function after resolving #1559.\n    return this.variableMap.getVariable(name, opt_type);\n  }\n\n  /**\n   * Find the variable by the given ID and return it. Return null if not found.\n   *\n   * @param id The ID to check for.\n   * @returns The variable with the given ID.\n   */\n  getVariableById(id: string): VariableModel | null {\n    return this.variableMap.getVariableById(id);\n  }\n\n  /**\n   * Find the variable with the specified type. If type is null, return list of\n   *     variables with empty string type.\n   *\n   * @param type Type of the variables to find.\n   * @returns The sought after variables of the passed in type. An empty array\n   *     if none are found.\n   */\n  getVariablesOfType(type: string | null): VariableModel[] {\n    return this.variableMap.getVariablesOfType(type);\n  }\n\n  /**\n   * Return all variable types.\n   *\n   * @returns List of variable types.\n   * @internal\n   */\n  getVariableTypes(): string[] {\n    return this.variableMap.getVariableTypes(this);\n  }\n\n  /**\n   * Return all variables of all types.\n   *\n   * @returns List of variable models.\n   */\n  getAllVariables(): VariableModel[] {\n    return this.variableMap.getAllVariables();\n  }\n\n  /**\n   * Returns all variable names of all types.\n   *\n   * @returns List of all variable names of all types.\n   */\n  getAllVariableNames(): string[] {\n    return this.variableMap.getAllVariableNames();\n  }\n  /* End functions that are just pass-throughs to the variable map. */\n  /**\n   * Returns the horizontal offset of the workspace.\n   * Intended for LTR/RTL compatibility in XML.\n   * Not relevant for a headless workspace.\n   *\n   * @returns Width.\n   */\n  getWidth(): number {\n    return 0;\n  }\n\n  /* eslint-disable jsdoc/require-returns-check */\n  /* eslint-disable @typescript-eslint/no-unused-vars */\n  /**\n   * Obtain a newly created block.\n   *\n   * @param prototypeName Name of the language object containing type-specific\n   *     functions for this block.\n   * @param opt_id Optional ID.  Use this ID if provided, otherwise create a new\n   *     ID.\n   * @returns The created block.\n   */\n  newBlock(prototypeName: string, opt_id?: string): Block {\n    throw new Error(\n      'The implementation of newBlock should be ' +\n        'monkey-patched in by blockly.ts',\n    );\n  }\n  /* eslint-enable */\n\n  /**\n   * The number of blocks that may be added to the workspace before reaching\n   *     the maxBlocks.\n   *\n   * @returns Number of blocks left.\n   */\n  remainingCapacity(): number {\n    if (isNaN(this.options.maxBlocks)) {\n      return Infinity;\n    }\n\n    return this.options.maxBlocks - this.getAllBlocks(false).length;\n  }\n\n  /**\n   * The number of blocks of the given type that may be added to the workspace\n   *    before reaching the maxInstances allowed for that type.\n   *\n   * @param type Type of block to return capacity for.\n   * @returns Number of blocks of type left.\n   */\n  remainingCapacityOfType(type: string): number {\n    if (!this.options.maxInstances) {\n      return Infinity;\n    }\n\n    const maxInstanceOfType =\n      this.options.maxInstances[type] !== undefined\n        ? this.options.maxInstances[type]\n        : Infinity;\n\n    return maxInstanceOfType - this.getBlocksByType(type, false).length;\n  }\n\n  /**\n   * Check if there is remaining capacity for blocks of the given counts to be\n   *    created. If the total number of blocks represented by the map is more\n   * than the total remaining capacity, it returns false. If a type count is\n   * more than the remaining capacity for that type, it returns false.\n   *\n   * @param typeCountsMap A map of types to counts (usually representing blocks\n   *     to be created).\n   * @returns True if there is capacity for the given map, false otherwise.\n   */\n  isCapacityAvailable(typeCountsMap: {[key: string]: number}): boolean {\n    if (!this.hasBlockLimits()) {\n      return true;\n    }\n    let copyableBlocksCount = 0;\n    for (const type in typeCountsMap) {\n      if (typeCountsMap[type] > this.remainingCapacityOfType(type)) {\n        return false;\n      }\n      copyableBlocksCount += typeCountsMap[type];\n    }\n    if (copyableBlocksCount > this.remainingCapacity()) {\n      return false;\n    }\n    return true;\n  }\n\n  /**\n   * Checks if the workspace has any limits on the maximum number of blocks,\n   *    or the maximum number of blocks of specific types.\n   *\n   * @returns True if it has block limits, false otherwise.\n   */\n  hasBlockLimits(): boolean {\n    return this.options.maxBlocks !== Infinity || !!this.options.maxInstances;\n  }\n\n  /**\n   * Gets the undo stack for workplace.\n   *\n   * @returns undo stack\n   * @internal\n   */\n  getUndoStack(): Abstract[] {\n    return this.undoStack_;\n  }\n\n  /**\n   * Gets the redo stack for workplace.\n   *\n   * @returns redo stack\n   * @internal\n   */\n  getRedoStack(): Abstract[] {\n    return this.redoStack_;\n  }\n\n  /**\n   * Undo or redo the previous action.\n   *\n   * @param redo False if undo, true if redo.\n   */\n  undo(redo: boolean) {\n    const inputStack = redo ? this.redoStack_ : this.undoStack_;\n    const outputStack = redo ? this.undoStack_ : this.redoStack_;\n    const inputEvent = inputStack.pop();\n    if (!inputEvent) {\n      return;\n    }\n    let events = [inputEvent];\n    // Do another undo/redo if the next one is of the same group.\n    while (\n      inputStack.length &&\n      inputEvent.group &&\n      inputEvent.group === inputStack[inputStack.length - 1].group\n    ) {\n      const event = inputStack.pop();\n      if (!event) continue;\n      events.push(event);\n    }\n    // Push these popped events on the opposite stack.\n    for (let i = 0; i < events.length; i++) {\n      const event = events[i];\n      outputStack.push(event);\n    }\n    events = eventUtils.filter(events, redo);\n    eventUtils.setRecordUndo(false);\n    try {\n      for (let i = 0; i < events.length; i++) {\n        const event = events[i];\n        event.run(redo);\n      }\n    } finally {\n      eventUtils.setRecordUndo(true);\n    }\n  }\n\n  /** Clear the undo/redo stacks. */\n  clearUndo() {\n    this.undoStack_.length = 0;\n    this.redoStack_.length = 0;\n    // Stop any events already in the firing queue from being undoable.\n    eventUtils.clearPendingUndo();\n  }\n\n  /**\n   * When something in this workspace changes, call a function.\n   * Note that there may be a few recent events already on the stack.  Thus the\n   * new change listener might be called with events that occurred a few\n   * milliseconds before the change listener was added.\n   *\n   * @param func Function to call.\n   * @returns Obsolete return value, ignore.\n   */\n  addChangeListener(func: (e: Abstract) => void): Function {\n    this.listeners.push(func);\n    return func;\n  }\n\n  /**\n   * Stop listening for this workspace's changes.\n   *\n   * @param func Function to stop calling.\n   */\n  removeChangeListener(func: Function) {\n    arrayUtils.removeElem(this.listeners, func);\n  }\n\n  /**\n   * Fire a change event.\n   *\n   * @param event Event to fire.\n   */\n  fireChangeListener(event: Abstract) {\n    if (event.recordUndo) {\n      this.undoStack_.push(event);\n      this.redoStack_.length = 0;\n      while (this.undoStack_.length > this.MAX_UNDO && this.MAX_UNDO >= 0) {\n        this.undoStack_.shift();\n      }\n    }\n    for (let i = 0; i < this.listeners.length; i++) {\n      const func = this.listeners[i];\n      func(event);\n    }\n  }\n\n  /**\n   * Find the block on this workspace with the specified ID.\n   *\n   * @param id ID of block to find.\n   * @returns The sought after block, or null if not found.\n   */\n  getBlockById(id: string): Block | null {\n    return this.blockDB.get(id) || null;\n  }\n\n  /**\n   * Set a block on this workspace with the specified ID.\n   *\n   * @param id ID of block to set.\n   * @param block The block to set.\n   * @internal\n   */\n  setBlockById(id: string, block: Block) {\n    this.blockDB.set(id, block);\n  }\n\n  /**\n   * Delete a block off this workspace with the specified ID.\n   *\n   * @param id ID of block to delete.\n   * @internal\n   */\n  removeBlockById(id: string) {\n    this.blockDB.delete(id);\n  }\n\n  /**\n   * Find the comment on this workspace with the specified ID.\n   *\n   * @param id ID of comment to find.\n   * @returns The sought after comment, or null if not found.\n   * @internal\n   */\n  getCommentById(id: string): WorkspaceComment | null {\n    return this.commentDB.get(id) ?? null;\n  }\n\n  /**\n   * Checks whether all value and statement inputs in the workspace are filled\n   * with blocks.\n   *\n   * @param opt_shadowBlocksAreFilled An optional argument controlling whether\n   *     shadow blocks are counted as filled. Defaults to true.\n   * @returns True if all inputs are filled, false otherwise.\n   */\n  allInputsFilled(opt_shadowBlocksAreFilled?: boolean): boolean {\n    const blocks = this.getTopBlocks(false);\n    for (let i = 0; i < blocks.length; i++) {\n      const block = blocks[i];\n      if (!block.allInputsFilled(opt_shadowBlocksAreFilled)) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  /**\n   * Return the variable map that contains \"potential\" variables.\n   * These exist in the flyout but not in the workspace.\n   *\n   * @returns The potential variable map.\n   * @internal\n   */\n  getPotentialVariableMap(): VariableMap | null {\n    return this.potentialVariableMap;\n  }\n\n  /**\n   * Create and store the potential variable map for this workspace.\n   *\n   * @internal\n   */\n  createPotentialVariableMap() {\n    this.potentialVariableMap = new VariableMap(this);\n  }\n\n  /**\n   * Return the map of all variables on the workspace.\n   *\n   * @returns The variable map.\n   */\n  getVariableMap(): VariableMap {\n    return this.variableMap;\n  }\n\n  /**\n   * Set the map of all variables on the workspace.\n   *\n   * @param variableMap The variable map.\n   * @internal\n   */\n  setVariableMap(variableMap: VariableMap) {\n    this.variableMap = variableMap;\n  }\n\n  /** Returns the map of all procedures on the workpace. */\n  getProcedureMap(): IProcedureMap {\n    return this.procedureMap;\n  }\n\n  /**\n   * Returns the root workspace of this workspace if the workspace has\n   * parent(s).\n   *\n   * E.g. workspaces in flyouts and mini workspace bubbles have parent\n   * workspaces.\n   */\n  getRootWorkspace(): Workspace | null {\n    let outerWs = null;\n    const parent = this.options.parentWorkspace;\n    // If we were in a flyout in a mutator, need to go up two levels to find\n    // the actual parent.\n    if (this.isFlyout) {\n      if (parent && parent.options) {\n        outerWs = parent.options.parentWorkspace;\n      }\n    } else if (parent) {\n      outerWs = parent;\n    }\n    return outerWs;\n  }\n\n  /**\n   * Find the workspace with the specified ID.\n   *\n   * @param id ID of workspace to find.\n   * @returns The sought after workspace or null if not found.\n   */\n  static getById(id: string): Workspace | null {\n    return common.getWorkspaceById(id);\n  }\n\n  /**\n   * Find all workspaces.\n   *\n   * @returns Array of workspaces.\n   */\n  static getAll(): Workspace[] {\n    return common.getAllWorkspaces();\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object in charge of loading, storing, and playing audio for a\n *     workspace.\n *\n * @class\n */\n// Former goog.module ID: Blockly.WorkspaceAudio\n\nimport * as userAgent from './utils/useragent.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Prevent a sound from playing if another sound preceded it within this many\n * milliseconds.\n */\nconst SOUND_LIMIT = 100;\n\n/**\n * Class for loading, storing, and playing audio for a workspace.\n */\nexport class WorkspaceAudio {\n  /** Database of pre-loaded sounds. */\n  private sounds = new Map<string, HTMLAudioElement>();\n\n  /** Time that the last sound was played. */\n  private lastSound_: Date | null = null;\n\n  /** Whether the audio is muted or not. */\n  private muted: boolean = false;\n\n  /**\n   * @param parentWorkspace The parent of the workspace this audio object\n   *     belongs to, or null.\n   */\n  constructor(private parentWorkspace: WorkspaceSvg) {}\n\n  /**\n   * Dispose of this audio manager.\n   *\n   * @internal\n   */\n  dispose() {\n    this.sounds.clear();\n  }\n\n  /**\n   * Load an audio file.  Cache it, ready for instantaneous playing.\n   *\n   * @param filenames List of file types in decreasing order of preference (i.e.\n   *     increasing size).  E.g. ['media/go.mp3', 'media/go.wav'] Filenames\n   *     include path from Blockly's root.  File extensions matter.\n   * @param name Name of sound.\n   */\n  load(filenames: string[], name: string) {\n    if (!filenames.length) {\n      return;\n    }\n    let audioTest;\n    try {\n      audioTest = new globalThis['Audio']();\n    } catch (e) {\n      // No browser support for Audio.\n      // IE can throw an error even if the Audio object exists.\n      return;\n    }\n    let sound;\n    for (let i = 0; i < filenames.length; i++) {\n      const filename = filenames[i];\n      const ext = filename.match(/\\.(\\w+)$/);\n      if (ext && audioTest.canPlayType('audio/' + ext[1])) {\n        // Found an audio format we can play.\n        sound = new globalThis['Audio'](filename);\n        break;\n      }\n    }\n    if (sound) {\n      this.sounds.set(name, sound);\n    }\n  }\n\n  /**\n   * Preload all the audio files so that they play quickly when asked for.\n   *\n   * @internal\n   */\n  preload() {\n    for (const sound of this.sounds.values()) {\n      sound.volume = 0.01;\n      const playPromise = sound.play();\n      // Edge does not return a promise, so we need to check.\n      if (playPromise !== undefined) {\n        // If we don't wait for the play request to complete before calling\n        // pause() we will get an exception: (DOMException: The play() request\n        // was interrupted) See more:\n        // https://developers.google.com/web/updates/2017/06/play-request-was-interrupted\n        playPromise.then(sound.pause).catch(\n          // Play without user interaction was prevented.\n          function () {},\n        );\n      } else {\n        sound.pause();\n      }\n\n      // iOS can only process one sound at a time.  Trying to load more than one\n      // corrupts the earlier ones.  Just load one and leave the others\n      // uncached.\n      if (userAgent.IPAD || userAgent.IPHONE) {\n        break;\n      }\n    }\n  }\n\n  /**\n   * Play a named sound at specified volume.  If volume is not specified,\n   * use full volume (1).\n   *\n   * @param name Name of sound.\n   * @param opt_volume Volume of sound (0-1).\n   */\n  play(name: string, opt_volume?: number) {\n    if (this.muted) {\n      return;\n    }\n    const sound = this.sounds.get(name);\n    if (sound) {\n      // Don't play one sound on top of another.\n      const now = new Date();\n      if (\n        this.lastSound_ !== null &&\n        now.getTime() - this.lastSound_.getTime() < SOUND_LIMIT\n      ) {\n        return;\n      }\n      this.lastSound_ = now;\n      let mySound;\n      if (userAgent.IPAD || userAgent.ANDROID) {\n        // Creating a new audio node causes lag in Android and iPad.  Android\n        // refetches the file from the server, iPad uses a singleton audio\n        // node which must be deleted and recreated for each new audio tag.\n        mySound = sound;\n      } else {\n        mySound = sound.cloneNode() as HTMLAudioElement;\n      }\n      mySound.volume = opt_volume === undefined ? 1 : opt_volume;\n      mySound.play();\n    } else if (this.parentWorkspace) {\n      // Maybe a workspace on a lower level knows about this sound.\n      this.parentWorkspace.getAudioManager().play(name, opt_volume);\n    }\n  }\n\n  /**\n   * @param muted If true, mute sounds. Otherwise, play them.\n   */\n  setMuted(muted: boolean) {\n    this.muted = muted;\n  }\n\n  /**\n   * @returns Whether the audio is currently muted or not.\n   */\n  getMuted(): boolean {\n    return this.muted;\n  }\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {WorkspaceSvg} from './workspace_svg.js';\nimport * as dom from './utils/dom.js';\nimport {Svg} from './utils/svg.js';\nimport {IRenderedElement} from './interfaces/i_rendered_element.js';\nimport * as layerNums from './layers.js';\nimport {Coordinate} from './utils/coordinate.js';\n\n/** @internal */\nexport class LayerManager {\n  /** The layer elements being dragged are appended to. */\n  private dragLayer: SVGGElement | undefined;\n  /** The layers elements not being dragged are appended to.  */\n  private layers = new Map<number, SVGGElement>();\n\n  /** @internal */\n  constructor(private workspace: WorkspaceSvg) {\n    const injectionDiv = workspace.getInjectionDiv();\n    // `getInjectionDiv` is actually nullable. We hit this if the workspace\n    // is part of a flyout and the workspace the flyout is attached to hasn't\n    // been appended yet.\n    if (injectionDiv) {\n      this.dragLayer = this.createDragLayer(injectionDiv);\n    }\n\n    // We construct these manually so we can add the css class for backwards\n    // compatibility.\n    const blockLayer = this.createLayer(layerNums.BLOCK);\n    dom.addClass(blockLayer, 'blocklyBlockCanvas');\n    const bubbleLayer = this.createLayer(layerNums.BUBBLE);\n    dom.addClass(bubbleLayer, 'blocklyBubbleCanvas');\n  }\n\n  private createDragLayer(injectionDiv: Element) {\n    const svg = dom.createSvgElement(Svg.SVG, {\n      'class': 'blocklyBlockDragSurface',\n      'xmlns': dom.SVG_NS,\n      'xmlns:html': dom.HTML_NS,\n      'xmlns:xlink': dom.XLINK_NS,\n      'version': '1.1',\n    });\n    injectionDiv.append(svg);\n    return dom.createSvgElement(Svg.G, {}, svg);\n  }\n\n  /**\n   * Translates layers when the workspace is dragged or zoomed.\n   *\n   * @internal\n   */\n  translateLayers(newCoord: Coordinate, newScale: number) {\n    const translation = `translate(${newCoord.x}, ${newCoord.y}) scale(${newScale})`;\n    this.dragLayer?.setAttribute('transform', translation);\n    for (const [_, layer] of this.layers) {\n      layer.setAttribute('transform', translation);\n    }\n  }\n\n  /**\n   * Moves the given element to the drag layer, which exists on top of all other\n   * layers, and the drag surface.\n   *\n   * @internal\n   */\n  moveToDragLayer(elem: IRenderedElement) {\n    this.dragLayer?.appendChild(elem.getSvgRoot());\n  }\n\n  /**\n   * Moves the given element off of the drag layer.\n   *\n   * @internal\n   */\n  moveOffDragLayer(elem: IRenderedElement, layerNum: number) {\n    this.append(elem, layerNum);\n  }\n\n  /**\n   * Appends the given element to a layer. If the layer does not exist, it is\n   * created.\n   *\n   * @internal\n   */\n  append(elem: IRenderedElement, layerNum: number) {\n    if (!this.layers.has(layerNum)) {\n      this.createLayer(layerNum);\n    }\n    this.layers.get(layerNum)?.appendChild(elem.getSvgRoot());\n  }\n\n  /**\n   * Creates a layer and inserts it at the proper place given the layer number.\n   *\n   * More positive layers exist later in the dom and are rendered ontop of\n   * less positive layers. Layers are added to the layer map as a side effect.\n   */\n  private createLayer(layerNum: number): SVGGElement {\n    const parent = this.workspace.getSvgGroup();\n    const layer = dom.createSvgElement(Svg.G, {});\n\n    let inserted = false;\n    const sortedLayers = [...this.layers].sort((a, b) => a[0] - b[0]);\n    for (const [num, sib] of sortedLayers) {\n      if (layerNum < num) {\n        parent.insertBefore(layer, sib);\n        inserted = true;\n        break;\n      }\n    }\n    if (!inserted) {\n      parent.appendChild(layer);\n    }\n    this.layers.set(layerNum, layer);\n    return layer;\n  }\n\n  /**\n   * Returns true if the given element is a layer managed by the layer manager.\n   * False otherwise.\n   *\n   * @internal\n   */\n  hasLayer(elem: SVGElement) {\n    return (\n      elem === this.dragLayer ||\n      new Set(this.layers.values()).has(elem as SVGGElement)\n    );\n  }\n\n  /**\n   * We need to be able to access this layer explicitly for backwards\n   * compatibility.\n   *\n   * @internal\n   */\n  getBlockLayer(): SVGGElement {\n    return this.layers.get(layerNums.BLOCK)!;\n  }\n\n  /**\n   * We need to be able to access this layer explicitly for backwards\n   * compatibility.\n   *\n   * @internal\n   */\n  getBubbleLayer(): SVGGElement {\n    return this.layers.get(layerNums.BUBBLE)!;\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Events fired as a result of trashcan flyout open and close.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.TrashcanOpen\n\nimport * as registry from '../registry.js';\nimport {AbstractEventJson} from './events_abstract.js';\n\nimport {UiBase} from './events_ui_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners when the trashcan is opening or closing.\n */\nexport class TrashcanOpen extends UiBase {\n  /**\n   * True if the trashcan is currently opening (previously closed).\n   * False if it is currently closing (previously open).\n   */\n  isOpen?: boolean;\n  override type = eventUtils.TRASHCAN_OPEN;\n\n  /**\n   * @param opt_isOpen Whether the trashcan flyout is opening (false if\n   *     opening). Undefined for a blank event.\n   * @param opt_workspaceId The workspace identifier for this event.\n   *    Undefined for a blank event.\n   */\n  constructor(opt_isOpen?: boolean, opt_workspaceId?: string) {\n    super(opt_workspaceId);\n    this.isOpen = opt_isOpen;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): TrashcanOpenJson {\n    const json = super.toJson() as TrashcanOpenJson;\n    if (this.isOpen === undefined) {\n      throw new Error(\n        'Whether this is already open or not is undefined. Either pass ' +\n          'a value to the constructor, or call fromJson',\n      );\n    }\n    json['isOpen'] = this.isOpen;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of TrashcanOpen, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: TrashcanOpenJson,\n    workspace: Workspace,\n    event?: any,\n  ): TrashcanOpen {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new TrashcanOpen(),\n    ) as TrashcanOpen;\n    newEvent.isOpen = json['isOpen'];\n    return newEvent;\n  }\n}\n\nexport interface TrashcanOpenJson extends AbstractEventJson {\n  isOpen: boolean;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.TRASHCAN_OPEN, TrashcanOpen);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for a block delete event.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.BlockDelete\n\nimport type {Block} from '../block.js';\nimport * as registry from '../registry.js';\nimport * as blocks from '../serialization/blocks.js';\nimport * as utilsXml from '../utils/xml.js';\nimport * as Xml from '../xml.js';\n\nimport {BlockBase, BlockBaseJson} from './events_block_base.js';\nimport * as eventUtils from './utils.js';\nimport {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners when a block (or connected stack of blocks) is\n * deleted.\n */\nexport class BlockDelete extends BlockBase {\n  /** The XML representation of the deleted block(s). */\n  oldXml?: Element | DocumentFragment;\n\n  /** The JSON respresentation of the deleted block(s). */\n  oldJson?: blocks.State;\n\n  /** All of the IDs of deleted blocks. */\n  ids?: string[];\n\n  /** True if the deleted block was a shadow block, false otherwise. */\n  wasShadow?: boolean;\n\n  override type = eventUtils.BLOCK_DELETE;\n\n  /** @param opt_block The deleted block.  Undefined for a blank event. */\n  constructor(opt_block?: Block) {\n    super(opt_block);\n\n    if (!opt_block) {\n      return; // Blank event to be populated by fromJson.\n    }\n\n    if (opt_block.getParent()) {\n      throw Error('Connected blocks cannot be deleted.');\n    }\n    if (opt_block.isShadow()) {\n      // Respawning shadow blocks is handled via disconnection.\n      this.recordUndo = false;\n    }\n\n    this.oldXml = Xml.blockToDomWithXY(opt_block);\n    this.ids = eventUtils.getDescendantIds(opt_block);\n    this.wasShadow = opt_block.isShadow();\n    this.oldJson = blocks.save(opt_block, {\n      addCoordinates: true,\n    }) as blocks.State;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): BlockDeleteJson {\n    const json = super.toJson() as BlockDeleteJson;\n    if (!this.oldXml) {\n      throw new Error(\n        'The old block XML is undefined. Either pass a block ' +\n          'to the constructor, or call fromJson',\n      );\n    }\n    if (!this.ids) {\n      throw new Error(\n        'The block IDs are undefined. Either pass a block to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (this.wasShadow === undefined) {\n      throw new Error(\n        'Whether the block was a shadow is undefined. Either ' +\n          'pass a block to the constructor, or call fromJson',\n      );\n    }\n    if (!this.oldJson) {\n      throw new Error(\n        'The old block JSON is undefined. Either pass a block ' +\n          'to the constructor, or call fromJson',\n      );\n    }\n    json['oldXml'] = Xml.domToText(this.oldXml);\n    json['ids'] = this.ids;\n    json['wasShadow'] = this.wasShadow;\n    json['oldJson'] = this.oldJson;\n    if (!this.recordUndo) {\n      json['recordUndo'] = this.recordUndo;\n    }\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of BlockDelete, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: BlockDeleteJson,\n    workspace: Workspace,\n    event?: any,\n  ): BlockDelete {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new BlockDelete(),\n    ) as BlockDelete;\n    newEvent.oldXml = utilsXml.textToDom(json['oldXml']);\n    newEvent.ids = json['ids'];\n    newEvent.wasShadow =\n      json['wasShadow'] || newEvent.oldXml.tagName.toLowerCase() === 'shadow';\n    newEvent.oldJson = json['oldJson'];\n    if (json['recordUndo'] !== undefined) {\n      newEvent.recordUndo = json['recordUndo'];\n    }\n    return newEvent;\n  }\n\n  /**\n   * Run a deletion event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    if (!this.ids) {\n      throw new Error(\n        'The block IDs are undefined. Either pass a block to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (!this.oldJson) {\n      throw new Error(\n        'The old block JSON is undefined. Either pass a block ' +\n          'to the constructor, or call fromJson',\n      );\n    }\n    if (forward) {\n      for (let i = 0; i < this.ids.length; i++) {\n        const id = this.ids[i];\n        const block = workspace.getBlockById(id);\n        if (block) {\n          block.dispose(false);\n        } else if (id === this.blockId) {\n          // Only complain about root-level block.\n          console.warn(\"Can't delete non-existent block: \" + id);\n        }\n      }\n    } else {\n      blocks.append(this.oldJson, workspace);\n    }\n  }\n}\n\nexport interface BlockDeleteJson extends BlockBaseJson {\n  oldXml: string;\n  ids: string[];\n  wasShadow: boolean;\n  oldJson: blocks.State;\n  recordUndo?: boolean;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.DELETE, BlockDelete);\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The class representing one block.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Block\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_change.js';\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_create.js';\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_delete.js';\n\nimport {Blocks} from './blocks.js';\nimport * as common from './common.js';\nimport {Connection} from './connection.js';\nimport {ConnectionType} from './connection_type.js';\nimport * as constants from './constants.js';\nimport {DuplicateIconType} from './icons/exceptions.js';\nimport type {Abstract} from './events/events_abstract.js';\nimport type {BlockMove} from './events/events_block_move.js';\nimport * as eventUtils from './events/utils.js';\nimport * as Extensions from './extensions.js';\nimport type {Field} from './field.js';\nimport * as fieldRegistry from './field_registry.js';\nimport {Input} from './inputs/input.js';\nimport {Align} from './inputs/align.js';\nimport type {IASTNodeLocation} from './interfaces/i_ast_node_location.js';\nimport type {IDeletable} from './interfaces/i_deletable.js';\nimport type {IIcon} from './interfaces/i_icon.js';\nimport {CommentIcon} from './icons/comment_icon.js';\nimport type {MutatorIcon} from './icons/mutator_icon.js';\nimport * as Tooltip from './tooltip.js';\nimport * as arrayUtils from './utils/array.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as idGenerator from './utils/idgenerator.js';\nimport * as parsing from './utils/parsing.js';\nimport * as registry from './registry.js';\nimport {Size} from './utils/size.js';\nimport type {VariableModel} from './variable_model.js';\nimport type {Workspace} from './workspace.js';\nimport {DummyInput} from './inputs/dummy_input.js';\nimport {EndRowInput} from './inputs/end_row_input.js';\nimport {ValueInput} from './inputs/value_input.js';\nimport {StatementInput} from './inputs/statement_input.js';\nimport {IconType} from './icons/icon_types.js';\n\n/**\n * Class for one block.\n * Not normally called directly, workspace.newBlock() is preferred.\n */\nexport class Block implements IASTNodeLocation, IDeletable {\n  /**\n   * An optional callback method to use whenever the block's parent workspace\n   * changes. This is usually only called from the constructor, the block type\n   * initializer function, or an extension initializer function.\n   */\n  onchange?: ((p1: Abstract) => void) | null;\n\n  /** The language-neutral ID given to the collapsed input. */\n  static readonly COLLAPSED_INPUT_NAME: string = constants.COLLAPSED_INPUT_NAME;\n\n  /** The language-neutral ID given to the collapsed field. */\n  static readonly COLLAPSED_FIELD_NAME: string = constants.COLLAPSED_FIELD_NAME;\n\n  /**\n   * Optional text data that round-trips between blocks and XML.\n   * Has no effect. May be used by 3rd parties for meta information.\n   */\n  data: string | null = null;\n\n  /**\n   * Has this block been disposed of?\n   *\n   * @internal\n   */\n  disposed = false;\n\n  /**\n   * Colour of the block as HSV hue value (0-360)\n   * This may be null if the block colour was not set via a hue number.\n   */\n  private hue_: number | null = null;\n\n  /** Colour of the block in '#RRGGBB' format. */\n  protected colour_ = '#000000';\n\n  /** Name of the block style. */\n  protected styleName_ = '';\n\n  /** An optional method called during initialization. */\n  init?: () => void;\n\n  /** An optional method called during disposal. */\n  destroy?: () => void;\n\n  /**\n   * An optional serialization method for defining how to serialize the\n   * mutation state to XML. This must be coupled with defining\n   * `domToMutation`.\n   */\n  mutationToDom?: (...p1: AnyDuringMigration[]) => Element;\n\n  /**\n   * An optional deserialization method for defining how to deserialize the\n   * mutation state from XML. This must be coupled with defining\n   * `mutationToDom`.\n   */\n  domToMutation?: (p1: Element) => void;\n\n  /**\n   * An optional serialization method for defining how to serialize the\n   * block's extra state (eg mutation state) to something JSON compatible.\n   * This must be coupled with defining `loadExtraState`.\n   *\n   * @param doFullSerialization Whether or not to serialize the full state of\n   *     the extra state (rather than possibly saving a reference to some\n   *     state). This is used during copy-paste. See the\n   *     {@link https://developers.devsite.google.com/blockly/guides/create-custom-blocks/extensions#full_serialization_and_backing_data | block serialization docs}\n   *     for more information.\n   */\n  saveExtraState?: (doFullSerialization?: boolean) => AnyDuringMigration;\n\n  /**\n   * An optional serialization method for defining how to deserialize the\n   * block's extra state (eg mutation state) from something JSON compatible.\n   * This must be coupled with defining `saveExtraState`.\n   */\n  loadExtraState?: (p1: AnyDuringMigration) => void;\n\n  /**\n   * An optional property for suppressing adding STATEMENT_PREFIX and\n   * STATEMENT_SUFFIX to generated code.\n   */\n  suppressPrefixSuffix: boolean | null = false;\n\n  /**\n   * An optional property for declaring developer variables.  Return a list of\n   * variable names for use by generators.  Developer variables are never\n   * shown to the user, but are declared as global variables in the generated\n   * code.\n   */\n  getDeveloperVariables?: () => string[];\n\n  /**\n   * An optional function that reconfigures the block based on the contents of\n   * the mutator dialog.\n   */\n  compose?: (p1: Block) => void;\n\n  /**\n   * An optional function that populates the mutator's dialog with\n   * this block's components.\n   */\n  decompose?: (p1: Workspace) => Block;\n  id: string;\n  outputConnection: Connection | null = null;\n  nextConnection: Connection | null = null;\n  previousConnection: Connection | null = null;\n  inputList: Input[] = [];\n  inputsInline?: boolean;\n  icons: IIcon[] = [];\n  private disabled = false;\n  tooltip: Tooltip.TipInfo = '';\n  contextMenu = true;\n\n  protected parentBlock_: this | null = null;\n\n  protected childBlocks_: this[] = [];\n\n  private deletable_ = true;\n\n  private movable_ = true;\n\n  private editable_ = true;\n\n  private isShadow_ = false;\n\n  protected collapsed_ = false;\n  protected outputShape_: number | null = null;\n\n  /**\n   * Is the current block currently in the process of being disposed?\n   */\n  private disposing = false;\n\n  private readonly xy_: Coordinate;\n  isInFlyout: boolean;\n  isInMutator: boolean;\n  RTL: boolean;\n\n  /** True if this block is an insertion marker. */\n  protected isInsertionMarker_ = false;\n\n  /** Name of the type of hat. */\n  hat?: string;\n\n  rendered: boolean | null = null;\n\n  /**\n   * String for block help, or function that returns a URL. Null for no help.\n   */\n  helpUrl: string | Function | null = null;\n\n  /** A bound callback function to use when the parent workspace changes. */\n  private onchangeWrapper_: ((p1: Abstract) => void) | null = null;\n\n  /**\n   * A count of statement inputs on the block.\n   *\n   * @internal\n   */\n  statementInputCount = 0;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  type!: string;\n  // Record initial inline state.\n  inputsInlineDefault?: boolean;\n  workspace: Workspace;\n\n  /**\n   * @param workspace The block's workspace.\n   * @param prototypeName Name of the language object containing type-specific\n   *     functions for this block.\n   * @param opt_id Optional ID.  Use this ID if provided, otherwise create a new\n   *     ID.\n   * @throws When the prototypeName is not valid or not allowed.\n   */\n  constructor(workspace: Workspace, prototypeName: string, opt_id?: string) {\n    this.workspace = workspace;\n\n    this.id =\n      opt_id && !workspace.getBlockById(opt_id) ? opt_id : idGenerator.genUid();\n    workspace.setBlockById(this.id, this);\n\n    /**\n     * The block's position in workspace units.  (0, 0) is at the workspace's\n     * origin; scale does not change this value.\n     */\n    this.xy_ = new Coordinate(0, 0);\n    this.isInFlyout = workspace.isFlyout;\n    this.isInMutator = workspace.isMutator;\n\n    this.RTL = workspace.RTL;\n\n    // Copy the type-specific functions and data from the prototype.\n    if (prototypeName) {\n      this.type = prototypeName;\n      const prototype = Blocks[prototypeName];\n      if (!prototype || typeof prototype !== 'object') {\n        throw TypeError('Invalid block definition for type: ' + prototypeName);\n      }\n      Object.assign(this, prototype);\n    }\n\n    workspace.addTopBlock(this);\n    workspace.addTypedBlock(this);\n\n    if (new.target === Block) {\n      this.doInit_();\n    }\n  }\n\n  /** Calls the init() function and handles associated event firing, etc. */\n  protected doInit_() {\n    // All events fired should be part of the same group.\n    // Any events fired during init should not be undoable,\n    // so that block creation is atomic.\n    const existingGroup = eventUtils.getGroup();\n    if (!existingGroup) {\n      eventUtils.setGroup(true);\n    }\n    const initialUndoFlag = eventUtils.getRecordUndo();\n\n    try {\n      // Call an initialization function, if it exists.\n      if (typeof this.init === 'function') {\n        eventUtils.setRecordUndo(false);\n        this.init();\n        eventUtils.setRecordUndo(initialUndoFlag);\n      }\n\n      // Fire a create event.\n      if (eventUtils.isEnabled()) {\n        eventUtils.fire(new (eventUtils.get(eventUtils.BLOCK_CREATE))(this));\n      }\n    } finally {\n      eventUtils.setGroup(existingGroup);\n      // In case init threw, recordUndo flag should still be reset.\n      eventUtils.setRecordUndo(initialUndoFlag);\n    }\n    this.inputsInlineDefault = this.inputsInline;\n\n    // Bind an onchange function, if it exists.\n    if (typeof this.onchange === 'function') {\n      this.setOnChange(this.onchange);\n    }\n  }\n\n  /**\n   * Dispose of this block.\n   *\n   * @param healStack If true, then try to heal any gap by connecting the next\n   *     statement with the previous statement.  Otherwise, dispose of all\n   *     children of this block.\n   */\n  dispose(healStack: boolean) {\n    if (this.isDeadOrDying()) return;\n\n    // Dispose of this change listener before unplugging.\n    // Technically not necessary due to the event firing delay.\n    // But future-proofing.\n    if (this.onchangeWrapper_) {\n      this.workspace.removeChangeListener(this.onchangeWrapper_);\n    }\n\n    this.unplug(healStack);\n    if (eventUtils.isEnabled()) {\n      // Constructing the delete event is costly. Only perform if necessary.\n      eventUtils.fire(new (eventUtils.get(eventUtils.BLOCK_DELETE))(this));\n    }\n    this.workspace.removeTopBlock(this);\n    this.disposeInternal();\n  }\n\n  /**\n   * Disposes of this block without doing things required by the top block.\n   * E.g. does not fire events, unplug the block, etc.\n   */\n  protected disposeInternal() {\n    if (this.isDeadOrDying()) return;\n\n    if (this.onchangeWrapper_) {\n      this.workspace.removeChangeListener(this.onchangeWrapper_);\n    }\n\n    this.workspace.removeTypedBlock(this);\n    this.workspace.removeBlockById(this.id);\n    this.disposing = true;\n\n    if (typeof this.destroy === 'function') this.destroy();\n\n    this.childBlocks_.forEach((c) => c.disposeInternal());\n    this.inputList.forEach((i) => i.dispose());\n    this.inputList.length = 0;\n    this.getConnections_(true).forEach((c) => c.dispose());\n    this.disposed = true;\n  }\n\n  /**\n   * Returns true if the block is either in the process of being disposed, or\n   * is disposed.\n   *\n   * @internal\n   */\n  isDeadOrDying(): boolean {\n    return this.disposing || this.disposed;\n  }\n\n  /**\n   * Call initModel on all fields on the block.\n   * May be called more than once.\n   * Either initModel or initSvg must be called after creating a block and\n   * before the first interaction with it.  Interactions include UI actions\n   * (e.g. clicking and dragging) and firing events (e.g. create, delete, and\n   * change).\n   */\n  initModel() {\n    for (const input of this.inputList) {\n      for (const field of input.fieldRow) {\n        if (field.initModel) {\n          field.initModel();\n        }\n      }\n    }\n  }\n\n  /**\n   * Unplug this block from its superior block.  If this block is a statement,\n   * optionally reconnect the block underneath with the block on top.\n   *\n   * @param opt_healStack Disconnect child statement and reconnect stack.\n   *     Defaults to false.\n   */\n  unplug(opt_healStack?: boolean) {\n    if (this.outputConnection) {\n      this.unplugFromRow_(opt_healStack);\n    }\n    if (this.previousConnection) {\n      this.unplugFromStack_(opt_healStack);\n    }\n  }\n\n  /**\n   * Unplug this block's output from an input on another block.  Optionally\n   * reconnect the block's parent to the only child block, if possible.\n   *\n   * @param opt_healStack Disconnect right-side block and connect to left-side\n   *     block.  Defaults to false.\n   */\n  private unplugFromRow_(opt_healStack?: boolean) {\n    let parentConnection = null;\n    if (this.outputConnection?.isConnected()) {\n      parentConnection = this.outputConnection.targetConnection;\n      // Disconnect from any superior block.\n      this.outputConnection.disconnect();\n    }\n\n    // Return early in obvious cases.\n    if (!parentConnection || !opt_healStack) {\n      return;\n    }\n\n    const thisConnection = this.getOnlyValueConnection_();\n    if (\n      !thisConnection ||\n      !thisConnection.isConnected() ||\n      thisConnection.targetBlock()!.isShadow()\n    ) {\n      // Too many or too few possible connections on this block, or there's\n      // nothing on the other side of this connection.\n      return;\n    }\n\n    const childConnection = thisConnection.targetConnection;\n    // Disconnect the child block.\n    childConnection?.disconnect();\n    // Connect child to the parent if possible, otherwise bump away.\n    if (\n      this.workspace.connectionChecker.canConnect(\n        childConnection,\n        parentConnection,\n        false,\n      )\n    ) {\n      parentConnection.connect(childConnection!);\n    } else {\n      childConnection?.onFailedConnect(parentConnection);\n    }\n  }\n\n  /**\n   * Returns the connection on the value input that is connected to another\n   * block. When an insertion marker is connected to a connection with a block\n   * already attached, the connected block is attached to the insertion marker.\n   * Since only one block can be displaced and attached to the insertion marker\n   * this should only ever return one connection.\n   *\n   * @returns The connection on the value input, or null.\n   */\n  private getOnlyValueConnection_(): Connection | null {\n    let connection = null;\n    for (let i = 0; i < this.inputList.length; i++) {\n      const thisConnection = this.inputList[i].connection;\n      if (\n        thisConnection &&\n        thisConnection.type === ConnectionType.INPUT_VALUE &&\n        thisConnection.targetConnection\n      ) {\n        if (connection) {\n          return null; // More than one value input found.\n        }\n        connection = thisConnection;\n      }\n    }\n    return connection;\n  }\n\n  /**\n   * Unplug this statement block from its superior block.  Optionally reconnect\n   * the block underneath with the block on top.\n   *\n   * @param opt_healStack Disconnect child statement and reconnect stack.\n   *     Defaults to false.\n   */\n  private unplugFromStack_(opt_healStack?: boolean) {\n    let previousTarget = null;\n    if (this.previousConnection?.isConnected()) {\n      // Remember the connection that any next statements need to connect to.\n      previousTarget = this.previousConnection.targetConnection;\n      // Detach this block from the parent's tree.\n      this.previousConnection.disconnect();\n    }\n    const nextBlock = this.getNextBlock();\n    if (opt_healStack && nextBlock && !nextBlock.isShadow()) {\n      // Disconnect the next statement.\n      const nextTarget = this.nextConnection?.targetConnection ?? null;\n      nextTarget?.disconnect();\n      if (\n        previousTarget &&\n        this.workspace.connectionChecker.canConnect(\n          previousTarget,\n          nextTarget,\n          false,\n        )\n      ) {\n        // Attach the next statement to the previous statement.\n        previousTarget.connect(nextTarget!);\n      }\n    }\n  }\n\n  /**\n   * Returns all connections originating from this block.\n   *\n   * @param _all If true, return all connections even hidden ones.\n   * @returns Array of connections.\n   * @internal\n   */\n  getConnections_(_all: boolean): Connection[] {\n    const myConnections = [];\n    if (this.outputConnection) {\n      myConnections.push(this.outputConnection);\n    }\n    if (this.previousConnection) {\n      myConnections.push(this.previousConnection);\n    }\n    if (this.nextConnection) {\n      myConnections.push(this.nextConnection);\n    }\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      if (input.connection) {\n        myConnections.push(input.connection);\n      }\n    }\n    return myConnections;\n  }\n\n  /**\n   * Walks down a stack of blocks and finds the last next connection on the\n   * stack.\n   *\n   * @param ignoreShadows If true,the last connection on a non-shadow block will\n   *     be returned. If false, this will follow shadows to find the last\n   *     connection.\n   * @returns The last next connection on the stack, or null.\n   * @internal\n   */\n  lastConnectionInStack(ignoreShadows: boolean): Connection | null {\n    let nextConnection = this.nextConnection;\n    while (nextConnection) {\n      const nextBlock = nextConnection.targetBlock();\n      if (!nextBlock || (ignoreShadows && nextBlock.isShadow())) {\n        return nextConnection;\n      }\n      nextConnection = nextBlock.nextConnection;\n    }\n    return null;\n  }\n\n  /**\n   * Bump unconnected blocks out of alignment.  Two blocks which aren't actually\n   * connected should not coincidentally line up on screen.\n   */\n  bumpNeighbours() {}\n  // noop.\n\n  /**\n   * Return the parent block or null if this block is at the top level. The\n   * parent block is either the block connected to the previous connection (for\n   * a statement block) or the block connected to the output connection (for a\n   * value block).\n   *\n   * @returns The block (if any) that holds the current block.\n   */\n  getParent(): this | null {\n    return this.parentBlock_;\n  }\n\n  /**\n   * Return the input that connects to the specified block.\n   *\n   * @param block A block connected to an input on this block.\n   * @returns The input (if any) that connects to the specified block.\n   */\n  getInputWithBlock(block: Block): Input | null {\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      if (input.connection && input.connection.targetBlock() === block) {\n        return input;\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Return the parent block that surrounds the current block, or null if this\n   * block has no surrounding block.  A parent block might just be the previous\n   * statement, whereas the surrounding block is an if statement, while loop,\n   * etc.\n   *\n   * @returns The block (if any) that surrounds the current block.\n   */\n  getSurroundParent(): this | null {\n    /* eslint-disable-next-line @typescript-eslint/no-this-alias */\n    let block: this | null = this;\n    let prevBlock;\n    do {\n      prevBlock = block;\n      block = block.getParent();\n      if (!block) {\n        // Ran off the top.\n        return null;\n      }\n    } while (block.getNextBlock() === prevBlock);\n    // This block is an enclosing parent, not just a statement in a stack.\n    return block;\n  }\n\n  /**\n   * Return the next statement block directly connected to this block.\n   *\n   * @returns The next statement block or null.\n   */\n  getNextBlock(): Block | null {\n    return this.nextConnection && this.nextConnection.targetBlock();\n  }\n\n  /**\n   * Returns the block connected to the previous connection.\n   *\n   * @returns The previous statement block or null.\n   */\n  getPreviousBlock(): Block | null {\n    return this.previousConnection && this.previousConnection.targetBlock();\n  }\n\n  /**\n   * Return the top-most block in this block's tree.\n   * This will return itself if this block is at the top level.\n   *\n   * @returns The root block.\n   */\n  getRootBlock(): this {\n    let rootBlock: this;\n    /* eslint-disable-next-line @typescript-eslint/no-this-alias */\n    let block: this | null = this;\n    do {\n      rootBlock = block;\n      block = rootBlock.parentBlock_;\n    } while (block);\n    return rootBlock;\n  }\n\n  /**\n   * Walk up from the given block up through the stack of blocks to find\n   * the top block of the sub stack. If we are nested in a statement input only\n   * find the top-most nested block. Do not go all the way to the root block.\n   *\n   * @returns The top block in a stack.\n   * @internal\n   */\n  getTopStackBlock(): this {\n    /* eslint-disable-next-line @typescript-eslint/no-this-alias */\n    let block = this;\n    let previous;\n    do {\n      previous = block.getPreviousBlock();\n      // AnyDuringMigration because:  Type 'Block' is not assignable to type\n      // 'this'.\n    } while (\n      previous &&\n      previous.getNextBlock() === block &&\n      (block = previous as AnyDuringMigration)\n    );\n    return block;\n  }\n\n  /**\n   * Find all the blocks that are directly nested inside this one.\n   * Includes value and statement inputs, as well as any following statement.\n   * Excludes any connection on an output tab or any preceding statement.\n   * Blocks are optionally sorted by position; top to bottom.\n   *\n   * @param ordered Sort the list if true.\n   * @returns Array of blocks.\n   */\n  getChildren(ordered: boolean): Block[] {\n    if (!ordered) {\n      return this.childBlocks_;\n    }\n    const blocks = [];\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      if (input.connection) {\n        const child = input.connection.targetBlock();\n        if (child) {\n          blocks.push(child);\n        }\n      }\n    }\n    const next = this.getNextBlock();\n    if (next) {\n      blocks.push(next);\n    }\n    return blocks;\n  }\n\n  /**\n   * Set parent of this block to be a new block or null.\n   *\n   * @param newParent New parent block.\n   * @internal\n   */\n  setParent(newParent: this | null) {\n    if (newParent === this.parentBlock_) {\n      return;\n    }\n\n    // Check that block is connected to new parent if new parent is not null and\n    //    that block is not connected to superior one if new parent is null.\n    const targetBlock =\n      (this.previousConnection && this.previousConnection.targetBlock()) ||\n      (this.outputConnection && this.outputConnection.targetBlock());\n    const isConnected = !!targetBlock;\n\n    if (isConnected && newParent && targetBlock !== newParent) {\n      throw Error('Block connected to superior one that is not new parent.');\n    } else if (!isConnected && newParent) {\n      throw Error('Block not connected to new parent.');\n    } else if (isConnected && !newParent) {\n      throw Error(\n        'Cannot set parent to null while block is still connected to' +\n          ' superior block.',\n      );\n    }\n\n    // This block hasn't actually moved on-screen, so there's no need to\n    // update\n    //     its connection locations.\n    if (this.parentBlock_) {\n      // Remove this block from the old parent's child list.\n      arrayUtils.removeElem(this.parentBlock_.childBlocks_, this);\n    } else {\n      // New parent must be non-null so remove this block from the workspace's\n      //     list of top-most blocks.\n      this.workspace.removeTopBlock(this);\n    }\n\n    this.parentBlock_ = newParent;\n    if (newParent) {\n      // Add this block to the new parent's child list.\n      newParent.childBlocks_.push(this);\n    } else {\n      this.workspace.addTopBlock(this);\n    }\n  }\n\n  /**\n   * Find all the blocks that are directly or indirectly nested inside this one.\n   * Includes this block in the list.\n   * Includes value and statement inputs, as well as any following statements.\n   * Excludes any connection on an output tab or any preceding statements.\n   * Blocks are optionally sorted by position; top to bottom.\n   *\n   * @param ordered Sort the list if true.\n   * @returns Flattened array of blocks.\n   */\n  getDescendants(ordered: boolean): this[] {\n    const blocks = [this];\n    const childBlocks = this.getChildren(ordered);\n    for (let child, i = 0; (child = childBlocks[i]); i++) {\n      // AnyDuringMigration because:  Argument of type 'Block[]' is not\n      // assignable to parameter of type 'this[]'.\n      blocks.push(...(child.getDescendants(ordered) as AnyDuringMigration));\n    }\n    return blocks;\n  }\n\n  /**\n   * Get whether this block is deletable or not.\n   *\n   * @returns True if deletable.\n   */\n  isDeletable(): boolean {\n    return (\n      this.deletable_ &&\n      !this.isShadow_ &&\n      !this.isDeadOrDying() &&\n      !this.workspace.options.readOnly\n    );\n  }\n\n  /**\n   * Return whether this block's own deletable property is true or false.\n   *\n   * @returns True if the block's deletable property is true, false otherwise.\n   */\n  isOwnDeletable(): boolean {\n    return this.deletable_;\n  }\n\n  /**\n   * Set whether this block is deletable or not.\n   *\n   * @param deletable True if deletable.\n   */\n  setDeletable(deletable: boolean) {\n    this.deletable_ = deletable;\n  }\n\n  /**\n   * Get whether this block is movable or not.\n   *\n   * @returns True if movable.\n   * @internal\n   */\n  isMovable(): boolean {\n    return (\n      this.movable_ &&\n      !this.isShadow_ &&\n      !this.isDeadOrDying() &&\n      !this.workspace.options.readOnly\n    );\n  }\n\n  /**\n   * Return whether this block's own movable property is true or false.\n   *\n   * @returns True if the block's movable property is true, false otherwise.\n   * @internal\n   */\n  isOwnMovable(): boolean {\n    return this.movable_;\n  }\n\n  /**\n   * Set whether this block is movable or not.\n   *\n   * @param movable True if movable.\n   */\n  setMovable(movable: boolean) {\n    this.movable_ = movable;\n  }\n\n  /**\n   * Get whether is block is duplicatable or not. If duplicating this block and\n   * descendants will put this block over the workspace's capacity this block is\n   * not duplicatable. If duplicating this block and descendants will put any\n   * type over their maxInstances this block is not duplicatable.\n   *\n   * @returns True if duplicatable.\n   */\n  isDuplicatable(): boolean {\n    if (!this.workspace.hasBlockLimits()) {\n      return true;\n    }\n    return this.workspace.isCapacityAvailable(\n      common.getBlockTypeCounts(this, true),\n    );\n  }\n\n  /**\n   * Get whether this block is a shadow block or not.\n   *\n   * @returns True if a shadow.\n   */\n  isShadow(): boolean {\n    return this.isShadow_;\n  }\n\n  /**\n   * Set whether this block is a shadow block or not.\n   * This method is internal and should not be called by users of Blockly. To\n   * create shadow blocks programmatically call connection.setShadowState\n   *\n   * @param shadow True if a shadow.\n   * @internal\n   */\n  setShadow(shadow: boolean) {\n    this.isShadow_ = shadow;\n  }\n\n  /**\n   * Get whether this block is an insertion marker block or not.\n   *\n   * @returns True if an insertion marker.\n   */\n  isInsertionMarker(): boolean {\n    return this.isInsertionMarker_;\n  }\n\n  /**\n   * Set whether this block is an insertion marker block or not.\n   * Once set this cannot be unset.\n   *\n   * @param insertionMarker True if an insertion marker.\n   * @internal\n   */\n  setInsertionMarker(insertionMarker: boolean) {\n    this.isInsertionMarker_ = insertionMarker;\n  }\n\n  /**\n   * Get whether this block is editable or not.\n   *\n   * @returns True if editable.\n   * @internal\n   */\n  isEditable(): boolean {\n    return (\n      this.editable_ &&\n      !this.isDeadOrDying() &&\n      !this.workspace.options.readOnly\n    );\n  }\n\n  /**\n   * Return whether this block's own editable property is true or false.\n   *\n   * @returns True if the block's editable property is true, false otherwise.\n   */\n  isOwnEditable(): boolean {\n    return this.editable_;\n  }\n\n  /**\n   * Set whether this block is editable or not.\n   *\n   * @param editable True if editable.\n   */\n  setEditable(editable: boolean) {\n    this.editable_ = editable;\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      for (let j = 0, field; (field = input.fieldRow[j]); j++) {\n        field.updateEditable();\n      }\n    }\n  }\n\n  /**\n   * Returns if this block has been disposed of / deleted.\n   *\n   * @returns True if this block has been disposed of / deleted.\n   */\n  isDisposed(): boolean {\n    return this.disposed;\n  }\n\n  /**\n   * @returns True if this block is a value block with a single editable field.\n   * @internal\n   */\n  isSimpleReporter(): boolean {\n    if (!this.outputConnection) return false;\n\n    for (const input of this.inputList) {\n      if (input.connection || input.fieldRow.length > 1) return false;\n    }\n    return true;\n  }\n\n  /**\n   * Find the connection on this block that corresponds to the given connection\n   * on the other block.\n   * Used to match connections between a block and its insertion marker.\n   *\n   * @param otherBlock The other block to match against.\n   * @param conn The other connection to match.\n   * @returns The matching connection on this block, or null.\n   * @internal\n   */\n  getMatchingConnection(\n    otherBlock: Block,\n    conn: Connection,\n  ): Connection | null {\n    const connections = this.getConnections_(true);\n    const otherConnections = otherBlock.getConnections_(true);\n    if (connections.length !== otherConnections.length) {\n      throw Error('Connection lists did not match in length.');\n    }\n    for (let i = 0; i < otherConnections.length; i++) {\n      if (otherConnections[i] === conn) {\n        return connections[i];\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Set the URL of this block's help page.\n   *\n   * @param url URL string for block help, or function that returns a URL.  Null\n   *     for no help.\n   */\n  setHelpUrl(url: string | Function) {\n    this.helpUrl = url;\n  }\n\n  /**\n   * Sets the tooltip for this block.\n   *\n   * @param newTip The text for the tooltip, a function that returns the text\n   *     for the tooltip, or a parent object whose tooltip will be used. To not\n   *     display a tooltip pass the empty string.\n   */\n  setTooltip(newTip: Tooltip.TipInfo) {\n    this.tooltip = newTip;\n  }\n\n  /**\n   * Returns the tooltip text for this block.\n   *\n   * @returns The tooltip text for this block.\n   */\n  getTooltip(): string {\n    return Tooltip.getTooltipOfObject(this);\n  }\n\n  /**\n   * Get the colour of a block.\n   *\n   * @returns #RRGGBB string.\n   */\n  getColour(): string {\n    return this.colour_;\n  }\n\n  /**\n   * Get the name of the block style.\n   *\n   * @returns Name of the block style.\n   */\n  getStyleName(): string {\n    return this.styleName_;\n  }\n\n  /**\n   * Get the HSV hue value of a block.  Null if hue not set.\n   *\n   * @returns Hue value (0-360).\n   */\n  getHue(): number | null {\n    return this.hue_;\n  }\n\n  /**\n   * Change the colour of a block.\n   *\n   * @param colour HSV hue value (0 to 360), #RRGGBB string, or a message\n   *     reference string pointing to one of those two values.\n   */\n  setColour(colour: number | string) {\n    const parsed = parsing.parseBlockColour(colour);\n    this.hue_ = parsed.hue;\n    this.colour_ = parsed.hex;\n  }\n\n  /**\n   * Set the style and colour values of a block.\n   *\n   * @param blockStyleName Name of the block style.\n   */\n  setStyle(blockStyleName: string) {\n    this.styleName_ = blockStyleName;\n  }\n\n  /**\n   * Sets a callback function to use whenever the block's parent workspace\n   * changes, replacing any prior onchange handler. This is usually only called\n   * from the constructor, the block type initializer function, or an extension\n   * initializer function.\n   *\n   * @param onchangeFn The callback to call when the block's workspace changes.\n   * @throws {Error} if onchangeFn is not falsey and not a function.\n   */\n  setOnChange(onchangeFn: (p1: Abstract) => void) {\n    if (onchangeFn && typeof onchangeFn !== 'function') {\n      throw Error('onchange must be a function.');\n    }\n    if (this.onchangeWrapper_) {\n      this.workspace.removeChangeListener(this.onchangeWrapper_);\n    }\n    this.onchange = onchangeFn;\n    this.onchangeWrapper_ = onchangeFn.bind(this);\n    this.workspace.addChangeListener(this.onchangeWrapper_);\n  }\n\n  /**\n   * Returns the named field from a block.\n   *\n   * @param name The name of the field.\n   * @returns Named field, or null if field does not exist.\n   */\n  getField(name: string): Field | null {\n    if (typeof name !== 'string') {\n      throw TypeError(\n        'Block.prototype.getField expects a string ' +\n          'with the field name but received ' +\n          (name === undefined ? 'nothing' : name + ' of type ' + typeof name) +\n          ' instead',\n      );\n    }\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      for (let j = 0, field; (field = input.fieldRow[j]); j++) {\n        if (field.name === name) {\n          return field;\n        }\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Return all variables referenced by this block.\n   *\n   * @returns List of variable ids.\n   */\n  getVars(): string[] {\n    const vars: string[] = [];\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      for (let j = 0, field; (field = input.fieldRow[j]); j++) {\n        if (field.referencesVariables()) {\n          // NOTE: This only applies to `FieldVariable`, a `Field<string>`\n          vars.push(field.getValue() as string);\n        }\n      }\n    }\n    return vars;\n  }\n\n  /**\n   * Return all variables referenced by this block.\n   *\n   * @returns List of variable models.\n   * @internal\n   */\n  getVarModels(): VariableModel[] {\n    const vars = [];\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      for (let j = 0, field; (field = input.fieldRow[j]); j++) {\n        if (field.referencesVariables()) {\n          const model = this.workspace.getVariableById(\n            field.getValue() as string,\n          );\n          // Check if the variable actually exists (and isn't just a potential\n          // variable).\n          if (model) {\n            vars.push(model);\n          }\n        }\n      }\n    }\n    return vars;\n  }\n\n  /**\n   * Notification that a variable is renaming but keeping the same ID.  If the\n   * variable is in use on this block, rerender to show the new name.\n   *\n   * @param variable The variable being renamed.\n   * @internal\n   */\n  updateVarName(variable: VariableModel) {\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      for (let j = 0, field; (field = input.fieldRow[j]); j++) {\n        if (\n          field.referencesVariables() &&\n          variable.getId() === field.getValue()\n        ) {\n          field.refreshVariableName();\n        }\n      }\n    }\n  }\n\n  /**\n   * Notification that a variable is renaming.\n   * If the ID matches one of this block's variables, rename it.\n   *\n   * @param oldId ID of variable to rename.\n   * @param newId ID of new variable.  May be the same as oldId, but with an\n   *     updated name.\n   */\n  renameVarById(oldId: string, newId: string) {\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      for (let j = 0, field; (field = input.fieldRow[j]); j++) {\n        if (field.referencesVariables() && oldId === field.getValue()) {\n          field.setValue(newId);\n        }\n      }\n    }\n  }\n\n  /**\n   * Returns the language-neutral value of the given field.\n   *\n   * @param name The name of the field.\n   * @returns Value of the field or null if field does not exist.\n   */\n  getFieldValue(name: string): AnyDuringMigration {\n    const field = this.getField(name);\n    if (field) {\n      return field.getValue();\n    }\n    return null;\n  }\n\n  /**\n   * Sets the value of the given field for this block.\n   *\n   * @param newValue The value to set.\n   * @param name The name of the field to set the value of.\n   */\n  setFieldValue(newValue: AnyDuringMigration, name: string) {\n    const field = this.getField(name);\n    if (!field) {\n      throw Error('Field \"' + name + '\" not found.');\n    }\n    field.setValue(newValue);\n  }\n\n  /**\n   * Set whether this block can chain onto the bottom of another block.\n   *\n   * @param newBoolean True if there can be a previous statement.\n   * @param opt_check Statement type or list of statement types.  Null/undefined\n   *     if any type could be connected.\n   */\n  setPreviousStatement(\n    newBoolean: boolean,\n    opt_check?: string | string[] | null,\n  ) {\n    if (newBoolean) {\n      if (opt_check === undefined) {\n        opt_check = null;\n      }\n      if (!this.previousConnection) {\n        this.previousConnection = this.makeConnection_(\n          ConnectionType.PREVIOUS_STATEMENT,\n        );\n      }\n      this.previousConnection.setCheck(opt_check);\n    } else {\n      if (this.previousConnection) {\n        if (this.previousConnection.isConnected()) {\n          throw Error(\n            'Must disconnect previous statement before removing ' +\n              'connection.',\n          );\n        }\n        this.previousConnection.dispose();\n        this.previousConnection = null;\n      }\n    }\n  }\n\n  /**\n   * Set whether another block can chain onto the bottom of this block.\n   *\n   * @param newBoolean True if there can be a next statement.\n   * @param opt_check Statement type or list of statement types.  Null/undefined\n   *     if any type could be connected.\n   */\n  setNextStatement(newBoolean: boolean, opt_check?: string | string[] | null) {\n    if (newBoolean) {\n      if (opt_check === undefined) {\n        opt_check = null;\n      }\n      if (!this.nextConnection) {\n        this.nextConnection = this.makeConnection_(\n          ConnectionType.NEXT_STATEMENT,\n        );\n      }\n      this.nextConnection.setCheck(opt_check);\n    } else {\n      if (this.nextConnection) {\n        if (this.nextConnection.isConnected()) {\n          throw Error(\n            'Must disconnect next statement before removing ' + 'connection.',\n          );\n        }\n        this.nextConnection.dispose();\n        this.nextConnection = null;\n      }\n    }\n  }\n\n  /**\n   * Set whether this block returns a value.\n   *\n   * @param newBoolean True if there is an output.\n   * @param opt_check Returned type or list of returned types.  Null or\n   *     undefined if any type could be returned (e.g. variable get).\n   */\n  setOutput(newBoolean: boolean, opt_check?: string | string[] | null) {\n    if (newBoolean) {\n      if (opt_check === undefined) {\n        opt_check = null;\n      }\n      if (!this.outputConnection) {\n        this.outputConnection = this.makeConnection_(\n          ConnectionType.OUTPUT_VALUE,\n        );\n      }\n      this.outputConnection.setCheck(opt_check);\n    } else {\n      if (this.outputConnection) {\n        if (this.outputConnection.isConnected()) {\n          throw Error(\n            'Must disconnect output value before removing connection.',\n          );\n        }\n        this.outputConnection.dispose();\n        this.outputConnection = null;\n      }\n    }\n  }\n\n  /**\n   * Set whether value inputs are arranged horizontally or vertically.\n   *\n   * @param newBoolean True if inputs are horizontal.\n   */\n  setInputsInline(newBoolean: boolean) {\n    if (this.inputsInline !== newBoolean) {\n      eventUtils.fire(\n        new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n          this,\n          'inline',\n          null,\n          this.inputsInline,\n          newBoolean,\n        ),\n      );\n      this.inputsInline = newBoolean;\n    }\n  }\n\n  /**\n   * Get whether value inputs are arranged horizontally or vertically.\n   *\n   * @returns True if inputs are horizontal.\n   */\n  getInputsInline(): boolean {\n    if (this.inputsInline !== undefined) {\n      // Set explicitly.\n      return this.inputsInline;\n    }\n    // Not defined explicitly.  Figure out what would look best.\n    for (let i = 1; i < this.inputList.length; i++) {\n      if (\n        this.inputList[i - 1] instanceof DummyInput &&\n        this.inputList[i] instanceof DummyInput\n      ) {\n        // Two dummy inputs in a row.  Don't inline them.\n        return false;\n      }\n    }\n    for (let i = 1; i < this.inputList.length; i++) {\n      if (\n        this.inputList[i - 1] instanceof ValueInput &&\n        this.inputList[i] instanceof DummyInput\n      ) {\n        // Dummy input after a value input.  Inline them.\n        return true;\n      }\n    }\n    for (let i = 0; i < this.inputList.length; i++) {\n      if (this.inputList[i] instanceof EndRowInput) {\n        // A row-end input is present. Inline value inputs.\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Set the block's output shape.\n   *\n   * @param outputShape Value representing an output shape.\n   */\n  setOutputShape(outputShape: number | null) {\n    this.outputShape_ = outputShape;\n  }\n\n  /**\n   * Get the block's output shape.\n   *\n   * @returns Value representing output shape if one exists.\n   */\n  getOutputShape(): number | null {\n    return this.outputShape_;\n  }\n\n  /**\n   * Get whether this block is enabled or not.\n   *\n   * @returns True if enabled.\n   */\n  isEnabled(): boolean {\n    return !this.disabled;\n  }\n\n  /**\n   * Set whether the block is enabled or not.\n   *\n   * @param enabled True if enabled.\n   */\n  setEnabled(enabled: boolean) {\n    if (this.isEnabled() !== enabled) {\n      const oldValue = this.disabled;\n      this.disabled = !enabled;\n      eventUtils.fire(\n        new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n          this,\n          'disabled',\n          null,\n          oldValue,\n          !enabled,\n        ),\n      );\n    }\n  }\n\n  /**\n   * Get whether the block is disabled or not due to parents.\n   * The block's own disabled property is not considered.\n   *\n   * @returns True if disabled.\n   */\n  getInheritedDisabled(): boolean {\n    let ancestor = this.getSurroundParent();\n    while (ancestor) {\n      if (ancestor.disabled) {\n        return true;\n      }\n      ancestor = ancestor.getSurroundParent();\n    }\n    // Ran off the top.\n    return false;\n  }\n\n  /**\n   * Get whether the block is collapsed or not.\n   *\n   * @returns True if collapsed.\n   */\n  isCollapsed(): boolean {\n    return this.collapsed_;\n  }\n\n  /**\n   * Set whether the block is collapsed or not.\n   *\n   * @param collapsed True if collapsed.\n   */\n  setCollapsed(collapsed: boolean) {\n    if (this.collapsed_ !== collapsed) {\n      eventUtils.fire(\n        new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n          this,\n          'collapsed',\n          null,\n          this.collapsed_,\n          collapsed,\n        ),\n      );\n      this.collapsed_ = collapsed;\n    }\n  }\n\n  /**\n   * Create a human-readable text representation of this block and any children.\n   *\n   * @param opt_maxLength Truncate the string to this length.\n   * @param opt_emptyToken The placeholder string used to denote an empty input.\n   *     If not specified, '?' is used.\n   * @returns Text of block.\n   */\n  toString(opt_maxLength?: number, opt_emptyToken?: string): string {\n    const tokens = this.toTokens(opt_emptyToken);\n\n    // Run through our tokens array and simplify expression to remove\n    // parentheses around single field blocks.\n    // E.g. ['repeat', '(', '10', ')', 'times', 'do', '?']\n    for (let i = 2; i < tokens.length; i++) {\n      if (tokens[i - 2] === '(' && tokens[i] === ')') {\n        tokens[i - 2] = tokens[i - 1];\n        tokens.splice(i - 1, 2);\n      }\n    }\n\n    // Join the text array, removing the spaces around added parentheses.\n    let prev = '';\n    let text: string = tokens.reduce((acc, curr) => {\n      const val = acc + (prev === '(' || curr === ')' ? '' : ' ') + curr;\n      prev = curr[curr.length - 1];\n      return val;\n    }, '');\n\n    text = text.trim() || '???';\n    if (opt_maxLength) {\n      // TODO: Improve truncation so that text from this block is given\n      // priority. E.g. \"1+2+3+4+5+6+7+8+9=0\" should be \"...6+7+8+9=0\", not\n      // \"1+2+3+4+5...\". E.g. \"1+2+3+4+5=6+7+8+9+0\" should be \"...4+5=6+7...\".\n      if (text.length > opt_maxLength) {\n        text = text.substring(0, opt_maxLength - 3) + '...';\n      }\n    }\n    return text;\n  }\n\n  /**\n   * Converts this block into string tokens.\n   *\n   * @param emptyToken The token to use in place of an empty input.\n   *     Defaults to '?'.\n   * @returns The array of string tokens representing this block.\n   */\n  private toTokens(emptyToken = '?'): string[] {\n    const tokens = [];\n    /**\n     * Whether or not to add parentheses around an input.\n     *\n     * @param connection The connection.\n     * @returns True if we should add parentheses around the input.\n     */\n    function shouldAddParentheses(connection: Connection): boolean {\n      let checks = connection.getCheck();\n      if (!checks && connection.targetConnection) {\n        checks = connection.targetConnection.getCheck();\n      }\n      return (\n        !!checks &&\n        (checks.indexOf('Boolean') !== -1 || checks.indexOf('Number') !== -1)\n      );\n    }\n\n    for (const input of this.inputList) {\n      if (input.name == constants.COLLAPSED_INPUT_NAME) {\n        continue;\n      }\n      for (const field of input.fieldRow) {\n        tokens.push(field.getText());\n      }\n      if (input.connection) {\n        const child = input.connection.targetBlock();\n        if (child) {\n          const shouldAddParens = shouldAddParentheses(input.connection);\n          if (shouldAddParens) tokens.push('(');\n          tokens.push(...child.toTokens(emptyToken));\n          if (shouldAddParens) tokens.push(')');\n        } else {\n          tokens.push(emptyToken);\n        }\n      }\n    }\n    return tokens;\n  }\n\n  /**\n   * Appends a value input row.\n   *\n   * @param name Language-neutral identifier which may used to find this input\n   *     again.  Should be unique to this block.\n   * @returns The input object created.\n   */\n  appendValueInput(name: string): Input {\n    return this.appendInput(new ValueInput(name, this));\n  }\n\n  /**\n   * Appends a statement input row.\n   *\n   * @param name Language-neutral identifier which may used to find this input\n   *     again.  Should be unique to this block.\n   * @returns The input object created.\n   */\n  appendStatementInput(name: string): Input {\n    this.statementInputCount++;\n    return this.appendInput(new StatementInput(name, this));\n  }\n\n  /**\n   * Appends a dummy input row.\n   *\n   * @param name Optional language-neutral identifier which may used to find\n   *     this input again.  Should be unique to this block.\n   * @returns The input object created.\n   */\n  appendDummyInput(name = ''): Input {\n    return this.appendInput(new DummyInput(name, this));\n  }\n\n  /**\n   * Appends an input that ends the row.\n   *\n   * @param name Optional language-neutral identifier which may used to find\n   *     this input again.  Should be unique to this block.\n   * @returns The input object created.\n   */\n  appendEndRowInput(name = ''): Input {\n    return this.appendInput(new EndRowInput(name, this));\n  }\n\n  /**\n   * Appends the given input row.\n   *\n   * Allows for custom inputs to be appended to the block.\n   */\n  appendInput(input: Input): Input {\n    this.inputList.push(input);\n    return input;\n  }\n\n  /**\n   * Appends an input with the given input type and name to the block after\n   * constructing it from the registry.\n   *\n   * @param type The name the input is registered under in the registry.\n   * @param name The name the input will have within the block.\n   * @returns The constucted input, or null if there was no constructor\n   *     associated with the type.\n   */\n  private appendInputFromRegistry(type: string, name: string): Input | null {\n    const inputConstructor = registry.getClass(\n      registry.Type.INPUT,\n      type,\n      false,\n    );\n    if (!inputConstructor) return null;\n    return this.appendInput(new inputConstructor(name, this));\n  }\n\n  /**\n   * Initialize this block using a cross-platform, internationalization-friendly\n   * JSON description.\n   *\n   * @param json Structured data describing the block.\n   */\n  jsonInit(json: AnyDuringMigration) {\n    const warningPrefix = json['type'] ? 'Block \"' + json['type'] + '\": ' : '';\n\n    // Validate inputs.\n    if (json['output'] && json['previousStatement']) {\n      throw Error(\n        warningPrefix + 'Must not have both an output and a previousStatement.',\n      );\n    }\n\n    // Validate that each arg has a corresponding message\n    let n = 0;\n    while (json['args' + n]) {\n      if (json['message' + n] === undefined) {\n        throw Error(\n          warningPrefix +\n            `args${n} must have a corresponding message (message${n}).`,\n        );\n      }\n      n++;\n    }\n\n    // Set basic properties of block.\n    // Makes styles backward compatible with old way of defining hat style.\n    if (json['style'] && json['style'].hat) {\n      this.hat = json['style'].hat;\n      // Must set to null so it doesn't error when checking for style and\n      // colour.\n      json['style'] = null;\n    }\n\n    if (json['style'] && json['colour']) {\n      throw Error(warningPrefix + 'Must not have both a colour and a style.');\n    } else if (json['style']) {\n      this.jsonInitStyle_(json, warningPrefix);\n    } else {\n      this.jsonInitColour_(json, warningPrefix);\n    }\n\n    // Interpolate the message blocks.\n    let i = 0;\n    while (json['message' + i] !== undefined) {\n      this.interpolate_(\n        json['message' + i],\n        json['args' + i] || [],\n        // Backwards compatibility: lastDummyAlign aliases implicitAlign.\n        json['implicitAlign' + i] || json['lastDummyAlign' + i],\n        warningPrefix,\n      );\n      i++;\n    }\n\n    if (json['inputsInline'] !== undefined) {\n      eventUtils.disable();\n      this.setInputsInline(json['inputsInline']);\n      eventUtils.enable();\n    }\n\n    // Set output and previous/next connections.\n    if (json['output'] !== undefined) {\n      this.setOutput(true, json['output']);\n    }\n    if (json['outputShape'] !== undefined) {\n      this.setOutputShape(json['outputShape']);\n    }\n    if (json['previousStatement'] !== undefined) {\n      this.setPreviousStatement(true, json['previousStatement']);\n    }\n    if (json['nextStatement'] !== undefined) {\n      this.setNextStatement(true, json['nextStatement']);\n    }\n    if (json['tooltip'] !== undefined) {\n      const rawValue = json['tooltip'];\n      const localizedText = parsing.replaceMessageReferences(rawValue);\n      this.setTooltip(localizedText);\n    }\n    if (json['enableContextMenu'] !== undefined) {\n      this.contextMenu = !!json['enableContextMenu'];\n    }\n    if (json['suppressPrefixSuffix'] !== undefined) {\n      this.suppressPrefixSuffix = !!json['suppressPrefixSuffix'];\n    }\n    if (json['helpUrl'] !== undefined) {\n      const rawValue = json['helpUrl'];\n      const localizedValue = parsing.replaceMessageReferences(rawValue);\n      this.setHelpUrl(localizedValue);\n    }\n    if (typeof json['extensions'] === 'string') {\n      console.warn(\n        warningPrefix +\n          \"JSON attribute 'extensions' should be an array of\" +\n          \" strings. Found raw string in JSON for '\" +\n          json['type'] +\n          \"' block.\",\n      );\n      json['extensions'] = [json['extensions']]; // Correct and continue.\n    }\n\n    // Add the mutator to the block.\n    if (json['mutator'] !== undefined) {\n      Extensions.apply(json['mutator'], this, true);\n    }\n\n    const extensionNames = json['extensions'];\n    if (Array.isArray(extensionNames)) {\n      for (let j = 0; j < extensionNames.length; j++) {\n        Extensions.apply(extensionNames[j], this, false);\n      }\n    }\n  }\n\n  /**\n   * Initialize the colour of this block from the JSON description.\n   *\n   * @param json Structured data describing the block.\n   * @param warningPrefix Warning prefix string identifying block.\n   */\n  private jsonInitColour_(json: AnyDuringMigration, warningPrefix: string) {\n    if ('colour' in json) {\n      if (json['colour'] === undefined) {\n        console.warn(warningPrefix + 'Undefined colour value.');\n      } else {\n        const rawValue = json['colour'];\n        try {\n          this.setColour(rawValue);\n        } catch (e) {\n          console.warn(warningPrefix + 'Illegal colour value: ', rawValue);\n        }\n      }\n    }\n  }\n\n  /**\n   * Initialize the style of this block from the JSON description.\n   *\n   * @param json Structured data describing the block.\n   * @param warningPrefix Warning prefix string identifying block.\n   */\n  private jsonInitStyle_(json: AnyDuringMigration, warningPrefix: string) {\n    const blockStyleName = json['style'];\n    try {\n      this.setStyle(blockStyleName);\n    } catch (styleError) {\n      console.warn(warningPrefix + 'Style does not exist: ', blockStyleName);\n    }\n  }\n\n  /**\n   * Add key/values from mixinObj to this block object. By default, this method\n   * will check that the keys in mixinObj will not overwrite existing values in\n   * the block, including prototype values. This provides some insurance against\n   * mixin / extension incompatibilities with future block features. This check\n   * can be disabled by passing true as the second argument.\n   *\n   * @param mixinObj The key/values pairs to add to this block object.\n   * @param opt_disableCheck Option flag to disable overwrite checks.\n   */\n  mixin(mixinObj: AnyDuringMigration, opt_disableCheck?: boolean) {\n    if (\n      opt_disableCheck !== undefined &&\n      typeof opt_disableCheck !== 'boolean'\n    ) {\n      throw Error('opt_disableCheck must be a boolean if provided');\n    }\n    if (!opt_disableCheck) {\n      const overwrites = [];\n      for (const key in mixinObj) {\n        if ((this as AnyDuringMigration)[key] !== undefined) {\n          overwrites.push(key);\n        }\n      }\n      if (overwrites.length) {\n        throw Error(\n          'Mixin will overwrite block members: ' + JSON.stringify(overwrites),\n        );\n      }\n    }\n    Object.assign(this, mixinObj);\n  }\n\n  /**\n   * Interpolate a message description onto the block.\n   *\n   * @param message Text contains interpolation tokens (%1, %2, ...) that match\n   *     with fields or inputs defined in the args array.\n   * @param args Array of arguments to be interpolated.\n   * @param implicitAlign If an implicit input is added at the end or in place\n   *     of newline tokens, how should it be aligned?\n   * @param warningPrefix Warning prefix string identifying block.\n   */\n  private interpolate_(\n    message: string,\n    args: AnyDuringMigration[],\n    implicitAlign: string | undefined,\n    warningPrefix: string,\n  ) {\n    const tokens = parsing.tokenizeInterpolation(message);\n    this.validateTokens_(tokens, args.length);\n    const elements = this.interpolateArguments_(tokens, args, implicitAlign);\n\n    // An array of [field, fieldName] tuples.\n    const fieldStack = [];\n    for (let i = 0, element; (element = elements[i]); i++) {\n      if (this.isInputKeyword_(element['type'])) {\n        const input = this.inputFromJson_(element, warningPrefix);\n        // Should never be null, but just in case.\n        if (input) {\n          for (let j = 0, tuple; (tuple = fieldStack[j]); j++) {\n            input.appendField(tuple[0], tuple[1]);\n          }\n          fieldStack.length = 0;\n        }\n      } else {\n        // All other types, including ones starting with 'input_' get routed\n        // here.\n        const field = this.fieldFromJson_(element);\n        if (field) {\n          fieldStack.push([field, element['name']]);\n        }\n      }\n    }\n  }\n\n  /**\n   * Validates that the tokens are within the correct bounds, with no\n   * duplicates, and that all of the arguments are referred to. Throws errors if\n   * any of these things are not true.\n   *\n   * @param tokens An array of tokens to validate\n   * @param argsCount The number of args that need to be referred to.\n   */\n  private validateTokens_(tokens: Array<string | number>, argsCount: number) {\n    const visitedArgsHash = [];\n    let visitedArgsCount = 0;\n    for (let i = 0; i < tokens.length; i++) {\n      const token = tokens[i];\n      if (typeof token !== 'number') {\n        continue;\n      }\n      if (token < 1 || token > argsCount) {\n        throw Error(\n          'Block \"' +\n            this.type +\n            '\": ' +\n            'Message index %' +\n            token +\n            ' out of range.',\n        );\n      }\n      if (visitedArgsHash[token]) {\n        throw Error(\n          'Block \"' +\n            this.type +\n            '\": ' +\n            'Message index %' +\n            token +\n            ' duplicated.',\n        );\n      }\n      visitedArgsHash[token] = true;\n      visitedArgsCount++;\n    }\n    if (visitedArgsCount !== argsCount) {\n      throw Error(\n        'Block \"' +\n          this.type +\n          '\": ' +\n          'Message does not reference all ' +\n          argsCount +\n          ' arg(s).',\n      );\n    }\n  }\n\n  /**\n   * Inserts args in place of numerical tokens. String args are converted to\n   * JSON that defines a label field. Newline characters are converted to\n   * end-row inputs, and if necessary an extra dummy input is added to the end\n   * of the elements.\n   *\n   * @param tokens The tokens to interpolate\n   * @param args The arguments to insert.\n   * @param implicitAlign The alignment to use for any implicitly added end-row\n   *     or dummy inputs, if necessary.\n   * @returns The JSON definitions of field and inputs to add to the block.\n   */\n  private interpolateArguments_(\n    tokens: Array<string | number>,\n    args: Array<AnyDuringMigration | string>,\n    implicitAlign: string | undefined,\n  ): AnyDuringMigration[] {\n    const elements = [];\n    for (let i = 0; i < tokens.length; i++) {\n      let element = tokens[i];\n      if (typeof element === 'number') {\n        element = args[element - 1];\n      }\n      // Args can be strings, which is why this isn't elseif.\n      if (typeof element === 'string') {\n        if (element === '\\n') {\n          // Convert newline tokens to end-row inputs.\n          const newlineInput = {'type': 'input_end_row'};\n          if (implicitAlign) {\n            (newlineInput as AnyDuringMigration)['align'] = implicitAlign;\n          }\n          element = newlineInput as AnyDuringMigration;\n        } else {\n          // AnyDuringMigration because:  Type '{ text: string; type: string; }\n          // | null' is not assignable to type 'string | number'.\n          element = this.stringToFieldJson_(element) as AnyDuringMigration;\n          if (!element) {\n            continue;\n          }\n        }\n      }\n      elements.push(element);\n    }\n\n    const length = elements.length;\n    if (\n      length &&\n      !this.isInputKeyword_(\n        (elements as AnyDuringMigration)[length - 1]['type'],\n      )\n    ) {\n      const dummyInput = {'type': 'input_dummy'};\n      if (implicitAlign) {\n        (dummyInput as AnyDuringMigration)['align'] = implicitAlign;\n      }\n      elements.push(dummyInput);\n    }\n\n    return elements;\n  }\n\n  /**\n   * Creates a field from the JSON definition of a field. If a field with the\n   * given type cannot be found, this attempts to create a different field using\n   * the 'alt' property of the JSON definition (if it exists).\n   *\n   * @param element The element to try to turn into a field.\n   * @returns The field defined by the JSON, or null if one couldn't be created.\n   */\n  private fieldFromJson_(element: {\n    alt?: string;\n    type: string;\n    text?: string;\n  }): Field | null {\n    const field = fieldRegistry.fromJson(element);\n    if (!field && element['alt']) {\n      if (typeof element['alt'] === 'string') {\n        const json = this.stringToFieldJson_(element['alt']);\n        return json ? this.fieldFromJson_(json) : null;\n      }\n      return this.fieldFromJson_(element['alt']);\n    }\n    return field;\n  }\n\n  /**\n   * Creates an input from the JSON definition of an input. Sets the input's\n   * check and alignment if they are provided.\n   *\n   * @param element The JSON to turn into an input.\n   * @param warningPrefix The prefix to add to warnings to help the developer\n   *     debug.\n   * @returns The input that has been created, or null if one could not be\n   *     created for some reason (should never happen).\n   */\n  private inputFromJson_(\n    element: AnyDuringMigration,\n    warningPrefix: string,\n  ): Input | null {\n    const alignmentLookup = {\n      'LEFT': Align.LEFT,\n      'RIGHT': Align.RIGHT,\n      'CENTRE': Align.CENTRE,\n      'CENTER': Align.CENTRE,\n    };\n\n    let input = null;\n    switch (element['type']) {\n      case 'input_value':\n        input = this.appendValueInput(element['name']);\n        break;\n      case 'input_statement':\n        input = this.appendStatementInput(element['name']);\n        break;\n      case 'input_dummy':\n        input = this.appendDummyInput(element['name']);\n        break;\n      case 'input_end_row':\n        input = this.appendEndRowInput(element['name']);\n        break;\n      default: {\n        input = this.appendInputFromRegistry(element['type'], element['name']);\n        break;\n      }\n    }\n    // Should never be hit because of interpolate_'s checks, but just in case.\n    if (!input) {\n      return null;\n    }\n\n    if (element['check']) {\n      input.setCheck(element['check']);\n    }\n    if (element['align']) {\n      const alignment = (alignmentLookup as AnyDuringMigration)[\n        element['align'].toUpperCase()\n      ];\n      if (alignment === undefined) {\n        console.warn(warningPrefix + 'Illegal align value: ', element['align']);\n      } else {\n        input.setAlign(alignment);\n      }\n    }\n    return input;\n  }\n\n  /**\n   * Returns true if the given string matches one of the input keywords.\n   *\n   * @param str The string to check.\n   * @returns True if the given string matches one of the input keywords, false\n   *     otherwise.\n   */\n  private isInputKeyword_(str: string): boolean {\n    return (\n      str === 'input_value' ||\n      str === 'input_statement' ||\n      str === 'input_dummy' ||\n      str === 'input_end_row' ||\n      registry.hasItem(registry.Type.INPUT, str)\n    );\n  }\n\n  /**\n   * Turns a string into the JSON definition of a label field. If the string\n   * becomes an empty string when trimmed, this returns null.\n   *\n   * @param str String to turn into the JSON definition of a label field.\n   * @returns The JSON definition or null.\n   */\n  private stringToFieldJson_(str: string): {text: string; type: string} | null {\n    str = str.trim();\n    if (str) {\n      return {\n        'type': 'field_label',\n        'text': str,\n      };\n    }\n    return null;\n  }\n\n  /**\n   * Move a named input to a different location on this block.\n   *\n   * @param name The name of the input to move.\n   * @param refName Name of input that should be after the moved input, or null\n   *     to be the input at the end.\n   */\n  moveInputBefore(name: string, refName: string | null) {\n    if (name === refName) {\n      return;\n    }\n    // Find both inputs.\n    let inputIndex = -1;\n    let refIndex = refName ? -1 : this.inputList.length;\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      if (input.name === name) {\n        inputIndex = i;\n        if (refIndex !== -1) {\n          break;\n        }\n      } else if (refName && input.name === refName) {\n        refIndex = i;\n        if (inputIndex !== -1) {\n          break;\n        }\n      }\n    }\n    if (inputIndex === -1) {\n      throw Error('Named input \"' + name + '\" not found.');\n    }\n    if (refIndex === -1) {\n      throw Error('Reference input \"' + refName + '\" not found.');\n    }\n    this.moveNumberedInputBefore(inputIndex, refIndex);\n  }\n\n  /**\n   * Move a numbered input to a different location on this block.\n   *\n   * @param inputIndex Index of the input to move.\n   * @param refIndex Index of input that should be after the moved input.\n   */\n  moveNumberedInputBefore(inputIndex: number, refIndex: number) {\n    // Validate arguments.\n    if (inputIndex === refIndex) {\n      throw Error(\"Can't move input to itself.\");\n    }\n    if (inputIndex >= this.inputList.length) {\n      throw RangeError('Input index ' + inputIndex + ' out of bounds.');\n    }\n    if (refIndex > this.inputList.length) {\n      throw RangeError('Reference input ' + refIndex + ' out of bounds.');\n    }\n    // Remove input.\n    const input = this.inputList[inputIndex];\n    this.inputList.splice(inputIndex, 1);\n    if (inputIndex < refIndex) {\n      refIndex--;\n    }\n    // Reinsert input.\n    this.inputList.splice(refIndex, 0, input);\n  }\n\n  /**\n   * Remove an input from this block.\n   *\n   * @param name The name of the input.\n   * @param opt_quiet True to prevent an error if input is not present.\n   * @returns True if operation succeeds, false if input is not present and\n   *     opt_quiet is true.\n   * @throws {Error} if the input is not present and opt_quiet is not true.\n   */\n  removeInput(name: string, opt_quiet?: boolean): boolean {\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      if (input.name === name) {\n        if (input instanceof StatementInput) this.statementInputCount--;\n        input.dispose();\n        this.inputList.splice(i, 1);\n        return true;\n      }\n    }\n    if (opt_quiet) {\n      return false;\n    }\n    throw Error('Input not found: ' + name);\n  }\n\n  /**\n   * Fetches the named input object.\n   *\n   * @param name The name of the input.\n   * @returns The input object, or null if input does not exist.\n   */\n  getInput(name: string): Input | null {\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      if (input.name === name) {\n        return input;\n      }\n    }\n    // This input does not exist.\n    return null;\n  }\n\n  /**\n   * Fetches the block attached to the named input.\n   *\n   * @param name The name of the input.\n   * @returns The attached value block, or null if the input is either\n   *     disconnected or if the input does not exist.\n   */\n  getInputTargetBlock(name: string): Block | null {\n    const input = this.getInput(name);\n    return input && input.connection && input.connection.targetBlock();\n  }\n\n  /**\n   * Returns the comment on this block (or null if there is no comment).\n   *\n   * @returns Block's comment.\n   */\n  getCommentText(): string | null {\n    const comment = this.getIcon(CommentIcon.TYPE) as CommentIcon | null;\n    return comment?.getText() ?? null;\n  }\n\n  /**\n   * Set this block's comment text.\n   *\n   * @param text The text, or null to delete.\n   */\n  setCommentText(text: string | null) {\n    const comment = this.getIcon(CommentIcon.TYPE) as CommentIcon | null;\n    const oldText = comment?.getText() ?? null;\n    if (oldText === text) return;\n    if (text !== null) {\n      let comment = this.getIcon(CommentIcon.TYPE) as CommentIcon | undefined;\n      if (!comment) {\n        comment = this.addIcon(new CommentIcon(this));\n      }\n      eventUtils.disable();\n      comment.setText(text);\n      eventUtils.enable();\n    } else {\n      this.removeIcon(CommentIcon.TYPE);\n    }\n\n    eventUtils.fire(\n      new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n        this,\n        'comment',\n        null,\n        oldText,\n        text,\n      ),\n    );\n  }\n\n  /**\n   * Set this block's warning text.\n   *\n   * @param _text The text, or null to delete.\n   * @param _opt_id An optional ID for the warning text to be able to maintain\n   *     multiple warnings.\n   */\n  setWarningText(_text: string | null, _opt_id?: string) {\n    // NOOP.\n  }\n\n  /**\n   * Give this block a mutator dialog.\n   *\n   * @param _mutator A mutator dialog instance or null to remove.\n   */\n  setMutator(_mutator: MutatorIcon) {\n    // NOOP.\n  }\n\n  /** Adds the given icon to the block. */\n  addIcon<T extends IIcon>(icon: T): T {\n    if (this.hasIcon(icon.getType())) throw new DuplicateIconType(icon);\n    this.icons.push(icon);\n    this.icons.sort((a, b) => a.getWeight() - b.getWeight());\n    return icon;\n  }\n\n  /**\n   * Removes the icon whose getType matches the given type iconType from the\n   * block.\n   *\n   * @param type The type of the icon to remove from the block.\n   * @returns True if an icon with the given type was found, false otherwise.\n   */\n  removeIcon(type: IconType<IIcon>): boolean {\n    if (!this.hasIcon(type)) return false;\n    this.getIcon(type)?.dispose();\n    this.icons = this.icons.filter((icon) => !icon.getType().equals(type));\n    return true;\n  }\n\n  /**\n   * @returns True if an icon with the given type exists on the block,\n   *     false otherwise.\n   */\n  hasIcon(type: IconType<IIcon>): boolean {\n    return this.icons.some((icon) => icon.getType().equals(type));\n  }\n\n  /**\n   * @param type The type of the icon to retrieve. Prefer passing an `IconType`\n   *     for proper type checking when using typescript.\n   * @returns The icon with the given type if it exists on the block, undefined\n   *     otherwise.\n   */\n  getIcon<T extends IIcon>(type: IconType<T> | string): T | undefined {\n    if (type instanceof IconType) {\n      return this.icons.find((icon) => icon.getType().equals(type)) as T;\n    } else {\n      return this.icons.find((icon) => icon.getType().toString() === type) as T;\n    }\n  }\n\n  /** @returns An array of the icons attached to this block. */\n  getIcons(): IIcon[] {\n    return [...this.icons];\n  }\n\n  /**\n   * Return the coordinates of the top-left corner of this block relative to the\n   * drawing surface's origin (0,0), in workspace units.\n   *\n   * @returns Object with .x and .y properties.\n   */\n  getRelativeToSurfaceXY(): Coordinate {\n    return this.xy_;\n  }\n\n  /**\n   * Move a block by a relative offset.\n   *\n   * @param dx Horizontal offset, in workspace units.\n   * @param dy Vertical offset, in workspace units.\n   * @param reason Why is this move happening?  'drag', 'bump', 'snap', ...\n   */\n  moveBy(dx: number, dy: number, reason?: string[]) {\n    if (this.parentBlock_) {\n      throw Error('Block has parent');\n    }\n    const event = new (eventUtils.get(eventUtils.BLOCK_MOVE))(\n      this,\n    ) as BlockMove;\n    reason && event.setReason(reason);\n    this.xy_.translate(dx, dy);\n    event.recordNew();\n    eventUtils.fire(event);\n  }\n\n  /**\n   * Create a connection of the specified type.\n   *\n   * @param type The type of the connection to create.\n   * @returns A new connection of the specified type.\n   * @internal\n   */\n  makeConnection_(type: ConnectionType): Connection {\n    return new Connection(this, type);\n  }\n\n  /**\n   * Recursively checks whether all statement and value inputs are filled with\n   * blocks. Also checks all following statement blocks in this stack.\n   *\n   * @param opt_shadowBlocksAreFilled An optional argument controlling whether\n   *     shadow blocks are counted as filled. Defaults to true.\n   * @returns True if all inputs are filled, false otherwise.\n   */\n  allInputsFilled(opt_shadowBlocksAreFilled?: boolean): boolean {\n    // Account for the shadow block filledness toggle.\n    if (opt_shadowBlocksAreFilled === undefined) {\n      opt_shadowBlocksAreFilled = true;\n    }\n    if (!opt_shadowBlocksAreFilled && this.isShadow()) {\n      return false;\n    }\n\n    // Recursively check each input block of the current block.\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      if (!input.connection) {\n        continue;\n      }\n      const target = input.connection.targetBlock();\n      if (!target || !target.allInputsFilled(opt_shadowBlocksAreFilled)) {\n        return false;\n      }\n    }\n\n    // Recursively check the next block after the current block.\n    const next = this.getNextBlock();\n    if (next) {\n      return next.allInputsFilled(opt_shadowBlocksAreFilled);\n    }\n\n    return true;\n  }\n\n  /**\n   * This method returns a string describing this Block in developer terms (type\n   * name and ID; English only).\n   *\n   * Intended to on be used in console logs and errors. If you need a string\n   * that uses the user's native language (including block text, field values,\n   * and child blocks), use [toString()]{@link Block#toString}.\n   *\n   * @returns The description.\n   */\n  toDevString(): string {\n    let msg = this.type ? '\"' + this.type + '\" block' : 'Block';\n    if (this.id) {\n      msg += ' (id=\"' + this.id + '\")';\n    }\n    return msg;\n  }\n}\n\nexport namespace Block {\n  export interface CommentModel {\n    text: string | null;\n    pinned: boolean;\n    size: Size;\n  }\n}\n\nexport type CommentModel = Block.CommentModel;\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The class representing a marker.\n * Used primarily for keyboard navigation to show a marked location.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Marker\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {MarkerSvg} from '../renderers/common/marker_svg.js';\n\nimport type {ASTNode} from './ast_node.js';\n\n/**\n * Class for a marker.\n * This is used in keyboard navigation to save a location in the Blockly AST.\n */\nexport class Marker {\n  /** The colour of the marker. */\n  colour: string | null = null;\n\n  /** The current location of the marker. */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'ASTNode'.\n  private curNode: ASTNode = null as AnyDuringMigration;\n\n  /**\n   * The object in charge of drawing the visual representation of the current\n   * node.\n   */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'MarkerSvg'.\n  private drawer: MarkerSvg = null as AnyDuringMigration;\n\n  /** The type of the marker. */\n  type = 'marker';\n\n  /** Constructs a new Marker instance. */\n  constructor() {}\n\n  /**\n   * Sets the object in charge of drawing the marker.\n   *\n   * @param drawer The object in charge of drawing the marker.\n   */\n  setDrawer(drawer: MarkerSvg) {\n    this.drawer = drawer;\n  }\n\n  /**\n   * Get the current drawer for the marker.\n   *\n   * @returns The object in charge of drawing the marker.\n   */\n  getDrawer(): MarkerSvg {\n    return this.drawer;\n  }\n\n  /**\n   * Gets the current location of the marker.\n   *\n   * @returns The current field, connection, or block the marker is on.\n   */\n  getCurNode(): ASTNode {\n    return this.curNode;\n  }\n\n  /**\n   * Set the location of the marker and call the update method.\n   * Setting isStack to true will only work if the newLocation is the top most\n   * output or previous connection on a stack.\n   *\n   * @param newNode The new location of the marker.\n   */\n  setCurNode(newNode: ASTNode) {\n    const oldNode = this.curNode;\n    this.curNode = newNode;\n    if (this.drawer) {\n      this.drawer.draw(oldNode, this.curNode);\n    }\n  }\n\n  /**\n   * Redraw the current marker.\n   *\n   * @internal\n   */\n  draw() {\n    if (this.drawer) {\n      this.drawer.draw(this.curNode, this.curNode);\n    }\n  }\n\n  /** Hide the marker SVG. */\n  hide() {\n    if (this.drawer) {\n      this.drawer.hide();\n    }\n  }\n\n  /** Dispose of this marker. */\n  dispose() {\n    if (this.getDrawer()) {\n      this.getDrawer().dispose();\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The class representing a cursor.\n * Used primarily for keyboard navigation.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Cursor\n\nimport * as registry from '../registry.js';\n\nimport {ASTNode} from './ast_node.js';\nimport {Marker} from './marker.js';\n\n/**\n * Class for a cursor.\n * A cursor controls how a user navigates the Blockly AST.\n */\nexport class Cursor extends Marker {\n  override type = 'cursor';\n\n  constructor() {\n    super();\n  }\n\n  /**\n   * Find the next connection, field, or block.\n   *\n   * @returns The next element, or null if the current node is not set or there\n   *     is no next value.\n   */\n  next(): ASTNode | null {\n    const curNode = this.getCurNode();\n    if (!curNode) {\n      return null;\n    }\n\n    let newNode = curNode.next();\n    while (\n      newNode &&\n      newNode.next() &&\n      (newNode.getType() === ASTNode.types.NEXT ||\n        newNode.getType() === ASTNode.types.BLOCK)\n    ) {\n      newNode = newNode.next();\n    }\n\n    if (newNode) {\n      this.setCurNode(newNode);\n    }\n    return newNode;\n  }\n\n  /**\n   * Find the in connection or field.\n   *\n   * @returns The in element, or null if the current node is not set or there is\n   *     no in value.\n   */\n  in(): ASTNode | null {\n    let curNode: ASTNode | null = this.getCurNode();\n    if (!curNode) {\n      return null;\n    }\n    // If we are on a previous or output connection, go to the block level\n    // before performing next operation.\n    if (\n      curNode.getType() === ASTNode.types.PREVIOUS ||\n      curNode.getType() === ASTNode.types.OUTPUT\n    ) {\n      curNode = curNode.next();\n    }\n    const newNode = curNode?.in() ?? null;\n\n    if (newNode) {\n      this.setCurNode(newNode);\n    }\n    return newNode;\n  }\n\n  /**\n   * Find the previous connection, field, or block.\n   *\n   * @returns The previous element, or null if the current node is not set or\n   *     there is no previous value.\n   */\n  prev(): ASTNode | null {\n    const curNode = this.getCurNode();\n    if (!curNode) {\n      return null;\n    }\n    let newNode = curNode.prev();\n\n    while (\n      newNode &&\n      newNode.prev() &&\n      (newNode.getType() === ASTNode.types.NEXT ||\n        newNode.getType() === ASTNode.types.BLOCK)\n    ) {\n      newNode = newNode.prev();\n    }\n\n    if (newNode) {\n      this.setCurNode(newNode);\n    }\n    return newNode;\n  }\n\n  /**\n   * Find the out connection, field, or block.\n   *\n   * @returns The out element, or null if the current node is not set or there\n   *     is no out value.\n   */\n  out(): ASTNode | null {\n    const curNode = this.getCurNode();\n    if (!curNode) {\n      return null;\n    }\n    let newNode = curNode.out();\n\n    if (newNode && newNode.getType() === ASTNode.types.BLOCK) {\n      newNode = newNode.prev() || newNode;\n    }\n\n    if (newNode) {\n      this.setCurNode(newNode);\n    }\n    return newNode;\n  }\n}\n\nregistry.register(registry.Type.CURSOR, registry.DEFAULT, Cursor);\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The class representing a basic cursor.\n * Used to demo switching between different cursors.\n *\n * @class\n */\n// Former goog.module ID: Blockly.BasicCursor\n\nimport * as registry from '../registry.js';\n\nimport {ASTNode} from './ast_node.js';\nimport {Cursor} from './cursor.js';\n\n/**\n * Class for a basic cursor.\n * This will allow the user to get to all nodes in the AST by hitting next or\n * previous.\n */\nexport class BasicCursor extends Cursor {\n  /** Name used for registering a basic cursor. */\n  static readonly registrationName = 'basicCursor';\n\n  constructor() {\n    super();\n  }\n\n  /**\n   * Find the next node in the pre order traversal.\n   *\n   * @returns The next node, or null if the current node is not set or there is\n   *     no next value.\n   */\n  override next(): ASTNode | null {\n    const curNode = this.getCurNode();\n    if (!curNode) {\n      return null;\n    }\n    const newNode = this.getNextNode_(curNode, this.validNode_);\n\n    if (newNode) {\n      this.setCurNode(newNode);\n    }\n    return newNode;\n  }\n\n  /**\n   * For a basic cursor we only have the ability to go next and previous, so\n   * in will also allow the user to get to the next node in the pre order\n   * traversal.\n   *\n   * @returns The next node, or null if the current node is not set or there is\n   *     no next value.\n   */\n  override in(): ASTNode | null {\n    return this.next();\n  }\n\n  /**\n   * Find the previous node in the pre order traversal.\n   *\n   * @returns The previous node, or null if the current node is not set or there\n   *     is no previous value.\n   */\n  override prev(): ASTNode | null {\n    const curNode = this.getCurNode();\n    if (!curNode) {\n      return null;\n    }\n    const newNode = this.getPreviousNode_(curNode, this.validNode_);\n\n    if (newNode) {\n      this.setCurNode(newNode);\n    }\n    return newNode;\n  }\n\n  /**\n   * For a basic cursor we only have the ability to go next and previous, so\n   * out will allow the user to get to the previous node in the pre order\n   * traversal.\n   *\n   * @returns The previous node, or null if the current node is not set or there\n   *     is no previous value.\n   */\n  override out(): ASTNode | null {\n    return this.prev();\n  }\n\n  /**\n   * Uses pre order traversal to navigate the Blockly AST. This will allow\n   * a user to easily navigate the entire Blockly AST without having to go in\n   * and out levels on the tree.\n   *\n   * @param node The current position in the AST.\n   * @param isValid A function true/false depending on whether the given node\n   *     should be traversed.\n   * @returns The next node in the traversal.\n   */\n  protected getNextNode_(\n    node: ASTNode | null,\n    isValid: (p1: ASTNode | null) => boolean,\n  ): ASTNode | null {\n    if (!node) {\n      return null;\n    }\n    const newNode = node.in() || node.next();\n    if (isValid(newNode)) {\n      return newNode;\n    } else if (newNode) {\n      return this.getNextNode_(newNode, isValid);\n    }\n    const siblingOrParent = this.findSiblingOrParent(node.out());\n    if (isValid(siblingOrParent)) {\n      return siblingOrParent;\n    } else if (siblingOrParent) {\n      return this.getNextNode_(siblingOrParent, isValid);\n    }\n    return null;\n  }\n\n  /**\n   * Reverses the pre order traversal in order to find the previous node. This\n   * will allow a user to easily navigate the entire Blockly AST without having\n   * to go in and out levels on the tree.\n   *\n   * @param node The current position in the AST.\n   * @param isValid A function true/false depending on whether the given node\n   *     should be traversed.\n   * @returns The previous node in the traversal or null if no previous node\n   *     exists.\n   */\n  protected getPreviousNode_(\n    node: ASTNode | null,\n    isValid: (p1: ASTNode | null) => boolean,\n  ): ASTNode | null {\n    if (!node) {\n      return null;\n    }\n    let newNode: ASTNode | null = node.prev();\n\n    if (newNode) {\n      newNode = this.getRightMostChild(newNode);\n    } else {\n      newNode = node.out();\n    }\n    if (isValid(newNode)) {\n      return newNode;\n    } else if (newNode) {\n      return this.getPreviousNode_(newNode, isValid);\n    }\n    return null;\n  }\n\n  /**\n   * Decides what nodes to traverse and which ones to skip. Currently, it\n   * skips output, stack and workspace nodes.\n   *\n   * @param node The AST node to check whether it is valid.\n   * @returns True if the node should be visited, false otherwise.\n   */\n  protected validNode_(node: ASTNode | null): boolean {\n    let isValid = false;\n    const type = node && node.getType();\n    if (\n      type === ASTNode.types.OUTPUT ||\n      type === ASTNode.types.INPUT ||\n      type === ASTNode.types.FIELD ||\n      type === ASTNode.types.NEXT ||\n      type === ASTNode.types.PREVIOUS ||\n      type === ASTNode.types.WORKSPACE\n    ) {\n      isValid = true;\n    }\n    return isValid;\n  }\n\n  /**\n   * From the given node find either the next valid sibling or parent.\n   *\n   * @param node The current position in the AST.\n   * @returns The parent AST node or null if there are no valid parents.\n   */\n  private findSiblingOrParent(node: ASTNode | null): ASTNode | null {\n    if (!node) {\n      return null;\n    }\n    const nextNode = node.next();\n    if (nextNode) {\n      return nextNode;\n    }\n    return this.findSiblingOrParent(node.out());\n  }\n\n  /**\n   * Get the right most child of a node.\n   *\n   * @param node The node to find the right most child of.\n   * @returns The right most child of the given node, or the node if no child\n   *     exists.\n   */\n  private getRightMostChild(node: ASTNode | null): ASTNode | null {\n    if (!node!.in()) {\n      return node;\n    }\n    let newNode = node!.in();\n    while (newNode && newNode.next()) {\n      newNode = newNode.next();\n    }\n    return this.getRightMostChild(newNode);\n  }\n}\n\nregistry.register(\n  registry.Type.CURSOR,\n  BasicCursor.registrationName,\n  BasicCursor,\n);\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The class representing a cursor that is used to navigate\n * between tab navigable fields.\n *\n * @class\n */\n// Former goog.module ID: Blockly.TabNavigateCursor\n\nimport type {Field} from '../field.js';\n\nimport {ASTNode} from './ast_node.js';\nimport {BasicCursor} from './basic_cursor.js';\n\n/**\n * A cursor for navigating between tab navigable fields.\n */\nexport class TabNavigateCursor extends BasicCursor {\n  /**\n   * Skip all nodes except for tab navigable fields.\n   *\n   * @param node The AST node to check whether it is valid.\n   * @returns True if the node should be visited, false otherwise.\n   */\n  override validNode_(node: ASTNode | null): boolean {\n    let isValid = false;\n    const type = node && node.getType();\n    if (node) {\n      const location = node.getLocation() as Field;\n      if (\n        type === ASTNode.types.FIELD &&\n        location &&\n        location.isTabNavigable() &&\n        location.isClickable()\n      ) {\n        isValid = true;\n      }\n    }\n    return isValid;\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Components for creating connections between blocks.\n *\n * @class\n */\n// Former goog.module ID: Blockly.RenderedConnection\n\nimport type {Block} from './block.js';\nimport type {BlockSvg} from './block_svg.js';\nimport * as common from './common.js';\nimport {config} from './config.js';\nimport {Connection} from './connection.js';\nimport type {ConnectionDB} from './connection_db.js';\nimport {ConnectionType} from './connection_type.js';\nimport * as eventUtils from './events/utils.js';\nimport {hasBubble} from './interfaces/i_has_bubble.js';\nimport * as internalConstants from './internal_constants.js';\nimport {Coordinate} from './utils/coordinate.js';\n\n/** Maximum randomness in workspace units for bumping a block. */\nconst BUMP_RANDOMNESS = 10;\n\n/**\n * Class for a connection between blocks that may be rendered on screen.\n */\nexport class RenderedConnection extends Connection {\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  sourceBlock_!: BlockSvg;\n  private readonly db: ConnectionDB;\n  private readonly dbOpposite: ConnectionDB;\n  private readonly offsetInBlock: Coordinate;\n  private trackedState: TrackedState;\n  private highlighted: boolean = false;\n\n  /** Connection this connection connects to.  Null if not connected. */\n  override targetConnection: RenderedConnection | null = null;\n\n  /**\n   * @param source The block establishing this connection.\n   * @param type The type of the connection.\n   */\n  constructor(source: BlockSvg, type: number) {\n    super(source, type);\n\n    /**\n     * Connection database for connections of this type on the current\n     * workspace.\n     */\n    this.db = source.workspace.connectionDBList[type];\n\n    /**\n     * Connection database for connections compatible with this type on the\n     * current workspace.\n     */\n    this.dbOpposite =\n      source.workspace.connectionDBList[internalConstants.OPPOSITE_TYPE[type]];\n\n    /** Workspace units, (0, 0) is top left of block. */\n    this.offsetInBlock = new Coordinate(0, 0);\n\n    /** Describes the state of this connection's tracked-ness. */\n    this.trackedState = RenderedConnection.TrackedState.WILL_TRACK;\n  }\n\n  /**\n   * Dispose of this connection. Remove it from the database (if it is\n   * tracked) and call the super-function to deal with connected blocks.\n   *\n   * @internal\n   */\n  override dispose() {\n    super.dispose();\n    if (this.trackedState === RenderedConnection.TrackedState.TRACKED) {\n      this.db.removeConnection(this, this.y);\n    }\n    this.sourceBlock_.pathObject.removeConnectionHighlight?.(this);\n  }\n\n  /**\n   * Get the source block for this connection.\n   *\n   * @returns The source block.\n   */\n  override getSourceBlock(): BlockSvg {\n    return super.getSourceBlock() as BlockSvg;\n  }\n\n  /**\n   * Returns the block that this connection connects to.\n   *\n   * @returns The connected block or null if none is connected.\n   */\n  override targetBlock(): BlockSvg | null {\n    return super.targetBlock() as BlockSvg;\n  }\n\n  /**\n   * Returns the distance between this connection and another connection in\n   * workspace units.\n   *\n   * @param otherConnection The other connection to measure the distance to.\n   * @returns The distance between connections, in workspace units.\n   */\n  distanceFrom(otherConnection: Connection): number {\n    const xDiff = this.x - otherConnection.x;\n    const yDiff = this.y - otherConnection.y;\n    return Math.sqrt(xDiff * xDiff + yDiff * yDiff);\n  }\n\n  /**\n   * Move the block(s) belonging to the connection to a point where they don't\n   * visually interfere with the specified connection.\n   *\n   * @param staticConnection The connection to move away from.\n   * @internal\n   */\n  bumpAwayFrom(staticConnection: RenderedConnection) {\n    if (this.sourceBlock_.workspace.isDragging()) {\n      // Don't move blocks around while the user is doing the same.\n      return;\n    }\n    // Move the root block.\n    let rootBlock = this.sourceBlock_.getRootBlock();\n    if (rootBlock.isInFlyout) {\n      // Don't move blocks around in a flyout.\n      return;\n    }\n    let reverse = false;\n    if (!rootBlock.isMovable()) {\n      // Can't bump an uneditable block away.\n      // Check to see if the other block is movable.\n      rootBlock = staticConnection.getSourceBlock().getRootBlock();\n      if (!rootBlock.isMovable()) {\n        return;\n      }\n      // Swap the connections and move the 'static' connection instead.\n      /* eslint-disable-next-line @typescript-eslint/no-this-alias */\n      staticConnection = this;\n      reverse = true;\n    }\n    // Raise it to the top for extra visibility.\n    const selected = common.getSelected() == rootBlock;\n    selected || rootBlock.addSelect();\n    let dx =\n      staticConnection.x +\n      config.snapRadius +\n      Math.floor(Math.random() * BUMP_RANDOMNESS) -\n      this.x;\n    let dy =\n      staticConnection.y +\n      config.snapRadius +\n      Math.floor(Math.random() * BUMP_RANDOMNESS) -\n      this.y;\n    if (reverse) {\n      // When reversing a bump due to an uneditable block, bump up.\n      dy = -dy;\n    }\n    if (rootBlock.RTL) {\n      dx =\n        staticConnection.x -\n        config.snapRadius -\n        Math.floor(Math.random() * BUMP_RANDOMNESS) -\n        this.x;\n    }\n    rootBlock.moveBy(dx, dy, ['bump']);\n    selected || rootBlock.removeSelect();\n  }\n\n  /**\n   * Change the connection's coordinates.\n   *\n   * @param x New absolute x coordinate, in workspace coordinates.\n   * @param y New absolute y coordinate, in workspace coordinates.\n   * @returns True if the position of the connection in the connection db\n   *     was updated.\n   */\n  moveTo(x: number, y: number): boolean {\n    // TODO(#6922): Readd this optimization.\n    // const moved = this.x !== x || this.y !== y;\n    const moved = true;\n    let updated = false;\n\n    if (this.trackedState === RenderedConnection.TrackedState.WILL_TRACK) {\n      this.db.addConnection(this, y);\n      this.trackedState = RenderedConnection.TrackedState.TRACKED;\n      updated = true;\n    } else if (\n      this.trackedState === RenderedConnection.TrackedState.TRACKED &&\n      moved\n    ) {\n      this.db.removeConnection(this, this.y);\n      this.db.addConnection(this, y);\n      updated = true;\n    }\n\n    this.x = x;\n    this.y = y;\n\n    return updated;\n  }\n\n  /**\n   * Change the connection's coordinates.\n   *\n   * @param dx Change to x coordinate, in workspace units.\n   * @param dy Change to y coordinate, in workspace units.\n   * @returns True if the position of the connection in the connection db\n   *     was updated.\n   */\n  moveBy(dx: number, dy: number): boolean {\n    return this.moveTo(this.x + dx, this.y + dy);\n  }\n\n  /**\n   * Move this connection to the location given by its offset within the block\n   * and the location of the block's top left corner.\n   *\n   * @param blockTL The location of the top left corner of the block, in\n   *     workspace coordinates.\n   * @returns True if the position of the connection in the connection db\n   *     was updated.\n   */\n  moveToOffset(blockTL: Coordinate): boolean {\n    return this.moveTo(\n      blockTL.x + this.offsetInBlock.x,\n      blockTL.y + this.offsetInBlock.y,\n    );\n  }\n\n  /**\n   * Set the offset of this connection relative to the top left of its block.\n   *\n   * @param x The new relative x, in workspace units.\n   * @param y The new relative y, in workspace units.\n   */\n  setOffsetInBlock(x: number, y: number) {\n    this.offsetInBlock.x = x;\n    this.offsetInBlock.y = y;\n  }\n\n  /**\n   * Get the offset of this connection relative to the top left of its block.\n   *\n   * @returns The offset of the connection.\n   */\n  getOffsetInBlock(): Coordinate {\n    return this.offsetInBlock;\n  }\n\n  /**\n   * Moves the blocks on either side of this connection right next to\n   * each other, based on their local offsets, not global positions.\n   *\n   * @internal\n   */\n  tightenEfficiently() {\n    const target = this.targetConnection;\n    const block = this.targetBlock();\n    if (!target || !block) return;\n    const offset = Coordinate.difference(\n      this.offsetInBlock,\n      target.offsetInBlock,\n    );\n    block.translate(offset.x, offset.y);\n  }\n\n  /**\n   * Find the closest compatible connection to this connection.\n   * All parameters are in workspace units.\n   *\n   * @param maxLimit The maximum radius to another connection.\n   * @param dxy Offset between this connection's location in the database and\n   *     the current location (as a result of dragging).\n   * @returns Contains two properties: 'connection' which is either another\n   *     connection or null, and 'radius' which is the distance.\n   */\n  closest(\n    maxLimit: number,\n    dxy: Coordinate,\n  ): {connection: RenderedConnection | null; radius: number} {\n    return this.dbOpposite.searchForClosest(this, maxLimit, dxy);\n  }\n\n  /** Add highlighting around this connection. */\n  highlight() {\n    this.highlighted = true;\n    this.getSourceBlock().queueRender();\n  }\n\n  /** Remove the highlighting around this connection. */\n  unhighlight() {\n    this.highlighted = false;\n    this.getSourceBlock().queueRender();\n  }\n\n  /** Returns true if this connection is highlighted, false otherwise. */\n  isHighlighted(): boolean {\n    return this.highlighted;\n  }\n\n  /**\n   * Set whether this connections is tracked in the database or not.\n   *\n   * @param doTracking If true, start tracking. If false, stop tracking.\n   * @internal\n   */\n  setTracking(doTracking: boolean) {\n    if (\n      (doTracking &&\n        this.trackedState === RenderedConnection.TrackedState.TRACKED) ||\n      (!doTracking &&\n        this.trackedState === RenderedConnection.TrackedState.UNTRACKED)\n    ) {\n      return;\n    }\n    if (this.sourceBlock_.isInFlyout) {\n      // Don't bother maintaining a database of connections in a flyout.\n      return;\n    }\n    if (doTracking) {\n      this.db.addConnection(this, this.y);\n      this.trackedState = RenderedConnection.TrackedState.TRACKED;\n      return;\n    }\n    if (this.trackedState === RenderedConnection.TrackedState.TRACKED) {\n      this.db.removeConnection(this, this.y);\n    }\n    this.trackedState = RenderedConnection.TrackedState.UNTRACKED;\n  }\n\n  /**\n   * Stop tracking this connection, as well as all down-stream connections on\n   * any block attached to this connection. This happens when a block is\n   * collapsed.\n   *\n   * Also closes down-stream icons/bubbles.\n   *\n   * @internal\n   */\n  stopTrackingAll() {\n    this.setTracking(false);\n    if (this.targetConnection) {\n      const blocks = this.targetBlock()!.getDescendants(false);\n      for (let i = 0; i < blocks.length; i++) {\n        const block = blocks[i];\n        // Stop tracking connections of all children.\n        const connections = block.getConnections_(true);\n        for (let j = 0; j < connections.length; j++) {\n          connections[j].setTracking(false);\n        }\n        // Close all bubbles of all children.\n        for (const icon of block.getIcons()) {\n          if (hasBubble(icon)) icon.setBubbleVisible(false);\n        }\n      }\n    }\n  }\n\n  /**\n   * Start tracking this connection, as well as all down-stream connections on\n   * any block attached to this connection. This happens when a block is\n   * expanded.\n   *\n   * @returns List of blocks to render.\n   */\n  startTrackingAll(): Block[] {\n    this.setTracking(true);\n    // All blocks that are not tracked must start tracking before any\n    // rendering takes place, since rendering requires knowing the dimensions\n    // of lower blocks. Also, since rendering a block renders all its parents,\n    // we only need to render the leaf nodes.\n    let renderList: Block[] = [];\n    if (\n      this.type !== ConnectionType.INPUT_VALUE &&\n      this.type !== ConnectionType.NEXT_STATEMENT\n    ) {\n      // Only spider down.\n      return renderList;\n    }\n    const block = this.targetBlock();\n    if (block) {\n      let connections;\n      if (block.isCollapsed()) {\n        // This block should only be partially revealed since it is collapsed.\n        connections = [];\n        block.outputConnection && connections.push(block.outputConnection);\n        block.nextConnection && connections.push(block.nextConnection);\n        block.previousConnection && connections.push(block.previousConnection);\n      } else {\n        // Show all connections of this block.\n        connections = block.getConnections_(true);\n      }\n      for (let i = 0; i < connections.length; i++) {\n        renderList.push(...connections[i].startTrackingAll());\n      }\n      if (!renderList.length) {\n        // Leaf block.\n        renderList = [block];\n      }\n    }\n    return renderList;\n  }\n\n  /**\n   * Behaviour after a connection attempt fails.\n   * Bumps this connection away from the other connection. Called when an\n   * attempted connection fails.\n   *\n   * @param otherConnection Connection that this connection failed to connect\n   *     to.\n   * @internal\n   */\n  override onFailedConnect(otherConnection: Connection) {\n    const block = this.getSourceBlock();\n    if (eventUtils.getRecordUndo()) {\n      const group = eventUtils.getGroup();\n      setTimeout(\n        function (this: RenderedConnection) {\n          if (!block.isDisposed() && !block.getParent()) {\n            eventUtils.setGroup(group);\n            this.bumpAwayFrom(otherConnection as RenderedConnection);\n            eventUtils.setGroup(false);\n          }\n        }.bind(this),\n        config.bumpDelay,\n      );\n    }\n  }\n\n  /**\n   * Disconnect two blocks that are connected by this connection.\n   *\n   * @param setParent Whether to set the parent of the disconnected block or\n   *     not, defaults to true.\n   *     If you do not set the parent, ensure that a subsequent action does,\n   *     otherwise the view and model will be out of sync.\n   */\n  override disconnectInternal(setParent = true) {\n    const {parentConnection, childConnection} =\n      this.getParentAndChildConnections();\n    if (!parentConnection || !childConnection) return;\n    const parent = parentConnection.getSourceBlock() as BlockSvg;\n    const child = childConnection.getSourceBlock() as BlockSvg;\n    super.disconnectInternal(setParent);\n    // Rerender the parent so that it may reflow.\n    if (parent.rendered) {\n      parent.queueRender();\n    }\n    if (child.rendered) {\n      child.updateDisabled();\n      child.queueRender();\n      // Reset visibility, since the child is now a top block.\n      child.getSvgRoot().style.display = 'block';\n    }\n  }\n\n  /**\n   * Respawn the shadow block if there was one connected to the this connection.\n   * Render/rerender blocks as needed.\n   */\n  protected override respawnShadow_() {\n    super.respawnShadow_();\n    const blockShadow = this.targetBlock();\n    if (!blockShadow) {\n      return;\n    }\n    blockShadow.initSvg();\n    blockShadow.queueRender();\n  }\n\n  /**\n   * Find all nearby compatible connections to this connection.\n   * Type checking does not apply, since this function is used for bumping.\n   *\n   * @param maxLimit The maximum radius to another connection, in workspace\n   *     units.\n   * @returns List of connections.\n   * @internal\n   */\n  override neighbours(maxLimit: number): RenderedConnection[] {\n    return this.dbOpposite.getNeighbours(this, maxLimit);\n  }\n\n  /**\n   * Connect two connections together.  This is the connection on the superior\n   * block.  Rerender blocks as needed.\n   *\n   * @param childConnection Connection on inferior block.\n   */\n  protected override connect_(childConnection: Connection) {\n    super.connect_(childConnection);\n\n    const renderedChildConnection = childConnection as RenderedConnection;\n\n    const parentBlock = this.getSourceBlock();\n    const childBlock = renderedChildConnection.getSourceBlock();\n    const parentRendered = parentBlock.rendered;\n    const childRendered = childBlock.rendered;\n\n    if (parentRendered) {\n      parentBlock.updateDisabled();\n    }\n    if (childRendered) {\n      childBlock.updateDisabled();\n    }\n    if (parentRendered && childRendered) {\n      if (\n        this.type === ConnectionType.NEXT_STATEMENT ||\n        this.type === ConnectionType.PREVIOUS_STATEMENT\n      ) {\n        // Child block may need to square off its corners if it is in a stack.\n        // Rendering a child will render its parent.\n        childBlock.queueRender();\n      } else {\n        // Child block does not change shape.  Rendering the parent node will\n        // move its connected children into position.\n        parentBlock.queueRender();\n      }\n    }\n\n    // The input the child block is connected to (if any).\n    const parentInput = parentBlock.getInputWithBlock(childBlock);\n    if (parentInput) {\n      const visible = parentInput.isVisible();\n      childBlock.getSvgRoot().style.display = visible ? 'block' : 'none';\n    }\n  }\n\n  /**\n   * Function to be called when this connection's compatible types have changed.\n   */\n  protected override onCheckChanged_() {\n    // The new value type may not be compatible with the existing connection.\n    if (\n      this.isConnected() &&\n      (!this.targetConnection ||\n        !this.getConnectionChecker().canConnect(\n          this,\n          this.targetConnection,\n          false,\n        ))\n    ) {\n      const child = this.isSuperior() ? this.targetBlock() : this.sourceBlock_;\n      child!.unplug();\n      // Bump away.\n      this.sourceBlock_.bumpNeighbours();\n    }\n  }\n\n  /**\n   * Change a connection's compatibility.\n   * Rerender blocks as needed.\n   *\n   * @param check Compatible value type or list of value types. Null if all\n   *     types are compatible.\n   * @returns The connection being modified (to allow chaining).\n   */\n  override setCheck(check: string | string[] | null): RenderedConnection {\n    super.setCheck(check);\n    if (this.sourceBlock_.rendered) {\n      this.sourceBlock_.queueRender();\n    }\n    return this;\n  }\n}\n\nexport namespace RenderedConnection {\n  /**\n   * Enum for different kinds of tracked states.\n   *\n   * WILL_TRACK means that this connection will add itself to\n   * the db on the next moveTo call it receives.\n   *\n   * UNTRACKED means that this connection will not add\n   * itself to the database until setTracking(true) is explicitly called.\n   *\n   * TRACKED means that this connection is currently being tracked.\n   */\n  export enum TrackedState {\n    WILL_TRACK = -1,\n    UNTRACKED = 0,\n    TRACKED = 1,\n  }\n}\n\nexport type TrackedState = RenderedConnection.TrackedState;\nexport const TrackedState = RenderedConnection.TrackedState;\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Methods for graphically rendering a block as SVG.\n *\n * @class\n */\n// Former goog.module ID: Blockly.BlockSvg\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_selected.js';\n\nimport {Block} from './block.js';\nimport * as blockAnimations from './block_animations.js';\nimport * as browserEvents from './browser_events.js';\nimport {CommentIcon} from './icons/comment_icon.js';\nimport * as common from './common.js';\nimport {config} from './config.js';\nimport type {Connection} from './connection.js';\nimport {ConnectionType} from './connection_type.js';\nimport * as constants from './constants.js';\nimport * as ContextMenu from './contextmenu.js';\nimport {\n  ContextMenuOption,\n  ContextMenuRegistry,\n  LegacyContextMenuOption,\n} from './contextmenu_registry.js';\nimport type {BlockMove} from './events/events_block_move.js';\nimport * as eventUtils from './events/utils.js';\nimport type {Field} from './field.js';\nimport {FieldLabel} from './field_label.js';\nimport type {Input} from './inputs/input.js';\nimport type {IASTNodeLocationSvg} from './interfaces/i_ast_node_location_svg.js';\nimport type {IBoundedElement} from './interfaces/i_bounded_element.js';\nimport type {ICopyable} from './interfaces/i_copyable.js';\nimport type {IDraggable} from './interfaces/i_draggable.js';\nimport {IIcon} from './interfaces/i_icon.js';\nimport * as internalConstants from './internal_constants.js';\nimport {ASTNode} from './keyboard_nav/ast_node.js';\nimport {TabNavigateCursor} from './keyboard_nav/tab_navigate_cursor.js';\nimport {MarkerManager} from './marker_manager.js';\nimport {Msg} from './msg.js';\nimport {MutatorIcon} from './icons/mutator_icon.js';\nimport {RenderedConnection} from './rendered_connection.js';\nimport type {IPathObject} from './renderers/common/i_path_object.js';\nimport * as blocks from './serialization/blocks.js';\nimport type {BlockStyle} from './theme.js';\nimport * as Tooltip from './tooltip.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport {Rect} from './utils/rect.js';\nimport {Svg} from './utils/svg.js';\nimport * as svgMath from './utils/svg_math.js';\nimport {WarningIcon} from './icons/warning_icon.js';\nimport type {Workspace} from './workspace.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport * as renderManagement from './render_management.js';\nimport * as deprecation from './utils/deprecation.js';\nimport {IconType} from './icons/icon_types.js';\nimport {BlockCopyData, BlockPaster} from './clipboard/block_paster.js';\n\n/**\n * Class for a block's SVG representation.\n * Not normally called directly, workspace.newBlock() is preferred.\n */\nexport class BlockSvg\n  extends Block\n  implements\n    IASTNodeLocationSvg,\n    IBoundedElement,\n    ICopyable<BlockCopyData>,\n    IDraggable\n{\n  /**\n   * Constant for identifying rows that are to be rendered inline.\n   * Don't collide with Blockly.inputTypes.\n   */\n  static readonly INLINE = -1;\n\n  /**\n   * ID to give the \"collapsed warnings\" warning. Allows us to remove the\n   * \"collapsed warnings\" warning without removing any warnings that belong to\n   * the block.\n   */\n  static readonly COLLAPSED_WARNING_ID = 'TEMP_COLLAPSED_WARNING_';\n  override decompose?: (p1: Workspace) => BlockSvg;\n  // override compose?: ((p1: BlockSvg) => void)|null;\n  saveConnections?: (p1: BlockSvg) => void;\n  customContextMenu?: (\n    p1: Array<ContextMenuOption | LegacyContextMenuOption>,\n  ) => void;\n\n  /**\n   * Height of this block, not including any statement blocks above or below.\n   * Height is in workspace units.\n   */\n  height = 0;\n\n  /**\n   * Width of this block, including any connected value blocks.\n   * Width is in workspace units.\n   */\n  width = 0;\n\n  /**\n   * Map from IDs for warnings text to PIDs of functions to apply them.\n   * Used to be able to maintain multiple warnings.\n   */\n  private warningTextDb = new Map<string, ReturnType<typeof setTimeout>>();\n\n  /** Block's mutator icon (if any). */\n  mutator: MutatorIcon | null = null;\n\n  /**\n   * Block's warning icon (if any).\n   *\n   * @deprecated Use `setWarningText` to modify warnings on this block.\n   */\n  warning: WarningIcon | null = null;\n\n  private svgGroup_: SVGGElement;\n  style: BlockStyle;\n  /** @internal */\n  pathObject: IPathObject;\n  override rendered = false;\n  private visuallyDisabled = false;\n\n  /**\n   * Is this block currently rendering? Used to stop recursive render calls\n   * from actually triggering a re-render.\n   */\n  private renderIsInProgress_ = false;\n\n  /** Whether mousedown events have been bound yet. */\n  private eventsInit_ = false;\n\n  override workspace: WorkspaceSvg;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  override outputConnection!: RenderedConnection;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  override nextConnection!: RenderedConnection;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  override previousConnection!: RenderedConnection;\n\n  private translation = '';\n\n  /**\n   * The ID of the setTimeout callback for bumping neighbours, or 0 if no bump\n   * is currently scheduled.\n   */\n  private bumpNeighboursPid = 0;\n\n  /** Whether this block is currently being dragged. */\n  private dragging = false;\n\n  /**\n   * The location of the top left of this block (in workspace coordinates)\n   * relative to either its parent block, or the workspace origin if it has no\n   * parent.\n   *\n   * @internal\n   */\n  relativeCoords = new Coordinate(0, 0);\n\n  /**\n   * @param workspace The block's workspace.\n   * @param prototypeName Name of the language object containing type-specific\n   *     functions for this block.\n   * @param opt_id Optional ID.  Use this ID if provided, otherwise create a new\n   *     ID.\n   */\n  constructor(workspace: WorkspaceSvg, prototypeName: string, opt_id?: string) {\n    super(workspace, prototypeName, opt_id);\n    this.workspace = workspace;\n    this.svgGroup_ = dom.createSvgElement(Svg.G, {});\n\n    /** A block style object. */\n    this.style = workspace.getRenderer().getConstants().getBlockStyle(null);\n\n    /** The renderer's path object. */\n    this.pathObject = workspace\n      .getRenderer()\n      .makePathObject(this.svgGroup_, this.style);\n\n    const svgPath = this.pathObject.svgPath;\n    (svgPath as any).tooltip = this;\n    Tooltip.bindMouseEvents(svgPath);\n\n    // Expose this block's ID on its top-level SVG group.\n    this.svgGroup_.setAttribute('data-id', this.id);\n\n    this.doInit_();\n  }\n\n  /**\n   * Create and initialize the SVG representation of the block.\n   * May be called more than once.\n   */\n  initSvg() {\n    if (!this.workspace.rendered) {\n      throw TypeError('Workspace is headless.');\n    }\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      input.init();\n    }\n    for (const icon of this.getIcons()) {\n      icon.initView(this.createIconPointerDownListener(icon));\n      icon.updateEditable();\n    }\n    this.applyColour();\n    this.pathObject.updateMovable(this.isMovable());\n    const svg = this.getSvgRoot();\n    if (!this.workspace.options.readOnly && !this.eventsInit_ && svg) {\n      browserEvents.conditionalBind(\n        svg,\n        'pointerdown',\n        this,\n        this.onMouseDown_,\n      );\n    }\n    this.eventsInit_ = true;\n\n    if (!svg.parentNode) {\n      this.workspace.getCanvas().appendChild(svg);\n    }\n  }\n\n  /**\n   * Get the secondary colour of a block.\n   *\n   * @returns #RRGGBB string.\n   */\n  getColourSecondary(): string | undefined {\n    return this.style.colourSecondary;\n  }\n\n  /**\n   * Get the tertiary colour of a block.\n   *\n   * @returns #RRGGBB string.\n   */\n  getColourTertiary(): string | undefined {\n    return this.style.colourTertiary;\n  }\n\n  /**\n   * Selects this block. Highlights the block visually and fires a select event\n   * if the block is not already selected.\n   */\n  select() {\n    if (this.isShadow() && this.getParent()) {\n      // Shadow blocks should not be selected.\n      this.getParent()!.select();\n      return;\n    }\n    if (common.getSelected() === this) {\n      return;\n    }\n    let oldId = null;\n    if (common.getSelected()) {\n      oldId = common.getSelected()!.id;\n      // Unselect any previously selected block.\n      eventUtils.disable();\n      try {\n        common.getSelected()!.unselect();\n      } finally {\n        eventUtils.enable();\n      }\n    }\n    const event = new (eventUtils.get(eventUtils.SELECTED))(\n      oldId,\n      this.id,\n      this.workspace.id,\n    );\n    eventUtils.fire(event);\n    common.setSelected(this);\n    this.addSelect();\n  }\n\n  /**\n   * Unselects this block. Unhighlights the block and fires a select (false)\n   * event if the block is currently selected.\n   */\n  unselect() {\n    if (common.getSelected() !== this) {\n      return;\n    }\n    const event = new (eventUtils.get(eventUtils.SELECTED))(\n      this.id,\n      null,\n      this.workspace.id,\n    );\n    event.workspaceId = this.workspace.id;\n    eventUtils.fire(event);\n    common.setSelected(null);\n    this.removeSelect();\n  }\n\n  /**\n   * Sets the parent of this block to be a new block or null.\n   *\n   * @param newParent New parent block.\n   * @internal\n   */\n  override setParent(newParent: this | null) {\n    const oldParent = this.parentBlock_;\n    if (newParent === oldParent) {\n      return;\n    }\n\n    dom.startTextWidthCache();\n    super.setParent(newParent);\n    dom.stopTextWidthCache();\n\n    const svgRoot = this.getSvgRoot();\n\n    // Bail early if workspace is clearing, or we aren't rendered.\n    // We won't need to reattach ourselves anywhere.\n    if (this.workspace.isClearing || !svgRoot) {\n      return;\n    }\n\n    const oldXY = this.getRelativeToSurfaceXY();\n    if (newParent) {\n      (newParent as BlockSvg).getSvgRoot().appendChild(svgRoot);\n    } else if (oldParent) {\n      // If we are losing a parent, we want to move our DOM element to the\n      // root of the workspace.\n      const draggingBlock = this.workspace\n        .getCanvas()\n        .querySelector('.blocklyDragging');\n      if (draggingBlock) {\n        this.workspace.getCanvas().insertBefore(svgRoot, draggingBlock);\n      } else {\n        this.workspace.getCanvas().appendChild(svgRoot);\n      }\n      this.translate(oldXY.x, oldXY.y);\n    }\n\n    this.applyColour();\n  }\n\n  /**\n   * Return the coordinates of the top-left corner of this block relative to the\n   * drawing surface's origin (0,0), in workspace units.\n   * If the block is on the workspace, (0, 0) is the origin of the workspace\n   * coordinate system.\n   * This does not change with workspace scale.\n   *\n   * @returns Object with .x and .y properties in workspace coordinates.\n   */\n  override getRelativeToSurfaceXY(): Coordinate {\n    const layerManger = this.workspace.getLayerManager();\n    if (!layerManger) {\n      throw new Error(\n        'Cannot calculate position because the workspace has not been appended',\n      );\n    }\n    let x = 0;\n    let y = 0;\n\n    let element: SVGElement = this.getSvgRoot();\n    if (element) {\n      do {\n        // Loop through this block and every parent.\n        const xy = svgMath.getRelativeXY(element);\n        x += xy.x;\n        y += xy.y;\n        element = element.parentNode as SVGElement;\n      } while (element && !layerManger.hasLayer(element));\n    }\n    return new Coordinate(x, y);\n  }\n\n  /**\n   * Move a block by a relative offset.\n   *\n   * @param dx Horizontal offset in workspace units.\n   * @param dy Vertical offset in workspace units.\n   * @param reason Why is this move happening?  'drag', 'bump', 'snap', ...\n   */\n  override moveBy(dx: number, dy: number, reason?: string[]) {\n    if (this.parentBlock_) {\n      throw Error('Block has parent');\n    }\n    const eventsEnabled = eventUtils.isEnabled();\n    let event: BlockMove | null = null;\n    if (eventsEnabled) {\n      event = new (eventUtils.get(eventUtils.BLOCK_MOVE)!)(this) as BlockMove;\n      reason && event.setReason(reason);\n    }\n\n    const delta = new Coordinate(dx, dy);\n    const currLoc = this.getRelativeToSurfaceXY();\n    const newLoc = Coordinate.sum(currLoc, delta);\n    this.translate(newLoc.x, newLoc.y);\n    this.updateComponentLocations(newLoc);\n\n    if (eventsEnabled && event) {\n      event!.recordNew();\n      eventUtils.fire(event);\n    }\n    this.workspace.resizeContents();\n  }\n\n  /**\n   * Transforms a block by setting the translation on the transform attribute\n   * of the block's SVG.\n   *\n   * @param x The x coordinate of the translation in workspace units.\n   * @param y The y coordinate of the translation in workspace units.\n   */\n  translate(x: number, y: number) {\n    this.translation = `translate(${x}, ${y})`;\n    this.relativeCoords = new Coordinate(x, y);\n    this.getSvgRoot().setAttribute('transform', this.getTranslation());\n  }\n\n  /**\n   * Returns the SVG translation of this block.\n   *\n   * @internal\n   */\n  getTranslation(): string {\n    return this.translation;\n  }\n\n  /**\n   * Move a block to a position.\n   *\n   * @param xy The position to move to in workspace units.\n   * @param reason Why is this move happening?  'drag', 'bump', 'snap', ...\n   */\n  moveTo(xy: Coordinate, reason?: string[]) {\n    const curXY = this.getRelativeToSurfaceXY();\n    this.moveBy(xy.x - curXY.x, xy.y - curXY.y, reason);\n  }\n\n  /**\n   * Move this block during a drag.\n   * This block must be a top-level block.\n   *\n   * @param newLoc The location to translate to, in workspace coordinates.\n   * @internal\n   */\n  moveDuringDrag(newLoc: Coordinate) {\n    this.translate(newLoc.x, newLoc.y);\n    this.getSvgRoot().setAttribute('transform', this.getTranslation());\n    this.updateComponentLocations(newLoc);\n  }\n\n  /** Snap this block to the nearest grid point. */\n  snapToGrid() {\n    if (this.isDeadOrDying()) {\n      return; // Deleted block.\n    }\n    if (this.workspace.isDragging()) {\n      return; // Don't bump blocks during a drag.\n    }\n\n    if (this.getParent()) {\n      return; // Only snap top-level blocks.\n    }\n    if (this.isInFlyout) {\n      return; // Don't move blocks around in a flyout.\n    }\n    const grid = this.workspace.getGrid();\n    if (!grid || !grid.shouldSnap()) {\n      return; // Config says no snapping.\n    }\n    const spacing = grid.getSpacing();\n    const half = spacing / 2;\n    const xy = this.getRelativeToSurfaceXY();\n    const dx = Math.round(\n      Math.round((xy.x - half) / spacing) * spacing + half - xy.x,\n    );\n    const dy = Math.round(\n      Math.round((xy.y - half) / spacing) * spacing + half - xy.y,\n    );\n    if (dx || dy) {\n      this.moveBy(dx, dy, ['snap']);\n    }\n  }\n\n  /**\n   * Returns the coordinates of a bounding box describing the dimensions of this\n   * block and any blocks stacked below it.\n   * Coordinate system: workspace coordinates.\n   *\n   * @returns Object with coordinates of the bounding box.\n   */\n  getBoundingRectangle(): Rect {\n    const blockXY = this.getRelativeToSurfaceXY();\n    const blockBounds = this.getHeightWidth();\n    let left;\n    let right;\n    if (this.RTL) {\n      left = blockXY.x - blockBounds.width;\n      right = blockXY.x;\n    } else {\n      left = blockXY.x;\n      right = blockXY.x + blockBounds.width;\n    }\n    return new Rect(blockXY.y, blockXY.y + blockBounds.height, left, right);\n  }\n\n  /**\n   * Notify every input on this block to mark its fields as dirty.\n   * A dirty field is a field that needs to be re-rendered.\n   */\n  markDirty() {\n    this.pathObject.constants = this.workspace.getRenderer().getConstants();\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      input.markDirty();\n    }\n  }\n\n  /**\n   * Set whether the block is collapsed or not.\n   *\n   * @param collapsed True if collapsed.\n   */\n  override setCollapsed(collapsed: boolean) {\n    if (this.collapsed_ === collapsed) {\n      return;\n    }\n    super.setCollapsed(collapsed);\n    this.updateCollapsed_();\n  }\n\n  /**\n   * Makes sure that when the block is collapsed, it is rendered correctly\n   * for that state.\n   */\n  private updateCollapsed_() {\n    const collapsed = this.isCollapsed();\n    const collapsedInputName = constants.COLLAPSED_INPUT_NAME;\n    const collapsedFieldName = constants.COLLAPSED_FIELD_NAME;\n\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      if (input.name !== collapsedInputName) {\n        input.setVisible(!collapsed);\n      }\n    }\n\n    for (const icon of this.getIcons()) {\n      icon.updateCollapsed();\n    }\n\n    if (!collapsed) {\n      this.updateDisabled();\n      this.removeInput(collapsedInputName);\n      return;\n    }\n\n    const text = this.toString(internalConstants.COLLAPSE_CHARS);\n    const field = this.getField(collapsedFieldName);\n    if (field) {\n      field.setValue(text);\n      return;\n    }\n    const input =\n      this.getInput(collapsedInputName) ||\n      this.appendDummyInput(collapsedInputName);\n    input.appendField(new FieldLabel(text), collapsedFieldName);\n  }\n\n  /**\n   * Open the next (or previous) FieldTextInput.\n   *\n   * @param start Current field.\n   * @param forward If true go forward, otherwise backward.\n   */\n  tab(start: Field, forward: boolean) {\n    const tabCursor = new TabNavigateCursor();\n    tabCursor.setCurNode(ASTNode.createFieldNode(start)!);\n    const currentNode = tabCursor.getCurNode();\n\n    if (forward) {\n      tabCursor.next();\n    } else {\n      tabCursor.prev();\n    }\n\n    const nextNode = tabCursor.getCurNode();\n    if (nextNode && nextNode !== currentNode) {\n      const nextField = nextNode.getLocation() as Field;\n      nextField.showEditor();\n\n      // Also move the cursor if we're in keyboard nav mode.\n      if (this.workspace.keyboardAccessibilityMode) {\n        this.workspace.getCursor()!.setCurNode(nextNode);\n      }\n    }\n  }\n\n  /**\n   * Handle a pointerdown on an SVG block.\n   *\n   * @param e Pointer down event.\n   */\n  private onMouseDown_(e: PointerEvent) {\n    const gesture = this.workspace.getGesture(e);\n    if (gesture) {\n      gesture.handleBlockStart(e, this);\n    }\n  }\n\n  /**\n   * Load the block's help page in a new window.\n   *\n   * @internal\n   */\n  showHelp() {\n    const url =\n      typeof this.helpUrl === 'function' ? this.helpUrl() : this.helpUrl;\n    if (url) {\n      window.open(url);\n    }\n  }\n\n  /**\n   * Generate the context menu for this block.\n   *\n   * @returns Context menu options or null if no menu.\n   */\n  protected generateContextMenu(): Array<\n    ContextMenuOption | LegacyContextMenuOption\n  > | null {\n    if (this.workspace.options.readOnly || !this.contextMenu) {\n      return null;\n    }\n    const menuOptions = ContextMenuRegistry.registry.getContextMenuOptions(\n      ContextMenuRegistry.ScopeType.BLOCK,\n      {block: this},\n    );\n\n    // Allow the block to add or modify menuOptions.\n    if (this.customContextMenu) {\n      this.customContextMenu(menuOptions);\n    }\n\n    return menuOptions;\n  }\n\n  /**\n   * Show the context menu for this block.\n   *\n   * @param e Mouse event.\n   * @internal\n   */\n  showContextMenu(e: Event) {\n    const menuOptions = this.generateContextMenu();\n\n    if (menuOptions && menuOptions.length) {\n      ContextMenu.show(e, menuOptions, this.RTL);\n      ContextMenu.setCurrentBlock(this);\n    }\n  }\n\n  /**\n   * Updates the locations of any parts of the block that need to know where\n   * they are (e.g. connections, icons).\n   *\n   * @param blockOrigin The top-left of this block in workspace coordinates.\n   * @internal\n   */\n  updateComponentLocations(blockOrigin: Coordinate) {\n    if (!this.rendered) {\n      // Rendering is required to lay out the blocks.\n      // This is probably an invisible block attached to a collapsed block.\n      return;\n    }\n\n    if (!this.dragging) this.updateConnectionLocations(blockOrigin);\n    this.updateIconLocations(blockOrigin);\n    this.updateFieldLocations(blockOrigin);\n\n    for (const child of this.getChildren(false)) {\n      child.updateComponentLocations(\n        Coordinate.sum(blockOrigin, child.relativeCoords),\n      );\n    }\n  }\n\n  private updateConnectionLocations(blockOrigin: Coordinate) {\n    for (const conn of this.getConnections_(false)) {\n      conn.moveToOffset(blockOrigin);\n    }\n  }\n\n  private updateIconLocations(blockOrigin: Coordinate) {\n    for (const icon of this.getIcons()) {\n      icon.onLocationChange(blockOrigin);\n    }\n  }\n\n  private updateFieldLocations(blockOrigin: Coordinate) {\n    for (const input of this.inputList) {\n      for (const field of input.fieldRow) {\n        field.onLocationChange(blockOrigin);\n      }\n    }\n  }\n\n  /**\n   * Recursively adds or removes the dragging class to this node and its\n   * children.\n   *\n   * @param adding True if adding, false if removing.\n   * @internal\n   */\n  setDragging(adding: boolean) {\n    this.dragging = adding;\n    if (adding) {\n      this.translation = '';\n      common.draggingConnections.push(...this.getConnections_(true));\n      dom.addClass(this.svgGroup_, 'blocklyDragging');\n    } else {\n      common.draggingConnections.length = 0;\n      dom.removeClass(this.svgGroup_, 'blocklyDragging');\n    }\n    // Recurse through all blocks attached under this one.\n    for (let i = 0; i < this.childBlocks_.length; i++) {\n      (this.childBlocks_[i] as BlockSvg).setDragging(adding);\n    }\n  }\n\n  /**\n   * Set whether this block is movable or not.\n   *\n   * @param movable True if movable.\n   */\n  override setMovable(movable: boolean) {\n    super.setMovable(movable);\n    this.pathObject.updateMovable(movable);\n  }\n\n  /**\n   * Set whether this block is editable or not.\n   *\n   * @param editable True if editable.\n   */\n  override setEditable(editable: boolean) {\n    super.setEditable(editable);\n    const icons = this.getIcons();\n    for (let i = 0; i < icons.length; i++) {\n      icons[i].updateEditable();\n    }\n  }\n\n  /**\n   * Sets whether this block is a shadow block or not.\n   * This method is internal and should not be called by users of Blockly. To\n   * create shadow blocks programmatically call connection.setShadowState\n   *\n   * @param shadow True if a shadow.\n   * @internal\n   */\n  override setShadow(shadow: boolean) {\n    super.setShadow(shadow);\n    this.applyColour();\n  }\n\n  /**\n   * Set whether this block is an insertion marker block or not.\n   * Once set this cannot be unset.\n   *\n   * @param insertionMarker True if an insertion marker.\n   * @internal\n   */\n  override setInsertionMarker(insertionMarker: boolean) {\n    if (this.isInsertionMarker_ === insertionMarker) {\n      return; // No change.\n    }\n    this.isInsertionMarker_ = insertionMarker;\n    if (this.isInsertionMarker_) {\n      this.setColour(\n        this.workspace.getRenderer().getConstants().INSERTION_MARKER_COLOUR,\n      );\n      this.pathObject.updateInsertionMarker(true);\n    }\n  }\n\n  /**\n   * Return the root node of the SVG or null if none exists.\n   *\n   * @returns The root SVG node (probably a group).\n   */\n  getSvgRoot(): SVGGElement {\n    return this.svgGroup_;\n  }\n\n  /**\n   * Dispose of this block.\n   *\n   * @param healStack If true, then try to heal any gap by connecting the next\n   *     statement with the previous statement.  Otherwise, dispose of all\n   *     children of this block.\n   * @param animate If true, show a disposal animation and sound.\n   */\n  override dispose(healStack?: boolean, animate?: boolean) {\n    if (this.isDeadOrDying()) return;\n\n    Tooltip.dispose();\n    ContextMenu.hide();\n\n    if (animate && this.rendered) {\n      this.unplug(healStack);\n      blockAnimations.disposeUiEffect(this);\n    }\n\n    super.dispose(!!healStack);\n    dom.removeNode(this.svgGroup_);\n  }\n\n  /**\n   * Disposes of this block without doing things required by the top block.\n   * E.g. does trigger UI effects, remove nodes, etc.\n   */\n  override disposeInternal() {\n    if (this.isDeadOrDying()) return;\n    super.disposeInternal();\n\n    this.rendered = false;\n\n    if (common.getSelected() === this) {\n      this.unselect();\n      this.workspace.cancelCurrentGesture();\n    }\n\n    [...this.warningTextDb.values()].forEach((n) => clearTimeout(n));\n    this.warningTextDb.clear();\n\n    this.getIcons().forEach((i) => i.dispose());\n  }\n\n  /**\n   * Delete a block and hide chaff when doing so. The block will not be deleted\n   * if it's in a flyout. This is called from the context menu and keyboard\n   * shortcuts as the full delete action. If you are disposing of a block from\n   * the workspace and don't need to perform flyout checks, handle event\n   * grouping, or hide chaff, then use `block.dispose()` directly.\n   */\n  checkAndDelete() {\n    if (this.workspace.isFlyout) {\n      return;\n    }\n    eventUtils.setGroup(true);\n    this.workspace.hideChaff();\n    if (this.outputConnection) {\n      // Do not attempt to heal rows\n      // (https://github.com/google/blockly/issues/4832)\n      this.dispose(false, true);\n    } else {\n      this.dispose(/* heal */ true, true);\n    }\n    eventUtils.setGroup(false);\n  }\n\n  /**\n   * Encode a block for copying.\n   *\n   * @returns Copy metadata, or null if the block is an insertion marker.\n   */\n  toCopyData(): BlockCopyData | null {\n    if (this.isInsertionMarker_) {\n      return null;\n    }\n    return {\n      paster: BlockPaster.TYPE,\n      blockState: blocks.save(this, {\n        addCoordinates: true,\n        addNextBlocks: false,\n      }) as blocks.State,\n      typeCounts: common.getBlockTypeCounts(this, true),\n    };\n  }\n\n  /**\n   * Updates the colour of the block to match the block's state.\n   *\n   * @internal\n   */\n  applyColour() {\n    this.pathObject.applyColour(this);\n\n    const icons = this.getIcons();\n    for (let i = 0; i < icons.length; i++) {\n      icons[i].applyColour();\n    }\n\n    for (let x = 0, input; (input = this.inputList[x]); x++) {\n      for (let y = 0, field; (field = input.fieldRow[y]); y++) {\n        field.applyColour();\n      }\n    }\n  }\n\n  /**\n   * Updates the colour of the block (and children) to match the current\n   * disabled state.\n   *\n   * @internal\n   */\n  updateDisabled() {\n    const disabled = !this.isEnabled() || this.getInheritedDisabled();\n\n    if (this.visuallyDisabled === disabled) {\n      this.getNextBlock()?.updateDisabled();\n      return;\n    }\n\n    this.applyColour();\n    this.visuallyDisabled = disabled;\n    for (const child of this.getChildren(false)) {\n      child.updateDisabled();\n    }\n  }\n\n  /**\n   * Get the comment icon attached to this block, or null if the block has no\n   * comment.\n   *\n   * @returns The comment icon attached to this block, or null.\n   * @deprecated Use getIcon. To be remove in v11.\n   */\n  getCommentIcon(): CommentIcon | null {\n    deprecation.warn('getCommentIcon', 'v10', 'v11', 'getIcon');\n    return (this.getIcon(CommentIcon.TYPE) ?? null) as CommentIcon | null;\n  }\n\n  /**\n   * Set this block's warning text.\n   *\n   * @param text The text, or null to delete.\n   * @param id An optional ID for the warning text to be able to maintain\n   *     multiple warnings.\n   */\n  override setWarningText(text: string | null, id: string = '') {\n    if (!id) {\n      // Kill all previous pending processes, this edit supersedes them all.\n      for (const timeout of this.warningTextDb.values()) {\n        clearTimeout(timeout);\n      }\n      this.warningTextDb.clear();\n    } else if (this.warningTextDb.has(id)) {\n      // Only queue up the latest change.  Kill any earlier pending process.\n      clearTimeout(this.warningTextDb.get(id)!);\n      this.warningTextDb.delete(id);\n    }\n    if (this.workspace.isDragging()) {\n      // Don't change the warning text during a drag.\n      // Wait until the drag finishes.\n      this.warningTextDb.set(\n        id,\n        setTimeout(() => {\n          if (!this.isDeadOrDying()) {\n            this.warningTextDb.delete(id);\n            this.setWarningText(text, id);\n          }\n        }, 100),\n      );\n      return;\n    }\n    if (this.isInFlyout) {\n      text = null;\n    }\n\n    const icon = this.getIcon(WarningIcon.TYPE) as WarningIcon | undefined;\n    if (text) {\n      // Bubble up to add a warning on top-most collapsed block.\n      // TODO(#6020): This warning is never removed.\n      let parent = this.getSurroundParent();\n      let collapsedParent = null;\n      while (parent) {\n        if (parent.isCollapsed()) {\n          collapsedParent = parent;\n        }\n        parent = parent.getSurroundParent();\n      }\n      if (collapsedParent) {\n        collapsedParent.setWarningText(\n          Msg['COLLAPSED_WARNINGS_WARNING'],\n          BlockSvg.COLLAPSED_WARNING_ID,\n        );\n      }\n\n      if (icon) {\n        (icon as WarningIcon).addMessage(text, id);\n      } else {\n        this.addIcon(new WarningIcon(this).addMessage(text, id));\n      }\n    } else if (icon) {\n      // Dispose all warnings if no ID is given.\n      if (!id) {\n        this.removeIcon(WarningIcon.TYPE);\n      } else {\n        // Remove just this warning id's message.\n        icon.addMessage('', id);\n        // Then remove the entire icon if there is no longer any text.\n        if (!icon.getText()) this.removeIcon(WarningIcon.TYPE);\n      }\n    }\n  }\n\n  /**\n   * Give this block a mutator dialog.\n   *\n   * @param mutator A mutator dialog instance or null to remove.\n   */\n  override setMutator(mutator: MutatorIcon | null) {\n    this.removeIcon(MutatorIcon.TYPE);\n    if (mutator) this.addIcon(mutator);\n  }\n\n  override addIcon<T extends IIcon>(icon: T): T {\n    super.addIcon(icon);\n\n    if (icon instanceof WarningIcon) this.warning = icon;\n    if (icon instanceof MutatorIcon) this.mutator = icon;\n\n    if (this.rendered) {\n      icon.initView(this.createIconPointerDownListener(icon));\n      icon.applyColour();\n      icon.updateEditable();\n      this.queueRender();\n      renderManagement.triggerQueuedRenders();\n      this.bumpNeighbours();\n    }\n\n    return icon;\n  }\n\n  /**\n   * Creates a pointer down event listener for the icon to append to its\n   * root svg.\n   */\n  private createIconPointerDownListener(icon: IIcon) {\n    return (e: PointerEvent) => {\n      if (this.isDeadOrDying()) return;\n      const gesture = this.workspace.getGesture(e);\n      if (gesture) {\n        gesture.setStartIcon(icon);\n      }\n    };\n  }\n\n  override removeIcon(type: IconType<IIcon>): boolean {\n    const removed = super.removeIcon(type);\n\n    if (type.equals(WarningIcon.TYPE)) this.warning = null;\n    if (type.equals(MutatorIcon.TYPE)) this.mutator = null;\n\n    if (this.rendered) {\n      this.queueRender();\n      renderManagement.triggerQueuedRenders();\n      this.bumpNeighbours();\n    }\n    return removed;\n  }\n\n  /**\n   * Set whether the block is enabled or not.\n   *\n   * @param enabled True if enabled.\n   */\n  override setEnabled(enabled: boolean) {\n    if (this.isEnabled() !== enabled) {\n      super.setEnabled(enabled);\n      if (this.rendered && !this.getInheritedDisabled()) {\n        this.updateDisabled();\n      }\n    }\n  }\n\n  /**\n   * Set whether the block is highlighted or not.  Block highlighting is\n   * often used to visually mark blocks currently being executed.\n   *\n   * @param highlighted True if highlighted.\n   */\n  setHighlighted(highlighted: boolean) {\n    if (!this.rendered) {\n      return;\n    }\n    this.pathObject.updateHighlighted(highlighted);\n  }\n\n  /**\n   * Adds the visual \"select\" effect to the block, but does not actually select\n   * it or fire an event.\n   *\n   * @see BlockSvg#select\n   */\n  addSelect() {\n    this.pathObject.updateSelected(true);\n  }\n\n  /**\n   * Removes the visual \"select\" effect from the block, but does not actually\n   * unselect it or fire an event.\n   *\n   * @see BlockSvg#unselect\n   */\n  removeSelect() {\n    this.pathObject.updateSelected(false);\n  }\n\n  /**\n   * Update the cursor over this block by adding or removing a class.\n   *\n   * @param enable True if the delete cursor should be shown, false otherwise.\n   * @internal\n   */\n  setDeleteStyle(enable: boolean) {\n    this.pathObject.updateDraggingDelete(enable);\n  }\n\n  // Overrides of functions on Blockly.Block that take into account whether the\n  // block has been rendered.\n\n  /**\n   * Get the colour of a block.\n   *\n   * @returns #RRGGBB string.\n   */\n  override getColour(): string {\n    return this.style.colourPrimary;\n  }\n\n  /**\n   * Change the colour of a block.\n   *\n   * @param colour HSV hue value, or #RRGGBB string.\n   */\n  override setColour(colour: number | string) {\n    super.setColour(colour);\n    const styleObj = this.workspace\n      .getRenderer()\n      .getConstants()\n      .getBlockStyleForColour(this.colour_);\n\n    this.pathObject.setStyle(styleObj.style);\n    this.style = styleObj.style;\n    this.styleName_ = styleObj.name;\n\n    this.applyColour();\n  }\n\n  /**\n   * Set the style and colour values of a block.\n   *\n   * @param blockStyleName Name of the block style.\n   * @throws {Error} if the block style does not exist.\n   */\n  override setStyle(blockStyleName: string) {\n    const blockStyle = this.workspace\n      .getRenderer()\n      .getConstants()\n      .getBlockStyle(blockStyleName);\n    this.styleName_ = blockStyleName;\n\n    if (blockStyle) {\n      this.hat = blockStyle.hat;\n      this.pathObject.setStyle(blockStyle);\n      // Set colour to match Block.\n      this.colour_ = blockStyle.colourPrimary;\n      this.style = blockStyle;\n\n      this.applyColour();\n    } else {\n      throw Error('Invalid style name: ' + blockStyleName);\n    }\n  }\n\n  /**\n   * Move this block to the front of the visible workspace.\n   * <g> tags do not respect z-index so SVG renders them in the\n   * order that they are in the DOM.  By placing this block first within the\n   * block group's <g>, it will render on top of any other blocks.\n   *\n   * @param blockOnly: True to only move this block to the front without\n   *     adjusting its parents.\n   * @internal\n   */\n  bringToFront(blockOnly = false) {\n    /* eslint-disable-next-line @typescript-eslint/no-this-alias */\n    let block: this | null = this;\n    if (block.isDeadOrDying()) {\n      return;\n    }\n    do {\n      const root = block.getSvgRoot();\n      const parent = root.parentNode;\n      const childNodes = parent!.childNodes;\n      // Avoid moving the block if it's already at the bottom.\n      if (childNodes[childNodes.length - 1] !== root) {\n        parent!.appendChild(root);\n      }\n      if (blockOnly) break;\n      block = block.getParent();\n    } while (block);\n  }\n\n  /**\n   * Set whether this block can chain onto the bottom of another block.\n   *\n   * @param newBoolean True if there can be a previous statement.\n   * @param opt_check Statement type or list of statement types.  Null/undefined\n   *     if any type could be connected.\n   */\n  override setPreviousStatement(\n    newBoolean: boolean,\n    opt_check?: string | string[] | null,\n  ) {\n    super.setPreviousStatement(newBoolean, opt_check);\n\n    if (this.rendered) {\n      this.queueRender();\n      this.bumpNeighbours();\n    }\n  }\n\n  /**\n   * Set whether another block can chain onto the bottom of this block.\n   *\n   * @param newBoolean True if there can be a next statement.\n   * @param opt_check Statement type or list of statement types.  Null/undefined\n   *     if any type could be connected.\n   */\n  override setNextStatement(\n    newBoolean: boolean,\n    opt_check?: string | string[] | null,\n  ) {\n    super.setNextStatement(newBoolean, opt_check);\n\n    if (this.rendered) {\n      this.queueRender();\n      this.bumpNeighbours();\n    }\n  }\n\n  /**\n   * Set whether this block returns a value.\n   *\n   * @param newBoolean True if there is an output.\n   * @param opt_check Returned type or list of returned types.  Null or\n   *     undefined if any type could be returned (e.g. variable get).\n   */\n  override setOutput(\n    newBoolean: boolean,\n    opt_check?: string | string[] | null,\n  ) {\n    super.setOutput(newBoolean, opt_check);\n\n    if (this.rendered) {\n      this.queueRender();\n      this.bumpNeighbours();\n    }\n  }\n\n  /**\n   * Set whether value inputs are arranged horizontally or vertically.\n   *\n   * @param newBoolean True if inputs are horizontal.\n   */\n  override setInputsInline(newBoolean: boolean) {\n    super.setInputsInline(newBoolean);\n\n    if (this.rendered) {\n      this.queueRender();\n      this.bumpNeighbours();\n    }\n  }\n\n  /**\n   * Remove an input from this block.\n   *\n   * @param name The name of the input.\n   * @param opt_quiet True to prevent error if input is not present.\n   * @returns True if operation succeeds, false if input is not present and\n   *     opt_quiet is true\n   * @throws {Error} if the input is not present and opt_quiet is not true.\n   */\n  override removeInput(name: string, opt_quiet?: boolean): boolean {\n    const removed = super.removeInput(name, opt_quiet);\n\n    if (this.rendered) {\n      this.queueRender();\n      // Removing an input will cause the block to change shape.\n      this.bumpNeighbours();\n    }\n\n    return removed;\n  }\n\n  /**\n   * Move a numbered input to a different location on this block.\n   *\n   * @param inputIndex Index of the input to move.\n   * @param refIndex Index of input that should be after the moved input.\n   */\n  override moveNumberedInputBefore(inputIndex: number, refIndex: number) {\n    super.moveNumberedInputBefore(inputIndex, refIndex);\n\n    if (this.rendered) {\n      this.queueRender();\n      // Moving an input will cause the block to change shape.\n      this.bumpNeighbours();\n    }\n  }\n\n  /** @override */\n  override appendInput(input: Input): Input {\n    super.appendInput(input);\n\n    if (this.rendered) {\n      this.queueRender();\n      // Adding an input will cause the block to change shape.\n      this.bumpNeighbours();\n    }\n    return input;\n  }\n\n  /**\n   * Sets whether this block's connections are tracked in the database or not.\n   *\n   * Used by the deserializer to be more efficient. Setting a connection's\n   * tracked_ value to false keeps it from adding itself to the db when it\n   * gets its first moveTo call, saving expensive ops for later.\n   *\n   * @param track If true, start tracking. If false, stop tracking.\n   * @internal\n   */\n  setConnectionTracking(track: boolean) {\n    if (this.previousConnection) {\n      this.previousConnection.setTracking(track);\n    }\n    if (this.outputConnection) {\n      this.outputConnection.setTracking(track);\n    }\n    if (this.nextConnection) {\n      this.nextConnection.setTracking(track);\n      const child = this.nextConnection.targetBlock();\n      if (child) {\n        child.setConnectionTracking(track);\n      }\n    }\n\n    if (this.collapsed_) {\n      // When track is true, we don't want to start tracking collapsed\n      // connections. When track is false, we're already not tracking\n      // collapsed connections, so no need to update.\n      return;\n    }\n\n    for (let i = 0; i < this.inputList.length; i++) {\n      const conn = this.inputList[i].connection as RenderedConnection;\n      if (conn) {\n        conn.setTracking(track);\n\n        // Pass tracking on down the chain.\n        const block = conn.targetBlock();\n        if (block) {\n          block.setConnectionTracking(track);\n        }\n      }\n    }\n  }\n\n  /**\n   * Returns connections originating from this block.\n   *\n   * @param all If true, return all connections even hidden ones.\n   *     Otherwise, for a non-rendered block return an empty list, and for a\n   *     collapsed block don't return inputs connections.\n   * @returns Array of connections.\n   * @internal\n   */\n  override getConnections_(all: boolean): RenderedConnection[] {\n    const myConnections = [];\n    if (all || this.rendered) {\n      if (this.outputConnection) {\n        myConnections.push(this.outputConnection);\n      }\n      if (this.previousConnection) {\n        myConnections.push(this.previousConnection);\n      }\n      if (this.nextConnection) {\n        myConnections.push(this.nextConnection);\n      }\n      if (all || !this.collapsed_) {\n        for (let i = 0, input; (input = this.inputList[i]); i++) {\n          if (input.connection) {\n            myConnections.push(input.connection as RenderedConnection);\n          }\n        }\n      }\n    }\n    return myConnections;\n  }\n\n  /**\n   * Walks down a stack of blocks and finds the last next connection on the\n   * stack.\n   *\n   * @param ignoreShadows If true,the last connection on a non-shadow block will\n   *     be returned. If false, this will follow shadows to find the last\n   *     connection.\n   * @returns The last next connection on the stack, or null.\n   * @internal\n   */\n  override lastConnectionInStack(\n    ignoreShadows: boolean,\n  ): RenderedConnection | null {\n    return super.lastConnectionInStack(ignoreShadows) as RenderedConnection;\n  }\n\n  /**\n   * Find the connection on this block that corresponds to the given connection\n   * on the other block.\n   * Used to match connections between a block and its insertion marker.\n   *\n   * @param otherBlock The other block to match against.\n   * @param conn The other connection to match.\n   * @returns The matching connection on this block, or null.\n   * @internal\n   */\n  override getMatchingConnection(\n    otherBlock: Block,\n    conn: Connection,\n  ): RenderedConnection | null {\n    return super.getMatchingConnection(otherBlock, conn) as RenderedConnection;\n  }\n\n  /**\n   * Create a connection of the specified type.\n   *\n   * @param type The type of the connection to create.\n   * @returns A new connection of the specified type.\n   * @internal\n   */\n  override makeConnection_(type: ConnectionType): RenderedConnection {\n    return new RenderedConnection(this, type);\n  }\n\n  /**\n   * Return the next statement block directly connected to this block.\n   *\n   * @returns The next statement block or null.\n   */\n  override getNextBlock(): BlockSvg | null {\n    return super.getNextBlock() as BlockSvg;\n  }\n\n  /**\n   * Returns the block connected to the previous connection.\n   *\n   * @returns The previous statement block or null.\n   */\n  override getPreviousBlock(): BlockSvg | null {\n    return super.getPreviousBlock() as BlockSvg;\n  }\n\n  /**\n   * Bumps unconnected blocks out of alignment.\n   *\n   * Two blocks which aren't actually connected should not coincidentally line\n   * up on screen, because that creates confusion for end-users.\n   */\n  override bumpNeighbours() {\n    if (this.bumpNeighboursPid) return;\n    const group = eventUtils.getGroup();\n\n    this.bumpNeighboursPid = setTimeout(() => {\n      const oldGroup = eventUtils.getGroup();\n      eventUtils.setGroup(group);\n      this.getRootBlock().bumpNeighboursInternal();\n      eventUtils.setGroup(oldGroup);\n      this.bumpNeighboursPid = 0;\n    }, config.bumpDelay);\n  }\n\n  /**\n   * Bumps unconnected blocks out of alignment.\n   */\n  private bumpNeighboursInternal() {\n    const root = this.getRootBlock();\n    if (\n      this.isDeadOrDying() ||\n      this.workspace.isDragging() ||\n      root.isInFlyout\n    ) {\n      return;\n    }\n\n    function neighbourIsInStack(neighbour: RenderedConnection) {\n      return neighbour.getSourceBlock().getRootBlock() === root;\n    }\n\n    for (const conn of this.getConnections_(false)) {\n      if (conn.isSuperior()) {\n        // Recurse down the block stack.\n        conn.targetBlock()?.bumpNeighboursInternal();\n      }\n\n      for (const neighbour of conn.neighbours(config.snapRadius)) {\n        // Don't bump away from things that are in our stack.\n        if (neighbourIsInStack(neighbour)) continue;\n        // If both connections are connected, that's fine.\n        if (conn.isConnected() && neighbour.isConnected()) continue;\n\n        // Always bump the inferior connection.\n        if (conn.isSuperior()) {\n          neighbour.bumpAwayFrom(conn);\n        } else {\n          conn.bumpAwayFrom(neighbour);\n        }\n      }\n    }\n  }\n\n  /**\n   * Schedule snapping to grid and bumping neighbours to occur after a brief\n   * delay.\n   *\n   * @internal\n   */\n  scheduleSnapAndBump() {\n    // Ensure that any snap and bump are part of this move's event group.\n    const group = eventUtils.getGroup();\n\n    setTimeout(() => {\n      eventUtils.setGroup(group);\n      this.snapToGrid();\n      eventUtils.setGroup(false);\n    }, config.bumpDelay / 2);\n\n    this.bumpNeighbours();\n  }\n\n  /**\n   * Position a block so that it doesn't move the target block when connected.\n   * The block to position is usually either the first block in a dragged stack\n   * or an insertion marker.\n   *\n   * @param sourceConnection The connection on the moving block's stack.\n   * @param originalOffsetToTarget The connection original offset to the target connection\n   * @param originalOffsetInBlock The connection original offset in its block\n   * @internal\n   */\n  positionNearConnection(\n    sourceConnection: RenderedConnection,\n    originalOffsetToTarget: {x: number; y: number},\n    originalOffsetInBlock: Coordinate,\n  ) {\n    // We only need to position the new block if it's before the existing one,\n    // otherwise its position is set by the previous block.\n    if (\n      sourceConnection.type === ConnectionType.NEXT_STATEMENT ||\n      sourceConnection.type === ConnectionType.INPUT_VALUE\n    ) {\n      // First move the block to match the orginal target connection position\n      let dx = originalOffsetToTarget.x;\n      let dy = originalOffsetToTarget.y;\n      // Then adjust its position according to the connection resize\n      dx += originalOffsetInBlock.x - sourceConnection.getOffsetInBlock().x;\n      dy += originalOffsetInBlock.y - sourceConnection.getOffsetInBlock().y;\n\n      this.moveBy(dx, dy);\n    }\n  }\n\n  /**\n   * Find all the blocks that are directly nested inside this one.\n   * Includes value and statement inputs, as well as any following statement.\n   * Excludes any connection on an output tab or any preceding statement.\n   * Blocks are optionally sorted by position; top to bottom.\n   *\n   * @param ordered Sort the list if true.\n   * @returns Array of blocks.\n   */\n  override getChildren(ordered: boolean): BlockSvg[] {\n    return super.getChildren(ordered) as BlockSvg[];\n  }\n\n  /**\n   * Triggers a rerender after a delay to allow for batching.\n   *\n   * @returns A promise that resolves after the currently queued renders have\n   *     been completed. Used for triggering other behavior that relies on\n   *     updated size/position location for the block.\n   * @internal\n   */\n  queueRender(): Promise<void> {\n    return renderManagement.queueRender(this);\n  }\n\n  /**\n   * Immediately lays out and reflows a block based on its contents and\n   * settings.\n   */\n  render() {\n    this.queueRender();\n    renderManagement.triggerQueuedRenders();\n  }\n\n  /**\n   * Renders this block in a way that's compatible with the more efficient\n   * render management system.\n   *\n   * @internal\n   */\n  renderEfficiently() {\n    this.rendered = true;\n    dom.startTextWidthCache();\n\n    if (this.isCollapsed()) {\n      this.updateCollapsed_();\n    }\n\n    if (!this.isEnabled()) {\n      this.updateDisabled();\n    }\n\n    this.workspace.getRenderer().render(this);\n    this.tightenChildrenEfficiently();\n\n    dom.stopTextWidthCache();\n    this.updateMarkers_();\n  }\n\n  /**\n   * Tightens all children of this block so they are snuggly rendered against\n   * their parent connections.\n   *\n   * Does not update connection locations, so that they can be updated more\n   * efficiently by the render management system.\n   *\n   * @internal\n   */\n  tightenChildrenEfficiently() {\n    for (const input of this.inputList) {\n      const conn = input.connection as RenderedConnection;\n      if (conn) conn.tightenEfficiently();\n    }\n    if (this.nextConnection) this.nextConnection.tightenEfficiently();\n  }\n\n  /** Redraw any attached marker or cursor svgs if needed. */\n  protected updateMarkers_() {\n    if (this.workspace.keyboardAccessibilityMode && this.pathObject.cursorSvg) {\n      this.workspace.getCursor()!.draw();\n    }\n    if (this.workspace.keyboardAccessibilityMode && this.pathObject.markerSvg) {\n      // TODO(#4592): Update all markers on the block.\n      this.workspace.getMarker(MarkerManager.LOCAL_MARKER)!.draw();\n    }\n    for (const input of this.inputList) {\n      for (const field of input.fieldRow) {\n        field.updateMarkers_();\n      }\n    }\n  }\n\n  /**\n   * Add the cursor SVG to this block's SVG group.\n   *\n   * @param cursorSvg The SVG root of the cursor to be added to the block SVG\n   *     group.\n   * @internal\n   */\n  setCursorSvg(cursorSvg: SVGElement) {\n    this.pathObject.setCursorSvg(cursorSvg);\n  }\n\n  /**\n   * Add the marker SVG to this block's SVG group.\n   *\n   * @param markerSvg The SVG root of the marker to be added to the block SVG\n   *     group.\n   * @internal\n   */\n  setMarkerSvg(markerSvg: SVGElement) {\n    this.pathObject.setMarkerSvg(markerSvg);\n  }\n\n  /**\n   * Returns a bounding box describing the dimensions of this block\n   * and any blocks stacked below it.\n   *\n   * @returns Object with height and width properties in workspace units.\n   * @internal\n   */\n  getHeightWidth(): {height: number; width: number} {\n    let height = this.height;\n    let width = this.width;\n    // Recursively add size of subsequent blocks.\n    const nextBlock = this.getNextBlock();\n    if (nextBlock) {\n      const nextHeightWidth = nextBlock.getHeightWidth();\n      const tabHeight = this.workspace\n        .getRenderer()\n        .getConstants().NOTCH_HEIGHT;\n      height += nextHeightWidth.height - tabHeight;\n      width = Math.max(width, nextHeightWidth.width);\n    }\n    return {height, width};\n  }\n\n  /**\n   * Visual effect to show that if the dragging block is dropped, this block\n   * will be replaced.  If a shadow block, it will disappear.  Otherwise it will\n   * bump.\n   *\n   * @param add True if highlighting should be added.\n   * @internal\n   */\n  fadeForReplacement(add: boolean) {\n    // TODO (7204): Remove these internal methods.\n    (this.pathObject as AnyDuringMigration).updateReplacementFade(add);\n  }\n\n  /**\n   * Visual effect to show that if the dragging block is dropped it will connect\n   * to this input.\n   *\n   * @param conn The connection on the input to highlight.\n   * @param add True if highlighting should be added.\n   * @internal\n   */\n  highlightShapeForInput(conn: RenderedConnection, add: boolean) {\n    // TODO (7204): Remove these internal methods.\n    (this.pathObject as AnyDuringMigration).updateShapeForInputHighlight(\n      conn,\n      add,\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The abstract class for a component with custom behaviour when a\n * block or bubble is dragged over or dropped on top of it.\n *\n * @class\n */\n// Former goog.module ID: Blockly.DragTarget\n\nimport type {IDragTarget} from './interfaces/i_drag_target.js';\nimport type {IDraggable} from './interfaces/i_draggable.js';\nimport type {Rect} from './utils/rect.js';\n\n/**\n * Abstract class for a component with custom behaviour when a block or bubble\n * is dragged over or dropped on top of it.\n */\nexport class DragTarget implements IDragTarget {\n  /**\n   * The unique id for this component that is used to register with the\n   * ComponentManager.\n   */\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  id!: string;\n\n  /**\n   * Constructor for DragTarget. It exists to add the id property and should not\n   * be called directly, only by a subclass.\n   */\n  constructor() {}\n\n  /**\n   * Handles when a cursor with a block or bubble enters this drag target.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  onDragEnter(_dragElement: IDraggable) {}\n  // no-op\n\n  /**\n   * Handles when a cursor with a block or bubble is dragged over this drag\n   * target.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  onDragOver(_dragElement: IDraggable) {}\n  // no-op\n\n  /**\n   * Handles when a cursor with a block or bubble exits this drag target.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  onDragExit(_dragElement: IDraggable) {}\n  // no-op\n  /**\n   * Handles when a block or bubble is dropped on this component.\n   * Should not handle delete here.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  onDrop(_dragElement: IDraggable) {}\n  // no-op\n\n  /**\n   * Returns the bounding rectangle of the drag target area in pixel units\n   * relative to the Blockly injection div.\n   *\n   * @returns The component's bounding box. Null if drag target area should be\n   *     ignored.\n   */\n  getClientRect(): Rect | null {\n    return null;\n  }\n\n  /**\n   * Returns whether the provided block or bubble should not be moved after\n   * being dropped on this component. If true, the element will return to where\n   * it was when the drag started.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   * @returns Whether the block or bubble provided should be returned to drag\n   *     start.\n   */\n  shouldPreventMove(_dragElement: IDraggable): boolean {\n    return false;\n  }\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The abstract class for a component that can delete a block or\n * bubble that is dropped on top of it.\n *\n * @class\n */\n// Former goog.module ID: Blockly.DeleteArea\n\nimport {BlockSvg} from './block_svg.js';\nimport {DragTarget} from './drag_target.js';\nimport type {IDeleteArea} from './interfaces/i_delete_area.js';\nimport type {IDraggable} from './interfaces/i_draggable.js';\n\n/**\n * Abstract class for a component that can delete a block or bubble that is\n * dropped on top of it.\n */\nexport class DeleteArea extends DragTarget implements IDeleteArea {\n  /**\n   * Whether the last block or bubble dragged over this delete area would be\n   * deleted if dropped on this component.\n   * This property is not updated after the block or bubble is deleted.\n   */\n  protected wouldDelete_ = false;\n\n  /**\n   * The unique id for this component that is used to register with the\n   * ComponentManager.\n   */\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  override id!: string;\n\n  /**\n   * Constructor for DeleteArea. Should not be called directly, only by a\n   * subclass.\n   */\n  constructor() {\n    super();\n  }\n\n  /**\n   * Returns whether the provided block or bubble would be deleted if dropped on\n   * this area.\n   * This method should check if the element is deletable and is always called\n   * before onDragEnter/onDragOver/onDragExit.\n   *\n   * @param element The block or bubble currently being dragged.\n   * @param couldConnect Whether the element could could connect to another.\n   * @returns Whether the element provided would be deleted if dropped on this\n   *     area.\n   */\n  wouldDelete(element: IDraggable, couldConnect: boolean): boolean {\n    if (element instanceof BlockSvg) {\n      const block = element;\n      const couldDeleteBlock = !block.getParent() && block.isDeletable();\n      this.updateWouldDelete_(couldDeleteBlock && !couldConnect);\n    } else {\n      this.updateWouldDelete_(element.isDeletable());\n    }\n    return this.wouldDelete_;\n  }\n\n  /**\n   * Updates the internal wouldDelete_ state.\n   *\n   * @param wouldDelete The new value for the wouldDelete state.\n   */\n  protected updateWouldDelete_(wouldDelete: boolean) {\n    this.wouldDelete_ = wouldDelete;\n  }\n}\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a trash can icon.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Trashcan\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_trashcan_open.js';\n\nimport type {BlocklyOptions} from './blockly_options.js';\nimport * as browserEvents from './browser_events.js';\nimport {ComponentManager} from './component_manager.js';\nimport {DeleteArea} from './delete_area.js';\nimport type {Abstract} from './events/events_abstract.js';\nimport type {BlockDelete} from './events/events_block_delete.js';\nimport * as eventUtils from './events/utils.js';\nimport type {IAutoHideable} from './interfaces/i_autohideable.js';\nimport type {IDraggable} from './interfaces/i_draggable.js';\nimport type {IFlyout} from './interfaces/i_flyout.js';\nimport type {IPositionable} from './interfaces/i_positionable.js';\nimport type {UiMetrics} from './metrics_manager.js';\nimport {Options} from './options.js';\nimport * as uiPosition from './positionable_helpers.js';\nimport * as registry from './registry.js';\nimport type * as blocks from './serialization/blocks.js';\nimport {SPRITE} from './sprites.js';\nimport * as dom from './utils/dom.js';\nimport {Rect} from './utils/rect.js';\nimport {Size} from './utils/size.js';\nimport {Svg} from './utils/svg.js';\nimport {BlockInfo} from './utils/toolbox.js';\nimport * as toolbox from './utils/toolbox.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Class for a trash can.\n */\nexport class Trashcan\n  extends DeleteArea\n  implements IAutoHideable, IPositionable\n{\n  /**\n   * The unique id for this component that is used to register with the\n   * ComponentManager.\n   */\n  override id = 'trashcan';\n\n  /**\n   * A list of JSON (stored as strings) representing blocks in the trashcan.\n   */\n  private readonly contents: string[] = [];\n\n  /**\n   * The trashcan flyout.\n   *\n   * @internal\n   */\n  flyout: IFlyout | null = null;\n\n  /** Current open/close state of the lid. */\n  isLidOpen = false;\n\n  /**\n   * The minimum openness of the lid. Used to indicate if the trashcan\n   * contains blocks.\n   */\n  private minOpenness = 0;\n\n  /** The SVG group containing the trash can. */\n  private svgGroup: SVGElement | null = null;\n\n  /** The SVG image element of the trash can lid. */\n  private svgLid: SVGElement | null = null;\n\n  /** Task ID of opening/closing animation. */\n  private lidTask: ReturnType<typeof setTimeout> | null = null;\n\n  /** Current state of lid opening (0.0 = closed, 1.0 = open). */\n  private lidOpen = 0;\n\n  /** Left coordinate of the trash can. */\n  private left = 0;\n\n  /** Top coordinate of the trash can. */\n  private top = 0;\n\n  /** Whether this trash can has been initialized. */\n  private initialized = false;\n\n  /** @param workspace The workspace to sit in. */\n  constructor(private workspace: WorkspaceSvg) {\n    super();\n\n    if (this.workspace.options.maxTrashcanContents <= 0) {\n      return;\n    }\n\n    // Create flyout options.\n    const flyoutWorkspaceOptions = new Options({\n      'scrollbars': true,\n      'parentWorkspace': this.workspace,\n      'rtl': this.workspace.RTL,\n      'oneBasedIndex': this.workspace.options.oneBasedIndex,\n      'renderer': this.workspace.options.renderer,\n      'rendererOverrides': this.workspace.options.rendererOverrides,\n      'move': {\n        'scrollbars': true,\n      },\n    } as BlocklyOptions);\n    // Create vertical or horizontal flyout.\n    if (this.workspace.horizontalLayout) {\n      flyoutWorkspaceOptions.toolboxPosition =\n        this.workspace.toolboxPosition === toolbox.Position.TOP\n          ? toolbox.Position.BOTTOM\n          : toolbox.Position.TOP;\n      const HorizontalFlyout = registry.getClassFromOptions(\n        registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX,\n        this.workspace.options,\n        true,\n      );\n      this.flyout = new HorizontalFlyout!(flyoutWorkspaceOptions);\n    } else {\n      flyoutWorkspaceOptions.toolboxPosition =\n        this.workspace.toolboxPosition === toolbox.Position.RIGHT\n          ? toolbox.Position.LEFT\n          : toolbox.Position.RIGHT;\n      const VerticalFlyout = registry.getClassFromOptions(\n        registry.Type.FLYOUTS_VERTICAL_TOOLBOX,\n        this.workspace.options,\n        true,\n      );\n      this.flyout = new VerticalFlyout!(flyoutWorkspaceOptions);\n    }\n    this.workspace.addChangeListener(this.onDelete.bind(this));\n  }\n\n  /**\n   * Create the trash can elements.\n   *\n   * @returns The trash can's SVG group.\n   */\n  createDom(): SVGElement {\n    /* Here's the markup that will be generated:\n        <g class=\"blocklyTrash\">\n          <clippath id=\"blocklyTrashBodyClipPath837493\">\n            <rect width=\"47\" height=\"45\" y=\"15\"></rect>\n          </clippath>\n          <image width=\"64\" height=\"92\" y=\"-32\" xlink:href=\"media/sprites.png\"\n              clip-path=\"url(#blocklyTrashBodyClipPath837493)\"></image>\n          <clippath id=\"blocklyTrashLidClipPath837493\">\n            <rect width=\"47\" height=\"15\"></rect>\n          </clippath>\n          <image width=\"84\" height=\"92\" y=\"-32\" xlink:href=\"media/sprites.png\"\n              clip-path=\"url(#blocklyTrashLidClipPath837493)\"></image>\n        </g>\n        */\n    this.svgGroup = dom.createSvgElement(Svg.G, {'class': 'blocklyTrash'});\n    let clip;\n    const rnd = String(Math.random()).substring(2);\n    clip = dom.createSvgElement(\n      Svg.CLIPPATH,\n      {'id': 'blocklyTrashBodyClipPath' + rnd},\n      this.svgGroup,\n    );\n    dom.createSvgElement(\n      Svg.RECT,\n      {'width': WIDTH, 'height': BODY_HEIGHT, 'y': LID_HEIGHT},\n      clip,\n    );\n    const body = dom.createSvgElement(\n      Svg.IMAGE,\n      {\n        'width': SPRITE.width,\n        'x': -SPRITE_LEFT,\n        'height': SPRITE.height,\n        'y': -SPRITE_TOP,\n        'clip-path': 'url(#blocklyTrashBodyClipPath' + rnd + ')',\n      },\n      this.svgGroup,\n    );\n    body.setAttributeNS(\n      dom.XLINK_NS,\n      'xlink:href',\n      this.workspace.options.pathToMedia + SPRITE.url,\n    );\n\n    clip = dom.createSvgElement(\n      Svg.CLIPPATH,\n      {'id': 'blocklyTrashLidClipPath' + rnd},\n      this.svgGroup,\n    );\n    dom.createSvgElement(\n      Svg.RECT,\n      {'width': WIDTH, 'height': LID_HEIGHT},\n      clip,\n    );\n    this.svgLid = dom.createSvgElement(\n      Svg.IMAGE,\n      {\n        'width': SPRITE.width,\n        'x': -SPRITE_LEFT,\n        'height': SPRITE.height,\n        'y': -SPRITE_TOP,\n        'clip-path': 'url(#blocklyTrashLidClipPath' + rnd + ')',\n      },\n      this.svgGroup,\n    );\n    this.svgLid.setAttributeNS(\n      dom.XLINK_NS,\n      'xlink:href',\n      this.workspace.options.pathToMedia + SPRITE.url,\n    );\n\n    // bindEventWithChecks_ quashes events too aggressively. See:\n    // https://groups.google.com/forum/#!topic/blockly/QF4yB9Wx00s\n    // Using bindEventWithChecks_ for blocking mousedown causes issue in mobile.\n    // See #4303\n    browserEvents.bind(\n      this.svgGroup,\n      'pointerdown',\n      this,\n      this.blockMouseDownWhenOpenable,\n    );\n    browserEvents.bind(this.svgGroup, 'pointerup', this, this.click);\n    // Bind to body instead of this.svgGroup so that we don't get lid jitters\n    browserEvents.bind(body, 'pointerover', this, this.mouseOver);\n    browserEvents.bind(body, 'pointerout', this, this.mouseOut);\n    this.animateLid();\n    return this.svgGroup;\n  }\n\n  /** Initializes the trash can. */\n  init() {\n    if (this.workspace.options.maxTrashcanContents > 0) {\n      dom.insertAfter(\n        this.flyout!.createDom(Svg.SVG)!,\n        this.workspace.getParentSvg(),\n      );\n      this.flyout!.init(this.workspace);\n    }\n    this.workspace.getComponentManager().addComponent({\n      component: this,\n      weight: 1,\n      capabilities: [\n        ComponentManager.Capability.AUTOHIDEABLE,\n        ComponentManager.Capability.DELETE_AREA,\n        ComponentManager.Capability.DRAG_TARGET,\n        ComponentManager.Capability.POSITIONABLE,\n      ],\n    });\n    this.initialized = true;\n    this.setLidOpen(false);\n  }\n\n  /**\n   * Dispose of this trash can.\n   * Unlink from all DOM elements to prevent memory leaks.\n   */\n  dispose() {\n    this.workspace.getComponentManager().removeComponent('trashcan');\n    if (this.svgGroup) {\n      dom.removeNode(this.svgGroup);\n    }\n    if (this.lidTask) {\n      clearTimeout(this.lidTask);\n    }\n  }\n\n  /**\n   * Whether the trashcan has contents.\n   *\n   * @returns True if the trashcan has contents.\n   */\n  private hasContents(): boolean {\n    return !!this.contents.length;\n  }\n\n  /**\n   * Returns true if the trashcan contents-flyout is currently open.\n   *\n   * @returns True if the trashcan contents-flyout is currently open.\n   */\n  contentsIsOpen(): boolean {\n    return !!this.flyout && this.flyout.isVisible();\n  }\n\n  /** Opens the trashcan flyout. */\n  openFlyout() {\n    if (this.contentsIsOpen()) {\n      return;\n    }\n    const contents = this.contents.map(function (string) {\n      return JSON.parse(string);\n    });\n    // Trashcans with lots of blocks can take a second to render.\n    const blocklyStyle = this.workspace.getParentSvg().style;\n    blocklyStyle.cursor = 'wait';\n    setTimeout(() => {\n      this.flyout?.show(contents);\n      blocklyStyle.cursor = '';\n      this.workspace.scrollbar?.setVisible(false);\n    }, 10);\n    this.fireUiEvent(true);\n  }\n\n  /** Closes the trashcan flyout. */\n  closeFlyout() {\n    if (!this.contentsIsOpen()) {\n      return;\n    }\n    this.flyout?.hide();\n    this.workspace.scrollbar?.setVisible(true);\n    this.fireUiEvent(false);\n    this.workspace.recordDragTargets();\n  }\n\n  /**\n   * Hides the component. Called in WorkspaceSvg.hideChaff.\n   *\n   * @param onlyClosePopups Whether only popups should be closed.\n   *     Flyouts should not be closed if this is true.\n   */\n  autoHide(onlyClosePopups: boolean) {\n    // For now the trashcan flyout always autocloses because it overlays the\n    // trashcan UI (no trashcan to click to close it).\n    if (!onlyClosePopups && this.flyout) {\n      this.closeFlyout();\n    }\n  }\n\n  /**\n   * Empties the trashcan's contents. If the contents-flyout is currently open\n   * it will be closed.\n   */\n  emptyContents() {\n    if (!this.hasContents()) {\n      return;\n    }\n    this.contents.length = 0;\n    this.setMinOpenness(0);\n    this.closeFlyout();\n  }\n\n  /**\n   * Positions the trashcan.\n   * It is positioned in the opposite corner to the corner the\n   * categories/toolbox starts at.\n   *\n   * @param metrics The workspace metrics.\n   * @param savedPositions List of rectangles that are already on the workspace.\n   */\n  position(metrics: UiMetrics, savedPositions: Rect[]) {\n    // Not yet initialized.\n    if (!this.initialized) {\n      return;\n    }\n\n    const cornerPosition = uiPosition.getCornerOppositeToolbox(\n      this.workspace,\n      metrics,\n    );\n\n    const height = BODY_HEIGHT + LID_HEIGHT;\n    const startRect = uiPosition.getStartPositionRect(\n      cornerPosition,\n      new Size(WIDTH, height),\n      MARGIN_HORIZONTAL,\n      MARGIN_VERTICAL,\n      metrics,\n      this.workspace,\n    );\n\n    const verticalPosition = cornerPosition.vertical;\n    const bumpDirection =\n      verticalPosition === uiPosition.verticalPosition.TOP\n        ? uiPosition.bumpDirection.DOWN\n        : uiPosition.bumpDirection.UP;\n    const positionRect = uiPosition.bumpPositionRect(\n      startRect,\n      MARGIN_VERTICAL,\n      bumpDirection,\n      savedPositions,\n    );\n\n    this.top = positionRect.top;\n    this.left = positionRect.left;\n    this.svgGroup?.setAttribute(\n      'transform',\n      'translate(' + this.left + ',' + this.top + ')',\n    );\n  }\n\n  /**\n   * Returns the bounding rectangle of the UI element in pixel units relative to\n   * the Blockly injection div.\n   *\n   * @returns The UI elements's bounding box. Null if bounding box should be\n   *     ignored by other UI elements.\n   */\n  getBoundingRectangle(): Rect | null {\n    const bottom = this.top + BODY_HEIGHT + LID_HEIGHT;\n    const right = this.left + WIDTH;\n    return new Rect(this.top, bottom, this.left, right);\n  }\n\n  /**\n   * Returns the bounding rectangle of the drag target area in pixel units\n   * relative to viewport.\n   *\n   * @returns The component's bounding box. Null if drag target area should be\n   *     ignored.\n   */\n  override getClientRect(): Rect | null {\n    if (!this.svgGroup) {\n      return null;\n    }\n\n    const trashRect = this.svgGroup.getBoundingClientRect();\n    const top = trashRect.top + SPRITE_TOP - MARGIN_HOTSPOT;\n    const bottom = top + LID_HEIGHT + BODY_HEIGHT + 2 * MARGIN_HOTSPOT;\n    const left = trashRect.left + SPRITE_LEFT - MARGIN_HOTSPOT;\n    const right = left + WIDTH + 2 * MARGIN_HOTSPOT;\n    return new Rect(top, bottom, left, right);\n  }\n\n  /**\n   * Handles when a cursor with a block or bubble is dragged over this drag\n   * target.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  override onDragOver(_dragElement: IDraggable) {\n    this.setLidOpen(this.wouldDelete_);\n  }\n\n  /**\n   * Handles when a cursor with a block or bubble exits this drag target.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  override onDragExit(_dragElement: IDraggable) {\n    this.setLidOpen(false);\n  }\n\n  /**\n   * Handles when a block or bubble is dropped on this component.\n   * Should not handle delete here.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  override onDrop(_dragElement: IDraggable) {\n    setTimeout(this.setLidOpen.bind(this, false), 100);\n  }\n\n  /**\n   * Flip the lid open or shut.\n   *\n   * @param state True if open.\n   * @internal\n   */\n  setLidOpen(state: boolean) {\n    if (this.isLidOpen === state) {\n      return;\n    }\n    if (this.lidTask) {\n      clearTimeout(this.lidTask);\n    }\n    this.isLidOpen = state;\n    this.animateLid();\n  }\n\n  /** Rotate the lid open or closed by one step.  Then wait and recurse. */\n  private animateLid() {\n    const frames = ANIMATION_FRAMES;\n\n    const delta = 1 / (frames + 1);\n    this.lidOpen += this.isLidOpen ? delta : -delta;\n    this.lidOpen = Math.min(Math.max(this.lidOpen, this.minOpenness), 1);\n\n    this.setLidAngle(this.lidOpen * MAX_LID_ANGLE);\n\n    // Linear interpolation between min and max.\n    const opacity = OPACITY_MIN + this.lidOpen * (OPACITY_MAX - OPACITY_MIN);\n    if (this.svgGroup) {\n      this.svgGroup.style.opacity = `${opacity}`;\n    }\n\n    if (this.lidOpen > this.minOpenness && this.lidOpen < 1) {\n      this.lidTask = setTimeout(\n        this.animateLid.bind(this),\n        ANIMATION_LENGTH / frames,\n      );\n    }\n  }\n\n  /**\n   * Set the angle of the trashcan's lid.\n   *\n   * @param lidAngle The angle at which to set the lid.\n   */\n  private setLidAngle(lidAngle: number) {\n    const openAtRight =\n      this.workspace.toolboxPosition === toolbox.Position.RIGHT ||\n      (this.workspace.horizontalLayout && this.workspace.RTL);\n    this.svgLid?.setAttribute(\n      'transform',\n      'rotate(' +\n        (openAtRight ? -lidAngle : lidAngle) +\n        ',' +\n        (openAtRight ? 4 : WIDTH - 4) +\n        ',' +\n        (LID_HEIGHT - 2) +\n        ')',\n    );\n  }\n\n  /**\n   * Sets the minimum openness of the trashcan lid. If the lid is currently\n   * closed, this will update lid's position.\n   *\n   * @param newMin The new minimum openness of the lid. Should be between 0\n   *     and 1.\n   */\n  private setMinOpenness(newMin: number) {\n    this.minOpenness = newMin;\n    if (!this.isLidOpen) {\n      this.setLidAngle(newMin * MAX_LID_ANGLE);\n    }\n  }\n\n  /**\n   * Flip the lid shut.\n   * Called externally after a drag.\n   */\n  closeLid() {\n    this.setLidOpen(false);\n  }\n\n  /** Inspect the contents of the trash. */\n  click() {\n    if (!this.hasContents() || this.workspace.isDragging()) {\n      return;\n    }\n    this.openFlyout();\n  }\n\n  /**\n   * Fires a UI event for trashcan flyout open or close.\n   *\n   * @param trashcanOpen Whether the flyout is opening.\n   */\n  private fireUiEvent(trashcanOpen: boolean) {\n    const uiEvent = new (eventUtils.get(eventUtils.TRASHCAN_OPEN))(\n      trashcanOpen,\n      this.workspace.id,\n    );\n    eventUtils.fire(uiEvent);\n  }\n\n  /**\n   * Prevents a workspace scroll and click event if the trashcan has blocks.\n   *\n   * @param e A mouse down event.\n   */\n  private blockMouseDownWhenOpenable(e: PointerEvent) {\n    if (!this.contentsIsOpen() && this.hasContents()) {\n      // Don't start a workspace scroll.\n      e.stopPropagation();\n    }\n  }\n\n  /**\n   * Indicate that the trashcan can be clicked (by opening it) if it has blocks.\n   */\n  private mouseOver() {\n    if (this.hasContents()) {\n      this.setLidOpen(true);\n    }\n  }\n\n  /**\n   * Close the lid of the trashcan if it was open (Vis. it was indicating it had\n   *    blocks).\n   */\n  private mouseOut() {\n    // No need to do a .hasBlocks check here because if it doesn't the trashcan\n    // won't be open in the first place, and setOpen won't run.\n    this.setLidOpen(false);\n  }\n\n  /**\n   * Handle a BLOCK_DELETE event. Adds deleted blocks oldXml to the content\n   * array.\n   *\n   * @param event Workspace event.\n   */\n  private onDelete(event: Abstract) {\n    if (\n      this.workspace.options.maxTrashcanContents <= 0 ||\n      event.type !== eventUtils.BLOCK_DELETE\n    ) {\n      return;\n    }\n    const deleteEvent = event as BlockDelete;\n    if (event.type === eventUtils.BLOCK_DELETE && !deleteEvent.wasShadow) {\n      if (!deleteEvent.oldJson) {\n        throw new Error('Encountered a delete event without proper oldJson');\n      }\n      const cleanedJson = JSON.stringify(\n        this.cleanBlockJson(deleteEvent.oldJson),\n      );\n      if (this.contents.indexOf(cleanedJson) !== -1) {\n        return;\n      }\n      this.contents.unshift(cleanedJson);\n      while (\n        this.contents.length > this.workspace.options.maxTrashcanContents\n      ) {\n        this.contents.pop();\n      }\n\n      this.setMinOpenness(HAS_BLOCKS_LID_ANGLE);\n    }\n  }\n\n  /**\n   * Converts JSON representing a block into text that can be stored in the\n   * content array.\n   *\n   * @param json A JSON representation of a block's state.\n   * @returns A BlockInfo object corresponding to the JSON, cleaned of all\n   *     unnecessary attributes.\n   */\n  private cleanBlockJson(json: blocks.State): BlockInfo {\n    // Create a deep copy.\n    json = JSON.parse(JSON.stringify(json)) as blocks.State;\n\n    /**\n     * Reshape JSON into a nicer format.\n     *\n     * @param json The JSON to clean.\n     */\n    function cleanRec(json: blocks.State) {\n      if (!json) {\n        return;\n      }\n\n      delete json['id'];\n      delete json['x'];\n      delete json['y'];\n      delete json['enabled'];\n\n      if (json['icons'] && json['icons']['comment']) {\n        const comment = json['icons']['comment'];\n        delete comment['height'];\n        delete comment['width'];\n        delete comment['pinned'];\n      }\n\n      const inputs = json['inputs'];\n      for (const name in inputs) {\n        const input = inputs[name];\n        const block = input['block'];\n        const shadow = input['shadow'];\n        if (block) {\n          cleanRec(block);\n        }\n        if (shadow) {\n          cleanRec(shadow);\n        }\n      }\n      if (json['next']) {\n        const next = json['next'];\n        const block = next['block'];\n        const shadow = next['shadow'];\n        if (block) {\n          cleanRec(block);\n        }\n        if (shadow) {\n          cleanRec(shadow);\n        }\n      }\n    }\n\n    cleanRec(json);\n\n    const blockInfo: BlockInfo = {\n      'kind': 'BLOCK',\n      ...json,\n    };\n    return blockInfo;\n  }\n}\n\n/** Width of both the trash can and lid images. */\nconst WIDTH = 47;\n\n/** Height of the trashcan image (minus lid). */\nconst BODY_HEIGHT = 44;\n\n/** Height of the lid image. */\nconst LID_HEIGHT = 16;\n\n/** Distance between trashcan and bottom or top edge of workspace. */\nconst MARGIN_VERTICAL = 20;\n\n/** Distance between trashcan and right or left edge of workspace. */\nconst MARGIN_HORIZONTAL = 20;\n\n/** Extent of hotspot on all sides beyond the size of the image. */\nconst MARGIN_HOTSPOT = 10;\n\n/** Location of trashcan in sprite image. */\nconst SPRITE_LEFT = 0;\n\n/** Location of trashcan in sprite image. */\nconst SPRITE_TOP = 32;\n\n/**\n * The openness of the lid when the trashcan contains blocks.\n *    (0.0 = closed, 1.0 = open)\n */\nconst HAS_BLOCKS_LID_ANGLE = 0.1;\n\n/** The length of the lid open/close animation in milliseconds. */\nconst ANIMATION_LENGTH = 80;\n\n/** The number of frames in the animation. */\nconst ANIMATION_FRAMES = 4;\n\n/** The minimum (resting) opacity of the trashcan and lid. */\nconst OPACITY_MIN = 0.4;\n\n/** The maximum (hovered) opacity of the trashcan and lid. */\nconst OPACITY_MAX = 0.8;\n\n/**\n * The maximum angle the trashcan lid can opens to. At the end of the open\n * animation the lid will be open to this angle.\n */\nconst MAX_LID_ANGLE = 45;\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The namespace used to keep track of keyboard shortcuts and the\n * key codes used to execute those shortcuts.\n *\n * @class\n */\n// Former goog.module ID: Blockly.ShortcutRegistry\n\nimport {KeyCodes} from './utils/keycodes.js';\nimport * as object from './utils/object.js';\nimport {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Class for the registry of keyboard shortcuts. This is intended to be a\n * singleton. You should not create a new instance, and only access this class\n * from ShortcutRegistry.registry.\n */\nexport class ShortcutRegistry {\n  static readonly registry = new ShortcutRegistry();\n\n  /** Registry of all keyboard shortcuts, keyed by name of shortcut. */\n  private shortcuts = new Map<string, KeyboardShortcut>();\n\n  /** Map of key codes to an array of shortcut names. */\n  private keyMap = new Map<string, string[]>();\n\n  /** Resets the existing ShortcutRegistry singleton. */\n  private constructor() {\n    this.reset();\n  }\n\n  /** Clear and recreate the registry and keyMap. */\n  reset() {\n    this.shortcuts.clear();\n    this.keyMap.clear();\n  }\n\n  /**\n   * Registers a keyboard shortcut.\n   *\n   * @param shortcut The shortcut for this key code.\n   * @param opt_allowOverrides True to prevent a warning when overriding an\n   *     already registered item.\n   * @throws {Error} if a shortcut with the same name already exists.\n   */\n  register(shortcut: KeyboardShortcut, opt_allowOverrides?: boolean) {\n    const registeredShortcut = this.shortcuts.get(shortcut.name);\n    if (registeredShortcut && !opt_allowOverrides) {\n      throw new Error(`Shortcut named \"${shortcut.name}\" already exists.`);\n    }\n    this.shortcuts.set(shortcut.name, shortcut);\n\n    const keyCodes = shortcut.keyCodes;\n    if (keyCodes && keyCodes.length > 0) {\n      for (let i = 0; i < keyCodes.length; i++) {\n        this.addKeyMapping(\n          keyCodes[i],\n          shortcut.name,\n          !!shortcut.allowCollision,\n        );\n      }\n    }\n  }\n\n  /**\n   * Unregisters a keyboard shortcut registered with the given key code. This\n   * will also remove any key mappings that reference this shortcut.\n   *\n   * @param shortcutName The name of the shortcut to unregister.\n   * @returns True if an item was unregistered, false otherwise.\n   */\n  unregister(shortcutName: string): boolean {\n    const shortcut = this.shortcuts.get(shortcutName);\n\n    if (!shortcut) {\n      console.warn(`Keyboard shortcut named \"${shortcutName}\" not found.`);\n      return false;\n    }\n\n    this.removeAllKeyMappings(shortcutName);\n\n    this.shortcuts.delete(shortcutName);\n    return true;\n  }\n\n  /**\n   * Adds a mapping between a keycode and a keyboard shortcut.\n   *\n   * @param keyCode The key code for the keyboard shortcut. If registering a key\n   *     code with a modifier (ex: ctrl+c) use\n   *     ShortcutRegistry.registry.createSerializedKey;\n   * @param shortcutName The name of the shortcut to execute when the given\n   *     keycode is pressed.\n   * @param opt_allowCollision True to prevent an error when adding a shortcut\n   *     to a key that is already mapped to a shortcut.\n   * @throws {Error} if the given key code is already mapped to a shortcut.\n   */\n  addKeyMapping(\n    keyCode: string | number | KeyCodes,\n    shortcutName: string,\n    opt_allowCollision?: boolean,\n  ) {\n    keyCode = `${keyCode}`;\n    const shortcutNames = this.keyMap.get(keyCode);\n    if (shortcutNames && !opt_allowCollision) {\n      throw new Error(\n        `Shortcut named \"${shortcutName}\" collides with shortcuts \"${shortcutNames}\"`,\n      );\n    } else if (shortcutNames && opt_allowCollision) {\n      shortcutNames.unshift(shortcutName);\n    } else {\n      this.keyMap.set(keyCode, [shortcutName]);\n    }\n  }\n\n  /**\n   * Removes a mapping between a keycode and a keyboard shortcut.\n   *\n   * @param keyCode The key code for the keyboard shortcut. If registering a key\n   *     code with a modifier (ex: ctrl+c) use\n   *     ShortcutRegistry.registry.createSerializedKey;\n   * @param shortcutName The name of the shortcut to execute when the given\n   *     keycode is pressed.\n   * @param opt_quiet True to not console warn when there is no shortcut to\n   *     remove.\n   * @returns True if a key mapping was removed, false otherwise.\n   */\n  removeKeyMapping(\n    keyCode: string,\n    shortcutName: string,\n    opt_quiet?: boolean,\n  ): boolean {\n    const shortcutNames = this.keyMap.get(keyCode);\n\n    if (!shortcutNames) {\n      if (!opt_quiet) {\n        console.warn(\n          `No keyboard shortcut named \"${shortcutName}\" registered with key code \"${keyCode}\"`,\n        );\n      }\n      return false;\n    }\n\n    const shortcutIdx = shortcutNames.indexOf(shortcutName);\n    if (shortcutIdx > -1) {\n      shortcutNames.splice(shortcutIdx, 1);\n      if (shortcutNames.length === 0) {\n        this.keyMap.delete(keyCode);\n      }\n      return true;\n    }\n    if (!opt_quiet) {\n      console.warn(\n        `No keyboard shortcut named \"${shortcutName}\" registered with key code \"${keyCode}\"`,\n      );\n    }\n    return false;\n  }\n\n  /**\n   * Removes all the key mappings for a shortcut with the given name.\n   * Useful when changing the default key mappings and the key codes registered\n   * to the shortcut are unknown.\n   *\n   * @param shortcutName The name of the shortcut to remove from the key map.\n   */\n  removeAllKeyMappings(shortcutName: string) {\n    for (const keyCode of this.keyMap.keys()) {\n      this.removeKeyMapping(keyCode, shortcutName, true);\n    }\n  }\n\n  /**\n   * Sets the key map. Setting the key map will override any default key\n   * mappings.\n   *\n   * @param newKeyMap The object with key code to shortcut names.\n   */\n  setKeyMap(newKeyMap: {[key: string]: string[]}) {\n    this.keyMap.clear();\n    for (const key in newKeyMap) {\n      this.keyMap.set(key, newKeyMap[key]);\n    }\n  }\n\n  /**\n   * Gets the current key map.\n   *\n   * @returns The object holding key codes to ShortcutRegistry.KeyboardShortcut.\n   */\n  getKeyMap(): {[key: string]: string[]} {\n    const legacyKeyMap: {[key: string]: string[]} = Object.create(null);\n    for (const [key, value] of this.keyMap) {\n      legacyKeyMap[key] = value;\n    }\n    return legacyKeyMap;\n  }\n\n  /**\n   * Gets the registry of keyboard shortcuts.\n   *\n   * @returns The registry of keyboard shortcuts.\n   */\n  getRegistry(): {[key: string]: KeyboardShortcut} {\n    const legacyRegistry: {[key: string]: KeyboardShortcut} =\n      Object.create(null);\n    for (const [key, value] of this.shortcuts) {\n      legacyRegistry[key] = value;\n    }\n    return object.deepMerge(Object.create(null), legacyRegistry);\n  }\n\n  /**\n   * Handles key down events.\n   *\n   * @param workspace The main workspace where the event was captured.\n   * @param e The key down event.\n   * @returns True if the event was handled, false otherwise.\n   */\n  onKeyDown(workspace: WorkspaceSvg, e: KeyboardEvent): boolean {\n    const key = this.serializeKeyEvent_(e);\n    const shortcutNames = this.getShortcutNamesByKeyCode(key);\n    if (!shortcutNames) {\n      return false;\n    }\n    for (let i = 0, shortcutName; (shortcutName = shortcutNames[i]); i++) {\n      const shortcut = this.shortcuts.get(shortcutName);\n      if (!shortcut?.preconditionFn || shortcut?.preconditionFn(workspace)) {\n        // If the key has been handled, stop processing shortcuts.\n        if (shortcut?.callback && shortcut?.callback(workspace, e, shortcut)) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Gets the shortcuts registered to the given key code.\n   *\n   * @param keyCode The serialized key code.\n   * @returns The list of shortcuts to call when the given keyCode is used.\n   *     Undefined if no shortcuts exist.\n   */\n  getShortcutNamesByKeyCode(keyCode: string): string[] | undefined {\n    return this.keyMap.get(keyCode) || [];\n  }\n\n  /**\n   * Gets the serialized key codes that the shortcut with the given name is\n   * registered under.\n   *\n   * @param shortcutName The name of the shortcut.\n   * @returns An array with all the key codes the shortcut is registered under.\n   */\n  getKeyCodesByShortcutName(shortcutName: string): string[] {\n    const keys = [];\n    for (const [keyCode, shortcuts] of this.keyMap) {\n      const shortcutIdx = shortcuts.indexOf(shortcutName);\n      if (shortcutIdx > -1) {\n        keys.push(keyCode);\n      }\n    }\n    return keys;\n  }\n\n  /**\n   * Serializes a key event.\n   *\n   * @param e A key down event.\n   * @returns The serialized key code for the given event.\n   */\n  private serializeKeyEvent_(e: KeyboardEvent): string {\n    let serializedKey = '';\n    for (const modifier in ShortcutRegistry.modifierKeys) {\n      if (e.getModifierState(modifier)) {\n        if (serializedKey !== '') {\n          serializedKey += '+';\n        }\n        serializedKey += modifier;\n      }\n    }\n    if (serializedKey !== '' && e.keyCode) {\n      serializedKey = serializedKey + '+' + e.keyCode;\n    } else if (e.keyCode) {\n      serializedKey = String(e.keyCode);\n    }\n    return serializedKey;\n  }\n\n  /**\n   * Checks whether any of the given modifiers are not valid.\n   *\n   * @param modifiers List of modifiers to be used with the key.\n   * @throws {Error} if the modifier is not in the valid modifiers list.\n   */\n  private checkModifiers_(modifiers: KeyCodes[]) {\n    for (let i = 0, modifier; (modifier = modifiers[i]); i++) {\n      if (!(modifier in ShortcutRegistry.modifierKeys)) {\n        throw new Error(modifier + ' is not a valid modifier key.');\n      }\n    }\n  }\n\n  /**\n   * Creates the serialized key code that will be used in the key map.\n   *\n   * @param keyCode Number code representing the key.\n   * @param modifiers List of modifier key codes to be used with the key. All\n   *     valid modifiers can be found in the ShortcutRegistry.modifierKeys.\n   * @returns The serialized key code for the given modifiers and key.\n   */\n  createSerializedKey(keyCode: number, modifiers: KeyCodes[] | null): string {\n    let serializedKey = '';\n\n    if (modifiers) {\n      this.checkModifiers_(modifiers);\n      for (const modifier in ShortcutRegistry.modifierKeys) {\n        const modifierKeyCode = (\n          ShortcutRegistry.modifierKeys as AnyDuringMigration\n        )[modifier];\n        if (modifiers.indexOf(modifierKeyCode) > -1) {\n          if (serializedKey !== '') {\n            serializedKey += '+';\n          }\n          serializedKey += modifier;\n        }\n      }\n    }\n\n    if (serializedKey !== '' && keyCode) {\n      serializedKey = serializedKey + '+' + keyCode;\n    } else if (keyCode) {\n      serializedKey = `${keyCode}`;\n    }\n    return serializedKey;\n  }\n}\n\nexport namespace ShortcutRegistry {\n  export interface KeyboardShortcut {\n    callback?: (p1: WorkspaceSvg, p2: Event, p3: KeyboardShortcut) => boolean;\n    name: string;\n    preconditionFn?: (p1: WorkspaceSvg) => boolean;\n    metadata?: object;\n    keyCodes?: (number | string)[];\n    allowCollision?: boolean;\n  }\n\n  /** Supported modifiers. */\n  export enum modifierKeys {\n    Shift = KeyCodes.SHIFT,\n    Control = KeyCodes.CTRL,\n    Alt = KeyCodes.ALT,\n    Meta = KeyCodes.META,\n  }\n}\n\nexport type KeyboardShortcut = ShortcutRegistry.KeyboardShortcut;\n// No need to export ShorcutRegistry.modifierKeys from the module at this time\n// because (1) it wasn't automatically converted by the automatic migration\n// script, (2) the name doesn't follow the styleguide.\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.serialization.variables\n\nimport type {ISerializer} from '../interfaces/i_serializer.js';\nimport type {Workspace} from '../workspace.js';\n\nimport * as priorities from './priorities.js';\nimport * as serializationRegistry from './registry.js';\n\n/**\n * Represents the state of a given variable.\n */\nexport interface State {\n  name: string;\n  id: string;\n  type: string | undefined;\n}\n\n/**\n * Serializer for saving and loading variable state.\n */\nexport class VariableSerializer implements ISerializer {\n  priority: number;\n\n  /* eslint-disable-next-line require-jsdoc */\n  constructor() {\n    /** The priority for deserializing variables. */\n    this.priority = priorities.VARIABLES;\n  }\n\n  /**\n   * Serializes the variables of the given workspace.\n   *\n   * @param workspace The workspace to save the variables of.\n   * @returns The state of the workspace's variables, or null if there are no\n   *     variables.\n   */\n  save(workspace: Workspace): State[] | null {\n    const variableStates = [];\n    for (const variable of workspace.getAllVariables()) {\n      const state = {\n        'name': variable.name,\n        'id': variable.getId(),\n      };\n      if (variable.type) {\n        (state as AnyDuringMigration)['type'] = variable.type;\n      }\n      variableStates.push(state);\n    }\n    // AnyDuringMigration because:  Type '{ name: string; id: string; }[] |\n    // null' is not assignable to type 'State[] | null'.\n    return (\n      variableStates.length ? variableStates : null\n    ) as AnyDuringMigration;\n  }\n\n  /**\n   * Deserializes the variable defined by the given state into the given\n   * workspace.\n   *\n   * @param state The state of the variables to deserialize.\n   * @param workspace The workspace to deserialize into.\n   */\n  load(state: State[], workspace: Workspace) {\n    for (const varState of state) {\n      workspace.createVariable(\n        varState['name'],\n        varState['type'],\n        varState['id'],\n      );\n    }\n  }\n\n  /**\n   * Disposes of any variables that exist on the workspace.\n   *\n   * @param workspace The workspace to clear the variables of.\n   */\n  clear(workspace: Workspace) {\n    workspace.getVariableMap().clear();\n  }\n}\n\nserializationRegistry.register('variables', new VariableSerializer());\n","/**\n * @license\n * Copyright 2022 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Serialization methods.\n */\n// Former goog.module ID: Blockly.serialization\n\nimport * as blocks from './serialization/blocks.js';\nimport * as exceptions from './serialization/exceptions.js';\nimport * as priorities from './serialization/priorities.js';\nimport * as procedures from './serialization/procedures.js';\nimport * as registry from './serialization/registry.js';\nimport * as variables from './serialization/variables.js';\nimport * as workspaces from './serialization/workspaces.js';\nimport {ISerializer} from './interfaces/i_serializer.js';\n\nexport {\n  blocks,\n  exceptions,\n  priorities,\n  procedures,\n  registry,\n  variables,\n  workspaces,\n  ISerializer,\n};\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a pair of scrollbars.\n *\n * @class\n */\n// Former goog.module ID: Blockly.ScrollbarPair\n\nimport * as eventUtils from './events/utils.js';\nimport {Scrollbar} from './scrollbar.js';\nimport * as dom from './utils/dom.js';\nimport type {Metrics} from './utils/metrics.js';\nimport {Svg} from './utils/svg.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Class for a pair of scrollbars.  Horizontal and vertical.\n */\nexport class ScrollbarPair {\n  hScroll: Scrollbar | null = null;\n  vScroll: Scrollbar | null = null;\n  corner_: SVGRectElement | null = null;\n\n  /** Previously recorded metrics from the workspace. */\n  private oldHostMetrics_: Metrics | null = null;\n\n  /**\n   * @param workspace Workspace to bind the scrollbars to.\n   * @param addHorizontal Whether to add a horizontal scrollbar.\n   *    Defaults to true.\n   * @param addVertical Whether to add a vertical scrollbar. Defaults to true.\n   * @param opt_class A class to be applied to these scrollbars.\n   * @param opt_margin The margin to apply to these scrollbars.\n   */\n  constructor(\n    private workspace: WorkspaceSvg,\n    addHorizontal?: boolean,\n    addVertical?: boolean,\n    opt_class?: string,\n    opt_margin?: number,\n  ) {\n    addHorizontal = addHorizontal === undefined ? true : addHorizontal;\n    addVertical = addVertical === undefined ? true : addVertical;\n    const isPair = addHorizontal && addVertical;\n\n    if (addHorizontal) {\n      this.hScroll = new Scrollbar(\n        workspace,\n        true,\n        isPair,\n        opt_class,\n        opt_margin,\n      );\n    }\n    if (addVertical) {\n      this.vScroll = new Scrollbar(\n        workspace,\n        false,\n        isPair,\n        opt_class,\n        opt_margin,\n      );\n    }\n\n    if (isPair) {\n      this.corner_ = dom.createSvgElement(Svg.RECT, {\n        'height': Scrollbar.scrollbarThickness,\n        'width': Scrollbar.scrollbarThickness,\n        'class': 'blocklyScrollbarBackground',\n      });\n      dom.insertAfter(this.corner_, workspace.getBubbleCanvas());\n    }\n  }\n\n  /**\n   * Dispose of this pair of scrollbars.\n   * Unlink from all DOM elements to prevent memory leaks.\n   */\n  dispose() {\n    dom.removeNode(this.corner_);\n    this.corner_ = null;\n    this.oldHostMetrics_ = null;\n    if (this.hScroll) {\n      this.hScroll.dispose();\n      this.hScroll = null;\n    }\n    if (this.vScroll) {\n      this.vScroll.dispose();\n      this.vScroll = null;\n    }\n  }\n\n  /**\n   * Recalculate both of the scrollbars' locations and lengths.\n   * Also reposition the corner rectangle.\n   */\n  resize() {\n    // Look up the host metrics once, and use for both scrollbars.\n    const hostMetrics = this.workspace.getMetrics();\n    if (!hostMetrics) {\n      // Host element is likely not visible.\n      return;\n    }\n\n    // Only change the scrollbars if there has been a change in metrics.\n    let resizeH = false;\n    let resizeV = false;\n    if (\n      !this.oldHostMetrics_ ||\n      this.oldHostMetrics_.viewWidth !== hostMetrics.viewWidth ||\n      this.oldHostMetrics_.viewHeight !== hostMetrics.viewHeight ||\n      this.oldHostMetrics_.absoluteTop !== hostMetrics.absoluteTop ||\n      this.oldHostMetrics_.absoluteLeft !== hostMetrics.absoluteLeft\n    ) {\n      // The window has been resized or repositioned.\n      resizeH = true;\n      resizeV = true;\n    } else {\n      // Has the content been resized or moved?\n      if (\n        !this.oldHostMetrics_ ||\n        this.oldHostMetrics_.scrollWidth !== hostMetrics.scrollWidth ||\n        this.oldHostMetrics_.viewLeft !== hostMetrics.viewLeft ||\n        this.oldHostMetrics_.scrollLeft !== hostMetrics.scrollLeft\n      ) {\n        resizeH = true;\n      }\n      if (\n        !this.oldHostMetrics_ ||\n        this.oldHostMetrics_.scrollHeight !== hostMetrics.scrollHeight ||\n        this.oldHostMetrics_.viewTop !== hostMetrics.viewTop ||\n        this.oldHostMetrics_.scrollTop !== hostMetrics.scrollTop\n      ) {\n        resizeV = true;\n      }\n    }\n\n    if (resizeH || resizeV) {\n      try {\n        eventUtils.disable();\n        if (this.hScroll && resizeH) {\n          this.hScroll.resize(hostMetrics);\n        }\n        if (this.vScroll && resizeV) {\n          this.vScroll.resize(hostMetrics);\n        }\n      } finally {\n        eventUtils.enable();\n      }\n      this.workspace.maybeFireViewportChangeEvent();\n    }\n\n    if (this.hScroll && this.vScroll) {\n      // Reposition the corner square.\n      if (\n        !this.oldHostMetrics_ ||\n        this.oldHostMetrics_.viewWidth !== hostMetrics.viewWidth ||\n        this.oldHostMetrics_.absoluteLeft !== hostMetrics.absoluteLeft\n      ) {\n        this.corner_?.setAttribute('x', String(this.vScroll.position.x));\n      }\n      if (\n        !this.oldHostMetrics_ ||\n        this.oldHostMetrics_.viewHeight !== hostMetrics.viewHeight ||\n        this.oldHostMetrics_.absoluteTop !== hostMetrics.absoluteTop\n      ) {\n        this.corner_?.setAttribute('y', String(this.hScroll.position.y));\n      }\n    }\n\n    // Cache the current metrics to potentially short-cut the next resize event.\n    this.oldHostMetrics_ = hostMetrics;\n  }\n\n  /**\n   * Returns whether scrolling horizontally is enabled.\n   *\n   * @returns True if horizontal scroll is enabled.\n   */\n  canScrollHorizontally(): boolean {\n    return !!this.hScroll;\n  }\n\n  /**\n   * Returns whether scrolling vertically is enabled.\n   *\n   * @returns True if vertical scroll is enabled.\n   */\n  canScrollVertically(): boolean {\n    return !!this.vScroll;\n  }\n\n  /**\n   * Record the origin of the workspace that the scrollbar is in, in pixels\n   * relative to the injection div origin. This is for times when the scrollbar\n   * is used in an object whose origin isn't the same as the main workspace\n   * (e.g. in a flyout.)\n   *\n   * @param x The x coordinate of the scrollbar's origin, in CSS pixels.\n   * @param y The y coordinate of the scrollbar's origin, in CSS pixels.\n   * @internal\n   */\n  setOrigin(x: number, y: number) {\n    if (this.hScroll) {\n      this.hScroll.setOrigin(x, y);\n    }\n    if (this.vScroll) {\n      this.vScroll.setOrigin(x, y);\n    }\n  }\n\n  /**\n   * Set the handles of both scrollbars.\n   *\n   * @param x The horizontal content displacement, relative to the view in\n   *     pixels.\n   * @param y The vertical content displacement, relative to the view in pixels.\n   * @param updateMetrics Whether to update metrics on this set call.\n   *    Defaults to true.\n   */\n  set(x: number, y: number, updateMetrics: boolean) {\n    // This function is equivalent to:\n    //   this.hScroll.set(x);\n    //   this.vScroll.set(y);\n    // However, that calls setMetrics twice which causes a chain of\n    // getAttribute->setAttribute->getAttribute resulting in an extra layout\n    // pass. Combining them speeds up rendering.\n    if (this.hScroll) {\n      this.hScroll.set(x, false);\n    }\n    if (this.vScroll) {\n      this.vScroll.set(y, false);\n    }\n\n    if (updateMetrics || updateMetrics === undefined) {\n      // Update metrics.\n      const xyRatio: {x?: number; y?: number} = {};\n      if (this.hScroll) {\n        xyRatio.x = this.hScroll.getRatio_();\n      }\n      if (this.vScroll) {\n        xyRatio.y = this.vScroll.getRatio_();\n      }\n      this.workspace.setMetrics(xyRatio);\n    }\n  }\n\n  /**\n   * Set the handle of the horizontal scrollbar to be at a certain position in\n   *    CSS pixels relative to its parents.\n   *\n   * @param x Horizontal scroll value.\n   */\n  setX(x: number) {\n    if (this.hScroll) {\n      this.hScroll.set(x, true);\n    }\n  }\n\n  /**\n   * Set the handle of the vertical scrollbar to be at a certain position in\n   *    CSS pixels relative to its parents.\n   *\n   * @param y Vertical scroll value.\n   */\n  setY(y: number) {\n    if (this.vScroll) {\n      this.vScroll.set(y, true);\n    }\n  }\n\n  /**\n   * Set whether this scrollbar's container is visible.\n   *\n   * @param visible Whether the container is visible.\n   */\n  setContainerVisible(visible: boolean) {\n    if (this.hScroll) {\n      this.hScroll.setContainerVisible(visible);\n    }\n    if (this.vScroll) {\n      this.vScroll.setContainerVisible(visible);\n    }\n  }\n\n  /**\n   * If any of the scrollbars are visible. Non-paired scrollbars may disappear\n   * when they aren't needed.\n   *\n   * @returns True if visible.\n   */\n  isVisible(): boolean {\n    let isVisible = false;\n    if (this.hScroll) {\n      isVisible = this.hScroll.isVisible();\n    }\n    if (this.vScroll) {\n      isVisible = isVisible || this.vScroll.isVisible();\n    }\n    return isVisible;\n  }\n\n  /**\n   * Sets the visibility of any existing scrollbars.\n   *\n   * @param visible True if visible.\n   */\n  setVisible(visible: boolean) {\n    if (this.hScroll) this.hScroll.setVisibleInternal(visible);\n    if (this.vScroll) this.vScroll.setVisibleInternal(visible);\n  }\n\n  /**\n   * Recalculates the scrollbars' locations within their path and length.\n   * This should be called when the contents of the workspace have changed.\n   *\n   * @param hostMetrics A data structure describing all the required dimensions,\n   *     possibly fetched from the host object.\n   */\n  resizeContent(hostMetrics: Metrics) {\n    if (this.hScroll) {\n      this.hScroll.resizeContentHorizontal(hostMetrics);\n    }\n    if (this.vScroll) {\n      this.vScroll.resizeContentVertical(hostMetrics);\n    }\n  }\n\n  /**\n   * Recalculates the scrollbars' locations on the screen and path length.\n   * This should be called when the layout or size of the window has changed.\n   *\n   * @param hostMetrics A data structure describing all the required dimensions,\n   *     possibly fetched from the host object.\n   */\n  resizeView(hostMetrics: Metrics) {\n    if (this.hScroll) {\n      this.hScroll.resizeViewHorizontal(hostMetrics);\n    }\n    if (this.vScroll) {\n      this.vScroll.resizeViewVertical(hostMetrics);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Calculates and reports workspace metrics.\n *\n * @class\n */\n// Former goog.module ID: Blockly.MetricsManager\n\nimport type {IFlyout} from './interfaces/i_flyout.js';\nimport type {IMetricsManager} from './interfaces/i_metrics_manager.js';\nimport type {IToolbox} from './interfaces/i_toolbox.js';\nimport * as registry from './registry.js';\nimport type {Metrics} from './utils/metrics.js';\nimport {Size} from './utils/size.js';\nimport * as toolboxUtils from './utils/toolbox.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * The manager for all workspace metrics calculations.\n */\nexport class MetricsManager implements IMetricsManager {\n  /** The workspace to calculate metrics for. */\n  protected readonly workspace_: WorkspaceSvg;\n\n  /** @param workspace The workspace to calculate metrics for. */\n  constructor(workspace: WorkspaceSvg) {\n    this.workspace_ = workspace;\n  }\n\n  /**\n   * Gets the dimensions of the given workspace component, in pixel coordinates.\n   *\n   * @param elem The element to get the dimensions of, or null.  It should be a\n   *     toolbox or flyout, and should implement getWidth() and getHeight().\n   * @returns An object containing width and height attributes, which will both\n   *     be zero if elem did not exist.\n   */\n  protected getDimensionsPx_(elem: IToolbox | null | IFlyout): Size {\n    let width = 0;\n    let height = 0;\n    if (elem) {\n      width = elem.getWidth();\n      height = elem.getHeight();\n    }\n    return new Size(width, height);\n  }\n\n  /**\n   * Gets the width and the height of the flyout in pixel\n   * coordinates. By default, will get metrics for either a simple flyout (owned\n   * directly by the workspace) or for the flyout owned by the toolbox. If you\n   * pass `opt_own` as `true` then only metrics for the simple flyout will be\n   * returned, and it will return 0 for the width and height if the workspace\n   * has a category toolbox instead of a simple toolbox.\n   *\n   * @param opt_own Whether to only return the workspace's own flyout metrics.\n   * @returns The width and height of the flyout.\n   */\n  getFlyoutMetrics(opt_own?: boolean): ToolboxMetrics {\n    const flyoutDimensions = this.getDimensionsPx_(\n      this.workspace_.getFlyout(opt_own),\n    );\n    return {\n      width: flyoutDimensions.width,\n      height: flyoutDimensions.height,\n      position: this.workspace_.toolboxPosition,\n    };\n  }\n\n  /**\n   * Gets the width, height and position of the toolbox on the workspace in\n   * pixel coordinates. Returns 0 for the width and height if the workspace has\n   * a simple toolbox instead of a category toolbox. To get the width and height\n   * of a simple toolbox, see {@link MetricsManager#getFlyoutMetrics}.\n   *\n   * @returns The object with the width, height and position of the toolbox.\n   */\n  getToolboxMetrics(): ToolboxMetrics {\n    const toolboxDimensions = this.getDimensionsPx_(\n      this.workspace_.getToolbox(),\n    );\n\n    return {\n      width: toolboxDimensions.width,\n      height: toolboxDimensions.height,\n      position: this.workspace_.toolboxPosition,\n    };\n  }\n\n  /**\n   * Gets the width and height of the workspace's parent SVG element in pixel\n   * coordinates. This area includes the toolbox and the visible workspace area.\n   *\n   * @returns The width and height of the workspace's parent SVG element.\n   */\n  getSvgMetrics(): Size {\n    return this.workspace_.getCachedParentSvgSize();\n  }\n\n  /**\n   * Gets the absolute left and absolute top in pixel coordinates.\n   * This is where the visible workspace starts in relation to the SVG\n   * container.\n   *\n   * @returns The absolute metrics for the workspace.\n   */\n  getAbsoluteMetrics(): AbsoluteMetrics {\n    let absoluteLeft = 0;\n    let absoluteTop = 0;\n\n    const toolboxMetrics = this.getToolboxMetrics();\n    const flyoutMetrics = this.getFlyoutMetrics();\n    const respectToolbox = !!this.workspace_.getToolbox();\n    const respectFlyout = !this.workspace_.getFlyout()?.autoClose;\n    const toolboxPosition = respectToolbox\n      ? toolboxMetrics.position\n      : flyoutMetrics.position;\n\n    const atLeft = toolboxPosition === toolboxUtils.Position.LEFT;\n    const atTop = toolboxPosition === toolboxUtils.Position.TOP;\n    if (atLeft) {\n      if (respectToolbox) absoluteLeft += toolboxMetrics.width;\n      if (respectFlyout) absoluteLeft += flyoutMetrics.width;\n    }\n    if (atTop) {\n      if (respectToolbox) absoluteTop += toolboxMetrics.height;\n      if (respectFlyout) absoluteTop += flyoutMetrics.height;\n    }\n\n    return {\n      top: absoluteTop,\n      left: absoluteLeft,\n    };\n  }\n\n  /**\n   * Gets the metrics for the visible workspace in either pixel or workspace\n   * coordinates. The visible workspace does not include the toolbox or flyout.\n   *\n   * @param opt_getWorkspaceCoordinates True to get the view metrics in\n   *     workspace coordinates, false to get them in pixel coordinates.\n   * @returns The width, height, top and left of the viewport in either\n   *     workspace coordinates or pixel coordinates.\n   */\n  getViewMetrics(opt_getWorkspaceCoordinates?: boolean): ContainerRegion {\n    const scale = opt_getWorkspaceCoordinates ? this.workspace_.scale : 1;\n    const svgMetrics = this.getSvgMetrics();\n    const toolboxMetrics = this.getToolboxMetrics();\n    const flyoutMetrics = this.getFlyoutMetrics();\n    const respectToolbox = !!this.workspace_.getToolbox();\n    const respectFlyout = !this.workspace_.getFlyout()?.autoClose;\n    const toolboxPosition = respectToolbox\n      ? toolboxMetrics.position\n      : flyoutMetrics.position;\n\n    const horizToolbox =\n      toolboxPosition === toolboxUtils.Position.TOP ||\n      toolboxPosition === toolboxUtils.Position.BOTTOM;\n    const vertToolbox =\n      toolboxPosition === toolboxUtils.Position.LEFT ||\n      toolboxPosition === toolboxUtils.Position.RIGHT;\n    if (horizToolbox) {\n      if (respectToolbox) svgMetrics.height -= toolboxMetrics.height;\n      if (respectFlyout) svgMetrics.height -= flyoutMetrics.height;\n    }\n    if (vertToolbox) {\n      if (respectToolbox) svgMetrics.width -= toolboxMetrics.width;\n      if (respectFlyout) svgMetrics.width -= flyoutMetrics.width;\n    }\n    return {\n      height: svgMetrics.height / scale,\n      width: svgMetrics.width / scale,\n      top: -this.workspace_.scrollY / scale,\n      left: -this.workspace_.scrollX / scale,\n    };\n  }\n\n  /**\n   * Gets content metrics in either pixel or workspace coordinates.\n   * The content area is a rectangle around all the top bounded elements on the\n   * workspace (workspace comments and blocks).\n   *\n   * @param opt_getWorkspaceCoordinates True to get the content metrics in\n   *     workspace coordinates, false to get them in pixel coordinates.\n   * @returns The metrics for the content container.\n   */\n  getContentMetrics(opt_getWorkspaceCoordinates?: boolean): ContainerRegion {\n    const scale = opt_getWorkspaceCoordinates ? 1 : this.workspace_.scale;\n    // Block bounding box is in workspace coordinates.\n    const blockBox = this.workspace_.getBlocksBoundingBox();\n\n    return {\n      height: (blockBox.bottom - blockBox.top) * scale,\n      width: (blockBox.right - blockBox.left) * scale,\n      top: blockBox.top * scale,\n      left: blockBox.left * scale,\n    };\n  }\n\n  /**\n   * Returns whether the scroll area has fixed edges.\n   *\n   * @returns Whether the scroll area has fixed edges.\n   * @internal\n   */\n  hasFixedEdges(): boolean {\n    // This exists for optimization of bump logic.\n    return (\n      !this.workspace_.isMovableHorizontally() ||\n      !this.workspace_.isMovableVertically()\n    );\n  }\n\n  /**\n   * Computes the fixed edges of the scroll area.\n   *\n   * @param opt_viewMetrics The view metrics if they have been previously\n   *     computed. Passing in null may cause the view metrics to be computed\n   *     again, if it is needed.\n   * @returns The fixed edges of the scroll area.\n   */\n  protected getComputedFixedEdges_(\n    opt_viewMetrics?: ContainerRegion,\n  ): FixedEdges {\n    if (!this.hasFixedEdges()) {\n      // Return early if there are no edges.\n      return {};\n    }\n\n    const hScrollEnabled = this.workspace_.isMovableHorizontally();\n    const vScrollEnabled = this.workspace_.isMovableVertically();\n\n    const viewMetrics = opt_viewMetrics || this.getViewMetrics(false);\n\n    const edges = {} as FixedEdges;\n    if (!vScrollEnabled) {\n      edges.top = viewMetrics.top;\n      edges.bottom = viewMetrics.top + viewMetrics.height;\n    }\n    if (!hScrollEnabled) {\n      edges.left = viewMetrics.left;\n      edges.right = viewMetrics.left + viewMetrics.width;\n    }\n    return edges;\n  }\n\n  /**\n   * Returns the content area with added padding.\n   *\n   * @param viewMetrics The view metrics.\n   * @param contentMetrics The content metrics.\n   * @returns The padded content area.\n   */\n  protected getPaddedContent_(\n    viewMetrics: ContainerRegion,\n    contentMetrics: ContainerRegion,\n  ): {top: number; bottom: number; left: number; right: number} {\n    const contentBottom = contentMetrics.top + contentMetrics.height;\n    const contentRight = contentMetrics.left + contentMetrics.width;\n\n    const viewWidth = viewMetrics.width;\n    const viewHeight = viewMetrics.height;\n    const halfWidth = viewWidth / 2;\n    const halfHeight = viewHeight / 2;\n\n    // Add a padding around the content that is at least half a screen wide.\n    // Ensure padding is wide enough that blocks can scroll over entire screen.\n    const top = Math.min(\n      contentMetrics.top - halfHeight,\n      contentBottom - viewHeight,\n    );\n    const left = Math.min(\n      contentMetrics.left - halfWidth,\n      contentRight - viewWidth,\n    );\n    const bottom = Math.max(\n      contentBottom + halfHeight,\n      contentMetrics.top + viewHeight,\n    );\n    const right = Math.max(\n      contentRight + halfWidth,\n      contentMetrics.left + viewWidth,\n    );\n\n    return {top, bottom, left, right};\n  }\n\n  /**\n   * Returns the metrics for the scroll area of the workspace.\n   *\n   * @param opt_getWorkspaceCoordinates True to get the scroll metrics in\n   *     workspace coordinates, false to get them in pixel coordinates.\n   * @param opt_viewMetrics The view metrics if they have been previously\n   *     computed. Passing in null may cause the view metrics to be computed\n   *     again, if it is needed.\n   * @param opt_contentMetrics The content metrics if they have been previously\n   *     computed. Passing in null may cause the content metrics to be computed\n   *     again, if it is needed.\n   * @returns The metrics for the scroll container.\n   */\n  getScrollMetrics(\n    opt_getWorkspaceCoordinates?: boolean,\n    opt_viewMetrics?: ContainerRegion,\n    opt_contentMetrics?: ContainerRegion,\n  ): ContainerRegion {\n    const scale = opt_getWorkspaceCoordinates ? this.workspace_.scale : 1;\n    const viewMetrics = opt_viewMetrics || this.getViewMetrics(false);\n    const contentMetrics = opt_contentMetrics || this.getContentMetrics();\n    const fixedEdges = this.getComputedFixedEdges_(viewMetrics);\n\n    // Add padding around content.\n    const paddedContent = this.getPaddedContent_(viewMetrics, contentMetrics);\n\n    // Use combination of fixed bounds and padded content to make scroll area.\n    const top =\n      fixedEdges.top !== undefined ? fixedEdges.top : paddedContent.top;\n    const left =\n      fixedEdges.left !== undefined ? fixedEdges.left : paddedContent.left;\n    const bottom =\n      fixedEdges.bottom !== undefined\n        ? fixedEdges.bottom\n        : paddedContent.bottom;\n    const right =\n      fixedEdges.right !== undefined ? fixedEdges.right : paddedContent.right;\n\n    return {\n      top: top / scale,\n      left: left / scale,\n      width: (right - left) / scale,\n      height: (bottom - top) / scale,\n    };\n  }\n\n  /**\n   * Returns common metrics used by UI elements.\n   *\n   * @returns The UI metrics.\n   */\n  getUiMetrics(): UiMetrics {\n    return {\n      viewMetrics: this.getViewMetrics(),\n      absoluteMetrics: this.getAbsoluteMetrics(),\n      toolboxMetrics: this.getToolboxMetrics(),\n    };\n  }\n\n  /**\n   * Returns an object with all the metrics required to size scrollbars for a\n   * top level workspace.  The following properties are computed:\n   * Coordinate system: pixel coordinates, -left, -up, +right, +down\n   * .viewHeight: Height of the visible portion of the workspace.\n   * .viewWidth: Width of the visible portion of the workspace.\n   * .contentHeight: Height of the content.\n   * .contentWidth: Width of the content.\n   * .scrollHeight: Height of the scroll area.\n   * .scrollWidth: Width of the scroll area.\n   * .svgHeight: Height of the Blockly div (the view + the toolbox,\n   *    simple or otherwise),\n   * .svgWidth: Width of the Blockly div (the view + the toolbox,\n   *    simple or otherwise),\n   * .viewTop: Top-edge of the visible portion of the workspace, relative to\n   *     the workspace origin.\n   * .viewLeft: Left-edge of the visible portion of the workspace, relative to\n   *     the workspace origin.\n   * .contentTop: Top-edge of the content, relative to the workspace origin.\n   * .contentLeft: Left-edge of the content relative to the workspace origin.\n   * .scrollTop: Top-edge of the scroll area, relative to the workspace origin.\n   * .scrollLeft: Left-edge of the scroll area relative to the workspace origin.\n   * .absoluteTop: Top-edge of the visible portion of the workspace, relative\n   *     to the blocklyDiv.\n   * .absoluteLeft: Left-edge of the visible portion of the workspace, relative\n   *     to the blocklyDiv.\n   * .toolboxWidth: Width of the toolbox, if it exists.  Otherwise zero.\n   * .toolboxHeight: Height of the toolbox, if it exists.  Otherwise zero.\n   * .flyoutWidth: Width of the flyout if it is always open.  Otherwise zero.\n   * .flyoutHeight: Height of the flyout if it is always open.  Otherwise zero.\n   * .toolboxPosition: Top, bottom, left or right. Use TOOLBOX_AT constants to\n   *     compare.\n   *\n   * @returns Contains size and position metrics of a top level workspace.\n   */\n  getMetrics(): Metrics {\n    const toolboxMetrics = this.getToolboxMetrics();\n    const flyoutMetrics = this.getFlyoutMetrics(true);\n    const svgMetrics = this.getSvgMetrics();\n    const absoluteMetrics = this.getAbsoluteMetrics();\n    const viewMetrics = this.getViewMetrics();\n    const contentMetrics = this.getContentMetrics();\n    const scrollMetrics = this.getScrollMetrics(\n      false,\n      viewMetrics,\n      contentMetrics,\n    );\n\n    return {\n      contentHeight: contentMetrics.height,\n      contentWidth: contentMetrics.width,\n      contentTop: contentMetrics.top,\n      contentLeft: contentMetrics.left,\n\n      scrollHeight: scrollMetrics.height,\n      scrollWidth: scrollMetrics.width,\n      scrollTop: scrollMetrics.top,\n      scrollLeft: scrollMetrics.left,\n\n      viewHeight: viewMetrics.height,\n      viewWidth: viewMetrics.width,\n      viewTop: viewMetrics.top,\n      viewLeft: viewMetrics.left,\n\n      absoluteTop: absoluteMetrics.top,\n      absoluteLeft: absoluteMetrics.left,\n\n      svgHeight: svgMetrics.height,\n      svgWidth: svgMetrics.width,\n\n      toolboxWidth: toolboxMetrics.width,\n      toolboxHeight: toolboxMetrics.height,\n      toolboxPosition: toolboxMetrics.position,\n\n      flyoutWidth: flyoutMetrics.width,\n      flyoutHeight: flyoutMetrics.height,\n    };\n  }\n}\n\nexport namespace MetricsManager {\n  /**\n   * Describes the width, height and location of the toolbox on the main\n   * workspace.\n   */\n  export interface ToolboxMetrics {\n    width: number;\n    height: number;\n    position: toolboxUtils.Position;\n  }\n\n  /** Describes where the viewport starts in relation to the workspace SVG. */\n  export interface AbsoluteMetrics {\n    left: number;\n    top: number;\n  }\n\n  /**\n   * All the measurements needed to describe the size and location of a\n   * container.\n   */\n  export interface ContainerRegion {\n    height: number;\n    width: number;\n    top: number;\n    left: number;\n  }\n\n  /** Describes fixed edges of the workspace. */\n  export interface FixedEdges {\n    top?: number;\n    bottom?: number;\n    left?: number;\n    right?: number;\n  }\n\n  /** Common metrics used for UI elements. */\n  export interface UiMetrics {\n    viewMetrics: ContainerRegion;\n    absoluteMetrics: AbsoluteMetrics;\n    toolboxMetrics: ToolboxMetrics;\n  }\n}\n\nexport type ToolboxMetrics = MetricsManager.ToolboxMetrics;\nexport type AbsoluteMetrics = MetricsManager.AbsoluteMetrics;\nexport type ContainerRegion = MetricsManager.ContainerRegion;\nexport type FixedEdges = MetricsManager.FixedEdges;\nexport type UiMetrics = MetricsManager.UiMetrics;\n\nregistry.register(\n  registry.Type.METRICS_MANAGER,\n  registry.DEFAULT,\n  MetricsManager,\n);\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for a finished loading workspace event.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.FinishedLoading\n\nimport * as registry from '../registry.js';\nimport type {Workspace} from '../workspace.js';\nimport {Abstract as AbstractEvent} from './events_abstract.js';\nimport * as eventUtils from './utils.js';\n\n/**\n * Notifies listeners when the workspace has finished deserializing from\n * JSON/XML.\n */\nexport class FinishedLoading extends AbstractEvent {\n  override isBlank = true;\n  override recordUndo = false;\n  override type = eventUtils.FINISHED_LOADING;\n\n  /**\n   * @param opt_workspace The workspace that has finished loading.  Undefined\n   *     for a blank event.\n   */\n  constructor(opt_workspace?: Workspace) {\n    super();\n    this.isBlank = !!opt_workspace;\n\n    if (!opt_workspace) return;\n\n    this.workspaceId = opt_workspace.id;\n  }\n}\n\nregistry.register(\n  registry.Type.EVENT,\n  eventUtils.FINISHED_LOADING,\n  FinishedLoading,\n);\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Events fired as a block drag.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.BlockDrag\n\nimport type {Block} from '../block.js';\nimport * as registry from '../registry.js';\nimport {AbstractEventJson} from './events_abstract.js';\nimport {UiBase} from './events_ui_base.js';\nimport * as eventUtils from './utils.js';\nimport {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners when a block is being manually dragged/dropped.\n */\nexport class BlockDrag extends UiBase {\n  /** The ID of the top-level block being dragged. */\n  blockId?: string;\n\n  /** True if this is the start of a drag, false if this is the end of one. */\n  isStart?: boolean;\n\n  /**\n   * A list of all of the blocks (i.e. all descendants of the block associated\n   * with the block ID) being dragged.\n   */\n  blocks?: Block[];\n\n  override type = eventUtils.BLOCK_DRAG;\n\n  /**\n   * @param opt_block The top block in the stack that is being dragged.\n   *     Undefined for a blank event.\n   * @param opt_isStart Whether this is the start of a block drag.\n   *    Undefined for a blank event.\n   * @param opt_blocks The blocks affected by this drag. Undefined for a blank\n   *     event.\n   */\n  constructor(opt_block?: Block, opt_isStart?: boolean, opt_blocks?: Block[]) {\n    const workspaceId = opt_block ? opt_block.workspace.id : undefined;\n    super(workspaceId);\n    if (!opt_block) return;\n\n    this.blockId = opt_block.id;\n    this.isStart = opt_isStart;\n    this.blocks = opt_blocks;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): BlockDragJson {\n    const json = super.toJson() as BlockDragJson;\n    if (this.isStart === undefined) {\n      throw new Error(\n        'Whether this event is the start of a drag is undefined. ' +\n          'Either pass the value to the constructor, or call fromJson',\n      );\n    }\n    if (this.blockId === undefined) {\n      throw new Error(\n        'The block ID is undefined. Either pass a block to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    json['isStart'] = this.isStart;\n    json['blockId'] = this.blockId;\n    // TODO: I don't think we should actually apply the blocks array to the JSON\n    //   object b/c they have functions and aren't actually serializable.\n    json['blocks'] = this.blocks;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of BlockDrag, but we can't specify that due to the fact that parameters\n   *     to static methods in subclasses must be supertypes of parameters to\n   *     static methods in superclasses..\n   * @internal\n   */\n  static fromJson(\n    json: BlockDragJson,\n    workspace: Workspace,\n    event?: any,\n  ): BlockDrag {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new BlockDrag(),\n    ) as BlockDrag;\n    newEvent.isStart = json['isStart'];\n    newEvent.blockId = json['blockId'];\n    newEvent.blocks = json['blocks'];\n    return newEvent;\n  }\n}\n\nexport interface BlockDragJson extends AbstractEventJson {\n  isStart: boolean;\n  blockId: string;\n  blocks?: Block[];\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.BLOCK_DRAG, BlockDrag);\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {Bubble} from './bubbles/bubble.js';\nimport {TextBubble} from './bubbles/text_bubble.js';\nimport {TextInputBubble} from './bubbles/textinput_bubble.js';\nimport {MiniWorkspaceBubble} from './bubbles/mini_workspace_bubble.js';\n\nexport {Bubble, TextBubble, TextInputBubble, MiniWorkspaceBubble};\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for an event representing an intermediate change to a block's field's\n * value.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.BlockFieldIntermediateChange\n\nimport type {Block} from '../block.js';\nimport * as registry from '../registry.js';\nimport {Workspace} from '../workspace.js';\n\nimport {BlockBase, BlockBaseJson} from './events_block_base.js';\nimport * as eventUtils from './utils.js';\n\n/**\n * Notifies listeners when the value of a block's field has changed but the\n * change is not yet complete, and is expected to be followed by a block change\n * event.\n */\nexport class BlockFieldIntermediateChange extends BlockBase {\n  override type = eventUtils.BLOCK_FIELD_INTERMEDIATE_CHANGE;\n\n  // Intermediate events do not undo or redo. They may be fired frequently while\n  // the field editor widget is open. A separate BLOCK_CHANGE event is fired\n  // when the editor is closed, which combines all of the field value changes\n  // into a single change that is recorded in the undo history instead. The\n  // intermediate changes are important for reacting to immediate changes, but\n  // some event handlers would prefer to handle the less frequent final events,\n  // like when triggering workspace serialization. Technically, this method of\n  // grouping changes can result in undo perfoming actions out of order if some\n  // other event occurs between opening and closing the field editor, but such\n  // events are unlikely to cause a broken state.\n  override recordUndo = false;\n\n  /** The name of the field that changed. */\n  name?: string;\n\n  /** The original value of the element. */\n  oldValue: unknown;\n\n  /** The new value of the element. */\n  newValue: unknown;\n\n  /**\n   * @param opt_block The changed block. Undefined for a blank event.\n   * @param opt_name Name of the field affected.\n   * @param opt_oldValue Previous value of element.\n   * @param opt_newValue New value of element.\n   */\n  constructor(\n    opt_block?: Block,\n    opt_name?: string,\n    opt_oldValue?: unknown,\n    opt_newValue?: unknown,\n  ) {\n    super(opt_block);\n    if (!opt_block) {\n      return; // Blank event to be populated by fromJson.\n    }\n\n    this.name = opt_name;\n    this.oldValue = opt_oldValue;\n    this.newValue = opt_newValue;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): BlockFieldIntermediateChangeJson {\n    const json = super.toJson() as BlockFieldIntermediateChangeJson;\n    if (!this.name) {\n      throw new Error(\n        'The changed field name is undefined. Either pass a ' +\n          'name to the constructor, or call fromJson.',\n      );\n    }\n    json['name'] = this.name;\n    json['oldValue'] = this.oldValue;\n    json['newValue'] = this.newValue;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of BlockFieldIntermediateChange, but we can't specify that due to the\n   *     fact that parameters to static methods in subclasses must be supertypes\n   *     of parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: BlockFieldIntermediateChangeJson,\n    workspace: Workspace,\n    event?: any,\n  ): BlockFieldIntermediateChange {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new BlockFieldIntermediateChange(),\n    ) as BlockFieldIntermediateChange;\n    newEvent.name = json['name'];\n    newEvent.oldValue = json['oldValue'];\n    newEvent.newValue = json['newValue'];\n    return newEvent;\n  }\n\n  /**\n   * Does this event record any change of state?\n   *\n   * @returns False if something changed.\n   */\n  override isNull(): boolean {\n    return this.oldValue === this.newValue;\n  }\n\n  /**\n   * Run a change event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    if (!this.blockId) {\n      throw new Error(\n        'The block ID is undefined. Either pass a block to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    const block = workspace.getBlockById(this.blockId);\n    if (!block) {\n      throw new Error(\n        'The associated block is undefined. Either pass a ' +\n          'block to the constructor, or call fromJson',\n      );\n    }\n\n    const value = forward ? this.newValue : this.oldValue;\n    const field = block.getField(this.name!);\n    if (field) {\n      field.setValue(value);\n    } else {\n      console.warn(\"Can't set non-existent field: \" + this.name);\n    }\n  }\n}\n\nexport interface BlockFieldIntermediateChangeJson extends BlockBaseJson {\n  name: string;\n  newValue: unknown;\n  oldValue: unknown;\n}\n\nregistry.register(\n  registry.Type.EVENT,\n  eventUtils.BLOCK_FIELD_INTERMEDIATE_CHANGE,\n  BlockFieldIntermediateChange,\n);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for a block move event.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.BlockMove\n\nimport type {Block} from '../block.js';\nimport {ConnectionType} from '../connection_type.js';\nimport * as registry from '../registry.js';\nimport {Coordinate} from '../utils/coordinate.js';\n\nimport {BlockBase, BlockBaseJson} from './events_block_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\ninterface BlockLocation {\n  parentId?: string;\n  inputName?: string;\n  coordinate?: Coordinate;\n}\n\n/**\n * Notifies listeners when a block is moved. This could be from one\n * connection to another, or from one location on the workspace to another.\n */\nexport class BlockMove extends BlockBase {\n  override type = eventUtils.BLOCK_MOVE;\n\n  /** The ID of the old parent block. Undefined if it was a top-level block. */\n  oldParentId?: string;\n\n  /**\n   * The name of the old input. Undefined if it was a top-level block or the\n   * parent's next block.\n   */\n  oldInputName?: string;\n\n  /**\n   * The old X and Y workspace coordinates of the block if it was a top level\n   * block. Undefined if it was not a top level block.\n   */\n  oldCoordinate?: Coordinate;\n\n  /** The ID of the new parent block. Undefined if it is a top-level block. */\n  newParentId?: string;\n\n  /**\n   * The name of the new input. Undefined if it is a top-level block or the\n   * parent's next block.\n   */\n  newInputName?: string;\n\n  /**\n   * The new X and Y workspace coordinates of the block if it is a top-level\n   * block. Undefined if it is not a top level block.\n   */\n  newCoordinate?: Coordinate;\n\n  /**\n   * An explanation of what this move is for.  Known values include:\n   *  'drag' -- A drag operation completed.\n   *  'bump' -- Block got bumped away from an invalid connection.\n   *  'snap' -- Block got shifted to line up with the grid.\n   *  'inbounds' -- Block got pushed back into a non-scrolling workspace.\n   *  'connect' -- Block got connected to another block.\n   *  'disconnect' -- Block got disconnected from another block.\n   *  'create' -- Block created via XML.\n   *  'cleanup' -- Workspace aligned top-level blocks.\n   * Event merging may create multiple reasons: ['drag', 'bump', 'snap'].\n   */\n  reason?: string[];\n\n  /** @param opt_block The moved block.  Undefined for a blank event. */\n  constructor(opt_block?: Block) {\n    super(opt_block);\n\n    if (!opt_block) {\n      return;\n    }\n    // Blank event to be populated by fromJson.\n    if (opt_block.isShadow()) {\n      // Moving shadow blocks is handled via disconnection.\n      this.recordUndo = false;\n    }\n\n    const location = this.currentLocation_();\n    this.oldParentId = location.parentId;\n    this.oldInputName = location.inputName;\n    this.oldCoordinate = location.coordinate;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): BlockMoveJson {\n    const json = super.toJson() as BlockMoveJson;\n    json['oldParentId'] = this.oldParentId;\n    json['oldInputName'] = this.oldInputName;\n    if (this.oldCoordinate) {\n      json['oldCoordinate'] =\n        `${Math.round(this.oldCoordinate.x)}, ` +\n        `${Math.round(this.oldCoordinate.y)}`;\n    }\n    json['newParentId'] = this.newParentId;\n    json['newInputName'] = this.newInputName;\n    if (this.newCoordinate) {\n      json['newCoordinate'] =\n        `${Math.round(this.newCoordinate.x)}, ` +\n        `${Math.round(this.newCoordinate.y)}`;\n    }\n    if (this.reason) {\n      json['reason'] = this.reason;\n    }\n    if (!this.recordUndo) {\n      json['recordUndo'] = this.recordUndo;\n    }\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of BlockMove, but we can't specify that due to the fact that parameters\n   *     to static methods in subclasses must be supertypes of parameters to\n   *     static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: BlockMoveJson,\n    workspace: Workspace,\n    event?: any,\n  ): BlockMove {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new BlockMove(),\n    ) as BlockMove;\n    newEvent.oldParentId = json['oldParentId'];\n    newEvent.oldInputName = json['oldInputName'];\n    if (json['oldCoordinate']) {\n      const xy = json['oldCoordinate'].split(',');\n      newEvent.oldCoordinate = new Coordinate(Number(xy[0]), Number(xy[1]));\n    }\n    newEvent.newParentId = json['newParentId'];\n    newEvent.newInputName = json['newInputName'];\n    if (json['newCoordinate']) {\n      const xy = json['newCoordinate'].split(',');\n      newEvent.newCoordinate = new Coordinate(Number(xy[0]), Number(xy[1]));\n    }\n    if (json['reason'] !== undefined) {\n      newEvent.reason = json['reason'];\n    }\n    if (json['recordUndo'] !== undefined) {\n      newEvent.recordUndo = json['recordUndo'];\n    }\n    return newEvent;\n  }\n\n  /** Record the block's new location.  Called after the move. */\n  recordNew() {\n    const location = this.currentLocation_();\n    this.newParentId = location.parentId;\n    this.newInputName = location.inputName;\n    this.newCoordinate = location.coordinate;\n  }\n\n  /**\n   * Set the reason for a move event.\n   *\n   * @param reason Why is this move happening?  'drag', 'bump', 'snap', ...\n   */\n  setReason(reason: string[]) {\n    this.reason = reason;\n  }\n\n  /**\n   * Returns the parentId and input if the block is connected,\n   *   or the XY location if disconnected.\n   *\n   * @returns Collection of location info.\n   */\n  private currentLocation_(): BlockLocation {\n    const workspace = this.getEventWorkspace_();\n    if (!this.blockId) {\n      throw new Error(\n        'The block ID is undefined. Either pass a block to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    const block = workspace.getBlockById(this.blockId);\n    if (!block) {\n      throw new Error(\n        'The block associated with the block move event ' +\n          'could not be found',\n      );\n    }\n    const location = {} as BlockLocation;\n    const parent = block.getParent();\n    if (parent) {\n      location.parentId = parent.id;\n      const input = parent.getInputWithBlock(block);\n      if (input) {\n        location.inputName = input.name;\n      }\n    } else {\n      location.coordinate = block.getRelativeToSurfaceXY();\n    }\n    return location;\n  }\n\n  /**\n   * Does this event record any change of state?\n   *\n   * @returns False if something changed.\n   */\n  override isNull(): boolean {\n    return (\n      this.oldParentId === this.newParentId &&\n      this.oldInputName === this.newInputName &&\n      Coordinate.equals(this.oldCoordinate, this.newCoordinate)\n    );\n  }\n\n  /**\n   * Run a move event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    if (!this.blockId) {\n      throw new Error(\n        'The block ID is undefined. Either pass a block to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    const block = workspace.getBlockById(this.blockId);\n    if (!block) {\n      console.warn(\"Can't move non-existent block: \" + this.blockId);\n      return;\n    }\n    const parentId = forward ? this.newParentId : this.oldParentId;\n    const inputName = forward ? this.newInputName : this.oldInputName;\n    const coordinate = forward ? this.newCoordinate : this.oldCoordinate;\n    let parentBlock: Block | null;\n    if (parentId) {\n      parentBlock = workspace.getBlockById(parentId);\n      if (!parentBlock) {\n        console.warn(\"Can't connect to non-existent block: \" + parentId);\n        return;\n      }\n    }\n    if (block.getParent()) {\n      block.unplug();\n    }\n    if (coordinate) {\n      const xy = block.getRelativeToSurfaceXY();\n      block.moveBy(coordinate.x - xy.x, coordinate.y - xy.y, this.reason);\n    } else {\n      let blockConnection = block.outputConnection;\n      if (\n        !blockConnection ||\n        (block.previousConnection && block.previousConnection.isConnected())\n      ) {\n        blockConnection = block.previousConnection;\n      }\n      let parentConnection;\n      const connectionType = blockConnection?.type;\n      if (inputName) {\n        const input = parentBlock!.getInput(inputName);\n        if (input) {\n          parentConnection = input.connection;\n        }\n      } else if (connectionType === ConnectionType.PREVIOUS_STATEMENT) {\n        parentConnection = parentBlock!.nextConnection;\n      }\n      if (parentConnection && blockConnection) {\n        blockConnection.connect(parentConnection);\n      } else {\n        console.warn(\"Can't connect to non-existent input: \" + inputName);\n      }\n    }\n  }\n}\n\nexport interface BlockMoveJson extends BlockBaseJson {\n  oldParentId?: string;\n  oldInputName?: string;\n  oldCoordinate?: string;\n  newParentId?: string;\n  newInputName?: string;\n  newCoordinate?: string;\n  reason?: string[];\n  recordUndo?: boolean;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.MOVE, BlockMove);\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Events fired as a result of bubble open.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.BubbleOpen\n\nimport type {AbstractEventJson} from './events_abstract.js';\nimport type {BlockSvg} from '../block_svg.js';\nimport * as registry from '../registry.js';\nimport {UiBase} from './events_ui_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Class for a bubble open event.\n */\nexport class BubbleOpen extends UiBase {\n  /** The ID of the block the bubble is attached to. */\n  blockId?: string;\n\n  /** True if the bubble is opening, false if closing. */\n  isOpen?: boolean;\n\n  /** The type of bubble; one of 'mutator', 'comment', or 'warning'. */\n  bubbleType?: BubbleType;\n\n  override type = eventUtils.BUBBLE_OPEN;\n\n  /**\n   * @param opt_block The associated block. Undefined for a blank event.\n   * @param opt_isOpen Whether the bubble is opening (false if closing).\n   *     Undefined for a blank event.\n   * @param opt_bubbleType The type of bubble. One of 'mutator', 'comment' or\n   *     'warning'. Undefined for a blank event.\n   */\n  constructor(\n    opt_block?: BlockSvg,\n    opt_isOpen?: boolean,\n    opt_bubbleType?: BubbleType,\n  ) {\n    const workspaceId = opt_block ? opt_block.workspace.id : undefined;\n    super(workspaceId);\n    if (!opt_block) return;\n\n    this.blockId = opt_block.id;\n    this.isOpen = opt_isOpen;\n    this.bubbleType = opt_bubbleType;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): BubbleOpenJson {\n    const json = super.toJson() as BubbleOpenJson;\n    if (this.isOpen === undefined) {\n      throw new Error(\n        'Whether this event is for opening the bubble is undefined. ' +\n          'Either pass the value to the constructor, or call fromJson',\n      );\n    }\n    if (!this.bubbleType) {\n      throw new Error(\n        'The type of bubble is undefined. Either pass the ' +\n          'value to the constructor, or call fromJson',\n      );\n    }\n    json['isOpen'] = this.isOpen;\n    json['bubbleType'] = this.bubbleType;\n    json['blockId'] = this.blockId || '';\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of BubbleOpen, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: BubbleOpenJson,\n    workspace: Workspace,\n    event?: any,\n  ): BubbleOpen {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new BubbleOpen(),\n    ) as BubbleOpen;\n    newEvent.isOpen = json['isOpen'];\n    newEvent.bubbleType = json['bubbleType'];\n    newEvent.blockId = json['blockId'];\n    return newEvent;\n  }\n}\n\nexport enum BubbleType {\n  MUTATOR = 'mutator',\n  COMMENT = 'comment',\n  WARNING = 'warning',\n}\n\nexport interface BubbleOpenJson extends AbstractEventJson {\n  isOpen: boolean;\n  bubbleType: BubbleType;\n  blockId: string;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.BUBBLE_OPEN, BubbleOpen);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Base class for comment events.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.CommentBase\n\nimport * as utilsXml from '../utils/xml.js';\nimport type {WorkspaceComment} from '../workspace_comment.js';\nimport * as Xml from '../xml.js';\n\nimport {\n  Abstract as AbstractEvent,\n  AbstractEventJson,\n} from './events_abstract.js';\nimport type {CommentCreate} from './events_comment_create.js';\nimport type {CommentDelete} from './events_comment_delete.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Abstract class for a comment event.\n */\nexport class CommentBase extends AbstractEvent {\n  override isBlank = true;\n\n  /** The ID of the comment that this event references. */\n  commentId?: string;\n\n  /**\n   * @param opt_comment The comment this event corresponds to.  Undefined for a\n   *     blank event.\n   */\n  constructor(opt_comment?: WorkspaceComment) {\n    super();\n    /** Whether or not an event is blank. */\n    this.isBlank = !opt_comment;\n\n    if (!opt_comment) return;\n\n    this.commentId = opt_comment.id;\n    this.workspaceId = opt_comment.workspace.id;\n    this.group = eventUtils.getGroup();\n    this.recordUndo = eventUtils.getRecordUndo();\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): CommentBaseJson {\n    const json = super.toJson() as CommentBaseJson;\n    if (!this.commentId) {\n      throw new Error(\n        'The comment ID is undefined. Either pass a comment to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    json['commentId'] = this.commentId;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of CommentBase, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: CommentBaseJson,\n    workspace: Workspace,\n    event?: any,\n  ): CommentBase {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new CommentBase(),\n    ) as CommentBase;\n    newEvent.commentId = json['commentId'];\n    return newEvent;\n  }\n\n  /**\n   * Helper function for Comment[Create|Delete]\n   *\n   * @param event The event to run.\n   * @param create if True then Create, if False then Delete\n   */\n  static CommentCreateDeleteHelper(\n    event: CommentCreate | CommentDelete,\n    create: boolean,\n  ) {\n    const workspace = event.getEventWorkspace_();\n    if (create) {\n      const xmlElement = utilsXml.createElement('xml');\n      if (!event.xml) {\n        throw new Error('Ecountered a comment event without proper xml');\n      }\n      xmlElement.appendChild(event.xml);\n      Xml.domToWorkspace(xmlElement, workspace);\n    } else {\n      if (!event.commentId) {\n        throw new Error(\n          'The comment ID is undefined. Either pass a comment to ' +\n            'the constructor, or call fromJson',\n        );\n      }\n      const comment = workspace.getCommentById(event.commentId);\n      if (comment) {\n        comment.dispose();\n      } else {\n        // Only complain about root-level block.\n        console.warn(\"Can't uncreate non-existent comment: \" + event.commentId);\n      }\n    }\n  }\n}\n\nexport interface CommentBaseJson extends AbstractEventJson {\n  commentId: string;\n}\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for comment change event.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.CommentChange\n\nimport * as registry from '../registry.js';\nimport type {WorkspaceComment} from '../workspace_comment.js';\n\nimport {CommentBase, CommentBaseJson} from './events_comment_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners that the contents of a workspace comment has changed.\n */\nexport class CommentChange extends CommentBase {\n  override type = eventUtils.COMMENT_CHANGE;\n\n  // TODO(#6774): We should remove underscores.\n  /** The previous contents of the comment. */\n  oldContents_?: string;\n\n  /** The new contents of the comment. */\n  newContents_?: string;\n\n  /**\n   * @param opt_comment The comment that is being changed.  Undefined for a\n   *     blank event.\n   * @param opt_oldContents Previous contents of the comment.\n   * @param opt_newContents New contents of the comment.\n   */\n  constructor(\n    opt_comment?: WorkspaceComment,\n    opt_oldContents?: string,\n    opt_newContents?: string,\n  ) {\n    super(opt_comment);\n\n    if (!opt_comment) {\n      return; // Blank event to be populated by fromJson.\n    }\n\n    this.oldContents_ =\n      typeof opt_oldContents === 'undefined' ? '' : opt_oldContents;\n    this.newContents_ =\n      typeof opt_newContents === 'undefined' ? '' : opt_newContents;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): CommentChangeJson {\n    const json = super.toJson() as CommentChangeJson;\n    if (!this.oldContents_) {\n      throw new Error(\n        'The old contents is undefined. Either pass a value to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (!this.newContents_) {\n      throw new Error(\n        'The new contents is undefined. Either pass a value to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    json['oldContents'] = this.oldContents_;\n    json['newContents'] = this.newContents_;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of CommentChange, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: CommentChangeJson,\n    workspace: Workspace,\n    event?: any,\n  ): CommentChange {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new CommentChange(),\n    ) as CommentChange;\n    newEvent.oldContents_ = json['oldContents'];\n    newEvent.newContents_ = json['newContents'];\n    return newEvent;\n  }\n\n  /**\n   * Does this event record any change of state?\n   *\n   * @returns False if something changed.\n   */\n  override isNull(): boolean {\n    return this.oldContents_ === this.newContents_;\n  }\n\n  /**\n   * Run a change event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    if (!this.commentId) {\n      throw new Error(\n        'The comment ID is undefined. Either pass a comment to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    const comment = workspace.getCommentById(this.commentId);\n    if (!comment) {\n      console.warn(\"Can't change non-existent comment: \" + this.commentId);\n      return;\n    }\n    const contents = forward ? this.newContents_ : this.oldContents_;\n    if (!contents) {\n      if (forward) {\n        throw new Error(\n          'The new contents is undefined. Either pass a value to ' +\n            'the constructor, or call fromJson',\n        );\n      }\n      throw new Error(\n        'The old contents is undefined. Either pass a value to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    comment.setContent(contents);\n  }\n}\n\nexport interface CommentChangeJson extends CommentBaseJson {\n  oldContents: string;\n  newContents: string;\n}\n\nregistry.register(\n  registry.Type.EVENT,\n  eventUtils.COMMENT_CHANGE,\n  CommentChange,\n);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for comment creation event.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.CommentCreate\n\nimport * as registry from '../registry.js';\nimport type {WorkspaceComment} from '../workspace_comment.js';\nimport * as utilsXml from '../utils/xml.js';\nimport * as Xml from '../xml.js';\n\nimport {CommentBase, CommentBaseJson} from './events_comment_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners that a workspace comment was created.\n */\nexport class CommentCreate extends CommentBase {\n  override type = eventUtils.COMMENT_CREATE;\n\n  /** The XML representation of the created workspace comment. */\n  xml?: Element | DocumentFragment;\n\n  /**\n   * @param opt_comment The created comment.\n   *     Undefined for a blank event.\n   */\n  constructor(opt_comment?: WorkspaceComment) {\n    super(opt_comment);\n\n    if (!opt_comment) {\n      return;\n    }\n    // Blank event to be populated by fromJson.\n    this.xml = opt_comment.toXmlWithXY();\n  }\n\n  // TODO (#1266): \"Full\" and \"minimal\" serialization.\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): CommentCreateJson {\n    const json = super.toJson() as CommentCreateJson;\n    if (!this.xml) {\n      throw new Error(\n        'The comment XML is undefined. Either pass a comment to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    json['xml'] = Xml.domToText(this.xml);\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of CommentCreate, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: CommentCreateJson,\n    workspace: Workspace,\n    event?: any,\n  ): CommentCreate {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new CommentCreate(),\n    ) as CommentCreate;\n    newEvent.xml = utilsXml.textToDom(json['xml']);\n    return newEvent;\n  }\n\n  /**\n   * Run a creation event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    CommentBase.CommentCreateDeleteHelper(this, forward);\n  }\n}\n\nexport interface CommentCreateJson extends CommentBaseJson {\n  xml: string;\n}\n\nregistry.register(\n  registry.Type.EVENT,\n  eventUtils.COMMENT_CREATE,\n  CommentCreate,\n);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for comment deletion event.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.CommentDelete\n\nimport * as registry from '../registry.js';\nimport type {WorkspaceComment} from '../workspace_comment.js';\n\nimport {CommentBase, CommentBaseJson} from './events_comment_base.js';\nimport * as eventUtils from './utils.js';\nimport * as utilsXml from '../utils/xml.js';\nimport * as Xml from '../xml.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners that a workspace comment has been deleted.\n */\nexport class CommentDelete extends CommentBase {\n  override type = eventUtils.COMMENT_DELETE;\n\n  /** The XML representation of the deleted workspace comment. */\n  xml?: Element;\n\n  /**\n   * @param opt_comment The deleted comment.\n   *     Undefined for a blank event.\n   */\n  constructor(opt_comment?: WorkspaceComment) {\n    super(opt_comment);\n\n    if (!opt_comment) {\n      return; // Blank event to be populated by fromJson.\n    }\n\n    this.xml = opt_comment.toXmlWithXY();\n  }\n\n  /**\n   * Run a creation event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    CommentBase.CommentCreateDeleteHelper(this, !forward);\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): CommentDeleteJson {\n    const json = super.toJson() as CommentDeleteJson;\n    if (!this.xml) {\n      throw new Error(\n        'The comment XML is undefined. Either pass a comment to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    json['xml'] = Xml.domToText(this.xml);\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of CommentDelete, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: CommentDeleteJson,\n    workspace: Workspace,\n    event?: any,\n  ): CommentDelete {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new CommentDelete(),\n    ) as CommentDelete;\n    newEvent.xml = utilsXml.textToDom(json['xml']);\n    return newEvent;\n  }\n}\n\nexport interface CommentDeleteJson extends CommentBaseJson {\n  xml: string;\n}\n\nregistry.register(\n  registry.Type.EVENT,\n  eventUtils.COMMENT_DELETE,\n  CommentDelete,\n);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for comment move event.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.CommentMove\n\nimport * as registry from '../registry.js';\nimport {Coordinate} from '../utils/coordinate.js';\nimport type {WorkspaceComment} from '../workspace_comment.js';\n\nimport {CommentBase, CommentBaseJson} from './events_comment_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners that a workspace comment has moved.\n */\nexport class CommentMove extends CommentBase {\n  override type = eventUtils.COMMENT_MOVE;\n\n  /** The comment that is being moved. */\n  comment_?: WorkspaceComment;\n\n  // TODO(#6774): We should remove underscores.\n  /** The location of the comment before the move, in workspace coordinates. */\n  oldCoordinate_?: Coordinate;\n\n  /** The location of the comment after the move, in workspace coordinates. */\n  newCoordinate_?: Coordinate;\n\n  /**\n   * @param opt_comment The comment that is being moved.  Undefined for a blank\n   *     event.\n   */\n  constructor(opt_comment?: WorkspaceComment) {\n    super(opt_comment);\n\n    if (!opt_comment) {\n      return; // Blank event to be populated by fromJson.\n    }\n\n    this.comment_ = opt_comment;\n    this.oldCoordinate_ = opt_comment.getRelativeToSurfaceXY();\n  }\n\n  /**\n   * Record the comment's new location.  Called after the move.  Can only be\n   * called once.\n   */\n  recordNew() {\n    if (this.newCoordinate_) {\n      throw Error(\n        'Tried to record the new position of a comment on the ' +\n          'same event twice.',\n      );\n    }\n    if (!this.comment_) {\n      throw new Error(\n        'The comment is undefined. Pass a comment to ' +\n          'the constructor if you want to use the record functionality',\n      );\n    }\n    this.newCoordinate_ = this.comment_.getRelativeToSurfaceXY();\n  }\n\n  /**\n   * Override the location before the move.  Use this if you don't create the\n   * event until the end of the move, but you know the original location.\n   *\n   * @param xy The location before the move, in workspace coordinates.\n   */\n  setOldCoordinate(xy: Coordinate) {\n    this.oldCoordinate_ = xy;\n  }\n\n  // TODO (#1266): \"Full\" and \"minimal\" serialization.\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): CommentMoveJson {\n    const json = super.toJson() as CommentMoveJson;\n    if (!this.oldCoordinate_) {\n      throw new Error(\n        'The old comment position is undefined. Either pass a comment to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (!this.newCoordinate_) {\n      throw new Error(\n        'The new comment position is undefined. Either call recordNew, or ' +\n          'call fromJson',\n      );\n    }\n    json['oldCoordinate'] =\n      `${Math.round(this.oldCoordinate_.x)}, ` +\n      `${Math.round(this.oldCoordinate_.y)}`;\n    json['newCoordinate'] =\n      Math.round(this.newCoordinate_.x) +\n      ',' +\n      Math.round(this.newCoordinate_.y);\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of CommentMove, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: CommentMoveJson,\n    workspace: Workspace,\n    event?: any,\n  ): CommentMove {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new CommentMove(),\n    ) as CommentMove;\n    let xy = json['oldCoordinate'].split(',');\n    newEvent.oldCoordinate_ = new Coordinate(Number(xy[0]), Number(xy[1]));\n    xy = json['newCoordinate'].split(',');\n    newEvent.newCoordinate_ = new Coordinate(Number(xy[0]), Number(xy[1]));\n    return newEvent;\n  }\n\n  /**\n   * Does this event record any change of state?\n   *\n   * @returns False if something changed.\n   */\n  override isNull(): boolean {\n    return Coordinate.equals(this.oldCoordinate_, this.newCoordinate_);\n  }\n\n  /**\n   * Run a move event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    if (!this.commentId) {\n      throw new Error(\n        'The comment ID is undefined. Either pass a comment to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    const comment = workspace.getCommentById(this.commentId);\n    if (!comment) {\n      console.warn(\"Can't move non-existent comment: \" + this.commentId);\n      return;\n    }\n\n    const target = forward ? this.newCoordinate_ : this.oldCoordinate_;\n    if (!target) {\n      throw new Error(\n        'Either oldCoordinate_ or newCoordinate_ is undefined. ' +\n          'Either pass a comment to the constructor and call recordNew, ' +\n          'or call fromJson',\n      );\n    }\n    // TODO: Check if the comment is being dragged, and give up if so.\n    const current = comment.getRelativeToSurfaceXY();\n    comment.moveBy(target.x - current.x, target.y - current.y);\n  }\n}\n\nexport interface CommentMoveJson extends CommentBaseJson {\n  oldCoordinate: string;\n  newCoordinate: string;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.COMMENT_MOVE, CommentMove);\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Events fired as a result of selecting an item on the toolbox.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.ToolboxItemSelect\n\nimport * as registry from '../registry.js';\nimport {AbstractEventJson} from './events_abstract.js';\nimport {UiBase} from './events_ui_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners that a toolbox item has been selected.\n */\nexport class ToolboxItemSelect extends UiBase {\n  /** The previously selected toolbox item. */\n  oldItem?: string;\n\n  /** The newly selected toolbox item. */\n  newItem?: string;\n\n  override type = eventUtils.TOOLBOX_ITEM_SELECT;\n\n  /**\n   * @param opt_oldItem The previously selected toolbox item.\n   *     Undefined for a blank event.\n   * @param opt_newItem The newly selected toolbox item. Undefined for a blank\n   *     event.\n   * @param opt_workspaceId The workspace identifier for this event.\n   *    Undefined for a blank event.\n   */\n  constructor(\n    opt_oldItem?: string | null,\n    opt_newItem?: string | null,\n    opt_workspaceId?: string,\n  ) {\n    super(opt_workspaceId);\n    this.oldItem = opt_oldItem ?? undefined;\n    this.newItem = opt_newItem ?? undefined;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): ToolboxItemSelectJson {\n    const json = super.toJson() as ToolboxItemSelectJson;\n    json['oldItem'] = this.oldItem;\n    json['newItem'] = this.newItem;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of ToolboxItemSelect, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: ToolboxItemSelectJson,\n    workspace: Workspace,\n    event?: any,\n  ): ToolboxItemSelect {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new ToolboxItemSelect(),\n    ) as ToolboxItemSelect;\n    newEvent.oldItem = json['oldItem'];\n    newEvent.newItem = json['newItem'];\n    return newEvent;\n  }\n}\n\nexport interface ToolboxItemSelectJson extends AbstractEventJson {\n  oldItem?: string;\n  newItem?: string;\n}\n\nregistry.register(\n  registry.Type.EVENT,\n  eventUtils.TOOLBOX_ITEM_SELECT,\n  ToolboxItemSelect,\n);\n","/**\n * @license\n * Copyright 2016 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.Events\n\nimport {Abstract, AbstractEventJson} from './events_abstract.js';\nimport {BlockBase, BlockBaseJson} from './events_block_base.js';\nimport {BlockChange, BlockChangeJson} from './events_block_change.js';\nimport {BlockCreate, BlockCreateJson} from './events_block_create.js';\nimport {BlockDelete, BlockDeleteJson} from './events_block_delete.js';\nimport {BlockDrag, BlockDragJson} from './events_block_drag.js';\nimport {\n  BlockFieldIntermediateChange,\n  BlockFieldIntermediateChangeJson,\n} from './events_block_field_intermediate_change.js';\nimport {BlockMove, BlockMoveJson} from './events_block_move.js';\nimport {BubbleOpen, BubbleOpenJson, BubbleType} from './events_bubble_open.js';\nimport {Click, ClickJson, ClickTarget} from './events_click.js';\nimport {CommentBase, CommentBaseJson} from './events_comment_base.js';\nimport {CommentChange, CommentChangeJson} from './events_comment_change.js';\nimport {CommentCreate, CommentCreateJson} from './events_comment_create.js';\nimport {CommentDelete} from './events_comment_delete.js';\nimport {CommentMove, CommentMoveJson} from './events_comment_move.js';\nimport {MarkerMove, MarkerMoveJson} from './events_marker_move.js';\nimport {Selected, SelectedJson} from './events_selected.js';\nimport {ThemeChange, ThemeChangeJson} from './events_theme_change.js';\nimport {\n  ToolboxItemSelect,\n  ToolboxItemSelectJson,\n} from './events_toolbox_item_select.js';\nimport {TrashcanOpen, TrashcanOpenJson} from './events_trashcan_open.js';\nimport {UiBase} from './events_ui_base.js';\nimport {VarBase, VarBaseJson} from './events_var_base.js';\nimport {VarCreate, VarCreateJson} from './events_var_create.js';\nimport {VarDelete, VarDeleteJson} from './events_var_delete.js';\nimport {VarRename, VarRenameJson} from './events_var_rename.js';\nimport {ViewportChange, ViewportChangeJson} from './events_viewport.js';\nimport * as eventUtils from './utils.js';\nimport {FinishedLoading} from './workspace_events.js';\n\n// Events.\nexport {Abstract};\nexport {AbstractEventJson};\nexport {BubbleOpen};\nexport {BubbleOpenJson};\nexport {BubbleType};\nexport {BlockBase};\nexport {BlockBaseJson};\nexport {BlockChange};\nexport {BlockChangeJson};\nexport {BlockCreate};\nexport {BlockCreateJson};\nexport {BlockDelete};\nexport {BlockDeleteJson};\nexport {BlockDrag};\nexport {BlockDragJson};\nexport {BlockFieldIntermediateChange};\nexport {BlockFieldIntermediateChangeJson};\nexport {BlockMove};\nexport {BlockMoveJson};\nexport {Click};\nexport {ClickJson};\nexport {ClickTarget};\nexport {CommentBase};\nexport {CommentBaseJson};\nexport {CommentChange};\nexport {CommentChangeJson};\nexport {CommentCreate};\nexport {CommentCreateJson};\nexport {CommentDelete};\nexport {CommentMove};\nexport {CommentMoveJson};\nexport {FinishedLoading};\nexport {MarkerMove};\nexport {MarkerMoveJson};\nexport {Selected};\nexport {SelectedJson};\nexport {ThemeChange};\nexport {ThemeChangeJson};\nexport {ToolboxItemSelect};\nexport {ToolboxItemSelectJson};\nexport {TrashcanOpen};\nexport {TrashcanOpenJson};\nexport {UiBase};\nexport {VarBase};\nexport {VarBaseJson};\nexport {VarCreate};\nexport {VarCreateJson};\nexport {VarDelete};\nexport {VarDeleteJson};\nexport {VarRename};\nexport {VarRenameJson};\nexport {ViewportChange};\nexport {ViewportChangeJson};\n\n// Event types.\nexport const BLOCK_CHANGE = eventUtils.BLOCK_CHANGE;\nexport const BLOCK_CREATE = eventUtils.BLOCK_CREATE;\nexport const BLOCK_DELETE = eventUtils.BLOCK_DELETE;\nexport const BLOCK_DRAG = eventUtils.BLOCK_DRAG;\nexport const BLOCK_MOVE = eventUtils.BLOCK_MOVE;\nexport const BLOCK_FIELD_INTERMEDIATE_CHANGE =\n  eventUtils.BLOCK_FIELD_INTERMEDIATE_CHANGE;\nexport const BUBBLE_OPEN = eventUtils.BUBBLE_OPEN;\nexport type BumpEvent = eventUtils.BumpEvent;\nexport const BUMP_EVENTS = eventUtils.BUMP_EVENTS;\nexport const CHANGE = eventUtils.CHANGE;\nexport const CLICK = eventUtils.CLICK;\nexport const COMMENT_CHANGE = eventUtils.COMMENT_CHANGE;\nexport const COMMENT_CREATE = eventUtils.COMMENT_CREATE;\nexport const COMMENT_DELETE = eventUtils.COMMENT_DELETE;\nexport const COMMENT_MOVE = eventUtils.COMMENT_MOVE;\nexport const CREATE = eventUtils.CREATE;\nexport const DELETE = eventUtils.DELETE;\nexport const FINISHED_LOADING = eventUtils.FINISHED_LOADING;\nexport const MARKER_MOVE = eventUtils.MARKER_MOVE;\nexport const MOVE = eventUtils.MOVE;\nexport const SELECTED = eventUtils.SELECTED;\nexport const THEME_CHANGE = eventUtils.THEME_CHANGE;\nexport const TOOLBOX_ITEM_SELECT = eventUtils.TOOLBOX_ITEM_SELECT;\nexport const TRASHCAN_OPEN = eventUtils.TRASHCAN_OPEN;\nexport const UI = eventUtils.UI;\nexport const VAR_CREATE = eventUtils.VAR_CREATE;\nexport const VAR_DELETE = eventUtils.VAR_DELETE;\nexport const VAR_RENAME = eventUtils.VAR_RENAME;\nexport const VIEWPORT_CHANGE = eventUtils.VIEWPORT_CHANGE;\n\n// Event utils.\nexport const clearPendingUndo = eventUtils.clearPendingUndo;\nexport const disable = eventUtils.disable;\nexport const enable = eventUtils.enable;\nexport const filter = eventUtils.filter;\nexport const fire = eventUtils.fire;\nexport const fromJson = eventUtils.fromJson;\nexport const getDescendantIds = eventUtils.getDescendantIds;\nexport const get = eventUtils.get;\nexport const getGroup = eventUtils.getGroup;\nexport const getRecordUndo = eventUtils.getRecordUndo;\nexport const isEnabled = eventUtils.isEnabled;\nexport const setGroup = eventUtils.setGroup;\nexport const setRecordUndo = eventUtils.setRecordUndo;\nexport const disableOrphans = eventUtils.disableOrphans;\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.zelos.ConstantProvider\n\nimport {ConnectionType} from '../../connection_type.js';\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {Theme} from '../../theme.js';\nimport * as utilsColour from '../../utils/colour.js';\nimport * as dom from '../../utils/dom.js';\nimport {Svg} from '../../utils/svg.js';\nimport * as svgPaths from '../../utils/svg_paths.js';\nimport {ConstantProvider as BaseConstantProvider} from '../common/constants.js';\nimport type {Shape} from '../common/constants.js';\n\n/** An object containing sizing and path information about inside corners. */\nexport interface InsideCorners {\n  width: number;\n  height: number;\n  pathTop: string;\n  pathBottom: string;\n  rightWidth: number;\n  rightHeight: number;\n  pathTopRight: string;\n  pathBottomRight: string;\n}\n\n/**\n * An object that provides constants for rendering blocks in Zelos mode.\n */\nexport class ConstantProvider extends BaseConstantProvider {\n  GRID_UNIT = 4;\n  STATEMENT_INPUT_SPACER_MIN_WIDTH: number;\n\n  override CURSOR_COLOUR = '#ffa200';\n\n  /**\n   * Radius of the cursor for input and output connections.\n   */\n  CURSOR_RADIUS = 5;\n\n  override JAGGED_TEETH_HEIGHT = 0;\n\n  override JAGGED_TEETH_WIDTH = 0;\n  override START_HAT_HEIGHT = 22;\n\n  override START_HAT_WIDTH = 96;\n\n  override SHAPES = {HEXAGONAL: 1, ROUND: 2, SQUARE: 3, PUZZLE: 4, NOTCH: 5};\n\n  /**\n   * Map of output/input shapes and the amount they should cause a block to be\n   * padded. Outer key is the outer shape, inner key is the inner shape.\n   * When a block with the outer shape contains an input block with the inner\n   * shape on its left or right edge, the block elements are aligned such that\n   * the padding specified is reached.\n   */\n  SHAPE_IN_SHAPE_PADDING: {[key: number]: {[key: number]: number}} = {\n    1: {\n      // Outer shape: hexagon.\n      0: 5 * this.GRID_UNIT, // Field in hexagon.\n      1: 2 * this.GRID_UNIT, // Hexagon in hexagon.\n      2: 5 * this.GRID_UNIT, // Round in hexagon.\n      3: 5 * this.GRID_UNIT, // Square in hexagon.\n    },\n    2: {\n      // Outer shape: round.\n      0: 3 * this.GRID_UNIT, // Field in round.\n      1: 3 * this.GRID_UNIT, // Hexagon in round.\n      2: 1 * this.GRID_UNIT, // Round in round.\n      3: 2 * this.GRID_UNIT, // Square in round.\n    },\n    3: {\n      // Outer shape: square.\n      0: 2 * this.GRID_UNIT, // Field in square.\n      1: 2 * this.GRID_UNIT, // Hexagon in square.\n      2: 2 * this.GRID_UNIT, // Round in square.\n      3: 2 * this.GRID_UNIT, // Square in square.\n    },\n  };\n\n  override FULL_BLOCK_FIELDS = true;\n\n  override FIELD_TEXT_FONTWEIGHT = 'bold';\n\n  override FIELD_TEXT_FONTFAMILY =\n    '\"Helvetica Neue\", \"Segoe UI\", Helvetica, sans-serif';\n\n  override FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW = true;\n\n  override FIELD_DROPDOWN_COLOURED_DIV = true;\n\n  override FIELD_DROPDOWN_SVG_ARROW = true;\n  override FIELD_TEXTINPUT_BOX_SHADOW = true;\n\n  override FIELD_COLOUR_FULL_BLOCK = true;\n  MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH: number;\n\n  /** The selected glow colour. */\n  SELECTED_GLOW_COLOUR = '#fff200';\n\n  /** The size of the selected glow. */\n  SELECTED_GLOW_SIZE = 0.5;\n\n  /** The replacement glow colour. */\n  REPLACEMENT_GLOW_COLOUR = '#fff200';\n\n  /** The size of the selected glow. */\n  REPLACEMENT_GLOW_SIZE = 2;\n\n  /**\n   * The ID of the selected glow filter, or the empty string if no filter is\n   * set.\n   */\n  selectedGlowFilterId = '';\n\n  /**\n   * The <filter> element to use for a selected glow, or null if not set.\n   */\n  private selectedGlowFilter: SVGElement | null = null;\n\n  /**\n   * The ID of the replacement glow filter, or the empty string if no filter\n   * is set.\n   */\n  replacementGlowFilterId = '';\n\n  /**\n   * The <filter> element to use for a replacement glow, or null if not set.\n   */\n  private replacementGlowFilter: SVGElement | null = null;\n\n  /**\n   * The object containing information about the hexagon used for a boolean\n   * reporter block. Null before init is called.\n   */\n  HEXAGONAL: Shape | null = null;\n\n  /**\n   * The object containing information about the hexagon used for a number or\n   * string reporter block. Null before init is called.\n   */\n  ROUNDED: Shape | null = null;\n\n  /**\n   * The object containing information about the hexagon used for a\n   * rectangular reporter block. Null before init is called.\n   */\n  SQUARED: Shape | null = null;\n\n  constructor() {\n    super();\n\n    this.SMALL_PADDING = this.GRID_UNIT;\n\n    this.MEDIUM_PADDING = 2 * this.GRID_UNIT;\n\n    this.MEDIUM_LARGE_PADDING = 3 * this.GRID_UNIT;\n\n    this.LARGE_PADDING = 4 * this.GRID_UNIT;\n\n    this.CORNER_RADIUS = 1 * this.GRID_UNIT;\n\n    this.NOTCH_WIDTH = 9 * this.GRID_UNIT;\n\n    this.NOTCH_HEIGHT = 2 * this.GRID_UNIT;\n\n    this.NOTCH_OFFSET_LEFT = 3 * this.GRID_UNIT;\n\n    this.STATEMENT_INPUT_NOTCH_OFFSET = this.NOTCH_OFFSET_LEFT;\n\n    this.MIN_BLOCK_WIDTH = 2 * this.GRID_UNIT;\n\n    this.MIN_BLOCK_HEIGHT = 12 * this.GRID_UNIT;\n\n    this.EMPTY_STATEMENT_INPUT_HEIGHT = 6 * this.GRID_UNIT;\n\n    this.TOP_ROW_MIN_HEIGHT = this.CORNER_RADIUS;\n\n    this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT = this.LARGE_PADDING;\n\n    this.BOTTOM_ROW_MIN_HEIGHT = this.CORNER_RADIUS;\n\n    this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT = 6 * this.GRID_UNIT;\n\n    this.STATEMENT_BOTTOM_SPACER = -this.NOTCH_HEIGHT;\n\n    /** Minimum statement input spacer width. */\n    this.STATEMENT_INPUT_SPACER_MIN_WIDTH = 40 * this.GRID_UNIT;\n\n    this.STATEMENT_INPUT_PADDING_LEFT = 4 * this.GRID_UNIT;\n\n    this.EMPTY_INLINE_INPUT_PADDING = 4 * this.GRID_UNIT;\n\n    this.EMPTY_INLINE_INPUT_HEIGHT = 8 * this.GRID_UNIT;\n\n    this.DUMMY_INPUT_MIN_HEIGHT = 8 * this.GRID_UNIT;\n\n    this.DUMMY_INPUT_SHADOW_MIN_HEIGHT = 6 * this.GRID_UNIT;\n\n    this.CURSOR_WS_WIDTH = 20 * this.GRID_UNIT;\n\n    this.FIELD_TEXT_FONTSIZE = 3 * this.GRID_UNIT;\n\n    this.FIELD_BORDER_RECT_RADIUS = this.CORNER_RADIUS;\n\n    this.FIELD_BORDER_RECT_X_PADDING = 2 * this.GRID_UNIT;\n\n    this.FIELD_BORDER_RECT_Y_PADDING = 1.625 * this.GRID_UNIT;\n\n    this.FIELD_BORDER_RECT_HEIGHT = 8 * this.GRID_UNIT;\n\n    this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT = 8 * this.GRID_UNIT;\n\n    this.FIELD_DROPDOWN_SVG_ARROW_PADDING = this.FIELD_BORDER_RECT_X_PADDING;\n\n    this.FIELD_COLOUR_DEFAULT_WIDTH = 6 * this.GRID_UNIT;\n\n    this.FIELD_COLOUR_DEFAULT_HEIGHT = 8 * this.GRID_UNIT;\n\n    this.FIELD_CHECKBOX_X_OFFSET = 1 * this.GRID_UNIT;\n\n    /** The maximum width of a dynamic connection shape. */\n    this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH = 12 * this.GRID_UNIT;\n  }\n\n  override setFontConstants_(theme: Theme) {\n    super.setFontConstants_(theme);\n\n    this.FIELD_BORDER_RECT_HEIGHT =\n      this.FIELD_TEXT_HEIGHT + this.FIELD_BORDER_RECT_Y_PADDING * 2;\n    this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT = this.FIELD_BORDER_RECT_HEIGHT;\n  }\n\n  override init() {\n    super.init();\n    this.HEXAGONAL = this.makeHexagonal();\n    this.ROUNDED = this.makeRounded();\n    this.SQUARED = this.makeSquared();\n\n    this.STATEMENT_INPUT_NOTCH_OFFSET =\n      this.NOTCH_OFFSET_LEFT +\n      (this.INSIDE_CORNERS as InsideCorners).rightWidth;\n  }\n\n  override setDynamicProperties_(theme: Theme) {\n    super.setDynamicProperties_(theme);\n\n    this.SELECTED_GLOW_COLOUR =\n      theme.getComponentStyle('selectedGlowColour') ||\n      this.SELECTED_GLOW_COLOUR;\n    const selectedGlowSize = Number(\n      theme.getComponentStyle('selectedGlowSize'),\n    );\n    this.SELECTED_GLOW_SIZE =\n      selectedGlowSize && !isNaN(selectedGlowSize)\n        ? selectedGlowSize\n        : this.SELECTED_GLOW_SIZE;\n    this.REPLACEMENT_GLOW_COLOUR =\n      theme.getComponentStyle('replacementGlowColour') ||\n      this.REPLACEMENT_GLOW_COLOUR;\n    const replacementGlowSize = Number(\n      theme.getComponentStyle('replacementGlowSize'),\n    );\n    this.REPLACEMENT_GLOW_SIZE =\n      replacementGlowSize && !isNaN(replacementGlowSize)\n        ? replacementGlowSize\n        : this.REPLACEMENT_GLOW_SIZE;\n  }\n\n  override dispose() {\n    super.dispose();\n    if (this.selectedGlowFilter) {\n      dom.removeNode(this.selectedGlowFilter);\n    }\n    if (this.replacementGlowFilter) {\n      dom.removeNode(this.replacementGlowFilter);\n    }\n  }\n\n  override makeStartHat() {\n    const height = this.START_HAT_HEIGHT;\n    const width = this.START_HAT_WIDTH;\n\n    const mainPath = svgPaths.curve('c', [\n      svgPaths.point(25, -height),\n      svgPaths.point(71, -height),\n      svgPaths.point(width, 0),\n    ]);\n    return {height, width, path: mainPath};\n  }\n\n  /**\n   * Create sizing and path information about a hexagonal shape.\n   *\n   * @returns An object containing sizing and path information about a hexagonal\n   *     shape for connections.\n   */\n  protected makeHexagonal(): Shape {\n    const maxWidth = this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;\n\n    /**\n     * Make the main path for the hexagonal connection shape out of two lines.\n     * The lines are defined with relative positions and require the block\n     * height. The 'up' and 'down' versions of the paths are the same, but the Y\n     * sign flips.  The 'left' and 'right' versions of the path are also the\n     * same, but the X sign flips.\n     *\n     * @param height The height of the block the connection is on.\n     * @param up True if the path should be drawn from bottom to top, false\n     *     otherwise.\n     * @param right True if the path is for the right side of the block.\n     * @returns A path fragment describing a rounded connection.\n     */\n    function makeMainPath(height: number, up: boolean, right: boolean): string {\n      const halfHeight = height / 2;\n      const width = halfHeight > maxWidth ? maxWidth : halfHeight;\n      const forward = up ? -1 : 1;\n      const direction = right ? -1 : 1;\n      const dy = (forward * height) / 2;\n      return (\n        svgPaths.lineTo(-direction * width, dy) +\n        svgPaths.lineTo(direction * width, dy)\n      );\n    }\n\n    return {\n      type: this.SHAPES.HEXAGONAL,\n      isDynamic: true,\n      width(height: number): number {\n        const halfHeight = height / 2;\n        return halfHeight > maxWidth ? maxWidth : halfHeight;\n      },\n      height(height: number): number {\n        return height;\n      },\n      connectionOffsetY(connectionHeight: number): number {\n        return connectionHeight / 2;\n      },\n      connectionOffsetX(connectionWidth: number): number {\n        return -connectionWidth;\n      },\n      pathDown(height: number): string {\n        return makeMainPath(height, false, false);\n      },\n      pathUp(height: number): string {\n        return makeMainPath(height, true, false);\n      },\n      pathRightDown(height: number): string {\n        return makeMainPath(height, false, true);\n      },\n      pathRightUp(height: number): string {\n        return makeMainPath(height, false, true);\n      },\n    };\n  }\n\n  /**\n   * Create sizing and path information about a rounded shape.\n   *\n   * @returns An object containing sizing and path information about a rounded\n   *     shape for connections.\n   */\n  protected makeRounded(): Shape {\n    const maxWidth = this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;\n    const maxHeight = maxWidth * 2;\n\n    /**\n     * Make the main path for the rounded connection shape out of two arcs and\n     * a line that joins them.  The arcs are defined with relative positions.\n     * Usually, the height of the block is split between the two arcs. In the\n     * case where the height of the block exceeds the maximum height, a line is\n     * drawn in between the two arcs. The 'up' and 'down' versions of the paths\n     * are the same, but the Y sign flips.  The 'up' and 'right' versions of the\n     * path flip the sweep-flag which moves the arc at negative angles.\n     *\n     * @param blockHeight The height of the block the connection is on.\n     * @param up True if the path should be drawn from bottom to top, false\n     *     otherwise.\n     * @param right True if the path is for the right side of the block.\n     * @returns A path fragment describing a rounded connection.\n     */\n    function makeMainPath(\n      blockHeight: number,\n      up: boolean,\n      right: boolean,\n    ): string {\n      const remainingHeight =\n        blockHeight > maxHeight ? blockHeight - maxHeight : 0;\n      const height = blockHeight > maxHeight ? maxHeight : blockHeight;\n      const radius = height / 2;\n      const sweep = right === up ? '0' : '1';\n      return (\n        svgPaths.arc(\n          'a',\n          '0 0,' + sweep,\n          radius,\n          svgPaths.point((right ? 1 : -1) * radius, (up ? -1 : 1) * radius),\n        ) +\n        svgPaths.lineOnAxis('v', (up ? -1 : 1) * remainingHeight) +\n        svgPaths.arc(\n          'a',\n          '0 0,' + sweep,\n          radius,\n          svgPaths.point((right ? -1 : 1) * radius, (up ? -1 : 1) * radius),\n        )\n      );\n    }\n\n    return {\n      type: this.SHAPES.ROUND,\n      isDynamic: true,\n      width(height: number): number {\n        const halfHeight = height / 2;\n        return halfHeight > maxWidth ? maxWidth : halfHeight;\n      },\n      height(height: number): number {\n        return height;\n      },\n      connectionOffsetY(connectionHeight: number): number {\n        return connectionHeight / 2;\n      },\n      connectionOffsetX(connectionWidth: number): number {\n        return -connectionWidth;\n      },\n      pathDown(height: number): string {\n        return makeMainPath(height, false, false);\n      },\n      pathUp(height: number): string {\n        return makeMainPath(height, true, false);\n      },\n      pathRightDown(height: number): string {\n        return makeMainPath(height, false, true);\n      },\n      pathRightUp(height: number): string {\n        return makeMainPath(height, false, true);\n      },\n    };\n  }\n\n  /**\n   * Create sizing and path information about a squared shape.\n   *\n   * @returns An object containing sizing and path information about a squared\n   *     shape for connections.\n   */\n  protected makeSquared(): Shape {\n    const radius = this.CORNER_RADIUS;\n\n    /**\n     * Make the main path for the squared connection shape out of two corners\n     * and a single line in-between (a and v). These are defined in relative\n     * positions and require the height of the block.\n     * The 'left' and 'right' versions of the paths are the same, but the Y sign\n     * flips.  The 'up' and 'down' versions of the path determine where the\n     * corner point is placed and in turn the direction of the corners.\n     *\n     * @param height The height of the block the connection is on.\n     * @param up True if the path should be drawn from bottom to top, false\n     *     otherwise.\n     * @param right True if the path is for the right side of the block.\n     * @returns A path fragment describing a squared connection.\n     */\n    function makeMainPath(height: number, up: boolean, right: boolean): string {\n      const innerHeight = height - radius * 2;\n      const sweep = right === up ? '0' : '1';\n      return (\n        svgPaths.arc(\n          'a',\n          '0 0,' + sweep,\n          radius,\n          svgPaths.point((right ? 1 : -1) * radius, (up ? -1 : 1) * radius),\n        ) +\n        svgPaths.lineOnAxis('v', (up ? -1 : 1) * innerHeight) +\n        svgPaths.arc(\n          'a',\n          '0 0,' + sweep,\n          radius,\n          svgPaths.point((right ? -1 : 1) * radius, (up ? -1 : 1) * radius),\n        )\n      );\n    }\n\n    return {\n      type: this.SHAPES.SQUARE,\n      isDynamic: true,\n      width(_height: number): number {\n        return radius;\n      },\n      height(height: number): number {\n        return height;\n      },\n      connectionOffsetY(connectionHeight: number): number {\n        return connectionHeight / 2;\n      },\n      connectionOffsetX(connectionWidth: number): number {\n        return -connectionWidth;\n      },\n      pathDown(height: number): string {\n        return makeMainPath(height, false, false);\n      },\n      pathUp(height: number): string {\n        return makeMainPath(height, true, false);\n      },\n      pathRightDown(height: number): string {\n        return makeMainPath(height, false, true);\n      },\n      pathRightUp(height: number): string {\n        return makeMainPath(height, false, true);\n      },\n    };\n  }\n\n  override shapeFor(connection: RenderedConnection): Shape {\n    let checks = connection.getCheck();\n    if (!checks && connection.targetConnection) {\n      checks = connection.targetConnection.getCheck();\n    }\n    let outputShape;\n    switch (connection.type) {\n      case ConnectionType.INPUT_VALUE:\n      case ConnectionType.OUTPUT_VALUE:\n        outputShape = connection.getSourceBlock().getOutputShape();\n        // If the block has an output shape set, use that instead.\n        if (outputShape !== null) {\n          switch (outputShape) {\n            case this.SHAPES.HEXAGONAL:\n              return this.HEXAGONAL!;\n            case this.SHAPES.ROUND:\n              return this.ROUNDED!;\n            case this.SHAPES.SQUARE:\n              return this.SQUARED!;\n          }\n        }\n        // Includes doesn't work in IE.\n        if (checks && checks.indexOf('Boolean') !== -1) {\n          return this.HEXAGONAL!;\n        }\n        if (checks && checks.indexOf('Number') !== -1) {\n          return this.ROUNDED!;\n        }\n        if (checks && checks.indexOf('String') !== -1) {\n          return this.ROUNDED!;\n        }\n        return this.ROUNDED!;\n      case ConnectionType.PREVIOUS_STATEMENT:\n      case ConnectionType.NEXT_STATEMENT:\n        return this.NOTCH!;\n      default:\n        throw Error('Unknown type');\n    }\n  }\n\n  override makeNotch() {\n    const width = this.NOTCH_WIDTH;\n    const height = this.NOTCH_HEIGHT;\n\n    const innerWidth = width / 3;\n    const curveWidth = innerWidth / 3;\n\n    const halfHeight = height / 2;\n    const quarterHeight = halfHeight / 2;\n\n    /**\n     * Make the main path for the notch.\n     *\n     * @param dir Direction multiplier to apply to horizontal offsets along the\n     *     path. Either 1 or -1.\n     * @returns A path fragment describing a notch.\n     */\n    function makeMainPath(dir: number): string {\n      return (\n        svgPaths.curve('c', [\n          svgPaths.point((dir * curveWidth) / 2, 0),\n          svgPaths.point((dir * curveWidth * 3) / 4, quarterHeight / 2),\n          svgPaths.point(dir * curveWidth, quarterHeight),\n        ]) +\n        svgPaths.line([svgPaths.point(dir * curveWidth, halfHeight)]) +\n        svgPaths.curve('c', [\n          svgPaths.point((dir * curveWidth) / 4, quarterHeight / 2),\n          svgPaths.point((dir * curveWidth) / 2, quarterHeight),\n          svgPaths.point(dir * curveWidth, quarterHeight),\n        ]) +\n        svgPaths.lineOnAxis('h', dir * innerWidth) +\n        svgPaths.curve('c', [\n          svgPaths.point((dir * curveWidth) / 2, 0),\n          svgPaths.point((dir * curveWidth * 3) / 4, -(quarterHeight / 2)),\n          svgPaths.point(dir * curveWidth, -quarterHeight),\n        ]) +\n        svgPaths.line([svgPaths.point(dir * curveWidth, -halfHeight)]) +\n        svgPaths.curve('c', [\n          svgPaths.point((dir * curveWidth) / 4, -(quarterHeight / 2)),\n          svgPaths.point((dir * curveWidth) / 2, -quarterHeight),\n          svgPaths.point(dir * curveWidth, -quarterHeight),\n        ])\n      );\n    }\n\n    const pathLeft = makeMainPath(1);\n    const pathRight = makeMainPath(-1);\n\n    return {\n      type: this.SHAPES.NOTCH,\n      width,\n      height,\n      pathLeft,\n      pathRight,\n    };\n  }\n\n  override makeInsideCorners() {\n    const radius = this.CORNER_RADIUS;\n\n    const innerTopLeftCorner = svgPaths.arc(\n      'a',\n      '0 0,0',\n      radius,\n      svgPaths.point(-radius, radius),\n    );\n\n    const innerTopRightCorner = svgPaths.arc(\n      'a',\n      '0 0,1',\n      radius,\n      svgPaths.point(-radius, radius),\n    );\n\n    const innerBottomLeftCorner = svgPaths.arc(\n      'a',\n      '0 0,0',\n      radius,\n      svgPaths.point(radius, radius),\n    );\n\n    const innerBottomRightCorner = svgPaths.arc(\n      'a',\n      '0 0,1',\n      radius,\n      svgPaths.point(radius, radius),\n    );\n\n    return {\n      width: radius,\n      height: radius,\n      pathTop: innerTopLeftCorner,\n      pathBottom: innerBottomLeftCorner,\n      rightWidth: radius,\n      rightHeight: radius,\n      pathTopRight: innerTopRightCorner,\n      pathBottomRight: innerBottomRightCorner,\n    };\n  }\n\n  override generateSecondaryColour_(colour: string) {\n    return utilsColour.blend('#000', colour, 0.15) || colour;\n  }\n\n  override generateTertiaryColour_(colour: string) {\n    return utilsColour.blend('#000', colour, 0.25) || colour;\n  }\n\n  override createDom(svg: SVGElement, tagName: string, selector: string) {\n    super.createDom(svg, tagName, selector);\n    /*\n        <defs>\n          ... filters go here ...\n        </defs>\n        */\n    const defs = dom.createSvgElement(Svg.DEFS, {}, svg);\n    // Using a dilate distorts the block shape.\n    // Instead use a gaussian blur, and then set all alpha to 1 with a transfer.\n    const selectedGlowFilter = dom.createSvgElement(\n      Svg.FILTER,\n      {\n        'id': 'blocklySelectedGlowFilter' + this.randomIdentifier,\n        'height': '160%',\n        'width': '180%',\n        'y': '-30%',\n        'x': '-40%',\n      },\n      defs,\n    );\n    dom.createSvgElement(\n      Svg.FEGAUSSIANBLUR,\n      {'in': 'SourceGraphic', 'stdDeviation': this.SELECTED_GLOW_SIZE},\n      selectedGlowFilter,\n    );\n    // Set all gaussian blur pixels to 1 opacity before applying flood\n    const selectedComponentTransfer = dom.createSvgElement(\n      Svg.FECOMPONENTTRANSFER,\n      {'result': 'outBlur'},\n      selectedGlowFilter,\n    );\n    dom.createSvgElement(\n      Svg.FEFUNCA,\n      {'type': 'table', 'tableValues': '0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1'},\n      selectedComponentTransfer,\n    );\n    // Color the highlight\n    dom.createSvgElement(\n      Svg.FEFLOOD,\n      {\n        'flood-color': this.SELECTED_GLOW_COLOUR,\n        'flood-opacity': 1,\n        'result': 'outColor',\n      },\n      selectedGlowFilter,\n    );\n    dom.createSvgElement(\n      Svg.FECOMPOSITE,\n      {\n        'in': 'outColor',\n        'in2': 'outBlur',\n        'operator': 'in',\n        'result': 'outGlow',\n      },\n      selectedGlowFilter,\n    );\n    this.selectedGlowFilterId = selectedGlowFilter.id;\n    this.selectedGlowFilter = selectedGlowFilter;\n\n    // Using a dilate distorts the block shape.\n    // Instead use a gaussian blur, and then set all alpha to 1 with a transfer.\n    const replacementGlowFilter = dom.createSvgElement(\n      Svg.FILTER,\n      {\n        'id': 'blocklyReplacementGlowFilter' + this.randomIdentifier,\n        'height': '160%',\n        'width': '180%',\n        'y': '-30%',\n        'x': '-40%',\n      },\n      defs,\n    );\n    dom.createSvgElement(\n      Svg.FEGAUSSIANBLUR,\n      {'in': 'SourceGraphic', 'stdDeviation': this.REPLACEMENT_GLOW_SIZE},\n      replacementGlowFilter,\n    );\n    // Set all gaussian blur pixels to 1 opacity before applying flood\n    const replacementComponentTransfer = dom.createSvgElement(\n      Svg.FECOMPONENTTRANSFER,\n      {'result': 'outBlur'},\n      replacementGlowFilter,\n    );\n    dom.createSvgElement(\n      Svg.FEFUNCA,\n      {'type': 'table', 'tableValues': '0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1'},\n      replacementComponentTransfer,\n    );\n    // Color the highlight\n    dom.createSvgElement(\n      Svg.FEFLOOD,\n      {\n        'flood-color': this.REPLACEMENT_GLOW_COLOUR,\n        'flood-opacity': 1,\n        'result': 'outColor',\n      },\n      replacementGlowFilter,\n    );\n    dom.createSvgElement(\n      Svg.FECOMPOSITE,\n      {\n        'in': 'outColor',\n        'in2': 'outBlur',\n        'operator': 'in',\n        'result': 'outGlow',\n      },\n      replacementGlowFilter,\n    );\n    dom.createSvgElement(\n      Svg.FECOMPOSITE,\n      {\n        'in': 'SourceGraphic',\n        'in2': 'outGlow',\n        'operator': 'over',\n      },\n      replacementGlowFilter,\n    );\n    this.replacementGlowFilterId = replacementGlowFilter.id;\n    this.replacementGlowFilter = replacementGlowFilter;\n  }\n\n  override getCSS_(selector: string) {\n    return [\n      /* eslint-disable indent */\n      // Text.\n      `${selector} .blocklyText,`,\n      `${selector} .blocklyFlyoutLabelText {`,\n      `font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}` +\n        `pt ${this.FIELD_TEXT_FONTFAMILY};`,\n      `}`,\n\n      // Fields.\n      `${selector} .blocklyText {`,\n      `fill: #fff;`,\n      `}`,\n      `${selector} .blocklyNonEditableText>rect:not(.blocklyDropdownRect),`,\n      `${selector} .blocklyEditableText>rect:not(.blocklyDropdownRect) {`,\n      `fill: ${this.FIELD_BORDER_RECT_COLOUR};`,\n      `}`,\n      `${selector} .blocklyNonEditableText>text,`,\n      `${selector} .blocklyEditableText>text,`,\n      `${selector} .blocklyNonEditableText>g>text,`,\n      `${selector} .blocklyEditableText>g>text {`,\n      `fill: #575E75;`,\n      `}`,\n\n      // Flyout labels.\n      `${selector} .blocklyFlyoutLabelText {`,\n      `fill: #575E75;`,\n      `}`,\n\n      // Bubbles.\n      `${selector} .blocklyText.blocklyBubbleText {`,\n      `fill: #575E75;`,\n      `}`,\n\n      // Editable field hover.\n      `${selector} .blocklyDraggable:not(.blocklyDisabled)`,\n      ` .blocklyEditableText:not(.editing):hover>rect,`,\n      `${selector} .blocklyDraggable:not(.blocklyDisabled)`,\n      ` .blocklyEditableText:not(.editing):hover>.blocklyPath {`,\n      `stroke: #fff;`,\n      `stroke-width: 2;`,\n      `}`,\n\n      // Text field input.\n      `${selector} .blocklyHtmlInput {`,\n      `font-family: ${this.FIELD_TEXT_FONTFAMILY};`,\n      `font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,\n      `color: #575E75;`,\n      `}`,\n\n      // Dropdown field.\n      `${selector} .blocklyDropdownText {`,\n      `fill: #fff !important;`,\n      `}`,\n\n      // Widget and Dropdown Div\n      `${selector}.blocklyWidgetDiv .goog-menuitem,`,\n      `${selector}.blocklyDropDownDiv .goog-menuitem {`,\n      `font-family: ${this.FIELD_TEXT_FONTFAMILY};`,\n      `}`,\n      `${selector}.blocklyDropDownDiv .goog-menuitem-content {`,\n      `color: #fff;`,\n      `}`,\n\n      // Connection highlight.\n      `${selector} .blocklyHighlightedConnectionPath {`,\n      `stroke: ${this.SELECTED_GLOW_COLOUR};`,\n      `}`,\n\n      // Disabled outline paths.\n      `${selector} .blocklyDisabled > .blocklyOutlinePath {`,\n      `fill: url(#blocklyDisabledPattern${this.randomIdentifier})`,\n      `}`,\n\n      // Insertion marker.\n      `${selector} .blocklyInsertionMarker>.blocklyPath {`,\n      `fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,\n      `stroke: none;`,\n      `}`,\n    ];\n  }\n}\n/* eslint-enable indent */\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.zelos.Drawer\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport {ConnectionType} from '../../connection_type.js';\nimport * as svgPaths from '../../utils/svg_paths.js';\nimport type {BaseShape, DynamicShape, Notch} from '../common/constants.js';\nimport {Drawer as BaseDrawer} from '../common/drawer.js';\nimport {Connection} from '../measurables/connection.js';\nimport type {InlineInput} from '../measurables/inline_input.js';\nimport {OutputConnection} from '../measurables/output_connection.js';\nimport type {Row} from '../measurables/row.js';\nimport type {SpacerRow} from '../measurables/spacer_row.js';\nimport {Types} from '../measurables/types.js';\n\nimport type {InsideCorners} from './constants.js';\nimport type {RenderInfo} from './info.js';\nimport type {StatementInput} from './measurables/inputs.js';\nimport type {PathObject} from './path_object.js';\n\n/**\n * An object that draws a block based on the given rendering information.\n */\nexport class Drawer extends BaseDrawer {\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  override info_!: RenderInfo;\n\n  /**\n   * @param block The block to render.\n   * @param info An object containing all information needed to render this\n   *     block.\n   */\n  constructor(block: BlockSvg, info: RenderInfo) {\n    super(block, info);\n  }\n\n  override draw() {\n    const pathObject = this.block_.pathObject as PathObject;\n    pathObject.beginDrawing();\n    this.drawOutline_();\n    this.drawInternals_();\n    this.updateConnectionHighlights();\n\n    pathObject.setPath(this.outlinePath_ + '\\n' + this.inlinePath_);\n    if (this.info_.RTL) {\n      pathObject.flipRTL();\n    }\n    this.recordSizeOnBlock_();\n    if (this.info_.outputConnection) {\n      // Store the output connection shape type for parent blocks to use during\n      // rendering.\n      pathObject.outputShapeType = this.info_.outputConnection.shape.type;\n    }\n    pathObject.endDrawing();\n  }\n\n  override drawOutline_() {\n    if (\n      this.info_.outputConnection &&\n      this.info_.outputConnection.isDynamicShape &&\n      !this.info_.hasStatementInput &&\n      !this.info_.bottomRow.hasNextConnection\n    ) {\n      this.drawFlatTop_();\n      this.drawRightDynamicConnection_();\n      this.drawFlatBottom_();\n      this.drawLeftDynamicConnection_();\n    } else {\n      super.drawOutline_();\n    }\n  }\n\n  override drawLeft_() {\n    if (\n      this.info_.outputConnection &&\n      this.info_.outputConnection.isDynamicShape\n    ) {\n      this.drawLeftDynamicConnection_();\n    } else {\n      super.drawLeft_();\n    }\n  }\n\n  /**\n   * Add steps for the right side of a row that does not have value or\n   * statement input connections.\n   *\n   * @param row The row to draw the side of.\n   */\n  protected override drawRightSideRow_(row: Row) {\n    if (row.height <= 0) {\n      return;\n    }\n    if (Types.isSpacer(row)) {\n      const spacerRow = row as SpacerRow;\n      const precedesStatement = spacerRow.precedesStatement;\n      const followsStatement = spacerRow.followsStatement;\n      if (precedesStatement || followsStatement) {\n        const insideCorners = this.constants_.INSIDE_CORNERS as InsideCorners;\n        const cornerHeight = insideCorners.rightHeight;\n        const remainingHeight =\n          spacerRow.height - (precedesStatement ? cornerHeight : 0);\n        const bottomRightPath = followsStatement\n          ? insideCorners.pathBottomRight\n          : '';\n        const verticalPath =\n          remainingHeight > 0\n            ? svgPaths.lineOnAxis('V', spacerRow.yPos + remainingHeight)\n            : '';\n        const topRightPath = precedesStatement\n          ? insideCorners.pathTopRight\n          : '';\n        // Put all of the partial paths together.\n        this.outlinePath_ += bottomRightPath + verticalPath + topRightPath;\n        return;\n      }\n    }\n    this.outlinePath_ += svgPaths.lineOnAxis('V', row.yPos + row.height);\n  }\n\n  /**\n   * Add steps to draw the right side of an output with a dynamic connection.\n   */\n  protected drawRightDynamicConnection_() {\n    if (!this.info_.outputConnection) {\n      throw new Error(\n        `Cannot draw the output connection of a block that doesn't have one`,\n      );\n    }\n    this.outlinePath_ += (\n      this.info_.outputConnection.shape as DynamicShape\n    ).pathRightDown(this.info_.outputConnection.height);\n  }\n\n  /**\n   * Add steps to draw the left side of an output with a dynamic connection.\n   */\n  protected drawLeftDynamicConnection_() {\n    if (!this.info_.outputConnection) {\n      throw new Error(\n        `Cannot draw the output connection of a block that doesn't have one`,\n      );\n    }\n    this.positionOutputConnection_();\n\n    this.outlinePath_ += (\n      this.info_.outputConnection.shape as DynamicShape\n    ).pathUp(this.info_.outputConnection.height);\n\n    // Close off the path.  This draws a vertical line up to the start of the\n    // block's path, which may be either a rounded or a sharp corner.\n    this.outlinePath_ += 'z';\n  }\n\n  /** Add steps to draw a flat top row. */\n  protected drawFlatTop_() {\n    const topRow = this.info_.topRow;\n    this.positionPreviousConnection_();\n\n    this.outlinePath_ += svgPaths.moveBy(topRow.xPos, this.info_.startY);\n    this.outlinePath_ += svgPaths.lineOnAxis('h', topRow.width);\n  }\n\n  /** Add steps to draw a flat bottom row. */\n  protected drawFlatBottom_() {\n    const bottomRow = this.info_.bottomRow;\n    this.positionNextConnection_();\n\n    this.outlinePath_ += svgPaths.lineOnAxis('V', bottomRow.baseline);\n    this.outlinePath_ += svgPaths.lineOnAxis('h', -bottomRow.width);\n  }\n\n  override drawInlineInput_(input: InlineInput) {\n    this.positionInlineInputConnection_(input);\n\n    const inputName = input.input.name;\n    if (input.connectedBlock || this.info_.isInsertionMarker) {\n      return;\n    }\n\n    const yPos = input.centerline - input.height / 2;\n    const connectionRight = input.xPos + input.connectionWidth;\n\n    const path =\n      svgPaths.moveTo(connectionRight, yPos) + this.getInlineInputPath(input);\n\n    const pathObject = this.block_.pathObject as PathObject;\n    pathObject.setOutlinePath(inputName, path);\n  }\n\n  private getInlineInputPath(input: InlineInput) {\n    const width = input.width - input.connectionWidth * 2;\n    const height = input.height;\n\n    return (\n      svgPaths.lineOnAxis('h', width) +\n      (input.shape as DynamicShape).pathRightDown(height) +\n      svgPaths.lineOnAxis('h', -width) +\n      (input.shape as DynamicShape).pathUp(height) +\n      'z'\n    );\n  }\n\n  override drawStatementInput_(row: Row) {\n    const input = row.getLastInput() as StatementInput;\n    // Where to start drawing the notch, which is on the right side in LTR.\n    const x = input.xPos + input.notchOffset + (input.shape as BaseShape).width;\n\n    const insideCorners = this.constants_.INSIDE_CORNERS;\n    const innerTopLeftCorner =\n      (input.shape as Notch).pathRight +\n      svgPaths.lineOnAxis('h', -(input.notchOffset - insideCorners.width)) +\n      insideCorners.pathTop;\n\n    const innerHeight = row.height - 2 * insideCorners.height;\n\n    const innerBottomLeftCorner =\n      insideCorners.pathBottom +\n      svgPaths.lineOnAxis('h', input.notchOffset - insideCorners.width) +\n      (input.connectedBottomNextConnection\n        ? ''\n        : (input.shape as Notch).pathLeft);\n\n    this.outlinePath_ +=\n      svgPaths.lineOnAxis('H', x) +\n      innerTopLeftCorner +\n      svgPaths.lineOnAxis('v', innerHeight) +\n      innerBottomLeftCorner +\n      svgPaths.lineOnAxis('H', row.xPos + row.width);\n\n    this.positionStatementInputConnection_(row);\n  }\n\n  /** Returns a path to highlight the given connection. */\n  drawConnectionHighlightPath(measurable: Connection) {\n    const conn = measurable.connectionModel;\n    if (\n      conn.type === ConnectionType.NEXT_STATEMENT ||\n      conn.type === ConnectionType.PREVIOUS_STATEMENT ||\n      (conn.type === ConnectionType.OUTPUT_VALUE && !measurable.isDynamicShape)\n    ) {\n      super.drawConnectionHighlightPath(measurable);\n      return;\n    }\n\n    let path = '';\n    if (conn.type === ConnectionType.INPUT_VALUE) {\n      const input = measurable as InlineInput;\n      const xPos = input.connectionWidth;\n      const yPos = -input.height / 2;\n      path = svgPaths.moveTo(xPos, yPos) + this.getInlineInputPath(input);\n    } else {\n      // Dynamic output.\n      const output = measurable as OutputConnection;\n      const xPos = output.width;\n      const yPos = -output.height / 2;\n      path =\n        svgPaths.moveTo(xPos, yPos) +\n        (output.shape as DynamicShape).pathDown(output.height);\n    }\n    const block = conn.getSourceBlock();\n    block.pathObject.addConnectionHighlight?.(\n      conn,\n      path,\n      conn.getOffsetInBlock(),\n      block.RTL,\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Image field.  Used for pictures, icons, etc.\n *\n * @class\n */\n// Former goog.module ID: Blockly.FieldImage\n\nimport {Field, FieldConfig} from './field.js';\nimport * as fieldRegistry from './field_registry.js';\nimport * as dom from './utils/dom.js';\nimport * as parsing from './utils/parsing.js';\nimport {Size} from './utils/size.js';\nimport {Svg} from './utils/svg.js';\n\n/**\n * Class for an image on a block.\n */\nexport class FieldImage extends Field<string> {\n  /**\n   * Vertical padding below the image, which is included in the reported height\n   * of the field.\n   */\n  private static readonly Y_PADDING = 1;\n  protected override size_: Size;\n  protected readonly imageHeight: number;\n\n  /** The function to be called when this field is clicked. */\n  private clickHandler: ((p1: FieldImage) => void) | null = null;\n\n  /** The rendered field's image element. */\n  protected imageElement: SVGImageElement | null = null;\n\n  /**\n   * Editable fields usually show some sort of UI indicating they are\n   * editable. This field should not.\n   */\n  override readonly EDITABLE = false;\n\n  /**\n   * Used to tell if the field needs to be rendered the next time the block is\n   * rendered. Image fields are statically sized, and only need to be\n   * rendered at initialization.\n   */\n  protected override isDirty_ = false;\n\n  /** Whether to flip this image in RTL. */\n  private flipRtl = false;\n\n  /** Alt text of this image. */\n  private altText = '';\n\n  /**\n   * @param src The URL of the image.\n   *     Also accepts Field.SKIP_SETUP if you wish to skip setup (only used by\n   * subclasses that want to handle configuration and setting the field value\n   * after their own constructors have run).\n   * @param width Width of the image.\n   * @param height Height of the image.\n   * @param alt Optional alt text for when block is collapsed.\n   * @param onClick Optional function to be called when the image is\n   *     clicked. If onClick is defined, alt must also be defined.\n   * @param flipRtl Whether to flip the icon in RTL.\n   * @param config A map of options used to configure the field.\n   *     See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/image#creation}\n   * for a list of properties this parameter supports.\n   */\n  constructor(\n    src: string | typeof Field.SKIP_SETUP,\n    width: string | number,\n    height: string | number,\n    alt?: string,\n    onClick?: (p1: FieldImage) => void,\n    flipRtl?: boolean,\n    config?: FieldImageConfig,\n  ) {\n    super(Field.SKIP_SETUP);\n\n    const imageHeight = Number(parsing.replaceMessageReferences(height));\n    const imageWidth = Number(parsing.replaceMessageReferences(width));\n    if (isNaN(imageHeight) || isNaN(imageWidth)) {\n      throw Error(\n        'Height and width values of an image field must cast to' + ' numbers.',\n      );\n    }\n    if (imageHeight <= 0 || imageWidth <= 0) {\n      throw Error(\n        'Height and width values of an image field must be greater' +\n          ' than 0.',\n      );\n    }\n\n    /** The size of the area rendered by the field. */\n    this.size_ = new Size(imageWidth, imageHeight + FieldImage.Y_PADDING);\n\n    /**\n     * Store the image height, since it is different from the field height.\n     */\n    this.imageHeight = imageHeight;\n\n    if (typeof onClick === 'function') {\n      this.clickHandler = onClick;\n    }\n\n    if (src === Field.SKIP_SETUP) return;\n\n    if (config) {\n      this.configure_(config);\n    } else {\n      this.flipRtl = !!flipRtl;\n      this.altText = parsing.replaceMessageReferences(alt) || '';\n    }\n    this.setValue(parsing.replaceMessageReferences(src));\n  }\n\n  /**\n   * Configure the field based on the given map of options.\n   *\n   * @param config A map of options to configure the field based on.\n   */\n  protected override configure_(config: FieldImageConfig) {\n    super.configure_(config);\n    if (config.flipRtl) this.flipRtl = config.flipRtl;\n    if (config.alt) {\n      this.altText = parsing.replaceMessageReferences(config.alt);\n    }\n  }\n\n  /**\n   * Create the block UI for this image.\n   */\n  override initView() {\n    this.imageElement = dom.createSvgElement(\n      Svg.IMAGE,\n      {\n        'height': this.imageHeight + 'px',\n        'width': this.size_.width + 'px',\n        'alt': this.altText,\n      },\n      this.fieldGroup_,\n    );\n    this.imageElement.setAttributeNS(\n      dom.XLINK_NS,\n      'xlink:href',\n      this.value_ as string,\n    );\n\n    if (this.clickHandler) {\n      this.imageElement.style.cursor = 'pointer';\n    }\n  }\n\n  override updateSize_() {}\n  // NOP\n\n  /**\n   * Ensure that the input value (the source URL) is a string.\n   *\n   * @param newValue The input value.\n   * @returns A string, or null if invalid.\n   */\n  protected override doClassValidation_(newValue?: any): string | null {\n    if (typeof newValue !== 'string') {\n      return null;\n    }\n    return newValue;\n  }\n\n  /**\n   * Update the value of this image field, and update the displayed image.\n   *\n   * @param newValue The value to be saved. The default validator guarantees\n   *     that this is a string.\n   */\n  protected override doValueUpdate_(newValue: string) {\n    this.value_ = newValue;\n    if (this.imageElement) {\n      this.imageElement.setAttributeNS(dom.XLINK_NS, 'xlink:href', this.value_);\n    }\n  }\n\n  /**\n   * Get whether to flip this image in RTL\n   *\n   * @returns True if we should flip in RTL.\n   */\n  override getFlipRtl(): boolean {\n    return this.flipRtl;\n  }\n\n  /**\n   * Set the alt text of this image.\n   *\n   * @param alt New alt text.\n   */\n  setAlt(alt: string | null) {\n    if (alt === this.altText) {\n      return;\n    }\n    this.altText = alt || '';\n    if (this.imageElement) {\n      this.imageElement.setAttribute('alt', this.altText);\n    }\n  }\n\n  /**\n   * If field click is called, and click handler defined,\n   * call the handler.\n   */\n  protected override showEditor_() {\n    if (this.clickHandler) {\n      this.clickHandler(this);\n    }\n  }\n\n  /**\n   * Set the function that is called when this image  is clicked.\n   *\n   * @param func The function that is called when the image is clicked, or null\n   *     to remove.\n   */\n  setOnClickHandler(func: ((p1: FieldImage) => void) | null) {\n    this.clickHandler = func;\n  }\n\n  /**\n   * Use the `getText_` developer hook to override the field's text\n   * representation.\n   * Return the image alt text instead.\n   *\n   * @returns The image alt text.\n   */\n  protected override getText_(): string | null {\n    return this.altText;\n  }\n\n  /**\n   * Construct a FieldImage from a JSON arg object,\n   * dereferencing any string table references.\n   *\n   * @param options A JSON object with options (src, width, height, alt, and\n   *     flipRtl).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static fromJson(options: FieldImageFromJsonConfig): FieldImage {\n    if (!options.src || !options.width || !options.height) {\n      throw new Error(\n        'src, width, and height values for an image field are' +\n          'required. The width and height must be non-zero.',\n      );\n    }\n    // `this` might be a subclass of FieldImage if that class doesn't override\n    // the static fromJson method.\n    return new this(\n      options.src,\n      options.width,\n      options.height,\n      undefined,\n      undefined,\n      undefined,\n      options,\n    );\n  }\n}\n\nfieldRegistry.register('field_image', FieldImage);\n\nFieldImage.prototype.DEFAULT_VALUE = '';\n\n/**\n * Config options for the image field.\n */\nexport interface FieldImageConfig extends FieldConfig {\n  flipRtl?: boolean;\n  alt?: string;\n}\n\n/**\n * fromJson config options for the colour field.\n */\nexport interface FieldImageFromJsonConfig extends FieldImageConfig {\n  src?: string;\n  width?: number;\n  height?: number;\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Text input field.\n *\n * @class\n */\n// Former goog.module ID: Blockly.FieldInput\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_change.js';\n\nimport {BlockSvg} from './block_svg.js';\nimport * as bumpObjects from './bump_objects.js';\nimport * as browserEvents from './browser_events.js';\nimport * as dialog from './dialog.js';\nimport * as dom from './utils/dom.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport * as eventUtils from './events/utils.js';\nimport {\n  Field,\n  FieldConfig,\n  FieldValidator,\n  UnattachedFieldError,\n} from './field.js';\nimport {Msg} from './msg.js';\nimport * as aria from './utils/aria.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as userAgent from './utils/useragent.js';\nimport * as WidgetDiv from './widgetdiv.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport {Size} from './utils/size.js';\n\n/**\n * Supported types for FieldInput subclasses.\n *\n * @internal\n */\ntype InputTypes = string | number;\n\n/**\n * Abstract class for an editable input field.\n *\n * @typeParam T - The value stored on the field.\n * @internal\n */\nexport abstract class FieldInput<T extends InputTypes> extends Field<\n  string | T\n> {\n  /**\n   * Pixel size of input border radius.\n   * Should match blocklyText's border-radius in CSS.\n   */\n  static BORDERRADIUS = 4;\n\n  /** Allow browser to spellcheck this field. */\n  protected spellcheck_ = true;\n\n  /** The HTML input element. */\n  protected htmlInput_: HTMLInputElement | null = null;\n\n  /** True if the field's value is currently being edited via the UI. */\n  protected isBeingEdited_ = false;\n\n  /**\n   * True if the value currently displayed in the field's editory UI is valid.\n   */\n  protected isTextValid_ = false;\n\n  /**\n   * The intial value of the field when the user opened an editor to change its\n   * value. When the editor is disposed, an event will be fired that uses this\n   * as the event's oldValue.\n   */\n  protected valueWhenEditorWasOpened_: string | T | null = null;\n\n  /** Key down event data. */\n  private onKeyDownWrapper_: browserEvents.Data | null = null;\n\n  /** Key input event data. */\n  private onKeyInputWrapper_: browserEvents.Data | null = null;\n\n  /**\n   * Whether the field should consider the whole parent block to be its click\n   * target.\n   */\n  fullBlockClickTarget_: boolean = false;\n\n  /** The workspace that this field belongs to. */\n  protected workspace_: WorkspaceSvg | null = null;\n\n  /**\n   * Serializable fields are saved by the serializer, non-serializable fields\n   * are not. Editable fields should also be serializable.\n   */\n  override SERIALIZABLE = true;\n\n  /** Mouse cursor style when over the hotspot that initiates the editor. */\n  override CURSOR = 'text';\n\n  /**\n   * @param value The initial value of the field. Should cast to a string.\n   *     Defaults to an empty string if null or undefined. Also accepts\n   *     Field.SKIP_SETUP if you wish to skip setup (only used by subclasses\n   *     that want to handle configuration and setting the field value after\n   *     their own constructors have run).\n   * @param validator A function that is called to validate changes to the\n   *     field's value. Takes in a string & returns a validated string, or null\n   *     to abort the change.\n   * @param config A map of options used to configure the field.\n   *     See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/text-input#creation}\n   * for a list of properties this parameter supports.\n   */\n  constructor(\n    value?: string | typeof Field.SKIP_SETUP,\n    validator?: FieldInputValidator<T> | null,\n    config?: FieldInputConfig,\n  ) {\n    super(Field.SKIP_SETUP);\n\n    if (value === Field.SKIP_SETUP) return;\n    if (config) {\n      this.configure_(config);\n    }\n    this.setValue(value);\n    if (validator) {\n      this.setValidator(validator);\n    }\n  }\n\n  protected override configure_(config: FieldInputConfig) {\n    super.configure_(config);\n    if (config.spellcheck !== undefined) {\n      this.spellcheck_ = config.spellcheck;\n    }\n  }\n\n  override initView() {\n    const block = this.getSourceBlock();\n    if (!block) throw new UnattachedFieldError();\n    super.initView();\n\n    if (this.isFullBlockField()) {\n      this.clickTarget_ = (this.sourceBlock_ as BlockSvg).getSvgRoot();\n    }\n  }\n\n  protected override isFullBlockField(): boolean {\n    const block = this.getSourceBlock();\n    if (!block) throw new UnattachedFieldError();\n\n    // Side effect for backwards compatibility.\n    this.fullBlockClickTarget_ =\n      !!this.getConstants()?.FULL_BLOCK_FIELDS && block.isSimpleReporter();\n    return this.fullBlockClickTarget_;\n  }\n\n  /**\n   * Called by setValue if the text input is not valid. If the field is\n   * currently being edited it reverts value of the field to the previous\n   * value while allowing the display text to be handled by the htmlInput_.\n   *\n   * @param _invalidValue The input value that was determined to be invalid.\n   *    This is not used by the text input because its display value is stored\n   * on the htmlInput_.\n   */\n  protected override doValueInvalid_(_invalidValue: AnyDuringMigration) {\n    if (this.isBeingEdited_) {\n      this.isDirty_ = true;\n      this.isTextValid_ = false;\n      const oldValue = this.value_;\n      // Revert value when the text becomes invalid.\n      this.value_ = this.htmlInput_!.getAttribute('data-untyped-default-value');\n      if (this.sourceBlock_ && eventUtils.isEnabled()) {\n        eventUtils.fire(\n          new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n            this.sourceBlock_,\n            'field',\n            this.name || null,\n            oldValue,\n            this.value_,\n          ),\n        );\n      }\n    }\n  }\n\n  /**\n   * Called by setValue if the text input is valid. Updates the value of the\n   * field, and updates the text of the field if it is not currently being\n   * edited (i.e. handled by the htmlInput_).\n   *\n   * @param newValue The value to be saved. The default validator guarantees\n   *     that this is a string.\n   */\n  protected override doValueUpdate_(newValue: string | T) {\n    this.isDirty_ = true;\n    this.isTextValid_ = true;\n    this.value_ = newValue;\n  }\n\n  /**\n   * Updates text field to match the colour/style of the block.\n   */\n  override applyColour() {\n    const block = this.getSourceBlock() as BlockSvg | null;\n    if (!block) throw new UnattachedFieldError();\n\n    if (!this.getConstants()!.FULL_BLOCK_FIELDS) return;\n    if (!this.fieldGroup_) return;\n\n    if (!this.isFullBlockField() && this.borderRect_) {\n      this.borderRect_!.style.display = 'block';\n      this.borderRect_.setAttribute('stroke', block.style.colourTertiary);\n    } else {\n      this.borderRect_!.style.display = 'none';\n      // In general, do *not* let fields control the color of blocks. Having the\n      // field control the color is unexpected, and could have performance\n      // impacts.\n      block.pathObject.svgPath.setAttribute(\n        'fill',\n        this.getConstants()!.FIELD_BORDER_RECT_COLOUR,\n      );\n    }\n  }\n\n  /**\n   * Returns the height and width of the field.\n   *\n   * This should *in general* be the only place render_ gets called from.\n   *\n   * @returns Height and width.\n   */\n  override getSize(): Size {\n    if (this.getConstants()?.FULL_BLOCK_FIELDS) {\n      // In general, do *not* let fields control the color of blocks. Having the\n      // field control the color is unexpected, and could have performance\n      // impacts.\n      // Full block fields have more control of the block than they should\n      // (i.e. updating fill colour). Whenever we get the size, the field may\n      // no longer be a full-block field, so we need to rerender.\n      this.render_();\n      this.isDirty_ = false;\n    }\n    return super.getSize();\n  }\n\n  /**\n   * Notifies the field that it has changed locations. Moves the widget div to\n   * be in the correct place if it is open.\n   */\n  onLocationChange(): void {\n    if (this.isBeingEdited_) this.resizeEditor_();\n  }\n\n  /**\n   * Updates the colour of the htmlInput given the current validity of the\n   * field's value.\n   *\n   * Also updates the colour of the block to reflect whether this is a full\n   * block field or not.\n   */\n  protected override render_() {\n    super.render_();\n    // This logic is done in render_ rather than doValueInvalid_ or\n    // doValueUpdate_ so that the code is more centralized.\n    if (this.isBeingEdited_) {\n      const htmlInput = this.htmlInput_ as HTMLElement;\n      if (!this.isTextValid_) {\n        dom.addClass(htmlInput, 'blocklyInvalidInput');\n        aria.setState(htmlInput, aria.State.INVALID, true);\n      } else {\n        dom.removeClass(htmlInput, 'blocklyInvalidInput');\n        aria.setState(htmlInput, aria.State.INVALID, false);\n      }\n    }\n\n    const block = this.getSourceBlock() as BlockSvg | null;\n    if (!block) throw new UnattachedFieldError();\n    // In general, do *not* let fields control the color of blocks. Having the\n    // field control the color is unexpected, and could have performance\n    // impacts.\n    // Whenever we render, the field may no longer be a full-block-field so\n    // we need to update the colour.\n    if (this.getConstants()!.FULL_BLOCK_FIELDS) block.applyColour();\n  }\n\n  /**\n   * Set whether this field is spellchecked by the browser.\n   *\n   * @param check True if checked.\n   */\n  setSpellcheck(check: boolean) {\n    if (check === this.spellcheck_) {\n      return;\n    }\n    this.spellcheck_ = check;\n    if (this.htmlInput_) {\n      // AnyDuringMigration because:  Argument of type 'boolean' is not\n      // assignable to parameter of type 'string'.\n      this.htmlInput_.setAttribute(\n        'spellcheck',\n        this.spellcheck_ as AnyDuringMigration,\n      );\n    }\n  }\n\n  /**\n   * Show an editor for the field.\n   * Shows the inline free-text editor on top of the text by default.\n   * Shows a prompt editor for mobile browsers if the modalInputs option is\n   * enabled.\n   *\n   * @param _e Optional mouse event that triggered the field to open, or\n   *     undefined if triggered programmatically.\n   * @param quietInput True if editor should be created without focus.\n   *     Defaults to false.\n   */\n  protected override showEditor_(_e?: Event, quietInput = false) {\n    this.workspace_ = (this.sourceBlock_ as BlockSvg).workspace;\n    if (\n      !quietInput &&\n      this.workspace_.options.modalInputs &&\n      (userAgent.MOBILE || userAgent.ANDROID || userAgent.IPAD)\n    ) {\n      this.showPromptEditor_();\n    } else {\n      this.showInlineEditor_(quietInput);\n    }\n  }\n\n  /**\n   * Create and show a text input editor that is a prompt (usually a popup).\n   * Mobile browsers may have issues with in-line textareas (focus and\n   * keyboards).\n   */\n  private showPromptEditor_() {\n    dialog.prompt(\n      Msg['CHANGE_VALUE_TITLE'],\n      this.getText(),\n      (text: string | null) => {\n        // Text is null if user pressed cancel button.\n        if (text !== null) {\n          this.setValue(this.getValueFromEditorText_(text));\n        }\n        this.onFinishEditing_(this.value_);\n      },\n    );\n  }\n\n  /**\n   * Create and show a text input editor that sits directly over the text input.\n   *\n   * @param quietInput True if editor should be created without focus.\n   */\n  private showInlineEditor_(quietInput: boolean) {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    WidgetDiv.show(this, block.RTL, this.widgetDispose_.bind(this));\n    this.htmlInput_ = this.widgetCreate_() as HTMLInputElement;\n    this.isBeingEdited_ = true;\n    this.valueWhenEditorWasOpened_ = this.value_;\n\n    if (!quietInput) {\n      (this.htmlInput_ as HTMLElement).focus({\n        preventScroll: true,\n      });\n      this.htmlInput_.select();\n    }\n  }\n\n  /**\n   * Create the text input editor widget.\n   *\n   * @returns The newly created text input editor.\n   */\n  protected widgetCreate_(): HTMLElement {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    eventUtils.setGroup(true);\n    const div = WidgetDiv.getDiv();\n\n    const clickTarget = this.getClickTarget_();\n    if (!clickTarget) throw new Error('A click target has not been set.');\n    dom.addClass(clickTarget, 'editing');\n\n    const htmlInput = document.createElement('input');\n    htmlInput.className = 'blocklyHtmlInput';\n    // AnyDuringMigration because:  Argument of type 'boolean' is not assignable\n    // to parameter of type 'string'.\n    htmlInput.setAttribute(\n      'spellcheck',\n      this.spellcheck_ as AnyDuringMigration,\n    );\n    const scale = this.workspace_!.getScale();\n    const fontSize = this.getConstants()!.FIELD_TEXT_FONTSIZE * scale + 'pt';\n    div!.style.fontSize = fontSize;\n    htmlInput.style.fontSize = fontSize;\n    let borderRadius = FieldInput.BORDERRADIUS * scale + 'px';\n\n    if (this.isFullBlockField()) {\n      const bBox = this.getScaledBBox();\n\n      // Override border radius.\n      borderRadius = (bBox.bottom - bBox.top) / 2 + 'px';\n      // Pull stroke colour from the existing shadow block\n      const strokeColour = block.getParent()\n        ? (block.getParent() as BlockSvg).style.colourTertiary\n        : (this.sourceBlock_ as BlockSvg).style.colourTertiary;\n      htmlInput.style.border = 1 * scale + 'px solid ' + strokeColour;\n      div!.style.borderRadius = borderRadius;\n      div!.style.transition = 'box-shadow 0.25s ease 0s';\n      if (this.getConstants()!.FIELD_TEXTINPUT_BOX_SHADOW) {\n        div!.style.boxShadow =\n          'rgba(255, 255, 255, 0.3) 0 0 0 ' + 4 * scale + 'px';\n      }\n    }\n    htmlInput.style.borderRadius = borderRadius;\n\n    div!.appendChild(htmlInput);\n\n    htmlInput.value = htmlInput.defaultValue = this.getEditorText_(this.value_);\n    htmlInput.setAttribute('data-untyped-default-value', String(this.value_));\n\n    this.resizeEditor_();\n\n    this.bindInputEvents_(htmlInput);\n\n    return htmlInput;\n  }\n\n  /**\n   * Closes the editor, saves the results, and disposes of any events or\n   * DOM-references belonging to the editor.\n   */\n  protected widgetDispose_() {\n    // Non-disposal related things that we do when the editor closes.\n    this.isBeingEdited_ = false;\n    this.isTextValid_ = true;\n    // Make sure the field's node matches the field's internal value.\n    this.forceRerender();\n    this.onFinishEditing_(this.value_);\n\n    if (\n      this.sourceBlock_ &&\n      eventUtils.isEnabled() &&\n      this.valueWhenEditorWasOpened_ !== null &&\n      this.valueWhenEditorWasOpened_ !== this.value_\n    ) {\n      // When closing a field input widget, fire an event indicating that the\n      // user has completed a sequence of changes. The value may have changed\n      // multiple times while the editor was open, but this will fire an event\n      // containing the value when the editor was opened as well as the new one.\n      eventUtils.fire(\n        new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n          this.sourceBlock_,\n          'field',\n          this.name || null,\n          this.valueWhenEditorWasOpened_,\n          this.value_,\n        ),\n      );\n      this.valueWhenEditorWasOpened_ = null;\n    }\n\n    eventUtils.setGroup(false);\n\n    // Actual disposal.\n    this.unbindInputEvents_();\n    const style = WidgetDiv.getDiv()!.style;\n    style.width = 'auto';\n    style.height = 'auto';\n    style.fontSize = '';\n    style.transition = '';\n    style.boxShadow = '';\n    this.htmlInput_ = null;\n\n    const clickTarget = this.getClickTarget_();\n    if (!clickTarget) throw new Error('A click target has not been set.');\n    dom.removeClass(clickTarget, 'editing');\n  }\n\n  /**\n   * A callback triggered when the user is done editing the field via the UI.\n   *\n   * @param _value The new value of the field.\n   */\n  onFinishEditing_(_value: AnyDuringMigration) {}\n\n  /**\n   * Bind handlers for user input on the text input field's editor.\n   *\n   * @param htmlInput The htmlInput to which event handlers will be bound.\n   */\n  protected bindInputEvents_(htmlInput: HTMLElement) {\n    // Trap Enter without IME and Esc to hide.\n    this.onKeyDownWrapper_ = browserEvents.conditionalBind(\n      htmlInput,\n      'keydown',\n      this,\n      this.onHtmlInputKeyDown_,\n    );\n    // Resize after every input change.\n    this.onKeyInputWrapper_ = browserEvents.conditionalBind(\n      htmlInput,\n      'input',\n      this,\n      this.onHtmlInputChange_,\n    );\n  }\n\n  /** Unbind handlers for user input and workspace size changes. */\n  protected unbindInputEvents_() {\n    if (this.onKeyDownWrapper_) {\n      browserEvents.unbind(this.onKeyDownWrapper_);\n      this.onKeyDownWrapper_ = null;\n    }\n    if (this.onKeyInputWrapper_) {\n      browserEvents.unbind(this.onKeyInputWrapper_);\n      this.onKeyInputWrapper_ = null;\n    }\n  }\n\n  /**\n   * Handle key down to the editor.\n   *\n   * @param e Keyboard event.\n   */\n  protected onHtmlInputKeyDown_(e: KeyboardEvent) {\n    if (e.key === 'Enter') {\n      WidgetDiv.hide();\n      dropDownDiv.hideWithoutAnimation();\n    } else if (e.key === 'Escape') {\n      this.setValue(\n        this.htmlInput_!.getAttribute('data-untyped-default-value'),\n        false,\n      );\n      WidgetDiv.hide();\n      dropDownDiv.hideWithoutAnimation();\n    } else if (e.key === 'Tab') {\n      WidgetDiv.hide();\n      dropDownDiv.hideWithoutAnimation();\n      (this.sourceBlock_ as BlockSvg).tab(this, !e.shiftKey);\n      e.preventDefault();\n    }\n  }\n\n  /**\n   * Handle a change to the editor.\n   *\n   * @param _e Keyboard event.\n   */\n  private onHtmlInputChange_(_e: Event) {\n    // Intermediate value changes from user input are not confirmed until the\n    // user closes the editor, and may be numerous. Inhibit reporting these as\n    // normal block change events, and instead report them as special\n    // intermediate changes that do not get recorded in undo history.\n    const oldValue = this.value_;\n    // Change the field's value without firing the normal change event.\n    this.setValue(this.getValueFromEditorText_(this.htmlInput_!.value), false);\n    if (\n      this.sourceBlock_ &&\n      eventUtils.isEnabled() &&\n      this.value_ !== oldValue\n    ) {\n      // Fire a special event indicating that the value changed but the change\n      // isn't complete yet and normal field change listeners can wait.\n      eventUtils.fire(\n        new (eventUtils.get(eventUtils.BLOCK_FIELD_INTERMEDIATE_CHANGE))(\n          this.sourceBlock_,\n          this.name || null,\n          oldValue,\n          this.value_,\n        ),\n      );\n    }\n  }\n\n  /**\n   * Set the HTML input value and the field's internal value. The difference\n   * between this and `setValue` is that this also updates the HTML input\n   * value whilst editing.\n   *\n   * @param newValue New value.\n   * @param fireChangeEvent Whether to fire a change event. Defaults to true.\n   *     Should usually be true unless the change will be reported some other\n   *     way, e.g. an intermediate field change event.\n   */\n  protected setEditorValue_(\n    newValue: AnyDuringMigration,\n    fireChangeEvent = true,\n  ) {\n    this.isDirty_ = true;\n    if (this.isBeingEdited_) {\n      // In the case this method is passed an invalid value, we still\n      // pass it through the transformation method `getEditorText` to deal\n      // with. Otherwise, the internal field's state will be inconsistent\n      // with what's shown to the user.\n      this.htmlInput_!.value = this.getEditorText_(newValue);\n    }\n    this.setValue(newValue, fireChangeEvent);\n  }\n\n  /** Resize the editor to fit the text. */\n  protected resizeEditor_() {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    const div = WidgetDiv.getDiv();\n    const bBox = this.getScaledBBox();\n    div!.style.width = bBox.right - bBox.left + 'px';\n    div!.style.height = bBox.bottom - bBox.top + 'px';\n\n    // In RTL mode block fields and LTR input fields the left edge moves,\n    // whereas the right edge is fixed.  Reposition the editor.\n    const x = block.RTL ? bBox.right - div!.offsetWidth : bBox.left;\n    const xy = new Coordinate(x, bBox.top);\n\n    div!.style.left = xy.x + 'px';\n    div!.style.top = xy.y + 'px';\n  }\n\n  /**\n   * Handles repositioning the WidgetDiv used for input fields when the\n   * workspace is resized. Will bump the block into the viewport and update the\n   * position of the text input if necessary.\n   *\n   * @returns True for rendered workspaces, as we never want to hide the widget\n   *     div.\n   */\n  override repositionForWindowResize(): boolean {\n    const block = this.getSourceBlock();\n    // This shouldn't be possible. We should never have a WidgetDiv if not using\n    // rendered blocks.\n    if (!(block instanceof BlockSvg)) return false;\n\n    const bumped = bumpObjects.bumpIntoBounds(\n      this.workspace_!,\n      this.workspace_!.getMetricsManager().getViewMetrics(true),\n      block,\n    );\n\n    if (!bumped) this.resizeEditor_();\n\n    return true;\n  }\n\n  /**\n   * Returns whether or not the field is tab navigable.\n   *\n   * @returns True if the field is tab navigable.\n   */\n  override isTabNavigable(): boolean {\n    return true;\n  }\n\n  /**\n   * Use the `getText_` developer hook to override the field's text\n   * representation. When we're currently editing, return the current HTML value\n   * instead. Otherwise, return null which tells the field to use the default\n   * behaviour (which is a string cast of the field's value).\n   *\n   * @returns The HTML value if we're editing, otherwise null.\n   */\n  protected override getText_(): string | null {\n    if (this.isBeingEdited_ && this.htmlInput_) {\n      // We are currently editing, return the HTML input value instead.\n      return this.htmlInput_.value;\n    }\n    return null;\n  }\n\n  /**\n   * Transform the provided value into a text to show in the HTML input.\n   * Override this method if the field's HTML input representation is different\n   * than the field's value. This should be coupled with an override of\n   * `getValueFromEditorText_`.\n   *\n   * @param value The value stored in this field.\n   * @returns The text to show on the HTML input.\n   */\n  protected getEditorText_(value: AnyDuringMigration): string {\n    return `${value}`;\n  }\n\n  /**\n   * Transform the text received from the HTML input into a value to store\n   * in this field.\n   * Override this method if the field's HTML input representation is different\n   * than the field's value. This should be coupled with an override of\n   * `getEditorText_`.\n   *\n   * @param text Text received from the HTML input.\n   * @returns The value to store.\n   */\n  protected getValueFromEditorText_(text: string): AnyDuringMigration {\n    return text;\n  }\n}\n\n/**\n * Config options for the input field.\n *\n * @internal\n */\nexport interface FieldInputConfig extends FieldConfig {\n  spellcheck?: boolean;\n}\n\n/**\n * A function that is called to validate changes to the field's value before\n * they are set.\n *\n * @see {@link https://developers.google.com/blockly/guides/create-custom-blocks/fields/validators#return_values}\n * @param newValue The value to be validated.\n * @returns One of three instructions for setting the new value: `T`, `null`,\n * or `undefined`.\n *\n * - `T` to set this function's returned value instead of `newValue`.\n *\n * - `null` to invoke `doValueInvalid_` and not set a value.\n *\n * - `undefined` to set `newValue` as is.\n * @internal\n */\nexport type FieldInputValidator<T extends InputTypes> = FieldValidator<\n  string | T\n>;\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Text input field.\n *\n * @class\n */\n// Former goog.module ID: Blockly.FieldTextInput\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_change.js';\n\nimport {Field} from './field.js';\nimport {\n  FieldInput,\n  FieldInputConfig,\n  FieldInputValidator,\n} from './field_input.js';\nimport * as fieldRegistry from './field_registry.js';\nimport * as parsing from './utils/parsing.js';\n\n/**\n * Class for an editable text field.\n */\nexport class FieldTextInput extends FieldInput<string> {\n  /**\n   * @param value The initial value of the field. Should cast to a string.\n   *     Defaults to an empty string if null or undefined. Also accepts\n   *     Field.SKIP_SETUP if you wish to skip setup (only used by subclasses\n   *     that want to handle configuration and setting the field value after\n   *     their own constructors have run).\n   * @param validator A function that is called to validate changes to the\n   *     field's value. Takes in a string & returns a validated string, or null\n   *     to abort the change.\n   * @param config A map of options used to configure the field.\n   *     See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/text-input#creation}\n   * for a list of properties this parameter supports.\n   */\n  constructor(\n    value?: string | typeof Field.SKIP_SETUP,\n    validator?: FieldTextInputValidator | null,\n    config?: FieldTextInputConfig,\n  ) {\n    super(value, validator, config);\n  }\n\n  /**\n   * Ensure that the input value casts to a valid string.\n   *\n   * @param newValue The input value.\n   * @returns A valid string, or null if invalid.\n   */\n  protected override doClassValidation_(\n    newValue?: AnyDuringMigration,\n  ): string | null {\n    if (newValue === undefined) {\n      return null;\n    }\n    return `${newValue}`;\n  }\n\n  /**\n   * Construct a FieldTextInput from a JSON arg object,\n   * dereferencing any string table references.\n   *\n   * @param options A JSON object with options (text, and spellcheck).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static fromJson(options: FieldTextInputFromJsonConfig): FieldTextInput {\n    const text = parsing.replaceMessageReferences(options.text);\n    // `this` might be a subclass of FieldTextInput if that class doesn't\n    // override the static fromJson method.\n    return new this(text, undefined, options);\n  }\n}\n\nfieldRegistry.register('field_input', FieldTextInput);\n\nFieldTextInput.prototype.DEFAULT_VALUE = '';\n\n/**\n *  Config options for the text input field.\n */\nexport type FieldTextInputConfig = FieldInputConfig;\n\n/**\n * fromJson config options for the text input field.\n */\nexport interface FieldTextInputFromJsonConfig extends FieldTextInputConfig {\n  text?: string;\n}\n\n/**\n * A function that is called to validate changes to the field's value before\n * they are set.\n *\n * @see {@link https://developers.google.com/blockly/guides/create-custom-blocks/fields/validators#return_values}\n * @param newValue The value to be validated.\n * @returns One of three instructions for setting the new value: `T`, `null`,\n * or `undefined`.\n *\n * - `T` to set this function's returned value instead of `newValue`.\n *\n * - `null` to invoke `doValueInvalid_` and not set a value.\n *\n * - `undefined` to set `newValue` as is.\n */\nexport type FieldTextInputValidator = FieldInputValidator<string>;\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.zelos.BottomRow\n\nimport type {BlockSvg} from '../../../block_svg.js';\nimport type {ConstantProvider} from '../../../renderers/common/constants.js';\nimport {BottomRow as BaseBottomRow} from '../../../renderers/measurables/bottom_row.js';\n\n/**\n * An object containing information about what elements are in the bottom row of\n * a block as well as spacing information for the top row.\n * Elements in a bottom row can consist of corners, spacers and next\n * connections.\n */\nexport class BottomRow extends BaseBottomRow {\n  /**\n   * @param constants The rendering constants provider.\n   */\n  constructor(constants: ConstantProvider) {\n    super(constants);\n  }\n\n  override endsWithElemSpacer() {\n    return false;\n  }\n\n  /** Render a round corner unless the block has an output connection. */\n  override hasLeftSquareCorner(block: BlockSvg) {\n    return !!block.outputConnection;\n  }\n\n  /** Render a round corner unless the block has an output connection. */\n  override hasRightSquareCorner(block: BlockSvg) {\n    return (\n      !!block.outputConnection &&\n      !block.statementInputCount &&\n      !block.nextConnection\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.zelos.StatementInput\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {Input} from '../../../inputs/input.js';\nimport type {ConstantProvider} from '../../../renderers/common/constants.js';\nimport {StatementInput as BaseStatementInput} from '../../../renderers/measurables/statement_input.js';\n\n/**\n * An object containing information about the space a statement input takes up\n * during rendering.\n */\nexport class StatementInput extends BaseStatementInput {\n  connectedBottomNextConnection = false;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param input The statement input to measure and store information for.\n   */\n  constructor(constants: ConstantProvider, input: Input) {\n    super(constants, input);\n\n    if (this.connectedBlock) {\n      // Find the bottom-most connected block in the stack.\n      let block = this.connectedBlock;\n      let nextBlock;\n      while ((nextBlock = block.getNextBlock())) {\n        block = nextBlock;\n      }\n      if (!block.nextConnection) {\n        this.height = this.connectedBlockHeight;\n        this.connectedBottomNextConnection = true;\n      }\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.zelos.RightConnectionShape\n\nimport type {ConstantProvider} from '../../../renderers/common/constants.js';\nimport {Measurable} from '../../../renderers/measurables/base.js';\nimport {Types} from '../../../renderers/measurables/types.js';\n\n/**\n * An object containing information about the space a right connection shape\n * takes up during rendering.\n */\nexport class RightConnectionShape extends Measurable {\n  // Size is dynamic\n  override height = 0;\n  override width = 0;\n\n  /**\n   * @param constants The rendering constants provider.\n   */\n  constructor(constants: ConstantProvider) {\n    super(constants);\n    this.type |= Types.getType('RIGHT_CONNECTION');\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.zelos.TopRow\n\nimport type {BlockSvg} from '../../../block_svg.js';\nimport type {ConstantProvider} from '../../../renderers/common/constants.js';\nimport {TopRow as BaseTopRow} from '../../../renderers/measurables/top_row.js';\n\n/**\n * An object containing information about what elements are in the top row of a\n * block as well as sizing information for the top row.\n * Elements in a top row can consist of corners, hats, spacers, and previous\n * connections.\n * After this constructor is called, the row will contain all non-spacer\n * elements it needs.\n */\nexport class TopRow extends BaseTopRow {\n  /**\n   * @param constants The rendering constants provider.\n   */\n  constructor(constants: ConstantProvider) {\n    super(constants);\n  }\n\n  override endsWithElemSpacer() {\n    return false;\n  }\n\n  /** Render a round corner unless the block has an output connection. */\n  override hasLeftSquareCorner(block: BlockSvg) {\n    const hasHat =\n      (block.hat ? block.hat === 'cap' : this.constants_.ADD_START_HATS) &&\n      !block.outputConnection &&\n      !block.previousConnection;\n    return !!block.outputConnection || hasHat;\n  }\n\n  /** Render a round corner unless the block has an output connection. */\n  override hasRightSquareCorner(block: BlockSvg) {\n    return (\n      !!block.outputConnection &&\n      !block.statementInputCount &&\n      !block.nextConnection\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.zelos.RenderInfo\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport {DummyInput} from '../../inputs/dummy_input.js';\nimport {EndRowInput} from '../../inputs/end_row_input.js';\nimport {FieldImage} from '../../field_image.js';\nimport {FieldLabel} from '../../field_label.js';\nimport {FieldTextInput} from '../../field_textinput.js';\nimport {Input} from '../../inputs/input.js';\nimport {Align} from '../../inputs/align.js';\nimport {RenderInfo as BaseRenderInfo} from '../common/info.js';\nimport type {Measurable} from '../measurables/base.js';\nimport {Field} from '../measurables/field.js';\nimport {InRowSpacer} from '../measurables/in_row_spacer.js';\nimport {InputConnection} from '../measurables/input_connection.js';\nimport {StatementInput} from '../../inputs/statement_input.js';\nimport type {Row} from '../measurables/row.js';\nimport type {SpacerRow} from '../measurables/spacer_row.js';\nimport {Types} from '../measurables/types.js';\nimport {ValueInput} from '../../inputs/value_input.js';\n\nimport type {ConstantProvider, InsideCorners} from './constants.js';\nimport {BottomRow} from './measurables/bottom_row.js';\nimport {StatementInput as StatementInputMeasurable} from './measurables/inputs.js';\nimport {RightConnectionShape} from './measurables/row_elements.js';\nimport {TopRow} from './measurables/top_row.js';\nimport type {PathObject} from './path_object.js';\nimport type {Renderer} from './renderer.js';\n\n/**\n * An object containing all sizing information needed to draw this block.\n *\n * This measure pass does not propagate changes to the block (although fields\n * may choose to rerender when getSize() is called).  However, calling it\n * repeatedly may be expensive.\n */\nexport class RenderInfo extends BaseRenderInfo {\n  override topRow: TopRow;\n  override bottomRow: BottomRow;\n  override constants_: ConstantProvider;\n  override renderer_: Renderer;\n\n  override isInline = true;\n  isMultiRow: boolean;\n  hasStatementInput: boolean;\n  rightSide: RightConnectionShape | null;\n  private readonly rightAlignedDummyInputs: WeakMap<Row, Input>;\n\n  /**\n   * @param renderer The renderer in use.\n   * @param block The block to measure.\n   */\n  constructor(renderer: Renderer, block: BlockSvg) {\n    super(renderer, block);\n\n    this.renderer_ = renderer;\n\n    this.constants_ = this.renderer_.getConstants();\n\n    /**\n     * An object with rendering information about the top row of the block.\n     */\n    this.topRow = new TopRow(this.constants_);\n\n    /**\n     * An object with rendering information about the bottom row of the block.\n     */\n    this.bottomRow = new BottomRow(this.constants_);\n\n    /**\n     * Whether the block should be rendered as a multi-line block, either\n     * because it's not inline or because it has been collapsed.\n     */\n    this.isMultiRow = !block.getInputsInline() || block.isCollapsed();\n\n    /**\n     * Whether or not the block has a statement input in one of its rows.\n     */\n    this.hasStatementInput = block.statementInputCount > 0;\n\n    /**\n     * An object with rendering information about the right connection shape.\n     */\n    this.rightSide = this.outputConnection\n      ? new RightConnectionShape(this.constants_)\n      : null;\n\n    /**\n     * A map of rows to right aligned dummy inputs within those rows. Used to\n     * add padding between left and right aligned inputs.\n     */\n    this.rightAlignedDummyInputs = new WeakMap();\n  }\n\n  /**\n   * Get the block renderer in use.\n   *\n   * @returns The block renderer in use.\n   */\n  override getRenderer(): Renderer {\n    return this.renderer_ as Renderer;\n  }\n\n  override measure() {\n    // Modifying parent measure method to add `adjustXPosition_`.\n    this.createRows_();\n    this.addElemSpacing_();\n    this.addRowSpacing_();\n    this.adjustXPosition_();\n    this.computeBounds_();\n    this.alignRowElements_();\n    this.finalize_();\n  }\n\n  override shouldStartNewRow_(currInput: Input, prevInput: Input): boolean {\n    // If this is the first input, just add to the existing row.\n    // That row is either empty or has some icons in it.\n    if (!prevInput) {\n      return false;\n    }\n    // If the previous input was an end-row input, then any following input\n    // should always be rendered on the next row.\n    if (prevInput instanceof EndRowInput) {\n      return true;\n    }\n    // A statement input or an input following one always gets a new row.\n    if (\n      currInput instanceof StatementInput ||\n      prevInput instanceof StatementInput\n    ) {\n      return true;\n    }\n    // Value, dummy, and end-row inputs get new row if inputs are not inlined.\n    if (\n      currInput instanceof ValueInput ||\n      currInput instanceof DummyInput ||\n      currInput instanceof EndRowInput\n    ) {\n      return !this.isInline || this.isMultiRow;\n    }\n    return false;\n  }\n\n  override getDesiredRowWidth_(row: Row): number {\n    if (row.hasStatement) {\n      const rightCornerWidth =\n        (this.constants_.INSIDE_CORNERS as InsideCorners).rightWidth || 0;\n      return this.width - this.startX - rightCornerWidth;\n    }\n    return super.getDesiredRowWidth_(row);\n  }\n\n  override getInRowSpacing_(\n    prev: Measurable | null,\n    next: Measurable | null,\n  ): number {\n    if (!prev || !next) {\n      // No need for padding at the beginning or end of the row if the\n      // output shape is dynamic.\n      if (\n        this.outputConnection &&\n        this.outputConnection.isDynamicShape &&\n        !this.hasStatementInput &&\n        !this.bottomRow.hasNextConnection\n      ) {\n        return this.constants_.NO_PADDING;\n      }\n    }\n    if (!prev) {\n      // Statement input padding.\n      if (next && Types.isStatementInput(next)) {\n        return this.constants_.STATEMENT_INPUT_PADDING_LEFT;\n      }\n    }\n    // Spacing between a rounded corner and a previous or next connection.\n    if (prev && Types.isLeftRoundedCorner(prev) && next) {\n      if (Types.isPreviousConnection(next) || Types.isNextConnection(next)) {\n        return next.notchOffset - this.constants_.CORNER_RADIUS;\n      }\n    }\n    // Spacing between a square corner and a hat.\n    if (prev && Types.isLeftSquareCorner(prev) && next && Types.isHat(next)) {\n      return this.constants_.NO_PADDING;\n    }\n    return this.constants_.MEDIUM_PADDING;\n  }\n\n  override getSpacerRowHeight_(prev: Row, next: Row): number {\n    // If we have an empty block add a spacer to increase the height.\n    if (Types.isTopRow(prev) && Types.isBottomRow(next)) {\n      return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;\n    }\n    const followsStatement = Types.isInputRow(prev) && prev.hasStatement;\n    const precedesStatement = Types.isInputRow(next) && next.hasStatement;\n    if (precedesStatement || followsStatement) {\n      const cornerHeight =\n        (this.constants_.INSIDE_CORNERS as InsideCorners).rightHeight || 0;\n      const height = Math.max(this.constants_.NOTCH_HEIGHT, cornerHeight);\n      return precedesStatement && followsStatement\n        ? Math.max(height, this.constants_.DUMMY_INPUT_MIN_HEIGHT)\n        : height;\n    }\n    // Top and bottom rows act as a spacer so we don't need any extra padding.\n    if (Types.isTopRow(prev)) {\n      const topRow = prev as TopRow;\n      if (\n        !topRow.hasPreviousConnection &&\n        (!this.outputConnection || this.hasStatementInput)\n      ) {\n        return Math.abs(\n          this.constants_.NOTCH_HEIGHT - this.constants_.CORNER_RADIUS,\n        );\n      }\n      return this.constants_.NO_PADDING;\n    }\n    if (Types.isBottomRow(next)) {\n      const bottomRow = next as BottomRow;\n      if (!this.outputConnection) {\n        const topHeight =\n          Math.max(\n            this.topRow.minHeight,\n            Math.max(\n              this.constants_.NOTCH_HEIGHT,\n              this.constants_.CORNER_RADIUS,\n            ),\n          ) - this.constants_.CORNER_RADIUS;\n        return topHeight;\n      } else if (!bottomRow.hasNextConnection && this.hasStatementInput) {\n        return Math.abs(\n          this.constants_.NOTCH_HEIGHT - this.constants_.CORNER_RADIUS,\n        );\n      }\n      return this.constants_.NO_PADDING;\n    }\n    return this.constants_.MEDIUM_PADDING;\n  }\n\n  override getSpacerRowWidth_(prev: Row, next: Row): number {\n    const width = this.width - this.startX;\n    if (\n      (Types.isInputRow(prev) && prev.hasStatement) ||\n      (Types.isInputRow(next) && next.hasStatement)\n    ) {\n      return Math.max(width, this.constants_.STATEMENT_INPUT_SPACER_MIN_WIDTH);\n    }\n    return width;\n  }\n\n  override getElemCenterline_(row: Row, elem: Measurable): number {\n    if (\n      row.hasStatement &&\n      !Types.isSpacer(elem) &&\n      !Types.isStatementInput(elem)\n    ) {\n      return row.yPos + this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT / 2;\n    }\n    if (Types.isInlineInput(elem) && elem instanceof InputConnection) {\n      const connectedBlock = elem.connectedBlock;\n      if (\n        connectedBlock &&\n        connectedBlock.outputConnection &&\n        connectedBlock.nextConnection\n      ) {\n        return row.yPos + connectedBlock.height / 2;\n      }\n    }\n    return super.getElemCenterline_(row, elem);\n  }\n\n  override addInput_(input: Input, activeRow: Row) {\n    // If we have two dummy inputs on the same row, one aligned left and the\n    // other right, keep track of the right aligned dummy input so we can add\n    // padding later. An end-row input after a dummy input also counts.\n    if (\n      (input instanceof DummyInput || input instanceof EndRowInput) &&\n      activeRow.hasDummyInput &&\n      activeRow.align === Align.LEFT &&\n      input.align === Align.RIGHT\n    ) {\n      this.rightAlignedDummyInputs.set(activeRow, input);\n    } else if (input instanceof StatementInput) {\n      // Handle statements without next connections correctly.\n      activeRow.elements.push(\n        new StatementInputMeasurable(this.constants_, input),\n      );\n      activeRow.hasStatement = true;\n\n      if (activeRow.align === null) {\n        activeRow.align = input.align;\n      }\n      return;\n    }\n    super.addInput_(input, activeRow);\n  }\n\n  override addAlignmentPadding_(row: Row, missingSpace: number) {\n    if (this.rightAlignedDummyInputs.get(row)) {\n      let alignmentDivider;\n      for (let i = 0; i < row.elements.length; i++) {\n        const elem = row.elements[i];\n        if (Types.isSpacer(elem)) {\n          alignmentDivider = elem;\n        }\n        if (\n          Types.isField(elem) &&\n          elem instanceof Field &&\n          elem.parentInput === this.rightAlignedDummyInputs.get(row)\n        ) {\n          break;\n        }\n      }\n      if (alignmentDivider) {\n        alignmentDivider.width += missingSpace;\n        row.width += missingSpace;\n        return;\n      }\n    }\n    super.addAlignmentPadding_(row, missingSpace);\n  }\n\n  /**\n   * Adjust the x position of fields to bump all non-label fields in the first\n   * row past the notch position.  This must be called before `computeBounds`\n   * is called.\n   */\n  protected adjustXPosition_() {\n    const notchTotalWidth =\n      this.constants_.NOTCH_OFFSET_LEFT + this.constants_.NOTCH_WIDTH;\n    let minXPos = notchTotalWidth;\n    // Run through every input row on the block and only apply bump logic to the\n    // first input row (if the block has prev connection) and every input row\n    // that has a prev and next notch.\n    for (let i = 2; i < this.rows.length - 1; i += 2) {\n      const prevSpacer = this.rows[i - 1] as SpacerRow;\n      const row = this.rows[i];\n      const nextSpacer = this.rows[i + 1] as SpacerRow;\n\n      const hasPrevNotch =\n        i === 2\n          ? !!this.topRow.hasPreviousConnection\n          : !!prevSpacer.followsStatement;\n      const hasNextNotch =\n        i + 2 >= this.rows.length - 1\n          ? !!this.bottomRow.hasNextConnection\n          : !!nextSpacer.precedesStatement;\n\n      if (Types.isInputRow(row) && row.hasStatement) {\n        row.measure();\n        minXPos =\n          row.width - (row.getLastInput()?.width ?? 0) + notchTotalWidth;\n      } else if (\n        hasPrevNotch &&\n        (i === 2 || hasNextNotch) &&\n        Types.isInputRow(row) &&\n        !row.hasStatement\n      ) {\n        let xCursor = row.xPos;\n        let prevInRowSpacer = null;\n        for (let j = 0; j < row.elements.length; j++) {\n          const elem = row.elements[j];\n          if (Types.isSpacer(elem)) {\n            prevInRowSpacer = elem;\n          }\n          if (prevInRowSpacer && (Types.isField(elem) || Types.isInput(elem))) {\n            if (\n              xCursor < minXPos &&\n              !(\n                Types.isField(elem) &&\n                elem instanceof Field &&\n                (elem.field instanceof FieldLabel ||\n                  elem.field instanceof FieldImage)\n              )\n            ) {\n              const difference = minXPos - xCursor;\n              prevInRowSpacer.width += difference;\n            }\n          }\n          xCursor += elem.width;\n        }\n      }\n    }\n  }\n\n  /**\n   * Finalize the output connection info.  In particular, set the height of the\n   * output connection to match that of the block.  For the right side, add a\n   * right connection shape element and have it match the dimensions of the\n   * output connection.\n   */\n  protected finalizeOutputConnection_() {\n    // Dynamic output connections depend on the height of the block.\n    if (!this.outputConnection || !this.outputConnection.isDynamicShape) {\n      return;\n    }\n    const outputConnectionShape = this.outputConnection.shape;\n    if (\n      !('isDynamic' in outputConnectionShape && outputConnectionShape.isDynamic)\n    ) {\n      return;\n    }\n\n    let yCursor = 0;\n    // Determine the block height.\n    for (let i = 0; i < this.rows.length; i++) {\n      const row = this.rows[i];\n      row.yPos = yCursor;\n      yCursor += row.height;\n    }\n    this.height = yCursor;\n\n    // Adjust the height of the output connection.\n    const blockHeight = this.bottomRow.hasNextConnection\n      ? this.height - this.bottomRow.descenderHeight\n      : this.height;\n    const connectionHeight = outputConnectionShape.height(blockHeight);\n    const connectionWidth = outputConnectionShape.width(blockHeight);\n\n    this.outputConnection.height = connectionHeight;\n    this.outputConnection.width = connectionWidth;\n    this.outputConnection.startX = connectionWidth;\n    this.outputConnection.connectionOffsetY =\n      outputConnectionShape.connectionOffsetY(connectionHeight);\n    this.outputConnection.connectionOffsetX =\n      outputConnectionShape.connectionOffsetX(connectionWidth);\n\n    // Add the right connection measurable.\n    // Don't add it if we have a value-to-statement or a value-to-stack block.\n    let rightConnectionWidth = 0;\n    if (!this.hasStatementInput && !this.bottomRow.hasNextConnection) {\n      rightConnectionWidth = connectionWidth;\n      this.rightSide!.height = connectionHeight;\n      this.rightSide!.width = rightConnectionWidth;\n      this.rightSide!.centerline = connectionHeight / 2;\n      this.rightSide!.xPos = this.width + rightConnectionWidth;\n    }\n    this.startX = connectionWidth;\n    this.width += connectionWidth + rightConnectionWidth;\n    this.widthWithChildren += connectionWidth + rightConnectionWidth;\n  }\n\n  /**\n   * Finalize horizontal alignment of elements on the block.  In particular,\n   * reduce the implicit spacing created by the left and right output connection\n   * shapes by adding setting negative spacing onto the leftmost and rightmost\n   * spacers.\n   */\n  protected finalizeHorizontalAlignment_() {\n    if (\n      !this.outputConnection ||\n      this.hasStatementInput ||\n      this.bottomRow.hasNextConnection\n    ) {\n      return;\n    }\n    let totalNegativeSpacing = 0;\n    for (let i = 0; i < this.rows.length; i++) {\n      const row = this.rows[i];\n      if (!Types.isInputRow(row)) {\n        continue;\n      }\n      const firstElem = row.elements[1];\n      const lastElem = row.elements[row.elements.length - 2];\n      let leftNegPadding = this.getNegativeSpacing_(firstElem);\n      let rightNegPadding = this.getNegativeSpacing_(lastElem);\n      totalNegativeSpacing = leftNegPadding + rightNegPadding;\n      const minBlockWidth =\n        this.constants_.MIN_BLOCK_WIDTH + this.outputConnection.width * 2;\n      if (this.width - totalNegativeSpacing < minBlockWidth) {\n        // Maintain a minimum block width, split negative spacing between left\n        // and right edge.\n        totalNegativeSpacing = this.width - minBlockWidth;\n        leftNegPadding = totalNegativeSpacing / 2;\n        rightNegPadding = totalNegativeSpacing / 2;\n      }\n      // Add a negative spacer on the start and end of the block.\n      row.elements.unshift(new InRowSpacer(this.constants_, -leftNegPadding));\n      row.elements.push(new InRowSpacer(this.constants_, -rightNegPadding));\n    }\n    if (totalNegativeSpacing) {\n      this.width -= totalNegativeSpacing;\n      this.widthWithChildren -= totalNegativeSpacing;\n      this.rightSide!.xPos -= totalNegativeSpacing;\n      for (let i = 0; i < this.rows.length; i++) {\n        const row = this.rows[i];\n        if (Types.isTopOrBottomRow(row)) {\n          row.elements[1].width -= totalNegativeSpacing;\n        }\n        row.width -= totalNegativeSpacing;\n        row.widthWithConnectedBlocks -= totalNegativeSpacing;\n      }\n    }\n  }\n\n  /**\n   * Calculate the spacing to reduce the left and right edges by based on the\n   * outer and inner connection shape.\n   *\n   * @param elem The first or last element on a block.\n   * @returns The amount of spacing to reduce the first or last spacer.\n   */\n  protected getNegativeSpacing_(elem: Measurable): number {\n    if (!elem || !this.outputConnection) {\n      return 0;\n    }\n    const connectionWidth = this.outputConnection.width;\n    const outerShape = this.outputConnection.shape.type;\n    const constants = this.constants_;\n    if (this.inputRows.length > 1) {\n      switch (outerShape) {\n        case constants.SHAPES.ROUND: {\n          // Special case for multi-row round reporter blocks.\n          const maxWidth = this.constants_.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;\n          const width = this.height / 2 > maxWidth ? maxWidth : this.height / 2;\n          const topPadding = this.constants_.SMALL_PADDING;\n          const roundPadding =\n            width * (1 - Math.sin(Math.acos((width - topPadding) / width)));\n          return connectionWidth - roundPadding;\n        }\n        default:\n          return 0;\n      }\n    }\n    if (Types.isInlineInput(elem) && elem instanceof InputConnection) {\n      const connectedBlock = elem.connectedBlock;\n      const innerShape = connectedBlock\n        ? (connectedBlock.pathObject as PathObject).outputShapeType\n        : elem.shape.type;\n      if (innerShape == null) {\n        return 0;\n      }\n      // Special case for value to stack / value to statement blocks.\n      if (\n        connectedBlock &&\n        connectedBlock.outputConnection &&\n        (connectedBlock.statementInputCount || connectedBlock.nextConnection)\n      ) {\n        return 0;\n      }\n      // Special case for hexagonal output.\n      if (\n        outerShape === constants.SHAPES.HEXAGONAL &&\n        outerShape !== innerShape\n      ) {\n        return 0;\n      }\n      return (\n        connectionWidth -\n        this.constants_.SHAPE_IN_SHAPE_PADDING[outerShape][innerShape]\n      );\n    } else if (Types.isField(elem) && elem instanceof Field) {\n      // Special case for text inputs.\n      if (\n        outerShape === constants.SHAPES.ROUND &&\n        elem.field instanceof FieldTextInput\n      ) {\n        return connectionWidth - 2.75 * constants.GRID_UNIT;\n      }\n      return (\n        connectionWidth - this.constants_.SHAPE_IN_SHAPE_PADDING[outerShape][0]\n      );\n    } else if (Types.isIcon(elem)) {\n      return this.constants_.SMALL_PADDING;\n    }\n    return 0;\n  }\n\n  /**\n   * Finalize vertical alignment of rows on a block.  In particular, reduce the\n   * implicit spacing when a non-shadow block is connected to any of an input\n   * row's inline inputs.\n   */\n  protected finalizeVerticalAlignment_() {\n    if (this.outputConnection) {\n      return;\n    }\n    // Run through every input row on the block and only apply tight nesting\n    // logic to input rows that have a prev and next notch.\n    for (let i = 2; i < this.rows.length - 1; i += 2) {\n      const prevSpacer = this.rows[i - 1] as SpacerRow;\n      const row = this.rows[i];\n      const nextSpacer = this.rows[i + 1] as SpacerRow;\n\n      const firstRow = i === 2;\n      const hasPrevNotch = firstRow\n        ? !!this.topRow.hasPreviousConnection\n        : !!prevSpacer.followsStatement;\n      const hasNextNotch =\n        i + 2 >= this.rows.length - 1\n          ? !!this.bottomRow.hasNextConnection\n          : !!nextSpacer.precedesStatement;\n\n      if (hasPrevNotch) {\n        const elem = row.elements[1];\n        const hasSingleTextOrImageField =\n          row.elements.length === 3 &&\n          elem instanceof Field &&\n          (elem.field instanceof FieldLabel ||\n            elem.field instanceof FieldImage);\n        if (!firstRow && hasSingleTextOrImageField) {\n          // Remove some padding if we have a single image or text field.\n          prevSpacer.height -= this.constants_.SMALL_PADDING;\n          nextSpacer.height -= this.constants_.SMALL_PADDING;\n          row.height -= this.constants_.MEDIUM_PADDING;\n        } else if (!firstRow && !hasNextNotch) {\n          // Add a small padding so the notch doesn't clash with inputs/fields.\n          prevSpacer.height += this.constants_.SMALL_PADDING;\n        } else if (hasNextNotch) {\n          // Determine if the input row has non-shadow connected blocks.\n          let hasNonShadowConnectedBlocks = false;\n          const minVerticalTightNestingHeight = 40;\n          for (let j = 0; j < row.elements.length; j++) {\n            const elem = row.elements[j];\n            if (\n              elem instanceof InputConnection &&\n              Types.isInlineInput(elem) &&\n              elem.connectedBlock &&\n              !elem.connectedBlock.isShadow() &&\n              elem.connectedBlock.getHeightWidth().height >=\n                minVerticalTightNestingHeight\n            ) {\n              hasNonShadowConnectedBlocks = true;\n              break;\n            }\n          }\n          // Apply tight-nesting if we have both a prev and next notch and the\n          // block has non-shadow connected blocks.\n          if (hasNonShadowConnectedBlocks) {\n            prevSpacer.height -= this.constants_.SMALL_PADDING;\n            nextSpacer.height -= this.constants_.SMALL_PADDING;\n          }\n        }\n      }\n    }\n  }\n\n  override finalize_() {\n    this.finalizeOutputConnection_();\n    this.finalizeHorizontalAlignment_();\n    this.finalizeVerticalAlignment_();\n    super.finalize_();\n\n    if (this.rightSide) {\n      this.widthWithChildren += this.rightSide.width;\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.zelos.MarkerSvg\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {ASTNode} from '../../keyboard_nav/ast_node.js';\nimport type {Marker} from '../../keyboard_nav/marker.js';\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport * as dom from '../../utils/dom.js';\nimport {Svg} from '../../utils/svg.js';\nimport type {WorkspaceSvg} from '../../workspace_svg.js';\nimport type {ConstantProvider as BaseConstantProvider} from '../common/constants.js';\nimport {MarkerSvg as BaseMarkerSvg} from '../common/marker_svg.js';\n\nimport type {ConstantProvider as ZelosConstantProvider} from './constants.js';\n\n/**\n * Class to draw a marker.\n */\nexport class MarkerSvg extends BaseMarkerSvg {\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  constants_!: ZelosConstantProvider;\n\n  private markerCircle: SVGCircleElement | null = null;\n\n  /**\n   * @param workspace The workspace the marker belongs to.\n   * @param constants The constants for the renderer.\n   * @param marker The marker to draw.\n   */\n  constructor(\n    workspace: WorkspaceSvg,\n    constants: BaseConstantProvider,\n    marker: Marker,\n  ) {\n    super(workspace, constants, marker);\n  }\n\n  /**\n   * Position and display the marker for an input or an output connection.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  private showWithInputOutput(curNode: ASTNode) {\n    const block = curNode.getSourceBlock() as BlockSvg;\n    const connection = curNode.getLocation() as RenderedConnection;\n    const offsetInBlock = connection.getOffsetInBlock();\n\n    this.positionCircle(offsetInBlock.x, offsetInBlock.y);\n    this.setParent_(block);\n    this.showCurrent_();\n  }\n\n  override showWithOutput_(curNode: ASTNode) {\n    this.showWithInputOutput(curNode);\n  }\n\n  override showWithInput_(curNode: ASTNode) {\n    this.showWithInputOutput(curNode);\n  }\n\n  /**\n   * Draw a rectangle around the block.\n   *\n   * @param curNode The current node of the marker.\n   */\n  override showWithBlock_(curNode: ASTNode) {\n    const block = curNode.getLocation() as BlockSvg;\n\n    // Gets the height and width of entire stack.\n    const heightWidth = block.getHeightWidth();\n    // Add padding so that being on a stack looks different than being on a\n    // block.\n    this.positionRect_(0, 0, heightWidth.width, heightWidth.height);\n    this.setParent_(block);\n    this.showCurrent_();\n  }\n\n  /**\n   * Position the circle we use for input and output connections.\n   *\n   * @param x The x position of the circle.\n   * @param y The y position of the circle.\n   */\n  private positionCircle(x: number, y: number) {\n    this.markerCircle?.setAttribute('cx', `${x}`);\n    this.markerCircle?.setAttribute('cy', `${y}`);\n    this.currentMarkerSvg = this.markerCircle;\n  }\n\n  override hide() {\n    super.hide();\n    if (this.markerCircle) {\n      this.markerCircle.style.display = 'none';\n    }\n  }\n\n  override createDomInternal_() {\n    /* clang-format off */\n    /* This markup will be generated and added to the .svgGroup_:\n        <g>\n          <rect width=\"100\" height=\"5\">\n            <animate attributeType=\"XML\" attributeName=\"fill\" dur=\"1s\"\n              values=\"transparent;transparent;#fff;transparent\" repeatCount=\"indefinite\" />\n          </rect>\n        </g>\n        */\n    /* clang-format on */\n    super.createDomInternal_();\n\n    this.markerCircle = dom.createSvgElement(\n      Svg.CIRCLE,\n      {\n        'r': this.constants_.CURSOR_RADIUS,\n        'stroke-width': this.constants_.CURSOR_STROKE_WIDTH,\n      },\n      this.markerSvg_,\n    );\n    this.hide();\n\n    // Markers and stack cursors don't blink.\n    if (this.isCursor()) {\n      const blinkProperties = this.getBlinkProperties_();\n      dom.createSvgElement(Svg.ANIMATE, blinkProperties, this.markerCircle!);\n    }\n\n    return this.markerSvg_!;\n  }\n\n  override applyColour_(curNode: ASTNode) {\n    super.applyColour_(curNode);\n\n    this.markerCircle?.setAttribute('fill', this.colour_);\n    this.markerCircle?.setAttribute('stroke', this.colour_);\n\n    if (this.isCursor()) {\n      const values = this.colour_ + ';transparent;transparent;';\n      this.markerCircle?.firstElementChild!.setAttribute('values', values);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.zelos.PathObject\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {Connection} from '../../connection.js';\nimport type {BlockStyle} from '../../theme.js';\nimport * as dom from '../../utils/dom.js';\nimport {Svg} from '../../utils/svg.js';\nimport {PathObject as BasePathObject} from '../common/path_object.js';\n\nimport type {ConstantProvider} from './constants.js';\n\n/**\n * An object that handles creating and setting each of the SVG elements\n * used by the renderer.\n */\nexport class PathObject extends BasePathObject {\n  /** The selected path of the block. */\n  private svgPathSelected: SVGElement | null = null;\n\n  /** The outline paths on the block. */\n  private readonly outlines = new Map<string, SVGElement>();\n\n  /**\n   * A set used to determine which outlines were used during a draw pass.  The\n   * set is initialized with a reference to all the outlines in\n   * `this.outlines`. Every time we use an outline during the draw pass, the\n   * reference is removed from this set.\n   */\n  private remainingOutlines = new Set<string>();\n\n  /**\n   * The type of block's output connection shape.  This is set when a block\n   * with an output connection is drawn.\n   */\n  outputShapeType: number | null = null;\n\n  public override constants: ConstantProvider;\n\n  /**\n   * @param root The root SVG element.\n   * @param style The style object to use for colouring.\n   * @param constants The renderer's constants.\n   */\n  constructor(\n    root: SVGElement,\n    style: BlockStyle,\n    constants: ConstantProvider,\n  ) {\n    super(root, style, constants);\n\n    this.constants = constants;\n  }\n\n  override setPath(pathString: string) {\n    super.setPath(pathString);\n    if (this.svgPathSelected) {\n      this.svgPathSelected.setAttribute('d', pathString);\n    }\n  }\n\n  override applyColour(block: BlockSvg) {\n    super.applyColour(block);\n    // Set shadow stroke colour.\n    const parent = block.getParent();\n    if (block.isShadow() && parent) {\n      this.svgPath.setAttribute('stroke', parent.style.colourTertiary);\n    }\n\n    // Apply colour to outlines.\n    for (const outline of this.outlines.values()) {\n      outline.setAttribute('fill', this.style.colourTertiary);\n    }\n  }\n\n  override flipRTL() {\n    super.flipRTL();\n    // Mirror each input outline path.\n    for (const outline of this.outlines.values()) {\n      outline.setAttribute('transform', 'scale(-1 1)');\n    }\n  }\n\n  override updateSelected(enable: boolean) {\n    this.setClass_('blocklySelected', enable);\n    if (enable) {\n      if (!this.svgPathSelected) {\n        this.svgPathSelected = this.svgPath.cloneNode(true) as SVGElement;\n        this.svgPathSelected.setAttribute('fill', 'none');\n        this.svgPathSelected.setAttribute(\n          'filter',\n          'url(#' + this.constants.selectedGlowFilterId + ')',\n        );\n        this.svgRoot.appendChild(this.svgPathSelected);\n      }\n    } else {\n      if (this.svgPathSelected) {\n        this.svgRoot.removeChild(this.svgPathSelected);\n        this.svgPathSelected = null;\n      }\n    }\n  }\n\n  override updateReplacementFade(enable: boolean) {\n    this.setClass_('blocklyReplaceable', enable);\n    if (enable) {\n      this.svgPath.setAttribute(\n        'filter',\n        'url(#' + this.constants.replacementGlowFilterId + ')',\n      );\n    } else {\n      this.svgPath.removeAttribute('filter');\n    }\n  }\n\n  override updateShapeForInputHighlight(conn: Connection, enable: boolean) {\n    const name = conn.getParentInput()!.name;\n    const outlinePath = this.getOutlinePath(name);\n    if (!outlinePath) {\n      return;\n    }\n    if (enable) {\n      outlinePath.setAttribute(\n        'filter',\n        'url(#' + this.constants.replacementGlowFilterId + ')',\n      );\n    } else {\n      outlinePath.removeAttribute('filter');\n    }\n  }\n\n  /**\n   * Method that's called when the drawer is about to draw the block.\n   */\n  beginDrawing() {\n    this.remainingOutlines.clear();\n    for (const key of this.outlines.keys()) {\n      this.remainingOutlines.add(key);\n    }\n  }\n\n  /**\n   * Method that's called when the drawer is done drawing.\n   */\n  endDrawing() {\n    // Go through all remaining outlines that were not used this draw pass, and\n    // remove them.\n    if (this.remainingOutlines.size) {\n      for (const key of this.remainingOutlines) {\n        this.removeOutlinePath(key);\n      }\n    }\n    this.remainingOutlines.clear();\n  }\n\n  /**\n   * Set the path generated by the renderer for an outline path on the\n   * respective outline path SVG element.\n   *\n   * @param name The input name.\n   * @param pathString The path.\n   */\n  setOutlinePath(name: string, pathString: string) {\n    const outline = this.getOutlinePath(name);\n    outline.setAttribute('d', pathString);\n    outline.setAttribute('fill', this.style.colourTertiary);\n  }\n\n  /**\n   * Create's an outline path for the specified input.\n   *\n   * @param name The input name.\n   * @returns The SVG outline path.\n   */\n  private getOutlinePath(name: string): SVGElement {\n    if (!this.outlines.has(name)) {\n      this.outlines.set(\n        name,\n        dom.createSvgElement(\n          Svg.PATH,\n          {\n            'class': 'blocklyOutlinePath', // IE doesn't like paths without the\n            // data definition, set empty\n            // default\n            'd': '',\n          },\n          this.svgRoot,\n        ),\n      );\n    }\n    this.remainingOutlines.delete(name);\n    return this.outlines.get(name)!;\n  }\n\n  /**\n   * Remove an outline path that is associated with the specified input.\n   *\n   * @param name The input name.\n   */\n  private removeOutlinePath(name: string) {\n    this.outlines.get(name)?.parentNode?.removeChild(this.outlines.get(name)!);\n    this.outlines.delete(name);\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.zelos.Renderer\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport {ConnectionType} from '../../connection_type.js';\nimport {InsertionMarkerManager} from '../../insertion_marker_manager.js';\nimport type {Marker} from '../../keyboard_nav/marker.js';\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {BlockStyle} from '../../theme.js';\nimport type {WorkspaceSvg} from '../../workspace_svg.js';\nimport * as blockRendering from '../common/block_rendering.js';\nimport type {RenderInfo as BaseRenderInfo} from '../common/info.js';\nimport {Renderer as BaseRenderer} from '../common/renderer.js';\n\nimport {ConstantProvider} from './constants.js';\nimport {Drawer} from './drawer.js';\nimport {RenderInfo} from './info.js';\nimport {MarkerSvg} from './marker_svg.js';\nimport {PathObject} from './path_object.js';\nimport * as deprecation from '../../utils/deprecation.js';\n\n/**\n * The zelos renderer. This renderer emulates Scratch-style and MakeCode-style\n * rendering.\n *\n * Zelos is the ancient Greek spirit of rivalry and emulation.\n */\nexport class Renderer extends BaseRenderer {\n  protected override constants_!: ConstantProvider;\n\n  /**\n   * @param name The renderer name.\n   */\n  constructor(name: string) {\n    super(name);\n  }\n\n  /**\n   * Create a new instance of the renderer's constant provider.\n   *\n   * @returns The constant provider.\n   */\n  protected override makeConstants_(): ConstantProvider {\n    return new ConstantProvider();\n  }\n\n  /**\n   * Create a new instance of the renderer's render info object.\n   *\n   * @param block The block to measure.\n   * @returns The render info object.\n   */\n  protected override makeRenderInfo_(block: BlockSvg): RenderInfo {\n    return new RenderInfo(this, block);\n  }\n\n  /**\n   * Create a new instance of the renderer's drawer.\n   *\n   * @param block The block to render.\n   * @param info An object containing all information needed to render this\n   *     block.\n   * @returns The drawer.\n   */\n  protected override makeDrawer_(\n    block: BlockSvg,\n    info: BaseRenderInfo,\n  ): Drawer {\n    return new Drawer(block, info as RenderInfo);\n  }\n\n  /**\n   * Create a new instance of the renderer's cursor drawer.\n   *\n   * @param workspace The workspace the cursor belongs to.\n   * @param marker The marker.\n   * @returns The object in charge of drawing the marker.\n   */\n  override makeMarkerDrawer(\n    workspace: WorkspaceSvg,\n    marker: Marker,\n  ): MarkerSvg {\n    return new MarkerSvg(workspace, this.getConstants(), marker);\n  }\n\n  /**\n   * Create a new instance of a renderer path object.\n   *\n   * @param root The root SVG element.\n   * @param style The style object to use for colouring.\n   * @returns The renderer path object.\n   */\n  override makePathObject(root: SVGElement, style: BlockStyle): PathObject {\n    return new PathObject(root, style, this.getConstants() as ConstantProvider);\n  }\n\n  /**\n   * Get the current renderer's constant provider.  We assume that when this is\n   * called, the renderer has already been initialized.\n   *\n   * @returns The constant provider.\n   */\n  override getConstants(): ConstantProvider {\n    return this.constants_;\n  }\n\n  /**\n   * @deprecated v10 - This function is no longer respected. A custom\n   *    IConnectionPreviewer may be able to fulfill the functionality.\n   */\n  override getConnectionPreviewMethod(\n    closest: RenderedConnection,\n    local: RenderedConnection,\n    topBlock: BlockSvg,\n  ) {\n    deprecation.warn(\n      'getConnectionPreviewMethod',\n      'v10',\n      'v12',\n      'an IConnectionPreviewer, if it fulfills your use case.',\n    );\n    if (local.type === ConnectionType.OUTPUT_VALUE) {\n      if (!closest.isConnected()) {\n        return InsertionMarkerManager.PREVIEW_TYPE.INPUT_OUTLINE;\n      }\n      // TODO: Returning this is a total hack, because we don't want to show\n      //   a replacement fade, we want to show an outline affect.\n      //   Sadly zelos does not support showing an outline around filled\n      //   inputs, so we have to pretend like the connected block is getting\n      //   replaced.\n      return InsertionMarkerManager.PREVIEW_TYPE.REPLACEMENT_FADE;\n    }\n\n    return super.getConnectionPreviewMethod(closest, local, topBlock);\n  }\n}\n\nblockRendering.register('zelos', Renderer);\n","/** @file Re-exports of Blockly.zelos.* modules. */\n\n/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.zelos\n\nimport {ConstantProvider} from './constants.js';\nimport {Drawer} from './drawer.js';\nimport {RenderInfo} from './info.js';\nimport {MarkerSvg} from './marker_svg.js';\nimport {BottomRow} from './measurables/bottom_row.js';\nimport {StatementInput} from './measurables/inputs.js';\nimport {RightConnectionShape} from './measurables/row_elements.js';\nimport {TopRow} from './measurables/top_row.js';\nimport {PathObject} from './path_object.js';\nimport {Renderer} from './renderer.js';\n\nexport {\n  BottomRow,\n  ConstantProvider,\n  Drawer,\n  MarkerSvg,\n  PathObject,\n  Renderer,\n  RenderInfo,\n  RightConnectionShape,\n  StatementInput,\n  TopRow,\n};\n","/**\n * @license\n * Copyright 2013 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Angle input field.\n *\n * @class\n */\n// Former goog.module ID: Blockly.FieldAngle\n\nimport {BlockSvg} from './block_svg.js';\nimport * as browserEvents from './browser_events.js';\nimport * as Css from './css.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport * as eventUtils from './events/utils.js';\nimport {Field, UnattachedFieldError} from './field.js';\nimport * as fieldRegistry from './field_registry.js';\nimport {\n  FieldInput,\n  FieldInputConfig,\n  FieldInputValidator,\n} from './field_input.js';\nimport * as dom from './utils/dom.js';\nimport * as math from './utils/math.js';\nimport {Svg} from './utils/svg.js';\nimport * as userAgent from './utils/useragent.js';\nimport * as WidgetDiv from './widgetdiv.js';\n\n/**\n * Class for an editable angle field.\n */\nexport class FieldAngle extends FieldInput<number> {\n  /** Half the width of protractor image. */\n  static readonly HALF = 100 / 2;\n\n  /**\n   * Radius of protractor circle.  Slightly smaller than protractor size since\n   * otherwise SVG crops off half the border at the edges.\n   */\n  static readonly RADIUS: number = FieldAngle.HALF - 1;\n\n  /**\n   * Default property describing which direction makes an angle field's value\n   * increase. Angle increases clockwise (true) or counterclockwise (false).\n   */\n  static readonly CLOCKWISE = false;\n\n  /**\n   * The default offset of 0 degrees (and all angles). Always offsets in the\n   * counterclockwise direction, regardless of the field's clockwise property.\n   * Usually either 0 (0 = right) or 90 (0 = up).\n   */\n  static readonly OFFSET = 0;\n\n  /**\n   * The default maximum angle to allow before wrapping.\n   * Usually either 360 (for 0 to 359.9) or 180 (for -179.9 to 180).\n   */\n  static readonly WRAP = 360;\n\n  /**\n   * The default amount to round angles to when using a mouse or keyboard nav\n   * input. Must be a positive integer to support keyboard navigation.\n   */\n  static readonly ROUND = 15;\n\n  /**\n   * Whether the angle should increase as the angle picker is moved clockwise\n   * (true) or counterclockwise (false).\n   */\n  private clockwise = FieldAngle.CLOCKWISE;\n\n  /**\n   * The offset of zero degrees (and all other angles).\n   */\n  private offset = FieldAngle.OFFSET;\n\n  /**\n   * The maximum angle to allow before wrapping.\n   */\n  private wrap = FieldAngle.WRAP;\n\n  /**\n   * The amount to round angles to when using a mouse or keyboard nav input.\n   */\n  private round = FieldAngle.ROUND;\n\n  /**\n   * Array holding info needed to unbind events.\n   * Used for disposing.\n   * Ex: [[node, name, func], [node, name, func]].\n   */\n  private boundEvents: browserEvents.Data[] = [];\n\n  /** Dynamic red line pointing at the value's angle. */\n  private line: SVGLineElement | null = null;\n\n  /** Dynamic pink area extending from 0 to the value's angle. */\n  private gauge: SVGPathElement | null = null;\n\n  /** The degree symbol for this field. */\n  protected symbol_: SVGTSpanElement | null = null;\n\n  /**\n   * @param value The initial value of the field. Should cast to a number.\n   *     Defaults to 0. Also accepts Field.SKIP_SETUP if you wish to skip setup\n   *     (only used by subclasses that want to handle configuration and setting\n   *     the field value after their own constructors have run).\n   * @param validator A function that is called to validate changes to the\n   *     field's value. Takes in a number & returns a validated number, or null\n   *     to abort the change.\n   * @param config A map of options used to configure the field.\n   *     See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/angle#creation}\n   * for a list of properties this parameter supports.\n   */\n  constructor(\n    value?: string | number | typeof Field.SKIP_SETUP,\n    validator?: FieldAngleValidator,\n    config?: FieldAngleConfig,\n  ) {\n    super(Field.SKIP_SETUP);\n\n    if (value === Field.SKIP_SETUP) return;\n    if (config) {\n      this.configure_(config);\n    }\n    this.setValue(value);\n    if (validator) {\n      this.setValidator(validator);\n    }\n  }\n\n  /**\n   * Configure the field based on the given map of options.\n   *\n   * @param config A map of options to configure the field based on.\n   */\n  protected override configure_(config: FieldAngleConfig) {\n    super.configure_(config);\n\n    switch (config.mode) {\n      case Mode.COMPASS:\n        this.clockwise = true;\n        this.offset = 90;\n        break;\n      case Mode.PROTRACTOR:\n        // This is the default mode, so we could do nothing. But just to\n        // future-proof, we'll set it anyway.\n        this.clockwise = false;\n        this.offset = 0;\n        break;\n    }\n\n    // Allow individual settings to override the mode setting.\n    if (config.clockwise) this.clockwise = config.clockwise;\n    if (config.offset) this.offset = config.offset;\n    if (config.wrap) this.wrap = config.wrap;\n    if (config.round) this.round = config.round;\n  }\n\n  /**\n   * Create the block UI for this field.\n   */\n  override initView() {\n    super.initView();\n    // Add the degree symbol to the left of the number,\n    // even in RTL (issue #2380).\n    this.symbol_ = dom.createSvgElement(Svg.TSPAN, {});\n    this.symbol_.appendChild(document.createTextNode('°'));\n    this.getTextElement().appendChild(this.symbol_);\n  }\n\n  /** Updates the angle when the field rerenders. */\n  protected override render_() {\n    super.render_();\n    this.updateGraph();\n  }\n\n  /**\n   * Create and show the angle field's editor.\n   *\n   * @param e Optional mouse event that triggered the field to open,\n   *     or undefined if triggered programmatically.\n   */\n  protected override showEditor_(e?: Event) {\n    // Mobile browsers have issues with in-line textareas (focus & keyboards).\n    const noFocus = userAgent.MOBILE || userAgent.ANDROID || userAgent.IPAD;\n    super.showEditor_(e, noFocus);\n\n    const editor = this.dropdownCreate();\n    dropDownDiv.getContentDiv().appendChild(editor);\n\n    if (this.sourceBlock_ instanceof BlockSvg) {\n      dropDownDiv.setColour(\n        this.sourceBlock_.style.colourPrimary,\n        this.sourceBlock_.style.colourTertiary,\n      );\n    }\n\n    dropDownDiv.showPositionedByField(this, this.dropdownDispose.bind(this));\n\n    this.updateGraph();\n  }\n\n  /**\n   * Creates the angle dropdown editor.\n   *\n   * @returns The newly created slider.\n   */\n  private dropdownCreate(): SVGSVGElement {\n    const svg = dom.createSvgElement(Svg.SVG, {\n      'xmlns': dom.SVG_NS,\n      'xmlns:html': dom.HTML_NS,\n      'xmlns:xlink': dom.XLINK_NS,\n      'version': '1.1',\n      'height': FieldAngle.HALF * 2 + 'px',\n      'width': FieldAngle.HALF * 2 + 'px',\n    });\n    svg.style.touchAction = 'none';\n    const circle = dom.createSvgElement(\n      Svg.CIRCLE,\n      {\n        'cx': FieldAngle.HALF,\n        'cy': FieldAngle.HALF,\n        'r': FieldAngle.RADIUS,\n        'class': 'blocklyAngleCircle',\n      },\n      svg,\n    );\n    this.gauge = dom.createSvgElement(\n      Svg.PATH,\n      {'class': 'blocklyAngleGauge'},\n      svg,\n    );\n    this.line = dom.createSvgElement(\n      Svg.LINE,\n      {\n        'x1': FieldAngle.HALF,\n        'y1': FieldAngle.HALF,\n        'class': 'blocklyAngleLine',\n      },\n      svg,\n    );\n    // Draw markers around the edge.\n    for (let angle = 0; angle < 360; angle += 15) {\n      dom.createSvgElement(\n        Svg.LINE,\n        {\n          'x1': FieldAngle.HALF + FieldAngle.RADIUS,\n          'y1': FieldAngle.HALF,\n          'x2':\n            FieldAngle.HALF + FieldAngle.RADIUS - (angle % 45 === 0 ? 10 : 5),\n          'y2': FieldAngle.HALF,\n          'class': 'blocklyAngleMarks',\n          'transform':\n            'rotate(' +\n            angle +\n            ',' +\n            FieldAngle.HALF +\n            ',' +\n            FieldAngle.HALF +\n            ')',\n        },\n        svg,\n      );\n    }\n\n    // The angle picker is different from other fields in that it updates on\n    // mousemove even if it's not in the middle of a drag.  In future we may\n    // change this behaviour.\n    this.boundEvents.push(\n      browserEvents.conditionalBind(svg, 'click', this, this.hide),\n    );\n    // On touch devices, the picker's value is only updated with a drag. Add\n    // a click handler on the drag surface to update the value if the surface\n    // is clicked.\n    this.boundEvents.push(\n      browserEvents.conditionalBind(\n        circle,\n        'pointerdown',\n        this,\n        this.onMouseMove_,\n        true,\n      ),\n    );\n    this.boundEvents.push(\n      browserEvents.conditionalBind(\n        circle,\n        'pointermove',\n        this,\n        this.onMouseMove_,\n        true,\n      ),\n    );\n    return svg;\n  }\n\n  /** Disposes of events and DOM-references belonging to the angle editor. */\n  private dropdownDispose() {\n    for (const event of this.boundEvents) {\n      browserEvents.unbind(event);\n    }\n    this.boundEvents.length = 0;\n    this.gauge = null;\n    this.line = null;\n  }\n\n  /** Hide the editor. */\n  private hide() {\n    dropDownDiv.hideIfOwner(this);\n    WidgetDiv.hide();\n  }\n\n  /**\n   * Set the angle to match the mouse's position.\n   *\n   * @param e Mouse move event.\n   */\n  protected onMouseMove_(e: PointerEvent) {\n    // Calculate angle.\n    const bBox = this.gauge!.ownerSVGElement!.getBoundingClientRect();\n    const dx = e.clientX - bBox.left - FieldAngle.HALF;\n    const dy = e.clientY - bBox.top - FieldAngle.HALF;\n    let angle = Math.atan(-dy / dx);\n    if (isNaN(angle)) {\n      // This shouldn't happen, but let's not let this error propagate further.\n      return;\n    }\n    angle = math.toDegrees(angle);\n    // 0: East, 90: North, 180: West, 270: South.\n    if (dx < 0) {\n      angle += 180;\n    } else if (dy > 0) {\n      angle += 360;\n    }\n\n    // Do offsetting.\n    if (this.clockwise) {\n      angle = this.offset + 360 - angle;\n    } else {\n      angle = 360 - (this.offset - angle);\n    }\n\n    this.displayMouseOrKeyboardValue(angle);\n  }\n\n  /**\n   * Handles and displays values that are input via mouse or arrow key input.\n   * These values need to be rounded and wrapped before being displayed so\n   * that the text input's value is appropriate.\n   *\n   * @param angle New angle.\n   */\n  private displayMouseOrKeyboardValue(angle: number) {\n    if (this.round) {\n      angle = Math.round(angle / this.round) * this.round;\n    }\n    angle = this.wrapValue(angle);\n    if (angle !== this.value_) {\n      // Intermediate value changes from user input are not confirmed until the\n      // user closes the editor, and may be numerous. Inhibit reporting these as\n      // normal block change events, and instead report them as special\n      // intermediate changes that do not get recorded in undo history.\n      const oldValue = this.value_;\n      this.setEditorValue_(angle, false);\n      if (\n        this.sourceBlock_ &&\n        eventUtils.isEnabled() &&\n        this.value_ !== oldValue\n      ) {\n        eventUtils.fire(\n          new (eventUtils.get(eventUtils.BLOCK_FIELD_INTERMEDIATE_CHANGE))(\n            this.sourceBlock_,\n            this.name || null,\n            oldValue,\n            this.value_,\n          ),\n        );\n      }\n    }\n  }\n\n  /** Redraw the graph with the current angle. */\n  private updateGraph() {\n    if (!this.gauge || !this.line) {\n      return;\n    }\n    // Always display the input (i.e. getText) even if it is invalid.\n    let angleDegrees = Number(this.getText()) + this.offset;\n    angleDegrees %= 360;\n    let angleRadians = math.toRadians(angleDegrees);\n    const path = ['M ', FieldAngle.HALF, ',', FieldAngle.HALF];\n    let x2 = FieldAngle.HALF;\n    let y2 = FieldAngle.HALF;\n    if (!isNaN(angleRadians)) {\n      const clockwiseFlag = Number(this.clockwise);\n      const angle1 = math.toRadians(this.offset);\n      const x1 = Math.cos(angle1) * FieldAngle.RADIUS;\n      const y1 = Math.sin(angle1) * -FieldAngle.RADIUS;\n      if (clockwiseFlag) {\n        angleRadians = 2 * angle1 - angleRadians;\n      }\n      x2 += Math.cos(angleRadians) * FieldAngle.RADIUS;\n      y2 -= Math.sin(angleRadians) * FieldAngle.RADIUS;\n      // Don't ask how the flag calculations work.  They just do.\n      let largeFlag = Math.abs(\n        Math.floor((angleRadians - angle1) / Math.PI) % 2,\n      );\n      if (clockwiseFlag) {\n        largeFlag = 1 - largeFlag;\n      }\n      path.push(\n        ' l ',\n        x1,\n        ',',\n        y1,\n        ' A ',\n        FieldAngle.RADIUS,\n        ',',\n        FieldAngle.RADIUS,\n        ' 0 ',\n        largeFlag,\n        ' ',\n        clockwiseFlag,\n        ' ',\n        x2,\n        ',',\n        y2,\n        ' z',\n      );\n    }\n    this.gauge.setAttribute('d', path.join(''));\n    this.line.setAttribute('x2', `${x2}`);\n    this.line.setAttribute('y2', `${y2}`);\n  }\n\n  /**\n   * Handle key down to the editor.\n   *\n   * @param e Keyboard event.\n   */\n  protected override onHtmlInputKeyDown_(e: KeyboardEvent) {\n    super.onHtmlInputKeyDown_(e);\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n\n    let multiplier = 0;\n    switch (e.key) {\n      case 'ArrowLeft':\n        // decrement (increment in RTL)\n        multiplier = block.RTL ? 1 : -1;\n        break;\n      case 'ArrowRight':\n        // increment (decrement in RTL)\n        multiplier = block.RTL ? -1 : 1;\n        break;\n      case 'ArrowDown':\n        // decrement\n        multiplier = -1;\n        break;\n      case 'ArrowUp':\n        // increment\n        multiplier = 1;\n        break;\n    }\n    if (multiplier) {\n      const value = this.getValue() as number;\n      this.displayMouseOrKeyboardValue(value + multiplier * this.round);\n      e.preventDefault();\n      e.stopPropagation();\n    }\n  }\n\n  /**\n   * Ensure that the input value is a valid angle.\n   *\n   * @param newValue The input value.\n   * @returns A valid angle, or null if invalid.\n   */\n  protected override doClassValidation_(newValue?: any): number | null {\n    const value = Number(newValue);\n    if (isNaN(value) || !isFinite(value)) {\n      return null;\n    }\n    return this.wrapValue(value);\n  }\n\n  /**\n   * Wraps the value so that it is in the range (-360 + wrap, wrap).\n   *\n   * @param value The value to wrap.\n   * @returns The wrapped value.\n   */\n  private wrapValue(value: number): number {\n    value %= 360;\n    if (value < 0) {\n      value += 360;\n    }\n    if (value > this.wrap) {\n      value -= 360;\n    }\n    return value;\n  }\n\n  /**\n   * Construct a FieldAngle from a JSON arg object.\n   *\n   * @param options A JSON object with options (angle).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static fromJson(options: FieldAngleFromJsonConfig): FieldAngle {\n    // `this` might be a subclass of FieldAngle if that class doesn't override\n    // the static fromJson method.\n    return new this(options.angle, undefined, options);\n  }\n}\n\nfieldRegistry.register('field_angle', FieldAngle);\n\nFieldAngle.prototype.DEFAULT_VALUE = 0;\n\n/**\n * CSS for angle field.\n */\nCss.register(`\n.blocklyAngleCircle {\n  stroke: #444;\n  stroke-width: 1;\n  fill: #ddd;\n  fill-opacity: 0.8;\n}\n\n.blocklyAngleMarks {\n  stroke: #444;\n  stroke-width: 1;\n}\n\n.blocklyAngleGauge {\n  fill: #f88;\n  fill-opacity: 0.8;\n  pointer-events: none;\n}\n\n.blocklyAngleLine {\n  stroke: #f00;\n  stroke-width: 2;\n  stroke-linecap: round;\n  pointer-events: none;\n}\n`);\n\n/**\n * The two main modes of the angle field.\n * Compass specifies:\n *   - clockwise: true\n *   - offset: 90\n *   - wrap: 0\n *   - round: 15\n *\n * Protractor specifies:\n *   - clockwise: false\n *   - offset: 0\n *   - wrap: 0\n *   - round: 15\n */\nexport enum Mode {\n  COMPASS = 'compass',\n  PROTRACTOR = 'protractor',\n}\n\n/**\n * Extra configuration options for the angle field.\n */\nexport interface FieldAngleConfig extends FieldInputConfig {\n  mode?: Mode;\n  clockwise?: boolean;\n  offset?: number;\n  wrap?: number;\n  round?: number;\n}\n\n/**\n * fromJson configuration options for the angle field.\n */\nexport interface FieldAngleFromJsonConfig extends FieldAngleConfig {\n  angle?: number;\n}\n\n/**\n * A function that is called to validate changes to the field's value before\n * they are set.\n *\n * @see {@link https://developers.google.com/blockly/guides/create-custom-blocks/fields/validators#return_values}\n * @param newValue The value to be validated.\n * @returns One of three instructions for setting the new value: `T`, `null`,\n * or `undefined`.\n *\n * - `T` to set this function's returned value instead of `newValue`.\n *\n * - `null` to invoke `doValueInvalid_` and not set a value.\n *\n * - `undefined` to set `newValue` as is.\n */\nexport type FieldAngleValidator = FieldInputValidator<number>;\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Checkbox field.  Checked or not checked.\n *\n * @class\n */\n// Former goog.module ID: Blockly.FieldCheckbox\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_change.js';\n\nimport * as dom from './utils/dom.js';\nimport {Field, FieldConfig, FieldValidator} from './field.js';\nimport * as fieldRegistry from './field_registry.js';\n\ntype BoolString = 'TRUE' | 'FALSE';\ntype CheckboxBool = BoolString | boolean;\n\n/**\n * Class for a checkbox field.\n */\nexport class FieldCheckbox extends Field<CheckboxBool> {\n  /** Default character for the checkmark. */\n  static readonly CHECK_CHAR = '✓';\n  private checkChar: string;\n\n  /**\n   * Serializable fields are saved by the serializer, non-serializable fields\n   * are not. Editable fields should also be serializable.\n   */\n  override SERIALIZABLE = true;\n\n  /**\n   * Mouse cursor style when over the hotspot that initiates editability.\n   */\n  override CURSOR = 'default';\n\n  /**\n   * NOTE: The default value is set in `Field`, so maintain that value instead\n   * of overwriting it here or in the constructor.\n   */\n  override value_: boolean | null = this.value_;\n\n  /**\n   * @param value The initial value of the field. Should either be 'TRUE',\n   *     'FALSE' or a boolean. Defaults to 'FALSE'. Also accepts\n   *     Field.SKIP_SETUP if you wish to skip setup (only used by subclasses\n   *     that want to handle configuration and setting the field value after\n   *     their own constructors have run).\n   * @param validator  A function that is called to validate changes to the\n   *     field's value. Takes in a value ('TRUE' or 'FALSE') & returns a\n   *     validated value ('TRUE' or 'FALSE'), or null to abort the change.\n   * @param config A map of options used to configure the field.\n   *     See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/checkbox#creation}\n   * for a list of properties this parameter supports.\n   */\n  constructor(\n    value?: CheckboxBool | typeof Field.SKIP_SETUP,\n    validator?: FieldCheckboxValidator,\n    config?: FieldCheckboxConfig,\n  ) {\n    super(Field.SKIP_SETUP);\n\n    /**\n     * Character for the check mark. Used to apply a different check mark\n     * character to individual fields.\n     */\n    this.checkChar = FieldCheckbox.CHECK_CHAR;\n\n    if (value === Field.SKIP_SETUP) return;\n    if (config) {\n      this.configure_(config);\n    }\n    this.setValue(value);\n    if (validator) {\n      this.setValidator(validator);\n    }\n  }\n\n  /**\n   * Configure the field based on the given map of options.\n   *\n   * @param config A map of options to configure the field based on.\n   */\n  protected override configure_(config: FieldCheckboxConfig) {\n    super.configure_(config);\n    if (config.checkCharacter) this.checkChar = config.checkCharacter;\n  }\n\n  /**\n   * Saves this field's value.\n   *\n   * @returns The boolean value held by this field.\n   * @internal\n   */\n  override saveState(): AnyDuringMigration {\n    const legacyState = this.saveLegacyState(FieldCheckbox);\n    if (legacyState !== null) {\n      return legacyState;\n    }\n    return this.getValueBoolean();\n  }\n\n  /**\n   * Create the block UI for this checkbox.\n   */\n  override initView() {\n    super.initView();\n\n    const textElement = this.getTextElement();\n    dom.addClass(textElement, 'blocklyCheckbox');\n    textElement.style.display = this.value_ ? 'block' : 'none';\n  }\n\n  override render_() {\n    if (this.textContent_) {\n      this.textContent_.nodeValue = this.getDisplayText_();\n    }\n    this.updateSize_(this.getConstants()!.FIELD_CHECKBOX_X_OFFSET);\n  }\n\n  override getDisplayText_() {\n    return this.checkChar;\n  }\n\n  /**\n   * Set the character used for the check mark.\n   *\n   * @param character The character to use for the check mark, or null to use\n   *     the default.\n   */\n  setCheckCharacter(character: string | null) {\n    this.checkChar = character || FieldCheckbox.CHECK_CHAR;\n    this.forceRerender();\n  }\n\n  /** Toggle the state of the checkbox on click. */\n  protected override showEditor_() {\n    this.setValue(!this.value_);\n  }\n\n  /**\n   * Ensure that the input value is valid ('TRUE' or 'FALSE').\n   *\n   * @param newValue The input value.\n   * @returns A valid value ('TRUE' or 'FALSE), or null if invalid.\n   */\n  protected override doClassValidation_(\n    newValue?: AnyDuringMigration,\n  ): BoolString | null {\n    if (newValue === true || newValue === 'TRUE') {\n      return 'TRUE';\n    }\n    if (newValue === false || newValue === 'FALSE') {\n      return 'FALSE';\n    }\n    return null;\n  }\n\n  /**\n   * Update the value of the field, and update the checkElement.\n   *\n   * @param newValue The value to be saved. The default validator guarantees\n   *     that this is a either 'TRUE' or 'FALSE'.\n   */\n  protected override doValueUpdate_(newValue: BoolString) {\n    this.value_ = this.convertValueToBool_(newValue);\n    // Update visual.\n    if (this.textElement_) {\n      this.textElement_.style.display = this.value_ ? 'block' : 'none';\n    }\n  }\n\n  /**\n   * Get the value of this field, either 'TRUE' or 'FALSE'.\n   *\n   * @returns The value of this field.\n   */\n  override getValue(): BoolString {\n    return this.value_ ? 'TRUE' : 'FALSE';\n  }\n\n  /**\n   * Get the boolean value of this field.\n   *\n   * @returns The boolean value of this field.\n   */\n  getValueBoolean(): boolean | null {\n    return this.value_;\n  }\n\n  /**\n   * Get the text of this field. Used when the block is collapsed.\n   *\n   * @returns Text representing the value of this field ('true' or 'false').\n   */\n  override getText(): string {\n    return String(this.convertValueToBool_(this.value_));\n  }\n\n  /**\n   * Convert a value into a pure boolean.\n   *\n   * Converts 'TRUE' to true and 'FALSE' to false correctly, everything else\n   * is cast to a boolean.\n   *\n   * @param value The value to convert.\n   * @returns The converted value.\n   */\n  private convertValueToBool_(value: CheckboxBool | null): boolean {\n    if (typeof value === 'string') return value === 'TRUE';\n    return !!value;\n  }\n\n  /**\n   * Construct a FieldCheckbox from a JSON arg object.\n   *\n   * @param options A JSON object with options (checked).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static fromJson(options: FieldCheckboxFromJsonConfig): FieldCheckbox {\n    // `this` might be a subclass of FieldCheckbox if that class doesn't\n    // 'override' the static fromJson method.\n    return new this(options.checked, undefined, options);\n  }\n}\n\nfieldRegistry.register('field_checkbox', FieldCheckbox);\n\nFieldCheckbox.prototype.DEFAULT_VALUE = false;\n\n/**\n * Config options for the checkbox field.\n */\nexport interface FieldCheckboxConfig extends FieldConfig {\n  checkCharacter?: string;\n}\n\n/**\n * fromJson config options for the checkbox field.\n */\nexport interface FieldCheckboxFromJsonConfig extends FieldCheckboxConfig {\n  checked?: boolean;\n}\n\n/**\n * A function that is called to validate changes to the field's value before\n * they are set.\n *\n * @see {@link https://developers.google.com/blockly/guides/create-custom-blocks/fields/validators#return_values}\n * @param newValue The value to be validated.\n * @returns One of three instructions for setting the new value: `T`, `null`,\n * or `undefined`.\n *\n * - `T` to set this function's returned value instead of `newValue`.\n *\n * - `null` to invoke `doValueInvalid_` and not set a value.\n *\n * - `undefined` to set `newValue` as is.\n */\nexport type FieldCheckboxValidator = FieldValidator<CheckboxBool>;\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Colour input field.\n *\n * @class\n */\n// Former goog.module ID: Blockly.FieldColour\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_change.js';\n\nimport {BlockSvg} from './block_svg.js';\nimport * as browserEvents from './browser_events.js';\nimport * as Css from './css.js';\nimport * as dom from './utils/dom.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport {\n  Field,\n  FieldConfig,\n  FieldValidator,\n  UnattachedFieldError,\n} from './field.js';\nimport * as fieldRegistry from './field_registry.js';\nimport * as aria from './utils/aria.js';\nimport * as colour from './utils/colour.js';\nimport * as idGenerator from './utils/idgenerator.js';\nimport {Size} from './utils/size.js';\n\n/**\n * Class for a colour input field.\n */\nexport class FieldColour extends Field<string> {\n  /**\n   * An array of colour strings for the palette.\n   * Copied from goog.ui.ColorPicker.SIMPLE_GRID_COLORS\n   * All colour pickers use this unless overridden with setColours.\n   */\n  // prettier-ignore\n  static COLOURS: string[] = [\n    // grays\n    '#ffffff', '#cccccc', '#c0c0c0', '#999999',\n    '#666666', '#333333', '#000000',  // reds\n    '#ffcccc', '#ff6666', '#ff0000', '#cc0000',\n    '#990000', '#660000', '#330000',  // oranges\n    '#ffcc99', '#ff9966', '#ff9900', '#ff6600',\n    '#cc6600', '#993300', '#663300',  // yellows\n    '#ffff99', '#ffff66', '#ffcc66', '#ffcc33',\n    '#cc9933', '#996633', '#663333',  // olives\n    '#ffffcc', '#ffff33', '#ffff00', '#ffcc00',\n    '#999900', '#666600', '#333300',  // greens\n    '#99ff99', '#66ff99', '#33ff33', '#33cc00',\n    '#009900', '#006600', '#003300',  // turquoises\n    '#99ffff', '#33ffff', '#66cccc', '#00cccc',\n    '#339999', '#336666', '#003333',  // blues\n    '#ccffff', '#66ffff', '#33ccff', '#3366ff',\n    '#3333ff', '#000099', '#000066',  // purples\n    '#ccccff', '#9999ff', '#6666cc', '#6633ff',\n    '#6600cc', '#333399', '#330099',  // violets\n    '#ffccff', '#ff99ff', '#cc66cc', '#cc33cc',\n    '#993399', '#663366', '#330033',\n  ];\n\n  /**\n   * An array of tooltip strings for the palette.  If not the same length as\n   * COLOURS, the colour's hex code will be used for any missing titles.\n   * All colour pickers use this unless overridden with setColours.\n   */\n  static TITLES: string[] = [];\n\n  /**\n   * Number of columns in the palette.\n   * All colour pickers use this unless overridden with setColumns.\n   */\n  static COLUMNS = 7;\n\n  /** The field's colour picker element. */\n  private picker: HTMLElement | null = null;\n\n  /** Index of the currently highlighted element. */\n  private highlightedIndex: number | null = null;\n\n  /**\n   * Array holding info needed to unbind events.\n   * Used for disposing.\n   * Ex: [[node, name, func], [node, name, func]].\n   */\n  private boundEvents: browserEvents.Data[] = [];\n\n  /**\n   * Serializable fields are saved by the serializer, non-serializable fields\n   * are not. Editable fields should also be serializable.\n   */\n  override SERIALIZABLE = true;\n\n  /** Mouse cursor style when over the hotspot that initiates the editor. */\n  override CURSOR = 'default';\n\n  /**\n   * Used to tell if the field needs to be rendered the next time the block is\n   * rendered. Colour fields are statically sized, and only need to be\n   * rendered at initialization.\n   */\n  protected override isDirty_ = false;\n\n  /** Array of colours used by this field.  If null, use the global list. */\n  private colours: string[] | null = null;\n\n  /**\n   * Array of colour tooltips used by this field.  If null, use the global\n   * list.\n   */\n  private titles: string[] | null = null;\n\n  /**\n   * Number of colour columns used by this field.  If 0, use the global\n   * setting. By default use the global constants for columns.\n   */\n  private columns = 0;\n\n  /**\n   * @param value The initial value of the field. Should be in '#rrggbb'\n   *     format. Defaults to the first value in the default colour array. Also\n   *     accepts Field.SKIP_SETUP if you wish to skip setup (only used by\n   *     subclasses that want to handle configuration and setting the field\n   *     value after their own constructors have run).\n   * @param validator A function that is called to validate changes to the\n   *     field's value. Takes in a colour string & returns a validated colour\n   *     string ('#rrggbb' format), or null to abort the change.\n   * @param config A map of options used to configure the field.\n   *     See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/colour}\n   * for a list of properties this parameter supports.\n   */\n  constructor(\n    value?: string | typeof Field.SKIP_SETUP,\n    validator?: FieldColourValidator,\n    config?: FieldColourConfig,\n  ) {\n    super(Field.SKIP_SETUP);\n\n    if (value === Field.SKIP_SETUP) return;\n    if (config) {\n      this.configure_(config);\n    }\n    this.setValue(value);\n    if (validator) {\n      this.setValidator(validator);\n    }\n  }\n\n  /**\n   * Configure the field based on the given map of options.\n   *\n   * @param config A map of options to configure the field based on.\n   */\n  protected override configure_(config: FieldColourConfig) {\n    super.configure_(config);\n    if (config.colourOptions) this.colours = config.colourOptions;\n    if (config.colourTitles) this.titles = config.colourTitles;\n    if (config.columns) this.columns = config.columns;\n  }\n\n  /**\n   * Create the block UI for this colour field.\n   */\n  override initView() {\n    this.size_ = new Size(\n      this.getConstants()!.FIELD_COLOUR_DEFAULT_WIDTH,\n      this.getConstants()!.FIELD_COLOUR_DEFAULT_HEIGHT,\n    );\n    this.createBorderRect_();\n    this.getBorderRect().style['fillOpacity'] = '1';\n    this.getBorderRect().setAttribute('stroke', '#fff');\n    if (this.isFullBlockField()) {\n      this.clickTarget_ = (this.sourceBlock_ as BlockSvg).getSvgRoot();\n    }\n  }\n\n  protected override isFullBlockField(): boolean {\n    const block = this.getSourceBlock();\n    if (!block) throw new UnattachedFieldError();\n\n    const constants = this.getConstants();\n    return block.isSimpleReporter() && !!constants?.FIELD_COLOUR_FULL_BLOCK;\n  }\n\n  /**\n   * Updates text field to match the colour/style of the block.\n   */\n  override applyColour() {\n    const block = this.getSourceBlock() as BlockSvg | null;\n    if (!block) throw new UnattachedFieldError();\n\n    if (!this.fieldGroup_) return;\n\n    const borderRect = this.borderRect_;\n    if (!borderRect) {\n      throw new Error('The border rect has not been initialized');\n    }\n\n    if (!this.isFullBlockField()) {\n      borderRect.style.display = 'block';\n      borderRect.style.fill = this.getValue() as string;\n    } else {\n      borderRect.style.display = 'none';\n      // In general, do *not* let fields control the color of blocks. Having the\n      // field control the color is unexpected, and could have performance\n      // impacts.\n      block.pathObject.svgPath.setAttribute('fill', this.getValue() as string);\n      block.pathObject.svgPath.setAttribute('stroke', '#fff');\n    }\n  }\n\n  /**\n   * Returns the height and width of the field.\n   *\n   * This should *in general* be the only place render_ gets called from.\n   *\n   * @returns Height and width.\n   */\n  override getSize(): Size {\n    if (this.getConstants()?.FIELD_COLOUR_FULL_BLOCK) {\n      // In general, do *not* let fields control the color of blocks. Having the\n      // field control the color is unexpected, and could have performance\n      // impacts.\n      // Full block fields have more control of the block than they should\n      // (i.e. updating fill colour). Whenever we get the size, the field may\n      // no longer be a full-block field, so we need to rerender.\n      this.render_();\n      this.isDirty_ = false;\n    }\n    return super.getSize();\n  }\n\n  /**\n   * Updates the colour of the block to reflect whether this is a full\n   * block field or not.\n   */\n  protected override render_() {\n    super.render_();\n\n    const block = this.getSourceBlock() as BlockSvg | null;\n    if (!block) throw new UnattachedFieldError();\n    // Calling applyColour updates the UI (full-block vs non-full-block) for the\n    // colour field, and the colour of the field/block.\n    block.applyColour();\n  }\n\n  /**\n   * Updates the size of the field based on whether it is a full block field\n   * or not.\n   *\n   * @param margin margin to use when positioning the field.\n   */\n  protected updateSize_(margin?: number) {\n    const constants = this.getConstants();\n    let totalWidth;\n    let totalHeight;\n    if (this.isFullBlockField()) {\n      const xOffset = margin ?? 0;\n      totalWidth = xOffset * 2;\n      totalHeight = constants!.FIELD_TEXT_HEIGHT;\n    } else {\n      totalWidth = constants!.FIELD_COLOUR_DEFAULT_WIDTH;\n      totalHeight = constants!.FIELD_COLOUR_DEFAULT_HEIGHT;\n    }\n\n    this.size_.height = totalHeight;\n    this.size_.width = totalWidth;\n\n    this.positionBorderRect_();\n  }\n\n  /**\n   * Ensure that the input value is a valid colour.\n   *\n   * @param newValue The input value.\n   * @returns A valid colour, or null if invalid.\n   */\n  protected override doClassValidation_(newValue?: any): string | null {\n    if (typeof newValue !== 'string') {\n      return null;\n    }\n    return colour.parse(newValue);\n  }\n\n  /**\n   * Get the text for this field.  Used when the block is collapsed.\n   *\n   * @returns Text representing the value of this field.\n   */\n  override getText(): string {\n    let colour = this.value_ as string;\n    // Try to use #rgb format if possible, rather than #rrggbb.\n    if (/^#(.)\\1(.)\\2(.)\\3$/.test(colour)) {\n      colour = '#' + colour[1] + colour[3] + colour[5];\n    }\n    return colour;\n  }\n\n  /**\n   * Set a custom colour grid for this field.\n   *\n   * @param colours Array of colours for this block, or null to use default\n   *     (FieldColour.COLOURS).\n   * @param titles Optional array of colour tooltips, or null to use default\n   *     (FieldColour.TITLES).\n   * @returns Returns itself (for method chaining).\n   */\n  setColours(colours: string[], titles?: string[]): FieldColour {\n    this.colours = colours;\n    if (titles) {\n      this.titles = titles;\n    }\n    return this;\n  }\n\n  /**\n   * Set a custom grid size for this field.\n   *\n   * @param columns Number of columns for this block, or 0 to use default\n   *     (FieldColour.COLUMNS).\n   * @returns Returns itself (for method chaining).\n   */\n  setColumns(columns: number): FieldColour {\n    this.columns = columns;\n    return this;\n  }\n\n  /** Create and show the colour field's editor. */\n  protected override showEditor_() {\n    this.dropdownCreate();\n    dropDownDiv.getContentDiv().appendChild(this.picker!);\n\n    dropDownDiv.showPositionedByField(this, this.dropdownDispose.bind(this));\n\n    // Focus so we can start receiving keyboard events.\n    this.picker!.focus({preventScroll: true});\n  }\n\n  /**\n   * Handle a click on a colour cell.\n   *\n   * @param e Mouse event.\n   */\n  private onClick(e: PointerEvent) {\n    const cell = e.target as Element;\n    const colour = cell && cell.getAttribute('data-colour');\n    if (colour !== null) {\n      this.setValue(colour);\n      dropDownDiv.hideIfOwner(this);\n    }\n  }\n\n  /**\n   * Handle a key down event. Navigate around the grid with the\n   * arrow keys. Enter selects the highlighted colour.\n   *\n   * @param e Keyboard event.\n   */\n  private onKeyDown(e: KeyboardEvent) {\n    let handled = true;\n    let highlighted: HTMLElement | null;\n    switch (e.key) {\n      case 'ArrowUp':\n        this.moveHighlightBy(0, -1);\n        break;\n      case 'ArrowDown':\n        this.moveHighlightBy(0, 1);\n        break;\n      case 'ArrowLeft':\n        this.moveHighlightBy(-1, 0);\n        break;\n      case 'ArrowRight':\n        this.moveHighlightBy(1, 0);\n        break;\n      case 'Enter':\n        // Select the highlighted colour.\n        highlighted = this.getHighlighted();\n        if (highlighted) {\n          const colour = highlighted.getAttribute('data-colour');\n          if (colour !== null) {\n            this.setValue(colour);\n          }\n        }\n        dropDownDiv.hideWithoutAnimation();\n        break;\n      default:\n        handled = false;\n    }\n    if (handled) {\n      e.stopPropagation();\n    }\n  }\n\n  /**\n   * Move the currently highlighted position by dx and dy.\n   *\n   * @param dx Change of x.\n   * @param dy Change of y.\n   */\n  private moveHighlightBy(dx: number, dy: number) {\n    if (!this.highlightedIndex) {\n      return;\n    }\n\n    const colours = this.colours || FieldColour.COLOURS;\n    const columns = this.columns || FieldColour.COLUMNS;\n\n    // Get the current x and y coordinates.\n    let x = this.highlightedIndex % columns;\n    let y = Math.floor(this.highlightedIndex / columns);\n\n    // Add the offset.\n    x += dx;\n    y += dy;\n\n    if (dx < 0) {\n      // Move left one grid cell, even in RTL.\n      // Loop back to the end of the previous row if we have room.\n      if (x < 0 && y > 0) {\n        x = columns - 1;\n        y--;\n      } else if (x < 0) {\n        x = 0;\n      }\n    } else if (dx > 0) {\n      // Move right one grid cell, even in RTL.\n      // Loop to the start of the next row, if there's room.\n      if (x > columns - 1 && y < Math.floor(colours.length / columns) - 1) {\n        x = 0;\n        y++;\n      } else if (x > columns - 1) {\n        x--;\n      }\n    } else if (dy < 0) {\n      // Move up one grid cell, stop at the top.\n      if (y < 0) {\n        y = 0;\n      }\n    } else if (dy > 0) {\n      // Move down one grid cell, stop at the bottom.\n      if (y > Math.floor(colours.length / columns) - 1) {\n        y = Math.floor(colours.length / columns) - 1;\n      }\n    }\n\n    // Move the highlight to the new coordinates.\n    const cell = this.picker!.childNodes[y].childNodes[x] as Element;\n    const index = y * columns + x;\n    this.setHighlightedCell(cell, index);\n  }\n\n  /**\n   * Handle a mouse move event. Highlight the hovered colour.\n   *\n   * @param e Mouse event.\n   */\n  private onMouseMove(e: PointerEvent) {\n    const cell = e.target as Element;\n    const index = cell && Number(cell.getAttribute('data-index'));\n    if (index !== null && index !== this.highlightedIndex) {\n      this.setHighlightedCell(cell, index);\n    }\n  }\n\n  /** Handle a mouse enter event. Focus the picker. */\n  private onMouseEnter() {\n    this.picker?.focus({preventScroll: true});\n  }\n\n  /**\n   * Handle a mouse leave event. Blur the picker and unhighlight\n   * the currently highlighted colour.\n   */\n  private onMouseLeave() {\n    this.picker?.blur();\n    const highlighted = this.getHighlighted();\n    if (highlighted) {\n      dom.removeClass(highlighted, 'blocklyColourHighlighted');\n    }\n  }\n\n  /**\n   * Returns the currently highlighted item (if any).\n   *\n   * @returns Highlighted item (null if none).\n   */\n  private getHighlighted(): HTMLElement | null {\n    if (!this.highlightedIndex) {\n      return null;\n    }\n\n    const columns = this.columns || FieldColour.COLUMNS;\n    const x = this.highlightedIndex % columns;\n    const y = Math.floor(this.highlightedIndex / columns);\n    const row = this.picker!.childNodes[y];\n    if (!row) {\n      return null;\n    }\n    return row.childNodes[x] as HTMLElement;\n  }\n\n  /**\n   * Update the currently highlighted cell.\n   *\n   * @param cell The new cell to highlight.\n   * @param index The index of the new cell.\n   */\n  private setHighlightedCell(cell: Element, index: number) {\n    // Unhighlight the current item.\n    const highlighted = this.getHighlighted();\n    if (highlighted) {\n      dom.removeClass(highlighted, 'blocklyColourHighlighted');\n    }\n    // Highlight new item.\n    dom.addClass(cell, 'blocklyColourHighlighted');\n    // Set new highlighted index.\n    this.highlightedIndex = index;\n\n    // Update accessibility roles.\n    const cellId = cell.getAttribute('id');\n    if (cellId && this.picker) {\n      aria.setState(this.picker, aria.State.ACTIVEDESCENDANT, cellId);\n    }\n  }\n\n  /** Create a colour picker dropdown editor. */\n  private dropdownCreate() {\n    const columns = this.columns || FieldColour.COLUMNS;\n    const colours = this.colours || FieldColour.COLOURS;\n    const titles = this.titles || FieldColour.TITLES;\n    const selectedColour = this.getValue();\n    // Create the palette.\n    const table = document.createElement('table');\n    table.className = 'blocklyColourTable';\n    table.tabIndex = 0;\n    table.dir = 'ltr';\n    aria.setRole(table, aria.Role.GRID);\n    aria.setState(table, aria.State.EXPANDED, true);\n    aria.setState(\n      table,\n      aria.State.ROWCOUNT,\n      Math.floor(colours.length / columns),\n    );\n    aria.setState(table, aria.State.COLCOUNT, columns);\n    let row: Element;\n    for (let i = 0; i < colours.length; i++) {\n      if (i % columns === 0) {\n        row = document.createElement('tr');\n        aria.setRole(row, aria.Role.ROW);\n        table.appendChild(row);\n      }\n      const cell = document.createElement('td');\n      row!.appendChild(cell);\n      // This becomes the value, if clicked.\n      cell.setAttribute('data-colour', colours[i]);\n      cell.title = titles[i] || colours[i];\n      cell.id = idGenerator.getNextUniqueId();\n      cell.setAttribute('data-index', `${i}`);\n      aria.setRole(cell, aria.Role.GRIDCELL);\n      aria.setState(cell, aria.State.LABEL, colours[i]);\n      aria.setState(cell, aria.State.SELECTED, colours[i] === selectedColour);\n      cell.style.backgroundColor = colours[i];\n      if (colours[i] === selectedColour) {\n        cell.className = 'blocklyColourSelected';\n        this.highlightedIndex = i;\n      }\n    }\n\n    // Configure event handler on the table to listen for any event in a cell.\n    this.boundEvents.push(\n      browserEvents.conditionalBind(\n        table,\n        'pointerdown',\n        this,\n        this.onClick,\n        true,\n      ),\n    );\n    this.boundEvents.push(\n      browserEvents.conditionalBind(\n        table,\n        'pointermove',\n        this,\n        this.onMouseMove,\n        true,\n      ),\n    );\n    this.boundEvents.push(\n      browserEvents.conditionalBind(\n        table,\n        'pointerenter',\n        this,\n        this.onMouseEnter,\n        true,\n      ),\n    );\n    this.boundEvents.push(\n      browserEvents.conditionalBind(\n        table,\n        'pointerleave',\n        this,\n        this.onMouseLeave,\n        true,\n      ),\n    );\n    this.boundEvents.push(\n      browserEvents.conditionalBind(\n        table,\n        'keydown',\n        this,\n        this.onKeyDown,\n        false,\n      ),\n    );\n\n    this.picker = table;\n  }\n\n  /** Disposes of events and DOM-references belonging to the colour editor. */\n  private dropdownDispose() {\n    for (const event of this.boundEvents) {\n      browserEvents.unbind(event);\n    }\n    this.boundEvents.length = 0;\n    this.picker = null;\n    this.highlightedIndex = null;\n  }\n\n  /**\n   * Construct a FieldColour from a JSON arg object.\n   *\n   * @param options A JSON object with options (colour).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static fromJson(options: FieldColourFromJsonConfig): FieldColour {\n    // `this` might be a subclass of FieldColour if that class doesn't override\n    // the static fromJson method.\n    return new this(options.colour, undefined, options);\n  }\n}\n\n/** The default value for this field. */\nFieldColour.prototype.DEFAULT_VALUE = FieldColour.COLOURS[0];\n\nfieldRegistry.register('field_colour', FieldColour);\n\n/**\n * CSS for colour picker.\n */\nCss.register(`\n.blocklyColourTable {\n  border-collapse: collapse;\n  display: block;\n  outline: none;\n  padding: 1px;\n}\n\n.blocklyColourTable>tr>td {\n  border: 0.5px solid #888;\n  box-sizing: border-box;\n  cursor: pointer;\n  display: inline-block;\n  height: 20px;\n  padding: 0;\n  width: 20px;\n}\n\n.blocklyColourTable>tr>td.blocklyColourHighlighted {\n  border-color: #eee;\n  box-shadow: 2px 2px 7px 2px rgba(0, 0, 0, 0.3);\n  position: relative;\n}\n\n.blocklyColourSelected, .blocklyColourSelected:hover {\n  border-color: #eee !important;\n  outline: 1px solid #333;\n  position: relative;\n}\n`);\n\n/**\n * Config options for the colour field.\n */\nexport interface FieldColourConfig extends FieldConfig {\n  colourOptions?: string[];\n  colourTitles?: string[];\n  columns?: number;\n}\n\n/**\n * fromJson config options for the colour field.\n */\nexport interface FieldColourFromJsonConfig extends FieldColourConfig {\n  colour?: string;\n}\n\n/**\n * A function that is called to validate changes to the field's value before\n * they are set.\n *\n * @see {@link https://developers.google.com/blockly/guides/create-custom-blocks/fields/validators#return_values}\n * @param newValue The value to be validated.\n * @returns One of three instructions for setting the new value: `T`, `null`,\n * or `undefined`.\n *\n * - `T` to set this function's returned value instead of `newValue`.\n *\n * - `null` to invoke `doValueInvalid_` and not set a value.\n *\n * - `undefined` to set `newValue` as is.\n */\nexport type FieldColourValidator = FieldValidator<string>;\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Non-editable, serializable text field. Behaves like a\n *    normal label but is serialized to XML. It may only be\n *    edited programmatically.\n *\n * @class\n */\n// Former goog.module ID: Blockly.FieldLabelSerializable\n\nimport {\n  FieldLabel,\n  FieldLabelConfig,\n  FieldLabelFromJsonConfig,\n} from './field_label.js';\nimport * as fieldRegistry from './field_registry.js';\nimport * as parsing from './utils/parsing.js';\n\n/**\n * Class for a non-editable, serializable text field.\n */\nexport class FieldLabelSerializable extends FieldLabel {\n  /**\n   * Editable fields usually show some sort of UI indicating they are\n   * editable. This field should not.\n   */\n  override EDITABLE = false;\n\n  /**\n   * Serializable fields are saved by the XML renderer, non-serializable\n   * fields are not.  This field should be serialized, but only edited\n   * programmatically.\n   */\n  override SERIALIZABLE = true;\n\n  /**\n   * @param value The initial value of the field. Should cast to a string.\n   *     Defaults to an empty string if null or undefined.\n   * @param textClass Optional CSS class for the field's text.\n   * @param config A map of options used to configure the field.\n   *    See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/label-serializable#creation}\n   * for a list of properties this parameter supports.\n   */\n  constructor(value?: string, textClass?: string, config?: FieldLabelConfig) {\n    super(String(value ?? ''), textClass, config);\n  }\n\n  /**\n   * Construct a FieldLabelSerializable from a JSON arg object,\n   * dereferencing any string table references.\n   *\n   * @param options A JSON object with options (text, and class).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static override fromJson(\n    options: FieldLabelFromJsonConfig,\n  ): FieldLabelSerializable {\n    const text = parsing.replaceMessageReferences(options.text);\n    // `this` might be a subclass of FieldLabelSerializable if that class\n    // doesn't override the static fromJson method.\n    return new this(text, undefined, options);\n  }\n}\n\nfieldRegistry.register('field_label_serializable', FieldLabelSerializable);\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Text Area field.\n *\n * @class\n */\n// Former goog.module ID: Blockly.FieldMultilineInput\n\nimport * as Css from './css.js';\nimport {Field, UnattachedFieldError} from './field.js';\nimport * as fieldRegistry from './field_registry.js';\nimport {\n  FieldTextInput,\n  FieldTextInputConfig,\n  FieldTextInputValidator,\n} from './field_textinput.js';\nimport * as aria from './utils/aria.js';\nimport * as dom from './utils/dom.js';\nimport * as parsing from './utils/parsing.js';\nimport {Svg} from './utils/svg.js';\nimport * as userAgent from './utils/useragent.js';\nimport * as WidgetDiv from './widgetdiv.js';\n\n/**\n * Class for an editable text area field.\n */\nexport class FieldMultilineInput extends FieldTextInput {\n  /**\n   * The SVG group element that will contain a text element for each text row\n   *     when initialized.\n   */\n  textGroup: SVGGElement | null = null;\n\n  /**\n   * Defines the maximum number of lines of field.\n   * If exceeded, scrolling functionality is enabled.\n   */\n  protected maxLines_ = Infinity;\n\n  /** Whether Y overflow is currently occurring. */\n  protected isOverflowedY_ = false;\n\n  /**\n   * @param value The initial content of the field. Should cast to a string.\n   *     Defaults to an empty string if null or undefined. Also accepts\n   *     Field.SKIP_SETUP if you wish to skip setup (only used by subclasses\n   *     that want to handle configuration and setting the field value after\n   *     their own constructors have run).\n   * @param validator An optional function that is called to validate any\n   *     constraints on what the user entered.  Takes the new text as an\n   *     argument and returns either the accepted text, a replacement text, or\n   *     null to abort the change.\n   * @param config A map of options used to configure the field.\n   *     See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/multiline-text-input#creation}\n   * for a list of properties this parameter supports.\n   */\n  constructor(\n    value?: string | typeof Field.SKIP_SETUP,\n    validator?: FieldMultilineInputValidator,\n    config?: FieldMultilineInputConfig,\n  ) {\n    super(Field.SKIP_SETUP);\n\n    if (value === Field.SKIP_SETUP) return;\n    if (config) {\n      this.configure_(config);\n    }\n    this.setValue(value);\n    if (validator) {\n      this.setValidator(validator);\n    }\n  }\n\n  /**\n   * Configure the field based on the given map of options.\n   *\n   * @param config A map of options to configure the field based on.\n   */\n  protected override configure_(config: FieldMultilineInputConfig) {\n    super.configure_(config);\n    if (config.maxLines) this.setMaxLines(config.maxLines);\n  }\n\n  /**\n   * Serializes this field's value to XML. Should only be called by Blockly.Xml.\n   *\n   * @param fieldElement The element to populate with info about the field's\n   *     state.\n   * @returns The element containing info about the field's state.\n   * @internal\n   */\n  override toXml(fieldElement: Element): Element {\n    // Replace '\\n' characters with HTML-escaped equivalent '&#10'. This is\n    // needed so the plain-text representation of the XML produced by\n    // `Blockly.Xml.domToText` will appear on a single line (this is a\n    // limitation of the plain-text format).\n    fieldElement.textContent = (this.getValue() as string).replace(\n      /\\n/g,\n      '&#10;',\n    );\n    return fieldElement;\n  }\n\n  /**\n   * Sets the field's value based on the given XML element. Should only be\n   * called by Blockly.Xml.\n   *\n   * @param fieldElement The element containing info about the field's state.\n   * @internal\n   */\n  override fromXml(fieldElement: Element) {\n    this.setValue(fieldElement.textContent!.replace(/&#10;/g, '\\n'));\n  }\n\n  /**\n   * Saves this field's value.\n   * This function only exists for subclasses of FieldMultilineInput which\n   * predate the load/saveState API and only define to/fromXml.\n   *\n   * @returns The state of this field.\n   * @internal\n   */\n  override saveState(): AnyDuringMigration {\n    const legacyState = this.saveLegacyState(FieldMultilineInput);\n    if (legacyState !== null) {\n      return legacyState;\n    }\n    return this.getValue();\n  }\n\n  /**\n   * Sets the field's value based on the given state.\n   * This function only exists for subclasses of FieldMultilineInput which\n   * predate the load/saveState API and only define to/fromXml.\n   *\n   * @param state The state of the variable to assign to this variable field.\n   * @internal\n   */\n  override loadState(state: AnyDuringMigration) {\n    if (this.loadLegacyState(Field, state)) {\n      return;\n    }\n    this.setValue(state);\n  }\n\n  /**\n   * Create the block UI for this field.\n   */\n  override initView() {\n    this.createBorderRect_();\n    this.textGroup = dom.createSvgElement(\n      Svg.G,\n      {\n        'class': 'blocklyEditableText',\n      },\n      this.fieldGroup_,\n    );\n  }\n\n  /**\n   * Get the text from this field as displayed on screen.  May differ from\n   * getText due to ellipsis, and other formatting.\n   *\n   * @returns Currently displayed text.\n   */\n  protected override getDisplayText_(): string {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    let textLines = this.getText();\n    if (!textLines) {\n      // Prevent the field from disappearing if empty.\n      return Field.NBSP;\n    }\n    const lines = textLines.split('\\n');\n    textLines = '';\n    const displayLinesNumber = this.isOverflowedY_\n      ? this.maxLines_\n      : lines.length;\n    for (let i = 0; i < displayLinesNumber; i++) {\n      let text = lines[i];\n      if (text.length > this.maxDisplayLength) {\n        // Truncate displayed string and add an ellipsis ('...').\n        text = text.substring(0, this.maxDisplayLength - 4) + '...';\n      } else if (this.isOverflowedY_ && i === displayLinesNumber - 1) {\n        text = text.substring(0, text.length - 3) + '...';\n      }\n      // Replace whitespace with non-breaking spaces so the text doesn't\n      // collapse.\n      text = text.replace(/\\s/g, Field.NBSP);\n\n      textLines += text;\n      if (i !== displayLinesNumber - 1) {\n        textLines += '\\n';\n      }\n    }\n    if (block.RTL) {\n      // The SVG is LTR, force value to be RTL.\n      textLines += '\\u200F';\n    }\n    return textLines;\n  }\n\n  /**\n   * Called by setValue if the text input is valid. Updates the value of the\n   * field, and updates the text of the field if it is not currently being\n   * edited (i.e. handled by the htmlInput_). Is being redefined here to update\n   * overflow state of the field.\n   *\n   * @param newValue The value to be saved. The default validator guarantees\n   *     that this is a string.\n   */\n  protected override doValueUpdate_(newValue: string) {\n    super.doValueUpdate_(newValue);\n    if (this.value_ !== null) {\n      this.isOverflowedY_ = this.value_.split('\\n').length > this.maxLines_;\n    }\n  }\n\n  /** Updates the text of the textElement. */\n  protected override render_() {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    // Remove all text group children.\n    let currentChild;\n    const textGroup = this.textGroup;\n    while ((currentChild = textGroup!.firstChild)) {\n      textGroup!.removeChild(currentChild);\n    }\n\n    // Add in text elements into the group.\n    const lines = this.getDisplayText_().split('\\n');\n    let y = 0;\n    for (let i = 0; i < lines.length; i++) {\n      const lineHeight =\n        this.getConstants()!.FIELD_TEXT_HEIGHT +\n        this.getConstants()!.FIELD_BORDER_RECT_Y_PADDING;\n      const span = dom.createSvgElement(\n        Svg.TEXT,\n        {\n          'class': 'blocklyText blocklyMultilineText',\n          'x': this.getConstants()!.FIELD_BORDER_RECT_X_PADDING,\n          'y': y + this.getConstants()!.FIELD_BORDER_RECT_Y_PADDING,\n          'dy': this.getConstants()!.FIELD_TEXT_BASELINE,\n        },\n        textGroup,\n      );\n      span.appendChild(document.createTextNode(lines[i]));\n      y += lineHeight;\n    }\n\n    if (this.isBeingEdited_) {\n      const htmlInput = this.htmlInput_ as HTMLElement;\n      if (this.isOverflowedY_) {\n        dom.addClass(htmlInput, 'blocklyHtmlTextAreaInputOverflowedY');\n      } else {\n        dom.removeClass(htmlInput, 'blocklyHtmlTextAreaInputOverflowedY');\n      }\n    }\n\n    this.updateSize_();\n\n    if (this.isBeingEdited_) {\n      if (block.RTL) {\n        // in RTL, we need to let the browser reflow before resizing\n        // in order to get the correct bounding box of the borderRect\n        // avoiding issue #2777.\n        setTimeout(this.resizeEditor_.bind(this), 0);\n      } else {\n        this.resizeEditor_();\n      }\n      const htmlInput = this.htmlInput_ as HTMLElement;\n      if (!this.isTextValid_) {\n        dom.addClass(htmlInput, 'blocklyInvalidInput');\n        aria.setState(htmlInput, aria.State.INVALID, true);\n      } else {\n        dom.removeClass(htmlInput, 'blocklyInvalidInput');\n        aria.setState(htmlInput, aria.State.INVALID, false);\n      }\n    }\n  }\n\n  /** Updates the size of the field based on the text. */\n  protected override updateSize_() {\n    const nodes = (this.textGroup as SVGElement).childNodes;\n    const fontSize = this.getConstants()!.FIELD_TEXT_FONTSIZE;\n    const fontWeight = this.getConstants()!.FIELD_TEXT_FONTWEIGHT;\n    const fontFamily = this.getConstants()!.FIELD_TEXT_FONTFAMILY;\n    let totalWidth = 0;\n    let totalHeight = 0;\n    for (let i = 0; i < nodes.length; i++) {\n      const tspan = nodes[i] as SVGTextElement;\n      const textWidth = dom.getFastTextWidth(\n        tspan,\n        fontSize,\n        fontWeight,\n        fontFamily,\n      );\n      if (textWidth > totalWidth) {\n        totalWidth = textWidth;\n      }\n      totalHeight +=\n        this.getConstants()!.FIELD_TEXT_HEIGHT +\n        (i > 0 ? this.getConstants()!.FIELD_BORDER_RECT_Y_PADDING : 0);\n    }\n    if (this.isBeingEdited_) {\n      // The default width is based on the longest line in the display text,\n      // but when it's being edited, width should be calculated based on the\n      // absolute longest line, even if it would be truncated after editing.\n      // Otherwise we would get wrong editor width when there are more\n      // lines than this.maxLines_.\n      const actualEditorLines = String(this.value_).split('\\n');\n      const dummyTextElement = dom.createSvgElement(Svg.TEXT, {\n        'class': 'blocklyText blocklyMultilineText',\n      });\n\n      for (let i = 0; i < actualEditorLines.length; i++) {\n        if (actualEditorLines[i].length > this.maxDisplayLength) {\n          actualEditorLines[i] = actualEditorLines[i].substring(\n            0,\n            this.maxDisplayLength,\n          );\n        }\n        dummyTextElement.textContent = actualEditorLines[i];\n        const lineWidth = dom.getFastTextWidth(\n          dummyTextElement,\n          fontSize,\n          fontWeight,\n          fontFamily,\n        );\n        if (lineWidth > totalWidth) {\n          totalWidth = lineWidth;\n        }\n      }\n\n      const scrollbarWidth =\n        this.htmlInput_!.offsetWidth - this.htmlInput_!.clientWidth;\n      totalWidth += scrollbarWidth;\n    }\n    if (this.borderRect_) {\n      totalHeight += this.getConstants()!.FIELD_BORDER_RECT_Y_PADDING * 2;\n      totalWidth += this.getConstants()!.FIELD_BORDER_RECT_X_PADDING * 2;\n      this.borderRect_.setAttribute('width', `${totalWidth}`);\n      this.borderRect_.setAttribute('height', `${totalHeight}`);\n    }\n    this.size_.width = totalWidth;\n    this.size_.height = totalHeight;\n\n    this.positionBorderRect_();\n  }\n\n  /**\n   * Show the inline free-text editor on top of the text.\n   * Overrides the default behaviour to force rerender in order to\n   * correct block size, based on editor text.\n   *\n   * @param e Optional mouse event that triggered the field to open, or\n   *     undefined if triggered programmatically.\n   * @param quietInput True if editor should be created without focus.\n   *     Defaults to false.\n   */\n  override showEditor_(e?: Event, quietInput?: boolean) {\n    super.showEditor_(e, quietInput);\n    this.forceRerender();\n  }\n\n  /**\n   * Create the text input editor widget.\n   *\n   * @returns The newly created text input editor.\n   */\n  protected override widgetCreate_(): HTMLTextAreaElement {\n    const div = WidgetDiv.getDiv();\n    const scale = this.workspace_!.getScale();\n\n    const htmlInput = document.createElement('textarea');\n    htmlInput.className = 'blocklyHtmlInput blocklyHtmlTextAreaInput';\n    htmlInput.setAttribute('spellcheck', String(this.spellcheck_));\n    const fontSize = this.getConstants()!.FIELD_TEXT_FONTSIZE * scale + 'pt';\n    div!.style.fontSize = fontSize;\n    htmlInput.style.fontSize = fontSize;\n    const borderRadius = FieldTextInput.BORDERRADIUS * scale + 'px';\n    htmlInput.style.borderRadius = borderRadius;\n    const paddingX = this.getConstants()!.FIELD_BORDER_RECT_X_PADDING * scale;\n    const paddingY =\n      (this.getConstants()!.FIELD_BORDER_RECT_Y_PADDING * scale) / 2;\n    htmlInput.style.padding =\n      paddingY + 'px ' + paddingX + 'px ' + paddingY + 'px ' + paddingX + 'px';\n    const lineHeight =\n      this.getConstants()!.FIELD_TEXT_HEIGHT +\n      this.getConstants()!.FIELD_BORDER_RECT_Y_PADDING;\n    htmlInput.style.lineHeight = lineHeight * scale + 'px';\n\n    div!.appendChild(htmlInput);\n\n    htmlInput.value = htmlInput.defaultValue = this.getEditorText_(this.value_);\n    htmlInput.setAttribute('data-untyped-default-value', String(this.value_));\n    htmlInput.setAttribute('data-old-value', '');\n    if (userAgent.GECKO) {\n      // In FF, ensure the browser reflows before resizing to avoid issue #2777.\n      setTimeout(this.resizeEditor_.bind(this), 0);\n    } else {\n      this.resizeEditor_();\n    }\n\n    this.bindInputEvents_(htmlInput);\n\n    return htmlInput;\n  }\n\n  /**\n   * Sets the maxLines config for this field.\n   *\n   * @param maxLines Defines the maximum number of lines allowed, before\n   *     scrolling functionality is enabled.\n   */\n  setMaxLines(maxLines: number) {\n    if (\n      typeof maxLines === 'number' &&\n      maxLines > 0 &&\n      maxLines !== this.maxLines_\n    ) {\n      this.maxLines_ = maxLines;\n      this.forceRerender();\n    }\n  }\n\n  /**\n   * Returns the maxLines config of this field.\n   *\n   * @returns The maxLines config value.\n   */\n  getMaxLines(): number {\n    return this.maxLines_;\n  }\n\n  /**\n   * Handle key down to the editor. Override the text input definition of this\n   * so as to not close the editor when enter is typed in.\n   *\n   * @param e Keyboard event.\n   */\n  protected override onHtmlInputKeyDown_(e: KeyboardEvent) {\n    if (e.key !== 'Enter') {\n      super.onHtmlInputKeyDown_(e);\n    }\n  }\n\n  /**\n   * Construct a FieldMultilineInput from a JSON arg object,\n   * dereferencing any string table references.\n   *\n   * @param options A JSON object with options (text, and spellcheck).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static override fromJson(\n    options: FieldMultilineInputFromJsonConfig,\n  ): FieldMultilineInput {\n    const text = parsing.replaceMessageReferences(options.text);\n    // `this` might be a subclass of FieldMultilineInput if that class doesn't\n    // override the static fromJson method.\n    return new this(text, undefined, options);\n  }\n}\n\nfieldRegistry.register('field_multilinetext', FieldMultilineInput);\n\n/**\n * CSS for multiline field.\n */\nCss.register(`\n.blocklyHtmlTextAreaInput {\n  font-family: monospace;\n  resize: none;\n  overflow: hidden;\n  height: 100%;\n  text-align: left;\n}\n\n.blocklyHtmlTextAreaInputOverflowedY {\n  overflow-y: scroll;\n}\n`);\n\n/**\n * Config options for the multiline input field.\n */\nexport interface FieldMultilineInputConfig extends FieldTextInputConfig {\n  maxLines?: number;\n}\n\n/**\n * fromJson config options for the multiline input field.\n */\nexport interface FieldMultilineInputFromJsonConfig\n  extends FieldMultilineInputConfig {\n  text?: string;\n}\n\n/**\n * A function that is called to validate changes to the field's value before\n * they are set.\n *\n * @see {@link https://developers.google.com/blockly/guides/create-custom-blocks/fields/validators#return_values}\n * @param newValue The value to be validated.\n * @returns One of three instructions for setting the new value: `T`, `null`,\n * or `undefined`.\n *\n * - `T` to set this function's returned value instead of `newValue`.\n *\n * - `null` to invoke `doValueInvalid_` and not set a value.\n *\n * - `undefined` to set `newValue` as is.\n */\nexport type FieldMultilineInputValidator = FieldTextInputValidator;\n","/**\n * @license\n * Copyright 2016 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Number input field\n *\n * @class\n */\n// Former goog.module ID: Blockly.FieldNumber\n\nimport {Field} from './field.js';\nimport * as fieldRegistry from './field_registry.js';\nimport {\n  FieldInput,\n  FieldInputConfig,\n  FieldInputValidator,\n} from './field_input.js';\nimport * as aria from './utils/aria.js';\n\n/**\n * Class for an editable number field.\n */\nexport class FieldNumber extends FieldInput<number> {\n  /** The minimum value this number field can contain. */\n  protected min_ = -Infinity;\n\n  /** The maximum value this number field can contain. */\n  protected max_ = Infinity;\n\n  /** The multiple to which this fields value is rounded. */\n  protected precision_ = 0;\n\n  /**\n   * The number of decimal places to allow, or null to allow any number of\n   * decimal digits.\n   */\n  private decimalPlaces: number | null = null;\n\n  /** Don't spellcheck numbers.  Our validator does a better job. */\n  protected override spellcheck_ = false;\n\n  /**\n   * @param value The initial value of the field. Should cast to a number.\n   *     Defaults to 0. Also accepts Field.SKIP_SETUP if you wish to skip setup\n   *     (only used by subclasses that want to handle configuration and setting\n   *     the field value after their own constructors have run).\n   * @param min Minimum value. Will only be used if config is not\n   *     provided.\n   * @param max Maximum value. Will only be used if config is not\n   *     provided.\n   * @param precision Precision for value. Will only be used if config\n   *     is not provided.\n   * @param validator A function that is called to validate changes to the\n   *     field's value. Takes in a number & returns a validated number, or null\n   *     to abort the change.\n   * @param config A map of options used to configure the field.\n   *     See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/number#creation}\n   * for a list of properties this parameter supports.\n   */\n  constructor(\n    value?: string | number | typeof Field.SKIP_SETUP,\n    min?: string | number | null,\n    max?: string | number | null,\n    precision?: string | number | null,\n    validator?: FieldNumberValidator | null,\n    config?: FieldNumberConfig,\n  ) {\n    // Pass SENTINEL so that we can define properties before value validation.\n    super(Field.SKIP_SETUP);\n\n    if (value === Field.SKIP_SETUP) return;\n    if (config) {\n      this.configure_(config);\n    } else {\n      this.setConstraints(min, max, precision);\n    }\n    this.setValue(value);\n    if (validator) {\n      this.setValidator(validator);\n    }\n  }\n\n  /**\n   * Configure the field based on the given map of options.\n   *\n   * @param config A map of options to configure the field based on.\n   */\n  protected override configure_(config: FieldNumberConfig) {\n    super.configure_(config);\n    this.setMinInternal(config.min);\n    this.setMaxInternal(config.max);\n    this.setPrecisionInternal(config.precision);\n  }\n\n  /**\n   * Set the maximum, minimum and precision constraints on this field.\n   * Any of these properties may be undefined or NaN to be disabled.\n   * Setting precision (usually a power of 10) enforces a minimum step between\n   * values. That is, the user's value will rounded to the closest multiple of\n   * precision. The least significant digit place is inferred from the\n   * precision. Integers values can be enforces by choosing an integer\n   * precision.\n   *\n   * @param min Minimum value.\n   * @param max Maximum value.\n   * @param precision Precision for value.\n   */\n  setConstraints(\n    min: number | string | undefined | null,\n    max: number | string | undefined | null,\n    precision: number | string | undefined | null,\n  ) {\n    this.setMinInternal(min);\n    this.setMaxInternal(max);\n    this.setPrecisionInternal(precision);\n    this.setValue(this.getValue());\n  }\n\n  /**\n   * Sets the minimum value this field can contain. Updates the value to\n   * reflect.\n   *\n   * @param min Minimum value.\n   */\n  setMin(min: number | string | undefined | null) {\n    this.setMinInternal(min);\n    this.setValue(this.getValue());\n  }\n\n  /**\n   * Sets the minimum value this field can contain. Called internally to avoid\n   * value updates.\n   *\n   * @param min Minimum value.\n   */\n  private setMinInternal(min: number | string | undefined | null) {\n    if (min == null) {\n      this.min_ = -Infinity;\n    } else {\n      min = Number(min);\n      if (!isNaN(min)) {\n        this.min_ = min;\n      }\n    }\n  }\n\n  /**\n   * Returns the current minimum value this field can contain. Default is\n   * -Infinity.\n   *\n   * @returns The current minimum value this field can contain.\n   */\n  getMin(): number {\n    return this.min_;\n  }\n\n  /**\n   * Sets the maximum value this field can contain. Updates the value to\n   * reflect.\n   *\n   * @param max Maximum value.\n   */\n  setMax(max: number | string | undefined | null) {\n    this.setMaxInternal(max);\n    this.setValue(this.getValue());\n  }\n\n  /**\n   * Sets the maximum value this field can contain. Called internally to avoid\n   * value updates.\n   *\n   * @param max Maximum value.\n   */\n  private setMaxInternal(max: number | string | undefined | null) {\n    if (max == null) {\n      this.max_ = Infinity;\n    } else {\n      max = Number(max);\n      if (!isNaN(max)) {\n        this.max_ = max;\n      }\n    }\n  }\n\n  /**\n   * Returns the current maximum value this field can contain. Default is\n   * Infinity.\n   *\n   * @returns The current maximum value this field can contain.\n   */\n  getMax(): number {\n    return this.max_;\n  }\n\n  /**\n   * Sets the precision of this field's value, i.e. the number to which the\n   * value is rounded. Updates the field to reflect.\n   *\n   * @param precision The number to which the field's value is rounded.\n   */\n  setPrecision(precision: number | string | undefined | null) {\n    this.setPrecisionInternal(precision);\n    this.setValue(this.getValue());\n  }\n\n  /**\n   * Sets the precision of this field's value. Called internally to avoid\n   * value updates.\n   *\n   * @param precision The number to which the field's value is rounded.\n   */\n  private setPrecisionInternal(precision: number | string | undefined | null) {\n    this.precision_ = Number(precision) || 0;\n    let precisionString = String(this.precision_);\n    if (precisionString.indexOf('e') !== -1) {\n      // String() is fast.  But it turns .0000001 into '1e-7'.\n      // Use the much slower toLocaleString to access all the digits.\n      precisionString = this.precision_.toLocaleString('en-US', {\n        maximumFractionDigits: 20,\n      });\n    }\n    const decimalIndex = precisionString.indexOf('.');\n    if (decimalIndex === -1) {\n      // If the precision is 0 (float) allow any number of decimals,\n      // otherwise allow none.\n      this.decimalPlaces = precision ? 0 : null;\n    } else {\n      this.decimalPlaces = precisionString.length - decimalIndex - 1;\n    }\n  }\n\n  /**\n   * Returns the current precision of this field. The precision being the\n   * number to which the field's value is rounded. A precision of 0 means that\n   * the value is not rounded.\n   *\n   * @returns The number to which this field's value is rounded.\n   */\n  getPrecision(): number {\n    return this.precision_;\n  }\n\n  /**\n   * Ensure that the input value is a valid number (must fulfill the\n   * constraints placed on the field).\n   *\n   * @param newValue The input value.\n   * @returns A valid number, or null if invalid.\n   */\n  protected override doClassValidation_(\n    newValue?: AnyDuringMigration,\n  ): number | null {\n    if (newValue === null) {\n      return null;\n    }\n\n    // Clean up text.\n    newValue = `${newValue}`;\n    // TODO: Handle cases like 'ten', '1.203,14', etc.\n    // 'O' is sometimes mistaken for '0' by inexperienced users.\n    newValue = newValue.replace(/O/gi, '0');\n    // Strip out thousands separators.\n    newValue = newValue.replace(/,/g, '');\n    // Ignore case of 'Infinity'.\n    newValue = newValue.replace(/infinity/i, 'Infinity');\n\n    // Clean up number.\n    let n = Number(newValue || 0);\n    if (isNaN(n)) {\n      // Invalid number.\n      return null;\n    }\n    // Get the value in range.\n    n = Math.min(Math.max(n, this.min_), this.max_);\n    // Round to nearest multiple of precision.\n    if (this.precision_ && isFinite(n)) {\n      n = Math.round(n / this.precision_) * this.precision_;\n    }\n    // Clean up floating point errors.\n    if (this.decimalPlaces !== null) {\n      n = Number(n.toFixed(this.decimalPlaces));\n    }\n    return n;\n  }\n\n  /**\n   * Create the number input editor widget.\n   *\n   * @returns The newly created number input editor.\n   */\n  protected override widgetCreate_(): HTMLInputElement {\n    const htmlInput = super.widgetCreate_() as HTMLInputElement;\n\n    // Set the accessibility state\n    if (this.min_ > -Infinity) {\n      htmlInput.min = `${this.min_}`;\n      aria.setState(htmlInput, aria.State.VALUEMIN, this.min_);\n    }\n    if (this.max_ < Infinity) {\n      htmlInput.max = `${this.max_}`;\n      aria.setState(htmlInput, aria.State.VALUEMAX, this.max_);\n    }\n    return htmlInput;\n  }\n\n  /**\n   * Construct a FieldNumber from a JSON arg object.\n   *\n   * @param options A JSON object with options (value, min, max, and precision).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static fromJson(options: FieldNumberFromJsonConfig): FieldNumber {\n    // `this` might be a subclass of FieldNumber if that class doesn't override\n    // the static fromJson method.\n    return new this(\n      options.value,\n      undefined,\n      undefined,\n      undefined,\n      undefined,\n      options,\n    );\n  }\n}\n\nfieldRegistry.register('field_number', FieldNumber);\n\nFieldNumber.prototype.DEFAULT_VALUE = 0;\n\n/**\n * Config options for the number field.\n */\nexport interface FieldNumberConfig extends FieldInputConfig {\n  min?: number;\n  max?: number;\n  precision?: number;\n}\n\n/**\n * fromJson config options for the number field.\n */\nexport interface FieldNumberFromJsonConfig extends FieldNumberConfig {\n  value?: number;\n}\n\n/**\n * A function that is called to validate changes to the field's value before\n * they are set.\n *\n * @see {@link https://developers.google.com/blockly/guides/create-custom-blocks/fields/validators#return_values}\n * @param newValue The value to be validated.\n * @returns One of three instructions for setting the new value: `T`, `null`,\n * or `undefined`.\n *\n * - `T` to set this function's returned value instead of `newValue`.\n *\n * - `null` to invoke `doValueInvalid_` and not set a value.\n *\n * - `undefined` to set `newValue` as is.\n */\nexport type FieldNumberValidator = FieldInputValidator<number>;\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Variable input field.\n *\n * @class\n */\n// Former goog.module ID: Blockly.FieldVariable\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_change.js';\n\nimport type {Block} from './block.js';\nimport {Field, FieldConfig, UnattachedFieldError} from './field.js';\nimport {\n  FieldDropdown,\n  FieldDropdownValidator,\n  MenuGenerator,\n  MenuOption,\n} from './field_dropdown.js';\nimport * as fieldRegistry from './field_registry.js';\nimport * as internalConstants from './internal_constants.js';\nimport type {Menu} from './menu.js';\nimport type {MenuItem} from './menuitem.js';\nimport {Msg} from './msg.js';\nimport * as parsing from './utils/parsing.js';\nimport {Size} from './utils/size.js';\nimport {VariableModel} from './variable_model.js';\nimport * as Variables from './variables.js';\nimport * as Xml from './xml.js';\n\n/**\n * Class for a variable's dropdown field.\n */\nexport class FieldVariable extends FieldDropdown {\n  protected override menuGenerator_: MenuGenerator | undefined;\n  defaultVariableName: string;\n\n  /** The type of the default variable for this field. */\n  private defaultType = '';\n\n  /**\n   * All of the types of variables that will be available in this field's\n   * dropdown.\n   */\n  variableTypes: string[] | null = [];\n  protected override size_: Size;\n\n  /** The variable model associated with this field. */\n  private variable: VariableModel | null = null;\n\n  /**\n   * Serializable fields are saved by the serializer, non-serializable fields\n   * are not. Editable fields should also be serializable.\n   */\n  override SERIALIZABLE = true;\n\n  /**\n   * @param varName The default name for the variable.\n   *     If null, a unique variable name will be generated.\n   *     Also accepts Field.SKIP_SETUP if you wish to skip setup (only used by\n   * subclasses that want to handle configuration and setting the field value\n   * after their own constructors have run).\n   * @param validator A function that is called to validate changes to the\n   *     field's value. Takes in a variable ID  & returns a validated variable\n   *     ID, or null to abort the change.\n   * @param variableTypes A list of the types of variables to include in the\n   *     dropdown. Will only be used if config is not provided.\n   * @param defaultType The type of variable to create if this field's value\n   *     is not explicitly set.  Defaults to ''. Will only be used if config\n   *     is not provided.\n   * @param config A map of options used to configure the field.\n   *    See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/variable#creation}\n   * for a list of properties this parameter supports.\n   */\n  constructor(\n    varName: string | null | typeof Field.SKIP_SETUP,\n    validator?: FieldVariableValidator,\n    variableTypes?: string[],\n    defaultType?: string,\n    config?: FieldVariableConfig,\n  ) {\n    super(Field.SKIP_SETUP);\n\n    /**\n     * An array of options for a dropdown list,\n     * or a function which generates these options.\n     */\n    this.menuGenerator_ = FieldVariable.dropdownCreate as MenuGenerator;\n\n    /**\n     * The initial variable name passed to this field's constructor, or an\n     * empty string if a name wasn't provided. Used to create the initial\n     * variable.\n     */\n    this.defaultVariableName = typeof varName === 'string' ? varName : '';\n\n    /** The size of the area rendered by the field. */\n    this.size_ = new Size(0, 0);\n\n    if (varName === Field.SKIP_SETUP) return;\n\n    if (config) {\n      this.configure_(config);\n    } else {\n      this.setTypes(variableTypes, defaultType);\n    }\n    if (validator) {\n      this.setValidator(validator);\n    }\n  }\n\n  /**\n   * Configure the field based on the given map of options.\n   *\n   * @param config A map of options to configure the field based on.\n   */\n  protected override configure_(config: FieldVariableConfig) {\n    super.configure_(config);\n    this.setTypes(config.variableTypes, config.defaultType);\n  }\n\n  /**\n   * Initialize the model for this field if it has not already been initialized.\n   * If the value has not been set to a variable by the first render, we make up\n   * a variable rather than let the value be invalid.\n   */\n  override initModel() {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    if (this.variable) {\n      return; // Initialization already happened.\n    }\n    const variable = Variables.getOrCreateVariablePackage(\n      block.workspace,\n      null,\n      this.defaultVariableName,\n      this.defaultType,\n    );\n    // Don't call setValue because we don't want to cause a rerender.\n    this.doValueUpdate_(variable.getId());\n  }\n\n  override shouldAddBorderRect_() {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    return (\n      super.shouldAddBorderRect_() &&\n      (!this.getConstants()!.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW ||\n        block.type !== 'variables_get')\n    );\n  }\n\n  /**\n   * Initialize this field based on the given XML.\n   *\n   * @param fieldElement The element containing information about the variable\n   *     field's state.\n   */\n  override fromXml(fieldElement: Element) {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    const id = fieldElement.getAttribute('id');\n    const variableName = fieldElement.textContent;\n    // 'variabletype' should be lowercase, but until July 2019 it was sometimes\n    // recorded as 'variableType'.  Thus we need to check for both.\n    const variableType =\n      fieldElement.getAttribute('variabletype') ||\n      fieldElement.getAttribute('variableType') ||\n      '';\n\n    // AnyDuringMigration because:  Argument of type 'string | null' is not\n    // assignable to parameter of type 'string | undefined'.\n    const variable = Variables.getOrCreateVariablePackage(\n      block.workspace,\n      id,\n      variableName as AnyDuringMigration,\n      variableType,\n    );\n\n    // This should never happen :)\n    if (variableType !== null && variableType !== variable.type) {\n      throw Error(\n        \"Serialized variable type with id '\" +\n          variable.getId() +\n          \"' had type \" +\n          variable.type +\n          ', and ' +\n          'does not match variable field that references it: ' +\n          Xml.domToText(fieldElement) +\n          '.',\n      );\n    }\n\n    this.setValue(variable.getId());\n  }\n\n  /**\n   * Serialize this field to XML.\n   *\n   * @param fieldElement The element to populate with info about the field's\n   *     state.\n   * @returns The element containing info about the field's state.\n   */\n  override toXml(fieldElement: Element): Element {\n    // Make sure the variable is initialized.\n    this.initModel();\n\n    fieldElement.id = this.variable!.getId();\n    fieldElement.textContent = this.variable!.name;\n    if (this.variable!.type) {\n      fieldElement.setAttribute('variabletype', this.variable!.type);\n    }\n    return fieldElement;\n  }\n\n  /**\n   * Saves this field's value.\n   *\n   * @param doFullSerialization If true, the variable field will serialize the\n   *     full state of the field being referenced (ie ID, name, and type) rather\n   *     than just a reference to it (ie ID).\n   * @returns The state of the variable field.\n   * @internal\n   */\n  override saveState(doFullSerialization?: boolean): AnyDuringMigration {\n    const legacyState = this.saveLegacyState(FieldVariable);\n    if (legacyState !== null) {\n      return legacyState;\n    }\n    // Make sure the variable is initialized.\n    this.initModel();\n    const state = {'id': this.variable!.getId()};\n    if (doFullSerialization) {\n      (state as AnyDuringMigration)['name'] = this.variable!.name;\n      (state as AnyDuringMigration)['type'] = this.variable!.type;\n    }\n    return state;\n  }\n\n  /**\n   * Sets the field's value based on the given state.\n   *\n   * @param state The state of the variable to assign to this variable field.\n   * @internal\n   */\n  override loadState(state: AnyDuringMigration) {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    if (this.loadLegacyState(FieldVariable, state)) {\n      return;\n    }\n    // This is necessary so that blocks in the flyout can have custom var names.\n    const variable = Variables.getOrCreateVariablePackage(\n      block.workspace,\n      state['id'] || null,\n      state['name'],\n      state['type'] || '',\n    );\n    this.setValue(variable.getId());\n  }\n\n  /**\n   * Attach this field to a block.\n   *\n   * @param block The block containing this field.\n   */\n  override setSourceBlock(block: Block) {\n    if (block.isShadow()) {\n      throw Error('Variable fields are not allowed to exist on shadow blocks.');\n    }\n    super.setSourceBlock(block);\n  }\n\n  /**\n   * Get the variable's ID.\n   *\n   * @returns Current variable's ID.\n   */\n  override getValue(): string | null {\n    return this.variable ? this.variable.getId() : null;\n  }\n\n  /**\n   * Get the text from this field, which is the selected variable's name.\n   *\n   * @returns The selected variable's name, or the empty string if no variable\n   *     is selected.\n   */\n  override getText(): string {\n    return this.variable ? this.variable.name : '';\n  }\n\n  /**\n   * Get the variable model for the selected variable.\n   * Not guaranteed to be in the variable map on the workspace (e.g. if accessed\n   * after the variable has been deleted).\n   *\n   * @returns The selected variable, or null if none was selected.\n   * @internal\n   */\n  getVariable(): VariableModel | null {\n    return this.variable;\n  }\n\n  /**\n   * Gets the validation function for this field, or null if not set.\n   * Returns null if the variable is not set, because validators should not\n   * run on the initial setValue call, because the field won't be attached to\n   * a block and workspace at that point.\n   *\n   * @returns Validation function, or null.\n   */\n  override getValidator(): FieldVariableValidator | null {\n    // Validators shouldn't operate on the initial setValue call.\n    // Normally this is achieved by calling setValidator after setValue, but\n    // this is not a possibility with variable fields.\n    if (this.variable) {\n      return this.validator_;\n    }\n    return null;\n  }\n\n  /**\n   * Ensure that the ID belongs to a valid variable of an allowed type.\n   *\n   * @param newValue The ID of the new variable to set.\n   * @returns The validated ID, or null if invalid.\n   */\n  protected override doClassValidation_(\n    newValue?: AnyDuringMigration,\n  ): string | null {\n    if (newValue === null) {\n      return null;\n    }\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    const newId = newValue as string;\n    const variable = Variables.getVariable(block.workspace, newId);\n    if (!variable) {\n      console.warn(\n        \"Variable id doesn't point to a real variable! \" + 'ID was ' + newId,\n      );\n      return null;\n    }\n    // Type Checks.\n    const type = variable.type;\n    if (!this.typeIsAllowed(type)) {\n      console.warn(\"Variable type doesn't match this field!  Type was \" + type);\n      return null;\n    }\n    return newId;\n  }\n\n  /**\n   * Update the value of this variable field, as well as its variable and text.\n   *\n   * The variable ID should be valid at this point, but if a variable field\n   * validator returns a bad ID, this could break.\n   *\n   * @param newId The value to be saved.\n   */\n  protected override doValueUpdate_(newId: string) {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    this.variable = Variables.getVariable(block.workspace, newId as string);\n    super.doValueUpdate_(newId);\n  }\n\n  /**\n   * Check whether the given variable type is allowed on this field.\n   *\n   * @param type The type to check.\n   * @returns True if the type is in the list of allowed types.\n   */\n  private typeIsAllowed(type: string): boolean {\n    const typeList = this.getVariableTypes();\n    if (!typeList) {\n      return true; // If it's null, all types are valid.\n    }\n    for (let i = 0; i < typeList.length; i++) {\n      if (type === typeList[i]) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Return a list of variable types to include in the dropdown.\n   *\n   * @returns Array of variable types.\n   * @throws {Error} if variableTypes is an empty array.\n   */\n  private getVariableTypes(): string[] {\n    let variableTypes = this.variableTypes;\n    if (variableTypes === null) {\n      // If variableTypes is null, return all variable types.\n      if (this.sourceBlock_ && !this.sourceBlock_.isDeadOrDying()) {\n        return this.sourceBlock_.workspace.getVariableTypes();\n      }\n    }\n    variableTypes = variableTypes || [''];\n    if (variableTypes.length === 0) {\n      // Throw an error if variableTypes is an empty list.\n      const name = this.getText();\n      throw Error(\n        \"'variableTypes' of field variable \" + name + ' was an empty list',\n      );\n    }\n    return variableTypes;\n  }\n\n  /**\n   * Parse the optional arguments representing the allowed variable types and\n   * the default variable type.\n   *\n   * @param variableTypes A list of the types of variables to include in the\n   *     dropdown.  If null or undefined, variables of all types will be\n   *     displayed in the dropdown.\n   * @param defaultType The type of the variable to create if this field's\n   *     value is not explicitly set.  Defaults to ''.\n   */\n  private setTypes(variableTypes: string[] | null = null, defaultType = '') {\n    // If you expected that the default type would be the same as the only entry\n    // in the variable types array, tell the Blockly team by commenting on\n    // #1499.\n    // Set the allowable variable types.  Null means all types on the workspace.\n    if (Array.isArray(variableTypes)) {\n      variableTypes = variableTypes;\n      // Make sure the default type is valid.\n      let isInArray = false;\n      for (let i = 0; i < variableTypes.length; i++) {\n        if (variableTypes[i] === defaultType) {\n          isInArray = true;\n        }\n      }\n      if (!isInArray) {\n        throw Error(\n          \"Invalid default type '\" +\n            defaultType +\n            \"' in \" +\n            'the definition of a FieldVariable',\n        );\n      }\n    } else if (variableTypes !== null) {\n      throw Error(\n        \"'variableTypes' was not an array in the definition of \" +\n          'a FieldVariable',\n      );\n    }\n    // Only update the field once all checks pass.\n    this.defaultType = defaultType;\n    this.variableTypes = variableTypes;\n  }\n\n  /**\n   * Refreshes the name of the variable by grabbing the name of the model.\n   * Used when a variable gets renamed, but the ID stays the same. Should only\n   * be called by the block.\n   *\n   * @internal\n   */\n  override refreshVariableName() {\n    this.forceRerender();\n  }\n\n  /**\n   * Handle the selection of an item in the variable dropdown menu.\n   * Special case the 'Rename variable...' and 'Delete variable...' options.\n   * In the rename case, prompt the user for a new name.\n   *\n   * @param menu The Menu component clicked.\n   * @param menuItem The MenuItem selected within menu.\n   */\n  protected override onItemSelected_(menu: Menu, menuItem: MenuItem) {\n    const id = menuItem.getValue();\n    // Handle special cases.\n    if (this.sourceBlock_ && !this.sourceBlock_.isDeadOrDying()) {\n      if (id === internalConstants.RENAME_VARIABLE_ID) {\n        // Rename variable.\n        Variables.renameVariable(\n          this.sourceBlock_.workspace,\n          this.variable as VariableModel,\n        );\n        return;\n      } else if (id === internalConstants.DELETE_VARIABLE_ID) {\n        // Delete variable.\n        this.sourceBlock_.workspace.deleteVariableById(this.variable!.getId());\n        return;\n      }\n    }\n    // Handle unspecial case.\n    this.setValue(id);\n  }\n\n  /**\n   * Overrides referencesVariables(), indicating this field refers to a\n   * variable.\n   *\n   * @returns True.\n   * @internal\n   */\n  override referencesVariables(): boolean {\n    return true;\n  }\n\n  /**\n   * Construct a FieldVariable from a JSON arg object,\n   * dereferencing any string table references.\n   *\n   * @param options A JSON object with options (variable, variableTypes, and\n   *     defaultType).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static override fromJson(\n    options: FieldVariableFromJsonConfig,\n  ): FieldVariable {\n    const varName = parsing.replaceMessageReferences(options.variable);\n    // `this` might be a subclass of FieldVariable if that class doesn't\n    // override the static fromJson method.\n    return new this(varName, undefined, undefined, undefined, options);\n  }\n\n  /**\n   * Return a sorted list of variable names for variable dropdown menus.\n   * Include a special option at the end for creating a new variable name.\n   *\n   * @returns Array of variable names/id tuples.\n   */\n  static dropdownCreate(this: FieldVariable): MenuOption[] {\n    if (!this.variable) {\n      throw Error(\n        'Tried to call dropdownCreate on a variable field with no' +\n          ' variable selected.',\n      );\n    }\n    const name = this.getText();\n    let variableModelList: VariableModel[] = [];\n    if (this.sourceBlock_ && !this.sourceBlock_.isDeadOrDying()) {\n      const variableTypes = this.getVariableTypes();\n      // Get a copy of the list, so that adding rename and new variable options\n      // doesn't modify the workspace's list.\n      for (let i = 0; i < variableTypes.length; i++) {\n        const variableType = variableTypes[i];\n        const variables =\n          this.sourceBlock_.workspace.getVariablesOfType(variableType);\n        variableModelList = variableModelList.concat(variables);\n      }\n    }\n    variableModelList.sort(VariableModel.compareByName);\n\n    const options: [string, string][] = [];\n    for (let i = 0; i < variableModelList.length; i++) {\n      // Set the UUID as the internal representation of the variable.\n      options[i] = [variableModelList[i].name, variableModelList[i].getId()];\n    }\n    options.push([\n      Msg['RENAME_VARIABLE'],\n      internalConstants.RENAME_VARIABLE_ID,\n    ]);\n    if (Msg['DELETE_VARIABLE']) {\n      options.push([\n        Msg['DELETE_VARIABLE'].replace('%1', name),\n        internalConstants.DELETE_VARIABLE_ID,\n      ]);\n    }\n\n    return options;\n  }\n}\n\nfieldRegistry.register('field_variable', FieldVariable);\n\n/**\n * Config options for the variable field.\n */\nexport interface FieldVariableConfig extends FieldConfig {\n  variableTypes?: string[];\n  defaultType?: string;\n}\n\n/**\n * fromJson config options for the variable field.\n */\nexport interface FieldVariableFromJsonConfig extends FieldVariableConfig {\n  variable?: string;\n}\n\n/**\n * A function that is called to validate changes to the field's value before\n * they are set.\n *\n * @see {@link https://developers.google.com/blockly/guides/create-custom-blocks/fields/validators#return_values}\n * @param newValue The value to be validated.\n * @returns One of three instructions for setting the new value: `T`, `null`,\n * or `undefined`.\n *\n * - `T` to set this function's returned value instead of `newValue`.\n *\n * - `null` to invoke `doValueInvalid_` and not set a value.\n *\n * - `undefined` to set `newValue` as is.\n */\nexport type FieldVariableValidator = FieldDropdownValidator;\n","/**\n * @license\n * Copyright 2016 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for a button in the flyout.\n *\n * @class\n */\n// Former goog.module ID: Blockly.FlyoutButton\n\nimport * as browserEvents from './browser_events.js';\nimport * as Css from './css.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport * as parsing from './utils/parsing.js';\nimport * as style from './utils/style.js';\nimport {Svg} from './utils/svg.js';\nimport type * as toolbox from './utils/toolbox.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Class for a button or label in the flyout.\n */\nexport class FlyoutButton {\n  /** The horizontal margin around the text in the button. */\n  static TEXT_MARGIN_X = 5;\n\n  /** The vertical margin around the text in the button. */\n  static TEXT_MARGIN_Y = 2;\n\n  /** The radius of the flyout button's borders. */\n  static BORDER_RADIUS = 4;\n\n  private readonly text: string;\n  private readonly position: Coordinate;\n  private readonly callbackKey: string;\n  private readonly cssClass: string | null;\n\n  /** Mouse up event data. */\n  private onMouseUpWrapper: browserEvents.Data | null = null;\n  info: toolbox.ButtonOrLabelInfo;\n\n  /** The width of the button's rect. */\n  width = 0;\n\n  /** The height of the button's rect. */\n  height = 0;\n\n  /** The root SVG group for the button or label. */\n  private svgGroup: SVGGElement | null = null;\n\n  /** The SVG element with the text of the label or button. */\n  private svgText: SVGTextElement | null = null;\n\n  /**\n   * @param workspace The workspace in which to place this button.\n   * @param targetWorkspace The flyout's target workspace.\n   * @param json The JSON specifying the label/button.\n   * @param isLabel_ Whether this button should be styled as a label.\n   * @internal\n   */\n  constructor(\n    private readonly workspace: WorkspaceSvg,\n    private readonly targetWorkspace: WorkspaceSvg,\n    json: toolbox.ButtonOrLabelInfo,\n    private readonly isLabel_: boolean,\n  ) {\n    this.text = json['text'];\n\n    this.position = new Coordinate(0, 0);\n\n    /** The key to the function called when this button is clicked. */\n    this.callbackKey =\n      (json as AnyDuringMigration)[\n        'callbackKey'\n      ] /* Check the lower case version\n                                                   too to satisfy IE */ ||\n      (json as AnyDuringMigration)['callbackkey'];\n\n    /** If specified, a CSS class to add to this button. */\n    this.cssClass = (json as AnyDuringMigration)['web-class'] || null;\n\n    /** The JSON specifying the label / button. */\n    this.info = json;\n  }\n\n  /**\n   * Create the button elements.\n   *\n   * @returns The button's SVG group.\n   */\n  createDom(): SVGElement {\n    let cssClass = this.isLabel_ ? 'blocklyFlyoutLabel' : 'blocklyFlyoutButton';\n    if (this.cssClass) {\n      cssClass += ' ' + this.cssClass;\n    }\n\n    this.svgGroup = dom.createSvgElement(\n      Svg.G,\n      {'class': cssClass},\n      this.workspace.getCanvas(),\n    );\n\n    let shadow;\n    if (!this.isLabel_) {\n      // Shadow rectangle (light source does not mirror in RTL).\n      shadow = dom.createSvgElement(\n        Svg.RECT,\n        {\n          'class': 'blocklyFlyoutButtonShadow',\n          'rx': FlyoutButton.BORDER_RADIUS,\n          'ry': FlyoutButton.BORDER_RADIUS,\n          'x': 1,\n          'y': 1,\n        },\n        this.svgGroup!,\n      );\n    }\n    // Background rectangle.\n    const rect = dom.createSvgElement(\n      Svg.RECT,\n      {\n        'class': this.isLabel_\n          ? 'blocklyFlyoutLabelBackground'\n          : 'blocklyFlyoutButtonBackground',\n        'rx': FlyoutButton.BORDER_RADIUS,\n        'ry': FlyoutButton.BORDER_RADIUS,\n      },\n      this.svgGroup!,\n    );\n\n    const svgText = dom.createSvgElement(\n      Svg.TEXT,\n      {\n        'class': this.isLabel_ ? 'blocklyFlyoutLabelText' : 'blocklyText',\n        'x': 0,\n        'y': 0,\n        'text-anchor': 'middle',\n      },\n      this.svgGroup!,\n    );\n    let text = parsing.replaceMessageReferences(this.text);\n    if (this.workspace.RTL) {\n      // Force text to be RTL by adding an RLM.\n      text += '\\u200F';\n    }\n    svgText.textContent = text;\n    if (this.isLabel_) {\n      this.svgText = svgText;\n      this.workspace\n        .getThemeManager()\n        .subscribe(this.svgText, 'flyoutForegroundColour', 'fill');\n    }\n\n    const fontSize = style.getComputedStyle(svgText, 'fontSize');\n    const fontWeight = style.getComputedStyle(svgText, 'fontWeight');\n    const fontFamily = style.getComputedStyle(svgText, 'fontFamily');\n    this.width = dom.getFastTextWidthWithSizeString(\n      svgText,\n      fontSize,\n      fontWeight,\n      fontFamily,\n    );\n    const fontMetrics = dom.measureFontMetrics(\n      text,\n      fontSize,\n      fontWeight,\n      fontFamily,\n    );\n    this.height = fontMetrics.height;\n\n    if (!this.isLabel_) {\n      this.width += 2 * FlyoutButton.TEXT_MARGIN_X;\n      this.height += 2 * FlyoutButton.TEXT_MARGIN_Y;\n      shadow?.setAttribute('width', String(this.width));\n      shadow?.setAttribute('height', String(this.height));\n    }\n    rect.setAttribute('width', String(this.width));\n    rect.setAttribute('height', String(this.height));\n\n    svgText.setAttribute('x', String(this.width / 2));\n    svgText.setAttribute(\n      'y',\n      String(this.height / 2 - fontMetrics.height / 2 + fontMetrics.baseline),\n    );\n\n    this.updateTransform();\n\n    // AnyDuringMigration because:  Argument of type 'SVGGElement | null' is not\n    // assignable to parameter of type 'EventTarget'.\n    this.onMouseUpWrapper = browserEvents.conditionalBind(\n      this.svgGroup as AnyDuringMigration,\n      'pointerup',\n      this,\n      this.onMouseUp,\n    );\n    return this.svgGroup!;\n  }\n\n  /** Correctly position the flyout button and make it visible. */\n  show() {\n    this.updateTransform();\n    this.svgGroup!.setAttribute('display', 'block');\n  }\n\n  /** Update SVG attributes to match internal state. */\n  private updateTransform() {\n    this.svgGroup!.setAttribute(\n      'transform',\n      'translate(' + this.position.x + ',' + this.position.y + ')',\n    );\n  }\n\n  /**\n   * Move the button to the given x, y coordinates.\n   *\n   * @param x The new x coordinate.\n   * @param y The new y coordinate.\n   */\n  moveTo(x: number, y: number) {\n    this.position.x = x;\n    this.position.y = y;\n    this.updateTransform();\n  }\n\n  /** @returns Whether or not the button is a label. */\n  isLabel(): boolean {\n    return this.isLabel_;\n  }\n\n  /**\n   * Location of the button.\n   *\n   * @returns x, y coordinates.\n   * @internal\n   */\n  getPosition(): Coordinate {\n    return this.position;\n  }\n\n  /** @returns Text of the button. */\n  getButtonText(): string {\n    return this.text;\n  }\n\n  /**\n   * Get the button's target workspace.\n   *\n   * @returns The target workspace of the flyout where this button resides.\n   */\n  getTargetWorkspace(): WorkspaceSvg {\n    return this.targetWorkspace;\n  }\n\n  /** Dispose of this button. */\n  dispose() {\n    if (this.onMouseUpWrapper) {\n      browserEvents.unbind(this.onMouseUpWrapper);\n    }\n    if (this.svgGroup) {\n      dom.removeNode(this.svgGroup);\n    }\n    if (this.svgText) {\n      this.workspace.getThemeManager().unsubscribe(this.svgText);\n    }\n  }\n\n  /**\n   * Do something when the button is clicked.\n   *\n   * @param e Pointer up event.\n   */\n  private onMouseUp(e: PointerEvent) {\n    const gesture = this.targetWorkspace.getGesture(e);\n    if (gesture) {\n      gesture.cancel();\n    }\n\n    if (this.isLabel_ && this.callbackKey) {\n      console.warn(\n        'Labels should not have callbacks. Label text: ' + this.text,\n      );\n    } else if (\n      !this.isLabel_ &&\n      !(\n        this.callbackKey &&\n        this.targetWorkspace.getButtonCallback(this.callbackKey)\n      )\n    ) {\n      console.warn('Buttons should have callbacks. Button text: ' + this.text);\n    } else if (!this.isLabel_) {\n      const callback = this.targetWorkspace.getButtonCallback(this.callbackKey);\n      if (callback) {\n        callback(this);\n      }\n    }\n  }\n}\n\n/** CSS for buttons and labels. See css.js for use. */\nCss.register(`\n.blocklyFlyoutButton {\n  fill: #888;\n  cursor: default;\n}\n\n.blocklyFlyoutButtonShadow {\n  fill: #666;\n}\n\n.blocklyFlyoutButton:hover {\n  fill: #aaa;\n}\n\n.blocklyFlyoutLabel {\n  cursor: default;\n}\n\n.blocklyFlyoutLabelBackground {\n  opacity: 0;\n}\n`);\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Calculates and reports flyout workspace metrics.\n *\n * @class\n */\n// Former goog.module ID: Blockly.FlyoutMetricsManager\n\nimport type {IFlyout} from './interfaces/i_flyout.js';\nimport {ContainerRegion, MetricsManager} from './metrics_manager.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Calculates metrics for a flyout's workspace.\n * The metrics are mainly used to size scrollbars for the flyout.\n */\nexport class FlyoutMetricsManager extends MetricsManager {\n  /** The flyout that owns the workspace to calculate metrics for. */\n  protected flyout_: IFlyout;\n\n  /**\n   * @param workspace The flyout's workspace.\n   * @param flyout The flyout.\n   */\n  constructor(workspace: WorkspaceSvg, flyout: IFlyout) {\n    super(workspace);\n    this.flyout_ = flyout;\n  }\n\n  /**\n   * Gets the bounding box of the blocks on the flyout's workspace.\n   * This is in workspace coordinates.\n   *\n   * @returns The bounding box of the blocks on the workspace.\n   */\n  private getBoundingBox_():\n    | SVGRect\n    | {height: number; y: number; width: number; x: number} {\n    let blockBoundingBox;\n    try {\n      blockBoundingBox = this.workspace_.getCanvas().getBBox();\n    } catch (e) {\n      // Firefox has trouble with hidden elements (Bug 528969).\n      // 2021 Update: It looks like this was fixed around Firefox 77 released in\n      // 2020.\n      blockBoundingBox = {height: 0, y: 0, width: 0, x: 0};\n    }\n    return blockBoundingBox;\n  }\n\n  override getContentMetrics(opt_getWorkspaceCoordinates?: boolean) {\n    // The bounding box is in workspace coordinates.\n    const blockBoundingBox = this.getBoundingBox_();\n    const scale = opt_getWorkspaceCoordinates ? 1 : this.workspace_.scale;\n\n    return {\n      height: blockBoundingBox.height * scale,\n      width: blockBoundingBox.width * scale,\n      top: blockBoundingBox.y * scale,\n      left: blockBoundingBox.x * scale,\n    };\n  }\n\n  override getScrollMetrics(\n    opt_getWorkspaceCoordinates?: boolean,\n    opt_viewMetrics?: ContainerRegion,\n    opt_contentMetrics?: ContainerRegion,\n  ) {\n    const contentMetrics = opt_contentMetrics || this.getContentMetrics();\n    const margin = this.flyout_.MARGIN * this.workspace_.scale;\n    const scale = opt_getWorkspaceCoordinates ? this.workspace_.scale : 1;\n\n    // The left padding isn't just the margin. Some blocks are also offset by\n    // tabWidth so that value and statement blocks line up.\n    // The contentMetrics.left value is equivalent to the variable left padding.\n    const leftPadding = contentMetrics.left;\n\n    return {\n      height: (contentMetrics.height + 2 * margin) / scale,\n      width: (contentMetrics.width + leftPadding + margin) / scale,\n      top: 0,\n      left: 0,\n    };\n  }\n}\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Flyout tray containing blocks which may be created.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Flyout\n\nimport type {Abstract as AbstractEvent} from './events/events_abstract.js';\nimport type {Block} from './block.js';\nimport type {BlockSvg} from './block_svg.js';\nimport * as browserEvents from './browser_events.js';\nimport * as common from './common.js';\nimport {ComponentManager} from './component_manager.js';\nimport {DeleteArea} from './delete_area.js';\nimport * as eventUtils from './events/utils.js';\nimport {FlyoutButton} from './flyout_button.js';\nimport {FlyoutMetricsManager} from './flyout_metrics_manager.js';\nimport type {IFlyout} from './interfaces/i_flyout.js';\nimport type {Options} from './options.js';\nimport {ScrollbarPair} from './scrollbar_pair.js';\nimport * as blocks from './serialization/blocks.js';\nimport * as Tooltip from './tooltip.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport * as idGenerator from './utils/idgenerator.js';\nimport {Svg} from './utils/svg.js';\nimport * as toolbox from './utils/toolbox.js';\nimport * as Variables from './variables.js';\nimport {WorkspaceSvg} from './workspace_svg.js';\nimport * as utilsXml from './utils/xml.js';\nimport * as Xml from './xml.js';\nimport * as renderManagement from './render_management.js';\nimport {IAutoHideable} from './interfaces/i_autohideable.js';\n\nenum FlyoutItemType {\n  BLOCK = 'block',\n  BUTTON = 'button',\n}\n\n/**\n * Class for a flyout.\n */\nexport abstract class Flyout\n  extends DeleteArea\n  implements IAutoHideable, IFlyout\n{\n  /**\n   * Position the flyout.\n   */\n  abstract position(): void;\n\n  /**\n   * Determine if a drag delta is toward the workspace, based on the position\n   * and orientation of the flyout. This is used in determineDragIntention_ to\n   * determine if a new block should be created or if the flyout should scroll.\n   *\n   * @param currentDragDeltaXY How far the pointer has\n   *     moved from the position at mouse down, in pixel units.\n   * @returns True if the drag is toward the workspace.\n   */\n  abstract isDragTowardWorkspace(currentDragDeltaXY: Coordinate): boolean;\n\n  /**\n   * Sets the translation of the flyout to match the scrollbars.\n   *\n   * @param xyRatio Contains a y property which is a float\n   *     between 0 and 1 specifying the degree of scrolling and a\n   *     similar x property.\n   */\n  protected abstract setMetrics_(xyRatio: {x?: number; y?: number}): void;\n\n  /**\n   * Lay out the blocks in the flyout.\n   *\n   * @param contents The blocks and buttons to lay out.\n   * @param gaps The visible gaps between blocks.\n   */\n  protected abstract layout_(contents: FlyoutItem[], gaps: number[]): void;\n\n  /**\n   * Scroll the flyout.\n   *\n   * @param e Mouse wheel scroll event.\n   */\n  protected abstract wheel_(e: WheelEvent): void;\n\n  /**\n   * Compute height of flyout.  Position mat under each block.\n   * For RTL: Lay out the blocks right-aligned.\n   */\n  protected abstract reflowInternal_(): void;\n\n  /**\n   * Calculates the x coordinate for the flyout position.\n   *\n   * @returns X coordinate.\n   */\n  abstract getX(): number;\n\n  /**\n   * Calculates the y coordinate for the flyout position.\n   *\n   * @returns Y coordinate.\n   */\n  abstract getY(): number;\n\n  /**\n   * Scroll the flyout to the beginning of its contents.\n   */\n  abstract scrollToStart(): void;\n\n  /**\n   * The type of a flyout content item.\n   */\n  static FlyoutItemType = FlyoutItemType;\n\n  protected workspace_: WorkspaceSvg;\n  RTL: boolean;\n  /**\n   * Whether the flyout should be laid out horizontally or not.\n   *\n   * @internal\n   */\n  horizontalLayout = false;\n  protected toolboxPosition_: number;\n\n  /**\n   * Array holding info needed to unbind events.\n   * Used for disposing.\n   * Ex: [[node, name, func], [node, name, func]].\n   */\n  private boundEvents: browserEvents.Data[] = [];\n\n  /**\n   * Function that will be registered as a change listener on the workspace\n   * to reflow when blocks in the flyout workspace change.\n   */\n  private reflowWrapper: ((e: AbstractEvent) => void) | null = null;\n\n  /**\n   * Function that disables blocks in the flyout based on max block counts\n   * allowed in the target workspace. Registered as a change listener on the\n   * target workspace.\n   */\n  private filterWrapper: ((e: AbstractEvent) => void) | null = null;\n\n  /**\n   * List of background mats that lurk behind each block to catch clicks\n   * landing in the blocks' lakes and bays.\n   */\n  private mats: SVGElement[] = [];\n\n  /**\n   * List of visible buttons.\n   */\n  protected buttons_: FlyoutButton[] = [];\n\n  /**\n   * List of event listeners.\n   */\n  private listeners: browserEvents.Data[] = [];\n\n  /**\n   * List of blocks that should always be disabled.\n   */\n  private permanentlyDisabled: Block[] = [];\n\n  protected readonly tabWidth_: number;\n\n  /**\n   * The target workspace.\n   *\n   * @internal\n   */\n  targetWorkspace!: WorkspaceSvg;\n\n  /**\n   * A list of blocks that can be reused.\n   */\n  private recycledBlocks: BlockSvg[] = [];\n\n  /**\n   * Does the flyout automatically close when a block is created?\n   */\n  autoClose = true;\n\n  /**\n   * Whether the flyout is visible.\n   */\n  private isVisible_ = false;\n\n  /**\n   * Whether the workspace containing this flyout is visible.\n   */\n  private containerVisible = true;\n  protected rectMap_: WeakMap<BlockSvg, SVGElement>;\n\n  /**\n   * Corner radius of the flyout background.\n   */\n  readonly CORNER_RADIUS: number = 8;\n  readonly MARGIN: number;\n  readonly GAP_X: number;\n  readonly GAP_Y: number;\n\n  /**\n   * Top/bottom padding between scrollbar and edge of flyout background.\n   */\n  readonly SCROLLBAR_MARGIN: number = 2.5;\n\n  /**\n   * Width of flyout.\n   */\n  protected width_ = 0;\n\n  /**\n   * Height of flyout.\n   */\n  protected height_ = 0;\n  // clang-format off\n  /**\n   * Range of a drag angle from a flyout considered \"dragging toward\n   * workspace\". Drags that are within the bounds of this many degrees from\n   * the orthogonal line to the flyout edge are considered to be \"drags toward\n   * the workspace\".\n   *\n   * @example\n   *\n   * ```\n   * Flyout                                                 Edge   Workspace\n   * [block] /  <-within this angle, drags \"toward workspace\" |\n   * [block] ---- orthogonal to flyout boundary ----          |\n   * [block] \\                                                |\n   * ```\n   *\n   * The angle is given in degrees from the orthogonal.\n   *\n   * This is used to know when to create a new block and when to scroll the\n   * flyout. Setting it to 360 means that all drags create a new block.\n   */\n  // clang-format on\n  protected dragAngleRange_ = 70;\n\n  /**\n   * The path around the background of the flyout, which will be filled with a\n   * background colour.\n   */\n  protected svgBackground_: SVGPathElement | null = null;\n\n  /**\n   * The root SVG group for the button or label.\n   */\n  protected svgGroup_: SVGGElement | null = null;\n  /**\n   * @param workspaceOptions Dictionary of options for the\n   *     workspace.\n   */\n  constructor(workspaceOptions: Options) {\n    super();\n    workspaceOptions.setMetrics = this.setMetrics_.bind(this);\n\n    this.workspace_ = new WorkspaceSvg(workspaceOptions);\n    this.workspace_.setMetricsManager(\n      new FlyoutMetricsManager(this.workspace_, this),\n    );\n\n    this.workspace_.internalIsFlyout = true;\n    // Keep the workspace visibility consistent with the flyout's visibility.\n    this.workspace_.setVisible(this.isVisible_);\n\n    /**\n     * The unique id for this component that is used to register with the\n     * ComponentManager.\n     */\n    this.id = idGenerator.genUid();\n\n    /**\n     * Is RTL vs LTR.\n     */\n    this.RTL = !!workspaceOptions.RTL;\n\n    /**\n     * Position of the toolbox and flyout relative to the workspace.\n     */\n    this.toolboxPosition_ = workspaceOptions.toolboxPosition;\n\n    /**\n     * Width of output tab.\n     */\n    this.tabWidth_ = this.workspace_.getRenderer().getConstants().TAB_WIDTH;\n\n    /**\n     * A map from blocks to the rects which are beneath them to act as input\n     * targets.\n     *\n     * @internal\n     */\n    this.rectMap_ = new WeakMap();\n\n    /**\n     * Margin around the edges of the blocks in the flyout.\n     */\n    this.MARGIN = this.CORNER_RADIUS;\n\n    // TODO: Move GAP_X and GAP_Y to their appropriate files.\n    /**\n     * Gap between items in horizontal flyouts. Can be overridden with the \"sep\"\n     * element.\n     */\n    this.GAP_X = this.MARGIN * 3;\n\n    /**\n     * Gap between items in vertical flyouts. Can be overridden with the \"sep\"\n     * element.\n     */\n    this.GAP_Y = this.MARGIN * 3;\n  }\n\n  /**\n   * Creates the flyout's DOM.  Only needs to be called once.  The flyout can\n   * either exist as its own SVG element or be a g element nested inside a\n   * separate SVG element.\n   *\n   * @param tagName The type of tag to\n   *     put the flyout in. This should be <svg> or <g>.\n   * @returns The flyout's SVG group.\n   */\n  createDom(\n    tagName: string | Svg<SVGSVGElement> | Svg<SVGGElement>,\n  ): SVGElement {\n    /*\n        <svg | g>\n          <path class=\"blocklyFlyoutBackground\"/>\n          <g class=\"blocklyFlyout\"></g>\n        </ svg | g>\n        */\n    // Setting style to display:none to start. The toolbox and flyout\n    // hide/show code will set up proper visibility and size later.\n    this.svgGroup_ = dom.createSvgElement(tagName, {\n      'class': 'blocklyFlyout',\n    });\n    this.svgGroup_.style.display = 'none';\n    this.svgBackground_ = dom.createSvgElement(\n      Svg.PATH,\n      {'class': 'blocklyFlyoutBackground'},\n      this.svgGroup_,\n    );\n    this.svgGroup_.appendChild(this.workspace_.createDom());\n    this.workspace_\n      .getThemeManager()\n      .subscribe(this.svgBackground_, 'flyoutBackgroundColour', 'fill');\n    this.workspace_\n      .getThemeManager()\n      .subscribe(this.svgBackground_, 'flyoutOpacity', 'fill-opacity');\n    return this.svgGroup_;\n  }\n\n  /**\n   * Initializes the flyout.\n   *\n   * @param targetWorkspace The workspace in which to\n   *     create new blocks.\n   */\n  init(targetWorkspace: WorkspaceSvg) {\n    this.targetWorkspace = targetWorkspace;\n    this.workspace_.targetWorkspace = targetWorkspace;\n\n    this.workspace_.scrollbar = new ScrollbarPair(\n      this.workspace_,\n      this.horizontalLayout,\n      !this.horizontalLayout,\n      'blocklyFlyoutScrollbar',\n      this.SCROLLBAR_MARGIN,\n    );\n\n    this.hide();\n\n    this.boundEvents.push(\n      browserEvents.conditionalBind(\n        this.svgGroup_ as SVGGElement,\n        'wheel',\n        this,\n        this.wheel_,\n      ),\n    );\n    this.filterWrapper = this.filterForCapacity.bind(this);\n    this.targetWorkspace.addChangeListener(this.filterWrapper);\n\n    // Dragging the flyout up and down.\n    this.boundEvents.push(\n      browserEvents.conditionalBind(\n        this.svgBackground_ as SVGPathElement,\n        'pointerdown',\n        this,\n        this.onMouseDown,\n      ),\n    );\n\n    // A flyout connected to a workspace doesn't have its own current gesture.\n    this.workspace_.getGesture = this.targetWorkspace.getGesture.bind(\n      this.targetWorkspace,\n    );\n\n    // Get variables from the main workspace rather than the target workspace.\n    this.workspace_.setVariableMap(this.targetWorkspace.getVariableMap());\n\n    this.workspace_.createPotentialVariableMap();\n\n    targetWorkspace.getComponentManager().addComponent({\n      component: this,\n      weight: 1,\n      capabilities: [\n        ComponentManager.Capability.AUTOHIDEABLE,\n        ComponentManager.Capability.DELETE_AREA,\n        ComponentManager.Capability.DRAG_TARGET,\n      ],\n    });\n  }\n\n  /**\n   * Dispose of this flyout.\n   * Unlink from all DOM elements to prevent memory leaks.\n   */\n  dispose() {\n    this.hide();\n    this.targetWorkspace.getComponentManager().removeComponent(this.id);\n    for (const event of this.boundEvents) {\n      browserEvents.unbind(event);\n    }\n    this.boundEvents.length = 0;\n    if (this.filterWrapper) {\n      this.targetWorkspace.removeChangeListener(this.filterWrapper);\n    }\n    if (this.workspace_) {\n      this.workspace_.getThemeManager().unsubscribe(this.svgBackground_!);\n      this.workspace_.dispose();\n    }\n    if (this.svgGroup_) {\n      dom.removeNode(this.svgGroup_);\n    }\n  }\n\n  /**\n   * Get the width of the flyout.\n   *\n   * @returns The width of the flyout.\n   */\n  getWidth(): number {\n    return this.width_;\n  }\n\n  /**\n   * Get the height of the flyout.\n   *\n   * @returns The width of the flyout.\n   */\n  getHeight(): number {\n    return this.height_;\n  }\n\n  /**\n   * Get the scale (zoom level) of the flyout. By default,\n   * this matches the target workspace scale, but this can be overridden.\n   *\n   * @returns Flyout workspace scale.\n   */\n  getFlyoutScale(): number {\n    return this.targetWorkspace.scale;\n  }\n\n  /**\n   * Get the workspace inside the flyout.\n   *\n   * @returns The workspace inside the flyout.\n   */\n  getWorkspace(): WorkspaceSvg {\n    return this.workspace_;\n  }\n\n  /**\n   * Sets whether this flyout automatically closes when blocks are dragged out,\n   * the workspace is clicked, etc, or not.\n   */\n  setAutoClose(autoClose: boolean) {\n    this.autoClose = autoClose;\n    this.targetWorkspace.recordDragTargets();\n    this.targetWorkspace.resizeContents();\n  }\n\n  /** Automatically hides the flyout if it is an autoclosing flyout. */\n  autoHide(onlyClosePopups: boolean): void {\n    if (\n      !onlyClosePopups &&\n      this.targetWorkspace.getFlyout(true) === this &&\n      this.autoClose\n    )\n      this.hide();\n  }\n\n  /**\n   * Is the flyout visible?\n   *\n   * @returns True if visible.\n   */\n  isVisible(): boolean {\n    return this.isVisible_;\n  }\n\n  /**\n   * Set whether the flyout is visible. A value of true does not necessarily\n   * mean that the flyout is shown. It could be hidden because its container is\n   * hidden.\n   *\n   * @param visible True if visible.\n   */\n  setVisible(visible: boolean) {\n    const visibilityChanged = visible !== this.isVisible();\n\n    this.isVisible_ = visible;\n    if (visibilityChanged) {\n      if (!this.autoClose) {\n        // Auto-close flyouts are ignored as drag targets, so only non\n        // auto-close flyouts need to have their drag target updated.\n        this.targetWorkspace.recordDragTargets();\n      }\n      this.updateDisplay();\n    }\n  }\n\n  /**\n   * Set whether this flyout's container is visible.\n   *\n   * @param visible Whether the container is visible.\n   */\n  setContainerVisible(visible: boolean) {\n    const visibilityChanged = visible !== this.containerVisible;\n    this.containerVisible = visible;\n    if (visibilityChanged) {\n      this.updateDisplay();\n    }\n  }\n\n  /**\n   * Update the display property of the flyout based whether it thinks it should\n   * be visible and whether its containing workspace is visible.\n   */\n  private updateDisplay() {\n    let show = true;\n    if (!this.containerVisible) {\n      show = false;\n    } else {\n      show = this.isVisible();\n    }\n    if (this.svgGroup_) {\n      this.svgGroup_.style.display = show ? 'block' : 'none';\n    }\n    // Update the scrollbar's visibility too since it should mimic the\n    // flyout's visibility.\n    this.workspace_.scrollbar?.setContainerVisible(show);\n  }\n\n  /**\n   * Update the view based on coordinates calculated in position().\n   *\n   * @param width The computed width of the flyout's SVG group\n   * @param height The computed height of the flyout's SVG group.\n   * @param x The computed x origin of the flyout's SVG group.\n   * @param y The computed y origin of the flyout's SVG group.\n   */\n  protected positionAt_(width: number, height: number, x: number, y: number) {\n    this.svgGroup_?.setAttribute('width', `${width}`);\n    this.svgGroup_?.setAttribute('height', `${height}`);\n    this.workspace_.setCachedParentSvgSize(width, height);\n\n    if (this.svgGroup_) {\n      const transform = 'translate(' + x + 'px,' + y + 'px)';\n      dom.setCssTransform(this.svgGroup_, transform);\n    }\n\n    // Update the scrollbar (if one exists).\n    const scrollbar = this.workspace_.scrollbar;\n    if (scrollbar) {\n      // Set the scrollbars origin to be the top left of the flyout.\n      scrollbar.setOrigin(x, y);\n      scrollbar.resize();\n      // If origin changed and metrics haven't changed enough to trigger\n      // reposition in resize, we need to call setPosition. See issue #4692.\n      if (scrollbar.hScroll) {\n        scrollbar.hScroll.setPosition(\n          scrollbar.hScroll.position.x,\n          scrollbar.hScroll.position.y,\n        );\n      }\n      if (scrollbar.vScroll) {\n        scrollbar.vScroll.setPosition(\n          scrollbar.vScroll.position.x,\n          scrollbar.vScroll.position.y,\n        );\n      }\n    }\n  }\n\n  /**\n   * Hide and empty the flyout.\n   */\n  hide() {\n    if (!this.isVisible()) {\n      return;\n    }\n    this.setVisible(false);\n    // Delete all the event listeners.\n    for (const listen of this.listeners) {\n      browserEvents.unbind(listen);\n    }\n    this.listeners.length = 0;\n    if (this.reflowWrapper) {\n      this.workspace_.removeChangeListener(this.reflowWrapper);\n      this.reflowWrapper = null;\n    }\n    // Do NOT delete the blocks here.  Wait until Flyout.show.\n    // https://neil.fraser.name/news/2014/08/09/\n  }\n\n  /**\n   * Show and populate the flyout.\n   *\n   * @param flyoutDef Contents to display\n   *     in the flyout. This is either an array of Nodes, a NodeList, a\n   *     toolbox definition, or a string with the name of the dynamic category.\n   */\n  show(flyoutDef: toolbox.FlyoutDefinition | string) {\n    this.workspace_.setResizesEnabled(false);\n    this.hide();\n    this.clearOldBlocks();\n\n    // Handle dynamic categories, represented by a name instead of a list.\n    if (typeof flyoutDef === 'string') {\n      flyoutDef = this.getDynamicCategoryContents(flyoutDef);\n    }\n    this.setVisible(true);\n\n    // Parse the Array, Node or NodeList into a a list of flyout items.\n    const parsedContent = toolbox.convertFlyoutDefToJsonArray(flyoutDef);\n    const flyoutInfo = this.createFlyoutInfo(parsedContent);\n\n    renderManagement.triggerQueuedRenders(this.workspace_);\n\n    this.layout_(flyoutInfo.contents, flyoutInfo.gaps);\n\n    if (this.horizontalLayout) {\n      this.height_ = 0;\n    } else {\n      this.width_ = 0;\n    }\n    this.workspace_.setResizesEnabled(true);\n    this.reflow();\n\n    this.filterForCapacity();\n\n    // Correctly position the flyout's scrollbar when it opens.\n    this.position();\n\n    this.reflowWrapper = this.reflow.bind(this);\n    this.workspace_.addChangeListener(this.reflowWrapper);\n    this.emptyRecycledBlocks();\n  }\n\n  /**\n   * Create the contents array and gaps array necessary to create the layout for\n   * the flyout.\n   *\n   * @param parsedContent The array\n   *     of objects to show in the flyout.\n   * @returns The list of contents and gaps needed to lay out the flyout.\n   */\n  private createFlyoutInfo(parsedContent: toolbox.FlyoutItemInfoArray): {\n    contents: FlyoutItem[];\n    gaps: number[];\n  } {\n    const contents: FlyoutItem[] = [];\n    const gaps: number[] = [];\n    this.permanentlyDisabled.length = 0;\n    const defaultGap = this.horizontalLayout ? this.GAP_X : this.GAP_Y;\n    for (const info of parsedContent) {\n      if ('custom' in info) {\n        const customInfo = info as toolbox.DynamicCategoryInfo;\n        const categoryName = customInfo['custom'];\n        const flyoutDef = this.getDynamicCategoryContents(categoryName);\n        const parsedDynamicContent =\n          toolbox.convertFlyoutDefToJsonArray(flyoutDef);\n        const {contents: dynamicContents, gaps: dynamicGaps} =\n          this.createFlyoutInfo(parsedDynamicContent);\n        contents.push(...dynamicContents);\n        gaps.push(...dynamicGaps);\n      }\n\n      switch (info['kind'].toUpperCase()) {\n        case 'BLOCK': {\n          const blockInfo = info as toolbox.BlockInfo;\n          const block = this.createFlyoutBlock(blockInfo);\n          contents.push({type: FlyoutItemType.BLOCK, block: block});\n          this.addBlockGap(blockInfo, gaps, defaultGap);\n          break;\n        }\n        case 'SEP': {\n          const sepInfo = info as toolbox.SeparatorInfo;\n          this.addSeparatorGap(sepInfo, gaps, defaultGap);\n          break;\n        }\n        case 'LABEL': {\n          const labelInfo = info as toolbox.LabelInfo;\n          // A label is a button with different styling.\n          const label = this.createButton(labelInfo, /** isLabel */ true);\n          contents.push({type: FlyoutItemType.BUTTON, button: label});\n          gaps.push(defaultGap);\n          break;\n        }\n        case 'BUTTON': {\n          const buttonInfo = info as toolbox.ButtonInfo;\n          const button = this.createButton(buttonInfo, /** isLabel */ false);\n          contents.push({type: FlyoutItemType.BUTTON, button: button});\n          gaps.push(defaultGap);\n          break;\n        }\n      }\n    }\n\n    return {contents: contents, gaps: gaps};\n  }\n\n  /**\n   * Gets the flyout definition for the dynamic category.\n   *\n   * @param categoryName The name of the dynamic category.\n   * @returns The definition of the\n   *     flyout in one of its many forms.\n   */\n  private getDynamicCategoryContents(\n    categoryName: string,\n  ): toolbox.FlyoutDefinition {\n    // Look up the correct category generation function and call that to get a\n    // valid XML list.\n    const fnToApply =\n      this.workspace_.targetWorkspace!.getToolboxCategoryCallback(categoryName);\n    if (typeof fnToApply !== 'function') {\n      throw TypeError(\n        \"Couldn't find a callback function when opening\" +\n          ' a toolbox category.',\n      );\n    }\n    return fnToApply(this.workspace_.targetWorkspace!);\n  }\n\n  /**\n   * Creates a flyout button or a flyout label.\n   *\n   * @param btnInfo The object holding information about a button or a label.\n   * @param isLabel True if the button is a label, false otherwise.\n   * @returns The object used to display the button in the\n   *    flyout.\n   */\n  private createButton(\n    btnInfo: toolbox.ButtonOrLabelInfo,\n    isLabel: boolean,\n  ): FlyoutButton {\n    const curButton = new FlyoutButton(\n      this.workspace_,\n      this.targetWorkspace as WorkspaceSvg,\n      btnInfo,\n      isLabel,\n    );\n    return curButton;\n  }\n\n  /**\n   * Create a block from the xml and permanently disable any blocks that were\n   * defined as disabled.\n   *\n   * @param blockInfo The info of the block.\n   * @returns The block created from the blockInfo.\n   */\n  private createFlyoutBlock(blockInfo: toolbox.BlockInfo): BlockSvg {\n    let block;\n    if (blockInfo['blockxml']) {\n      const xml = (\n        typeof blockInfo['blockxml'] === 'string'\n          ? utilsXml.textToDom(blockInfo['blockxml'])\n          : blockInfo['blockxml']\n      ) as Element;\n      block = this.getRecycledBlock(xml.getAttribute('type')!);\n      if (!block) {\n        block = Xml.domToBlockInternal(xml, this.workspace_);\n      }\n    } else {\n      block = this.getRecycledBlock(blockInfo['type']!);\n      if (!block) {\n        if (blockInfo['enabled'] === undefined) {\n          blockInfo['enabled'] =\n            blockInfo['disabled'] !== 'true' && blockInfo['disabled'] !== true;\n        }\n        block = blocks.appendInternal(\n          blockInfo as blocks.State,\n          this.workspace_,\n        );\n      }\n    }\n\n    if (!block.isEnabled()) {\n      // Record blocks that were initially disabled.\n      // Do not enable these blocks as a result of capacity filtering.\n      this.permanentlyDisabled.push(block);\n    }\n    return block as BlockSvg;\n  }\n\n  /**\n   * Returns a block from the array of recycled blocks with the given type, or\n   * undefined if one cannot be found.\n   *\n   * @param blockType The type of the block to try to recycle.\n   * @returns The recycled block, or undefined if\n   *     one could not be recycled.\n   */\n  private getRecycledBlock(blockType: string): BlockSvg | undefined {\n    let index = -1;\n    for (let i = 0; i < this.recycledBlocks.length; i++) {\n      if (this.recycledBlocks[i].type === blockType) {\n        index = i;\n        break;\n      }\n    }\n    return index === -1 ? undefined : this.recycledBlocks.splice(index, 1)[0];\n  }\n\n  /**\n   * Adds a gap in the flyout based on block info.\n   *\n   * @param blockInfo Information about a block.\n   * @param gaps The list of gaps between items in the flyout.\n   * @param defaultGap The default gap between one element and the\n   *     next.\n   */\n  private addBlockGap(\n    blockInfo: toolbox.BlockInfo,\n    gaps: number[],\n    defaultGap: number,\n  ) {\n    let gap;\n    if (blockInfo['gap']) {\n      gap = parseInt(String(blockInfo['gap']));\n    } else if (blockInfo['blockxml']) {\n      const xml = (\n        typeof blockInfo['blockxml'] === 'string'\n          ? utilsXml.textToDom(blockInfo['blockxml'])\n          : blockInfo['blockxml']\n      ) as Element;\n      gap = parseInt(xml.getAttribute('gap')!);\n    }\n    gaps.push(!gap || isNaN(gap) ? defaultGap : gap);\n  }\n\n  /**\n   * Add the necessary gap in the flyout for a separator.\n   *\n   * @param sepInfo The object holding\n   *    information about a separator.\n   * @param gaps The list gaps between items in the flyout.\n   * @param defaultGap The default gap between the button and next\n   *     element.\n   */\n  private addSeparatorGap(\n    sepInfo: toolbox.SeparatorInfo,\n    gaps: number[],\n    defaultGap: number,\n  ) {\n    // Change the gap between two toolbox elements.\n    // <sep gap=\"36\"></sep>\n    // The default gap is 24, can be set larger or smaller.\n    // This overwrites the gap attribute on the previous element.\n    const newGap = parseInt(String(sepInfo['gap']));\n    // Ignore gaps before the first block.\n    if (!isNaN(newGap) && gaps.length > 0) {\n      gaps[gaps.length - 1] = newGap;\n    } else {\n      gaps.push(defaultGap);\n    }\n  }\n\n  /**\n   * Delete blocks, mats and buttons from a previous showing of the flyout.\n   */\n  private clearOldBlocks() {\n    // Delete any blocks from a previous showing.\n    const oldBlocks = this.workspace_.getTopBlocks(false);\n    for (let i = 0, block; (block = oldBlocks[i]); i++) {\n      if (this.blockIsRecyclable_(block)) {\n        this.recycleBlock(block);\n      } else {\n        block.dispose(false, false);\n      }\n    }\n    // Delete any mats from a previous showing.\n    for (let j = 0; j < this.mats.length; j++) {\n      const rect = this.mats[j];\n      if (rect) {\n        Tooltip.unbindMouseEvents(rect);\n        dom.removeNode(rect);\n      }\n    }\n    this.mats.length = 0;\n    // Delete any buttons from a previous showing.\n    for (let i = 0, button; (button = this.buttons_[i]); i++) {\n      button.dispose();\n    }\n    this.buttons_.length = 0;\n\n    // Clear potential variables from the previous showing.\n    this.workspace_.getPotentialVariableMap()?.clear();\n  }\n\n  /**\n   * Empties all of the recycled blocks, properly disposing of them.\n   */\n  private emptyRecycledBlocks() {\n    for (let i = 0; i < this.recycledBlocks.length; i++) {\n      this.recycledBlocks[i].dispose();\n    }\n    this.recycledBlocks = [];\n  }\n\n  /**\n   * Returns whether the given block can be recycled or not.\n   *\n   * @param _block The block to check for recyclability.\n   * @returns True if the block can be recycled. False otherwise.\n   */\n  protected blockIsRecyclable_(_block: BlockSvg): boolean {\n    // By default, recycling is disabled.\n    return false;\n  }\n\n  /**\n   * Puts a previously created block into the recycle bin and moves it to the\n   * top of the workspace. Used during large workspace swaps to limit the number\n   * of new DOM elements we need to create.\n   *\n   * @param block The block to recycle.\n   */\n  private recycleBlock(block: BlockSvg) {\n    const xy = block.getRelativeToSurfaceXY();\n    block.moveBy(-xy.x, -xy.y);\n    this.recycledBlocks.push(block);\n  }\n\n  /**\n   * Add listeners to a block that has been added to the flyout.\n   *\n   * @param root The root node of the SVG group the block is in.\n   * @param block The block to add listeners for.\n   * @param rect The invisible rectangle under the block that acts\n   *     as a mat for that block.\n   */\n  protected addBlockListeners_(\n    root: SVGElement,\n    block: BlockSvg,\n    rect: SVGElement,\n  ) {\n    this.listeners.push(\n      browserEvents.conditionalBind(\n        root,\n        'pointerdown',\n        null,\n        this.blockMouseDown(block),\n      ),\n    );\n    this.listeners.push(\n      browserEvents.conditionalBind(\n        rect,\n        'pointerdown',\n        null,\n        this.blockMouseDown(block),\n      ),\n    );\n    this.listeners.push(\n      browserEvents.bind(root, 'pointerenter', block, () => {\n        if (!this.targetWorkspace.isDragging()) {\n          block.addSelect();\n        }\n      }),\n    );\n    this.listeners.push(\n      browserEvents.bind(root, 'pointerleave', block, () => {\n        if (!this.targetWorkspace.isDragging()) {\n          block.removeSelect();\n        }\n      }),\n    );\n    this.listeners.push(\n      browserEvents.bind(rect, 'pointerenter', block, () => {\n        if (!this.targetWorkspace.isDragging()) {\n          block.addSelect();\n        }\n      }),\n    );\n    this.listeners.push(\n      browserEvents.bind(rect, 'pointerleave', block, () => {\n        if (!this.targetWorkspace.isDragging()) {\n          block.removeSelect();\n        }\n      }),\n    );\n  }\n\n  /**\n   * Handle a pointerdown on an SVG block in a non-closing flyout.\n   *\n   * @param block The flyout block to copy.\n   * @returns Function to call when block is clicked.\n   */\n  private blockMouseDown(block: BlockSvg): Function {\n    return (e: PointerEvent) => {\n      const gesture = this.targetWorkspace.getGesture(e);\n      if (gesture) {\n        gesture.setStartBlock(block);\n        gesture.handleFlyoutStart(e, this);\n      }\n    };\n  }\n\n  /**\n   * Pointer down on the flyout background.  Start a vertical scroll drag.\n   *\n   * @param e Pointer down event.\n   */\n  private onMouseDown(e: PointerEvent) {\n    const gesture = this.targetWorkspace.getGesture(e);\n    if (gesture) {\n      gesture.handleFlyoutStart(e, this);\n    }\n  }\n\n  /**\n   * Does this flyout allow you to create a new instance of the given block?\n   * Used for deciding if a block can be \"dragged out of\" the flyout.\n   *\n   * @param block The block to copy from the flyout.\n   * @returns True if you can create a new instance of the block, false\n   *    otherwise.\n   * @internal\n   */\n  isBlockCreatable(block: BlockSvg): boolean {\n    return block.isEnabled();\n  }\n\n  /**\n   * Create a copy of this block on the workspace.\n   *\n   * @param originalBlock The block to copy from the flyout.\n   * @returns The newly created block.\n   * @throws {Error} if something went wrong with deserialization.\n   * @internal\n   */\n  createBlock(originalBlock: BlockSvg): BlockSvg {\n    let newBlock = null;\n    eventUtils.disable();\n    const variablesBeforeCreation = this.targetWorkspace.getAllVariables();\n    this.targetWorkspace.setResizesEnabled(false);\n    try {\n      newBlock = this.placeNewBlock(originalBlock);\n    } finally {\n      eventUtils.enable();\n    }\n\n    // Close the flyout.\n    this.targetWorkspace.hideChaff();\n\n    const newVariables = Variables.getAddedVariables(\n      this.targetWorkspace,\n      variablesBeforeCreation,\n    );\n\n    if (eventUtils.isEnabled()) {\n      eventUtils.setGroup(true);\n      // Fire a VarCreate event for each (if any) new variable created.\n      for (let i = 0; i < newVariables.length; i++) {\n        const thisVariable = newVariables[i];\n        eventUtils.fire(\n          new (eventUtils.get(eventUtils.VAR_CREATE))(thisVariable),\n        );\n      }\n\n      // Block events come after var events, in case they refer to newly created\n      // variables.\n      eventUtils.fire(new (eventUtils.get(eventUtils.BLOCK_CREATE))(newBlock));\n    }\n    if (this.autoClose) {\n      this.hide();\n    } else {\n      this.filterForCapacity();\n    }\n    return newBlock;\n  }\n\n  /**\n   * Initialize the given button: move it to the correct location,\n   * add listeners, etc.\n   *\n   * @param button The button to initialize and place.\n   * @param x The x position of the cursor during this layout pass.\n   * @param y The y position of the cursor during this layout pass.\n   */\n  protected initFlyoutButton_(button: FlyoutButton, x: number, y: number) {\n    const buttonSvg = button.createDom();\n    button.moveTo(x, y);\n    button.show();\n    // Clicking on a flyout button or label is a lot like clicking on the\n    // flyout background.\n    this.listeners.push(\n      browserEvents.conditionalBind(\n        buttonSvg,\n        'pointerdown',\n        this,\n        this.onMouseDown,\n      ),\n    );\n\n    this.buttons_.push(button);\n  }\n\n  /**\n   * Create and place a rectangle corresponding to the given block.\n   *\n   * @param block The block to associate the rect to.\n   * @param x The x position of the cursor during this layout pass.\n   * @param y The y position of the cursor during this layout pass.\n   * @param blockHW The height and width of\n   *     the block.\n   * @param index The index into the mats list where this rect should\n   *     be placed.\n   * @returns Newly created SVG element for the rectangle behind\n   *     the block.\n   */\n  protected createRect_(\n    block: BlockSvg,\n    x: number,\n    y: number,\n    blockHW: {height: number; width: number},\n    index: number,\n  ): SVGElement {\n    // Create an invisible rectangle under the block to act as a button.  Just\n    // using the block as a button is poor, since blocks have holes in them.\n    const rect = dom.createSvgElement(Svg.RECT, {\n      'fill-opacity': 0,\n      'x': x,\n      'y': y,\n      'height': blockHW.height,\n      'width': blockHW.width,\n    });\n    (rect as AnyDuringMigration).tooltip = block;\n    Tooltip.bindMouseEvents(rect);\n    // Add the rectangles under the blocks, so that the blocks' tooltips work.\n    this.workspace_.getCanvas().insertBefore(rect, block.getSvgRoot());\n\n    this.rectMap_.set(block, rect);\n    this.mats[index] = rect;\n    return rect;\n  }\n\n  /**\n   * Move a rectangle to sit exactly behind a block, taking into account tabs,\n   * hats, and any other protrusions we invent.\n   *\n   * @param rect The rectangle to move directly behind the block.\n   * @param block The block the rectangle should be behind.\n   */\n  protected moveRectToBlock_(rect: SVGElement, block: BlockSvg) {\n    const blockHW = block.getHeightWidth();\n    rect.setAttribute('width', String(blockHW.width));\n    rect.setAttribute('height', String(blockHW.height));\n\n    const blockXY = block.getRelativeToSurfaceXY();\n    rect.setAttribute('y', String(blockXY.y));\n    rect.setAttribute(\n      'x',\n      String(this.RTL ? blockXY.x - blockHW.width : blockXY.x),\n    );\n  }\n\n  /**\n   * Filter the blocks on the flyout to disable the ones that are above the\n   * capacity limit.  For instance, if the user may only place two more blocks\n   * on the workspace, an \"a + b\" block that has two shadow blocks would be\n   * disabled.\n   */\n  private filterForCapacity() {\n    const blocks = this.workspace_.getTopBlocks(false);\n    for (let i = 0, block; (block = blocks[i]); i++) {\n      if (this.permanentlyDisabled.indexOf(block) === -1) {\n        const enable = this.targetWorkspace.isCapacityAvailable(\n          common.getBlockTypeCounts(block),\n        );\n        while (block) {\n          block.setEnabled(enable);\n          block = block.getNextBlock();\n        }\n      }\n    }\n  }\n\n  /**\n   * Reflow blocks and their mats.\n   */\n  reflow() {\n    if (this.reflowWrapper) {\n      this.workspace_.removeChangeListener(this.reflowWrapper);\n    }\n    this.reflowInternal_();\n    if (this.reflowWrapper) {\n      this.workspace_.addChangeListener(this.reflowWrapper);\n    }\n  }\n\n  /**\n   * @returns True if this flyout may be scrolled with a scrollbar or\n   *     by dragging.\n   * @internal\n   */\n  isScrollable(): boolean {\n    return this.workspace_.scrollbar\n      ? this.workspace_.scrollbar.isVisible()\n      : false;\n  }\n\n  /**\n   * Copy a block from the flyout to the workspace and position it correctly.\n   *\n   * @param oldBlock The flyout block to copy.\n   * @returns The new block in the main workspace.\n   */\n  private placeNewBlock(oldBlock: BlockSvg): BlockSvg {\n    const targetWorkspace = this.targetWorkspace;\n    const svgRootOld = oldBlock.getSvgRoot();\n    if (!svgRootOld) {\n      throw Error('oldBlock is not rendered');\n    }\n\n    // Clone the block.\n    const json = blocks.save(oldBlock) as blocks.State;\n    // Normallly this resizes leading to weird jumps. Save it for terminateDrag.\n    targetWorkspace.setResizesEnabled(false);\n    const block = blocks.append(json, targetWorkspace) as BlockSvg;\n\n    this.positionNewBlock(oldBlock, block);\n\n    return block;\n  }\n\n  /**\n   * Positions a block on the target workspace.\n   *\n   * @param oldBlock The flyout block being copied.\n   * @param block The block to posiiton.\n   */\n  private positionNewBlock(oldBlock: BlockSvg, block: BlockSvg) {\n    const targetWorkspace = this.targetWorkspace;\n\n    // The offset in pixels between the main workspace's origin and the upper\n    // left corner of the injection div.\n    const mainOffsetPixels = targetWorkspace.getOriginOffsetInPixels();\n\n    // The offset in pixels between the flyout workspace's origin and the upper\n    // left corner of the injection div.\n    const flyoutOffsetPixels = this.workspace_.getOriginOffsetInPixels();\n\n    // The position of the old block in flyout workspace coordinates.\n    const oldBlockPos = oldBlock.getRelativeToSurfaceXY();\n    // The position of the old block in pixels relative to the flyout\n    // workspace's origin.\n    oldBlockPos.scale(this.workspace_.scale);\n\n    // The position of the old block in pixels relative to the upper left corner\n    // of the injection div.\n    const oldBlockOffsetPixels = Coordinate.sum(\n      flyoutOffsetPixels,\n      oldBlockPos,\n    );\n\n    // The position of the old block in pixels relative to the origin of the\n    // main workspace.\n    const finalOffset = Coordinate.difference(\n      oldBlockOffsetPixels,\n      mainOffsetPixels,\n    );\n    // The position of the old block in main workspace coordinates.\n    finalOffset.scale(1 / targetWorkspace.scale);\n\n    // No 'reason' provided since events are disabled.\n    block.moveTo(new Coordinate(finalOffset.x, finalOffset.y));\n  }\n}\n\n/**\n * A flyout content item.\n */\nexport interface FlyoutItem {\n  type: FlyoutItemType;\n  button?: FlyoutButton | undefined;\n  block?: BlockSvg | undefined;\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Horizontal flyout tray containing blocks which may be created.\n *\n * @class\n */\n// Former goog.module ID: Blockly.HorizontalFlyout\n\nimport * as browserEvents from './browser_events.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport {Flyout, FlyoutItem} from './flyout_base.js';\nimport type {FlyoutButton} from './flyout_button.js';\nimport type {Options} from './options.js';\nimport * as registry from './registry.js';\nimport {Scrollbar} from './scrollbar.js';\nimport type {Coordinate} from './utils/coordinate.js';\nimport {Rect} from './utils/rect.js';\nimport * as toolbox from './utils/toolbox.js';\nimport * as WidgetDiv from './widgetdiv.js';\n\n/**\n * Class for a flyout.\n */\nexport class HorizontalFlyout extends Flyout {\n  override horizontalLayout = true;\n\n  /** @param workspaceOptions Dictionary of options for the workspace. */\n  constructor(workspaceOptions: Options) {\n    super(workspaceOptions);\n  }\n\n  /**\n   * Sets the translation of the flyout to match the scrollbars.\n   *\n   * @param xyRatio Contains a y property which is a float between 0 and 1\n   *     specifying the degree of scrolling and a similar x property.\n   */\n  protected override setMetrics_(xyRatio: {x: number; y: number}) {\n    if (!this.isVisible()) {\n      return;\n    }\n\n    const metricsManager = this.workspace_.getMetricsManager();\n    const scrollMetrics = metricsManager.getScrollMetrics();\n    const viewMetrics = metricsManager.getViewMetrics();\n    const absoluteMetrics = metricsManager.getAbsoluteMetrics();\n\n    if (typeof xyRatio.x === 'number') {\n      this.workspace_.scrollX = -(\n        scrollMetrics.left +\n        (scrollMetrics.width - viewMetrics.width) * xyRatio.x\n      );\n    }\n\n    this.workspace_.translate(\n      this.workspace_.scrollX + absoluteMetrics.left,\n      this.workspace_.scrollY + absoluteMetrics.top,\n    );\n  }\n\n  /**\n   * Calculates the x coordinate for the flyout position.\n   *\n   * @returns X coordinate.\n   */\n  override getX(): number {\n    // X is always 0 since this is a horizontal flyout.\n    return 0;\n  }\n\n  /**\n   * Calculates the y coordinate for the flyout position.\n   *\n   * @returns Y coordinate.\n   */\n  override getY(): number {\n    if (!this.isVisible()) {\n      return 0;\n    }\n    const metricsManager = this.targetWorkspace!.getMetricsManager();\n    const absoluteMetrics = metricsManager.getAbsoluteMetrics();\n    const viewMetrics = metricsManager.getViewMetrics();\n    const toolboxMetrics = metricsManager.getToolboxMetrics();\n\n    let y = 0;\n    const atTop = this.toolboxPosition_ === toolbox.Position.TOP;\n    // If this flyout is not the trashcan flyout (e.g. toolbox or mutator).\n    // Trashcan flyout is opposite the main flyout.\n    if (this.targetWorkspace!.toolboxPosition === this.toolboxPosition_) {\n      // If there is a category toolbox.\n      // Simple (flyout-only) toolbox.\n      if (this.targetWorkspace!.getToolbox()) {\n        if (atTop) {\n          y = toolboxMetrics.height;\n        } else {\n          y = viewMetrics.height - this.height_;\n        }\n      } else {\n        if (atTop) {\n          y = 0;\n        } else {\n          // The simple flyout does not cover the workspace.\n          y = viewMetrics.height;\n        }\n      }\n    } else {\n      if (atTop) {\n        y = 0;\n      } else {\n        // Because the anchor point of the flyout is on the top, but we want\n        // to align the bottom edge of the flyout with the bottom edge of the\n        // blocklyDiv, we calculate the full height of the div minus the height\n        // of the flyout.\n        y = viewMetrics.height + absoluteMetrics.top - this.height_;\n      }\n    }\n\n    return y;\n  }\n\n  /** Move the flyout to the edge of the workspace. */\n  override position() {\n    if (!this.isVisible() || !this.targetWorkspace!.isVisible()) {\n      return;\n    }\n    const metricsManager = this.targetWorkspace!.getMetricsManager();\n    const targetWorkspaceViewMetrics = metricsManager.getViewMetrics();\n    this.width_ = targetWorkspaceViewMetrics.width;\n\n    const edgeWidth = targetWorkspaceViewMetrics.width - 2 * this.CORNER_RADIUS;\n    const edgeHeight = this.height_ - this.CORNER_RADIUS;\n    this.setBackgroundPath(edgeWidth, edgeHeight);\n\n    const x = this.getX();\n    const y = this.getY();\n\n    this.positionAt_(this.width_, this.height_, x, y);\n  }\n\n  /**\n   * Create and set the path for the visible boundaries of the flyout.\n   *\n   * @param width The width of the flyout, not including the rounded corners.\n   * @param height The height of the flyout, not including rounded corners.\n   */\n  private setBackgroundPath(width: number, height: number) {\n    const atTop = this.toolboxPosition_ === toolbox.Position.TOP;\n    // Start at top left.\n    const path: (string | number)[] = [\n      'M 0,' + (atTop ? 0 : this.CORNER_RADIUS),\n    ];\n\n    if (atTop) {\n      // Top.\n      path.push('h', width + 2 * this.CORNER_RADIUS);\n      // Right.\n      path.push('v', height);\n      // Bottom.\n      path.push(\n        'a',\n        this.CORNER_RADIUS,\n        this.CORNER_RADIUS,\n        0,\n        0,\n        1,\n        -this.CORNER_RADIUS,\n        this.CORNER_RADIUS,\n      );\n      path.push('h', -width);\n      // Left.\n      path.push(\n        'a',\n        this.CORNER_RADIUS,\n        this.CORNER_RADIUS,\n        0,\n        0,\n        1,\n        -this.CORNER_RADIUS,\n        -this.CORNER_RADIUS,\n      );\n      path.push('z');\n    } else {\n      // Top.\n      path.push(\n        'a',\n        this.CORNER_RADIUS,\n        this.CORNER_RADIUS,\n        0,\n        0,\n        1,\n        this.CORNER_RADIUS,\n        -this.CORNER_RADIUS,\n      );\n      path.push('h', width);\n      // Right.\n      path.push(\n        'a',\n        this.CORNER_RADIUS,\n        this.CORNER_RADIUS,\n        0,\n        0,\n        1,\n        this.CORNER_RADIUS,\n        this.CORNER_RADIUS,\n      );\n      path.push('v', height);\n      // Bottom.\n      path.push('h', -width - 2 * this.CORNER_RADIUS);\n      // Left.\n      path.push('z');\n    }\n    this.svgBackground_!.setAttribute('d', path.join(' '));\n  }\n\n  /** Scroll the flyout to the top. */\n  override scrollToStart() {\n    this.workspace_.scrollbar?.setX(this.RTL ? Infinity : 0);\n  }\n\n  /**\n   * Scroll the flyout.\n   *\n   * @param e Mouse wheel scroll event.\n   */\n  protected override wheel_(e: WheelEvent) {\n    const scrollDelta = browserEvents.getScrollDeltaPixels(e);\n    const delta = scrollDelta.x || scrollDelta.y;\n\n    if (delta) {\n      const metricsManager = this.workspace_.getMetricsManager();\n      const scrollMetrics = metricsManager.getScrollMetrics();\n      const viewMetrics = metricsManager.getViewMetrics();\n\n      const pos = viewMetrics.left - scrollMetrics.left + delta;\n      this.workspace_.scrollbar?.setX(pos);\n      // When the flyout moves from a wheel event, hide WidgetDiv and\n      // dropDownDiv.\n      WidgetDiv.hide();\n      dropDownDiv.hideWithoutAnimation();\n    }\n    // Don't scroll the page.\n    e.preventDefault();\n    // Don't propagate mousewheel event (zooming).\n    e.stopPropagation();\n  }\n\n  /**\n   * Lay out the blocks in the flyout.\n   *\n   * @param contents The blocks and buttons to lay out.\n   * @param gaps The visible gaps between blocks.\n   */\n  protected override layout_(contents: FlyoutItem[], gaps: number[]) {\n    this.workspace_.scale = this.targetWorkspace!.scale;\n    const margin = this.MARGIN;\n    let cursorX = margin + this.tabWidth_;\n    const cursorY = margin;\n    if (this.RTL) {\n      contents = contents.reverse();\n    }\n\n    for (let i = 0, item; (item = contents[i]); i++) {\n      if (item.type === 'block') {\n        const block = item.block;\n        const allBlocks = block!.getDescendants(false);\n        for (let j = 0, child; (child = allBlocks[j]); j++) {\n          // Mark blocks as being inside a flyout.  This is used to detect and\n          // prevent the closure of the flyout if the user right-clicks on such\n          // a block.\n          child.isInFlyout = true;\n        }\n        const root = block!.getSvgRoot();\n        const blockHW = block!.getHeightWidth();\n        // Figure out where to place the block.\n        const tab = block!.outputConnection ? this.tabWidth_ : 0;\n        let moveX;\n        if (this.RTL) {\n          moveX = cursorX + blockHW.width;\n        } else {\n          moveX = cursorX - tab;\n        }\n        block!.moveBy(moveX, cursorY);\n\n        const rect = this.createRect_(block!, moveX, cursorY, blockHW, i);\n        cursorX += blockHW.width + gaps[i];\n\n        this.addBlockListeners_(root, block!, rect);\n      } else if (item.type === 'button') {\n        const button = item.button as FlyoutButton;\n        this.initFlyoutButton_(button, cursorX, cursorY);\n        cursorX += button.width + gaps[i];\n      }\n    }\n  }\n\n  /**\n   * Determine if a drag delta is toward the workspace, based on the position\n   * and orientation of the flyout. This is used in determineDragIntention_ to\n   * determine if a new block should be created or if the flyout should scroll.\n   *\n   * @param currentDragDeltaXY How far the pointer has moved from the position\n   *     at mouse down, in pixel units.\n   * @returns True if the drag is toward the workspace.\n   * @internal\n   */\n  override isDragTowardWorkspace(currentDragDeltaXY: Coordinate): boolean {\n    const dx = currentDragDeltaXY.x;\n    const dy = currentDragDeltaXY.y;\n    // Direction goes from -180 to 180, with 0 toward the right and 90 on top.\n    const dragDirection = (Math.atan2(dy, dx) / Math.PI) * 180;\n\n    const range = this.dragAngleRange_;\n    // Check for up or down dragging.\n    if (\n      (dragDirection < 90 + range && dragDirection > 90 - range) ||\n      (dragDirection > -90 - range && dragDirection < -90 + range)\n    ) {\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Returns the bounding rectangle of the drag target area in pixel units\n   * relative to viewport.\n   *\n   * @returns The component's bounding box. Null if drag target area should be\n   *     ignored.\n   */\n  override getClientRect(): Rect | null {\n    if (!this.svgGroup_ || this.autoClose || !this.isVisible()) {\n      // The bounding rectangle won't compute correctly if the flyout is closed\n      // and auto-close flyouts aren't valid drag targets (or delete areas).\n      return null;\n    }\n\n    const flyoutRect = this.svgGroup_.getBoundingClientRect();\n    // BIG_NUM is offscreen padding so that blocks dragged beyond the shown\n    // flyout area are still deleted.  Must be larger than the largest screen\n    // size, but be smaller than half Number.MAX_SAFE_INTEGER (not available on\n    // IE).\n    const BIG_NUM = 1000000000;\n    const top = flyoutRect.top;\n\n    if (this.toolboxPosition_ === toolbox.Position.TOP) {\n      const height = flyoutRect.height;\n      return new Rect(-BIG_NUM, top + height, -BIG_NUM, BIG_NUM);\n    } else {\n      // Bottom.\n      return new Rect(top, BIG_NUM, -BIG_NUM, BIG_NUM);\n    }\n  }\n\n  /**\n   * Compute height of flyout.  toolbox.Position mat under each block.\n   * For RTL: Lay out the blocks right-aligned.\n   */\n  protected override reflowInternal_() {\n    this.workspace_.scale = this.getFlyoutScale();\n    let flyoutHeight = 0;\n    const blocks = this.workspace_.getTopBlocks(false);\n    for (let i = 0, block; (block = blocks[i]); i++) {\n      flyoutHeight = Math.max(flyoutHeight, block.getHeightWidth().height);\n    }\n    const buttons = this.buttons_;\n    for (let i = 0, button; (button = buttons[i]); i++) {\n      flyoutHeight = Math.max(flyoutHeight, button.height);\n    }\n    flyoutHeight += this.MARGIN * 1.5;\n    flyoutHeight *= this.workspace_.scale;\n    flyoutHeight += Scrollbar.scrollbarThickness;\n\n    if (this.height_ !== flyoutHeight) {\n      for (let i = 0, block; (block = blocks[i]); i++) {\n        if (this.rectMap_.has(block)) {\n          this.moveRectToBlock_(this.rectMap_.get(block)!, block);\n        }\n      }\n\n      // TODO(#7689): Remove this.\n      // Workspace with no scrollbars where this is permanently open on the top.\n      // If scrollbars exist they properly update the metrics.\n      if (\n        !this.targetWorkspace.scrollbar &&\n        !this.autoClose &&\n        this.targetWorkspace.getFlyout() === this &&\n        this.toolboxPosition_ === toolbox.Position.TOP\n      ) {\n        this.targetWorkspace.translate(\n          this.targetWorkspace.scrollX,\n          this.targetWorkspace.scrollY + flyoutHeight,\n        );\n      }\n\n      this.height_ = flyoutHeight;\n      this.position();\n      this.targetWorkspace.resizeContents();\n      this.targetWorkspace.recordDragTargets();\n    }\n  }\n}\n\nregistry.register(\n  registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX,\n  registry.DEFAULT,\n  HorizontalFlyout,\n);\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Layout code for a vertical variant of the flyout.\n *\n * @class\n */\n// Former goog.module ID: Blockly.VerticalFlyout\n\nimport * as browserEvents from './browser_events.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport {Flyout, FlyoutItem} from './flyout_base.js';\nimport type {FlyoutButton} from './flyout_button.js';\nimport type {Options} from './options.js';\nimport * as registry from './registry.js';\nimport {Scrollbar} from './scrollbar.js';\nimport type {Coordinate} from './utils/coordinate.js';\nimport {Rect} from './utils/rect.js';\nimport * as toolbox from './utils/toolbox.js';\nimport * as WidgetDiv from './widgetdiv.js';\n\n/**\n * Class for a flyout.\n */\nexport class VerticalFlyout extends Flyout {\n  /** The name of the vertical flyout in the registry. */\n  static registryName = 'verticalFlyout';\n\n  /** @param workspaceOptions Dictionary of options for the workspace. */\n  constructor(workspaceOptions: Options) {\n    super(workspaceOptions);\n  }\n\n  /**\n   * Sets the translation of the flyout to match the scrollbars.\n   *\n   * @param xyRatio Contains a y property which is a float between 0 and 1\n   *     specifying the degree of scrolling and a similar x property.\n   */\n  protected override setMetrics_(xyRatio: {x: number; y: number}) {\n    if (!this.isVisible()) {\n      return;\n    }\n    const metricsManager = this.workspace_.getMetricsManager();\n    const scrollMetrics = metricsManager.getScrollMetrics();\n    const viewMetrics = metricsManager.getViewMetrics();\n    const absoluteMetrics = metricsManager.getAbsoluteMetrics();\n\n    if (typeof xyRatio.y === 'number') {\n      this.workspace_.scrollY = -(\n        scrollMetrics.top +\n        (scrollMetrics.height - viewMetrics.height) * xyRatio.y\n      );\n    }\n    this.workspace_.translate(\n      this.workspace_.scrollX + absoluteMetrics.left,\n      this.workspace_.scrollY + absoluteMetrics.top,\n    );\n  }\n\n  /**\n   * Calculates the x coordinate for the flyout position.\n   *\n   * @returns X coordinate.\n   */\n  override getX(): number {\n    if (!this.isVisible()) {\n      return 0;\n    }\n    const metricsManager = this.targetWorkspace!.getMetricsManager();\n    const absoluteMetrics = metricsManager.getAbsoluteMetrics();\n    const viewMetrics = metricsManager.getViewMetrics();\n    const toolboxMetrics = metricsManager.getToolboxMetrics();\n    let x = 0;\n\n    // If this flyout is not the trashcan flyout (e.g. toolbox or mutator).\n    // Trashcan flyout is opposite the main flyout.\n    if (this.targetWorkspace!.toolboxPosition === this.toolboxPosition_) {\n      // If there is a category toolbox.\n      // Simple (flyout-only) toolbox.\n      if (this.targetWorkspace!.getToolbox()) {\n        if (this.toolboxPosition_ === toolbox.Position.LEFT) {\n          x = toolboxMetrics.width;\n        } else {\n          x = viewMetrics.width - this.width_;\n        }\n      } else {\n        if (this.toolboxPosition_ === toolbox.Position.LEFT) {\n          x = 0;\n        } else {\n          // The simple flyout does not cover the workspace.\n          x = viewMetrics.width;\n        }\n      }\n    } else {\n      if (this.toolboxPosition_ === toolbox.Position.LEFT) {\n        x = 0;\n      } else {\n        // Because the anchor point of the flyout is on the left, but we want\n        // to align the right edge of the flyout with the right edge of the\n        // blocklyDiv, we calculate the full width of the div minus the width\n        // of the flyout.\n        x = viewMetrics.width + absoluteMetrics.left - this.width_;\n      }\n    }\n\n    return x;\n  }\n\n  /**\n   * Calculates the y coordinate for the flyout position.\n   *\n   * @returns Y coordinate.\n   */\n  override getY(): number {\n    // Y is always 0 since this is a vertical flyout.\n    return 0;\n  }\n\n  /** Move the flyout to the edge of the workspace. */\n  override position() {\n    if (!this.isVisible() || !this.targetWorkspace!.isVisible()) {\n      return;\n    }\n    const metricsManager = this.targetWorkspace!.getMetricsManager();\n    const targetWorkspaceViewMetrics = metricsManager.getViewMetrics();\n    this.height_ = targetWorkspaceViewMetrics.height;\n\n    const edgeWidth = this.width_ - this.CORNER_RADIUS;\n    const edgeHeight =\n      targetWorkspaceViewMetrics.height - 2 * this.CORNER_RADIUS;\n    this.setBackgroundPath(edgeWidth, edgeHeight);\n\n    const x = this.getX();\n    const y = this.getY();\n\n    this.positionAt_(this.width_, this.height_, x, y);\n  }\n\n  /**\n   * Create and set the path for the visible boundaries of the flyout.\n   *\n   * @param width The width of the flyout, not including the rounded corners.\n   * @param height The height of the flyout, not including rounded corners.\n   */\n  private setBackgroundPath(width: number, height: number) {\n    const atRight = this.toolboxPosition_ === toolbox.Position.RIGHT;\n    const totalWidth = width + this.CORNER_RADIUS;\n\n    // Decide whether to start on the left or right.\n    const path: Array<string | number> = [\n      'M ' + (atRight ? totalWidth : 0) + ',0',\n    ];\n    // Top.\n    path.push('h', atRight ? -width : width);\n    // Rounded corner.\n    path.push(\n      'a',\n      this.CORNER_RADIUS,\n      this.CORNER_RADIUS,\n      0,\n      0,\n      atRight ? 0 : 1,\n      atRight ? -this.CORNER_RADIUS : this.CORNER_RADIUS,\n      this.CORNER_RADIUS,\n    );\n    // Side closest to workspace.\n    path.push('v', Math.max(0, height));\n    // Rounded corner.\n    path.push(\n      'a',\n      this.CORNER_RADIUS,\n      this.CORNER_RADIUS,\n      0,\n      0,\n      atRight ? 0 : 1,\n      atRight ? this.CORNER_RADIUS : -this.CORNER_RADIUS,\n      this.CORNER_RADIUS,\n    );\n    // Bottom.\n    path.push('h', atRight ? width : -width);\n    path.push('z');\n    this.svgBackground_!.setAttribute('d', path.join(' '));\n  }\n\n  /** Scroll the flyout to the top. */\n  override scrollToStart() {\n    this.workspace_.scrollbar?.setY(0);\n  }\n\n  /**\n   * Scroll the flyout.\n   *\n   * @param e Mouse wheel scroll event.\n   */\n  protected override wheel_(e: WheelEvent) {\n    const scrollDelta = browserEvents.getScrollDeltaPixels(e);\n\n    if (scrollDelta.y) {\n      const metricsManager = this.workspace_.getMetricsManager();\n      const scrollMetrics = metricsManager.getScrollMetrics();\n      const viewMetrics = metricsManager.getViewMetrics();\n      const pos = viewMetrics.top - scrollMetrics.top + scrollDelta.y;\n\n      this.workspace_.scrollbar?.setY(pos);\n      // When the flyout moves from a wheel event, hide WidgetDiv and\n      // dropDownDiv.\n      WidgetDiv.hide();\n      dropDownDiv.hideWithoutAnimation();\n    }\n    // Don't scroll the page.\n    e.preventDefault();\n    // Don't propagate mousewheel event (zooming).\n    e.stopPropagation();\n  }\n\n  /**\n   * Lay out the blocks in the flyout.\n   *\n   * @param contents The blocks and buttons to lay out.\n   * @param gaps The visible gaps between blocks.\n   */\n  protected override layout_(contents: FlyoutItem[], gaps: number[]) {\n    this.workspace_.scale = this.targetWorkspace!.scale;\n    const margin = this.MARGIN;\n    const cursorX = this.RTL ? margin : margin + this.tabWidth_;\n    let cursorY = margin;\n\n    for (let i = 0, item; (item = contents[i]); i++) {\n      if (item.type === 'block') {\n        const block = item.block;\n        const allBlocks = block!.getDescendants(false);\n        for (let j = 0, child; (child = allBlocks[j]); j++) {\n          // Mark blocks as being inside a flyout.  This is used to detect and\n          // prevent the closure of the flyout if the user right-clicks on such\n          // a block.\n          child.isInFlyout = true;\n        }\n        const root = block!.getSvgRoot();\n        const blockHW = block!.getHeightWidth();\n        const moveX = block!.outputConnection\n          ? cursorX - this.tabWidth_\n          : cursorX;\n        block!.moveBy(moveX, cursorY);\n\n        const rect = this.createRect_(\n          block!,\n          this.RTL ? moveX - blockHW.width : moveX,\n          cursorY,\n          blockHW,\n          i,\n        );\n\n        this.addBlockListeners_(root, block!, rect);\n\n        cursorY += blockHW.height + gaps[i];\n      } else if (item.type === 'button') {\n        const button = item.button as FlyoutButton;\n        this.initFlyoutButton_(button, cursorX, cursorY);\n        cursorY += button.height + gaps[i];\n      }\n    }\n  }\n\n  /**\n   * Determine if a drag delta is toward the workspace, based on the position\n   * and orientation of the flyout. This is used in determineDragIntention_ to\n   * determine if a new block should be created or if the flyout should scroll.\n   *\n   * @param currentDragDeltaXY How far the pointer has moved from the position\n   *     at mouse down, in pixel units.\n   * @returns True if the drag is toward the workspace.\n   * @internal\n   */\n  override isDragTowardWorkspace(currentDragDeltaXY: Coordinate): boolean {\n    const dx = currentDragDeltaXY.x;\n    const dy = currentDragDeltaXY.y;\n    // Direction goes from -180 to 180, with 0 toward the right and 90 on top.\n    const dragDirection = (Math.atan2(dy, dx) / Math.PI) * 180;\n\n    const range = this.dragAngleRange_;\n    // Check for left or right dragging.\n    if (\n      (dragDirection < range && dragDirection > -range) ||\n      dragDirection < -180 + range ||\n      dragDirection > 180 - range\n    ) {\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Returns the bounding rectangle of the drag target area in pixel units\n   * relative to viewport.\n   *\n   * @returns The component's bounding box. Null if drag target area should be\n   *     ignored.\n   */\n  override getClientRect(): Rect | null {\n    if (!this.svgGroup_ || this.autoClose || !this.isVisible()) {\n      // The bounding rectangle won't compute correctly if the flyout is closed\n      // and auto-close flyouts aren't valid drag targets (or delete areas).\n      return null;\n    }\n\n    const flyoutRect = this.svgGroup_.getBoundingClientRect();\n    // BIG_NUM is offscreen padding so that blocks dragged beyond the shown\n    // flyout area are still deleted.  Must be larger than the largest screen\n    // size, but be smaller than half Number.MAX_SAFE_INTEGER (not available on\n    // IE).\n    const BIG_NUM = 1000000000;\n    const left = flyoutRect.left;\n\n    if (this.toolboxPosition_ === toolbox.Position.LEFT) {\n      const width = flyoutRect.width;\n      return new Rect(-BIG_NUM, BIG_NUM, -BIG_NUM, left + width);\n    } else {\n      // Right\n      return new Rect(-BIG_NUM, BIG_NUM, left, BIG_NUM);\n    }\n  }\n\n  /**\n   * Compute width of flyout.  toolbox.Position mat under each block.\n   * For RTL: Lay out the blocks and buttons to be right-aligned.\n   */\n  protected override reflowInternal_() {\n    this.workspace_.scale = this.getFlyoutScale();\n    let flyoutWidth = 0;\n    const blocks = this.workspace_.getTopBlocks(false);\n    for (let i = 0, block; (block = blocks[i]); i++) {\n      let width = block.getHeightWidth().width;\n      if (block.outputConnection) {\n        width -= this.tabWidth_;\n      }\n      flyoutWidth = Math.max(flyoutWidth, width);\n    }\n    for (let i = 0, button; (button = this.buttons_[i]); i++) {\n      flyoutWidth = Math.max(flyoutWidth, button.width);\n    }\n    flyoutWidth += this.MARGIN * 1.5 + this.tabWidth_;\n    flyoutWidth *= this.workspace_.scale;\n    flyoutWidth += Scrollbar.scrollbarThickness;\n\n    if (this.width_ !== flyoutWidth) {\n      for (let i = 0, block; (block = blocks[i]); i++) {\n        if (this.RTL) {\n          // With the flyoutWidth known, right-align the blocks.\n          const oldX = block.getRelativeToSurfaceXY().x;\n          let newX = flyoutWidth / this.workspace_.scale - this.MARGIN;\n          if (!block.outputConnection) {\n            newX -= this.tabWidth_;\n          }\n          block.moveBy(newX - oldX, 0);\n        }\n        if (this.rectMap_.has(block)) {\n          this.moveRectToBlock_(this.rectMap_.get(block)!, block);\n        }\n      }\n      if (this.RTL) {\n        // With the flyoutWidth known, right-align the buttons.\n        for (let i = 0, button; (button = this.buttons_[i]); i++) {\n          const y = button.getPosition().y;\n          const x =\n            flyoutWidth / this.workspace_.scale -\n            button.width -\n            this.MARGIN -\n            this.tabWidth_;\n          button.moveTo(x, y);\n        }\n      }\n\n      // TODO(#7689): Remove this.\n      // Workspace with no scrollbars where this is permanently\n      // open on the left.\n      // If scrollbars exist they properly update the metrics.\n      if (\n        !this.targetWorkspace.scrollbar &&\n        !this.autoClose &&\n        this.targetWorkspace.getFlyout() === this &&\n        this.toolboxPosition_ === toolbox.Position.LEFT\n      ) {\n        this.targetWorkspace.translate(\n          this.targetWorkspace.scrollX + flyoutWidth,\n          this.targetWorkspace.scrollY,\n        );\n      }\n\n      this.width_ = flyoutWidth;\n      this.position();\n      this.targetWorkspace.resizeContents();\n      this.targetWorkspace.recordDragTargets();\n    }\n  }\n}\n\nregistry.register(\n  registry.Type.FLYOUTS_VERTICAL_TOOLBOX,\n  registry.DEFAULT,\n  VerticalFlyout,\n);\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Utility functions for generating executable code from\n * Blockly code.\n *\n * @class\n */\n// Former goog.module ID: Blockly.CodeGenerator\n\nimport type {Block} from './block.js';\nimport * as common from './common.js';\nimport {Names, NameType} from './names.js';\nimport type {Workspace} from './workspace.js';\nimport {warn} from './utils/deprecation.js';\n\n/**\n * Deprecated, no-longer used type declaration for per-block-type generator\n * functions.\n *\n * @deprecated\n * @see {@link https://developers.google.com/blockly/guides/create-custom-blocks/generating-code}\n * @param block The Block instance to generate code for.\n * @param genearator The CodeGenerator calling the function.\n * @returns A string containing the generated code (for statement blocks),\n *     or a [code, precedence] tuple (for value/expression blocks), or\n *     null if no code should be emitted for block.\n */\nexport type BlockGenerator = (\n  block: Block,\n  generator: CodeGenerator,\n) => [string, number] | string | null;\n\n/**\n * Class for a code generator that translates the blocks into a language.\n */\nexport class CodeGenerator {\n  name_: string;\n\n  /**\n   * A dictionary of block generator functions, keyed by block type.\n   * Each block generator function takes two parameters:\n   *\n   * - the Block to generate code for, and\n   * - the calling CodeGenerator (or subclass) instance, so the\n   *   function can call methods defined below (e.g. blockToCode) or\n   *   on the relevant subclass (e.g. JavascripGenerator),\n   *\n   * and returns:\n   *\n   * - a [code, precedence] tuple (for value/expression blocks), or\n   * - a string containing the generated code (for statement blocks), or\n   * - null if no code should be emitted for block.\n   */\n  forBlock: Record<\n    string,\n    (block: Block, generator: this) => [string, number] | string | null\n  > = Object.create(null);\n\n  /**\n   * This is used as a placeholder in functions defined using\n   * CodeGenerator.provideFunction_.  It must not be legal code that could\n   * legitimately appear in a function definition (or comment), and it must\n   * not confuse the regular expression parser.\n   */\n  FUNCTION_NAME_PLACEHOLDER_ = '{leCUI8hutHZI4480Dc}';\n  FUNCTION_NAME_PLACEHOLDER_REGEXP_: RegExp;\n\n  /**\n   * Arbitrary code to inject into locations that risk causing infinite loops.\n   * Any instances of '%1' will be replaced by the block ID that failed.\n   * E.g. `  checkTimeout(%1);\\n`\n   */\n  INFINITE_LOOP_TRAP: string | null = null;\n\n  /**\n   * Arbitrary code to inject before every statement.\n   * Any instances of '%1' will be replaced by the block ID of the statement.\n   * E.g. `highlight(%1);\\n`\n   */\n  STATEMENT_PREFIX: string | null = null;\n\n  /**\n   * Arbitrary code to inject after every statement.\n   * Any instances of '%1' will be replaced by the block ID of the statement.\n   * E.g. `highlight(%1);\\n`\n   */\n  STATEMENT_SUFFIX: string | null = null;\n\n  /**\n   * The method of indenting.  Defaults to two spaces, but language generators\n   * may override this to increase indent or change to tabs.\n   */\n  INDENT = '  ';\n\n  /**\n   * Maximum length for a comment before wrapping.  Does not account for\n   * indenting level.\n   */\n  COMMENT_WRAP = 60;\n\n  /** List of outer-inner pairings that do NOT require parentheses. */\n  ORDER_OVERRIDES: number[][] = [];\n\n  /**\n   * Whether the init method has been called.\n   * Generators that set this flag to false after creation and true in init\n   * will cause blockToCode to emit a warning if the generator has not been\n   * initialized. If this flag is untouched, it will have no effect.\n   */\n  isInitialized: boolean | null = null;\n\n  /** Comma-separated list of reserved words. */\n  protected RESERVED_WORDS_ = '';\n\n  /** A dictionary of definitions to be printed before the code. */\n  protected definitions_: {[key: string]: string} = Object.create(null);\n\n  /**\n   * A dictionary mapping desired function names in definitions_ to actual\n   * function names (to avoid collisions with user functions).\n   */\n  protected functionNames_: {[key: string]: string} = Object.create(null);\n\n  /** A database of variable and procedure names. */\n  nameDB_?: Names = undefined;\n\n  /** @param name Language name of this generator. */\n  constructor(name: string) {\n    this.name_ = name;\n\n    this.FUNCTION_NAME_PLACEHOLDER_REGEXP_ = new RegExp(\n      this.FUNCTION_NAME_PLACEHOLDER_,\n      'g',\n    );\n  }\n\n  /**\n   * Generate code for all blocks in the workspace to the specified language.\n   *\n   * @param workspace Workspace to generate code from.\n   * @returns Generated code.\n   */\n  workspaceToCode(workspace?: Workspace): string {\n    if (!workspace) {\n      // Backwards compatibility from before there could be multiple workspaces.\n      console.warn(\n        'No workspace specified in workspaceToCode call.  Guessing.',\n      );\n      workspace = common.getMainWorkspace();\n    }\n    const code = [];\n    this.init(workspace);\n    const blocks = workspace.getTopBlocks(true);\n    for (let i = 0, block; (block = blocks[i]); i++) {\n      let line = this.blockToCode(block);\n      if (Array.isArray(line)) {\n        // Value blocks return tuples of code and operator order.\n        // Top-level blocks don't care about operator order.\n        line = line[0];\n      }\n      if (line) {\n        if (block.outputConnection) {\n          // This block is a naked value.  Ask the language's code generator if\n          // it wants to append a semicolon, or something.\n          line = this.scrubNakedValue(line);\n          if (this.STATEMENT_PREFIX && !block.suppressPrefixSuffix) {\n            line = this.injectId(this.STATEMENT_PREFIX, block) + line;\n          }\n          if (this.STATEMENT_SUFFIX && !block.suppressPrefixSuffix) {\n            line = line + this.injectId(this.STATEMENT_SUFFIX, block);\n          }\n        }\n        code.push(line);\n      }\n    }\n    // Blank line between each section.\n    let codeString = code.join('\\n');\n    codeString = this.finish(codeString);\n    // Final scrubbing of whitespace.\n    codeString = codeString.replace(/^\\s+\\n/, '');\n    codeString = codeString.replace(/\\n\\s+$/, '\\n');\n    codeString = codeString.replace(/[ \\t]+\\n/g, '\\n');\n    return codeString;\n  }\n\n  /**\n   * Prepend a common prefix onto each line of code.\n   * Intended for indenting code or adding comment markers.\n   *\n   * @param text The lines of code.\n   * @param prefix The common prefix.\n   * @returns The prefixed lines of code.\n   */\n  prefixLines(text: string, prefix: string): string {\n    return prefix + text.replace(/(?!\\n$)\\n/g, '\\n' + prefix);\n  }\n\n  /**\n   * Recursively spider a tree of blocks, returning all their comments.\n   *\n   * @param block The block from which to start spidering.\n   * @returns Concatenated list of comments.\n   */\n  allNestedComments(block: Block): string {\n    const comments = [];\n    const blocks = block.getDescendants(true);\n    for (let i = 0; i < blocks.length; i++) {\n      const comment = blocks[i].getCommentText();\n      if (comment) {\n        comments.push(comment);\n      }\n    }\n    // Append an empty string to create a trailing line break when joined.\n    if (comments.length) {\n      comments.push('');\n    }\n    return comments.join('\\n');\n  }\n\n  /**\n   * Generate code for the specified block (and attached blocks).\n   * The generator must be initialized before calling this function.\n   *\n   * @param block The block to generate code for.\n   * @param opt_thisOnly True to generate code for only this statement.\n   * @returns For statement blocks, the generated code.\n   *     For value blocks, an array containing the generated code and an\n   * operator order value.  Returns '' if block is null.\n   */\n  blockToCode(\n    block: Block | null,\n    opt_thisOnly?: boolean,\n  ): string | [string, number] {\n    if (this.isInitialized === false) {\n      console.warn(\n        'CodeGenerator init was not called before blockToCode was called.',\n      );\n    }\n    if (!block) {\n      return '';\n    }\n    if (!block.isEnabled()) {\n      // Skip past this block if it is disabled.\n      return opt_thisOnly ? '' : this.blockToCode(block.getNextBlock());\n    }\n    if (block.isInsertionMarker()) {\n      // Skip past insertion markers.\n      return opt_thisOnly ? '' : this.blockToCode(block.getChildren(false)[0]);\n    }\n\n    // Look up block generator function in dictionary - but fall back\n    // to looking up on this if not found, for backwards compatibility.\n    let func = this.forBlock[block.type];\n    if (!func && (this as any)[block.type]) {\n      warn(\n        'block generator functions on CodeGenerator objects',\n        '10.0',\n        '11.0',\n        'the .forBlock[blockType] dictionary',\n      );\n      func = (this as any)[block.type];\n    }\n    if (typeof func !== 'function') {\n      throw Error(\n        `${this.name_} generator does not know how to generate code ` +\n          `for block type \"${block.type}\".`,\n      );\n    }\n    // First argument to func.call is the value of 'this' in the generator.\n    // Prior to 24 September 2013 'this' was the only way to access the block.\n    // The current preferred method of accessing the block is through the second\n    // argument to func.call, which becomes the first parameter to the\n    // generator.\n    let code = func.call(block, block, this);\n    if (Array.isArray(code)) {\n      // Value blocks return tuples of code and operator order.\n      if (!block.outputConnection) {\n        throw TypeError('Expecting string from statement block: ' + block.type);\n      }\n      return [this.scrub_(block, code[0], opt_thisOnly), code[1]];\n    } else if (typeof code === 'string') {\n      if (this.STATEMENT_PREFIX && !block.suppressPrefixSuffix) {\n        code = this.injectId(this.STATEMENT_PREFIX, block) + code;\n      }\n      if (this.STATEMENT_SUFFIX && !block.suppressPrefixSuffix) {\n        code = code + this.injectId(this.STATEMENT_SUFFIX, block);\n      }\n      return this.scrub_(block, code, opt_thisOnly);\n    } else if (code === null) {\n      // Block has handled code generation itself.\n      return '';\n    }\n    throw SyntaxError('Invalid code generated: ' + code);\n  }\n\n  /**\n   * Generate code representing the specified value input.\n   *\n   * @param block The block containing the input.\n   * @param name The name of the input.\n   * @param outerOrder The maximum binding strength (minimum order value) of any\n   *     operators adjacent to \"block\".\n   * @returns Generated code or '' if no blocks are connected or the specified\n   *     input does not exist.\n   */\n  valueToCode(block: Block, name: string, outerOrder: number): string {\n    if (isNaN(outerOrder)) {\n      throw TypeError('Expecting valid order from block: ' + block.type);\n    }\n    const targetBlock = block.getInputTargetBlock(name);\n    if (!targetBlock) {\n      return '';\n    }\n    const tuple = this.blockToCode(targetBlock);\n    if (tuple === '') {\n      // Disabled block.\n      return '';\n    }\n    // Value blocks must return code and order of operations info.\n    // Statement blocks must only return code.\n    if (!Array.isArray(tuple)) {\n      throw TypeError(\n        `Expecting tuple from value block: ${targetBlock.type} See ` +\n          `developers.google.com/blockly/guides/create-custom-blocks/generating-code ` +\n          `for more information`,\n      );\n    }\n    let code = tuple[0];\n    const innerOrder = tuple[1];\n    if (isNaN(innerOrder)) {\n      throw TypeError(\n        'Expecting valid order from value block: ' + targetBlock.type,\n      );\n    }\n    if (!code) {\n      return '';\n    }\n\n    // Add parentheses if needed.\n    let parensNeeded = false;\n    const outerOrderClass = Math.floor(outerOrder);\n    const innerOrderClass = Math.floor(innerOrder);\n    if (outerOrderClass <= innerOrderClass) {\n      if (\n        outerOrderClass === innerOrderClass &&\n        (outerOrderClass === 0 || outerOrderClass === 99)\n      ) {\n        // Don't generate parens around NONE-NONE and ATOMIC-ATOMIC pairs.\n        // 0 is the atomic order, 99 is the none order.  No parentheses needed.\n        // In all known languages multiple such code blocks are not order\n        // sensitive.  In fact in Python ('a' 'b') 'c' would fail.\n      } else {\n        // The operators outside this code are stronger than the operators\n        // inside this code.  To prevent the code from being pulled apart,\n        // wrap the code in parentheses.\n        parensNeeded = true;\n        // Check for special exceptions.\n        for (let i = 0; i < this.ORDER_OVERRIDES.length; i++) {\n          if (\n            this.ORDER_OVERRIDES[i][0] === outerOrder &&\n            this.ORDER_OVERRIDES[i][1] === innerOrder\n          ) {\n            parensNeeded = false;\n            break;\n          }\n        }\n      }\n    }\n    if (parensNeeded) {\n      // Technically, this should be handled on a language-by-language basis.\n      // However all known (sane) languages use parentheses for grouping.\n      code = '(' + code + ')';\n    }\n    return code;\n  }\n\n  /**\n   * Generate a code string representing the blocks attached to the named\n   * statement input. Indent the code.\n   * This is mainly used in generators. When trying to generate code to evaluate\n   * look at using workspaceToCode or blockToCode.\n   *\n   * @param block The block containing the input.\n   * @param name The name of the input.\n   * @returns Generated code or '' if no blocks are connected.\n   */\n  statementToCode(block: Block, name: string): string {\n    const targetBlock = block.getInputTargetBlock(name);\n    let code = this.blockToCode(targetBlock);\n    // Value blocks must return code and order of operations info.\n    // Statement blocks must only return code.\n    if (typeof code !== 'string') {\n      throw TypeError(\n        'Expecting code from statement block: ' +\n          (targetBlock && targetBlock.type),\n      );\n    }\n    if (code) {\n      code = this.prefixLines(code, this.INDENT);\n    }\n    return code;\n  }\n\n  /**\n   * Add an infinite loop trap to the contents of a loop.\n   * Add statement suffix at the start of the loop block (right after the loop\n   * statement executes), and a statement prefix to the end of the loop block\n   * (right before the loop statement executes).\n   *\n   * @param branch Code for loop contents.\n   * @param block Enclosing block.\n   * @returns Loop contents, with infinite loop trap added.\n   */\n  addLoopTrap(branch: string, block: Block): string {\n    if (this.INFINITE_LOOP_TRAP) {\n      branch =\n        this.prefixLines(\n          this.injectId(this.INFINITE_LOOP_TRAP, block),\n          this.INDENT,\n        ) + branch;\n    }\n    if (this.STATEMENT_SUFFIX && !block.suppressPrefixSuffix) {\n      branch =\n        this.prefixLines(\n          this.injectId(this.STATEMENT_SUFFIX, block),\n          this.INDENT,\n        ) + branch;\n    }\n    if (this.STATEMENT_PREFIX && !block.suppressPrefixSuffix) {\n      branch =\n        branch +\n        this.prefixLines(\n          this.injectId(this.STATEMENT_PREFIX, block),\n          this.INDENT,\n        );\n    }\n    return branch;\n  }\n\n  /**\n   * Inject a block ID into a message to replace '%1'.\n   * Used for STATEMENT_PREFIX, STATEMENT_SUFFIX, and INFINITE_LOOP_TRAP.\n   *\n   * @param msg Code snippet with '%1'.\n   * @param block Block which has an ID.\n   * @returns Code snippet with ID.\n   */\n  injectId(msg: string, block: Block): string {\n    const id = block.id.replace(/\\$/g, '$$$$'); // Issue 251.\n    return msg.replace(/%1/g, \"'\" + id + \"'\");\n  }\n\n  /**\n   * Add one or more words to the list of reserved words for this language.\n   *\n   * @param words Comma-separated list of words to add to the list.\n   *     No spaces.  Duplicates are ok.\n   */\n  addReservedWords(words: string) {\n    this.RESERVED_WORDS_ += words + ',';\n  }\n\n  /**\n   * Define a developer-defined function (not a user-defined procedure) to be\n   * included in the generated code.  Used for creating private helper\n   * functions. The first time this is called with a given desiredName, the code\n   * is saved and an actual name is generated.  Subsequent calls with the same\n   * desiredName have no effect but have the same return value.\n   *\n   * It is up to the caller to make sure the same desiredName is not\n   * used for different helper functions (e.g. use \"colourRandom\" and\n   * \"listRandom\", not \"random\").  There is no danger of colliding with reserved\n   * words, or user-defined variable or procedure names.\n   *\n   * The code gets output when CodeGenerator.finish() is called.\n   *\n   * @param desiredName The desired name of the function (e.g. mathIsPrime).\n   * @param code A list of statements or one multi-line code string.  Use '  '\n   *     for indents (they will be replaced).\n   * @returns The actual name of the new function.  This may differ from\n   *     desiredName if the former has already been taken by the user.\n   */\n  provideFunction_(desiredName: string, code: string[] | string): string {\n    if (!this.definitions_[desiredName]) {\n      const functionName = this.nameDB_!.getDistinctName(\n        desiredName,\n        NameType.PROCEDURE,\n      );\n      this.functionNames_[desiredName] = functionName;\n      if (Array.isArray(code)) {\n        code = code.join('\\n');\n      }\n      let codeText = code\n        .trim()\n        .replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_, functionName);\n      // Change all '  ' indents into the desired indent.\n      // To avoid an infinite loop of replacements, change all indents to '\\0'\n      // character first, then replace them all with the indent.\n      // We are assuming that no provided functions contain a literal null char.\n      let oldCodeText;\n      while (oldCodeText !== codeText) {\n        oldCodeText = codeText;\n        codeText = codeText.replace(/^(( {2})*) {2}/gm, '$1\\0');\n      }\n      codeText = codeText.replace(/\\0/g, this.INDENT);\n      this.definitions_[desiredName] = codeText;\n    }\n    return this.functionNames_[desiredName];\n  }\n\n  /**\n   * Gets a unique, legal name for a user-defined variable.\n   * Before calling this method, the `nameDB_` property of the class\n   * must have been initialized already. This is typically done in\n   * the `init` function of the code generator class.\n   *\n   * @param nameOrId The ID of the variable to get a name for,\n   *    or the proposed name for a variable not associated with an id.\n   * @returns A unique, legal name for the variable.\n   */\n  getVariableName(nameOrId: string): string {\n    return this.getName(nameOrId, NameType.VARIABLE);\n  }\n\n  /**\n   * Gets a unique, legal name for a user-defined procedure.\n   * Before calling this method, the `nameDB_` property of the class\n   * must have been initialized already. This is typically done in\n   * the `init` function of the code generator class.\n   *\n   * @param name The proposed name for a procedure.\n   * @returns A unique, legal name for the procedure.\n   */\n  getProcedureName(name: string): string {\n    return this.getName(name, NameType.PROCEDURE);\n  }\n\n  private getName(nameOrId: string, type: NameType): string {\n    if (!this.nameDB_) {\n      throw new Error(\n        'Name database is not defined. You must initialize `nameDB_` in your generator class and call `init` first.',\n      );\n    }\n    return this.nameDB_.getName(nameOrId, type);\n  }\n\n  /**\n   * Hook for code to run before code generation starts.\n   * Subclasses may override this, e.g. to initialise the database of variable\n   * names.\n   *\n   * @param _workspace Workspace to generate code from.\n   */\n  init(_workspace: Workspace) {\n    // Optionally override\n    // Create a dictionary of definitions to be printed before the code.\n    this.definitions_ = Object.create(null);\n    // Create a dictionary mapping desired developer-defined function names in\n    // definitions_ to actual function names (to avoid collisions with\n    // user-defined procedures).\n    this.functionNames_ = Object.create(null);\n  }\n\n  /**\n   * Common tasks for generating code from blocks.  This is called from\n   * blockToCode and is called on every block, not just top level blocks.\n   * Subclasses may override this, e.g. to generate code for statements\n   * following the block, or to handle comments for the specified block and any\n   * connected value blocks.\n   *\n   * @param _block The current block.\n   * @param code The code created for this block.\n   * @param _opt_thisOnly True to generate code for only this statement.\n   * @returns Code with comments and subsequent blocks added.\n   */\n  protected scrub_(\n    _block: Block,\n    code: string,\n    _opt_thisOnly?: boolean,\n  ): string {\n    // Optionally override\n    return code;\n  }\n\n  /**\n   * Hook for code to run at end of code generation.\n   * Subclasses may override this, e.g. to prepend the generated code with\n   * import statements or variable definitions.\n   *\n   * @param code Generated code.\n   * @returns Completed code.\n   */\n  finish(code: string): string {\n    // Optionally override\n    // Clean up temporary data.\n    this.definitions_ = Object.create(null);\n    this.functionNames_ = Object.create(null);\n    return code;\n  }\n\n  /**\n   * Naked values are top-level blocks with outputs that aren't plugged into\n   * anything.\n   * Subclasses may override this, e.g. if their language does not allow\n   * naked values.\n   *\n   * @param line Line of generated code.\n   * @returns Legal line of code.\n   */\n  scrubNakedValue(line: string): string {\n    // Optionally override\n    return line;\n  }\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {Align} from './inputs/align.js';\nimport {Input} from './inputs/input.js';\nimport {DummyInput} from './inputs/dummy_input.js';\nimport {EndRowInput} from './inputs/end_row_input.js';\nimport {StatementInput} from './inputs/statement_input.js';\nimport {ValueInput} from './inputs/value_input.js';\nimport {inputTypes} from './inputs/input_types.js';\n\nexport {\n  Align,\n  Input,\n  DummyInput,\n  EndRowInput,\n  StatementInput,\n  ValueInput,\n  inputTypes,\n};\n","/**\n * @license\n * Copyright 2024 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {BlockSvg} from '../block_svg.js';\nimport {IConnectionPreviewer} from '../interfaces/i_connection_previewer.js';\nimport {RenderedConnection} from '../rendered_connection.js';\nimport {WorkspaceSvg} from '../workspace_svg.js';\nimport * as eventUtils from '../events/utils.js';\nimport * as constants from '../constants.js';\nimport * as renderManagement from '../render_management.js';\nimport * as registry from '../registry.js';\nimport {Renderer as ZelosRenderer} from '../renderers/zelos/renderer.js';\nimport {ConnectionType} from '../connection_type.js';\n\n/**\n * An error message to throw if the block created by createMarkerBlock_ is\n * missing any components.\n */\nconst DUPLICATE_BLOCK_ERROR =\n  'The insertion marker previewer tried to create a marker but the result ' +\n  'is missing %1. If you are using a mutator, make sure your domToMutation ' +\n  'method is properly defined.';\n\nexport class InsertionMarkerPreviewer implements IConnectionPreviewer {\n  private readonly workspace: WorkspaceSvg;\n\n  private fadedBlock: BlockSvg | null = null;\n\n  private markerConn: RenderedConnection | null = null;\n\n  private draggedConn: RenderedConnection | null = null;\n\n  private staticConn: RenderedConnection | null = null;\n\n  constructor(draggedBlock: BlockSvg) {\n    this.workspace = draggedBlock.workspace;\n  }\n\n  /**\n   * Display a connection preview where the draggedCon connects to the\n   * staticCon, replacing the replacedBlock (currently connected to the\n   * staticCon).\n   *\n   * @param draggedConn The connection on the block stack being dragged.\n   * @param staticConn The connection not being dragged that we are\n   *     connecting to.\n   * @param replacedBlock The block currently connected to the staticCon that\n   *     is being replaced.\n   */\n  previewReplacement(\n    draggedConn: RenderedConnection,\n    staticConn: RenderedConnection,\n    replacedBlock: BlockSvg,\n  ) {\n    eventUtils.disable();\n    try {\n      this.hidePreview();\n      this.fadedBlock = replacedBlock;\n      replacedBlock.fadeForReplacement(true);\n      if (this.workspace.getRenderer().shouldHighlightConnection(staticConn)) {\n        staticConn.highlight();\n        this.staticConn = staticConn;\n      }\n    } finally {\n      eventUtils.enable();\n    }\n  }\n\n  /**\n   * Display a connection preview where the draggedCon connects to the\n   * staticCon, and no block is being relaced.\n   *\n   * @param draggedConn The connection on the block stack being dragged.\n   * @param staticConn The connection not being dragged that we are\n   *     connecting to.\n   */\n  previewConnection(\n    draggedConn: RenderedConnection,\n    staticConn: RenderedConnection,\n  ) {\n    if (draggedConn === this.draggedConn && staticConn === this.staticConn) {\n      return;\n    }\n\n    eventUtils.disable();\n    try {\n      this.hidePreview();\n\n      // TODO(7898): Instead of special casing, we should change the dragger to\n      //   track the change in distance between the dragged connection and the\n      //   static connection, so that it doesn't disconnect  unless that\n      //   (+ a bit) has been exceeded.\n      if (this.shouldUseMarkerPreview(draggedConn, staticConn)) {\n        this.markerConn = this.previewMarker(draggedConn, staticConn);\n      }\n\n      if (this.workspace.getRenderer().shouldHighlightConnection(staticConn)) {\n        staticConn.highlight();\n      }\n\n      this.draggedConn = draggedConn;\n      this.staticConn = staticConn;\n    } finally {\n      eventUtils.enable();\n    }\n  }\n\n  private shouldUseMarkerPreview(\n    _draggedConn: RenderedConnection,\n    staticConn: RenderedConnection,\n  ): boolean {\n    return (\n      staticConn.type === ConnectionType.PREVIOUS_STATEMENT ||\n      staticConn.type === ConnectionType.NEXT_STATEMENT ||\n      !(this.workspace.getRenderer() instanceof ZelosRenderer)\n    );\n  }\n\n  private previewMarker(\n    draggedConn: RenderedConnection,\n    staticConn: RenderedConnection,\n  ): RenderedConnection {\n    const dragged = draggedConn.getSourceBlock();\n    const marker = this.createInsertionMarker(dragged);\n    const markerConn = this.getMatchingConnection(dragged, marker, draggedConn);\n    if (!markerConn) {\n      throw Error('Could not create insertion marker to preview connection');\n    }\n\n    // Render disconnected from everything else so that we have a valid\n    // connection location.\n    marker.queueRender();\n    renderManagement.triggerQueuedRenders();\n\n    // Connect() also renders the insertion marker.\n    markerConn.connect(staticConn);\n\n    const originalOffsetToTarget = {\n      x: staticConn.x - markerConn.x,\n      y: staticConn.y - markerConn.y,\n    };\n    const originalOffsetInBlock = markerConn.getOffsetInBlock().clone();\n    renderManagement.finishQueuedRenders().then(() => {\n      // Position so that the existing block doesn't move.\n      marker?.positionNearConnection(\n        markerConn,\n        originalOffsetToTarget,\n        originalOffsetInBlock,\n      );\n      marker?.getSvgRoot().setAttribute('visibility', 'visible');\n    });\n    return markerConn;\n  }\n\n  private createInsertionMarker(origBlock: BlockSvg) {\n    const result = this.workspace.newBlock(origBlock.type);\n    result.setInsertionMarker(true);\n    if (origBlock.saveExtraState) {\n      const state = origBlock.saveExtraState(true);\n      if (state && result.loadExtraState) {\n        result.loadExtraState(state);\n      }\n    } else if (origBlock.mutationToDom) {\n      const oldMutationDom = origBlock.mutationToDom();\n      if (oldMutationDom && result.domToMutation) {\n        result.domToMutation(oldMutationDom);\n      }\n    }\n    // Copy field values from the other block.  These values may impact the\n    // rendered size of the insertion marker.  Note that we do not care about\n    // child blocks here.\n    for (let i = 0; i < origBlock.inputList.length; i++) {\n      const sourceInput = origBlock.inputList[i];\n      if (sourceInput.name === constants.COLLAPSED_INPUT_NAME) {\n        continue; // Ignore the collapsed input.\n      }\n      const resultInput = result.inputList[i];\n      if (!resultInput) {\n        throw new Error(DUPLICATE_BLOCK_ERROR.replace('%1', 'an input'));\n      }\n      for (let j = 0; j < sourceInput.fieldRow.length; j++) {\n        const sourceField = sourceInput.fieldRow[j];\n        const resultField = resultInput.fieldRow[j];\n        if (!resultField) {\n          throw new Error(DUPLICATE_BLOCK_ERROR.replace('%1', 'a field'));\n        }\n        resultField.setValue(sourceField.getValue());\n      }\n    }\n\n    for (const block of result.getDescendants(false)) {\n      block.setInsertionMarker(true);\n    }\n\n    result.setCollapsed(origBlock.isCollapsed());\n    result.setInputsInline(origBlock.getInputsInline());\n\n    result.initSvg();\n    result.getSvgRoot().setAttribute('visibility', 'hidden');\n    return result;\n  }\n\n  /**\n   * Gets the connection on the marker block that matches the original\n   * connection on the original block.\n   *\n   * @param orig The original block.\n   * @param marker The marker block (where we want to find the matching\n   *     connection).\n   * @param origConn The original connection.\n   */\n  private getMatchingConnection(\n    orig: BlockSvg,\n    marker: BlockSvg,\n    origConn: RenderedConnection,\n  ) {\n    const origConns = orig.getConnections_(true);\n    const markerConns = marker.getConnections_(true);\n    if (origConns.length !== markerConns.length) return null;\n    for (let i = 0; i < origConns.length; i++) {\n      if (origConns[i] === origConn) {\n        return markerConns[i];\n      }\n    }\n    return null;\n  }\n\n  /** Hide any previews that are currently displayed. */\n  hidePreview() {\n    eventUtils.disable();\n    try {\n      if (this.staticConn) {\n        this.staticConn.unhighlight();\n        this.staticConn = null;\n      }\n      if (this.fadedBlock) {\n        this.fadedBlock.fadeForReplacement(false);\n        this.fadedBlock = null;\n      }\n      if (this.markerConn) {\n        this.hideInsertionMarker(this.markerConn);\n        this.markerConn = null;\n        this.draggedConn = null;\n      }\n    } finally {\n      eventUtils.enable();\n    }\n  }\n\n  private hideInsertionMarker(markerConn: RenderedConnection) {\n    const marker = markerConn.getSourceBlock();\n    const markerPrev = marker.previousConnection;\n    const markerOutput = marker.outputConnection;\n\n    if (!markerPrev?.targetConnection && !markerOutput?.targetConnection) {\n      // If we are the top block, unplugging doesn't do anything.\n      // The marker connection may not have a target block if we are hiding\n      // as part of applying connections.\n      markerConn.targetBlock()?.unplug(false);\n    } else {\n      marker.unplug(true);\n    }\n\n    marker.dispose();\n  }\n\n  /** Dispose of any references held by this connection previewer. */\n  dispose() {\n    this.hidePreview();\n  }\n}\n\nregistry.register(\n  registry.Type.CONNECTION_PREVIEWER,\n  registry.DEFAULT,\n  InsertionMarkerPreviewer,\n);\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.geras.ConstantProvider\n\nimport {ConstantProvider as BaseConstantProvider} from '../common/constants.js';\n\n/**\n * An object that provides constants for rendering blocks in Geras mode.\n */\nexport class ConstantProvider extends BaseConstantProvider {\n  override FIELD_TEXT_BASELINE_CENTER = false;\n\n  // The dark/shadow path in classic rendering is the same as the normal block\n  // path, but translated down one and right one.\n  DARK_PATH_OFFSET = 1;\n\n  /**\n   * The maximum width of a bottom row that follows a statement input and has\n   * inputs inline.\n   */\n  MAX_BOTTOM_WIDTH = 30;\n  override STATEMENT_BOTTOM_SPACER = -this.NOTCH_HEIGHT / 2;\n\n  constructor() {\n    super();\n  }\n\n  override getCSS_(selector: string) {\n    return super.getCSS_(selector).concat([\n      /* eslint-disable indent */\n      /* clang-format off */\n      // Insertion marker.\n      `${selector} .blocklyInsertionMarker>.blocklyPathLight,`,\n      `${selector} .blocklyInsertionMarker>.blocklyPathDark {`,\n      `fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,\n      `stroke: none;`,\n      '}',\n      /* clang-format on */\n      /* eslint-enable indent */\n    ]);\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.geras.Highlighter\n\nimport * as svgPaths from '../../utils/svg_paths.js';\nimport type {ConstantProvider} from '../common/constants.js';\nimport type {BottomRow} from '../measurables/bottom_row.js';\nimport type {Row} from '../measurables/row.js';\nimport {SpacerRow} from '../measurables/spacer_row.js';\nimport type {TopRow} from '../measurables/top_row.js';\nimport {Types} from '../measurables/types.js';\n\nimport type {\n  HighlightConstantProvider,\n  InsideCorner,\n  JaggedTeeth,\n  Notch,\n  OutsideCorner,\n  PuzzleTab,\n  StartHat,\n} from './highlight_constants.js';\nimport type {RenderInfo} from './info.js';\nimport type {InlineInput} from './measurables/inline_input.js';\n\n/**\n * An object that adds highlights to a block based on the given rendering\n * information.\n *\n * Highlighting is interesting because the highlights do not fully enclose the\n * block.  Instead, they are positioned based on a light source in the top left.\n * This means that rendering highlights requires exact information about the\n * position of each part of the block.  The resulting paths are not continuous\n * or closed paths.  The highlights for tabs and notches are loosely based on\n * tab and notch shapes, but are not exactly the same.\n */\nexport class Highlighter {\n  info_: RenderInfo;\n  steps_ = '';\n  inlineSteps_ = '';\n  RTL_: boolean;\n  constants_: ConstantProvider;\n  highlightConstants_: HighlightConstantProvider;\n  private readonly highlightOffset: number;\n  outsideCornerPaths_: OutsideCorner;\n  insideCornerPaths_: InsideCorner;\n  puzzleTabPaths_: PuzzleTab;\n  notchPaths_: Notch;\n  startPaths_: StartHat;\n  jaggedTeethPaths_: JaggedTeeth;\n\n  /**\n   * @param info An object containing all information needed to render this\n   *     block.\n   */\n  constructor(info: RenderInfo) {\n    this.info_ = info;\n\n    this.RTL_ = this.info_.RTL;\n\n    const renderer = info.getRenderer();\n\n    /** The renderer's constant provider. */\n    this.constants_ = renderer.getConstants();\n\n    this.highlightConstants_ = renderer.getHighlightConstants();\n    /** The offset between the block's main path and highlight path. */\n    this.highlightOffset = this.highlightConstants_.OFFSET;\n\n    this.outsideCornerPaths_ = this.highlightConstants_.OUTSIDE_CORNER;\n    this.insideCornerPaths_ = this.highlightConstants_.INSIDE_CORNER;\n    this.puzzleTabPaths_ = this.highlightConstants_.PUZZLE_TAB;\n    this.notchPaths_ = this.highlightConstants_.NOTCH;\n    this.startPaths_ = this.highlightConstants_.START_HAT;\n    this.jaggedTeethPaths_ = this.highlightConstants_.JAGGED_TEETH;\n  }\n\n  /**\n   * Get the steps for the highlight path.\n   *\n   * @returns The steps for the highlight path.\n   */\n  getPath(): string {\n    return this.steps_ + '\\n' + this.inlineSteps_;\n  }\n\n  /**\n   * Add a highlight to the top corner of a block.\n   *\n   * @param row The top row of the block.\n   */\n  drawTopCorner(row: TopRow) {\n    this.steps_ += svgPaths.moveBy(row.xPos, this.info_.startY);\n    for (let i = 0, elem; (elem = row.elements[i]); i++) {\n      if (Types.isLeftSquareCorner(elem)) {\n        this.steps_ += this.highlightConstants_.START_POINT;\n      } else if (Types.isLeftRoundedCorner(elem)) {\n        this.steps_ += this.outsideCornerPaths_.topLeft(this.RTL_);\n      } else if (Types.isPreviousConnection(elem)) {\n        this.steps_ += this.notchPaths_.pathLeft;\n      } else if (Types.isHat(elem)) {\n        this.steps_ += this.startPaths_.path(this.RTL_);\n      } else if (Types.isSpacer(elem) && elem.width !== 0) {\n        // The end point of the spacer needs to be offset by the highlight\n        // amount. So instead of using the spacer's width for a relative\n        // horizontal, use its width and position for an absolute horizontal\n        // move.\n        this.steps_ += svgPaths.lineOnAxis(\n          'H',\n          elem.xPos + elem.width - this.highlightOffset,\n        );\n      }\n    }\n\n    const right = row.xPos + row.width - this.highlightOffset;\n    this.steps_ += svgPaths.lineOnAxis('H', right);\n  }\n\n  /**\n   * Add a highlight on a jagged edge for a collapsed block.\n   *\n   * @param row  The row to highlight.\n   */\n  drawJaggedEdge_(row: Row) {\n    if (this.info_.RTL) {\n      const remainder =\n        row.height - this.jaggedTeethPaths_.height - this.highlightOffset;\n      this.steps_ +=\n        this.jaggedTeethPaths_.pathLeft + svgPaths.lineOnAxis('v', remainder);\n    }\n  }\n\n  /**\n   * Add a highlight on a value input.\n   *\n   * @param row The row the input belongs to.\n   */\n  drawValueInput(row: Row) {\n    const input = row.getLastInput() as InlineInput;\n    if (this.RTL_) {\n      const belowTabHeight = row.height - input.connectionHeight;\n\n      this.steps_ +=\n        svgPaths.moveTo(\n          input.xPos + input.width - this.highlightOffset,\n          row.yPos,\n        ) +\n        this.puzzleTabPaths_.pathDown(this.RTL_) +\n        svgPaths.lineOnAxis('v', belowTabHeight);\n    } else {\n      this.steps_ +=\n        svgPaths.moveTo(input.xPos + input.width, row.yPos) +\n        this.puzzleTabPaths_.pathDown(this.RTL_);\n    }\n  }\n\n  /**\n   * Add a highlight on a statement input.\n   *\n   * @param row The row to highlight.\n   */\n  drawStatementInput(row: Row) {\n    const input = row.getLastInput();\n    if (!input) return;\n    if (this.RTL_) {\n      const innerHeight = row.height - 2 * this.insideCornerPaths_.height;\n      this.steps_ +=\n        svgPaths.moveTo(input.xPos, row.yPos) +\n        this.insideCornerPaths_.pathTop(this.RTL_) +\n        svgPaths.lineOnAxis('v', innerHeight) +\n        this.insideCornerPaths_.pathBottom(this.RTL_) +\n        svgPaths.lineTo(\n          row.width - input.xPos - this.insideCornerPaths_.width,\n          0,\n        );\n    } else {\n      this.steps_ +=\n        svgPaths.moveTo(input.xPos, row.yPos + row.height) +\n        this.insideCornerPaths_.pathBottom(this.RTL_) +\n        svgPaths.lineTo(\n          row.width - input.xPos - this.insideCornerPaths_.width,\n          0,\n        );\n    }\n  }\n\n  /**\n   * Add a highlight on the right side of a row.\n   *\n   * @param row The row to highlight.\n   */\n  drawRightSideRow(row: Row) {\n    const rightEdge = row.xPos + row.width - this.highlightOffset;\n    if (row instanceof SpacerRow && row.followsStatement) {\n      this.steps_ += svgPaths.lineOnAxis('H', rightEdge);\n    }\n    if (this.RTL_) {\n      this.steps_ += svgPaths.lineOnAxis('H', rightEdge);\n      if (row.height > this.highlightOffset) {\n        this.steps_ += svgPaths.lineOnAxis(\n          'V',\n          row.yPos + row.height - this.highlightOffset,\n        );\n      }\n    }\n  }\n\n  /**\n   * Add a highlight to the bottom row.\n   *\n   * @param row The row to highlight.\n   */\n  drawBottomRow(row: BottomRow) {\n    // Highlight the vertical edge of the bottom row on the input side.\n    // Highlighting is always from the top left, both in LTR and RTL.\n    if (this.RTL_) {\n      this.steps_ += svgPaths.lineOnAxis(\n        'V',\n        row.baseline - this.highlightOffset,\n      );\n    } else {\n      const cornerElem = this.info_.bottomRow.elements[0];\n      if (Types.isLeftSquareCorner(cornerElem)) {\n        this.steps_ += svgPaths.moveTo(\n          row.xPos + this.highlightOffset,\n          row.baseline - this.highlightOffset,\n        );\n      } else if (Types.isLeftRoundedCorner(cornerElem)) {\n        this.steps_ += svgPaths.moveTo(row.xPos, row.baseline);\n        this.steps_ += this.outsideCornerPaths_.bottomLeft();\n      }\n    }\n  }\n\n  /**\n   * Draw the highlight on the left side of the block.\n   */\n  drawLeft() {\n    const outputConnection = this.info_.outputConnection;\n    if (outputConnection) {\n      const tabBottom =\n        outputConnection.connectionOffsetY + outputConnection.height;\n      // Draw a line up to the bottom of the tab.\n      if (this.RTL_) {\n        this.steps_ += svgPaths.moveTo(this.info_.startX, tabBottom);\n      } else {\n        const left = this.info_.startX + this.highlightOffset;\n        const bottom = this.info_.bottomRow.baseline - this.highlightOffset;\n        this.steps_ += svgPaths.moveTo(left, bottom);\n        this.steps_ += svgPaths.lineOnAxis('V', tabBottom);\n      }\n      this.steps_ += this.puzzleTabPaths_.pathUp(this.RTL_);\n    }\n\n    if (!this.RTL_) {\n      const topRow = this.info_.topRow;\n      if (Types.isLeftRoundedCorner(topRow.elements[0])) {\n        this.steps_ += svgPaths.lineOnAxis(\n          'V',\n          this.outsideCornerPaths_.height,\n        );\n      } else {\n        this.steps_ += svgPaths.lineOnAxis(\n          'V',\n          topRow.capline + this.highlightOffset,\n        );\n      }\n    }\n  }\n\n  /**\n   * Add a highlight to an inline input.\n   *\n   * @param input The input to highlight.\n   */\n  drawInlineInput(input: InlineInput) {\n    const offset = this.highlightOffset;\n\n    // Relative to the block's left.\n    const connectionRight = input.xPos + input.connectionWidth;\n    const yPos = input.centerline - input.height / 2;\n    const bottomHighlightWidth = input.width - input.connectionWidth;\n    const startY = yPos + offset;\n\n    if (this.RTL_) {\n      const aboveTabHeight = input.connectionOffsetY - offset;\n      const belowTabHeight =\n        input.height -\n        (input.connectionOffsetY + input.connectionHeight) +\n        offset;\n\n      const startX = connectionRight - offset;\n\n      this.inlineSteps_ +=\n        svgPaths.moveTo(startX, startY) + // Right edge above tab.\n        svgPaths.lineOnAxis('v', aboveTabHeight) + // Back of tab.\n        this.puzzleTabPaths_.pathDown(this.RTL_) + // Right edge below tab.\n        svgPaths.lineOnAxis('v', belowTabHeight) + // Bottom.\n        svgPaths.lineOnAxis('h', bottomHighlightWidth);\n    } else {\n      this.inlineSteps_ += // Go to top right corner.\n        svgPaths.moveTo(input.xPos + input.width + offset, startY) + // Highlight right edge, bottom.\n        svgPaths.lineOnAxis('v', input.height) +\n        svgPaths.lineOnAxis('h', -bottomHighlightWidth) + // Go to top of tab.\n        svgPaths.moveTo(connectionRight, yPos + input.connectionOffsetY) + // Short highlight glint at\n        // bottom of tab.\n        this.puzzleTabPaths_.pathDown(this.RTL_);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.geras.Drawer\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport * as svgPaths from '../../utils/svg_paths.js';\nimport {Drawer as BaseDrawer} from '../common/drawer.js';\nimport type {Row} from '../measurables/row.js';\n\nimport type {ConstantProvider} from './constants.js';\nimport {Highlighter} from './highlighter.js';\nimport type {RenderInfo} from './info.js';\nimport type {InlineInput} from './measurables/inline_input.js';\nimport type {PathObject} from './path_object.js';\n\n/**\n * An object that draws a block based on the given rendering information,\n * customized for the geras renderer.\n */\nexport class Drawer extends BaseDrawer {\n  highlighter_: Highlighter;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  override constants_!: ConstantProvider;\n\n  /**\n   * @param block The block to render.\n   * @param info An object containing all information needed to render this\n   *     block.\n   */\n  constructor(block: BlockSvg, info: RenderInfo) {\n    super(block, info);\n    // Unlike Thrasos, Geras has highlights and drop shadows.\n    this.highlighter_ = new Highlighter(info);\n  }\n\n  override draw() {\n    this.drawOutline_();\n    this.drawInternals_();\n    this.updateConnectionHighlights();\n\n    const pathObject = this.block_.pathObject as PathObject;\n    pathObject.setPath(this.outlinePath_ + '\\n' + this.inlinePath_);\n    pathObject.setHighlightPath(this.highlighter_.getPath());\n    if (this.info_.RTL) {\n      pathObject.flipRTL();\n    }\n    this.recordSizeOnBlock_();\n  }\n\n  override drawTop_() {\n    this.highlighter_.drawTopCorner(this.info_.topRow);\n    this.highlighter_.drawRightSideRow(this.info_.topRow);\n\n    super.drawTop_();\n  }\n\n  override drawJaggedEdge_(row: Row) {\n    this.highlighter_.drawJaggedEdge_(row);\n\n    super.drawJaggedEdge_(row);\n  }\n\n  override drawValueInput_(row: Row) {\n    this.highlighter_.drawValueInput(row);\n\n    super.drawValueInput_(row);\n  }\n\n  override drawStatementInput_(row: Row) {\n    this.highlighter_.drawStatementInput(row);\n\n    super.drawStatementInput_(row);\n  }\n\n  override drawRightSideRow_(row: Row) {\n    this.highlighter_.drawRightSideRow(row);\n\n    this.outlinePath_ +=\n      svgPaths.lineOnAxis('H', row.xPos + row.width) +\n      svgPaths.lineOnAxis('V', row.yPos + row.height);\n  }\n\n  override drawBottom_() {\n    this.highlighter_.drawBottomRow(this.info_.bottomRow);\n\n    super.drawBottom_();\n  }\n\n  /**\n   * Add steps for the left side of the block, which may include an output\n   * connection\n   */\n  protected override drawLeft_() {\n    this.highlighter_.drawLeft();\n\n    super.drawLeft_();\n  }\n\n  override drawInlineInput_(input: InlineInput) {\n    this.highlighter_.drawInlineInput(input as InlineInput);\n\n    super.drawInlineInput_(input);\n  }\n\n  override positionInlineInputConnection_(input: InlineInput) {\n    const yPos = input.centerline - input.height / 2;\n    // Move the connection.\n    if (input.connectionModel) {\n      // xPos already contains info about startX\n      let connX =\n        input.xPos + input.connectionWidth + this.constants_.DARK_PATH_OFFSET;\n      if (this.info_.RTL) {\n        connX *= -1;\n      }\n      input.connectionModel.setOffsetInBlock(\n        connX,\n        yPos + input.connectionOffsetY + this.constants_.DARK_PATH_OFFSET,\n      );\n    }\n  }\n\n  override positionStatementInputConnection_(row: Row) {\n    const input = row.getLastInput();\n    if (input?.connectionModel) {\n      let connX = row.xPos + row.statementEdge + input.notchOffset;\n      if (this.info_.RTL) {\n        connX *= -1;\n      } else {\n        connX += this.constants_.DARK_PATH_OFFSET;\n      }\n      input.connectionModel.setOffsetInBlock(\n        connX,\n        row.yPos + this.constants_.DARK_PATH_OFFSET,\n      );\n    }\n  }\n\n  override positionExternalValueConnection_(row: Row) {\n    const input = row.getLastInput();\n    if (input && input.connectionModel) {\n      let connX = row.xPos + row.width + this.constants_.DARK_PATH_OFFSET;\n      if (this.info_.RTL) {\n        connX *= -1;\n      }\n      input.connectionModel.setOffsetInBlock(connX, row.yPos);\n    }\n  }\n\n  override positionNextConnection_() {\n    const bottomRow = this.info_.bottomRow;\n\n    if (bottomRow.connection) {\n      const connInfo = bottomRow.connection;\n      const x = connInfo.xPos; // Already contains info about startX.\n      const connX =\n        (this.info_.RTL ? -x : x) + this.constants_.DARK_PATH_OFFSET / 2;\n      connInfo.connectionModel.setOffsetInBlock(\n        connX,\n        bottomRow.baseline + this.constants_.DARK_PATH_OFFSET,\n      );\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.geras.HighlightConstantProvider\n\nimport * as svgPaths from '../../utils/svg_paths.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\n/** An object containing sizing and path information about an outside corner. */\nexport interface OutsideCorner {\n  height: number;\n  topLeft: (p1: boolean) => string;\n  bottomLeft: () => string;\n}\n\n/** An object containing sizing and path information about an inside corner. */\nexport interface InsideCorner {\n  width: number;\n  height: number;\n  pathTop: (p1: boolean) => string;\n  pathBottom: (p1: boolean) => string;\n}\n\n/** An object containing sizing and path information about a start hat. */\nexport interface StartHat {\n  path: (p1: boolean) => string;\n}\n\n/** An object containing sizing and path information about a notch. */\nexport interface Notch {\n  pathLeft: string;\n}\n\n/** An object containing sizing and path information about a puzzle tab. */\nexport interface PuzzleTab {\n  width: number;\n  height: number;\n  pathDown: (p1: boolean) => string;\n  pathUp: (p1: boolean) => string;\n}\n\n/**\n * An object containing sizing and path information about collapsed block\n * indicators.\n */\nexport interface JaggedTeeth {\n  height: number;\n  width: number;\n  pathLeft: string;\n}\n\n/**\n * An object that provides constants for rendering highlights on blocks.\n * Some highlights are simple offsets of the parent paths and can be generated\n * programmatically.  Others, especially on curves, are just made out of piles\n * of constants and are hard to tweak.\n */\nexport class HighlightConstantProvider {\n  constantProvider: ConstantProvider;\n\n  /** The offset between the block's main path and highlight path. */\n  OFFSET = 0.5;\n  START_POINT: string;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  INSIDE_CORNER!: InsideCorner;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  OUTSIDE_CORNER!: OutsideCorner;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  PUZZLE_TAB!: PuzzleTab;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  NOTCH!: Notch;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  JAGGED_TEETH!: JaggedTeeth;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  START_HAT!: StartHat;\n\n  /**\n   * @param constants The rendering constants provider.\n   */\n  constructor(constants: ConstantProvider) {\n    /** The renderer's constant provider. */\n    this.constantProvider = constants;\n\n    /**\n     * The start point, which is offset in both X and Y, as an SVG path chunk.\n     */\n    this.START_POINT = svgPaths.moveBy(this.OFFSET, this.OFFSET);\n  }\n\n  /**\n   * Initialize shape objects based on the constants set in the constructor.\n   */\n  init() {\n    /**\n     * An object containing sizing and path information about inside corner\n     * highlights.\n     */\n    this.INSIDE_CORNER = this.makeInsideCorner();\n\n    /**\n     * An object containing sizing and path information about outside corner\n     * highlights.\n     */\n    this.OUTSIDE_CORNER = this.makeOutsideCorner();\n\n    /**\n     * An object containing sizing and path information about puzzle tab\n     * highlights.\n     */\n    this.PUZZLE_TAB = this.makePuzzleTab();\n\n    /**\n     * An object containing sizing and path information about notch highlights.\n     */\n    this.NOTCH = this.makeNotch();\n\n    /**\n     * An object containing sizing and path information about highlights for\n     * collapsed block indicators.\n     */\n    this.JAGGED_TEETH = this.makeJaggedTeeth();\n\n    /**\n     * An object containing sizing and path information about start hat\n     * highlights.\n     */\n    this.START_HAT = this.makeStartHat();\n  }\n\n  /**\n   * @returns An object containing sizing and path information about inside\n   *     corner highlights.\n   */\n  protected makeInsideCorner(): InsideCorner {\n    const radius = this.constantProvider.CORNER_RADIUS;\n    const offset = this.OFFSET;\n\n    /**\n     * Distance from shape edge to intersect with a curved corner at 45 degrees.\n     * Applies to highlighting on around the outside of a curve.\n     */\n    const distance45outside = (1 - Math.SQRT1_2) * (radius + offset) - offset;\n\n    const pathTopRtl =\n      svgPaths.moveBy(distance45outside, distance45outside) +\n      svgPaths.arc(\n        'a',\n        '0 0,0',\n        radius,\n        svgPaths.point(-distance45outside - offset, radius - distance45outside),\n      );\n\n    const pathBottomRtl = svgPaths.arc(\n      'a',\n      '0 0,0',\n      radius + offset,\n      svgPaths.point(radius + offset, radius + offset),\n    );\n\n    const pathBottomLtr =\n      svgPaths.moveBy(distance45outside, -distance45outside) +\n      svgPaths.arc(\n        'a',\n        '0 0,0',\n        radius + offset,\n        svgPaths.point(radius - distance45outside, distance45outside + offset),\n      );\n\n    return {\n      width: radius + offset,\n      height: radius,\n      pathTop(rtl) {\n        return rtl ? pathTopRtl : '';\n      },\n      pathBottom(rtl) {\n        return rtl ? pathBottomRtl : pathBottomLtr;\n      },\n    };\n  }\n\n  /**\n   * @returns An object containing sizing and path information about outside\n   *     corner highlights.\n   */\n  protected makeOutsideCorner(): OutsideCorner {\n    const radius = this.constantProvider.CORNER_RADIUS;\n    const offset = this.OFFSET;\n\n    /**\n     * Distance from shape edge to intersect with a curved corner at 45 degrees.\n     * Applies to highlighting on around the inside of a curve.\n     */\n    const distance45inside = (1 - Math.SQRT1_2) * (radius - offset) + offset;\n\n    const topLeftStartX = distance45inside;\n    const topLeftStartY = distance45inside;\n    const topLeftCornerHighlightRtl =\n      svgPaths.moveBy(topLeftStartX, topLeftStartY) +\n      svgPaths.arc(\n        'a',\n        '0 0,1',\n        radius - offset,\n        svgPaths.point(radius - topLeftStartX, -topLeftStartY + offset),\n      );\n    /**\n     * SVG path for drawing the highlight on the rounded top-left corner.\n     */\n    const topLeftCornerHighlightLtr =\n      svgPaths.moveBy(offset, radius) +\n      svgPaths.arc(\n        'a',\n        '0 0,1',\n        radius - offset,\n        svgPaths.point(radius, -radius + offset),\n      );\n\n    const bottomLeftStartX = distance45inside;\n    const bottomLeftStartY = -distance45inside;\n    const bottomLeftPath =\n      svgPaths.moveBy(bottomLeftStartX, bottomLeftStartY) +\n      svgPaths.arc(\n        'a',\n        '0 0,1',\n        radius - offset,\n        svgPaths.point(-bottomLeftStartX + offset, -bottomLeftStartY - radius),\n      );\n\n    return {\n      height: radius,\n      topLeft(rtl) {\n        return rtl ? topLeftCornerHighlightRtl : topLeftCornerHighlightLtr;\n      },\n      bottomLeft() {\n        return bottomLeftPath;\n      },\n    };\n  }\n\n  /**\n   * @returns An object containing sizing and path information about puzzle tab\n   *     highlights.\n   */\n  protected makePuzzleTab(): PuzzleTab {\n    const width = this.constantProvider.TAB_WIDTH;\n    const height = this.constantProvider.TAB_HEIGHT;\n\n    // This is how much of the vertical block edge is actually drawn by the\n    // puzzle tab.\n    const verticalOverlap = 2.5;\n\n    const highlightRtlUp =\n      svgPaths.moveBy(-2, -height + verticalOverlap + 0.9) +\n      svgPaths.lineTo(width * -0.45, -2.1);\n\n    const highlightRtlDown =\n      svgPaths.lineOnAxis('v', verticalOverlap) +\n      svgPaths.moveBy(-width * 0.97, 2.5) +\n      svgPaths.curve('q', [\n        svgPaths.point(-width * 0.05, 10),\n        svgPaths.point(width * 0.3, 9.5),\n      ]) +\n      svgPaths.moveBy(width * 0.67, -1.9) +\n      svgPaths.lineOnAxis('v', verticalOverlap);\n\n    const highlightLtrUp =\n      svgPaths.lineOnAxis('v', -1.5) +\n      svgPaths.moveBy(width * -0.92, -0.5) +\n      svgPaths.curve('q', [\n        svgPaths.point(width * -0.19, -5.5),\n        svgPaths.point(0, -11),\n      ]) +\n      svgPaths.moveBy(width * 0.92, 1);\n\n    const highlightLtrDown =\n      svgPaths.moveBy(-5, height - 0.7) + svgPaths.lineTo(width * 0.46, -2.1);\n\n    return {\n      width,\n      height,\n      pathUp(rtl) {\n        return rtl ? highlightRtlUp : highlightLtrUp;\n      },\n      pathDown(rtl) {\n        return rtl ? highlightRtlDown : highlightLtrDown;\n      },\n    };\n  }\n\n  /**\n   * @returns An object containing sizing and path information about notch\n   *     highlights.\n   */\n  protected makeNotch(): Notch {\n    // This is only for the previous connection.\n    const pathLeft =\n      svgPaths.lineOnAxis('h', this.OFFSET) +\n      this.constantProvider.NOTCH.pathLeft;\n    return {pathLeft};\n  }\n\n  /**\n   * @returns An object containing sizing and path information about collapsed\n   *     block edge highlights.\n   */\n  protected makeJaggedTeeth(): JaggedTeeth {\n    const pathLeft =\n      svgPaths.lineTo(5.1, 2.6) +\n      svgPaths.moveBy(-10.2, 6.8) +\n      svgPaths.lineTo(5.1, 2.6);\n    return {pathLeft, height: 12, width: 10.2};\n  }\n\n  /**\n   * @returns An object containing sizing and path information about start\n   *     highlights.\n   */\n  protected makeStartHat(): StartHat {\n    const hatHeight = this.constantProvider.START_HAT.height;\n    const pathRtl =\n      svgPaths.moveBy(25, -8.7) +\n      svgPaths.curve('c', [\n        svgPaths.point(29.7, -6.2),\n        svgPaths.point(57.2, -0.5),\n        svgPaths.point(75, 8.7),\n      ]);\n\n    const pathLtr =\n      svgPaths.curve('c', [\n        svgPaths.point(17.8, -9.2),\n        svgPaths.point(45.3, -14.9),\n        svgPaths.point(75, -8.7),\n      ]) + svgPaths.moveTo(100.5, hatHeight + 0.5);\n    return {\n      path(rtl) {\n        return rtl ? pathRtl : pathLtr;\n      },\n    };\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.geras.InlineInput\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {Input} from '../../../inputs/input.js';\nimport type {ConstantProvider as BaseConstantProvider} from '../../../renderers/common/constants.js';\nimport {InlineInput as BaseInlineInput} from '../../../renderers/measurables/inline_input.js';\nimport type {ConstantProvider as GerasConstantProvider} from '../constants.js';\n\n/**\n * An object containing information about the space an inline input takes up\n * during rendering.\n */\nexport class InlineInput extends BaseInlineInput {\n  override constants_: GerasConstantProvider;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param input The inline input to measure and store information for.\n   */\n  constructor(constants: BaseConstantProvider, input: Input) {\n    super(constants, input);\n    this.constants_ = constants as GerasConstantProvider;\n\n    if (this.connectedBlock) {\n      // We allow the dark path to show on the parent block so that the child\n      // block looks embossed.  This takes up an extra pixel in both x and y.\n      this.width += this.constants_.DARK_PATH_OFFSET;\n      this.height += this.constants_.DARK_PATH_OFFSET;\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.geras.StatementInput\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {Input} from '../../../inputs/input.js';\nimport type {ConstantProvider as BaseConstantProvider} from '../../../renderers/common/constants.js';\nimport {StatementInput as BaseStatementInput} from '../../../renderers/measurables/statement_input.js';\nimport type {ConstantProvider as GerasConstantProvider} from '../constants.js';\n\n/**\n * An object containing information about the space a statement input takes up\n * during rendering.\n */\nexport class StatementInput extends BaseStatementInput {\n  override constants_: GerasConstantProvider;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param input The statement input to measure and store information for.\n   */\n  constructor(constants: BaseConstantProvider, input: Input) {\n    super(constants, input);\n    this.constants_ = constants as GerasConstantProvider;\n\n    if (this.connectedBlock) {\n      // We allow the dark path to show on the parent block so that the child\n      // block looks embossed.  This takes up an extra pixel in both x and y.\n      this.height += this.constants_.DARK_PATH_OFFSET;\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.geras.RenderInfo\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {Input} from '../../inputs/input.js';\nimport {RenderInfo as BaseRenderInfo} from '../common/info.js';\nimport type {Measurable} from '../measurables/base.js';\nimport type {BottomRow} from '../measurables/bottom_row.js';\nimport {DummyInput} from '../../inputs/dummy_input.js';\nimport {EndRowInput} from '../../inputs/end_row_input.js';\nimport {ExternalValueInput} from '../measurables/external_value_input.js';\nimport type {Field} from '../measurables/field.js';\nimport {InRowSpacer} from '../measurables/in_row_spacer.js';\nimport type {InputRow} from '../measurables/input_row.js';\nimport type {Row} from '../measurables/row.js';\nimport {StatementInput} from '../../inputs/statement_input.js';\nimport type {TopRow} from '../measurables/top_row.js';\nimport {Types} from '../measurables/types.js';\nimport {ValueInput} from '../../inputs/value_input.js';\n\nimport type {ConstantProvider} from './constants.js';\nimport {InlineInput} from './measurables/inline_input.js';\nimport {StatementInput as StatementInputMeasurable} from './measurables/statement_input.js';\nimport type {Renderer} from './renderer.js';\n\n/**\n * An object containing all sizing information needed to draw this block,\n * customized for the geras renderer.\n *\n * This measure pass does not propagate changes to the block (although fields\n * may choose to rerender when getSize() is called).  However, calling it\n * repeatedly may be expensive.\n */\nexport class RenderInfo extends BaseRenderInfo {\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  override constants_!: ConstantProvider;\n\n  protected override readonly renderer_: Renderer;\n\n  /**\n   * @param renderer The renderer in use.\n   * @param block The block to measure.\n   */\n  constructor(renderer: Renderer, block: BlockSvg) {\n    super(renderer, block);\n    this.renderer_ = renderer;\n  }\n\n  /**\n   * Get the block renderer in use.\n   *\n   * @returns The block renderer in use.\n   */\n  override getRenderer(): Renderer {\n    return this.renderer_;\n  }\n\n  override populateBottomRow_() {\n    super.populateBottomRow_();\n\n    const followsStatement =\n      this.block_.inputList.length &&\n      this.block_.inputList[this.block_.inputList.length - 1] instanceof\n        StatementInput;\n    // The minimum height of the bottom row is smaller in Geras than in other\n    // renderers, because the dark path adds a pixel.\n    // If one of the row's elements has a greater height this will be\n    // overwritten in the compute pass.\n    if (!followsStatement) {\n      this.bottomRow.minHeight =\n        this.constants_.MEDIUM_PADDING - this.constants_.DARK_PATH_OFFSET;\n    }\n  }\n\n  override addInput_(input: Input, activeRow: Row) {\n    // Non-dummy inputs have visual representations onscreen.\n    if (this.isInline && input instanceof ValueInput) {\n      activeRow.elements.push(new InlineInput(this.constants_, input));\n      activeRow.hasInlineInput = true;\n    } else if (input instanceof StatementInput) {\n      activeRow.elements.push(\n        new StatementInputMeasurable(this.constants_, input),\n      );\n      activeRow.hasStatement = true;\n    } else if (input instanceof ValueInput) {\n      activeRow.elements.push(new ExternalValueInput(this.constants_, input));\n      activeRow.hasExternalInput = true;\n    } else if (input instanceof DummyInput || input instanceof EndRowInput) {\n      // Dummy and end-row inputs have no visual representation, but the\n      // information is still important.\n      activeRow.minHeight = Math.max(\n        activeRow.minHeight,\n        this.constants_.DUMMY_INPUT_MIN_HEIGHT,\n      );\n      activeRow.hasDummyInput = true;\n    }\n    // Ignore row alignment if inline.\n    if (!this.isInline && activeRow.align === null) {\n      activeRow.align = input.align;\n    }\n  }\n\n  override addElemSpacing_() {\n    let hasExternalInputs = false;\n    for (let i = 0, row; (row = this.rows[i]); i++) {\n      if (row.hasExternalInput) {\n        hasExternalInputs = true;\n      }\n    }\n    for (let i = 0, row; (row = this.rows[i]); i++) {\n      const oldElems = row.elements;\n      row.elements = [];\n      // No spacing needed before the corner on the top row or the bottom row.\n      if (row.startsWithElemSpacer()) {\n        // There's a spacer before the first element in the row.\n        row.elements.push(\n          new InRowSpacer(\n            this.constants_,\n            this.getInRowSpacing_(null, oldElems[0]),\n          ),\n        );\n      }\n      if (!oldElems.length) {\n        continue;\n      }\n      for (let e = 0; e < oldElems.length - 1; e++) {\n        row.elements.push(oldElems[e]);\n        const spacing = this.getInRowSpacing_(oldElems[e], oldElems[e + 1]);\n        row.elements.push(new InRowSpacer(this.constants_, spacing));\n      }\n      row.elements.push(oldElems[oldElems.length - 1]);\n      if (row.endsWithElemSpacer()) {\n        let spacing = this.getInRowSpacing_(\n          oldElems[oldElems.length - 1],\n          null,\n        );\n        if (hasExternalInputs && row.hasDummyInput) {\n          spacing += this.constants_.TAB_WIDTH;\n        }\n        // There's a spacer after the last element in the row.\n        row.elements.push(new InRowSpacer(this.constants_, spacing));\n      }\n    }\n  }\n\n  override getInRowSpacing_(prev: Measurable | null, next: Measurable | null) {\n    if (!prev) {\n      // Between an editable field and the beginning of the row.\n      if (next && Types.isField(next) && (next as Field).isEditable) {\n        return this.constants_.MEDIUM_PADDING;\n      }\n      // Inline input at the beginning of the row.\n      if (next && Types.isInlineInput(next)) {\n        return this.constants_.MEDIUM_LARGE_PADDING;\n      }\n      if (next && Types.isStatementInput(next)) {\n        return this.constants_.STATEMENT_INPUT_PADDING_LEFT;\n      }\n      // Anything else at the beginning of the row.\n      return this.constants_.LARGE_PADDING;\n    }\n\n    // Spacing between a non-input and the end of the row or a statement input.\n    if (!Types.isInput(prev) && (!next || Types.isStatementInput(next))) {\n      // Between an editable field and the end of the row.\n      if (Types.isField(prev) && (prev as Field).isEditable) {\n        return this.constants_.MEDIUM_PADDING;\n      }\n      // Padding at the end of an icon-only row to make the block shape clearer.\n      if (Types.isIcon(prev)) {\n        return this.constants_.LARGE_PADDING * 2 + 1;\n      }\n      if (Types.isHat(prev)) {\n        return this.constants_.NO_PADDING;\n      }\n      // Establish a minimum width for a block with a previous or next\n      // connection.\n      if (Types.isPreviousOrNextConnection(prev)) {\n        return this.constants_.LARGE_PADDING;\n      }\n      // Between rounded corner and the end of the row.\n      if (Types.isLeftRoundedCorner(prev)) {\n        return this.constants_.MIN_BLOCK_WIDTH;\n      }\n      // Between a jagged edge and the end of the row.\n      if (Types.isJaggedEdge(prev)) {\n        return this.constants_.NO_PADDING;\n      }\n      // Between noneditable fields and icons and the end of the row.\n      return this.constants_.LARGE_PADDING;\n    }\n\n    // Between inputs and the end of the row.\n    if (Types.isInput(prev) && !next) {\n      if (Types.isExternalInput(prev)) {\n        return this.constants_.NO_PADDING;\n      } else if (Types.isInlineInput(prev)) {\n        return this.constants_.LARGE_PADDING;\n      } else if (Types.isStatementInput(prev)) {\n        return this.constants_.NO_PADDING;\n      }\n    }\n\n    // Spacing between a non-input and an input.\n    if (!Types.isInput(prev) && next && Types.isInput(next)) {\n      // Between an editable field and an input.\n      if (Types.isField(prev) && (prev as Field).isEditable) {\n        if (Types.isInlineInput(next)) {\n          return this.constants_.SMALL_PADDING;\n        } else if (Types.isExternalInput(next)) {\n          return this.constants_.SMALL_PADDING;\n        }\n      } else {\n        if (Types.isInlineInput(next)) {\n          return this.constants_.MEDIUM_LARGE_PADDING;\n        } else if (Types.isExternalInput(next)) {\n          return this.constants_.MEDIUM_LARGE_PADDING;\n        } else if (Types.isStatementInput(next)) {\n          return this.constants_.LARGE_PADDING;\n        }\n      }\n      return this.constants_.LARGE_PADDING - 1;\n    }\n\n    // Spacing between an icon and an icon or field.\n    if (Types.isIcon(prev) && next && !Types.isInput(next)) {\n      return this.constants_.LARGE_PADDING;\n    }\n    // Spacing between an inline input and a field.\n    if (Types.isInlineInput(prev) && next && Types.isField(next)) {\n      // Editable field after inline input.\n      if ((next as Field).isEditable) {\n        return this.constants_.MEDIUM_PADDING;\n      } else {\n        // Noneditable field after inline input.\n        return this.constants_.LARGE_PADDING;\n      }\n    }\n\n    if (Types.isLeftSquareCorner(prev) && next) {\n      // Spacing between a hat and a corner\n      if (Types.isHat(next)) {\n        return this.constants_.NO_PADDING;\n      }\n      // Spacing between a square corner and a previous or next connection\n      if (Types.isPreviousConnection(next)) {\n        return next.notchOffset;\n      } else if (Types.isNextConnection(next)) {\n        // Next connections are shifted slightly to the left (in both LTR and\n        // RTL) to make the dark path under the previous connection show\n        // through.\n        const offset =\n          ((this.RTL ? 1 : -1) * this.constants_.DARK_PATH_OFFSET) / 2;\n        return next.notchOffset + offset;\n      }\n    }\n\n    // Spacing between a rounded corner and a previous or next connection.\n    if (Types.isLeftRoundedCorner(prev) && next) {\n      if (Types.isPreviousConnection(next)) {\n        return next.notchOffset - this.constants_.CORNER_RADIUS;\n      } else if (Types.isNextConnection(next)) {\n        // Next connections are shifted slightly to the left (in both LTR and\n        // RTL) to make the dark path under the previous connection show\n        // through.\n        const offset =\n          ((this.RTL ? 1 : -1) * this.constants_.DARK_PATH_OFFSET) / 2;\n        return next.notchOffset - this.constants_.CORNER_RADIUS + offset;\n      }\n    }\n\n    // Spacing between two fields of the same editability.\n    if (\n      Types.isField(prev) &&\n      next &&\n      Types.isField(next) &&\n      (prev as Field).isEditable === (next as Field).isEditable\n    ) {\n      return this.constants_.LARGE_PADDING;\n    }\n\n    // Spacing between anything and a jagged edge.\n    if (next && Types.isJaggedEdge(next)) {\n      return this.constants_.LARGE_PADDING;\n    }\n\n    return this.constants_.MEDIUM_PADDING;\n  }\n\n  override getSpacerRowHeight_(prev: Row, next: Row) {\n    // If we have an empty block add a spacer to increase the height.\n    if (Types.isTopRow(prev) && Types.isBottomRow(next)) {\n      return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;\n    }\n    // Top and bottom rows act as a spacer so we don't need any extra padding.\n    if (Types.isTopRow(prev) || Types.isBottomRow(next)) {\n      return this.constants_.NO_PADDING;\n    }\n    if (prev.hasExternalInput && next.hasExternalInput) {\n      return this.constants_.LARGE_PADDING;\n    }\n    if (!prev.hasStatement && next.hasStatement) {\n      return this.constants_.BETWEEN_STATEMENT_PADDING_Y;\n    }\n    if (prev.hasStatement && next.hasStatement) {\n      return this.constants_.LARGE_PADDING;\n    }\n    if (!prev.hasStatement && next.hasDummyInput) {\n      return this.constants_.LARGE_PADDING;\n    }\n    if (prev.hasDummyInput) {\n      return this.constants_.LARGE_PADDING;\n    }\n    return this.constants_.MEDIUM_PADDING;\n  }\n\n  override getElemCenterline_(row: Row, elem: Measurable) {\n    if (Types.isSpacer(elem)) {\n      return row.yPos + elem.height / 2;\n    }\n    if (Types.isBottomRow(row)) {\n      const bottomRow = row as BottomRow;\n      const baseline =\n        bottomRow.yPos + bottomRow.height - bottomRow.descenderHeight;\n      if (Types.isNextConnection(elem)) {\n        return baseline + elem.height / 2;\n      }\n      return baseline - elem.height / 2;\n    }\n    if (Types.isTopRow(row)) {\n      const topRow = row as TopRow;\n      if (Types.isHat(elem)) {\n        return topRow.capline - elem.height / 2;\n      }\n      return topRow.capline + elem.height / 2;\n    }\n\n    let result = row.yPos;\n    if (Types.isField(elem) || Types.isIcon(elem)) {\n      result += elem.height / 2;\n      if (\n        (row.hasInlineInput || row.hasStatement) &&\n        elem.height + this.constants_.TALL_INPUT_FIELD_OFFSET_Y <= row.height\n      ) {\n        result += this.constants_.TALL_INPUT_FIELD_OFFSET_Y;\n      }\n    } else if (Types.isInlineInput(elem)) {\n      result += elem.height / 2;\n    } else {\n      result += row.height / 2;\n    }\n    return result;\n  }\n\n  override alignRowElements_() {\n    if (!this.isInline) {\n      super.alignRowElements_();\n      return;\n    }\n    // Walk backgrounds through rows on the block, keeping track of the right\n    // input edge.\n    let nextRightEdge = 0;\n    const rowNextRightEdges = new WeakMap();\n    let prevInput = null;\n    for (let i = this.rows.length - 1, row; (row = this.rows[i]); i--) {\n      rowNextRightEdges.set(row, nextRightEdge);\n      if (Types.isInputRow(row)) {\n        if (row.hasStatement) {\n          this.alignStatementRow_(row as InputRow);\n        }\n        if (\n          prevInput &&\n          prevInput.hasStatement &&\n          row.width < prevInput.width\n        ) {\n          rowNextRightEdges.set(row, prevInput.width);\n        } else if (row.hasStatement) {\n          nextRightEdge = row.width;\n        } else {\n          // To keep right edges of consecutive non-statement rows aligned, use\n          // the maximum width.\n          nextRightEdge = Math.max(nextRightEdge, row.width);\n        }\n        prevInput = row;\n      }\n    }\n    // Walk down each row from the top, comparing the prev and next right input\n    // edges and setting the desired width to the max of the two.\n    let prevRightEdge = 0;\n    for (let i = 0, row; (row = this.rows[i]); i++) {\n      if (row.hasStatement) {\n        prevRightEdge = this.getDesiredRowWidth_(row);\n      } else if (Types.isSpacer(row)) {\n        // Set the spacer row to the max of the prev or next input width.\n        row.width = Math.max(prevRightEdge, rowNextRightEdges.get(row));\n      } else {\n        const currentWidth = row.width;\n        const desiredWidth = Math.max(\n          prevRightEdge,\n          rowNextRightEdges.get(row),\n        );\n        const missingSpace = desiredWidth - currentWidth;\n        if (missingSpace > 0) {\n          this.addAlignmentPadding_(row, missingSpace);\n        }\n        prevRightEdge = row.width;\n      }\n    }\n  }\n\n  override getDesiredRowWidth_(row: Row) {\n    // Limit the width of a statement row when a block is inline.\n    if (this.isInline && row.hasStatement) {\n      return (\n        this.statementEdge + this.constants_.MAX_BOTTOM_WIDTH + this.startX\n      );\n    }\n    return super.getDesiredRowWidth_(row);\n  }\n\n  override finalize_() {\n    // Performance note: this could be combined with the draw pass, if the time\n    // that this takes is excessive.  But it shouldn't be, because it only\n    // accesses and sets properties that already exist on the objects.\n    let widestRowWithConnectedBlocks = 0;\n    let yCursor = 0;\n    for (let i = 0, row; (row = this.rows[i]); i++) {\n      row.yPos = yCursor;\n      row.xPos = this.startX;\n      yCursor += row.height;\n\n      widestRowWithConnectedBlocks = Math.max(\n        widestRowWithConnectedBlocks,\n        row.widthWithConnectedBlocks,\n      );\n      // Add padding to the bottom row if block height is less than minimum\n      const heightWithoutHat = yCursor - this.topRow.ascenderHeight;\n      if (\n        row === this.bottomRow &&\n        heightWithoutHat < this.constants_.MIN_BLOCK_HEIGHT\n      ) {\n        // But the hat height shouldn't be part of this.\n        const diff = this.constants_.MIN_BLOCK_HEIGHT - heightWithoutHat;\n        this.bottomRow.height += diff;\n        yCursor += diff;\n      }\n      this.recordElemPositions_(row);\n    }\n    if (\n      this.outputConnection &&\n      this.block_.nextConnection &&\n      this.block_.nextConnection.isConnected()\n    ) {\n      const target = this.block_.nextConnection.targetBlock();\n      if (target) {\n        // Include width of connected block in value to stack width measurement.\n        widestRowWithConnectedBlocks = Math.max(\n          widestRowWithConnectedBlocks,\n          target.getHeightWidth().width - this.constants_.DARK_PATH_OFFSET,\n        );\n      }\n    }\n\n    this.bottomRow.baseline = yCursor - this.bottomRow.descenderHeight;\n    this.widthWithChildren =\n      widestRowWithConnectedBlocks +\n      this.startX +\n      this.constants_.DARK_PATH_OFFSET;\n    this.width += this.constants_.DARK_PATH_OFFSET;\n    this.height = yCursor + this.constants_.DARK_PATH_OFFSET;\n    this.startY = this.topRow.capline;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.geras.PathObject\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {BlockStyle} from '../../theme.js';\nimport * as colour from '../../utils/colour.js';\nimport * as dom from '../../utils/dom.js';\nimport {Svg} from '../../utils/svg.js';\nimport {PathObject as BasePathObject} from '../common/path_object.js';\n\nimport type {ConstantProvider} from './constants.js';\n\n/**\n * An object that handles creating and setting each of the SVG elements\n * used by the renderer.\n */\nexport class PathObject extends BasePathObject {\n  svgPathDark: SVGElement;\n  svgPathLight: SVGElement;\n\n  /**\n   * The colour of the dark path on the block in '#RRGGBB' format.\n   */\n  colourDark = '#000000';\n\n  /**\n   * @param root The root SVG element.\n   * @param style The style object to use for colouring.\n   * @param constants The renderer's constants.\n   */\n  constructor(\n    root: SVGElement,\n    style: BlockStyle,\n    public override constants: ConstantProvider,\n  ) {\n    super(root, style, constants);\n\n    /** The dark path of the block. */\n    this.svgPathDark = dom.createSvgElement(Svg.PATH, {\n      'class': 'blocklyPathDark',\n      'transform': 'translate(1,1)',\n    });\n    // SVG draw order is based on the order of elements (top most = back most)\n    // So we need to insert the dark path before the base path to make sure it\n    // gets drawn first.\n    this.svgRoot.insertBefore(this.svgPathDark, this.svgPath);\n\n    /** The light path of the block. */\n    this.svgPathLight = dom.createSvgElement(\n      Svg.PATH,\n      {'class': 'blocklyPathLight'},\n      this.svgRoot,\n    );\n  }\n\n  override setPath(mainPath: string) {\n    this.svgPath.setAttribute('d', mainPath);\n    this.svgPathDark.setAttribute('d', mainPath);\n  }\n\n  /**\n   * Set the highlight path generated by the renderer onto the SVG element.\n   *\n   * @param highlightPath The highlight path.\n   */\n  setHighlightPath(highlightPath: string) {\n    this.svgPathLight.setAttribute('d', highlightPath);\n  }\n\n  override flipRTL() {\n    // Mirror the block's path.\n    this.svgPath.setAttribute('transform', 'scale(-1 1)');\n    this.svgPathLight.setAttribute('transform', 'scale(-1 1)');\n    this.svgPathDark.setAttribute('transform', 'translate(1,1) scale(-1 1)');\n  }\n\n  override applyColour(block: BlockSvg) {\n    this.svgPathLight.style.display = '';\n    this.svgPathDark.style.display = '';\n    if (!this.style.colourTertiary) {\n      throw new Error(\n        'The renderer did not properly initialize the tertiary colour of ' +\n          'the block style',\n      );\n    }\n    this.svgPathLight.setAttribute('stroke', this.style.colourTertiary);\n    this.svgPathDark.setAttribute('fill', this.colourDark);\n\n    super.applyColour(block);\n\n    this.svgPath.setAttribute('stroke', 'none');\n  }\n\n  override setStyle(blockStyle: BlockStyle) {\n    this.style = blockStyle;\n    this.colourDark =\n      colour.blend('#000', this.style.colourPrimary, 0.2) || this.colourDark;\n  }\n\n  override updateHighlighted(highlighted: boolean) {\n    if (highlighted) {\n      this.svgPath.setAttribute(\n        'filter',\n        'url(#' + this.constants.embossFilterId + ')',\n      );\n      this.svgPathLight.style.display = 'none';\n    } else {\n      this.svgPath.setAttribute('filter', 'none');\n      this.svgPathLight.style.display = 'inline';\n    }\n  }\n\n  override updateShadow_(shadow: boolean) {\n    if (shadow) {\n      this.svgPathLight.style.display = 'none';\n      if (!this.style.colourSecondary) {\n        throw new Error(\n          'The renderer did not properly initialize the secondary colour ' +\n            'of the block style block style',\n        );\n      }\n      this.svgPathDark.setAttribute('fill', this.style.colourSecondary);\n      this.svgPath.setAttribute('stroke', 'none');\n      this.svgPath.setAttribute('fill', this.style.colourSecondary);\n    }\n  }\n\n  override updateDisabled_(disabled: boolean) {\n    super.updateDisabled_(disabled);\n    if (disabled) {\n      this.svgPath.setAttribute('stroke', 'none');\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.geras.Renderer\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {BlockStyle, Theme} from '../../theme.js';\nimport * as blockRendering from '../common/block_rendering.js';\nimport type {RenderInfo as BaseRenderInfo} from '../common/info.js';\nimport {Renderer as BaseRenderer} from '../common/renderer.js';\n\nimport {ConstantProvider} from './constants.js';\nimport {Drawer} from './drawer.js';\nimport {HighlightConstantProvider} from './highlight_constants.js';\nimport {RenderInfo} from './info.js';\nimport {PathObject} from './path_object.js';\n\n/**\n * The geras renderer. This renderer was designed to be backwards compatible\n * with pre-2019 Blockly. Newer projects that are not constrained by backwards\n * compatibility should use thrasos, which is a more modern take on this\n * renderer.\n *\n * Geras is the ancient Greek spirit of old age.\n */\nexport class Renderer extends BaseRenderer {\n  /** The renderer's highlight constant provider. */\n  private highlightConstants: HighlightConstantProvider | null = null;\n\n  /**\n   * @param name The renderer name.\n   */\n  constructor(name: string) {\n    super(name);\n  }\n\n  /**\n   * Initialize the renderer.  Geras has a highlight provider in addition to\n   * the normal constant provider.\n   */\n  override init(\n    theme: Theme,\n    opt_rendererOverrides?: {[rendererConstant: string]: any},\n  ) {\n    super.init(theme, opt_rendererOverrides);\n    this.highlightConstants = this.makeHighlightConstants_();\n    this.highlightConstants.init();\n  }\n\n  override refreshDom(svg: SVGElement, theme: Theme) {\n    super.refreshDom(svg, theme);\n    this.getHighlightConstants().init();\n  }\n\n  override makeConstants_() {\n    return new ConstantProvider();\n  }\n\n  /**\n   * Create a new instance of the renderer's render info object.\n   *\n   * @param block The block to measure.\n   * @returns The render info object.\n   */\n  protected override makeRenderInfo_(block: BlockSvg): RenderInfo {\n    return new RenderInfo(this, block);\n  }\n\n  /**\n   * Create a new instance of the renderer's drawer.\n   *\n   * @param block The block to render.\n   * @param info An object containing all information needed to render this\n   *     block.\n   * @returns The drawer.\n   */\n  protected override makeDrawer_(\n    block: BlockSvg,\n    info: BaseRenderInfo,\n  ): Drawer {\n    return new Drawer(block, info as RenderInfo);\n  }\n\n  /**\n   * Create a new instance of a renderer path object.\n   *\n   * @param root The root SVG element.\n   * @param style The style object to use for colouring.\n   * @returns The renderer path object.\n   */\n  override makePathObject(root: SVGElement, style: BlockStyle): PathObject {\n    return new PathObject(root, style, this.getConstants() as ConstantProvider);\n  }\n\n  /**\n   * Create a new instance of the renderer's highlight constant provider.\n   *\n   * @returns The highlight constant provider.\n   */\n  protected makeHighlightConstants_(): HighlightConstantProvider {\n    return new HighlightConstantProvider(this.getConstants());\n  }\n\n  /**\n   * Get the renderer's highlight constant provider.  We assume that when this\n   * is called, the renderer has already been initialized.\n   *\n   * @returns The highlight constant provider.\n   */\n  getHighlightConstants(): HighlightConstantProvider {\n    if (!this.highlightConstants) {\n      throw new Error(\n        'Cannot access the highlight constants because init has not ' +\n          'been called',\n      );\n    }\n    return this.highlightConstants;\n  }\n}\n\nblockRendering.register('geras', Renderer);\n","/** @file Re-exports of Blockly.geras.* modules. */\n\n/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.geras\n\nimport {ConstantProvider} from './constants.js';\nimport {Drawer} from './drawer.js';\nimport {HighlightConstantProvider} from './highlight_constants.js';\nimport {Highlighter} from './highlighter.js';\nimport {RenderInfo} from './info.js';\nimport {InlineInput} from './measurables/inline_input.js';\nimport {StatementInput} from './measurables/statement_input.js';\nimport {PathObject} from './path_object.js';\nimport {Renderer} from './renderer.js';\n\nexport {\n  ConstantProvider,\n  Drawer,\n  HighlightConstantProvider,\n  Highlighter,\n  InlineInput,\n  PathObject,\n  Renderer,\n  RenderInfo,\n  StatementInput,\n};\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.minimalist.ConstantProvider\n\nimport {ConstantProvider as BaseConstantProvider} from '../common/constants.js';\nimport * as deprecation from '../../utils/deprecation.js';\n\n/**\n * An object that provides constants for rendering blocks in the minimalist\n * renderer.\n *\n * @deprecated Use Blockly.blockRendering.ConstantProvider instead.\n *     To be removed in v11.\n */\nexport class ConstantProvider extends BaseConstantProvider {\n  /**\n   * @deprecated Use Blockly.blockRendering.ConstantProvider instead.\n   *     To be removed in v11.\n   */\n  constructor() {\n    super();\n    deprecation.warn(\n      'Blockly.minimalist.ConstantProvider',\n      'v10',\n      'v11',\n      'Blockly.blockRendering.ConstantProvider',\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.minimalist.Drawer\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport {Drawer as BaseDrawer} from '../common/drawer.js';\nimport * as deprecation from '../../utils/deprecation.js';\n\nimport type {RenderInfo} from './info.js';\n\n/**\n * An object that draws a block based on the given rendering information.\n *\n * @deprecated Use Blockly.blockRendering.Drawer instead.\n *     To be removed in v11.\n */\nexport class Drawer extends BaseDrawer {\n  /**\n   * @param block The block to render.\n   * @param info An object containing all information needed to render this\n   *     block.\n   *\n   * @deprecated Use Blockly.blockRendering.Drawer instead.\n   *     To be removed in v11.\n   */\n  constructor(block: BlockSvg, info: RenderInfo) {\n    super(block, info);\n    deprecation.warn(\n      'Blockly.minimalist.Drawer',\n      'v10',\n      'v11',\n      'Blockly.blockRendering.Drawer',\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.minimalist.RenderInfo\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport {RenderInfo as BaseRenderInfo} from '../common/info.js';\nimport * as deprecation from '../../utils/deprecation.js';\n\nimport type {Renderer} from './renderer.js';\n\n/**\n * An object containing all sizing information needed to draw this block.\n *\n * This measure pass does not propagate changes to the block (although fields\n * may choose to rerender when getSize() is called).  However, calling it\n * repeatedly may be expensive.\n *\n * @deprecated Use Blockly.blockRendering.RenderInfo instead. To be removed\n *     in v11.\n */\nexport class RenderInfo extends BaseRenderInfo {\n  // Exclamation is fine b/c this is assigned by the super constructor.\n  protected override renderer_!: Renderer;\n\n  /**\n   * @param renderer The renderer in use.\n   * @param block The block to measure.\n   * @deprecated Use Blockly.blockRendering.RenderInfo instead. To be removed\n   *     in v11.\n   */\n  constructor(renderer: Renderer, block: BlockSvg) {\n    super(renderer, block);\n    deprecation.warn(\n      'Blockly.minimalist.RenderInfo',\n      'v10',\n      'v11',\n      'Blockly.blockRendering.RenderInfo',\n    );\n  }\n\n  /**\n   * Get the block renderer in use.\n   *\n   * @returns The block renderer in use.\n   */\n  override getRenderer(): Renderer {\n    return this.renderer_;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.minimalist.Renderer\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport * as blockRendering from '../common/block_rendering.js';\nimport type {RenderInfo as BaseRenderInfo} from '../common/info.js';\nimport {Renderer as BaseRenderer} from '../common/renderer.js';\nimport * as deprecation from '../../utils/deprecation.js';\n\nimport {ConstantProvider} from './constants.js';\nimport {Drawer} from './drawer.js';\nimport {RenderInfo} from './info.js';\n\n/**\n * The minimalist renderer.\n *\n * @deprecated Use Blockly.blockRendering.Renderer instead. To be removed\n *     in v11.\n */\nexport class Renderer extends BaseRenderer {\n  /**\n   * @param name The renderer name.\n   * @deprecated Use Blockly.blockRendering.Renderer instead. To be removed\n   *     in v11.\n   */\n  constructor(name: string) {\n    super(name);\n    deprecation.warn(\n      'Blockly.minimalist.Renderer',\n      'v10',\n      'v11',\n      'Blockly.blockRendering.Renderer',\n    );\n  }\n\n  /**\n   * Create a new instance of the renderer's constant provider.\n   *\n   * @returns The constant provider.\n   */\n  protected override makeConstants_(): ConstantProvider {\n    return new ConstantProvider();\n  }\n\n  /**\n   * Create a new instance of the renderer's render info object.\n   *\n   * @param block The block to measure.\n   * @returns The render info object.\n   */\n  protected override makeRenderInfo_(block: BlockSvg): RenderInfo {\n    return new RenderInfo(this, block);\n  }\n\n  /**\n   * Create a new instance of the renderer's drawer.\n   *\n   * @param block The block to render.\n   * @param info An object containing all information needed to render this\n   *     block.\n   * @returns The drawer.\n   */\n  protected override makeDrawer_(\n    block: BlockSvg,\n    info: BaseRenderInfo,\n  ): Drawer {\n    return new Drawer(block, info as RenderInfo);\n  }\n}\n\nblockRendering.register('minimalist', Renderer);\n","/** @file Re-exports of Blockly.minimalist.* modules. */\n\n/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.minimalist\n\nimport {ConstantProvider} from './constants.js';\nimport {Drawer} from './drawer.js';\nimport {RenderInfo} from './info.js';\nimport {Renderer} from './renderer.js';\n\nexport {ConstantProvider, Drawer, Renderer, RenderInfo};\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.thrasos.RenderInfo\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport {RenderInfo as BaseRenderInfo} from '../common/info.js';\nimport type {Measurable} from '../measurables/base.js';\nimport type {BottomRow} from '../measurables/bottom_row.js';\nimport type {Field} from '../measurables/field.js';\nimport {InRowSpacer} from '../measurables/in_row_spacer.js';\nimport type {Row} from '../measurables/row.js';\nimport type {TopRow} from '../measurables/top_row.js';\nimport {Types} from '../measurables/types.js';\n\nimport type {Renderer} from './renderer.js';\n\n/**\n * An object containing all sizing information needed to draw this block.\n *\n * This measure pass does not propagate changes to the block (although fields\n * may choose to rerender when getSize() is called).  However, calling it\n * repeatedly may be expensive.\n */\nexport class RenderInfo extends BaseRenderInfo {\n  // Exclamation is fine b/c this is assigned by the super constructor.\n  protected override renderer_!: Renderer;\n\n  /**\n   * @param renderer The renderer in use.\n   * @param block The block to measure.\n   */\n  constructor(renderer: Renderer, block: BlockSvg) {\n    super(renderer, block);\n  }\n\n  /**\n   * Get the block renderer in use.\n   *\n   * @returns The block renderer in use.\n   */\n  override getRenderer(): Renderer {\n    return this.renderer_;\n  }\n\n  override addElemSpacing_() {\n    let hasExternalInputs = false;\n    for (let i = 0; i < this.rows.length; i++) {\n      const row = this.rows[i];\n      if (row.hasExternalInput) {\n        hasExternalInputs = true;\n        break;\n      }\n    }\n    for (let i = 0; i < this.rows.length; i++) {\n      const row = this.rows[i];\n      const oldElems = row.elements;\n      row.elements = [];\n      // No spacing needed before the corner on the top row or the bottom row.\n      if (row.startsWithElemSpacer()) {\n        // There's a spacer before the first element in the row.\n        row.elements.push(\n          new InRowSpacer(\n            this.constants_,\n            this.getInRowSpacing_(null, oldElems[0]),\n          ),\n        );\n      }\n      if (!oldElems.length) {\n        continue;\n      }\n      for (let e = 0; e < oldElems.length - 1; e++) {\n        row.elements.push(oldElems[e]);\n        const spacing = this.getInRowSpacing_(oldElems[e], oldElems[e + 1]);\n        row.elements.push(new InRowSpacer(this.constants_, spacing));\n      }\n      row.elements.push(oldElems[oldElems.length - 1]);\n      if (row.endsWithElemSpacer()) {\n        let spacing = this.getInRowSpacing_(\n          oldElems[oldElems.length - 1],\n          null,\n        );\n        if (hasExternalInputs && row.hasDummyInput) {\n          spacing += this.constants_.TAB_WIDTH;\n        }\n        // There's a spacer after the last element in the row.\n        row.elements.push(new InRowSpacer(this.constants_, spacing));\n      }\n    }\n  }\n\n  override getInRowSpacing_(prev: Measurable | null, next: Measurable | null) {\n    if (!prev) {\n      // Between an editable field and the beginning of the row.\n      if (next && Types.isField(next) && (next as Field).isEditable) {\n        return this.constants_.MEDIUM_PADDING;\n      }\n      // Inline input at the beginning of the row.\n      if (next && Types.isInlineInput(next)) {\n        return this.constants_.MEDIUM_LARGE_PADDING;\n      }\n      if (next && Types.isStatementInput(next)) {\n        return this.constants_.STATEMENT_INPUT_PADDING_LEFT;\n      }\n      // Anything else at the beginning of the row.\n      return this.constants_.LARGE_PADDING;\n    }\n\n    // Spacing between a non-input and the end of the row.\n    if (!Types.isInput(prev) && !next) {\n      // Between an editable field and the end of the row.\n      if (Types.isField(prev) && (prev as Field).isEditable) {\n        return this.constants_.MEDIUM_PADDING;\n      }\n      // Padding at the end of an icon-only row to make the block shape clearer.\n      if (Types.isIcon(prev)) {\n        return this.constants_.LARGE_PADDING * 2 + 1;\n      }\n      if (Types.isHat(prev)) {\n        return this.constants_.NO_PADDING;\n      }\n      // Establish a minimum width for a block with a previous or next\n      // connection.\n      if (Types.isPreviousOrNextConnection(prev)) {\n        return this.constants_.LARGE_PADDING;\n      }\n      // Between rounded corner and the end of the row.\n      if (Types.isLeftRoundedCorner(prev)) {\n        return this.constants_.MIN_BLOCK_WIDTH;\n      }\n      // Between a jagged edge and the end of the row.\n      if (Types.isJaggedEdge(prev)) {\n        return this.constants_.NO_PADDING;\n      }\n      // Between noneditable fields and icons and the end of the row.\n      return this.constants_.LARGE_PADDING;\n    }\n    // Between inputs and the end of the row.\n    if (Types.isInput(prev) && !next) {\n      if (Types.isExternalInput(prev)) {\n        return this.constants_.NO_PADDING;\n      } else if (Types.isInlineInput(prev)) {\n        return this.constants_.LARGE_PADDING;\n      } else if (Types.isStatementInput(prev)) {\n        return this.constants_.NO_PADDING;\n      }\n    }\n\n    // Spacing between a non-input and an input.\n    if (!Types.isInput(prev) && next && Types.isInput(next)) {\n      // Between an editable field and an input.\n      if (Types.isField(prev) && (prev as Field).isEditable) {\n        if (Types.isInlineInput(next)) {\n          return this.constants_.SMALL_PADDING;\n        } else if (Types.isExternalInput(next)) {\n          return this.constants_.SMALL_PADDING;\n        }\n      } else {\n        if (Types.isInlineInput(next)) {\n          return this.constants_.MEDIUM_LARGE_PADDING;\n        } else if (Types.isExternalInput(next)) {\n          return this.constants_.MEDIUM_LARGE_PADDING;\n        } else if (Types.isStatementInput(next)) {\n          return this.constants_.LARGE_PADDING;\n        }\n      }\n      return this.constants_.LARGE_PADDING - 1;\n    }\n\n    // Spacing between an icon and an icon or field.\n    if (Types.isIcon(prev) && next && !Types.isInput(next)) {\n      return this.constants_.LARGE_PADDING;\n    }\n\n    // Spacing between an inline input and a field.\n    if (Types.isInlineInput(prev) && next && Types.isField(next)) {\n      // Editable field after inline input.\n      if ((next as Field).isEditable) {\n        return this.constants_.MEDIUM_PADDING;\n      } else {\n        // Noneditable field after inline input.\n        return this.constants_.LARGE_PADDING;\n      }\n    }\n\n    if (Types.isLeftSquareCorner(prev) && next) {\n      // Spacing between a hat and a corner\n      if (Types.isHat(next)) {\n        return this.constants_.NO_PADDING;\n      }\n      // Spacing between a square corner and a previous or next connection\n      if (Types.isPreviousConnection(next) || Types.isNextConnection(next)) {\n        return next.notchOffset;\n      }\n    }\n    // Spacing between a rounded corner and a previous or next connection.\n    if (Types.isLeftRoundedCorner(prev) && next) {\n      return next.notchOffset - this.constants_.CORNER_RADIUS;\n    }\n\n    // Spacing between two fields of the same editability.\n    if (\n      Types.isField(prev) &&\n      next &&\n      Types.isField(next) &&\n      (prev as Field).isEditable === (next as Field).isEditable\n    ) {\n      return this.constants_.LARGE_PADDING;\n    }\n\n    // Spacing between anything and a jagged edge.\n    if (next && Types.isJaggedEdge(next)) {\n      return this.constants_.LARGE_PADDING;\n    }\n\n    return this.constants_.MEDIUM_PADDING;\n  }\n\n  override getSpacerRowHeight_(prev: Row, next: Row) {\n    // If we have an empty block add a spacer to increase the height.\n    if (Types.isTopRow(prev) && Types.isBottomRow(next)) {\n      return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;\n    }\n    // Top and bottom rows act as a spacer so we don't need any extra padding.\n    if (Types.isTopRow(prev) || Types.isBottomRow(next)) {\n      return this.constants_.NO_PADDING;\n    }\n    if (prev.hasExternalInput && next.hasExternalInput) {\n      return this.constants_.LARGE_PADDING;\n    }\n    if (!prev.hasStatement && next.hasStatement) {\n      return this.constants_.BETWEEN_STATEMENT_PADDING_Y;\n    }\n    if (prev.hasStatement && next.hasStatement) {\n      return this.constants_.LARGE_PADDING;\n    }\n    if (prev.hasDummyInput || next.hasDummyInput) {\n      return this.constants_.LARGE_PADDING;\n    }\n    return this.constants_.MEDIUM_PADDING;\n  }\n\n  override getElemCenterline_(row: Row, elem: Measurable) {\n    if (Types.isSpacer(elem)) {\n      return row.yPos + elem.height / 2;\n    }\n    if (Types.isBottomRow(row)) {\n      const bottomRow = row as BottomRow;\n      const baseline =\n        bottomRow.yPos + bottomRow.height - bottomRow.descenderHeight;\n      if (Types.isNextConnection(elem)) {\n        return baseline + elem.height / 2;\n      }\n      return baseline - elem.height / 2;\n    }\n    if (Types.isTopRow(row)) {\n      const topRow = row as TopRow;\n      if (Types.isHat(elem)) {\n        return topRow.capline - elem.height / 2;\n      }\n      return topRow.capline + elem.height / 2;\n    }\n\n    let result = row.yPos;\n    if (Types.isField(elem) && row.hasStatement) {\n      const offset =\n        this.constants_.TALL_INPUT_FIELD_OFFSET_Y + elem.height / 2;\n      result += offset;\n    } else {\n      result += row.height / 2;\n    }\n    return result;\n  }\n\n  override finalize_() {\n    // Performance note: this could be combined with the draw pass, if the time\n    // that this takes is excessive.  But it shouldn't be, because it only\n    // accesses and sets properties that already exist on the objects.\n    let widestRowWithConnectedBlocks = 0;\n    let yCursor = 0;\n    for (let i = 0; i < this.rows.length; i++) {\n      const row = this.rows[i];\n      row.yPos = yCursor;\n      row.xPos = this.startX;\n      yCursor += row.height;\n\n      widestRowWithConnectedBlocks = Math.max(\n        widestRowWithConnectedBlocks,\n        row.widthWithConnectedBlocks,\n      );\n      // Add padding to the bottom row if block height is less than minimum\n      const heightWithoutHat = yCursor - this.topRow.ascenderHeight;\n      if (\n        row === this.bottomRow &&\n        heightWithoutHat < this.constants_.MIN_BLOCK_HEIGHT\n      ) {\n        // But the hat height shouldn't be part of this.\n        const diff = this.constants_.MIN_BLOCK_HEIGHT - heightWithoutHat;\n        this.bottomRow.height += diff;\n        yCursor += diff;\n      }\n      this.recordElemPositions_(row);\n    }\n    if (\n      this.outputConnection &&\n      this.block_.nextConnection &&\n      this.block_.nextConnection.isConnected()\n    ) {\n      const target = this.block_.nextConnection.targetBlock();\n      if (target) {\n        // Include width of connected block in value to stack width measurement.\n        widestRowWithConnectedBlocks = Math.max(\n          widestRowWithConnectedBlocks,\n          target.getHeightWidth().width,\n        );\n      }\n    }\n\n    this.bottomRow.baseline = yCursor - this.bottomRow.descenderHeight;\n    this.widthWithChildren = widestRowWithConnectedBlocks + this.startX;\n\n    this.height = yCursor;\n    this.startY = this.topRow.capline;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.thrasos.Renderer\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport * as blockRendering from '../common/block_rendering.js';\nimport {Renderer as BaseRenderer} from '../common/renderer.js';\n\nimport {RenderInfo} from './info.js';\n\n/**\n * The thrasos renderer. This is a more modern take on the legacy geras\n * renderer.\n *\n * Thrasos is the ancient Greek spirit of boldness.\n */\nexport class Renderer extends BaseRenderer {\n  /**\n   * @param name The renderer name.\n   */\n  constructor(name: string) {\n    super(name);\n  }\n\n  /**\n   * Create a new instance of the renderer's render info object.\n   *\n   * @param block The block to measure.\n   * @returns The render info object.\n   */\n  protected override makeRenderInfo_(block: BlockSvg): RenderInfo {\n    return new RenderInfo(this, block);\n  }\n}\n\nblockRendering.register('thrasos', Renderer);\n","/** @file Re-exports of Blockly.thrasos.* modules. */\n\n/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.thrasos\n\nimport {RenderInfo} from './info.js';\nimport {Renderer} from './renderer.js';\n\nexport {Renderer, RenderInfo};\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.Themes.Zelos\n\nimport {Theme} from '../theme.js';\n\nconst defaultBlockStyles = {\n  'colour_blocks': {\n    'colourPrimary': '#CF63CF',\n    'colourSecondary': '#C94FC9',\n    'colourTertiary': '#BD42BD',\n  },\n  'list_blocks': {\n    'colourPrimary': '#9966FF',\n    'colourSecondary': '#855CD6',\n    'colourTertiary': '#774DCB',\n  },\n  'logic_blocks': {\n    'colourPrimary': '#4C97FF',\n    'colourSecondary': '#4280D7',\n    'colourTertiary': '#3373CC',\n  },\n  'loop_blocks': {\n    'colourPrimary': '#0fBD8C',\n    'colourSecondary': '#0DA57A',\n    'colourTertiary': '#0B8E69',\n  },\n  'math_blocks': {\n    'colourPrimary': '#59C059',\n    'colourSecondary': '#46B946',\n    'colourTertiary': '#389438',\n  },\n  'procedure_blocks': {\n    'colourPrimary': '#FF6680',\n    'colourSecondary': '#FF4D6A',\n    'colourTertiary': '#FF3355',\n  },\n  'text_blocks': {\n    'colourPrimary': '#FFBF00',\n    'colourSecondary': '#E6AC00',\n    'colourTertiary': '#CC9900',\n  },\n  'variable_blocks': {\n    'colourPrimary': '#FF8C1A',\n    'colourSecondary': '#FF8000',\n    'colourTertiary': '#DB6E00',\n  },\n  'variable_dynamic_blocks': {\n    'colourPrimary': '#FF8C1A',\n    'colourSecondary': '#FF8000',\n    'colourTertiary': '#DB6E00',\n  },\n  'hat_blocks': {\n    'colourPrimary': '#4C97FF',\n    'colourSecondary': '#4280D7',\n    'colourTertiary': '#3373CC',\n    'hat': 'cap',\n  },\n};\n\nconst categoryStyles = {\n  'colour_category': {'colour': '#CF63CF'},\n  'list_category': {'colour': '#9966FF'},\n  'logic_category': {'colour': '#4C97FF'},\n  'loop_category': {'colour': '#0fBD8C'},\n  'math_category': {'colour': '#59C059'},\n  'procedure_category': {'colour': '#FF6680'},\n  'text_category': {'colour': '#FFBF00'},\n  'variable_category': {'colour': '#FF8C1A'},\n  'variable_dynamic_category': {'colour': '#FF8C1A'},\n};\n\n/**\n * Zelos theme.\n */\nexport const Zelos = new Theme('zelos', defaultBlockStyles, categoryStyles);\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.Themes\n\nimport {Classic} from './classic.js';\nimport {Zelos} from './zelos.js';\n\nexport {Classic, Zelos};\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * An item in the toolbox.\n *\n * @class\n */\n// Former goog.module ID: Blockly.ToolboxItem\n\nimport type {ICollapsibleToolboxItem} from '../interfaces/i_collapsible_toolbox_item.js';\nimport type {IToolbox} from '../interfaces/i_toolbox.js';\nimport type {IToolboxItem} from '../interfaces/i_toolbox_item.js';\nimport * as idGenerator from '../utils/idgenerator.js';\nimport type * as toolbox from '../utils/toolbox.js';\nimport type {WorkspaceSvg} from '../workspace_svg.js';\n\n/**\n * Class for an item in the toolbox.\n */\nexport class ToolboxItem implements IToolboxItem {\n  protected id_: string;\n  protected parent_: ICollapsibleToolboxItem | null;\n  protected level_: number;\n  protected toolboxItemDef_: toolbox.ToolboxItemInfo | null;\n  protected workspace_: WorkspaceSvg;\n  /** The toolbox this category belongs to. */\n  protected readonly parentToolbox_: IToolbox;\n\n  /**\n   * @param toolboxItemDef The JSON defining the toolbox item.\n   * @param parentToolbox The toolbox that holds the toolbox item.\n   * @param opt_parent The parent toolbox item or null if the category does not\n   *     have a parent.\n   */\n  constructor(\n    toolboxItemDef: toolbox.ToolboxItemInfo,\n    parentToolbox: IToolbox,\n    opt_parent?: ICollapsibleToolboxItem,\n  ) {\n    /** The ID for the category. */\n    this.id_ =\n      (toolboxItemDef as AnyDuringMigration)['toolboxitemid'] ||\n      idGenerator.getNextUniqueId();\n\n    /** The parent of the category. */\n    this.parent_ = opt_parent || null;\n\n    /** The level that the category is nested at. */\n    this.level_ = this.parent_ ? this.parent_.getLevel() + 1 : 0;\n\n    /** The JSON definition of the toolbox item. */\n    this.toolboxItemDef_ = toolboxItemDef;\n\n    this.parentToolbox_ = parentToolbox;\n\n    /** The workspace of the parent toolbox. */\n    this.workspace_ = this.parentToolbox_.getWorkspace();\n  }\n\n  /**\n   * Initializes the toolbox item.\n   * This includes creating the DOM and updating the state of any items based\n   * on the info object.\n   */\n  init() {}\n  // No-op by default.\n\n  /**\n   * Gets the div for the toolbox item.\n   *\n   * @returns The div for the toolbox item.\n   */\n  getDiv(): Element | null {\n    return null;\n  }\n\n  /**\n   * Gets the HTML element that is clickable.\n   * The parent toolbox element receives clicks. The parent toolbox will add an\n   * ID to this element so it can pass the onClick event to the correct\n   * toolboxItem.\n   *\n   * @returns The HTML element that receives clicks, or null if this item should\n   *     not receive clicks.\n   */\n  getClickTarget(): Element | null {\n    return null;\n  }\n\n  /**\n   * Gets a unique identifier for this toolbox item.\n   *\n   * @returns The ID for the toolbox item.\n   */\n  getId(): string {\n    return this.id_;\n  }\n\n  /**\n   * Gets the parent if the toolbox item is nested.\n   *\n   * @returns The parent toolbox item, or null if this toolbox item is not\n   *     nested.\n   */\n  getParent(): ICollapsibleToolboxItem | null {\n    return null;\n  }\n\n  /**\n   * Gets the nested level of the category.\n   *\n   * @returns The nested level of the category.\n   * @internal\n   */\n  getLevel(): number {\n    return this.level_;\n  }\n\n  /**\n   * Whether the toolbox item is selectable.\n   *\n   * @returns True if the toolbox item can be selected.\n   */\n  isSelectable(): boolean {\n    return false;\n  }\n\n  /**\n   * Whether the toolbox item is collapsible.\n   *\n   * @returns True if the toolbox item is collapsible.\n   */\n  isCollapsible(): boolean {\n    return false;\n  }\n\n  /** Dispose of this toolbox item. No-op by default. */\n  dispose() {}\n\n  /**\n   * Sets whether the category is visible or not.\n   * For a category to be visible its parent category must also be expanded.\n   *\n   * @param _isVisible True if category should be visible.\n   */\n  setVisible_(_isVisible: boolean) {}\n}\n// nop by default\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * A toolbox category used to organize blocks in the toolbox.\n *\n * @class\n */\n// Former goog.module ID: Blockly.ToolboxCategory\n\nimport * as Css from '../css.js';\nimport type {ICollapsibleToolboxItem} from '../interfaces/i_collapsible_toolbox_item.js';\nimport type {ISelectableToolboxItem} from '../interfaces/i_selectable_toolbox_item.js';\nimport type {IToolbox} from '../interfaces/i_toolbox.js';\nimport type {IToolboxItem} from '../interfaces/i_toolbox_item.js';\nimport type {\n  CategoryInfo,\n  DynamicCategoryInfo,\n  FlyoutDefinition,\n  FlyoutItemInfo,\n  FlyoutItemInfoArray,\n  StaticCategoryInfo,\n} from '../utils/toolbox.js';\nimport * as registry from '../registry.js';\nimport * as aria from '../utils/aria.js';\nimport * as colourUtils from '../utils/colour.js';\nimport * as dom from '../utils/dom.js';\nimport * as parsing from '../utils/parsing.js';\nimport * as toolbox from '../utils/toolbox.js';\n\nimport {ToolboxItem} from './toolbox_item.js';\n\n/**\n * Class for a category in a toolbox.\n */\nexport class ToolboxCategory\n  extends ToolboxItem\n  implements ISelectableToolboxItem\n{\n  /** Name used for registering a toolbox category. */\n  static registrationName = 'category';\n\n  /** The number of pixels to move the category over at each nested level. */\n  static nestedPadding = 19;\n\n  /** The width in pixels of the strip of colour next to each category. */\n  static borderWidth = 8;\n\n  /**\n   * The default colour of the category. This is used as the background colour\n   * of the category when it is selected.\n   */\n  static defaultBackgroundColour = '#57e';\n\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  override toolboxItemDef_!: CategoryInfo;\n\n  /** The name that will be displayed on the category. */\n  protected name_ = '';\n\n  /** The colour of the category. */\n  protected colour_ = '';\n\n  /** The HTML container for the category. */\n  protected htmlDiv_: HTMLDivElement | null = null;\n\n  /** The HTML element for the category row. */\n  protected rowDiv_: HTMLDivElement | null = null;\n\n  /** The HTML element that holds children elements of the category row. */\n  protected rowContents_: HTMLDivElement | null = null;\n\n  /** The HTML element for the toolbox icon. */\n  protected iconDom_: Element | null = null;\n\n  /** The HTML element for the toolbox label. */\n  protected labelDom_: Element | null = null;\n  protected cssConfig_: CssConfig;\n\n  /** True if the category is meant to be hidden, false otherwise. */\n  protected isHidden_ = false;\n\n  /** True if this category is disabled, false otherwise. */\n  protected isDisabled_ = false;\n\n  /** The flyout items for this category. */\n  protected flyoutItems_: string | FlyoutItemInfoArray = [];\n\n  /**\n   * @param categoryDef The information needed to create a category in the\n   *     toolbox.\n   * @param parentToolbox The parent toolbox for the category.\n   * @param opt_parent The parent category or null if the category does not have\n   *     a parent.\n   */\n  constructor(\n    categoryDef: CategoryInfo,\n    parentToolbox: IToolbox,\n    opt_parent?: ICollapsibleToolboxItem,\n  ) {\n    super(categoryDef, parentToolbox, opt_parent);\n\n    /** All the css class names that are used to create a category. */\n    this.cssConfig_ = this.makeDefaultCssConfig_();\n  }\n\n  /**\n   * Initializes the toolbox item.\n   * This includes creating the DOM and updating the state of any items based\n   * on the info object.\n   * Init should be called immediately after the construction of the toolbox\n   * item, to ensure that the category contents are properly parsed.\n   */\n  override init() {\n    this.parseCategoryDef_(this.toolboxItemDef_);\n    this.parseContents_(this.toolboxItemDef_);\n    this.createDom_();\n    if (this.toolboxItemDef_['hidden'] === 'true') {\n      this.hide();\n    }\n  }\n\n  /**\n   * Creates an object holding the default classes for a category.\n   *\n   * @returns The configuration object holding all the CSS classes for a\n   *     category.\n   */\n  protected makeDefaultCssConfig_(): CssConfig {\n    return {\n      'container': 'blocklyToolboxCategory',\n      'row': 'blocklyTreeRow',\n      'rowcontentcontainer': 'blocklyTreeRowContentContainer',\n      'icon': 'blocklyTreeIcon',\n      'label': 'blocklyTreeLabel',\n      'contents': 'blocklyToolboxContents',\n      'selected': 'blocklyTreeSelected',\n      'openicon': 'blocklyTreeIconOpen',\n      'closedicon': 'blocklyTreeIconClosed',\n    };\n  }\n\n  /**\n   * Parses the contents array depending on if the category is a dynamic\n   * category, or if its contents are meant to be shown in the flyout.\n   *\n   * @param categoryDef The information needed to create a category.\n   */\n  protected parseContents_(categoryDef: CategoryInfo) {\n    if ('custom' in categoryDef) {\n      this.flyoutItems_ = categoryDef['custom'];\n    } else {\n      const contents = categoryDef['contents'];\n      if (!contents) return;\n\n      for (let i = 0; i < contents.length; i++) {\n        const itemDef = contents[i];\n        const flyoutItem = itemDef as FlyoutItemInfo;\n        if (Array.isArray(this.flyoutItems_)) {\n          this.flyoutItems_.push(flyoutItem);\n        }\n      }\n    }\n  }\n\n  /**\n   * Parses the non-contents parts of the category def.\n   *\n   * @param categoryDef The information needed to create a category.\n   */\n  protected parseCategoryDef_(categoryDef: CategoryInfo) {\n    this.name_ =\n      'name' in categoryDef\n        ? parsing.replaceMessageReferences(categoryDef['name'])\n        : '';\n    this.colour_ = this.getColour_(categoryDef);\n    Object.assign(\n      this.cssConfig_,\n      categoryDef['cssconfig'] || (categoryDef as any)['cssConfig'],\n    );\n  }\n\n  /**\n   * Creates the DOM for the category.\n   *\n   * @returns The parent element for the category.\n   */\n  protected createDom_(): HTMLDivElement {\n    this.htmlDiv_ = this.createContainer_();\n    aria.setRole(this.htmlDiv_, aria.Role.TREEITEM);\n    aria.setState(this.htmlDiv_, aria.State.SELECTED, false);\n    aria.setState(this.htmlDiv_, aria.State.LEVEL, this.level_ + 1);\n\n    this.rowDiv_ = this.createRowContainer_();\n    this.rowDiv_.style.pointerEvents = 'auto';\n    this.htmlDiv_.appendChild(this.rowDiv_);\n\n    this.rowContents_ = this.createRowContentsContainer_();\n    this.rowContents_.style.pointerEvents = 'none';\n    this.rowDiv_.appendChild(this.rowContents_);\n\n    this.iconDom_ = this.createIconDom_();\n    aria.setRole(this.iconDom_, aria.Role.PRESENTATION);\n    this.rowContents_.appendChild(this.iconDom_);\n\n    this.labelDom_ = this.createLabelDom_(this.name_);\n    this.rowContents_.appendChild(this.labelDom_);\n\n    const id = this.labelDom_.getAttribute('id');\n    if (id) {\n      aria.setState(this.htmlDiv_, aria.State.LABELLEDBY, id);\n    }\n\n    this.addColourBorder_(this.colour_);\n\n    return this.htmlDiv_;\n  }\n\n  /**\n   * Creates the container that holds the row and any subcategories.\n   *\n   * @returns The div that holds the icon and the label.\n   */\n  protected createContainer_(): HTMLDivElement {\n    const container = document.createElement('div');\n    const className = this.cssConfig_['container'];\n    if (className) {\n      dom.addClass(container, className);\n    }\n    return container;\n  }\n\n  /**\n   * Creates the parent of the contents container. All clicks will happen on\n   * this div.\n   *\n   * @returns The div that holds the contents container.\n   */\n  protected createRowContainer_(): HTMLDivElement {\n    const rowDiv = document.createElement('div');\n    const className = this.cssConfig_['row'];\n    if (className) {\n      dom.addClass(rowDiv, className);\n    }\n    const nestedPadding = `${\n      ToolboxCategory.nestedPadding * this.getLevel()\n    }px`;\n    this.workspace_.RTL\n      ? (rowDiv.style.paddingRight = nestedPadding)\n      : (rowDiv.style.paddingLeft = nestedPadding);\n    return rowDiv;\n  }\n\n  /**\n   * Creates the container for the label and icon.\n   * This is necessary so we can set all subcategory pointer events to none.\n   *\n   * @returns The div that holds the icon and the label.\n   */\n  protected createRowContentsContainer_(): HTMLDivElement {\n    const contentsContainer = document.createElement('div');\n    const className = this.cssConfig_['rowcontentcontainer'];\n    if (className) {\n      dom.addClass(contentsContainer, className);\n    }\n    return contentsContainer;\n  }\n\n  /**\n   * Creates the span that holds the category icon.\n   *\n   * @returns The span that holds the category icon.\n   */\n  protected createIconDom_(): Element {\n    const toolboxIcon = document.createElement('span');\n    if (!this.parentToolbox_.isHorizontal()) {\n      const className = this.cssConfig_['icon'];\n      if (className) {\n        dom.addClass(toolboxIcon, className);\n      }\n    }\n\n    toolboxIcon.style.display = 'inline-block';\n    return toolboxIcon;\n  }\n\n  /**\n   * Creates the span that holds the category label.\n   * This should have an ID for accessibility purposes.\n   *\n   * @param name The name of the category.\n   * @returns The span that holds the category label.\n   */\n  protected createLabelDom_(name: string): Element {\n    const toolboxLabel = document.createElement('span');\n    toolboxLabel.setAttribute('id', this.getId() + '.label');\n    toolboxLabel.textContent = name;\n    const className = this.cssConfig_['label'];\n    if (className) {\n      dom.addClass(toolboxLabel, className);\n    }\n    return toolboxLabel;\n  }\n\n  /** Updates the colour for this category. */\n  refreshTheme() {\n    this.colour_ = this.getColour_(this.toolboxItemDef_);\n    this.addColourBorder_(this.colour_);\n  }\n\n  /**\n   * Add the strip of colour to the toolbox category.\n   *\n   * @param colour The category colour.\n   */\n  protected addColourBorder_(colour: string) {\n    if (colour) {\n      const border =\n        ToolboxCategory.borderWidth + 'px solid ' + (colour || '#ddd');\n      if (this.workspace_.RTL) {\n        this.rowDiv_!.style.borderRight = border;\n      } else {\n        this.rowDiv_!.style.borderLeft = border;\n      }\n    }\n  }\n\n  /**\n   * Gets either the colour or the style for a category.\n   *\n   * @param categoryDef The object holding information on the category.\n   * @returns The hex colour for the category.\n   */\n  protected getColour_(categoryDef: CategoryInfo): string {\n    const styleName =\n      categoryDef['categorystyle'] || (categoryDef as any)['categoryStyle'];\n    const colour = categoryDef['colour'];\n\n    if (colour && styleName) {\n      console.warn(\n        'Toolbox category \"' +\n          this.name_ +\n          '\" must not have both a style and a colour',\n      );\n    } else if (styleName) {\n      return this.getColourfromStyle_(styleName);\n    } else if (colour) {\n      return this.parseColour_(colour);\n    }\n    return '';\n  }\n\n  /**\n   * Sets the colour for the category using the style name and returns the new\n   * colour as a hex string.\n   *\n   * @param styleName Name of the style.\n   * @returns The hex colour for the category.\n   */\n  private getColourfromStyle_(styleName: string): string {\n    const theme = this.workspace_.getTheme();\n    if (styleName && theme) {\n      const style = theme.categoryStyles[styleName];\n      if (style && style.colour) {\n        return this.parseColour_(style.colour);\n      } else {\n        console.warn(\n          'Style \"' + styleName + '\" must exist and contain a colour value',\n        );\n      }\n    }\n    return '';\n  }\n\n  /**\n   * Gets the HTML element that is clickable.\n   * The parent toolbox element receives clicks. The parent toolbox will add an\n   * ID to this element so it can pass the onClick event to the correct\n   * toolboxItem.\n   *\n   * @returns The HTML element that receives clicks.\n   */\n  override getClickTarget(): Element {\n    return this.rowDiv_ as Element;\n  }\n\n  /**\n   * Parses the colour on the category.\n   *\n   * @param colourValue HSV hue value (0 to 360), #RRGGBB string, or a message\n   *     reference string pointing to one of those two values.\n   * @returns The hex colour for the category.\n   */\n  private parseColour_(colourValue: number | string): string {\n    // Decode the colour for any potential message references\n    // (eg. `%{BKY_MATH_HUE}`).\n    const colour = parsing.replaceMessageReferences(colourValue);\n    if (colour == null || colour === '') {\n      // No attribute. No colour.\n      return '';\n    } else {\n      const hue = Number(colour);\n      if (!isNaN(hue)) {\n        return colourUtils.hueToHex(hue);\n      } else {\n        const hex = colourUtils.parse(colour);\n        if (hex) {\n          return hex;\n        } else {\n          console.warn(\n            'Toolbox category \"' +\n              this.name_ +\n              '\" has unrecognized colour attribute: ' +\n              colour,\n          );\n          return '';\n        }\n      }\n    }\n  }\n\n  /**\n   * Adds appropriate classes to display an open icon.\n   *\n   * @param iconDiv The div that holds the icon.\n   */\n  protected openIcon_(iconDiv: Element | null) {\n    if (!iconDiv) {\n      return;\n    }\n    const closedIconClass = this.cssConfig_['closedicon'];\n    if (closedIconClass) {\n      dom.removeClasses(iconDiv, closedIconClass);\n    }\n    const className = this.cssConfig_['openicon'];\n    if (className) {\n      dom.addClass(iconDiv, className);\n    }\n  }\n\n  /**\n   * Adds appropriate classes to display a closed icon.\n   *\n   * @param iconDiv The div that holds the icon.\n   */\n  protected closeIcon_(iconDiv: Element | null) {\n    if (!iconDiv) {\n      return;\n    }\n    const openIconClass = this.cssConfig_['openicon'];\n    if (openIconClass) {\n      dom.removeClasses(iconDiv, openIconClass);\n    }\n    const className = this.cssConfig_['closedicon'];\n    if (className) {\n      dom.addClass(iconDiv, className);\n    }\n  }\n\n  /**\n   * Sets whether the category is visible or not.\n   * For a category to be visible its parent category must also be expanded.\n   *\n   * @param isVisible True if category should be visible.\n   */\n  override setVisible_(isVisible: boolean) {\n    this.htmlDiv_!.style.display = isVisible ? 'block' : 'none';\n    this.isHidden_ = !isVisible;\n\n    if (this.parentToolbox_.getSelectedItem() === this) {\n      this.parentToolbox_.clearSelection();\n    }\n  }\n\n  /** Hide the category. */\n  hide() {\n    this.setVisible_(false);\n  }\n\n  /**\n   * Show the category. Category will only appear if its parent category is also\n   * expanded.\n   */\n  show() {\n    this.setVisible_(true);\n  }\n\n  /**\n   * Whether the category is visible.\n   * A category is only visible if all of its ancestors are expanded and\n   * isHidden_ is false.\n   *\n   * @returns True if the category is visible, false otherwise.\n   */\n  isVisible(): boolean {\n    return !this.isHidden_ && this.allAncestorsExpanded_();\n  }\n\n  /**\n   * Whether all ancestors of a category (parent and parent's parent, etc.) are\n   * expanded.\n   *\n   * @returns True only if every ancestor is expanded\n   */\n  protected allAncestorsExpanded_(): boolean {\n    /* eslint-disable-next-line @typescript-eslint/no-this-alias */\n    let category: IToolboxItem = this;\n    while (category.getParent()) {\n      category = category.getParent()!;\n      if (!(category as ICollapsibleToolboxItem).isExpanded()) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  override isSelectable() {\n    return this.isVisible() && !this.isDisabled_;\n  }\n\n  /**\n   * Handles when the toolbox item is clicked.\n   *\n   * @param _e Click event to handle.\n   */\n  onClick(_e: Event) {}\n  // No-op\n\n  /**\n   * Sets the current category as selected.\n   *\n   * @param isSelected True if this category is selected, false otherwise.\n   */\n  setSelected(isSelected: boolean) {\n    if (!this.rowDiv_) {\n      return;\n    }\n    const className = this.cssConfig_['selected'];\n    if (isSelected) {\n      const defaultColour = this.parseColour_(\n        ToolboxCategory.defaultBackgroundColour,\n      );\n      this.rowDiv_.style.backgroundColor = this.colour_ || defaultColour;\n      if (className) {\n        dom.addClass(this.rowDiv_, className);\n      }\n    } else {\n      this.rowDiv_.style.backgroundColor = '';\n      if (className) {\n        dom.removeClass(this.rowDiv_, className);\n      }\n    }\n    aria.setState(this.htmlDiv_ as Element, aria.State.SELECTED, isSelected);\n  }\n\n  /**\n   * Sets whether the category is disabled.\n   *\n   * @param isDisabled True to disable the category, false otherwise.\n   */\n  setDisabled(isDisabled: boolean) {\n    this.isDisabled_ = isDisabled;\n    this.getDiv()!.setAttribute('disabled', `${isDisabled}`);\n    isDisabled\n      ? this.getDiv()!.setAttribute('disabled', 'true')\n      : this.getDiv()!.removeAttribute('disabled');\n  }\n\n  /**\n   * Gets the name of the category. Used for emitting events.\n   *\n   * @returns The name of the toolbox item.\n   */\n  getName(): string {\n    return this.name_;\n  }\n\n  override getParent() {\n    return this.parent_;\n  }\n\n  override getDiv() {\n    return this.htmlDiv_;\n  }\n\n  /**\n   * Gets the contents of the category. These are items that are meant to be\n   * displayed in the flyout.\n   *\n   * @returns The definition of items to be displayed in the flyout.\n   */\n  getContents(): FlyoutItemInfoArray | string {\n    return this.flyoutItems_;\n  }\n\n  /**\n   * Updates the contents to be displayed in the flyout.\n   * If the flyout is open when the contents are updated, refreshSelection on\n   * the toolbox must also be called.\n   *\n   * @param contents The contents to be displayed in the flyout. A string can be\n   *     supplied to create a dynamic category.\n   */\n  updateFlyoutContents(contents: FlyoutDefinition | string) {\n    this.flyoutItems_ = [];\n\n    if (typeof contents === 'string') {\n      const newDefinition: DynamicCategoryInfo = {\n        kind: this.toolboxItemDef_.kind,\n        custom: contents,\n        id: this.toolboxItemDef_.id,\n        categorystyle: this.toolboxItemDef_.categorystyle,\n        colour: this.toolboxItemDef_.colour,\n        cssconfig: this.toolboxItemDef_.cssconfig,\n        hidden: this.toolboxItemDef_.hidden,\n      };\n      this.toolboxItemDef_ = newDefinition;\n    } else {\n      const newDefinition: StaticCategoryInfo = {\n        kind: this.toolboxItemDef_.kind,\n        name:\n          'name' in this.toolboxItemDef_ ? this.toolboxItemDef_['name'] : '',\n        contents: toolbox.convertFlyoutDefToJsonArray(contents),\n        id: this.toolboxItemDef_.id,\n        categorystyle: this.toolboxItemDef_.categorystyle,\n        colour: this.toolboxItemDef_.colour,\n        cssconfig: this.toolboxItemDef_.cssconfig,\n        hidden: this.toolboxItemDef_.hidden,\n      };\n      this.toolboxItemDef_ = newDefinition;\n    }\n    this.parseContents_(this.toolboxItemDef_);\n  }\n\n  override dispose() {\n    dom.removeNode(this.htmlDiv_);\n  }\n}\n\nexport namespace ToolboxCategory {\n  /** All the CSS class names that are used to create a category. */\n  export interface CssConfig {\n    container?: string;\n    row?: string;\n    rowcontentcontainer?: string;\n    icon?: string;\n    label?: string;\n    contents?: string;\n    selected?: string;\n    openicon?: string;\n    closedicon?: string;\n  }\n}\n\nexport type CssConfig = ToolboxCategory.CssConfig;\n\n/** CSS for Toolbox.  See css.js for use. */\nCss.register(`\n.blocklyTreeRow:not(.blocklyTreeSelected):hover {\n  background-color: rgba(255, 255, 255, .2);\n}\n\n.blocklyToolboxDiv[layout=\"h\"] .blocklyToolboxCategory {\n  margin: 1px 5px 1px 0;\n}\n\n.blocklyToolboxDiv[dir=\"RTL\"][layout=\"h\"] .blocklyToolboxCategory {\n  margin: 1px 0 1px 5px;\n}\n\n.blocklyTreeRow {\n  height: 22px;\n  line-height: 22px;\n  margin-bottom: 3px;\n  padding-right: 8px;\n  white-space: nowrap;\n}\n\n.blocklyToolboxDiv[dir=\"RTL\"] .blocklyTreeRow {\n  margin-left: 8px;\n  padding-right: 0;\n}\n\n.blocklyTreeIcon {\n  background-image: url(<<<PATH>>>/sprites.png);\n  height: 16px;\n  vertical-align: middle;\n  visibility: hidden;\n  width: 16px;\n}\n\n.blocklyTreeIconClosed {\n  background-position: -32px -1px;\n}\n\n.blocklyToolboxDiv[dir=\"RTL\"] .blocklyTreeIconClosed {\n  background-position: 0 -1px;\n}\n\n.blocklyTreeSelected>.blocklyTreeIconClosed {\n  background-position: -32px -17px;\n}\n\n.blocklyToolboxDiv[dir=\"RTL\"] .blocklyTreeSelected>.blocklyTreeIconClosed {\n  background-position: 0 -17px;\n}\n\n.blocklyTreeIconOpen {\n  background-position: -16px -1px;\n}\n\n.blocklyTreeSelected>.blocklyTreeIconOpen {\n  background-position: -16px -17px;\n}\n\n.blocklyTreeLabel {\n  cursor: default;\n  font: 16px sans-serif;\n  padding: 0 3px;\n  vertical-align: middle;\n}\n\n.blocklyToolboxDelete .blocklyTreeLabel {\n  cursor: url(\"<<<PATH>>>/handdelete.cur\"), auto;\n}\n\n.blocklyTreeSelected .blocklyTreeLabel {\n  color: #fff;\n}\n`);\n\nregistry.register(\n  registry.Type.TOOLBOX_ITEM,\n  ToolboxCategory.registrationName,\n  ToolboxCategory,\n);\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * A separator used for separating toolbox categories.\n *\n * @class\n */\n// Former goog.module ID: Blockly.ToolboxSeparator\n\nimport * as Css from '../css.js';\nimport type {IToolbox} from '../interfaces/i_toolbox.js';\nimport * as registry from '../registry.js';\nimport * as dom from '../utils/dom.js';\nimport type * as toolbox from '../utils/toolbox.js';\n\nimport {ToolboxItem} from './toolbox_item.js';\n\n/**\n * Class for a toolbox separator. This is the thin visual line that appears on\n * the toolbox. This item is not interactable.\n */\nexport class ToolboxSeparator extends ToolboxItem {\n  /** Name used for registering a toolbox separator. */\n  static registrationName = 'sep';\n\n  /** All the CSS class names that are used to create a separator. */\n  protected cssConfig_: CssConfig = {'container': 'blocklyTreeSeparator'};\n\n  private htmlDiv_: HTMLDivElement | null = null;\n\n  /**\n   * @param separatorDef The information needed to create a separator.\n   * @param toolbox The parent toolbox for the separator.\n   */\n  constructor(separatorDef: toolbox.SeparatorInfo, toolbox: IToolbox) {\n    super(separatorDef, toolbox);\n\n    const cssConfig =\n      separatorDef['cssconfig'] || (separatorDef as any)['cssConfig'];\n    Object.assign(this.cssConfig_, cssConfig);\n  }\n\n  override init() {\n    this.createDom_();\n  }\n\n  /**\n   * Creates the DOM for a separator.\n   *\n   * @returns The parent element for the separator.\n   */\n  protected createDom_(): HTMLDivElement {\n    const container = document.createElement('div');\n    const className = this.cssConfig_['container'];\n    if (className) {\n      dom.addClass(container, className);\n    }\n    this.htmlDiv_ = container;\n    return container;\n  }\n\n  override getDiv() {\n    return this.htmlDiv_ as HTMLDivElement;\n  }\n\n  override dispose() {\n    dom.removeNode(this.htmlDiv_ as HTMLDivElement);\n  }\n}\n\nexport namespace ToolboxSeparator {\n  export interface CssConfig {\n    container: string | undefined;\n  }\n}\n\nexport type CssConfig = ToolboxSeparator.CssConfig;\n\n/** CSS for Toolbox.  See css.js for use. */\nCss.register(`\n.blocklyTreeSeparator {\n  border-bottom: solid #e5e5e5 1px;\n  height: 0;\n  margin: 5px 0;\n}\n\n.blocklyToolboxDiv[layout=\"h\"] .blocklyTreeSeparator {\n  border-right: solid #e5e5e5 1px;\n  border-bottom: none;\n  height: auto;\n  margin: 0 5px 0 5px;\n  padding: 5px 0;\n  width: 0;\n}\n`);\n\nregistry.register(\n  registry.Type.TOOLBOX_ITEM,\n  ToolboxSeparator.registrationName,\n  ToolboxSeparator,\n);\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * A toolbox category used to organize blocks in the toolbox.\n *\n * @class\n */\n// Former goog.module ID: Blockly.CollapsibleToolboxCategory\n\nimport type {ICollapsibleToolboxItem} from '../interfaces/i_collapsible_toolbox_item.js';\nimport type {IToolbox} from '../interfaces/i_toolbox.js';\nimport type {IToolboxItem} from '../interfaces/i_toolbox_item.js';\nimport * as registry from '../registry.js';\nimport * as aria from '../utils/aria.js';\nimport * as dom from '../utils/dom.js';\nimport * as toolbox from '../utils/toolbox.js';\n\nimport {ToolboxCategory} from './category.js';\nimport {ToolboxSeparator} from './separator.js';\n\n/**\n * Class for a category in a toolbox that can be collapsed.\n */\nexport class CollapsibleToolboxCategory\n  extends ToolboxCategory\n  implements ICollapsibleToolboxItem\n{\n  /** Name used for registering a collapsible toolbox category. */\n  static override registrationName = 'collapsibleCategory';\n\n  /** Container for any child categories. */\n  protected subcategoriesDiv_: HTMLDivElement | null = null;\n\n  /** Whether or not the category should display its subcategories. */\n  protected expanded_ = false;\n\n  /** The child toolbox items for this category. */\n  protected toolboxItems_: IToolboxItem[] = [];\n\n  /**\n   * @param categoryDef The information needed to create a category in the\n   *     toolbox.\n   * @param toolbox The parent toolbox for the category.\n   * @param opt_parent The parent category or null if the category does not have\n   *     a parent.\n   */\n  constructor(\n    categoryDef: toolbox.CategoryInfo,\n    toolbox: IToolbox,\n    opt_parent?: ICollapsibleToolboxItem,\n  ) {\n    super(categoryDef, toolbox, opt_parent);\n  }\n\n  override makeDefaultCssConfig_() {\n    const cssConfig = super.makeDefaultCssConfig_();\n    cssConfig['contents'] = 'blocklyToolboxContents';\n    return cssConfig;\n  }\n\n  override parseContents_(categoryDef: toolbox.CategoryInfo) {\n    if ('custom' in categoryDef) {\n      this.flyoutItems_ = categoryDef['custom'];\n    } else {\n      const contents = categoryDef['contents'];\n      if (!contents) return;\n      this.flyoutItems_ = [];\n      let prevIsFlyoutItem = true;\n      for (let i = 0; i < contents.length; i++) {\n        const itemDef = contents[i];\n        // Separators can exist as either a flyout item or a toolbox item so\n        // decide where it goes based on the type of the previous item.\n        if (\n          !registry.hasItem(registry.Type.TOOLBOX_ITEM, itemDef['kind']) ||\n          (itemDef['kind'].toLowerCase() ===\n            ToolboxSeparator.registrationName &&\n            prevIsFlyoutItem)\n        ) {\n          const flyoutItem = itemDef as toolbox.FlyoutItemInfo;\n          this.flyoutItems_.push(flyoutItem);\n          prevIsFlyoutItem = true;\n        } else {\n          this.createToolboxItem_(itemDef);\n          prevIsFlyoutItem = false;\n        }\n      }\n    }\n  }\n\n  /**\n   * Creates a toolbox item and adds it to the list of toolbox items.\n   *\n   * @param itemDef The information needed to create a toolbox item.\n   */\n  private createToolboxItem_(itemDef: toolbox.ToolboxItemInfo) {\n    let registryName = itemDef['kind'];\n    const categoryDef = itemDef as toolbox.CategoryInfo;\n    // Categories that are collapsible are created using a class registered\n    // under a different name.\n    if (\n      registryName.toUpperCase() === 'CATEGORY' &&\n      toolbox.isCategoryCollapsible(categoryDef)\n    ) {\n      registryName = CollapsibleToolboxCategory.registrationName;\n    }\n    const ToolboxItemClass = registry.getClass(\n      registry.Type.TOOLBOX_ITEM,\n      registryName,\n    );\n    const toolboxItem = new ToolboxItemClass!(\n      itemDef,\n      this.parentToolbox_,\n      this,\n    );\n    this.toolboxItems_.push(toolboxItem);\n  }\n\n  override init() {\n    super.init();\n\n    this.setExpanded(\n      this.toolboxItemDef_['expanded'] === 'true' ||\n        this.toolboxItemDef_['expanded'] === true,\n    );\n  }\n\n  override createDom_() {\n    super.createDom_();\n\n    const subCategories = this.getChildToolboxItems();\n    this.subcategoriesDiv_ = this.createSubCategoriesDom_(subCategories);\n    aria.setRole(this.subcategoriesDiv_, aria.Role.GROUP);\n    this.htmlDiv_!.appendChild(this.subcategoriesDiv_);\n    this.closeIcon_(this.iconDom_);\n    aria.setState(this.htmlDiv_ as HTMLDivElement, aria.State.EXPANDED, false);\n\n    return this.htmlDiv_!;\n  }\n\n  override createIconDom_() {\n    const toolboxIcon = document.createElement('span');\n    if (!this.parentToolbox_.isHorizontal()) {\n      const className = this.cssConfig_['icon'];\n      if (className) {\n        dom.addClass(toolboxIcon, className);\n      }\n      toolboxIcon.style.visibility = 'visible';\n    }\n\n    toolboxIcon.style.display = 'inline-block';\n    return toolboxIcon;\n  }\n\n  /**\n   * Create the DOM for all subcategories.\n   *\n   * @param subcategories The subcategories.\n   * @returns The div holding all the subcategories.\n   */\n  protected createSubCategoriesDom_(\n    subcategories: IToolboxItem[],\n  ): HTMLDivElement {\n    const contentsContainer = document.createElement('div');\n    contentsContainer.style.display = 'none';\n    const className = this.cssConfig_['contents'];\n    if (className) {\n      dom.addClass(contentsContainer, className);\n    }\n\n    for (let i = 0; i < subcategories.length; i++) {\n      const newCategory = subcategories[i];\n      newCategory.init();\n      const newCategoryDiv = newCategory.getDiv();\n      contentsContainer.appendChild(newCategoryDiv!);\n      if (newCategory.getClickTarget) {\n        newCategory.getClickTarget()?.setAttribute('id', newCategory.getId());\n      }\n    }\n    return contentsContainer;\n  }\n\n  /**\n   * Opens or closes the current category and the associated flyout.\n   *\n   * @param isExpanded True to expand the category, false to close.\n   */\n  setExpanded(isExpanded: boolean) {\n    if (this.expanded_ === isExpanded) return;\n\n    this.expanded_ = isExpanded;\n    if (isExpanded) {\n      this.subcategoriesDiv_!.style.display = 'block';\n      this.openIcon_(this.iconDom_);\n    } else {\n      this.parentToolbox_.getFlyout()?.setVisible(false);\n      this.subcategoriesDiv_!.style.display = 'none';\n      this.closeIcon_(this.iconDom_);\n    }\n    aria.setState(\n      this.htmlDiv_ as HTMLDivElement,\n      aria.State.EXPANDED,\n      isExpanded,\n    );\n\n    this.parentToolbox_.handleToolboxItemResize();\n  }\n\n  override setVisible_(isVisible: boolean) {\n    this.htmlDiv_!.style.display = isVisible ? 'block' : 'none';\n    const childToolboxItems = this.getChildToolboxItems();\n    for (let i = 0; i < childToolboxItems.length; i++) {\n      const child = childToolboxItems[i];\n      child.setVisible_(isVisible);\n    }\n    this.isHidden_ = !isVisible;\n\n    if (this.parentToolbox_.getSelectedItem() === this) {\n      this.parentToolbox_.clearSelection();\n    }\n  }\n\n  /**\n   * Whether the category is expanded to show its child subcategories.\n   *\n   * @returns True if the toolbox item shows its children, false if it is\n   *     collapsed.\n   */\n  isExpanded(): boolean {\n    return this.expanded_;\n  }\n\n  override isCollapsible() {\n    return true;\n  }\n\n  override onClick(_e: Event) {\n    this.toggleExpanded();\n  }\n\n  /** Toggles whether or not the category is expanded. */\n  toggleExpanded() {\n    this.setExpanded(!this.expanded_);\n  }\n\n  override getDiv() {\n    return this.htmlDiv_;\n  }\n\n  /**\n   * Gets any children toolbox items. (ex. Gets the subcategories)\n   *\n   * @returns The child toolbox items.\n   */\n  getChildToolboxItems(): IToolboxItem[] {\n    return this.toolboxItems_;\n  }\n}\n\nexport namespace CollapsibleToolboxCategory {\n  /**\n   * All the CSS class names that are used to create a collapsible\n   * category. This is all the properties from the regular category plus\n   * contents.\n   */\n  export interface CssConfig {\n    container: string | null;\n    row: string | null;\n    rowcontentcontainer: string | null;\n    icon: string | null;\n    label: string | null;\n    selected: string | null;\n    openicon: string | null;\n    closedicon: string | null;\n    contents: string | null;\n  }\n}\n\nexport type CssConfig = CollapsibleToolboxCategory.CssConfig;\n\nregistry.register(\n  registry.Type.TOOLBOX_ITEM,\n  CollapsibleToolboxCategory.registrationName,\n  CollapsibleToolboxCategory,\n);\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Toolbox from whence to create blocks.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Toolbox\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport '../events/events_toolbox_item_select.js';\n\nimport {BlockSvg} from '../block_svg.js';\nimport type {BlocklyOptions} from '../blockly_options.js';\nimport * as browserEvents from '../browser_events.js';\nimport * as common from '../common.js';\nimport {ComponentManager} from '../component_manager.js';\nimport * as Css from '../css.js';\nimport {DeleteArea} from '../delete_area.js';\nimport * as eventUtils from '../events/utils.js';\nimport type {IAutoHideable} from '../interfaces/i_autohideable.js';\nimport type {ICollapsibleToolboxItem} from '../interfaces/i_collapsible_toolbox_item.js';\nimport type {IDraggable} from '../interfaces/i_draggable.js';\nimport type {IFlyout} from '../interfaces/i_flyout.js';\nimport type {IKeyboardAccessible} from '../interfaces/i_keyboard_accessible.js';\nimport type {ISelectableToolboxItem} from '../interfaces/i_selectable_toolbox_item.js';\nimport {isSelectableToolboxItem} from '../interfaces/i_selectable_toolbox_item.js';\nimport type {IStyleable} from '../interfaces/i_styleable.js';\nimport type {IToolbox} from '../interfaces/i_toolbox.js';\nimport type {IToolboxItem} from '../interfaces/i_toolbox_item.js';\nimport {Options} from '../options.js';\nimport * as registry from '../registry.js';\nimport type {KeyboardShortcut} from '../shortcut_registry.js';\nimport * as Touch from '../touch.js';\nimport * as aria from '../utils/aria.js';\nimport * as dom from '../utils/dom.js';\nimport {Rect} from '../utils/rect.js';\nimport * as toolbox from '../utils/toolbox.js';\nimport type {WorkspaceSvg} from '../workspace_svg.js';\n\nimport type {ToolboxCategory} from './category.js';\nimport {CollapsibleToolboxCategory} from './collapsible_category.js';\n\n/**\n * Class for a Toolbox.\n * Creates the toolbox's DOM.\n */\nexport class Toolbox\n  extends DeleteArea\n  implements IAutoHideable, IKeyboardAccessible, IStyleable, IToolbox\n{\n  /**\n   * The unique ID for this component that is used to register with the\n   * ComponentManager.\n   */\n  override id = 'toolbox';\n  protected toolboxDef_: toolbox.ToolboxInfo;\n  private readonly horizontalLayout_: boolean;\n\n  /** The HTML container for the toolbox. */\n  HtmlDiv: HTMLDivElement | null = null;\n\n  /** The HTML container for the contents of a toolbox. */\n  protected contentsDiv_: HTMLDivElement | null = null;\n\n  /** Whether the Toolbox is visible. */\n  protected isVisible_ = false;\n\n  /** The list of items in the toolbox. */\n  protected contents_: IToolboxItem[] = [];\n\n  /** The width of the toolbox. */\n  protected width_ = 0;\n\n  /** The height of the toolbox. */\n  protected height_ = 0;\n  RTL: boolean;\n\n  /** The flyout for the toolbox. */\n  private flyout_: IFlyout | null = null;\n  protected contentMap_: {[key: string]: IToolboxItem};\n  toolboxPosition: toolbox.Position;\n\n  /** The currently selected item. */\n  protected selectedItem_: ISelectableToolboxItem | null = null;\n\n  /** The previously selected item. */\n  protected previouslySelectedItem_: ISelectableToolboxItem | null = null;\n\n  /**\n   * Array holding info needed to unbind event handlers.\n   * Used for disposing.\n   * Ex: [[node, name, func], [node, name, func]].\n   */\n  protected boundEvents_: browserEvents.Data[] = [];\n\n  /** The workspace this toolbox is on. */\n  protected readonly workspace_: WorkspaceSvg;\n\n  /** @param workspace The workspace in which to create new blocks. */\n  constructor(workspace: WorkspaceSvg) {\n    super();\n\n    this.workspace_ = workspace;\n\n    /** The JSON describing the contents of this toolbox. */\n    this.toolboxDef_ = workspace.options.languageTree || {\n      contents: new Array<toolbox.ToolboxItemInfo>(),\n    };\n\n    /** Whether the toolbox should be laid out horizontally. */\n    this.horizontalLayout_ = workspace.options.horizontalLayout;\n\n    /** Is RTL vs LTR. */\n    this.RTL = workspace.options.RTL;\n\n    /** A map from toolbox item IDs to toolbox items. */\n    this.contentMap_ = Object.create(null);\n\n    /** Position of the toolbox and flyout relative to the workspace. */\n    this.toolboxPosition = workspace.options.toolboxPosition;\n  }\n\n  /**\n   * Handles the given keyboard shortcut.\n   *\n   * @param _shortcut The shortcut to be handled.\n   * @returns True if the shortcut has been handled, false otherwise.\n   */\n  onShortcut(_shortcut: KeyboardShortcut): boolean {\n    return false;\n  }\n\n  /** Initializes the toolbox */\n  init() {\n    const workspace = this.workspace_;\n    const svg = workspace.getParentSvg();\n\n    this.flyout_ = this.createFlyout_();\n\n    this.HtmlDiv = this.createDom_(this.workspace_);\n    dom.insertAfter(this.flyout_.createDom('svg'), svg);\n    this.setVisible(true);\n    this.flyout_.init(workspace);\n\n    this.render(this.toolboxDef_);\n    const themeManager = workspace.getThemeManager();\n    themeManager.subscribe(\n      this.HtmlDiv,\n      'toolboxBackgroundColour',\n      'background-color',\n    );\n    themeManager.subscribe(this.HtmlDiv, 'toolboxForegroundColour', 'color');\n    this.workspace_.getComponentManager().addComponent({\n      component: this,\n      weight: 1,\n      capabilities: [\n        ComponentManager.Capability.AUTOHIDEABLE,\n        ComponentManager.Capability.DELETE_AREA,\n        ComponentManager.Capability.DRAG_TARGET,\n      ],\n    });\n  }\n\n  /**\n   * Creates the DOM for the toolbox.\n   *\n   * @param workspace The workspace this toolbox is on.\n   * @returns The HTML container for the toolbox.\n   */\n  protected createDom_(workspace: WorkspaceSvg): HTMLDivElement {\n    const svg = workspace.getParentSvg();\n\n    const container = this.createContainer_();\n\n    this.contentsDiv_ = this.createContentsContainer_();\n    this.contentsDiv_.tabIndex = 0;\n    aria.setRole(this.contentsDiv_, aria.Role.TREE);\n    container.appendChild(this.contentsDiv_);\n\n    svg.parentNode!.insertBefore(container, svg);\n\n    this.attachEvents_(container, this.contentsDiv_);\n    return container;\n  }\n\n  /**\n   * Creates the container div for the toolbox.\n   *\n   * @returns The HTML container for the toolbox.\n   */\n  protected createContainer_(): HTMLDivElement {\n    const toolboxContainer = document.createElement('div');\n    toolboxContainer.setAttribute('layout', this.isHorizontal() ? 'h' : 'v');\n    dom.addClass(toolboxContainer, 'blocklyToolboxDiv');\n    dom.addClass(toolboxContainer, 'blocklyNonSelectable');\n    toolboxContainer.setAttribute('dir', this.RTL ? 'RTL' : 'LTR');\n    return toolboxContainer;\n  }\n\n  /**\n   * Creates the container for all the contents in the toolbox.\n   *\n   * @returns The HTML container for the toolbox contents.\n   */\n  protected createContentsContainer_(): HTMLDivElement {\n    const contentsContainer = document.createElement('div');\n    dom.addClass(contentsContainer, 'blocklyToolboxContents');\n    if (this.isHorizontal()) {\n      contentsContainer.style.flexDirection = 'row';\n    }\n    return contentsContainer;\n  }\n\n  /**\n   * Adds event listeners to the toolbox container div.\n   *\n   * @param container The HTML container for the toolbox.\n   * @param contentsContainer The HTML container for the contents of the\n   *     toolbox.\n   */\n  protected attachEvents_(\n    container: HTMLDivElement,\n    contentsContainer: HTMLDivElement,\n  ) {\n    // Clicking on toolbox closes popups.\n    const clickEvent = browserEvents.conditionalBind(\n      container,\n      'pointerdown',\n      this,\n      this.onClick_,\n      /* opt_noCaptureIdentifier */ false,\n    );\n    this.boundEvents_.push(clickEvent);\n\n    const keyDownEvent = browserEvents.conditionalBind(\n      contentsContainer,\n      'keydown',\n      this,\n      this.onKeyDown_,\n      /* opt_noCaptureIdentifier */ false,\n    );\n    this.boundEvents_.push(keyDownEvent);\n  }\n\n  /**\n   * Handles on click events for when the toolbox or toolbox items are clicked.\n   *\n   * @param e Click event to handle.\n   */\n  protected onClick_(e: PointerEvent) {\n    if (browserEvents.isRightButton(e) || e.target === this.HtmlDiv) {\n      // Close flyout.\n      (common.getMainWorkspace() as WorkspaceSvg).hideChaff(false);\n    } else {\n      const targetElement = e.target;\n      const itemId = (targetElement as Element).getAttribute('id');\n      if (itemId) {\n        const item = this.getToolboxItemById(itemId);\n        if (item!.isSelectable()) {\n          this.setSelectedItem(item);\n          (item as ISelectableToolboxItem).onClick(e);\n        }\n      }\n      // Just close popups.\n      (common.getMainWorkspace() as WorkspaceSvg).hideChaff(true);\n    }\n    Touch.clearTouchIdentifier();\n  }\n\n  /**\n   * Handles key down events for the toolbox.\n   *\n   * @param e The key down event.\n   */\n  protected onKeyDown_(e: KeyboardEvent) {\n    let handled = false;\n    switch (e.key) {\n      case 'ArrowDown':\n        handled = this.selectNext_();\n        break;\n      case 'ArrowUp':\n        handled = this.selectPrevious_();\n        break;\n      case 'ArrowLeft':\n        handled = this.selectParent_();\n        break;\n      case 'ArrowRight':\n        handled = this.selectChild_();\n        break;\n      case 'Enter':\n      case ' ':\n        if (this.selectedItem_ && this.selectedItem_.isCollapsible()) {\n          const collapsibleItem = this.selectedItem_ as ICollapsibleToolboxItem;\n          collapsibleItem.toggleExpanded();\n          handled = true;\n        }\n        break;\n      default:\n        handled = false;\n        break;\n    }\n    if (!handled && this.selectedItem_) {\n      // TODO(#6097): Figure out who implements onKeyDown and which interface it\n      // should be part of.\n      if ((this.selectedItem_ as any).onKeyDown) {\n        handled = (this.selectedItem_ as any).onKeyDown(e);\n      }\n    }\n\n    if (handled) {\n      e.preventDefault();\n    }\n  }\n\n  /**\n   * Creates the flyout based on the toolbox layout.\n   *\n   * @returns The flyout for the toolbox.\n   * @throws {Error} If missing a require for `Blockly.HorizontalFlyout`,\n   *     `Blockly.VerticalFlyout`, and no flyout plugin is specified.\n   */\n  protected createFlyout_(): IFlyout {\n    const workspace = this.workspace_;\n    // TODO (#4247): Look into adding a makeFlyout method to Blockly Options.\n    const workspaceOptions = new Options({\n      'parentWorkspace': workspace,\n      'rtl': workspace.RTL,\n      'oneBasedIndex': workspace.options.oneBasedIndex,\n      'horizontalLayout': workspace.horizontalLayout,\n      'renderer': workspace.options.renderer,\n      'rendererOverrides': workspace.options.rendererOverrides,\n      'move': {\n        'scrollbars': true,\n      },\n    } as BlocklyOptions);\n    // Options takes in either 'end' or 'start'. This has already been parsed to\n    // be either 0 or 1, so set it after.\n    workspaceOptions.toolboxPosition = workspace.options.toolboxPosition;\n    let FlyoutClass = null;\n    if (workspace.horizontalLayout) {\n      FlyoutClass = registry.getClassFromOptions(\n        registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX,\n        workspace.options,\n        true,\n      );\n    } else {\n      FlyoutClass = registry.getClassFromOptions(\n        registry.Type.FLYOUTS_VERTICAL_TOOLBOX,\n        workspace.options,\n        true,\n      );\n    }\n    return new FlyoutClass!(workspaceOptions);\n  }\n\n  /**\n   * Fills the toolbox with new toolbox items and removes any old contents.\n   *\n   * @param toolboxDef Object holding information for creating a toolbox.\n   * @internal\n   */\n  render(toolboxDef: toolbox.ToolboxInfo) {\n    this.toolboxDef_ = toolboxDef;\n    for (let i = 0; i < this.contents_.length; i++) {\n      const toolboxItem = this.contents_[i];\n      if (toolboxItem) {\n        toolboxItem.dispose();\n      }\n    }\n    this.contents_ = [];\n    this.contentMap_ = Object.create(null);\n    this.renderContents_(toolboxDef['contents']);\n    this.position();\n    this.handleToolboxItemResize();\n  }\n\n  /**\n   * Adds all the toolbox items to the toolbox.\n   *\n   * @param toolboxDef Array holding objects containing information on the\n   *     contents of the toolbox.\n   */\n  protected renderContents_(toolboxDef: toolbox.ToolboxItemInfo[]) {\n    // This is for performance reasons. By using document fragment we only have\n    // to add to the DOM once.\n    const fragment = document.createDocumentFragment();\n    for (let i = 0; i < toolboxDef.length; i++) {\n      const toolboxItemDef = toolboxDef[i];\n      this.createToolboxItem_(toolboxItemDef, fragment);\n    }\n    this.contentsDiv_!.appendChild(fragment);\n  }\n\n  /**\n   * Creates and renders the toolbox item.\n   *\n   * @param toolboxItemDef Any information that can be used to create an item in\n   *     the toolbox.\n   * @param fragment The document fragment to add the child toolbox elements to.\n   */\n  private createToolboxItem_(\n    toolboxItemDef: toolbox.ToolboxItemInfo,\n    fragment: DocumentFragment,\n  ) {\n    let registryName = toolboxItemDef['kind'];\n\n    // Categories that are collapsible are created using a class registered\n    // under a different name.\n    if (\n      registryName.toUpperCase() === 'CATEGORY' &&\n      toolbox.isCategoryCollapsible(toolboxItemDef as toolbox.CategoryInfo)\n    ) {\n      registryName = CollapsibleToolboxCategory.registrationName;\n    }\n\n    const ToolboxItemClass = registry.getClass(\n      registry.Type.TOOLBOX_ITEM,\n      registryName.toLowerCase(),\n    );\n    if (ToolboxItemClass) {\n      const toolboxItem = new ToolboxItemClass(toolboxItemDef, this);\n      toolboxItem.init();\n      this.addToolboxItem_(toolboxItem);\n      const toolboxItemDom = toolboxItem.getDiv();\n      if (toolboxItemDom) {\n        fragment.appendChild(toolboxItemDom);\n      }\n      // Adds the ID to the HTML element that can receive a click.\n      // This is used in onClick_ to find the toolboxItem that was clicked.\n      if (toolboxItem.getClickTarget()) {\n        toolboxItem.getClickTarget()!.setAttribute('id', toolboxItem.getId());\n      }\n    }\n  }\n\n  /**\n   * Adds an item to the toolbox.\n   *\n   * @param toolboxItem The item in the toolbox.\n   */\n  protected addToolboxItem_(toolboxItem: IToolboxItem) {\n    this.contents_.push(toolboxItem);\n    this.contentMap_[toolboxItem.getId()] = toolboxItem;\n    if (toolboxItem.isCollapsible()) {\n      const collapsibleItem = toolboxItem as ICollapsibleToolboxItem;\n      const childToolboxItems = collapsibleItem.getChildToolboxItems();\n      for (let i = 0; i < childToolboxItems.length; i++) {\n        const child = childToolboxItems[i];\n        this.addToolboxItem_(child);\n      }\n    }\n  }\n\n  /**\n   * Gets the items in the toolbox.\n   *\n   * @returns The list of items in the toolbox.\n   */\n  getToolboxItems(): IToolboxItem[] {\n    return this.contents_;\n  }\n\n  /**\n   * Adds a style on the toolbox. Usually used to change the cursor.\n   *\n   * @param style The name of the class to add.\n   * @internal\n   */\n  addStyle(style: string) {\n    if (style && this.HtmlDiv) {\n      dom.addClass(this.HtmlDiv, style);\n    }\n  }\n\n  /**\n   * Removes a style from the toolbox. Usually used to change the cursor.\n   *\n   * @param style The name of the class to remove.\n   * @internal\n   */\n  removeStyle(style: string) {\n    if (style && this.HtmlDiv) {\n      dom.removeClass(this.HtmlDiv, style);\n    }\n  }\n\n  /**\n   * Returns the bounding rectangle of the drag target area in pixel units\n   * relative to viewport.\n   *\n   * @returns The component's bounding box. Null if drag target area should be\n   *     ignored.\n   */\n  override getClientRect(): Rect | null {\n    if (!this.HtmlDiv || !this.isVisible_) {\n      return null;\n    }\n    // BIG_NUM is offscreen padding so that blocks dragged beyond the toolbox\n    // area are still deleted.  Must be smaller than Infinity, but larger than\n    // the largest screen size.\n    const BIG_NUM = 10000000;\n    const toolboxRect = this.HtmlDiv.getBoundingClientRect();\n\n    const top = toolboxRect.top;\n    const bottom = top + toolboxRect.height;\n    const left = toolboxRect.left;\n    const right = left + toolboxRect.width;\n\n    // Assumes that the toolbox is on the SVG edge.  If this changes\n    // (e.g. toolboxes in mutators) then this code will need to be more complex.\n    if (this.toolboxPosition === toolbox.Position.TOP) {\n      return new Rect(-BIG_NUM, bottom, -BIG_NUM, BIG_NUM);\n    } else if (this.toolboxPosition === toolbox.Position.BOTTOM) {\n      return new Rect(top, BIG_NUM, -BIG_NUM, BIG_NUM);\n    } else if (this.toolboxPosition === toolbox.Position.LEFT) {\n      return new Rect(-BIG_NUM, BIG_NUM, -BIG_NUM, right);\n    } else {\n      // Right\n      return new Rect(-BIG_NUM, BIG_NUM, left, BIG_NUM);\n    }\n  }\n\n  /**\n   * Returns whether the provided block or bubble would be deleted if dropped on\n   * this area.\n   * This method should check if the element is deletable and is always called\n   * before onDragEnter/onDragOver/onDragExit.\n   *\n   * @param element The block or bubble currently being dragged.\n   * @param _couldConnect Whether the element could could connect to another.\n   * @returns Whether the element provided would be deleted if dropped on this\n   *     area.\n   */\n  override wouldDelete(element: IDraggable, _couldConnect: boolean): boolean {\n    if (element instanceof BlockSvg) {\n      const block = element;\n      // Prefer dragging to the toolbox over connecting to other blocks.\n      this.updateWouldDelete_(!block.getParent() && block.isDeletable());\n    } else {\n      this.updateWouldDelete_(element.isDeletable());\n    }\n    return this.wouldDelete_;\n  }\n\n  /**\n   * Handles when a cursor with a block or bubble enters this drag target.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  override onDragEnter(_dragElement: IDraggable) {\n    this.updateCursorDeleteStyle_(true);\n  }\n\n  /**\n   * Handles when a cursor with a block or bubble exits this drag target.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  override onDragExit(_dragElement: IDraggable) {\n    this.updateCursorDeleteStyle_(false);\n  }\n\n  /**\n   * Handles when a block or bubble is dropped on this component.\n   * Should not handle delete here.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  override onDrop(_dragElement: IDraggable) {\n    this.updateCursorDeleteStyle_(false);\n  }\n\n  /**\n   * Updates the internal wouldDelete_ state.\n   *\n   * @param wouldDelete The new value for the wouldDelete state.\n   */\n  protected override updateWouldDelete_(wouldDelete: boolean) {\n    if (wouldDelete === this.wouldDelete_) {\n      return;\n    }\n    // This logic handles updating the deleteStyle properly if the delete state\n    // changes while the block is over the Toolbox. This could happen if the\n    // implementation of wouldDeleteBlock depends on the couldConnect parameter\n    // or if the isDeletable property of the block currently being dragged\n    // changes during the drag.\n    this.updateCursorDeleteStyle_(false);\n    this.wouldDelete_ = wouldDelete;\n    this.updateCursorDeleteStyle_(true);\n  }\n\n  /**\n   * Adds or removes the CSS style of the cursor over the toolbox based whether\n   * the block or bubble over it is expected to be deleted if dropped (using the\n   * internal this.wouldDelete_ property).\n   *\n   * @param addStyle Whether the style should be added or removed.\n   */\n  protected updateCursorDeleteStyle_(addStyle: boolean) {\n    const style = this.wouldDelete_\n      ? 'blocklyToolboxDelete'\n      : 'blocklyToolboxGrab';\n    if (addStyle) {\n      this.addStyle(style);\n    } else {\n      this.removeStyle(style);\n    }\n  }\n\n  /**\n   * Gets the toolbox item with the given ID.\n   *\n   * @param id The ID of the toolbox item.\n   * @returns The toolbox item with the given ID, or null if no item exists.\n   */\n  getToolboxItemById(id: string): IToolboxItem | null {\n    return this.contentMap_[id] || null;\n  }\n\n  /**\n   * Gets the width of the toolbox.\n   *\n   * @returns The width of the toolbox.\n   */\n  getWidth(): number {\n    return this.width_;\n  }\n\n  /**\n   * Gets the height of the toolbox.\n   *\n   * @returns The width of the toolbox.\n   */\n  getHeight(): number {\n    return this.height_;\n  }\n\n  /**\n   * Gets the toolbox flyout.\n   *\n   * @returns The toolbox flyout.\n   */\n  getFlyout(): IFlyout | null {\n    return this.flyout_;\n  }\n\n  /**\n   * Gets the workspace for the toolbox.\n   *\n   * @returns The parent workspace for the toolbox.\n   */\n  getWorkspace(): WorkspaceSvg {\n    return this.workspace_;\n  }\n\n  /**\n   * Gets the selected item.\n   *\n   * @returns The selected item, or null if no item is currently selected.\n   */\n  getSelectedItem(): ISelectableToolboxItem | null {\n    return this.selectedItem_;\n  }\n\n  /**\n   * Gets the previously selected item.\n   *\n   * @returns The previously selected item, or null if no item was previously\n   *     selected.\n   */\n  getPreviouslySelectedItem(): ISelectableToolboxItem | null {\n    return this.previouslySelectedItem_;\n  }\n\n  /**\n   * Gets whether or not the toolbox is horizontal.\n   *\n   * @returns True if the toolbox is horizontal, false if the toolbox is\n   *     vertical.\n   */\n  isHorizontal(): boolean {\n    return this.horizontalLayout_;\n  }\n\n  /**\n   * Positions the toolbox based on whether it is a horizontal toolbox and\n   * whether the workspace is in rtl.\n   */\n  position() {\n    const workspaceMetrics = this.workspace_.getMetrics();\n    const toolboxDiv = this.HtmlDiv;\n    if (!toolboxDiv) {\n      // Not initialized yet.\n      return;\n    }\n\n    if (this.horizontalLayout_) {\n      toolboxDiv.style.left = '0';\n      toolboxDiv.style.height = 'auto';\n      toolboxDiv.style.width = '100%';\n      this.height_ = toolboxDiv.offsetHeight;\n      this.width_ = workspaceMetrics.viewWidth;\n      if (this.toolboxPosition === toolbox.Position.TOP) {\n        toolboxDiv.style.top = '0';\n      } else {\n        // Bottom\n        toolboxDiv.style.bottom = '0';\n      }\n    } else {\n      if (this.toolboxPosition === toolbox.Position.RIGHT) {\n        toolboxDiv.style.right = '0';\n      } else {\n        // Left\n        toolboxDiv.style.left = '0';\n      }\n      toolboxDiv.style.height = '100%';\n      this.width_ = toolboxDiv.offsetWidth;\n      this.height_ = workspaceMetrics.viewHeight;\n    }\n    this.flyout_!.position();\n  }\n\n  /**\n   * Handles resizing the toolbox when a toolbox item resizes.\n   *\n   * @internal\n   */\n  handleToolboxItemResize() {\n    // Reposition the workspace so that (0,0) is in the correct position\n    // relative to the new absolute edge (ie toolbox edge).\n    const workspace = this.workspace_;\n    const rect = this.HtmlDiv!.getBoundingClientRect();\n    const newX =\n      this.toolboxPosition === toolbox.Position.LEFT\n        ? workspace.scrollX + rect.width\n        : workspace.scrollX;\n    const newY =\n      this.toolboxPosition === toolbox.Position.TOP\n        ? workspace.scrollY + rect.height\n        : workspace.scrollY;\n    workspace.translate(newX, newY);\n\n    // Even though the div hasn't changed size, the visible workspace\n    // surface of the workspace has, so we may need to reposition everything.\n    common.svgResize(workspace);\n  }\n\n  /** Unhighlights any previously selected item. */\n  clearSelection() {\n    this.setSelectedItem(null);\n  }\n\n  /**\n   * Updates the category colours and background colour of selected categories.\n   *\n   * @internal\n   */\n  refreshTheme() {\n    for (let i = 0; i < this.contents_.length; i++) {\n      const child = this.contents_[i];\n      // TODO(#6097): Fix types or add refreshTheme to IToolboxItem.\n      const childAsCategory = child as ToolboxCategory;\n      if (childAsCategory.refreshTheme) {\n        childAsCategory.refreshTheme();\n      }\n    }\n  }\n\n  /**\n   * Updates the flyout's content without closing it.  Should be used in\n   * response to a change in one of the dynamic categories, such as variables or\n   * procedures.\n   */\n  refreshSelection() {\n    if (\n      this.selectedItem_ &&\n      this.selectedItem_.isSelectable() &&\n      this.selectedItem_.getContents().length\n    ) {\n      this.flyout_!.show(this.selectedItem_.getContents());\n    }\n  }\n\n  /**\n   * Shows or hides the toolbox.\n   *\n   * @param isVisible True if toolbox should be visible.\n   */\n  setVisible(isVisible: boolean) {\n    if (this.isVisible_ === isVisible) {\n      return;\n    }\n\n    this.HtmlDiv!.style.display = isVisible ? 'block' : 'none';\n    this.isVisible_ = isVisible;\n    // Invisible toolbox is ignored as drag targets and must have the drag\n    // target updated.\n    this.workspace_.recordDragTargets();\n  }\n\n  /**\n   * Hides the component. Called in WorkspaceSvg.hideChaff.\n   *\n   * @param onlyClosePopups Whether only popups should be closed.\n   *     Flyouts should not be closed if this is true.\n   */\n  autoHide(onlyClosePopups: boolean) {\n    if (!onlyClosePopups && this.flyout_ && this.flyout_.autoClose) {\n      this.clearSelection();\n    }\n  }\n\n  /**\n   * Sets the given item as selected.\n   * No-op if the item is not selectable.\n   *\n   * @param newItem The toolbox item to select.\n   */\n  setSelectedItem(newItem: IToolboxItem | null) {\n    const oldItem = this.selectedItem_;\n\n    if (\n      (!newItem && !oldItem) ||\n      (newItem && !isSelectableToolboxItem(newItem))\n    ) {\n      return;\n    }\n\n    if (this.shouldDeselectItem_(oldItem, newItem) && oldItem !== null) {\n      this.deselectItem_(oldItem);\n    }\n\n    if (this.shouldSelectItem_(oldItem, newItem) && newItem !== null) {\n      this.selectItem_(oldItem, newItem);\n    }\n\n    this.updateFlyout_(oldItem, newItem);\n    this.fireSelectEvent_(oldItem, newItem);\n  }\n\n  /**\n   * Decides whether the old item should be deselected.\n   *\n   * @param oldItem The previously selected toolbox item.\n   * @param newItem The newly selected toolbox item.\n   * @returns True if the old item should be deselected, false otherwise.\n   */\n  protected shouldDeselectItem_(\n    oldItem: ISelectableToolboxItem | null,\n    newItem: ISelectableToolboxItem | null,\n  ): boolean {\n    // Deselect the old item unless the old item is collapsible and has been\n    // previously clicked on.\n    return (\n      oldItem !== null && (!oldItem.isCollapsible() || oldItem !== newItem)\n    );\n  }\n\n  /**\n   * Decides whether the new item should be selected.\n   *\n   * @param oldItem The previously selected toolbox item.\n   * @param newItem The newly selected toolbox item.\n   * @returns True if the new item should be selected, false otherwise.\n   */\n  protected shouldSelectItem_(\n    oldItem: ISelectableToolboxItem | null,\n    newItem: ISelectableToolboxItem | null,\n  ): boolean {\n    // Select the new item unless the old item equals the new item.\n    return newItem !== null && newItem !== oldItem;\n  }\n\n  /**\n   * Deselects the given item, marks it as unselected, and updates aria state.\n   *\n   * @param item The previously selected toolbox item which should be\n   *     deselected.\n   */\n  protected deselectItem_(item: ISelectableToolboxItem) {\n    this.selectedItem_ = null;\n    this.previouslySelectedItem_ = item;\n    item.setSelected(false);\n    aria.setState(\n      this.contentsDiv_ as Element,\n      aria.State.ACTIVEDESCENDANT,\n      '',\n    );\n  }\n\n  /**\n   * Selects the given item, marks it selected, and updates aria state.\n   *\n   * @param oldItem The previously selected toolbox item.\n   * @param newItem The newly selected toolbox item.\n   */\n  protected selectItem_(\n    oldItem: ISelectableToolboxItem | null,\n    newItem: ISelectableToolboxItem,\n  ) {\n    this.selectedItem_ = newItem;\n    this.previouslySelectedItem_ = oldItem;\n    newItem.setSelected(true);\n    aria.setState(\n      this.contentsDiv_ as Element,\n      aria.State.ACTIVEDESCENDANT,\n      newItem.getId(),\n    );\n  }\n\n  /**\n   * Selects the toolbox item by its position in the list of toolbox items.\n   *\n   * @param position The position of the item to select.\n   */\n  selectItemByPosition(position: number) {\n    if (position > -1 && position < this.contents_.length) {\n      const item = this.contents_[position];\n      if (item.isSelectable()) {\n        this.setSelectedItem(item);\n      }\n    }\n  }\n\n  /**\n   * Decides whether to hide or show the flyout depending on the selected item.\n   *\n   * @param oldItem The previously selected toolbox item.\n   * @param newItem The newly selected toolbox item.\n   */\n  protected updateFlyout_(\n    oldItem: ISelectableToolboxItem | null,\n    newItem: ISelectableToolboxItem | null,\n  ) {\n    if (\n      !newItem ||\n      (oldItem === newItem && !newItem.isCollapsible()) ||\n      !newItem.getContents().length\n    ) {\n      this.flyout_!.hide();\n    } else {\n      this.flyout_!.show(newItem.getContents());\n      this.flyout_!.scrollToStart();\n    }\n  }\n\n  /**\n   * Emits an event when a new toolbox item is selected.\n   *\n   * @param oldItem The previously selected toolbox item.\n   * @param newItem The newly selected toolbox item.\n   */\n  private fireSelectEvent_(\n    oldItem: ISelectableToolboxItem | null,\n    newItem: ISelectableToolboxItem | null,\n  ) {\n    const oldElement = oldItem && oldItem.getName();\n    let newElement = newItem && newItem.getName();\n    // In this case the toolbox closes, so the newElement should be null.\n    if (oldItem === newItem) {\n      newElement = null;\n    }\n    const event = new (eventUtils.get(eventUtils.TOOLBOX_ITEM_SELECT))(\n      oldElement,\n      newElement,\n      this.workspace_.id,\n    );\n    eventUtils.fire(event);\n  }\n\n  /**\n   * Closes the current item if it is expanded, or selects the parent.\n   *\n   * @returns True if a parent category was selected, false otherwise.\n   */\n  private selectParent_(): boolean {\n    if (!this.selectedItem_) {\n      return false;\n    }\n\n    if (\n      this.selectedItem_.isCollapsible() &&\n      (this.selectedItem_ as ICollapsibleToolboxItem).isExpanded()\n    ) {\n      const collapsibleItem = this.selectedItem_ as ICollapsibleToolboxItem;\n      collapsibleItem.toggleExpanded();\n      return true;\n    } else if (\n      this.selectedItem_.getParent() &&\n      this.selectedItem_.getParent()!.isSelectable()\n    ) {\n      this.setSelectedItem(this.selectedItem_.getParent());\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Selects the first child of the currently selected item, or nothing if the\n   * toolbox item has no children.\n   *\n   * @returns True if a child category was selected, false otherwise.\n   */\n  private selectChild_(): boolean {\n    if (!this.selectedItem_ || !this.selectedItem_.isCollapsible()) {\n      return false;\n    }\n    const collapsibleItem = this.selectedItem_ as ICollapsibleToolboxItem;\n    if (!collapsibleItem.isExpanded()) {\n      collapsibleItem.toggleExpanded();\n      return true;\n    } else {\n      this.selectNext_();\n      return true;\n    }\n  }\n\n  /**\n   * Selects the next visible toolbox item.\n   *\n   * @returns True if a next category was selected, false otherwise.\n   */\n  private selectNext_(): boolean {\n    if (!this.selectedItem_) {\n      return false;\n    }\n\n    let nextItemIdx = this.contents_.indexOf(this.selectedItem_) + 1;\n    if (nextItemIdx > -1 && nextItemIdx < this.contents_.length) {\n      let nextItem = this.contents_[nextItemIdx];\n      while (nextItem && !nextItem.isSelectable()) {\n        nextItem = this.contents_[++nextItemIdx];\n      }\n      if (nextItem && nextItem.isSelectable()) {\n        this.setSelectedItem(nextItem);\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Selects the previous visible toolbox item.\n   *\n   * @returns True if a previous category was selected, false otherwise.\n   */\n  private selectPrevious_(): boolean {\n    if (!this.selectedItem_) {\n      return false;\n    }\n\n    let prevItemIdx = this.contents_.indexOf(this.selectedItem_) - 1;\n    if (prevItemIdx > -1 && prevItemIdx < this.contents_.length) {\n      let prevItem = this.contents_[prevItemIdx];\n      while (prevItem && !prevItem.isSelectable()) {\n        prevItem = this.contents_[--prevItemIdx];\n      }\n      if (prevItem && prevItem.isSelectable()) {\n        this.setSelectedItem(prevItem);\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /** Disposes of this toolbox. */\n  dispose() {\n    this.workspace_.getComponentManager().removeComponent('toolbox');\n    this.flyout_!.dispose();\n    for (let i = 0; i < this.contents_.length; i++) {\n      const toolboxItem = this.contents_[i];\n      toolboxItem.dispose();\n    }\n\n    for (let j = 0; j < this.boundEvents_.length; j++) {\n      browserEvents.unbind(this.boundEvents_[j]);\n    }\n    this.boundEvents_ = [];\n    this.contents_ = [];\n\n    if (this.HtmlDiv) {\n      this.workspace_.getThemeManager().unsubscribe(this.HtmlDiv);\n      dom.removeNode(this.HtmlDiv);\n    }\n  }\n}\n\n/** CSS for Toolbox.  See css.js for use. */\nCss.register(`\n.blocklyToolboxDelete {\n  cursor: url(\"<<<PATH>>>/handdelete.cur\"), auto;\n}\n\n.blocklyToolboxGrab {\n  cursor: url(\"<<<PATH>>>/handclosed.cur\"), auto;\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n/* Category tree in Toolbox. */\n.blocklyToolboxDiv {\n  background-color: #ddd;\n  overflow-x: visible;\n  overflow-y: auto;\n  padding: 4px 0 4px 0;\n  position: absolute;\n  z-index: 70;  /* so blocks go under toolbox when dragging */\n  -webkit-tap-highlight-color: transparent;  /* issue #1345 */\n}\n\n.blocklyToolboxContents {\n  display: flex;\n  flex-wrap: wrap;\n  flex-direction: column;\n}\n\n.blocklyToolboxContents:focus {\n  outline: none;\n}\n`);\n\nregistry.register(registry.Type.TOOLBOX, registry.DEFAULT, Toolbox);\n","/**\n * @license\n * Copyright 2022 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @file The entrypoint for blockly_compressed.js.  Provides various\n * backwards-compatibility hacks.  Not used when loading in\n * uncompressed mode.\n */\n\n// Former goog.module ID: Blockly.main\n\nimport * as Blockly from './blockly.js';\nimport * as Msg from './msg.js';\nimport * as colour from './utils/colour.js';\nimport * as deprecation from './utils/deprecation.js';\n\n/*\n * Aliased functions and properties that used to be on the Blockly namespace.\n * Everything in this section is deprecated. Both external and internal code\n * should avoid using these functions and use the designated replacements.\n * Everything in this section will be removed in a future version of Blockly.\n */\n\n// Add accessors for properties on Blockly that have now been deprecated.\n// This will not work in uncompressed mode; it depends on Blockly being\n// transpiled from a ES Module object to a plain object by Closure Compiler.\nObject.defineProperties(Blockly, {\n  /**\n   * The richness of block colours, regardless of the hue.\n   * Must be in the range of 0 (inclusive) to 1 (exclusive).\n   *\n   * @name Blockly.HSV_SATURATION\n   * @type {number}\n   * @deprecated Use Blockly.utils.colour.getHsvSaturation() /\n   *     .setHsvSaturation() instead.  (July 2023)\n   * @suppress {checkTypes}\n   */\n  HSV_SATURATION: {\n    get: function () {\n      deprecation.warn(\n        'Blockly.HSV_SATURATION',\n        'version 10',\n        'version 11',\n        'Blockly.utils.colour.getHsvSaturation()',\n      );\n      return colour.getHsvSaturation();\n    },\n    set: function (newValue) {\n      deprecation.warn(\n        'Blockly.HSV_SATURATION',\n        'version 10',\n        'version 11',\n        'Blockly.utils.colour.setHsvSaturation()',\n      );\n      colour.setHsvSaturation(newValue);\n    },\n  },\n  /**\n   * The intensity of block colours, regardless of the hue.\n   * Must be in the range of 0 (inclusive) to 1 (exclusive).\n   *\n   * @name Blockly.HSV_VALUE\n   * @type {number}\n   * @deprecated Use Blockly.utils.colour.getHsvValue() / .setHsvValue instead.\n   *     (July 2023)\n   * @suppress {checkTypes}\n   */\n  HSV_VALUE: {\n    get: function () {\n      deprecation.warn(\n        'Blockly.HSV_VALUE',\n        'version 10',\n        'version 11',\n        'Blockly.utils.colour.getHsvValue()',\n      );\n      return colour.getHsvValue();\n    },\n    set: function (newValue) {\n      deprecation.warn(\n        'Blockly.HSV_VALUE',\n        'version 10',\n        'version 11',\n        'Blockly.utils.colour.setHsvValue()',\n      );\n      colour.setHsvValue(newValue);\n    },\n  },\n});\n\n// If Blockly is compiled with ADVANCED_COMPILATION and/or loaded as a\n// CJS or ES module there will not be a Blockly global variable\n// created.  This can cause problems because a very common way of\n// loading translations is to use a <script> tag to load one of\n// the generated msg/*.js files, which consists of lines like:\n//\n// Blockly.Msg[\"ADD_COMMENT\"] = \"Add Comment\";\n// Blockly.Msg[\"CLEAN_UP\"] = \"Clean up Blocks\";\n//\n// This obviously only works if Blockly.Msg is the Msg export from the\n// Blockly.Msg module - so make sure it is, but only if there is not\n// yet a Blockly global variable.\nif (!('Blockly' in globalThis)) {\n  (globalThis as any)['Blockly'] = {'Msg': Msg};\n}\n","/**\n * @license\n * Copyright 2016 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.BlocklyOptions\n\nimport type {Theme, ITheme} from './theme.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport type {ToolboxDefinition} from './utils/toolbox.js';\n\n/**\n * Blockly options.\n */\nexport interface BlocklyOptions {\n  collapse?: boolean;\n  comments?: boolean;\n  css?: boolean;\n  disable?: boolean;\n  grid?: GridOptions;\n  horizontalLayout?: boolean;\n  maxBlocks?: number;\n  maxInstances?: {[blockType: string]: number};\n  media?: string;\n  modalInputs?: boolean;\n  move?: MoveOptions;\n  oneBasedIndex?: boolean;\n  readOnly?: boolean;\n  renderer?: string;\n  rendererOverrides?: {[rendererConstant: string]: any};\n  rtl?: boolean;\n  scrollbars?: ScrollbarOptions | boolean;\n  sounds?: boolean;\n  theme?: Theme | string | ITheme;\n  toolbox?: string | ToolboxDefinition | Element;\n  toolboxPosition?: string;\n  trashcan?: boolean;\n  maxTrashcanContents?: number;\n  plugins?: {[key: string]: (new (...p1: any[]) => any) | string};\n  zoom?: ZoomOptions;\n  parentWorkspace?: WorkspaceSvg;\n}\n\nexport interface GridOptions {\n  colour?: string;\n  length?: number;\n  snap?: boolean;\n  spacing?: number;\n}\n\nexport interface MoveOptions {\n  drag?: boolean;\n  scrollbars?: boolean | ScrollbarOptions;\n  wheel?: boolean;\n}\n\nexport interface ScrollbarOptions {\n  horizontal?: boolean;\n  vertical?: boolean;\n}\n\nexport interface ZoomOptions {\n  controls?: boolean;\n  maxScale?: number;\n  minScale?: number;\n  pinch?: boolean;\n  scaleSpeed?: number;\n  startScale?: number;\n  wheel?: boolean;\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.utils.Metrics\n\nexport interface Metrics {\n  /** Height of the visible portion of the workspace. */\n  viewHeight: number;\n\n  /** Width of the visible portion of the workspace. */\n  viewWidth: number;\n\n  /** Height of the content. */\n  contentHeight: number;\n\n  /** Width of the content. */\n  contentWidth: number;\n\n  /** Height of the scroll area. */\n  scrollHeight: number;\n\n  /** Width of the scroll area. */\n  scrollWidth: number;\n\n  /**\n   * Top-edge of the visible portion of the workspace, relative to the workspace\n   * origin.\n   */\n  viewTop: number;\n\n  /**\n   * Left-edge of the visible portion of the workspace, relative to the\n   * workspace origin.\n   */\n  viewLeft: number;\n\n  /** Top-edge of the content, relative to the workspace origin. */\n  contentTop: number;\n\n  /** Left-edge of the content relative to the workspace origin. */\n  contentLeft: number;\n\n  /** Top-edge of the scroll area, relative to the workspace origin. */\n  scrollTop: number;\n\n  /** Left-edge of the scroll area relative to the workspace origin. */\n  scrollLeft: number;\n\n  /**\n   * Top-edge of the visible portion of the workspace, relative to the\n   * blocklyDiv.\n   */\n  absoluteTop: number;\n\n  /**\n   * Left-edge of the visible portion of the workspace, relative to the\n   * blocklyDiv.\n   */\n  absoluteLeft: number;\n\n  /**\n   * Height of the Blockly div (the view + the toolbox, simple of otherwise).\n   */\n  svgHeight: number;\n\n  /** Width of the Blockly div (the view + the toolbox, simple or otherwise). */\n  svgWidth: number;\n\n  /** Width of the toolbox, if it exists.  Otherwise zero. */\n  toolboxWidth: number;\n\n  /** Height of the toolbox, if it exists.  Otherwise zero. */\n  toolboxHeight: number;\n\n  /** Top, bottom, left or right. Use TOOLBOX_AT constants to compare. */\n  toolboxPosition: number;\n\n  /** Width of the flyout if it is always open.  Otherwise zero. */\n  flyoutWidth: number;\n\n  /** Height of the flyout if it is always open.  Otherwise zero. */\n  flyoutHeight: number;\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.IPathObject\n\nimport type {BlockStyle} from '../../theme.js';\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {ConstantProvider} from './constants.js';\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {Coordinate} from '../../utils/coordinate.js';\n\n/**\n * An interface for a block's path object.\n *\n * @param _root The root SVG element.\n * @param _constants The renderer's constants.\n */\nexport interface IPathObject {\n  /**\n   * The primary path of the block.\n   */\n  svgPath: SVGElement;\n\n  /** The renderer's constant provider. */\n  constants: ConstantProvider;\n\n  /** The primary path of the block. */\n  style: BlockStyle;\n\n  /**\n   * Holds the cursors SVG element when the cursor is attached to the block.\n   * This is null if there is no cursor on the block.\n   */\n  cursorSvg: SVGElement | null;\n\n  /**\n   * Holds the markers SVG element when the marker is attached to the block.\n   * This is null if there is no marker on the block.\n   */\n  markerSvg: SVGElement | null;\n\n  /**\n   * Set the path generated by the renderer onto the respective SVG element.\n   *\n   * @param pathString The path.\n   */\n  setPath(pathString: string): void;\n\n  /**\n   * Apply the stored colours to the block's path, taking into account whether\n   * the paths belong to a shadow block.\n   *\n   * @param block The source block.\n   */\n  applyColour(block: BlockSvg): void;\n\n  /**\n   * Update the style.\n   *\n   * @param blockStyle The block style to use.\n   */\n  setStyle(blockStyle: BlockStyle): void;\n\n  /**\n   * Flip the SVG paths in RTL.\n   */\n  flipRTL(): void;\n\n  /**\n   * Add the cursor SVG to this block's SVG group.\n   *\n   * @param cursorSvg The SVG root of the cursor to be added to the block SVG\n   *     group.\n   */\n  setCursorSvg(cursorSvg: SVGElement): void;\n\n  /**\n   * Add the marker SVG to this block's SVG group.\n   *\n   * @param markerSvg The SVG root of the marker to be added to the block SVG\n   *     group.\n   */\n  setMarkerSvg(markerSvg: SVGElement): void;\n\n  /**\n   * Set whether the block shows a highlight or not.  Block highlighting is\n   * often used to visually mark blocks currently being executed.\n   *\n   * @param highlighted True if highlighted.\n   */\n  updateHighlighted(highlighted: boolean): void;\n\n  /**\n   * Add or remove styling showing that a block is selected.\n   *\n   * @param enable True if selection is enabled, false otherwise.\n   */\n  updateSelected(enabled: boolean): void;\n\n  /**\n   * Add or remove styling showing that a block is dragged over a delete area.\n   *\n   * @param enable True if the block is being dragged over a delete area, false\n   *     otherwise.\n   */\n  updateDraggingDelete(enabled: boolean): void;\n\n  /**\n   * Add or remove styling showing that a block is an insertion marker.\n   *\n   * @param enable True if the block is an insertion marker, false otherwise.\n   */\n  updateInsertionMarker(enabled: boolean): void;\n\n  /**\n   * Add or remove styling showing that a block is movable.\n   *\n   * @param enable True if the block is movable, false otherwise.\n   */\n  updateMovable(enabled: boolean): void;\n\n  /** Adds the given path as a connection highlight for the given connection. */\n  addConnectionHighlight?(\n    connection: RenderedConnection,\n    connectionPath: string,\n    offset: Coordinate,\n    rtl: boolean,\n  ): void;\n\n  /**\n   * Removes any highlight associated with the given connection, if it exists.\n   */\n  removeConnectionHighlight?(connection: RenderedConnection): void;\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.IToolboxItem\n\n/**\n * Interface for an item in the toolbox.\n */\nexport interface IToolboxItem {\n  /**\n   * Initializes the toolbox item.\n   * This includes creating the DOM and updating the state of any items based\n   * on the info object.\n   */\n  init(): void;\n\n  /**\n   * Gets the div for the toolbox item.\n   *\n   * @returns The div for the toolbox item.\n   */\n  getDiv(): Element | null;\n\n  /**\n   * Gets a unique identifier for this toolbox item.\n   *\n   * @returns The ID for the toolbox item.\n   */\n  getId(): string;\n\n  /**\n   * Gets the parent if the toolbox item is nested.\n   *\n   * @returns The parent toolbox item, or null if this toolbox item is not\n   *     nested.\n   */\n  getParent(): IToolboxItem | null;\n\n  /**\n   * Gets the nested level of the category.\n   *\n   * @returns The nested level of the category.\n   * @internal\n   */\n  getLevel(): number;\n\n  /**\n   * Whether the toolbox item is selectable.\n   *\n   * @returns True if the toolbox item can be selected.\n   */\n  isSelectable(): boolean;\n\n  /**\n   * Whether the toolbox item is collapsible.\n   *\n   * @returns True if the toolbox item is collapsible.\n   */\n  isCollapsible(): boolean;\n\n  /** Dispose of this toolbox item. No-op by default. */\n  dispose(): void;\n\n  /**\n   * Gets the HTML element that is clickable.\n   *\n   * @returns The HTML element that receives clicks.\n   */\n  getClickTarget(): Element | null;\n\n  /**\n   * Sets whether the category is visible or not.\n   * For a category to be visible its parent category must also be expanded.\n   *\n   * @param isVisible True if category should be visible.\n   */\n  setVisible_(isVisible: boolean): void;\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.IToolbox\n\nimport type {IRegistrable} from './i_registrable.js';\nimport type {IToolboxItem} from './i_toolbox_item.js';\nimport type {ToolboxInfo} from '../utils/toolbox.js';\nimport type {IFlyout} from './i_flyout.js';\nimport type {WorkspaceSvg} from '../workspace_svg.js';\n\n/**\n * Interface for a toolbox.\n */\nexport interface IToolbox extends IRegistrable {\n  /** Initializes the toolbox. */\n  init(): void;\n\n  /**\n   * Fills the toolbox with new toolbox items and removes any old contents.\n   *\n   * @param toolboxDef Object holding information for creating a toolbox.\n   */\n  render(toolboxDef: ToolboxInfo): void;\n\n  /**\n   * Gets the width of the toolbox.\n   *\n   * @returns The width of the toolbox.\n   */\n  getWidth(): number;\n\n  /**\n   * Gets the height of the toolbox.\n   *\n   * @returns The height of the toolbox.\n   */\n  getHeight(): number;\n\n  /**\n   * Gets the toolbox flyout.\n   *\n   * @returns The toolbox flyout.\n   */\n  getFlyout(): IFlyout | null;\n\n  /**\n   * Gets the workspace for the toolbox.\n   *\n   * @returns The parent workspace for the toolbox.\n   */\n  getWorkspace(): WorkspaceSvg;\n\n  /**\n   * Gets whether or not the toolbox is horizontal.\n   *\n   * @returns True if the toolbox is horizontal, false if the toolbox is\n   *     vertical.\n   */\n  isHorizontal(): boolean;\n\n  /**\n   * Positions the toolbox based on whether it is a horizontal toolbox and\n   * whether the workspace is in rtl.\n   */\n  position(): void;\n\n  /** Handles resizing the toolbox when a toolbox item resizes. */\n  handleToolboxItemResize(): void;\n\n  /** Unhighlights any previously selected item. */\n  clearSelection(): void;\n\n  /**\n   * Updates the category colours and background colour of selected categories.\n   */\n  refreshTheme(): void;\n\n  /**\n   * Updates the flyout's content without closing it.  Should be used in\n   * response to a change in one of the dynamic categories, such as variables or\n   * procedures.\n   */\n  refreshSelection(): void;\n\n  /**\n   * Sets the visibility of the toolbox.\n   *\n   * @param isVisible True if toolbox should be visible.\n   */\n  setVisible(isVisible: boolean): void;\n\n  /**\n   * Selects the toolbox item by it's position in the list of toolbox items.\n   *\n   * @param position The position of the item to select.\n   */\n  selectItemByPosition(position: number): void;\n\n  /**\n   * Gets the selected item.\n   *\n   * @returns The selected item, or null if no item is currently selected.\n   */\n  getSelectedItem(): IToolboxItem | null;\n\n  /** Disposes of this toolbox. */\n  dispose(): void;\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.IStyleable\n\n/**\n * Interface for an object that a style can be added to.\n */\nexport interface IStyleable {\n  /**\n   * Adds a style on the toolbox. Usually used to change the cursor.\n   *\n   * @param style The name of the class to add.\n   */\n  addStyle(style: string): void;\n\n  /**\n   * Removes a style from the toolbox. Usually used to change the cursor.\n   *\n   * @param style The name of the class to remove.\n   */\n  removeStyle(style: string): void;\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.serialization.ISerializer\n\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Serializes and deserializes a plugin or system.\n */\nexport interface ISerializer {\n  /**\n   * A priority value used to determine the order of deserializing state.\n   * More positive priorities are deserialized before less positive\n   * priorities. Eg if you have priorities (0, -10, 10, 100) the order of\n   * deserialiation will be (100, 10, 0, -10).\n   * If two serializers have the same priority, they are deserialized in an\n   * arbitrary order relative to each other.\n   */\n  priority: number;\n\n  /* eslint-disable no-unused-vars, valid-jsdoc */\n\n  /**\n   * Saves the state of the plugin or system.\n   *\n   * @param workspace The workspace the system to serialize is associated with.\n   * @returns A JS object containing the system's state, or null if there is no\n   *     state to record.\n   */\n  save(workspace: Workspace): Object | null;\n  /* eslint-enable valid-jsdoc */\n\n  /**\n   * Loads the state of the plugin or system.\n   *\n   * @param state The state of the system to deserialize. This will always be\n   *     non-null.\n   * @param workspace The workspace the system to deserialize is associated\n   *     with.\n   */\n  load(state: Object, workspace: Workspace): void;\n\n  /**\n   * Clears the state of the plugin or system.\n   *\n   * @param workspace The workspace the system to clear the state of is\n   *     associated with.\n   */\n  clear(workspace: Workspace): void;\n}\n/* eslint-enable no-unused-vars */\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.ISelectable\n\nimport type {IDeletable} from './i_deletable.js';\nimport type {IMovable} from './i_movable.js';\n\n/**\n * The interface for an object that is selectable.\n */\nexport interface ISelectable extends IDeletable, IMovable {\n  id: string;\n\n  /** Select this.  Highlight it visually. */\n  select(): void;\n\n  /** Unselect this.  Unhighlight it visually. */\n  unselect(): void;\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.IRegistrable\n\n/**\n * The interface for a Blockly component that can be registered.\n */\nexport interface IRegistrable {}\n","/**\n * @license\n * Copyright 2022 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {IParameterModel} from './i_parameter_model.js';\n\n/**\n * A data model for a procedure.\n */\nexport interface IProcedureModel {\n  /** Sets the human-readable name of the procedure. */\n  setName(name: string): this;\n\n  /**\n   * Inserts a parameter into the list of parameters.\n   *\n   * To move a parameter, first delete it, and then re-insert.\n   */\n  insertParameter(parameterModel: IParameterModel, index: number): this;\n\n  /** Removes the parameter at the given index from the parameter list. */\n  deleteParameter(index: number): this;\n\n  /**\n   * Sets the return type(s) of the procedure.\n   *\n   * Pass null to represent a procedure that does not return.\n   */\n  setReturnTypes(types: string[] | null): this;\n\n  /**\n   * Sets whether this procedure is enabled/disabled. If a procedure is disabled\n   * all procedure caller blocks should be disabled as well.\n   */\n  setEnabled(enabled: boolean): this;\n\n  /** Returns the unique language-neutral ID for the procedure. */\n  getId(): string;\n\n  /** Returns the human-readable name of the procedure. */\n  getName(): string;\n\n  /** Returns the parameter at the given index in the parameter list. */\n  getParameter(index: number): IParameterModel;\n\n  /** Returns an array of all of the parameters in the parameter list. */\n  getParameters(): IParameterModel[];\n\n  /**\n   * Returns the return type(s) of the procedure.\n   *\n   * Null represents a procedure that does not return a value.\n   */\n  getReturnTypes(): string[] | null;\n\n  /**\n   * Returns whether the procedure is enabled/disabled. If a procedure is\n   * disabled, all procedure caller blocks should be disabled as well.\n   */\n  getEnabled(): boolean;\n}\n","/**\n * @license\n * Copyright 2022 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {IProcedureModel} from './i_procedure_model.js';\n\nexport interface IProcedureMap extends Map<string, IProcedureModel> {\n  /**\n   * Adds the given ProcedureModel to the map of procedure models, so that\n   * blocks can find it.\n   */\n  add(proc: IProcedureModel): this;\n\n  /** Returns all of the procedures stored in this map. */\n  getProcedures(): IProcedureModel[];\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {Rect} from '../utils/rect.js';\nimport type {UiMetrics} from '../metrics_manager.js';\n// Former goog.module ID: Blockly.IPositionable\n\nimport type {IComponent} from './i_component.js';\n\n/**\n * Interface for a component that is positioned on top of the workspace.\n */\nexport interface IPositionable extends IComponent {\n  /**\n   * Positions the element. Called when the window is resized.\n   *\n   * @param metrics The workspace metrics.\n   * @param savedPositions List of rectangles that are already on the workspace.\n   */\n  position(metrics: UiMetrics, savedPositions: Rect[]): void;\n\n  /**\n   * Returns the bounding rectangle of the UI element in pixel units relative to\n   * the Blockly injection div.\n   *\n   * @returns The UI elements's bounding box. Null if bounding box should be\n   *     ignored by other UI elements.\n   */\n  getBoundingRectangle(): Rect | null;\n}\n","/**\n * @license\n * Copyright 2022 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {IProcedureModel} from './i_procedure_model';\n\n/**\n * A data model for a procedure.\n */\nexport interface IParameterModel {\n  /**\n   * Sets the name of this parameter to the given name.\n   */\n  setName(name: string): this;\n\n  /**\n   * Sets the types of this parameter to the given type.\n   */\n  setTypes(types: string[]): this;\n\n  /**\n   * Returns the name of this parameter.\n   */\n  getName(): string;\n\n  /**\n   * Return the types of this parameter.\n   */\n  getTypes(): string[];\n\n  /**\n   * Returns the unique language-neutral ID for the parameter.\n   *\n   * This represents the identify of the variable model which does not change\n   * over time.\n   */\n  getId(): string;\n\n  /** Sets the procedure model this parameter is associated with. */\n  setProcedureModel(model: IProcedureModel): this;\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.IMovable\n\n/**\n * The interface for an object that is movable.\n */\nexport interface IMovable {\n  /**\n   * Get whether this is movable or not.\n   *\n   * @returns True if movable.\n   */\n  isMovable(): boolean;\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {\n  ContainerRegion,\n  ToolboxMetrics,\n  AbsoluteMetrics,\n  UiMetrics,\n} from '../metrics_manager.js';\nimport type {Size} from '../utils/size.js';\nimport type {Metrics} from '../utils/metrics.js';\n// Former goog.module ID: Blockly.IMetricsManager\n\n/**\n * Interface for a metrics manager.\n */\nexport interface IMetricsManager {\n  /**\n   * Returns whether the scroll area has fixed edges.\n   *\n   * @returns Whether the scroll area has fixed edges.\n   * @internal\n   */\n  hasFixedEdges(): boolean;\n\n  /**\n   * Returns the metrics for the scroll area of the workspace.\n   *\n   * @param opt_getWorkspaceCoordinates True to get the scroll metrics in\n   *     workspace coordinates, false to get them in pixel coordinates.\n   * @param opt_viewMetrics The view metrics if they have been previously\n   *     computed. Passing in null may cause the view metrics to be computed\n   *     again, if it is needed.\n   * @param opt_contentMetrics The content metrics if they have been previously\n   *     computed. Passing in null may cause the content metrics to be computed\n   *     again, if it is needed.\n   * @returns The metrics for the scroll container\n   */\n  getScrollMetrics(\n    opt_getWorkspaceCoordinates?: boolean,\n    opt_viewMetrics?: ContainerRegion,\n    opt_contentMetrics?: ContainerRegion,\n  ): ContainerRegion;\n\n  /**\n   * Gets the width and the height of the flyout in pixel\n   * coordinates. By default, will get metrics for either a simple flyout (owned\n   * directly by the workspace) or for the flyout owned by the toolbox. If you\n   * pass `opt_own` as `true` then only metrics for the simple flyout will be\n   * returned, and it will return 0 for the width and height if the workspace\n   * has a category toolbox instead of a simple toolbox.\n   *\n   * @param opt_own Whether to only return the workspace's own flyout metrics.\n   * @returns The width and height of the flyout.\n   */\n  getFlyoutMetrics(opt_own?: boolean): ToolboxMetrics;\n\n  /**\n   * Gets the width, height and position of the toolbox on the workspace in\n   * pixel coordinates. Returns 0 for the width and height if the workspace has\n   * a simple toolbox instead of a category toolbox. To get the width and height\n   * of a simple toolbox, see {@link IMetricsManager#getFlyoutMetrics}.\n   *\n   * @returns The object with the width, height and position of the toolbox.\n   */\n  getToolboxMetrics(): ToolboxMetrics;\n\n  /**\n   * Gets the width and height of the workspace's parent SVG element in pixel\n   * coordinates. This area includes the toolbox and the visible workspace area.\n   *\n   * @returns The width and height of the workspace's parent SVG element.\n   */\n  getSvgMetrics(): Size;\n\n  /**\n   * Gets the absolute left and absolute top in pixel coordinates.\n   * This is where the visible workspace starts in relation to the SVG\n   * container.\n   *\n   * @returns The absolute metrics for the workspace.\n   */\n  getAbsoluteMetrics(): AbsoluteMetrics;\n\n  /**\n   * Gets the metrics for the visible workspace in either pixel or workspace\n   * coordinates. The visible workspace does not include the toolbox or flyout.\n   *\n   * @param opt_getWorkspaceCoordinates True to get the view metrics in\n   *     workspace coordinates, false to get them in pixel coordinates.\n   * @returns The width, height, top and left of the viewport in either\n   *     workspace coordinates or pixel coordinates.\n   */\n  getViewMetrics(opt_getWorkspaceCoordinates?: boolean): ContainerRegion;\n\n  /**\n   * Gets content metrics in either pixel or workspace coordinates.\n   * The content area is a rectangle around all the top bounded elements on the\n   * workspace (workspace comments and blocks).\n   *\n   * @param opt_getWorkspaceCoordinates True to get the content metrics in\n   *     workspace coordinates, false to get them in pixel coordinates.\n   * @returns The metrics for the content container.\n   */\n  getContentMetrics(opt_getWorkspaceCoordinates?: boolean): ContainerRegion;\n\n  /**\n   * Returns an object with all the metrics required to size scrollbars for a\n   * top level workspace.  The following properties are computed:\n   * Coordinate system: pixel coordinates, -left, -up, +right, +down\n   * .viewHeight: Height of the visible portion of the workspace.\n   * .viewWidth: Width of the visible portion of the workspace.\n   * .contentHeight: Height of the content.\n   * .contentWidth: Width of the content.\n   * .svgHeight: Height of the Blockly div (the view + the toolbox,\n   *    simple or otherwise),\n   * .svgWidth: Width of the Blockly div (the view + the toolbox,\n   *    simple or otherwise),\n   * .viewTop: Top-edge of the visible portion of the workspace, relative to\n   *     the workspace origin.\n   * .viewLeft: Left-edge of the visible portion of the workspace, relative to\n   *     the workspace origin.\n   * .contentTop: Top-edge of the content, relative to the workspace origin.\n   * .contentLeft: Left-edge of the content relative to the workspace origin.\n   * .absoluteTop: Top-edge of the visible portion of the workspace, relative\n   *     to the blocklyDiv.\n   * .absoluteLeft: Left-edge of the visible portion of the workspace, relative\n   *     to the blocklyDiv.\n   * .toolboxWidth: Width of the toolbox, if it exists.  Otherwise zero.\n   * .toolboxHeight: Height of the toolbox, if it exists.  Otherwise zero.\n   * .flyoutWidth: Width of the flyout if it is always open.  Otherwise zero.\n   * .flyoutHeight: Height of the flyout if it is always open.  Otherwise zero.\n   * .toolboxPosition: Top, bottom, left or right. Use TOOLBOX_AT constants to\n   *     compare.\n   *\n   * @returns Contains size and position metrics of a top level workspace.\n   */\n  getMetrics(): Metrics;\n\n  /**\n   * Returns common metrics used by UI elements.\n   *\n   * @returns The UI metrics.\n   */\n  getUiMetrics(): UiMetrics;\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {KeyboardShortcut} from '../shortcut_registry.js';\n// Former goog.module ID: Blockly.IKeyboardAccessible\n\n/**\n * An interface for an object that handles keyboard shortcuts.\n */\nexport interface IKeyboardAccessible {\n  /**\n   * Handles the given keyboard shortcut.\n   *\n   * @param shortcut The shortcut to be handled.\n   * @returns True if the shortcut has been handled, false otherwise.\n   */\n  onShortcut(shortcut: KeyboardShortcut): boolean;\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.IFlyout\n\nimport type {WorkspaceSvg} from '../workspace_svg.js';\nimport type {BlockSvg} from '../block_svg.js';\nimport type {Coordinate} from '../utils/coordinate.js';\nimport type {FlyoutDefinition} from '../utils/toolbox.js';\nimport type {Svg} from '../utils/svg.js';\nimport type {IRegistrable} from './i_registrable.js';\n\n/**\n * Interface for a flyout.\n */\nexport interface IFlyout extends IRegistrable {\n  /** Whether the flyout is laid out horizontally or not. */\n  horizontalLayout: boolean;\n\n  /** Is RTL vs LTR. */\n  RTL: boolean;\n\n  /** The target workspace */\n  targetWorkspace: WorkspaceSvg | null;\n\n  /** Margin around the edges of the blocks in the flyout. */\n  readonly MARGIN: number;\n\n  /** Does the flyout automatically close when a block is created? */\n  autoClose: boolean;\n\n  /** Corner radius of the flyout background. */\n  readonly CORNER_RADIUS: number;\n\n  /**\n   * Creates the flyout's DOM.  Only needs to be called once.  The flyout can\n   * either exist as its own svg element or be a g element nested inside a\n   * separate svg element.\n   *\n   * @param tagName The type of tag to put the flyout in. This should be <svg>\n   *     or <g>.\n   * @returns The flyout's SVG group.\n   */\n  createDom(\n    tagName: string | Svg<SVGSVGElement> | Svg<SVGGElement>,\n  ): SVGElement;\n\n  /**\n   * Initializes the flyout.\n   *\n   * @param targetWorkspace The workspace in which to create new blocks.\n   */\n  init(targetWorkspace: WorkspaceSvg): void;\n\n  /**\n   * Dispose of this flyout.\n   * Unlink from all DOM elements to prevent memory leaks.\n   */\n  dispose(): void;\n\n  /**\n   * Get the width of the flyout.\n   *\n   * @returns The width of the flyout.\n   */\n  getWidth(): number;\n\n  /**\n   * Get the height of the flyout.\n   *\n   * @returns The height of the flyout.\n   */\n  getHeight(): number;\n\n  /**\n   * Get the workspace inside the flyout.\n   *\n   * @returns The workspace inside the flyout.\n   */\n  getWorkspace(): WorkspaceSvg;\n\n  /**\n   * Is the flyout visible?\n   *\n   * @returns True if visible.\n   */\n  isVisible(): boolean;\n\n  /**\n   * Set whether the flyout is visible. A value of true does not necessarily\n   * mean that the flyout is shown. It could be hidden because its container is\n   * hidden.\n   *\n   * @param visible True if visible.\n   */\n  setVisible(visible: boolean): void;\n\n  /**\n   * Set whether this flyout's container is visible.\n   *\n   * @param visible Whether the container is visible.\n   */\n  setContainerVisible(visible: boolean): void;\n\n  /** Hide and empty the flyout. */\n  hide(): void;\n\n  /**\n   * Show and populate the flyout.\n   *\n   * @param flyoutDef Contents to display in the flyout. This is either an array\n   *     of Nodes, a NodeList, a toolbox definition, or a string with the name\n   *     of the dynamic category.\n   */\n  show(flyoutDef: FlyoutDefinition | string): void;\n\n  /**\n   * Create a copy of this block on the workspace.\n   *\n   * @param originalBlock The block to copy from the flyout.\n   * @returns The newly created block.\n   * @throws {Error} if something went wrong with deserialization.\n   */\n  createBlock(originalBlock: BlockSvg): BlockSvg;\n\n  /** Reflow blocks and their mats. */\n  reflow(): void;\n\n  /**\n   * @returns True if this flyout may be scrolled with a scrollbar or by\n   *     dragging.\n   */\n  isScrollable(): boolean;\n\n  /**\n   * Calculates the x coordinate for the flyout position.\n   *\n   * @returns X coordinate.\n   */\n  getX(): number;\n\n  /**\n   * Calculates the y coordinate for the flyout position.\n   *\n   * @returns Y coordinate.\n   */\n  getY(): number;\n\n  /** Position the flyout. */\n  position(): void;\n\n  /**\n   * Determine if a drag delta is toward the workspace, based on the position\n   * and orientation of the flyout. This is used in determineDragIntention_ to\n   * determine if a new block should be created or if the flyout should scroll.\n   *\n   * @param currentDragDeltaXY How far the pointer has moved from the position\n   *     at mouse down, in pixel units.\n   * @returns True if the drag is toward the workspace.\n   */\n  isDragTowardWorkspace(currentDragDeltaXY: Coordinate): boolean;\n\n  /**\n   * Does this flyout allow you to create a new instance of the given block?\n   * Used for deciding if a block can be \"dragged out of\" the flyout.\n   *\n   * @param block The block to copy from the flyout.\n   * @returns True if you can create a new instance of the block, false\n   *     otherwise.\n   */\n  isBlockCreatable(block: BlockSvg): boolean;\n\n  /** Scroll the flyout to the beginning of its contents. */\n  scrollToStart(): void;\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.IDraggable\n\nimport type {IDeletable} from './i_deletable.js';\n\n/**\n * The interface for an object that can be dragged.\n */\nexport interface IDraggable extends IDeletable {}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {Rect} from '../utils/rect.js';\n\nimport {IDraggable} from './i_draggable.js';\n\n// Former goog.module ID: Blockly.IDragTarget\n\nimport type {IComponent} from './i_component.js';\n\n/**\n * Interface for a component with custom behaviour when a block or bubble is\n * dragged over or dropped on top of it.\n */\nexport interface IDragTarget extends IComponent {\n  /**\n   * Returns the bounding rectangle of the drag target area in pixel units\n   * relative to viewport.\n   *\n   * @returns The component's bounding box. Null if drag target area should be\n   *     ignored.\n   */\n  getClientRect(): Rect | null;\n\n  /**\n   * Handles when a cursor with a block or bubble enters this drag target.\n   *\n   * @param dragElement The block or bubble currently being dragged.\n   */\n  onDragEnter(dragElement: IDraggable): void;\n\n  /**\n   * Handles when a cursor with a block or bubble is dragged over this drag\n   * target.\n   *\n   * @param dragElement The block or bubble currently being dragged.\n   */\n  onDragOver(dragElement: IDraggable): void;\n\n  /**\n   * Handles when a cursor with a block or bubble exits this drag target.\n   *\n   * @param dragElement The block or bubble currently being dragged.\n   */\n  onDragExit(dragElement: IDraggable): void;\n\n  /**\n   * Handles when a block or bubble is dropped on this component.\n   * Should not handle delete here.\n   *\n   * @param dragElement The block or bubble currently being dragged.\n   */\n  onDrop(dragElement: IDraggable): void;\n\n  /**\n   * Returns whether the provided block or bubble should not be moved after\n   * being dropped on this component. If true, the element will return to where\n   * it was when the drag started.\n   *\n   * @param dragElement The block or bubble currently being dragged.\n   * @returns Whether the block or bubble provided should be returned to drag\n   *     start.\n   */\n  shouldPreventMove(dragElement: IDraggable): boolean;\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.IDeleteArea\n\nimport type {IDragTarget} from './i_drag_target.js';\nimport type {IDraggable} from './i_draggable.js';\n\n/**\n * Interface for a component that can delete a block or bubble that is dropped\n * on top of it.\n */\nexport interface IDeleteArea extends IDragTarget {\n  /**\n   * Returns whether the provided block or bubble would be deleted if dropped on\n   * this area.\n   * This method should check if the element is deletable and is always called\n   * before onDragEnter/onDragOver/onDragExit.\n   *\n   * @param element The block or bubble currently being dragged.\n   * @param couldConnect Whether the element could could connect to another.\n   * @returns Whether the element provided would be deleted if dropped on this\n   *     area.\n   */\n  wouldDelete(element: IDraggable, couldConnect: boolean): boolean;\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.IDeletable\n\n/**\n * The interface for an object that can be deleted.\n */\nexport interface IDeletable {\n  /**\n   * Get whether this object is deletable or not.\n   *\n   * @returns True if deletable.\n   */\n  isDeletable(): boolean;\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.IContextMenu\n\nexport interface IContextMenu {\n  /**\n   * Show the context menu for this object.\n   *\n   * @param e Mouse event.\n   */\n  showContextMenu(e: Event): void;\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {BlockSvg} from '../block_svg';\nimport type {RenderedConnection} from '../rendered_connection';\n\n/**\n * Displays visual \"previews\" of where a block will be connected if it is\n * dropped.\n */\nexport interface IConnectionPreviewer {\n  /**\n   * Display a connection preview where the draggedCon connects to the\n   * staticCon, replacing the replacedBlock (currently connected to the\n   * staticCon).\n   *\n   * @param draggedCon The connection on the block stack being dragged.\n   * @param staticCon The connection not being dragged that we are\n   *     connecting to.\n   * @param replacedBlock The block currently connected to the staticCon that\n   *     is being replaced.\n   */\n  previewReplacement(\n    draggedConn: RenderedConnection,\n    staticConn: RenderedConnection,\n    replacedBlock: BlockSvg,\n  ): void;\n\n  /**\n   * Display a connection preview where the draggedCon connects to the\n   * staticCon, and no block is being relaced.\n   *\n   * @param draggedCon The connection on the block stack being dragged.\n   * @param staticCon The connection not being dragged that we are\n   *     connecting to.\n   */\n  previewConnection(\n    draggedConn: RenderedConnection,\n    staticConn: RenderedConnection,\n  ): void;\n\n  /** Hide any previews that are currently displayed. */\n  hidePreview(): void;\n\n  /** Dispose of any references held by this connection previewer. */\n  dispose(): void;\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {Connection} from '../connection.js';\nimport type {RenderedConnection} from '../rendered_connection.js';\n// Former goog.module ID: Blockly.IConnectionChecker\n\n/**\n * Class for connection type checking logic.\n */\nexport interface IConnectionChecker {\n  /**\n   * Check whether the current connection can connect with the target\n   * connection.\n   *\n   * @param a Connection to check compatibility with.\n   * @param b Connection to check compatibility with.\n   * @param isDragging True if the connection is being made by dragging a block.\n   * @param opt_distance The max allowable distance between the connections for\n   *     drag checks.\n   * @returns Whether the connection is legal.\n   */\n  canConnect(\n    a: Connection | null,\n    b: Connection | null,\n    isDragging: boolean,\n    opt_distance?: number,\n  ): boolean;\n\n  /**\n   * Checks whether the current connection can connect with the target\n   * connection, and return an error code if there are problems.\n   *\n   * @param a Connection to check compatibility with.\n   * @param b Connection to check compatibility with.\n   * @param isDragging True if the connection is being made by dragging a block.\n   * @param opt_distance The max allowable distance between the connections for\n   *     drag checks.\n   * @returns Connection.CAN_CONNECT if the connection is legal, an error code\n   *     otherwise.\n   */\n  canConnectWithReason(\n    a: Connection | null,\n    b: Connection | null,\n    isDragging: boolean,\n    opt_distance?: number,\n  ): number;\n\n  /**\n   * Helper method that translates a connection error code into a string.\n   *\n   * @param errorCode The error code.\n   * @param a One of the two connections being checked.\n   * @param b The second of the two connections being checked.\n   * @returns A developer-readable error string.\n   */\n  getErrorMessage(\n    errorCode: number,\n    a: Connection | null,\n    b: Connection | null,\n  ): string;\n\n  /**\n   * Check that connecting the given connections is safe, meaning that it would\n   * not break any of Blockly's basic assumptions (e.g. no self connections).\n   *\n   * @param a The first of the connections to check.\n   * @param b The second of the connections to check.\n   * @returns An enum with the reason this connection is safe or unsafe.\n   */\n  doSafetyChecks(a: Connection | null, b: Connection | null): number;\n\n  /**\n   * Check whether this connection is compatible with another connection with\n   * respect to the value type system.  E.g. square_root(\"Hello\") is not\n   * compatible.\n   *\n   * @param a Connection to compare.\n   * @param b Connection to compare against.\n   * @returns True if the connections share a type.\n   */\n  doTypeChecks(a: Connection, b: Connection): boolean;\n\n  /**\n   * Check whether this connection can be made by dragging.\n   *\n   * @param a Connection to compare.\n   * @param b Connection to compare against.\n   * @param distance The maximum allowable distance between connections.\n   * @returns True if the connection is allowed during a drag.\n   */\n  doDragChecks(\n    a: RenderedConnection,\n    b: RenderedConnection,\n    distance: number,\n  ): boolean;\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.IComponent\n\n/**\n * The interface for a workspace component that can be registered with the\n * ComponentManager.\n */\nexport interface IComponent {\n  /**\n   * The unique ID for this component that is used to register with the\n   * ComponentManager.\n   */\n  id: string;\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.ICollapsibleToolboxItem\n\nimport type {ISelectableToolboxItem} from './i_selectable_toolbox_item.js';\nimport type {IToolboxItem} from './i_toolbox_item.js';\n\n/**\n * Interface for an item in the toolbox that can be collapsed.\n */\nexport interface ICollapsibleToolboxItem extends ISelectableToolboxItem {\n  /**\n   * Gets any children toolbox items. (ex. Gets the subcategories)\n   *\n   * @returns The child toolbox items.\n   */\n  getChildToolboxItems(): IToolboxItem[];\n\n  /**\n   * Whether the toolbox item is expanded to show its child subcategories.\n   *\n   * @returns True if the toolbox item shows its children, false if it is\n   *     collapsed.\n   */\n  isExpanded(): boolean;\n\n  /** Toggles whether or not the toolbox item is expanded. */\n  toggleExpanded(): void;\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {Coordinate} from '../utils/coordinate.js';\n// Former goog.module ID: Blockly.IBubble\n\nimport type {IContextMenu} from './i_contextmenu.js';\nimport type {IDraggable} from './i_draggable.js';\n\n/**\n * A bubble interface.\n */\nexport interface IBubble extends IDraggable, IContextMenu {\n  /**\n   * Return the coordinates of the top-left corner of this bubble's body\n   * relative to the drawing surface's origin (0,0), in workspace units.\n   *\n   * @returns Object with .x and .y properties.\n   */\n  getRelativeToSurfaceXY(): Coordinate;\n\n  /**\n   * Return the root node of the bubble's SVG group.\n   *\n   * @returns The root SVG node of the bubble's group.\n   */\n  getSvgRoot(): SVGElement;\n\n  /**\n   * Sets whether or not this bubble is being dragged.\n   *\n   * @param adding True if dragging, false otherwise.\n   */\n  setDragging(dragging: boolean): void;\n\n  /**\n   * Move this bubble during a drag.\n   *\n   * @param newLoc The location to translate to, in workspace coordinates.\n   */\n  moveDuringDrag(newLoc: Coordinate): void;\n\n  /**\n   * Move the bubble to the specified location in workspace coordinates.\n   *\n   * @param x The x position to move to.\n   * @param y The y position to move to.\n   */\n  moveTo(x: number, y: number): void;\n\n  /**\n   * Update the style of this bubble when it is dragged over a delete area.\n   *\n   * @param enable True if the bubble is about to be deleted, false otherwise.\n   */\n  setDeleteStyle(enable: boolean): void;\n\n  /** Dispose of this bubble. */\n  dispose(): void;\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {Rect} from '../utils/rect.js';\n// Former goog.module ID: Blockly.IBoundedElement\n\n/**\n * A bounded element interface.\n */\nexport interface IBoundedElement {\n  /**\n   * Returns the coordinates of a bounded element describing the dimensions of\n   * the element. Coordinate system: workspace coordinates.\n   *\n   * @returns Object with coordinates of the bounded element.\n   */\n  getBoundingRectangle(): Rect;\n\n  /**\n   * Move the element by a relative offset.\n   *\n   * @param dx Horizontal offset in workspace units.\n   * @param dy Vertical offset in workspace units.\n   * @param reason Why is this move happening?  'user', 'bump', 'snap'...\n   */\n  moveBy(dx: number, dy: number, reason?: string[]): void;\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {Coordinate} from '../utils/coordinate.js';\nimport type {BlockSvg} from '../block_svg.js';\n// Former goog.module ID: Blockly.IBlockDragger\n\n/**\n * A block dragger interface.\n */\nexport interface IBlockDragger {\n  /**\n   * Start dragging a block.\n   *\n   * @param currentDragDeltaXY How far the pointer has moved from the position\n   *     at mouse down, in pixel units.\n   * @param healStack Whether or not to heal the stack after disconnecting.\n   */\n  startDrag(currentDragDeltaXY: Coordinate, healStack: boolean): void;\n\n  /**\n   * Execute a step of block dragging, based on the given event.  Update the\n   * display accordingly.\n   *\n   * @param e The most recent move event.\n   * @param currentDragDeltaXY How far the pointer has moved from the position\n   *     at the start of the drag, in pixel units.\n   */\n  drag(e: Event, currentDragDeltaXY: Coordinate): void;\n\n  /**\n   * Finish a block drag and put the block back on the workspace.\n   *\n   * @param e The mouseup/touchend event.\n   * @param currentDragDeltaXY How far the pointer has moved from the position\n   *     at the start of the drag, in pixel units.\n   */\n  endDrag(e: Event, currentDragDeltaXY: Coordinate): void;\n\n  /**\n   * Get a list of the insertion markers that currently exist.  Drags have 0, 1,\n   * or 2 insertion markers.\n   *\n   * @returns A possibly empty list of insertion marker blocks.\n   */\n  getInsertionMarkers(): BlockSvg[];\n\n  /** Sever all links from this object and do any necessary cleanup. */\n  dispose(): void;\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.IAutoHideable\n\nimport type {IComponent} from './i_component.js';\n\n/**\n * Interface for a component that can be automatically hidden.\n */\nexport interface IAutoHideable extends IComponent {\n  /**\n   * Hides the component. Called in WorkspaceSvg.hideChaff.\n   *\n   * @param onlyClosePopups Whether only popups should be closed.\n   *   Flyouts should not be closed if this is true.\n   */\n  autoHide(onlyClosePopups: boolean): void;\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.IASTNodeLocationWithBlock\n\nimport type {IASTNodeLocation} from './i_ast_node_location.js';\nimport type {Block} from '../block.js';\n\n/**\n * An AST node location that has an associated block.\n */\nexport interface IASTNodeLocationWithBlock extends IASTNodeLocation {\n  /**\n   * Get the source block associated with this node.\n   *\n   * @returns The source block.\n   */\n  getSourceBlock(): Block | null;\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.IASTNodeLocationSvg\n\nimport type {IASTNodeLocation} from './i_ast_node_location.js';\n\n/**\n * An AST node location SVG interface.\n */\nexport interface IASTNodeLocationSvg extends IASTNodeLocation {\n  /**\n   * Add the marker SVG to this node's SVG group.\n   *\n   * @param markerSvg The SVG root of the marker to be added to the SVG group.\n   */\n  setMarkerSvg(markerSvg: SVGElement | null): void;\n\n  /**\n   * Add the cursor SVG to this node's SVG group.\n   *\n   * @param cursorSvg The SVG root of the cursor to be added to the SVG group.\n   */\n  setCursorSvg(cursorSvg: SVGElement | null): void;\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.IASTNodeLocation\n\n/**\n * An AST node location interface.\n */\nexport interface IASTNodeLocation {}\n","import * as Blockly from \"blockly/core\";\n\nexport const endiveGenerator = new Blockly.Generator(\"Endive\");\n\nendiveGenerator.RESERVED_WORDS_ = \"let,lemma,example,ohno\";\nendiveGenerator.init = function (workspace) {\n  this.nameDB_ = new Blockly.Names(endiveGenerator.RESERVED_WORDS_);\n  endiveGenerator.nameDB_.setVariableMap(workspace.getVariableMap());\n};\n\n/*endiveGenerator.scrub_ = function (block, code, thisOnly) {\n  const nextBlock = block.nextConnection && block.nextConnection.targetBlock();\n  if (nextBlock && !thisOnly) {\n    return code + endiveGenerator.blockToCode(nextBlock);\n  }\n  return code;\n};*/\n\nendiveGenerator[\"theorem\"] = function (block, generator) {\n  const statement = generator.valueToCode(block, \"STATEMENT\", 0);\n\n  var proof = \"\";\n  var proofBlock = block.getInput(\"PROOF\").connection.targetBlock();\n\n  while (proofBlock) {\n    var tactic =\n      generator.blockToCode(proofBlock).slice(0, -1).replace(/^/gm, \"  \") +\n      \"\\n\";\n    proof += tactic;\n    proofBlock = proofBlock.getNextBlock();\n  }\n\n  const code = `Lemma theorem: ${statement}.\\n${proof}Qed.`;\n  return code;\n};\n\nendiveGenerator[\"lemma\"] = function (block, generator) {\n  const name = block.getFieldValue(\"NAME\");\n  const statement = generator.valueToCode(block, \"STATEMENT\", 0);\n\n  var proof = \"\";\n  var proofBlock = block.getInput(\"PROOF\").connection.targetBlock();\n\n  while (proofBlock) {\n    var tactic =\n      generator.blockToCode(proofBlock).slice(0, -1).replace(/^/gm, \"  \") +\n      \"\\n\";\n    proof += tactic;\n    proofBlock = proofBlock.getNextBlock();\n  }\n\n  const code = `Lemma ${name}: ${statement}.\\n${proof}Qed.`;\n  return code;\n};\n\nendiveGenerator[\"proposition_forall\"] = function (block, generator) {\n  const variable = endiveGenerator.getVariableName(\n    block.getFieldValue(\"VARIABLE\"),\n  );\n  const proposition = generator.valueToCode(block, \"PROPOSITION\", 0);\n  return [`forall ${variable}:Prop, ${proposition}`, 0];\n};\n\nendiveGenerator[\"proposition_exists\"] = function (block, generator) {\n  const variable = endiveGenerator.getVariableName(\n    block.getFieldValue(\"VARIABLE\"),\n  );\n  const proposition = generator.valueToCode(block, \"PROPOSITION\", 0);\n  return [`exists ${variable}:Prop, ${proposition}`, 0];\n};\n\nendiveGenerator[\"proposition_or\"] = function (block, generator) {\n  const left = generator.valueToCode(block, \"LEFT\", 2);\n  const right = generator.valueToCode(block, \"RIGHT\", 2);\n  return [`${left} \\\\/ ${right}`, 2];\n};\n\nendiveGenerator[\"proposition_and\"] = function (block, generator) {\n  const left = generator.valueToCode(block, \"LEFT\", 1);\n  const right = generator.valueToCode(block, \"RIGHT\", 1);\n  return [`${left} /\\\\ ${right}`, 1];\n};\n\nendiveGenerator[\"proposition_implies\"] = function (block, generator) {\n  const antecedent = generator.valueToCode(block, \"ANTECEDENT\", 90);\n  const consequent = generator.valueToCode(block, \"CONSEQUENT\", 99);\n  return [`${antecedent} -> ${consequent}`, 99];\n};\n\nendiveGenerator[\"proposition_reference\"] = function (block, generator) {\n  const name = endiveGenerator.getVariableName(block.getFieldValue(\"NAME\"));\n  return [name, 0];\n};\n\nendiveGenerator[\"tactic_let\"] = function (block, generator) {\n  const variable = endiveGenerator.getVariableName(\n    block.getFieldValue(\"VARIABLE\"),\n  );\n  return `let ${variable}: Prop.\\n`;\n};\n\nendiveGenerator[\"tactic_suppose\"] = function (block, generator) {\n  const hypothesis = endiveGenerator.valueToCode(block, \"HYPOTHESIS\", 0);\n  return `suppose ${hypothesis}.\\n`;\n};\n\nendiveGenerator[\"tactic_then\"] = function (block, generator) {\n  const conclusion = endiveGenerator.valueToCode(block, \"CONCLUSION\", 0);\n  return `then ${conclusion}.\\n`;\n};\n","exports.interopDefault = function (a) {\n  return a && a.__esModule ? a : {default: a};\n};\n\nexports.defineInteropFlag = function (a) {\n  Object.defineProperty(a, '__esModule', {value: true});\n};\n\nexports.exportAll = function (source, dest) {\n  Object.keys(source).forEach(function (key) {\n    if (\n      key === 'default' ||\n      key === '__esModule' ||\n      Object.prototype.hasOwnProperty.call(dest, key)\n    ) {\n      return;\n    }\n\n    Object.defineProperty(dest, key, {\n      enumerable: true,\n      get: function () {\n        return source[key];\n      },\n    });\n  });\n\n  return dest;\n};\n\nexports.export = function (dest, destName, get) {\n  Object.defineProperty(dest, destName, {\n    enumerable: true,\n    get: get,\n  });\n};\n","import intialize, * as endive from \"endive-wasm\";\nimport * as _ from \"lodash\";\n\nimport url from \"url:endive-wasm/endive_wasm_bg.wasm\";\n\nimport { prop } from \"./definitions\";\n\nfunction makeFreshVariable(environment) {\n  let len = environment.length;\n  return `h${len}`;\n}\n\nfunction isBound(environment, name) {\n  return environment.some((pair) => pair[0] == name);\n}\n\nfunction deBruijnIndex(environment, name) {\n  const index = environment.findIndex((pair) => _.isEqual(pair[0], name));\n  if (index == -1)\n    throw new Error(\"Asked for index of an unbound variable name\");\n  return environment.length - index - 1;\n}\n\nfunction offsetIndices(lterm) {\n  if (lterm.type == \"variable\") {\n    return {\n      type: \"variable\",\n      index: lterm.index + 1,\n    };\n  }\n\n  if (lterm.type == \"abstraction\" || lterm.type == \"pi\") {\n    return {\n      type: lterm.type,\n      variable: offsetIndices(lterm.variable),\n      body: offsetIndices(lterm.body),\n    };\n  }\n\n  return lterm;\n}\n\nfunction convertStatement(block, environment) {\n  /** Converts a statement block into the corresponding lambda-term */\n  if (block == null) {\n    throw new Error(\"Incomplete statement\");\n  }\n\n  if (block.type === \"proposition_forall\") {\n    let name = block.getField(\"VARIABLE\").getText();\n\n    let propositionBlock = block\n      .getInput(\"PROPOSITION\")\n      .connection.targetBlock();\n    if (propositionBlock == null) {\n      block.setWarningText(\"Ce quantificateur n'est pas complet.\");\n      throw new Error(\"Incomplete statement\");\n    }\n\n    let proposition = convertStatement(\n      propositionBlock,\n      environment\n        .concat([[name, prop]])\n        .map((x) => [x[0], offsetIndices(x[1])]),\n    );\n\n    return {\n      type: \"pi\",\n      variable: prop,\n      body: proposition,\n    };\n  }\n\n  if (block.type === \"proposition_implies\") {\n    let antecedentBlock = block.getInput(\"ANTECEDENT\").connection.targetBlock();\n    let consequentBlock = block.getInput(\"CONSEQUENT\").connection.targetBlock();\n    if (antecedentBlock == null || consequentBlock == null) {\n      block.setWarningText(\"Cette implication n'est pas complète.\");\n      throw new Error(\"Incomplete statement\");\n    }\n\n    let antecedent = convertStatement(antecedentBlock, environment);\n    let consequent = convertStatement(\n      consequentBlock,\n      environment\n        .concat([[makeFreshVariable(environment), antecedent]])\n        .map((x) => [x[0], offsetIndices(x[1])]),\n    );\n\n    return {\n      type: \"pi\",\n      variable: antecedent,\n      body: consequent,\n    };\n  }\n\n  if (block.type === \"proposition_reference\") {\n    let name = block.getField(\"NAME\").getText();\n\n    if (!isBound(environment, name)) {\n      block.setWarningText(\"Cet élément n'est pas défini.\");\n      throw new Error(`Unbound variable ${name}`);\n    }\n\n    return {\n      type: \"variable\",\n      index: deBruijnIndex(environment, name),\n    };\n  }\n\n  throw new Exception(`Unsupported block type ${block.type}`);\n}\n\nfunction convertTactics(block, environment, hypotheses) {\n  /** Converts a proof into the corresponding lambda-term\n   * Environment: pairs of variable names and their types (used to compute de Bruijn indexes and to verify that nothing that is used is unbound)\n   * Hypotheses: lambda-terms\n   */\n  if (block == null) {\n    return hypotheses[hypotheses.length - 1][0];\n  }\n\n  if (block.type === \"tactic_let\") {\n    let name = block.getField(\"VARIABLE\").getText();\n    let restOfProof = convertTactics(\n      block.nextConnection.targetBlock(),\n      environment\n        .concat([[name, prop]])\n        .map((x) => [x[0], offsetIndices(x[1])]),\n      hypotheses.map((x) => [offsetIndices(x[0]), offsetIndices(x[1])]),\n    );\n    return {\n      type: \"abstraction\",\n      variable: prop,\n      body: restOfProof,\n    };\n  }\n\n  if (block.type === \"tactic_suppose\") {\n    let hypothesisBlock = block.getInput(\"HYPOTHESIS\").connection.targetBlock();\n    if (hypothesisBlock == null) {\n      block.setWarningText(\n        \"Vous n'avez pas précisé d'énoncé pour cette hypothèse.\",\n      );\n      throw new Error(\"Missing hypothesis\");\n    }\n\n    let hypothesis = convertStatement(hypothesisBlock, environment, hypotheses);\n    let offsetHypothesis = offsetIndices(hypothesis);\n    let hypothesisName = makeFreshVariable(environment);\n\n    let restOfProof = convertTactics(\n      block.nextConnection.targetBlock(),\n      environment\n        .map((x) => [x[0], offsetIndices(x[1])])\n        .concat([[hypothesisName, offsetHypothesis]]),\n      hypotheses\n        .map((x) => [offsetIndices(x[0]), offsetIndices(x[1])])\n        .concat([\n          [\n            {\n              type: \"variable\",\n              index: 0,\n            },\n            offsetHypothesis,\n          ],\n        ]),\n    );\n    return {\n      type: \"abstraction\",\n      variable: hypothesis,\n      body: restOfProof,\n    };\n  }\n\n  if (block.type === \"tactic_then\") {\n    let conclusionBlock = block.getInput(\"CONCLUSION\").connection.targetBlock();\n    if (conclusionBlock == null) {\n      block.setWarningText(\n        \"Vous n'avez pas précisé d'énoncé pour cette conclusion.\",\n      );\n      throw new Error(\"Missing conclusion\");\n    }\n\n    let conclusion = convertStatement(conclusionBlock, environment, hypotheses);\n\n    // Look for conclusion in hypotheses\n    let lterm = null;\n    for (let i = 0; i < hypotheses.length; ++i) {\n      //if (endive.betaEquivalent(hypotheses[i][1], conclusion)) {\n      if (_.isEqual(hypotheses[i][1], conclusion)) {\n        lterm = hypotheses[i][0];\n        break;\n      }\n    }\n\n    // Otherwise, look for a pair of hypotheses (A->B, A) where B is our conclusion\n    for (let i = 0; i < hypotheses.length; ++i) {\n      if (lterm !== null) break;\n      for (let j = 0; j < hypotheses.length; ++j) {\n        if (\n          _.isEqual(hypotheses[i][1], {\n            type: \"pi\",\n            variable: hypotheses[j][1],\n            body: offsetIndices(conclusion),\n          })\n        ) {\n          lterm = {\n            type: \"application\",\n            f: hypotheses[i][0],\n            argument: hypotheses[j][0],\n          };\n          break;\n        }\n      }\n    }\n\n    if (lterm !== null) {\n      return convertTactics(\n        block.nextConnection.targetBlock(),\n        environment,\n        hypotheses.concat([[lterm, conclusion]]),\n      );\n    }\n    block.setWarningText(\n      \"Vos hypothèses ne permettent pas d'arriver à cette conclusion.\",\n    );\n    throw new Error(\"Illicit conclusion in then\");\n  }\n}\n\nfunction addGlow(block, name, color) {\n  let blockSvg = block.getSvgRoot();\n  blockSvg.style.filter = `drop-shadow(0px 0px 5px ${color})`;\n}\n\nfunction verifyTheorem(block) {\n  /* Reads a theorem block and verifies that it is valid and that the proof is correct */\n\n  // Read statement\n  let statementBlock = block.getInput(\"STATEMENT\").connection.targetBlock();\n  if (statementBlock == null) {\n    block.setWarningText(\"Vous n'avez pas précisé d'énoncé pour ce théorème.\");\n    return false;\n  }\n  let statement;\n  try {\n    statement = convertStatement(statementBlock, [], []);\n  } catch (e) {\n    return false;\n  }\n\n  let statementType = endive.inferType(statement);\n  if (statementType.type !== \"universe\") {\n    console.error(\"Ill-typed statement\");\n    console.log(statementType);\n    return false;\n  }\n\n  // Read proof\n  let proofBlock = block.getInput(\"PROOF\").connection.targetBlock();\n  if (proofBlock == null) {\n    block.setWarningText(\"Vous n'avez pas prouvé ce théorème.\");\n    return false;\n  }\n  console.log(\"Converting proof\");\n  let proof;\n  try {\n    proof = convertTactics(proofBlock, [], []);\n  } catch (e) {\n    return false;\n  }\n\n  // Verify beta-equivalence\n  console.log(\"Testing for beta-equivalence\");\n  let isBetaEquivalent = endive.betaEquivalent(\n    endive.inferType(proof),\n    statement,\n  );\n\n  if (!isBetaEquivalent) {\n    block.setWarningText(\n      \"Cette preuve est valide, mais ne prouve pas ce que vous avez énoncé :(\",\n    );\n    return false;\n  } else {\n    block.setTooltip(\"Preuve valide :D\");\n    return true;\n  }\n}\n\nexport async function verifyTheorems(workspace) {\n  await intialize(url);\n  let blocks = workspace.getAllBlocks();\n\n  // Reset warnings for all blocks\n  for (let i = 0; i < blocks.length; ++i) {\n    blocks[i].setWarningText(\"\");\n  }\n\n  // Verify theorems\n  for (let i = 0; i < blocks.length; ++i) {\n    let block = blocks[i];\n    if (block.type !== \"theorem\") continue;\n    block.getSvgRoot().style.filter = \"\";\n    if (verifyTheorem(block)) {\n      addGlow(block, \"green\", \"#00ff00\");\n    } else {\n      addGlow(block, \"red\", \"#ff0000\");\n    }\n  }\n}\n","let wasm;\n\nconst heap = new Array(128).fill(undefined);\n\nheap.push(undefined, null, true, false);\n\nfunction getObject(idx) {\n  return heap[idx];\n}\n\nlet heap_next = heap.length;\n\nfunction dropObject(idx) {\n  if (idx < 132) return;\n  heap[idx] = heap_next;\n  heap_next = idx;\n}\n\nfunction takeObject(idx) {\n  const ret = getObject(idx);\n  dropObject(idx);\n  return ret;\n}\n\nfunction isLikeNone(x) {\n  return x === undefined || x === null;\n}\n\nlet cachedFloat64Memory0 = null;\n\nfunction getFloat64Memory0() {\n  if (cachedFloat64Memory0 === null || cachedFloat64Memory0.byteLength === 0) {\n    cachedFloat64Memory0 = new Float64Array(wasm.memory.buffer);\n  }\n  return cachedFloat64Memory0;\n}\n\nlet cachedInt32Memory0 = null;\n\nfunction getInt32Memory0() {\n  if (cachedInt32Memory0 === null || cachedInt32Memory0.byteLength === 0) {\n    cachedInt32Memory0 = new Int32Array(wasm.memory.buffer);\n  }\n  return cachedInt32Memory0;\n}\n\nconst cachedTextDecoder =\n  typeof TextDecoder !== \"undefined\"\n    ? new TextDecoder(\"utf-8\", { ignoreBOM: true, fatal: true })\n    : {\n        decode: () => {\n          throw Error(\"TextDecoder not available\");\n        },\n      };\n\nif (typeof TextDecoder !== \"undefined\") {\n  cachedTextDecoder.decode();\n}\n\nlet cachedUint8Memory0 = null;\n\nfunction getUint8Memory0() {\n  if (cachedUint8Memory0 === null || cachedUint8Memory0.byteLength === 0) {\n    cachedUint8Memory0 = new Uint8Array(wasm.memory.buffer);\n  }\n  return cachedUint8Memory0;\n}\n\nfunction getStringFromWasm0(ptr, len) {\n  ptr = ptr >>> 0;\n  return cachedTextDecoder.decode(getUint8Memory0().subarray(ptr, ptr + len));\n}\n\nfunction addHeapObject(obj) {\n  if (heap_next === heap.length) heap.push(heap.length + 1);\n  const idx = heap_next;\n  heap_next = heap[idx];\n\n  heap[idx] = obj;\n  return idx;\n}\n\nlet WASM_VECTOR_LEN = 0;\n\nconst cachedTextEncoder =\n  typeof TextEncoder !== \"undefined\"\n    ? new TextEncoder(\"utf-8\")\n    : {\n        encode: () => {\n          throw Error(\"TextEncoder not available\");\n        },\n      };\n\nconst encodeString =\n  typeof cachedTextEncoder.encodeInto === \"function\"\n    ? function (arg, view) {\n        return cachedTextEncoder.encodeInto(arg, view);\n      }\n    : function (arg, view) {\n        const buf = cachedTextEncoder.encode(arg);\n        view.set(buf);\n        return {\n          read: arg.length,\n          written: buf.length,\n        };\n      };\n\nfunction passStringToWasm0(arg, malloc, realloc) {\n  if (realloc === undefined) {\n    const buf = cachedTextEncoder.encode(arg);\n    const ptr = malloc(buf.length, 1) >>> 0;\n    getUint8Memory0()\n      .subarray(ptr, ptr + buf.length)\n      .set(buf);\n    WASM_VECTOR_LEN = buf.length;\n    return ptr;\n  }\n\n  let len = arg.length;\n  let ptr = malloc(len, 1) >>> 0;\n\n  const mem = getUint8Memory0();\n\n  let offset = 0;\n\n  for (; offset < len; offset++) {\n    const code = arg.charCodeAt(offset);\n    if (code > 0x7f) break;\n    mem[ptr + offset] = code;\n  }\n\n  if (offset !== len) {\n    if (offset !== 0) {\n      arg = arg.slice(offset);\n    }\n    ptr = realloc(ptr, len, (len = offset + arg.length * 3), 1) >>> 0;\n    const view = getUint8Memory0().subarray(ptr + offset, ptr + len);\n    const ret = encodeString(arg, view);\n\n    offset += ret.written;\n    ptr = realloc(ptr, len, offset, 1) >>> 0;\n  }\n\n  WASM_VECTOR_LEN = offset;\n  return ptr;\n}\n\nfunction debugString(val) {\n  // primitive types\n  const type = typeof val;\n  if (type == \"number\" || type == \"boolean\" || val == null) {\n    return `${val}`;\n  }\n  if (type == \"string\") {\n    return `\"${val}\"`;\n  }\n  if (type == \"symbol\") {\n    const description = val.description;\n    if (description == null) {\n      return \"Symbol\";\n    } else {\n      return `Symbol(${description})`;\n    }\n  }\n  if (type == \"function\") {\n    const name = val.name;\n    if (typeof name == \"string\" && name.length > 0) {\n      return `Function(${name})`;\n    } else {\n      return \"Function\";\n    }\n  }\n  // objects\n  if (Array.isArray(val)) {\n    const length = val.length;\n    let debug = \"[\";\n    if (length > 0) {\n      debug += debugString(val[0]);\n    }\n    for (let i = 1; i < length; i++) {\n      debug += \", \" + debugString(val[i]);\n    }\n    debug += \"]\";\n    return debug;\n  }\n  // Test for built-in\n  const builtInMatches = /\\[object ([^\\]]+)\\]/.exec(toString.call(val));\n  let className;\n  if (builtInMatches.length > 1) {\n    className = builtInMatches[1];\n  } else {\n    // Failed to match the standard '[object ClassName]'\n    return toString.call(val);\n  }\n  if (className == \"Object\") {\n    // we're a user defined class or Object\n    // JSON.stringify avoids problems with cycles, and is generally much\n    // easier than looping through ownProperties of `val`.\n    try {\n      return \"Object(\" + JSON.stringify(val) + \")\";\n    } catch (_) {\n      return \"Object\";\n    }\n  }\n  // errors\n  if (val instanceof Error) {\n    return `${val.name}: ${val.message}\\n${val.stack}`;\n  }\n  // TODO we could test for more things here, like `Set`s and `Map`s.\n  return className;\n}\n\nlet stack_pointer = 128;\n\nfunction addBorrowedObject(obj) {\n  if (stack_pointer == 1) throw new Error(\"out of js stack\");\n  heap[--stack_pointer] = obj;\n  return stack_pointer;\n}\n/**\n * @param {any} n\n * @returns {any}\n */\nexport function normalize(n) {\n  try {\n    const retptr = wasm.__wbindgen_add_to_stack_pointer(-16);\n    wasm.normalize(retptr, addBorrowedObject(n));\n    var r0 = getInt32Memory0()[retptr / 4 + 0];\n    var r1 = getInt32Memory0()[retptr / 4 + 1];\n    var r2 = getInt32Memory0()[retptr / 4 + 2];\n    if (r2) {\n      throw takeObject(r1);\n    }\n    return takeObject(r0);\n  } finally {\n    wasm.__wbindgen_add_to_stack_pointer(16);\n    heap[stack_pointer++] = undefined;\n  }\n}\n\n/**\n * @param {any} n\n * @returns {any}\n */\nexport function inferType(n) {\n  try {\n    const retptr = wasm.__wbindgen_add_to_stack_pointer(-16);\n    wasm.inferType(retptr, addBorrowedObject(n));\n    var r0 = getInt32Memory0()[retptr / 4 + 0];\n    var r1 = getInt32Memory0()[retptr / 4 + 1];\n    var r2 = getInt32Memory0()[retptr / 4 + 2];\n    if (r2) {\n      throw takeObject(r1);\n    }\n    return takeObject(r0);\n  } finally {\n    wasm.__wbindgen_add_to_stack_pointer(16);\n    heap[stack_pointer++] = undefined;\n  }\n}\n\n/**\n * @param {any} n\n * @param {any} m\n * @returns {any}\n */\nexport function betaEquivalent(n, m) {\n  try {\n    const retptr = wasm.__wbindgen_add_to_stack_pointer(-16);\n    wasm.betaEquivalent(retptr, addBorrowedObject(n), addBorrowedObject(m));\n    var r0 = getInt32Memory0()[retptr / 4 + 0];\n    var r1 = getInt32Memory0()[retptr / 4 + 1];\n    var r2 = getInt32Memory0()[retptr / 4 + 2];\n    if (r2) {\n      throw takeObject(r1);\n    }\n    return takeObject(r0);\n  } finally {\n    wasm.__wbindgen_add_to_stack_pointer(16);\n    heap[stack_pointer++] = undefined;\n    heap[stack_pointer++] = undefined;\n  }\n}\n\nfunction handleError(f, args) {\n  try {\n    return f.apply(this, args);\n  } catch (e) {\n    wasm.__wbindgen_exn_store(addHeapObject(e));\n  }\n}\n\nasync function __wbg_load(module, imports) {\n  if (typeof Response === \"function\" && module instanceof Response) {\n    if (typeof WebAssembly.instantiateStreaming === \"function\") {\n      try {\n        return await WebAssembly.instantiateStreaming(module, imports);\n      } catch (e) {\n        if (module.headers.get(\"Content-Type\") != \"application/wasm\") {\n          console.warn(\n            \"`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\\n\",\n            e,\n          );\n        } else {\n          throw e;\n        }\n      }\n    }\n\n    const bytes = await module.arrayBuffer();\n    return await WebAssembly.instantiate(bytes, imports);\n  } else {\n    const instance = await WebAssembly.instantiate(module, imports);\n\n    if (instance instanceof WebAssembly.Instance) {\n      return { instance, module };\n    } else {\n      return instance;\n    }\n  }\n}\n\nfunction __wbg_get_imports() {\n  const imports = {};\n  imports.wbg = {};\n  imports.wbg.__wbindgen_object_drop_ref = function (arg0) {\n    takeObject(arg0);\n  };\n  imports.wbg.__wbindgen_number_get = function (arg0, arg1) {\n    const obj = getObject(arg1);\n    const ret = typeof obj === \"number\" ? obj : undefined;\n    getFloat64Memory0()[arg0 / 8 + 1] = isLikeNone(ret) ? 0 : ret;\n    getInt32Memory0()[arg0 / 4 + 0] = !isLikeNone(ret);\n  };\n  imports.wbg.__wbindgen_string_new = function (arg0, arg1) {\n    const ret = getStringFromWasm0(arg0, arg1);\n    return addHeapObject(ret);\n  };\n  imports.wbg.__wbindgen_string_get = function (arg0, arg1) {\n    const obj = getObject(arg1);\n    const ret = typeof obj === \"string\" ? obj : undefined;\n    var ptr1 = isLikeNone(ret)\n      ? 0\n      : passStringToWasm0(ret, wasm.__wbindgen_malloc, wasm.__wbindgen_realloc);\n    var len1 = WASM_VECTOR_LEN;\n    getInt32Memory0()[arg0 / 4 + 1] = len1;\n    getInt32Memory0()[arg0 / 4 + 0] = ptr1;\n  };\n  imports.wbg.__wbindgen_number_new = function (arg0) {\n    const ret = arg0;\n    return addHeapObject(ret);\n  };\n  imports.wbg.__wbg_get_bd8e338fbd5f5cc8 = function (arg0, arg1) {\n    const ret = getObject(arg0)[arg1 >>> 0];\n    return addHeapObject(ret);\n  };\n  imports.wbg.__wbg_length_cd7af8117672b8b8 = function (arg0) {\n    const ret = getObject(arg0).length;\n    return ret;\n  };\n  imports.wbg.__wbg_new_16b304a2cfa7ff4a = function () {\n    const ret = new Array();\n    return addHeapObject(ret);\n  };\n  imports.wbg.__wbg_get_e3c254076557e348 = function () {\n    return handleError(function (arg0, arg1) {\n      const ret = Reflect.get(getObject(arg0), getObject(arg1));\n      return addHeapObject(ret);\n    }, arguments);\n  };\n  imports.wbg.__wbg_new_72fb9a18b5ae2624 = function () {\n    const ret = new Object();\n    return addHeapObject(ret);\n  };\n  imports.wbg.__wbg_isArray_2ab64d95e09ea0ae = function (arg0) {\n    const ret = Array.isArray(getObject(arg0));\n    return ret;\n  };\n  imports.wbg.__wbg_push_a5b05aedc7234f9f = function (arg0, arg1) {\n    const ret = getObject(arg0).push(getObject(arg1));\n    return ret;\n  };\n  imports.wbg.__wbg_new_28c511d9baebfa89 = function (arg0, arg1) {\n    const ret = new Error(getStringFromWasm0(arg0, arg1));\n    return addHeapObject(ret);\n  };\n  imports.wbg.__wbg_instanceof_Object_71ca3c0a59266746 = function (arg0) {\n    let result;\n    try {\n      result = getObject(arg0) instanceof Object;\n    } catch (_) {\n      result = false;\n    }\n    const ret = result;\n    return ret;\n  };\n  imports.wbg.__wbg_entries_95cc2c823b285a09 = function (arg0) {\n    const ret = Object.entries(getObject(arg0));\n    return addHeapObject(ret);\n  };\n  imports.wbg.__wbg_new_5dd86ebc917d9f52 = function (arg0, arg1) {\n    const ret = new TypeError(getStringFromWasm0(arg0, arg1));\n    return addHeapObject(ret);\n  };\n  imports.wbg.__wbg_set_1f9b04f170055d33 = function () {\n    return handleError(function (arg0, arg1, arg2) {\n      const ret = Reflect.set(\n        getObject(arg0),\n        getObject(arg1),\n        getObject(arg2),\n      );\n      return ret;\n    }, arguments);\n  };\n  imports.wbg.__wbindgen_debug_string = function (arg0, arg1) {\n    const ret = debugString(getObject(arg1));\n    const ptr1 = passStringToWasm0(\n      ret,\n      wasm.__wbindgen_malloc,\n      wasm.__wbindgen_realloc,\n    );\n    const len1 = WASM_VECTOR_LEN;\n    getInt32Memory0()[arg0 / 4 + 1] = len1;\n    getInt32Memory0()[arg0 / 4 + 0] = ptr1;\n  };\n  imports.wbg.__wbindgen_throw = function (arg0, arg1) {\n    throw new Error(getStringFromWasm0(arg0, arg1));\n  };\n\n  return imports;\n}\n\nfunction __wbg_init_memory(imports, maybe_memory) {}\n\nfunction __wbg_finalize_init(instance, module) {\n  wasm = instance.exports;\n  __wbg_init.__wbindgen_wasm_module = module;\n  cachedFloat64Memory0 = null;\n  cachedInt32Memory0 = null;\n  cachedUint8Memory0 = null;\n\n  return wasm;\n}\n\nfunction initSync(module) {\n  if (wasm !== undefined) return wasm;\n\n  const imports = __wbg_get_imports();\n\n  __wbg_init_memory(imports);\n\n  if (!(module instanceof WebAssembly.Module)) {\n    module = new WebAssembly.Module(module);\n  }\n\n  const instance = new WebAssembly.Instance(module, imports);\n\n  return __wbg_finalize_init(instance, module);\n}\n\nasync function __wbg_init(input) {\n  if (wasm !== undefined) return wasm;\n\n  if (typeof input === \"undefined\") {\n    input = new URL(\"endive_wasm_bg.wasm\", import.meta.url);\n  }\n  const imports = __wbg_get_imports();\n\n  if (\n    typeof input === \"string\" ||\n    (typeof Request === \"function\" && input instanceof Request) ||\n    (typeof URL === \"function\" && input instanceof URL)\n  ) {\n    input = fetch(input);\n  }\n\n  __wbg_init_memory(imports);\n\n  const { instance, module } = await __wbg_load(await input, imports);\n\n  return __wbg_finalize_init(instance, module);\n}\n\nexport { initSync };\nexport default __wbg_init;\n","module.exports = require('./helpers/bundle-url').getBundleURL('gIy7C') + \"endive_wasm_bg.221b47df.wasm\" + \"?\" + Date.now();","\"use strict\";\n\nvar bundleURL = {};\nfunction getBundleURLCached(id) {\n  var value = bundleURL[id];\n  if (!value) {\n    value = getBundleURL();\n    bundleURL[id] = value;\n  }\n  return value;\n}\nfunction getBundleURL() {\n  try {\n    throw new Error();\n  } catch (err) {\n    var matches = ('' + err.stack).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\\/\\/[^)\\n]+/g);\n    if (matches) {\n      // The first two stack frames will be this function and getBundleURLCached.\n      // Use the 3rd one, which will be a runtime in the original bundle.\n      return getBaseURL(matches[2]);\n    }\n  }\n  return '/';\n}\nfunction getBaseURL(url) {\n  return ('' + url).replace(/^((?:https?|file|ftp|(chrome|moz|safari-web)-extension):\\/\\/.+)\\/[^/]+$/, '$1') + '/';\n}\n\n// TODO: Replace uses with `new URL(url).origin` when ie11 is no longer supported.\nfunction getOrigin(url) {\n  var matches = ('' + url).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\\/\\/[^/]+/);\n  if (!matches) {\n    throw new Error('Origin not found');\n  }\n  return matches[0];\n}\nexports.getBundleURL = getBundleURLCached;\nexports.getBaseURL = getBaseURL;\nexports.getOrigin = getOrigin;","/**\n * @license\n * Lodash <https://lodash.com/>\n * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n;(function() {\n\n  /** Used as a safe reference for `undefined` in pre-ES5 environments. */\n  var undefined;\n\n  /** Used as the semantic version number. */\n  var VERSION = '4.17.21';\n\n  /** Used as the size to enable large array optimizations. */\n  var LARGE_ARRAY_SIZE = 200;\n\n  /** Error message constants. */\n  var CORE_ERROR_TEXT = 'Unsupported core-js use. Try https://npms.io/search?q=ponyfill.',\n      FUNC_ERROR_TEXT = 'Expected a function',\n      INVALID_TEMPL_VAR_ERROR_TEXT = 'Invalid `variable` option passed into `_.template`';\n\n  /** Used to stand-in for `undefined` hash values. */\n  var HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n  /** Used as the maximum memoize cache size. */\n  var MAX_MEMOIZE_SIZE = 500;\n\n  /** Used as the internal argument placeholder. */\n  var PLACEHOLDER = '__lodash_placeholder__';\n\n  /** Used to compose bitmasks for cloning. */\n  var CLONE_DEEP_FLAG = 1,\n      CLONE_FLAT_FLAG = 2,\n      CLONE_SYMBOLS_FLAG = 4;\n\n  /** Used to compose bitmasks for value comparisons. */\n  var COMPARE_PARTIAL_FLAG = 1,\n      COMPARE_UNORDERED_FLAG = 2;\n\n  /** Used to compose bitmasks for function metadata. */\n  var WRAP_BIND_FLAG = 1,\n      WRAP_BIND_KEY_FLAG = 2,\n      WRAP_CURRY_BOUND_FLAG = 4,\n      WRAP_CURRY_FLAG = 8,\n      WRAP_CURRY_RIGHT_FLAG = 16,\n      WRAP_PARTIAL_FLAG = 32,\n      WRAP_PARTIAL_RIGHT_FLAG = 64,\n      WRAP_ARY_FLAG = 128,\n      WRAP_REARG_FLAG = 256,\n      WRAP_FLIP_FLAG = 512;\n\n  /** Used as default options for `_.truncate`. */\n  var DEFAULT_TRUNC_LENGTH = 30,\n      DEFAULT_TRUNC_OMISSION = '...';\n\n  /** Used to detect hot functions by number of calls within a span of milliseconds. */\n  var HOT_COUNT = 800,\n      HOT_SPAN = 16;\n\n  /** Used to indicate the type of lazy iteratees. */\n  var LAZY_FILTER_FLAG = 1,\n      LAZY_MAP_FLAG = 2,\n      LAZY_WHILE_FLAG = 3;\n\n  /** Used as references for various `Number` constants. */\n  var INFINITY = 1 / 0,\n      MAX_SAFE_INTEGER = 9007199254740991,\n      MAX_INTEGER = 1.7976931348623157e+308,\n      NAN = 0 / 0;\n\n  /** Used as references for the maximum length and index of an array. */\n  var MAX_ARRAY_LENGTH = 4294967295,\n      MAX_ARRAY_INDEX = MAX_ARRAY_LENGTH - 1,\n      HALF_MAX_ARRAY_LENGTH = MAX_ARRAY_LENGTH >>> 1;\n\n  /** Used to associate wrap methods with their bit flags. */\n  var wrapFlags = [\n    ['ary', WRAP_ARY_FLAG],\n    ['bind', WRAP_BIND_FLAG],\n    ['bindKey', WRAP_BIND_KEY_FLAG],\n    ['curry', WRAP_CURRY_FLAG],\n    ['curryRight', WRAP_CURRY_RIGHT_FLAG],\n    ['flip', WRAP_FLIP_FLAG],\n    ['partial', WRAP_PARTIAL_FLAG],\n    ['partialRight', WRAP_PARTIAL_RIGHT_FLAG],\n    ['rearg', WRAP_REARG_FLAG]\n  ];\n\n  /** `Object#toString` result references. */\n  var argsTag = '[object Arguments]',\n      arrayTag = '[object Array]',\n      asyncTag = '[object AsyncFunction]',\n      boolTag = '[object Boolean]',\n      dateTag = '[object Date]',\n      domExcTag = '[object DOMException]',\n      errorTag = '[object Error]',\n      funcTag = '[object Function]',\n      genTag = '[object GeneratorFunction]',\n      mapTag = '[object Map]',\n      numberTag = '[object Number]',\n      nullTag = '[object Null]',\n      objectTag = '[object Object]',\n      promiseTag = '[object Promise]',\n      proxyTag = '[object Proxy]',\n      regexpTag = '[object RegExp]',\n      setTag = '[object Set]',\n      stringTag = '[object String]',\n      symbolTag = '[object Symbol]',\n      undefinedTag = '[object Undefined]',\n      weakMapTag = '[object WeakMap]',\n      weakSetTag = '[object WeakSet]';\n\n  var arrayBufferTag = '[object ArrayBuffer]',\n      dataViewTag = '[object DataView]',\n      float32Tag = '[object Float32Array]',\n      float64Tag = '[object Float64Array]',\n      int8Tag = '[object Int8Array]',\n      int16Tag = '[object Int16Array]',\n      int32Tag = '[object Int32Array]',\n      uint8Tag = '[object Uint8Array]',\n      uint8ClampedTag = '[object Uint8ClampedArray]',\n      uint16Tag = '[object Uint16Array]',\n      uint32Tag = '[object Uint32Array]';\n\n  /** Used to match empty string literals in compiled template source. */\n  var reEmptyStringLeading = /\\b__p \\+= '';/g,\n      reEmptyStringMiddle = /\\b(__p \\+=) '' \\+/g,\n      reEmptyStringTrailing = /(__e\\(.*?\\)|\\b__t\\)) \\+\\n'';/g;\n\n  /** Used to match HTML entities and HTML characters. */\n  var reEscapedHtml = /&(?:amp|lt|gt|quot|#39);/g,\n      reUnescapedHtml = /[&<>\"']/g,\n      reHasEscapedHtml = RegExp(reEscapedHtml.source),\n      reHasUnescapedHtml = RegExp(reUnescapedHtml.source);\n\n  /** Used to match template delimiters. */\n  var reEscape = /<%-([\\s\\S]+?)%>/g,\n      reEvaluate = /<%([\\s\\S]+?)%>/g,\n      reInterpolate = /<%=([\\s\\S]+?)%>/g;\n\n  /** Used to match property names within property paths. */\n  var reIsDeepProp = /\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,\n      reIsPlainProp = /^\\w*$/,\n      rePropName = /[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g;\n\n  /**\n   * Used to match `RegExp`\n   * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n   */\n  var reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g,\n      reHasRegExpChar = RegExp(reRegExpChar.source);\n\n  /** Used to match leading whitespace. */\n  var reTrimStart = /^\\s+/;\n\n  /** Used to match a single whitespace character. */\n  var reWhitespace = /\\s/;\n\n  /** Used to match wrap detail comments. */\n  var reWrapComment = /\\{(?:\\n\\/\\* \\[wrapped with .+\\] \\*\\/)?\\n?/,\n      reWrapDetails = /\\{\\n\\/\\* \\[wrapped with (.+)\\] \\*/,\n      reSplitDetails = /,? & /;\n\n  /** Used to match words composed of alphanumeric characters. */\n  var reAsciiWord = /[^\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\x7f]+/g;\n\n  /**\n   * Used to validate the `validate` option in `_.template` variable.\n   *\n   * Forbids characters which could potentially change the meaning of the function argument definition:\n   * - \"(),\" (modification of function parameters)\n   * - \"=\" (default value)\n   * - \"[]{}\" (destructuring of function parameters)\n   * - \"/\" (beginning of a comment)\n   * - whitespace\n   */\n  var reForbiddenIdentifierChars = /[()=,{}\\[\\]\\/\\s]/;\n\n  /** Used to match backslashes in property paths. */\n  var reEscapeChar = /\\\\(\\\\)?/g;\n\n  /**\n   * Used to match\n   * [ES template delimiters](http://ecma-international.org/ecma-262/7.0/#sec-template-literal-lexical-components).\n   */\n  var reEsTemplate = /\\$\\{([^\\\\}]*(?:\\\\.[^\\\\}]*)*)\\}/g;\n\n  /** Used to match `RegExp` flags from their coerced string values. */\n  var reFlags = /\\w*$/;\n\n  /** Used to detect bad signed hexadecimal string values. */\n  var reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n  /** Used to detect binary string values. */\n  var reIsBinary = /^0b[01]+$/i;\n\n  /** Used to detect host constructors (Safari). */\n  var reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n  /** Used to detect octal string values. */\n  var reIsOctal = /^0o[0-7]+$/i;\n\n  /** Used to detect unsigned integer values. */\n  var reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n  /** Used to match Latin Unicode letters (excluding mathematical operators). */\n  var reLatin = /[\\xc0-\\xd6\\xd8-\\xf6\\xf8-\\xff\\u0100-\\u017f]/g;\n\n  /** Used to ensure capturing order of template delimiters. */\n  var reNoMatch = /($^)/;\n\n  /** Used to match unescaped characters in compiled string literals. */\n  var reUnescapedString = /['\\n\\r\\u2028\\u2029\\\\]/g;\n\n  /** Used to compose unicode character classes. */\n  var rsAstralRange = '\\\\ud800-\\\\udfff',\n      rsComboMarksRange = '\\\\u0300-\\\\u036f',\n      reComboHalfMarksRange = '\\\\ufe20-\\\\ufe2f',\n      rsComboSymbolsRange = '\\\\u20d0-\\\\u20ff',\n      rsComboRange = rsComboMarksRange + reComboHalfMarksRange + rsComboSymbolsRange,\n      rsDingbatRange = '\\\\u2700-\\\\u27bf',\n      rsLowerRange = 'a-z\\\\xdf-\\\\xf6\\\\xf8-\\\\xff',\n      rsMathOpRange = '\\\\xac\\\\xb1\\\\xd7\\\\xf7',\n      rsNonCharRange = '\\\\x00-\\\\x2f\\\\x3a-\\\\x40\\\\x5b-\\\\x60\\\\x7b-\\\\xbf',\n      rsPunctuationRange = '\\\\u2000-\\\\u206f',\n      rsSpaceRange = ' \\\\t\\\\x0b\\\\f\\\\xa0\\\\ufeff\\\\n\\\\r\\\\u2028\\\\u2029\\\\u1680\\\\u180e\\\\u2000\\\\u2001\\\\u2002\\\\u2003\\\\u2004\\\\u2005\\\\u2006\\\\u2007\\\\u2008\\\\u2009\\\\u200a\\\\u202f\\\\u205f\\\\u3000',\n      rsUpperRange = 'A-Z\\\\xc0-\\\\xd6\\\\xd8-\\\\xde',\n      rsVarRange = '\\\\ufe0e\\\\ufe0f',\n      rsBreakRange = rsMathOpRange + rsNonCharRange + rsPunctuationRange + rsSpaceRange;\n\n  /** Used to compose unicode capture groups. */\n  var rsApos = \"['\\u2019]\",\n      rsAstral = '[' + rsAstralRange + ']',\n      rsBreak = '[' + rsBreakRange + ']',\n      rsCombo = '[' + rsComboRange + ']',\n      rsDigits = '\\\\d+',\n      rsDingbat = '[' + rsDingbatRange + ']',\n      rsLower = '[' + rsLowerRange + ']',\n      rsMisc = '[^' + rsAstralRange + rsBreakRange + rsDigits + rsDingbatRange + rsLowerRange + rsUpperRange + ']',\n      rsFitz = '\\\\ud83c[\\\\udffb-\\\\udfff]',\n      rsModifier = '(?:' + rsCombo + '|' + rsFitz + ')',\n      rsNonAstral = '[^' + rsAstralRange + ']',\n      rsRegional = '(?:\\\\ud83c[\\\\udde6-\\\\uddff]){2}',\n      rsSurrPair = '[\\\\ud800-\\\\udbff][\\\\udc00-\\\\udfff]',\n      rsUpper = '[' + rsUpperRange + ']',\n      rsZWJ = '\\\\u200d';\n\n  /** Used to compose unicode regexes. */\n  var rsMiscLower = '(?:' + rsLower + '|' + rsMisc + ')',\n      rsMiscUpper = '(?:' + rsUpper + '|' + rsMisc + ')',\n      rsOptContrLower = '(?:' + rsApos + '(?:d|ll|m|re|s|t|ve))?',\n      rsOptContrUpper = '(?:' + rsApos + '(?:D|LL|M|RE|S|T|VE))?',\n      reOptMod = rsModifier + '?',\n      rsOptVar = '[' + rsVarRange + ']?',\n      rsOptJoin = '(?:' + rsZWJ + '(?:' + [rsNonAstral, rsRegional, rsSurrPair].join('|') + ')' + rsOptVar + reOptMod + ')*',\n      rsOrdLower = '\\\\d*(?:1st|2nd|3rd|(?![123])\\\\dth)(?=\\\\b|[A-Z_])',\n      rsOrdUpper = '\\\\d*(?:1ST|2ND|3RD|(?![123])\\\\dTH)(?=\\\\b|[a-z_])',\n      rsSeq = rsOptVar + reOptMod + rsOptJoin,\n      rsEmoji = '(?:' + [rsDingbat, rsRegional, rsSurrPair].join('|') + ')' + rsSeq,\n      rsSymbol = '(?:' + [rsNonAstral + rsCombo + '?', rsCombo, rsRegional, rsSurrPair, rsAstral].join('|') + ')';\n\n  /** Used to match apostrophes. */\n  var reApos = RegExp(rsApos, 'g');\n\n  /**\n   * Used to match [combining diacritical marks](https://en.wikipedia.org/wiki/Combining_Diacritical_Marks) and\n   * [combining diacritical marks for symbols](https://en.wikipedia.org/wiki/Combining_Diacritical_Marks_for_Symbols).\n   */\n  var reComboMark = RegExp(rsCombo, 'g');\n\n  /** Used to match [string symbols](https://mathiasbynens.be/notes/javascript-unicode). */\n  var reUnicode = RegExp(rsFitz + '(?=' + rsFitz + ')|' + rsSymbol + rsSeq, 'g');\n\n  /** Used to match complex or compound words. */\n  var reUnicodeWord = RegExp([\n    rsUpper + '?' + rsLower + '+' + rsOptContrLower + '(?=' + [rsBreak, rsUpper, '$'].join('|') + ')',\n    rsMiscUpper + '+' + rsOptContrUpper + '(?=' + [rsBreak, rsUpper + rsMiscLower, '$'].join('|') + ')',\n    rsUpper + '?' + rsMiscLower + '+' + rsOptContrLower,\n    rsUpper + '+' + rsOptContrUpper,\n    rsOrdUpper,\n    rsOrdLower,\n    rsDigits,\n    rsEmoji\n  ].join('|'), 'g');\n\n  /** Used to detect strings with [zero-width joiners or code points from the astral planes](http://eev.ee/blog/2015/09/12/dark-corners-of-unicode/). */\n  var reHasUnicode = RegExp('[' + rsZWJ + rsAstralRange  + rsComboRange + rsVarRange + ']');\n\n  /** Used to detect strings that need a more robust regexp to match words. */\n  var reHasUnicodeWord = /[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;\n\n  /** Used to assign default `context` object properties. */\n  var contextProps = [\n    'Array', 'Buffer', 'DataView', 'Date', 'Error', 'Float32Array', 'Float64Array',\n    'Function', 'Int8Array', 'Int16Array', 'Int32Array', 'Map', 'Math', 'Object',\n    'Promise', 'RegExp', 'Set', 'String', 'Symbol', 'TypeError', 'Uint8Array',\n    'Uint8ClampedArray', 'Uint16Array', 'Uint32Array', 'WeakMap',\n    '_', 'clearTimeout', 'isFinite', 'parseInt', 'setTimeout'\n  ];\n\n  /** Used to make template sourceURLs easier to identify. */\n  var templateCounter = -1;\n\n  /** Used to identify `toStringTag` values of typed arrays. */\n  var typedArrayTags = {};\n  typedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\n  typedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\n  typedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\n  typedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\n  typedArrayTags[uint32Tag] = true;\n  typedArrayTags[argsTag] = typedArrayTags[arrayTag] =\n  typedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\n  typedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\n  typedArrayTags[errorTag] = typedArrayTags[funcTag] =\n  typedArrayTags[mapTag] = typedArrayTags[numberTag] =\n  typedArrayTags[objectTag] = typedArrayTags[regexpTag] =\n  typedArrayTags[setTag] = typedArrayTags[stringTag] =\n  typedArrayTags[weakMapTag] = false;\n\n  /** Used to identify `toStringTag` values supported by `_.clone`. */\n  var cloneableTags = {};\n  cloneableTags[argsTag] = cloneableTags[arrayTag] =\n  cloneableTags[arrayBufferTag] = cloneableTags[dataViewTag] =\n  cloneableTags[boolTag] = cloneableTags[dateTag] =\n  cloneableTags[float32Tag] = cloneableTags[float64Tag] =\n  cloneableTags[int8Tag] = cloneableTags[int16Tag] =\n  cloneableTags[int32Tag] = cloneableTags[mapTag] =\n  cloneableTags[numberTag] = cloneableTags[objectTag] =\n  cloneableTags[regexpTag] = cloneableTags[setTag] =\n  cloneableTags[stringTag] = cloneableTags[symbolTag] =\n  cloneableTags[uint8Tag] = cloneableTags[uint8ClampedTag] =\n  cloneableTags[uint16Tag] = cloneableTags[uint32Tag] = true;\n  cloneableTags[errorTag] = cloneableTags[funcTag] =\n  cloneableTags[weakMapTag] = false;\n\n  /** Used to map Latin Unicode letters to basic Latin letters. */\n  var deburredLetters = {\n    // Latin-1 Supplement block.\n    '\\xc0': 'A',  '\\xc1': 'A', '\\xc2': 'A', '\\xc3': 'A', '\\xc4': 'A', '\\xc5': 'A',\n    '\\xe0': 'a',  '\\xe1': 'a', '\\xe2': 'a', '\\xe3': 'a', '\\xe4': 'a', '\\xe5': 'a',\n    '\\xc7': 'C',  '\\xe7': 'c',\n    '\\xd0': 'D',  '\\xf0': 'd',\n    '\\xc8': 'E',  '\\xc9': 'E', '\\xca': 'E', '\\xcb': 'E',\n    '\\xe8': 'e',  '\\xe9': 'e', '\\xea': 'e', '\\xeb': 'e',\n    '\\xcc': 'I',  '\\xcd': 'I', '\\xce': 'I', '\\xcf': 'I',\n    '\\xec': 'i',  '\\xed': 'i', '\\xee': 'i', '\\xef': 'i',\n    '\\xd1': 'N',  '\\xf1': 'n',\n    '\\xd2': 'O',  '\\xd3': 'O', '\\xd4': 'O', '\\xd5': 'O', '\\xd6': 'O', '\\xd8': 'O',\n    '\\xf2': 'o',  '\\xf3': 'o', '\\xf4': 'o', '\\xf5': 'o', '\\xf6': 'o', '\\xf8': 'o',\n    '\\xd9': 'U',  '\\xda': 'U', '\\xdb': 'U', '\\xdc': 'U',\n    '\\xf9': 'u',  '\\xfa': 'u', '\\xfb': 'u', '\\xfc': 'u',\n    '\\xdd': 'Y',  '\\xfd': 'y', '\\xff': 'y',\n    '\\xc6': 'Ae', '\\xe6': 'ae',\n    '\\xde': 'Th', '\\xfe': 'th',\n    '\\xdf': 'ss',\n    // Latin Extended-A block.\n    '\\u0100': 'A',  '\\u0102': 'A', '\\u0104': 'A',\n    '\\u0101': 'a',  '\\u0103': 'a', '\\u0105': 'a',\n    '\\u0106': 'C',  '\\u0108': 'C', '\\u010a': 'C', '\\u010c': 'C',\n    '\\u0107': 'c',  '\\u0109': 'c', '\\u010b': 'c', '\\u010d': 'c',\n    '\\u010e': 'D',  '\\u0110': 'D', '\\u010f': 'd', '\\u0111': 'd',\n    '\\u0112': 'E',  '\\u0114': 'E', '\\u0116': 'E', '\\u0118': 'E', '\\u011a': 'E',\n    '\\u0113': 'e',  '\\u0115': 'e', '\\u0117': 'e', '\\u0119': 'e', '\\u011b': 'e',\n    '\\u011c': 'G',  '\\u011e': 'G', '\\u0120': 'G', '\\u0122': 'G',\n    '\\u011d': 'g',  '\\u011f': 'g', '\\u0121': 'g', '\\u0123': 'g',\n    '\\u0124': 'H',  '\\u0126': 'H', '\\u0125': 'h', '\\u0127': 'h',\n    '\\u0128': 'I',  '\\u012a': 'I', '\\u012c': 'I', '\\u012e': 'I', '\\u0130': 'I',\n    '\\u0129': 'i',  '\\u012b': 'i', '\\u012d': 'i', '\\u012f': 'i', '\\u0131': 'i',\n    '\\u0134': 'J',  '\\u0135': 'j',\n    '\\u0136': 'K',  '\\u0137': 'k', '\\u0138': 'k',\n    '\\u0139': 'L',  '\\u013b': 'L', '\\u013d': 'L', '\\u013f': 'L', '\\u0141': 'L',\n    '\\u013a': 'l',  '\\u013c': 'l', '\\u013e': 'l', '\\u0140': 'l', '\\u0142': 'l',\n    '\\u0143': 'N',  '\\u0145': 'N', '\\u0147': 'N', '\\u014a': 'N',\n    '\\u0144': 'n',  '\\u0146': 'n', '\\u0148': 'n', '\\u014b': 'n',\n    '\\u014c': 'O',  '\\u014e': 'O', '\\u0150': 'O',\n    '\\u014d': 'o',  '\\u014f': 'o', '\\u0151': 'o',\n    '\\u0154': 'R',  '\\u0156': 'R', '\\u0158': 'R',\n    '\\u0155': 'r',  '\\u0157': 'r', '\\u0159': 'r',\n    '\\u015a': 'S',  '\\u015c': 'S', '\\u015e': 'S', '\\u0160': 'S',\n    '\\u015b': 's',  '\\u015d': 's', '\\u015f': 's', '\\u0161': 's',\n    '\\u0162': 'T',  '\\u0164': 'T', '\\u0166': 'T',\n    '\\u0163': 't',  '\\u0165': 't', '\\u0167': 't',\n    '\\u0168': 'U',  '\\u016a': 'U', '\\u016c': 'U', '\\u016e': 'U', '\\u0170': 'U', '\\u0172': 'U',\n    '\\u0169': 'u',  '\\u016b': 'u', '\\u016d': 'u', '\\u016f': 'u', '\\u0171': 'u', '\\u0173': 'u',\n    '\\u0174': 'W',  '\\u0175': 'w',\n    '\\u0176': 'Y',  '\\u0177': 'y', '\\u0178': 'Y',\n    '\\u0179': 'Z',  '\\u017b': 'Z', '\\u017d': 'Z',\n    '\\u017a': 'z',  '\\u017c': 'z', '\\u017e': 'z',\n    '\\u0132': 'IJ', '\\u0133': 'ij',\n    '\\u0152': 'Oe', '\\u0153': 'oe',\n    '\\u0149': \"'n\", '\\u017f': 's'\n  };\n\n  /** Used to map characters to HTML entities. */\n  var htmlEscapes = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": '&#39;'\n  };\n\n  /** Used to map HTML entities to characters. */\n  var htmlUnescapes = {\n    '&amp;': '&',\n    '&lt;': '<',\n    '&gt;': '>',\n    '&quot;': '\"',\n    '&#39;': \"'\"\n  };\n\n  /** Used to escape characters for inclusion in compiled string literals. */\n  var stringEscapes = {\n    '\\\\': '\\\\',\n    \"'\": \"'\",\n    '\\n': 'n',\n    '\\r': 'r',\n    '\\u2028': 'u2028',\n    '\\u2029': 'u2029'\n  };\n\n  /** Built-in method references without a dependency on `root`. */\n  var freeParseFloat = parseFloat,\n      freeParseInt = parseInt;\n\n  /** Detect free variable `global` from Node.js. */\n  var freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n  /** Detect free variable `self`. */\n  var freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n  /** Used as a reference to the global object. */\n  var root = freeGlobal || freeSelf || Function('return this')();\n\n  /** Detect free variable `exports`. */\n  var freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n  /** Detect free variable `module`. */\n  var freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n  /** Detect the popular CommonJS extension `module.exports`. */\n  var moduleExports = freeModule && freeModule.exports === freeExports;\n\n  /** Detect free variable `process` from Node.js. */\n  var freeProcess = moduleExports && freeGlobal.process;\n\n  /** Used to access faster Node.js helpers. */\n  var nodeUtil = (function() {\n    try {\n      // Use `util.types` for Node.js 10+.\n      var types = freeModule && freeModule.require && freeModule.require('util').types;\n\n      if (types) {\n        return types;\n      }\n\n      // Legacy `process.binding('util')` for Node.js < 10.\n      return freeProcess && freeProcess.binding && freeProcess.binding('util');\n    } catch (e) {}\n  }());\n\n  /* Node.js helper references. */\n  var nodeIsArrayBuffer = nodeUtil && nodeUtil.isArrayBuffer,\n      nodeIsDate = nodeUtil && nodeUtil.isDate,\n      nodeIsMap = nodeUtil && nodeUtil.isMap,\n      nodeIsRegExp = nodeUtil && nodeUtil.isRegExp,\n      nodeIsSet = nodeUtil && nodeUtil.isSet,\n      nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n  /*--------------------------------------------------------------------------*/\n\n  /**\n   * A faster alternative to `Function#apply`, this function invokes `func`\n   * with the `this` binding of `thisArg` and the arguments of `args`.\n   *\n   * @private\n   * @param {Function} func The function to invoke.\n   * @param {*} thisArg The `this` binding of `func`.\n   * @param {Array} args The arguments to invoke `func` with.\n   * @returns {*} Returns the result of `func`.\n   */\n  function apply(func, thisArg, args) {\n    switch (args.length) {\n      case 0: return func.call(thisArg);\n      case 1: return func.call(thisArg, args[0]);\n      case 2: return func.call(thisArg, args[0], args[1]);\n      case 3: return func.call(thisArg, args[0], args[1], args[2]);\n    }\n    return func.apply(thisArg, args);\n  }\n\n  /**\n   * A specialized version of `baseAggregator` for arrays.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} setter The function to set `accumulator` values.\n   * @param {Function} iteratee The iteratee to transform keys.\n   * @param {Object} accumulator The initial aggregated object.\n   * @returns {Function} Returns `accumulator`.\n   */\n  function arrayAggregator(array, setter, iteratee, accumulator) {\n    var index = -1,\n        length = array == null ? 0 : array.length;\n\n    while (++index < length) {\n      var value = array[index];\n      setter(accumulator, value, iteratee(value), array);\n    }\n    return accumulator;\n  }\n\n  /**\n   * A specialized version of `_.forEach` for arrays without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @returns {Array} Returns `array`.\n   */\n  function arrayEach(array, iteratee) {\n    var index = -1,\n        length = array == null ? 0 : array.length;\n\n    while (++index < length) {\n      if (iteratee(array[index], index, array) === false) {\n        break;\n      }\n    }\n    return array;\n  }\n\n  /**\n   * A specialized version of `_.forEachRight` for arrays without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @returns {Array} Returns `array`.\n   */\n  function arrayEachRight(array, iteratee) {\n    var length = array == null ? 0 : array.length;\n\n    while (length--) {\n      if (iteratee(array[length], length, array) === false) {\n        break;\n      }\n    }\n    return array;\n  }\n\n  /**\n   * A specialized version of `_.every` for arrays without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} predicate The function invoked per iteration.\n   * @returns {boolean} Returns `true` if all elements pass the predicate check,\n   *  else `false`.\n   */\n  function arrayEvery(array, predicate) {\n    var index = -1,\n        length = array == null ? 0 : array.length;\n\n    while (++index < length) {\n      if (!predicate(array[index], index, array)) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  /**\n   * A specialized version of `_.filter` for arrays without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} predicate The function invoked per iteration.\n   * @returns {Array} Returns the new filtered array.\n   */\n  function arrayFilter(array, predicate) {\n    var index = -1,\n        length = array == null ? 0 : array.length,\n        resIndex = 0,\n        result = [];\n\n    while (++index < length) {\n      var value = array[index];\n      if (predicate(value, index, array)) {\n        result[resIndex++] = value;\n      }\n    }\n    return result;\n  }\n\n  /**\n   * A specialized version of `_.includes` for arrays without support for\n   * specifying an index to search from.\n   *\n   * @private\n   * @param {Array} [array] The array to inspect.\n   * @param {*} target The value to search for.\n   * @returns {boolean} Returns `true` if `target` is found, else `false`.\n   */\n  function arrayIncludes(array, value) {\n    var length = array == null ? 0 : array.length;\n    return !!length && baseIndexOf(array, value, 0) > -1;\n  }\n\n  /**\n   * This function is like `arrayIncludes` except that it accepts a comparator.\n   *\n   * @private\n   * @param {Array} [array] The array to inspect.\n   * @param {*} target The value to search for.\n   * @param {Function} comparator The comparator invoked per element.\n   * @returns {boolean} Returns `true` if `target` is found, else `false`.\n   */\n  function arrayIncludesWith(array, value, comparator) {\n    var index = -1,\n        length = array == null ? 0 : array.length;\n\n    while (++index < length) {\n      if (comparator(value, array[index])) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * A specialized version of `_.map` for arrays without support for iteratee\n   * shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @returns {Array} Returns the new mapped array.\n   */\n  function arrayMap(array, iteratee) {\n    var index = -1,\n        length = array == null ? 0 : array.length,\n        result = Array(length);\n\n    while (++index < length) {\n      result[index] = iteratee(array[index], index, array);\n    }\n    return result;\n  }\n\n  /**\n   * Appends the elements of `values` to `array`.\n   *\n   * @private\n   * @param {Array} array The array to modify.\n   * @param {Array} values The values to append.\n   * @returns {Array} Returns `array`.\n   */\n  function arrayPush(array, values) {\n    var index = -1,\n        length = values.length,\n        offset = array.length;\n\n    while (++index < length) {\n      array[offset + index] = values[index];\n    }\n    return array;\n  }\n\n  /**\n   * A specialized version of `_.reduce` for arrays without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @param {*} [accumulator] The initial value.\n   * @param {boolean} [initAccum] Specify using the first element of `array` as\n   *  the initial value.\n   * @returns {*} Returns the accumulated value.\n   */\n  function arrayReduce(array, iteratee, accumulator, initAccum) {\n    var index = -1,\n        length = array == null ? 0 : array.length;\n\n    if (initAccum && length) {\n      accumulator = array[++index];\n    }\n    while (++index < length) {\n      accumulator = iteratee(accumulator, array[index], index, array);\n    }\n    return accumulator;\n  }\n\n  /**\n   * A specialized version of `_.reduceRight` for arrays without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @param {*} [accumulator] The initial value.\n   * @param {boolean} [initAccum] Specify using the last element of `array` as\n   *  the initial value.\n   * @returns {*} Returns the accumulated value.\n   */\n  function arrayReduceRight(array, iteratee, accumulator, initAccum) {\n    var length = array == null ? 0 : array.length;\n    if (initAccum && length) {\n      accumulator = array[--length];\n    }\n    while (length--) {\n      accumulator = iteratee(accumulator, array[length], length, array);\n    }\n    return accumulator;\n  }\n\n  /**\n   * A specialized version of `_.some` for arrays without support for iteratee\n   * shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} predicate The function invoked per iteration.\n   * @returns {boolean} Returns `true` if any element passes the predicate check,\n   *  else `false`.\n   */\n  function arraySome(array, predicate) {\n    var index = -1,\n        length = array == null ? 0 : array.length;\n\n    while (++index < length) {\n      if (predicate(array[index], index, array)) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Gets the size of an ASCII `string`.\n   *\n   * @private\n   * @param {string} string The string inspect.\n   * @returns {number} Returns the string size.\n   */\n  var asciiSize = baseProperty('length');\n\n  /**\n   * Converts an ASCII `string` to an array.\n   *\n   * @private\n   * @param {string} string The string to convert.\n   * @returns {Array} Returns the converted array.\n   */\n  function asciiToArray(string) {\n    return string.split('');\n  }\n\n  /**\n   * Splits an ASCII `string` into an array of its words.\n   *\n   * @private\n   * @param {string} The string to inspect.\n   * @returns {Array} Returns the words of `string`.\n   */\n  function asciiWords(string) {\n    return string.match(reAsciiWord) || [];\n  }\n\n  /**\n   * The base implementation of methods like `_.findKey` and `_.findLastKey`,\n   * without support for iteratee shorthands, which iterates over `collection`\n   * using `eachFunc`.\n   *\n   * @private\n   * @param {Array|Object} collection The collection to inspect.\n   * @param {Function} predicate The function invoked per iteration.\n   * @param {Function} eachFunc The function to iterate over `collection`.\n   * @returns {*} Returns the found element or its key, else `undefined`.\n   */\n  function baseFindKey(collection, predicate, eachFunc) {\n    var result;\n    eachFunc(collection, function(value, key, collection) {\n      if (predicate(value, key, collection)) {\n        result = key;\n        return false;\n      }\n    });\n    return result;\n  }\n\n  /**\n   * The base implementation of `_.findIndex` and `_.findLastIndex` without\n   * support for iteratee shorthands.\n   *\n   * @private\n   * @param {Array} array The array to inspect.\n   * @param {Function} predicate The function invoked per iteration.\n   * @param {number} fromIndex The index to search from.\n   * @param {boolean} [fromRight] Specify iterating from right to left.\n   * @returns {number} Returns the index of the matched value, else `-1`.\n   */\n  function baseFindIndex(array, predicate, fromIndex, fromRight) {\n    var length = array.length,\n        index = fromIndex + (fromRight ? 1 : -1);\n\n    while ((fromRight ? index-- : ++index < length)) {\n      if (predicate(array[index], index, array)) {\n        return index;\n      }\n    }\n    return -1;\n  }\n\n  /**\n   * The base implementation of `_.indexOf` without `fromIndex` bounds checks.\n   *\n   * @private\n   * @param {Array} array The array to inspect.\n   * @param {*} value The value to search for.\n   * @param {number} fromIndex The index to search from.\n   * @returns {number} Returns the index of the matched value, else `-1`.\n   */\n  function baseIndexOf(array, value, fromIndex) {\n    return value === value\n      ? strictIndexOf(array, value, fromIndex)\n      : baseFindIndex(array, baseIsNaN, fromIndex);\n  }\n\n  /**\n   * This function is like `baseIndexOf` except that it accepts a comparator.\n   *\n   * @private\n   * @param {Array} array The array to inspect.\n   * @param {*} value The value to search for.\n   * @param {number} fromIndex The index to search from.\n   * @param {Function} comparator The comparator invoked per element.\n   * @returns {number} Returns the index of the matched value, else `-1`.\n   */\n  function baseIndexOfWith(array, value, fromIndex, comparator) {\n    var index = fromIndex - 1,\n        length = array.length;\n\n    while (++index < length) {\n      if (comparator(array[index], value)) {\n        return index;\n      }\n    }\n    return -1;\n  }\n\n  /**\n   * The base implementation of `_.isNaN` without support for number objects.\n   *\n   * @private\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.\n   */\n  function baseIsNaN(value) {\n    return value !== value;\n  }\n\n  /**\n   * The base implementation of `_.mean` and `_.meanBy` without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} array The array to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @returns {number} Returns the mean.\n   */\n  function baseMean(array, iteratee) {\n    var length = array == null ? 0 : array.length;\n    return length ? (baseSum(array, iteratee) / length) : NAN;\n  }\n\n  /**\n   * The base implementation of `_.property` without support for deep paths.\n   *\n   * @private\n   * @param {string} key The key of the property to get.\n   * @returns {Function} Returns the new accessor function.\n   */\n  function baseProperty(key) {\n    return function(object) {\n      return object == null ? undefined : object[key];\n    };\n  }\n\n  /**\n   * The base implementation of `_.propertyOf` without support for deep paths.\n   *\n   * @private\n   * @param {Object} object The object to query.\n   * @returns {Function} Returns the new accessor function.\n   */\n  function basePropertyOf(object) {\n    return function(key) {\n      return object == null ? undefined : object[key];\n    };\n  }\n\n  /**\n   * The base implementation of `_.reduce` and `_.reduceRight`, without support\n   * for iteratee shorthands, which iterates over `collection` using `eachFunc`.\n   *\n   * @private\n   * @param {Array|Object} collection The collection to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @param {*} accumulator The initial value.\n   * @param {boolean} initAccum Specify using the first or last element of\n   *  `collection` as the initial value.\n   * @param {Function} eachFunc The function to iterate over `collection`.\n   * @returns {*} Returns the accumulated value.\n   */\n  function baseReduce(collection, iteratee, accumulator, initAccum, eachFunc) {\n    eachFunc(collection, function(value, index, collection) {\n      accumulator = initAccum\n        ? (initAccum = false, value)\n        : iteratee(accumulator, value, index, collection);\n    });\n    return accumulator;\n  }\n\n  /**\n   * The base implementation of `_.sortBy` which uses `comparer` to define the\n   * sort order of `array` and replaces criteria objects with their corresponding\n   * values.\n   *\n   * @private\n   * @param {Array} array The array to sort.\n   * @param {Function} comparer The function to define sort order.\n   * @returns {Array} Returns `array`.\n   */\n  function baseSortBy(array, comparer) {\n    var length = array.length;\n\n    array.sort(comparer);\n    while (length--) {\n      array[length] = array[length].value;\n    }\n    return array;\n  }\n\n  /**\n   * The base implementation of `_.sum` and `_.sumBy` without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} array The array to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @returns {number} Returns the sum.\n   */\n  function baseSum(array, iteratee) {\n    var result,\n        index = -1,\n        length = array.length;\n\n    while (++index < length) {\n      var current = iteratee(array[index]);\n      if (current !== undefined) {\n        result = result === undefined ? current : (result + current);\n      }\n    }\n    return result;\n  }\n\n  /**\n   * The base implementation of `_.times` without support for iteratee shorthands\n   * or max array length checks.\n   *\n   * @private\n   * @param {number} n The number of times to invoke `iteratee`.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @returns {Array} Returns the array of results.\n   */\n  function baseTimes(n, iteratee) {\n    var index = -1,\n        result = Array(n);\n\n    while (++index < n) {\n      result[index] = iteratee(index);\n    }\n    return result;\n  }\n\n  /**\n   * The base implementation of `_.toPairs` and `_.toPairsIn` which creates an array\n   * of key-value pairs for `object` corresponding to the property names of `props`.\n   *\n   * @private\n   * @param {Object} object The object to query.\n   * @param {Array} props The property names to get values for.\n   * @returns {Object} Returns the key-value pairs.\n   */\n  function baseToPairs(object, props) {\n    return arrayMap(props, function(key) {\n      return [key, object[key]];\n    });\n  }\n\n  /**\n   * The base implementation of `_.trim`.\n   *\n   * @private\n   * @param {string} string The string to trim.\n   * @returns {string} Returns the trimmed string.\n   */\n  function baseTrim(string) {\n    return string\n      ? string.slice(0, trimmedEndIndex(string) + 1).replace(reTrimStart, '')\n      : string;\n  }\n\n  /**\n   * The base implementation of `_.unary` without support for storing metadata.\n   *\n   * @private\n   * @param {Function} func The function to cap arguments for.\n   * @returns {Function} Returns the new capped function.\n   */\n  function baseUnary(func) {\n    return function(value) {\n      return func(value);\n    };\n  }\n\n  /**\n   * The base implementation of `_.values` and `_.valuesIn` which creates an\n   * array of `object` property values corresponding to the property names\n   * of `props`.\n   *\n   * @private\n   * @param {Object} object The object to query.\n   * @param {Array} props The property names to get values for.\n   * @returns {Object} Returns the array of property values.\n   */\n  function baseValues(object, props) {\n    return arrayMap(props, function(key) {\n      return object[key];\n    });\n  }\n\n  /**\n   * Checks if a `cache` value for `key` exists.\n   *\n   * @private\n   * @param {Object} cache The cache to query.\n   * @param {string} key The key of the entry to check.\n   * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n   */\n  function cacheHas(cache, key) {\n    return cache.has(key);\n  }\n\n  /**\n   * Used by `_.trim` and `_.trimStart` to get the index of the first string symbol\n   * that is not found in the character symbols.\n   *\n   * @private\n   * @param {Array} strSymbols The string symbols to inspect.\n   * @param {Array} chrSymbols The character symbols to find.\n   * @returns {number} Returns the index of the first unmatched string symbol.\n   */\n  function charsStartIndex(strSymbols, chrSymbols) {\n    var index = -1,\n        length = strSymbols.length;\n\n    while (++index < length && baseIndexOf(chrSymbols, strSymbols[index], 0) > -1) {}\n    return index;\n  }\n\n  /**\n   * Used by `_.trim` and `_.trimEnd` to get the index of the last string symbol\n   * that is not found in the character symbols.\n   *\n   * @private\n   * @param {Array} strSymbols The string symbols to inspect.\n   * @param {Array} chrSymbols The character symbols to find.\n   * @returns {number} Returns the index of the last unmatched string symbol.\n   */\n  function charsEndIndex(strSymbols, chrSymbols) {\n    var index = strSymbols.length;\n\n    while (index-- && baseIndexOf(chrSymbols, strSymbols[index], 0) > -1) {}\n    return index;\n  }\n\n  /**\n   * Gets the number of `placeholder` occurrences in `array`.\n   *\n   * @private\n   * @param {Array} array The array to inspect.\n   * @param {*} placeholder The placeholder to search for.\n   * @returns {number} Returns the placeholder count.\n   */\n  function countHolders(array, placeholder) {\n    var length = array.length,\n        result = 0;\n\n    while (length--) {\n      if (array[length] === placeholder) {\n        ++result;\n      }\n    }\n    return result;\n  }\n\n  /**\n   * Used by `_.deburr` to convert Latin-1 Supplement and Latin Extended-A\n   * letters to basic Latin letters.\n   *\n   * @private\n   * @param {string} letter The matched letter to deburr.\n   * @returns {string} Returns the deburred letter.\n   */\n  var deburrLetter = basePropertyOf(deburredLetters);\n\n  /**\n   * Used by `_.escape` to convert characters to HTML entities.\n   *\n   * @private\n   * @param {string} chr The matched character to escape.\n   * @returns {string} Returns the escaped character.\n   */\n  var escapeHtmlChar = basePropertyOf(htmlEscapes);\n\n  /**\n   * Used by `_.template` to escape characters for inclusion in compiled string literals.\n   *\n   * @private\n   * @param {string} chr The matched character to escape.\n   * @returns {string} Returns the escaped character.\n   */\n  function escapeStringChar(chr) {\n    return '\\\\' + stringEscapes[chr];\n  }\n\n  /**\n   * Gets the value at `key` of `object`.\n   *\n   * @private\n   * @param {Object} [object] The object to query.\n   * @param {string} key The key of the property to get.\n   * @returns {*} Returns the property value.\n   */\n  function getValue(object, key) {\n    return object == null ? undefined : object[key];\n  }\n\n  /**\n   * Checks if `string` contains Unicode symbols.\n   *\n   * @private\n   * @param {string} string The string to inspect.\n   * @returns {boolean} Returns `true` if a symbol is found, else `false`.\n   */\n  function hasUnicode(string) {\n    return reHasUnicode.test(string);\n  }\n\n  /**\n   * Checks if `string` contains a word composed of Unicode symbols.\n   *\n   * @private\n   * @param {string} string The string to inspect.\n   * @returns {boolean} Returns `true` if a word is found, else `false`.\n   */\n  function hasUnicodeWord(string) {\n    return reHasUnicodeWord.test(string);\n  }\n\n  /**\n   * Converts `iterator` to an array.\n   *\n   * @private\n   * @param {Object} iterator The iterator to convert.\n   * @returns {Array} Returns the converted array.\n   */\n  function iteratorToArray(iterator) {\n    var data,\n        result = [];\n\n    while (!(data = iterator.next()).done) {\n      result.push(data.value);\n    }\n    return result;\n  }\n\n  /**\n   * Converts `map` to its key-value pairs.\n   *\n   * @private\n   * @param {Object} map The map to convert.\n   * @returns {Array} Returns the key-value pairs.\n   */\n  function mapToArray(map) {\n    var index = -1,\n        result = Array(map.size);\n\n    map.forEach(function(value, key) {\n      result[++index] = [key, value];\n    });\n    return result;\n  }\n\n  /**\n   * Creates a unary function that invokes `func` with its argument transformed.\n   *\n   * @private\n   * @param {Function} func The function to wrap.\n   * @param {Function} transform The argument transform.\n   * @returns {Function} Returns the new function.\n   */\n  function overArg(func, transform) {\n    return function(arg) {\n      return func(transform(arg));\n    };\n  }\n\n  /**\n   * Replaces all `placeholder` elements in `array` with an internal placeholder\n   * and returns an array of their indexes.\n   *\n   * @private\n   * @param {Array} array The array to modify.\n   * @param {*} placeholder The placeholder to replace.\n   * @returns {Array} Returns the new array of placeholder indexes.\n   */\n  function replaceHolders(array, placeholder) {\n    var index = -1,\n        length = array.length,\n        resIndex = 0,\n        result = [];\n\n    while (++index < length) {\n      var value = array[index];\n      if (value === placeholder || value === PLACEHOLDER) {\n        array[index] = PLACEHOLDER;\n        result[resIndex++] = index;\n      }\n    }\n    return result;\n  }\n\n  /**\n   * Converts `set` to an array of its values.\n   *\n   * @private\n   * @param {Object} set The set to convert.\n   * @returns {Array} Returns the values.\n   */\n  function setToArray(set) {\n    var index = -1,\n        result = Array(set.size);\n\n    set.forEach(function(value) {\n      result[++index] = value;\n    });\n    return result;\n  }\n\n  /**\n   * Converts `set` to its value-value pairs.\n   *\n   * @private\n   * @param {Object} set The set to convert.\n   * @returns {Array} Returns the value-value pairs.\n   */\n  function setToPairs(set) {\n    var index = -1,\n        result = Array(set.size);\n\n    set.forEach(function(value) {\n      result[++index] = [value, value];\n    });\n    return result;\n  }\n\n  /**\n   * A specialized version of `_.indexOf` which performs strict equality\n   * comparisons of values, i.e. `===`.\n   *\n   * @private\n   * @param {Array} array The array to inspect.\n   * @param {*} value The value to search for.\n   * @param {number} fromIndex The index to search from.\n   * @returns {number} Returns the index of the matched value, else `-1`.\n   */\n  function strictIndexOf(array, value, fromIndex) {\n    var index = fromIndex - 1,\n        length = array.length;\n\n    while (++index < length) {\n      if (array[index] === value) {\n        return index;\n      }\n    }\n    return -1;\n  }\n\n  /**\n   * A specialized version of `_.lastIndexOf` which performs strict equality\n   * comparisons of values, i.e. `===`.\n   *\n   * @private\n   * @param {Array} array The array to inspect.\n   * @param {*} value The value to search for.\n   * @param {number} fromIndex The index to search from.\n   * @returns {number} Returns the index of the matched value, else `-1`.\n   */\n  function strictLastIndexOf(array, value, fromIndex) {\n    var index = fromIndex + 1;\n    while (index--) {\n      if (array[index] === value) {\n        return index;\n      }\n    }\n    return index;\n  }\n\n  /**\n   * Gets the number of symbols in `string`.\n   *\n   * @private\n   * @param {string} string The string to inspect.\n   * @returns {number} Returns the string size.\n   */\n  function stringSize(string) {\n    return hasUnicode(string)\n      ? unicodeSize(string)\n      : asciiSize(string);\n  }\n\n  /**\n   * Converts `string` to an array.\n   *\n   * @private\n   * @param {string} string The string to convert.\n   * @returns {Array} Returns the converted array.\n   */\n  function stringToArray(string) {\n    return hasUnicode(string)\n      ? unicodeToArray(string)\n      : asciiToArray(string);\n  }\n\n  /**\n   * Used by `_.trim` and `_.trimEnd` to get the index of the last non-whitespace\n   * character of `string`.\n   *\n   * @private\n   * @param {string} string The string to inspect.\n   * @returns {number} Returns the index of the last non-whitespace character.\n   */\n  function trimmedEndIndex(string) {\n    var index = string.length;\n\n    while (index-- && reWhitespace.test(string.charAt(index))) {}\n    return index;\n  }\n\n  /**\n   * Used by `_.unescape` to convert HTML entities to characters.\n   *\n   * @private\n   * @param {string} chr The matched character to unescape.\n   * @returns {string} Returns the unescaped character.\n   */\n  var unescapeHtmlChar = basePropertyOf(htmlUnescapes);\n\n  /**\n   * Gets the size of a Unicode `string`.\n   *\n   * @private\n   * @param {string} string The string inspect.\n   * @returns {number} Returns the string size.\n   */\n  function unicodeSize(string) {\n    var result = reUnicode.lastIndex = 0;\n    while (reUnicode.test(string)) {\n      ++result;\n    }\n    return result;\n  }\n\n  /**\n   * Converts a Unicode `string` to an array.\n   *\n   * @private\n   * @param {string} string The string to convert.\n   * @returns {Array} Returns the converted array.\n   */\n  function unicodeToArray(string) {\n    return string.match(reUnicode) || [];\n  }\n\n  /**\n   * Splits a Unicode `string` into an array of its words.\n   *\n   * @private\n   * @param {string} The string to inspect.\n   * @returns {Array} Returns the words of `string`.\n   */\n  function unicodeWords(string) {\n    return string.match(reUnicodeWord) || [];\n  }\n\n  /*--------------------------------------------------------------------------*/\n\n  /**\n   * Create a new pristine `lodash` function using the `context` object.\n   *\n   * @static\n   * @memberOf _\n   * @since 1.1.0\n   * @category Util\n   * @param {Object} [context=root] The context object.\n   * @returns {Function} Returns a new `lodash` function.\n   * @example\n   *\n   * _.mixin({ 'foo': _.constant('foo') });\n   *\n   * var lodash = _.runInContext();\n   * lodash.mixin({ 'bar': lodash.constant('bar') });\n   *\n   * _.isFunction(_.foo);\n   * // => true\n   * _.isFunction(_.bar);\n   * // => false\n   *\n   * lodash.isFunction(lodash.foo);\n   * // => false\n   * lodash.isFunction(lodash.bar);\n   * // => true\n   *\n   * // Create a suped-up `defer` in Node.js.\n   * var defer = _.runInContext({ 'setTimeout': setImmediate }).defer;\n   */\n  var runInContext = (function runInContext(context) {\n    context = context == null ? root : _.defaults(root.Object(), context, _.pick(root, contextProps));\n\n    /** Built-in constructor references. */\n    var Array = context.Array,\n        Date = context.Date,\n        Error = context.Error,\n        Function = context.Function,\n        Math = context.Math,\n        Object = context.Object,\n        RegExp = context.RegExp,\n        String = context.String,\n        TypeError = context.TypeError;\n\n    /** Used for built-in method references. */\n    var arrayProto = Array.prototype,\n        funcProto = Function.prototype,\n        objectProto = Object.prototype;\n\n    /** Used to detect overreaching core-js shims. */\n    var coreJsData = context['__core-js_shared__'];\n\n    /** Used to resolve the decompiled source of functions. */\n    var funcToString = funcProto.toString;\n\n    /** Used to check objects for own properties. */\n    var hasOwnProperty = objectProto.hasOwnProperty;\n\n    /** Used to generate unique IDs. */\n    var idCounter = 0;\n\n    /** Used to detect methods masquerading as native. */\n    var maskSrcKey = (function() {\n      var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n      return uid ? ('Symbol(src)_1.' + uid) : '';\n    }());\n\n    /**\n     * Used to resolve the\n     * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n     * of values.\n     */\n    var nativeObjectToString = objectProto.toString;\n\n    /** Used to infer the `Object` constructor. */\n    var objectCtorString = funcToString.call(Object);\n\n    /** Used to restore the original `_` reference in `_.noConflict`. */\n    var oldDash = root._;\n\n    /** Used to detect if a method is native. */\n    var reIsNative = RegExp('^' +\n      funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n      .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n    );\n\n    /** Built-in value references. */\n    var Buffer = moduleExports ? context.Buffer : undefined,\n        Symbol = context.Symbol,\n        Uint8Array = context.Uint8Array,\n        allocUnsafe = Buffer ? Buffer.allocUnsafe : undefined,\n        getPrototype = overArg(Object.getPrototypeOf, Object),\n        objectCreate = Object.create,\n        propertyIsEnumerable = objectProto.propertyIsEnumerable,\n        splice = arrayProto.splice,\n        spreadableSymbol = Symbol ? Symbol.isConcatSpreadable : undefined,\n        symIterator = Symbol ? Symbol.iterator : undefined,\n        symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n    var defineProperty = (function() {\n      try {\n        var func = getNative(Object, 'defineProperty');\n        func({}, '', {});\n        return func;\n      } catch (e) {}\n    }());\n\n    /** Mocked built-ins. */\n    var ctxClearTimeout = context.clearTimeout !== root.clearTimeout && context.clearTimeout,\n        ctxNow = Date && Date.now !== root.Date.now && Date.now,\n        ctxSetTimeout = context.setTimeout !== root.setTimeout && context.setTimeout;\n\n    /* Built-in method references for those with the same name as other `lodash` methods. */\n    var nativeCeil = Math.ceil,\n        nativeFloor = Math.floor,\n        nativeGetSymbols = Object.getOwnPropertySymbols,\n        nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined,\n        nativeIsFinite = context.isFinite,\n        nativeJoin = arrayProto.join,\n        nativeKeys = overArg(Object.keys, Object),\n        nativeMax = Math.max,\n        nativeMin = Math.min,\n        nativeNow = Date.now,\n        nativeParseInt = context.parseInt,\n        nativeRandom = Math.random,\n        nativeReverse = arrayProto.reverse;\n\n    /* Built-in method references that are verified to be native. */\n    var DataView = getNative(context, 'DataView'),\n        Map = getNative(context, 'Map'),\n        Promise = getNative(context, 'Promise'),\n        Set = getNative(context, 'Set'),\n        WeakMap = getNative(context, 'WeakMap'),\n        nativeCreate = getNative(Object, 'create');\n\n    /** Used to store function metadata. */\n    var metaMap = WeakMap && new WeakMap;\n\n    /** Used to lookup unminified function names. */\n    var realNames = {};\n\n    /** Used to detect maps, sets, and weakmaps. */\n    var dataViewCtorString = toSource(DataView),\n        mapCtorString = toSource(Map),\n        promiseCtorString = toSource(Promise),\n        setCtorString = toSource(Set),\n        weakMapCtorString = toSource(WeakMap);\n\n    /** Used to convert symbols to primitives and strings. */\n    var symbolProto = Symbol ? Symbol.prototype : undefined,\n        symbolValueOf = symbolProto ? symbolProto.valueOf : undefined,\n        symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates a `lodash` object which wraps `value` to enable implicit method\n     * chain sequences. Methods that operate on and return arrays, collections,\n     * and functions can be chained together. Methods that retrieve a single value\n     * or may return a primitive value will automatically end the chain sequence\n     * and return the unwrapped value. Otherwise, the value must be unwrapped\n     * with `_#value`.\n     *\n     * Explicit chain sequences, which must be unwrapped with `_#value`, may be\n     * enabled using `_.chain`.\n     *\n     * The execution of chained methods is lazy, that is, it's deferred until\n     * `_#value` is implicitly or explicitly called.\n     *\n     * Lazy evaluation allows several methods to support shortcut fusion.\n     * Shortcut fusion is an optimization to merge iteratee calls; this avoids\n     * the creation of intermediate arrays and can greatly reduce the number of\n     * iteratee executions. Sections of a chain sequence qualify for shortcut\n     * fusion if the section is applied to an array and iteratees accept only\n     * one argument. The heuristic for whether a section qualifies for shortcut\n     * fusion is subject to change.\n     *\n     * Chaining is supported in custom builds as long as the `_#value` method is\n     * directly or indirectly included in the build.\n     *\n     * In addition to lodash methods, wrappers have `Array` and `String` methods.\n     *\n     * The wrapper `Array` methods are:\n     * `concat`, `join`, `pop`, `push`, `shift`, `sort`, `splice`, and `unshift`\n     *\n     * The wrapper `String` methods are:\n     * `replace` and `split`\n     *\n     * The wrapper methods that support shortcut fusion are:\n     * `at`, `compact`, `drop`, `dropRight`, `dropWhile`, `filter`, `find`,\n     * `findLast`, `head`, `initial`, `last`, `map`, `reject`, `reverse`, `slice`,\n     * `tail`, `take`, `takeRight`, `takeRightWhile`, `takeWhile`, and `toArray`\n     *\n     * The chainable wrapper methods are:\n     * `after`, `ary`, `assign`, `assignIn`, `assignInWith`, `assignWith`, `at`,\n     * `before`, `bind`, `bindAll`, `bindKey`, `castArray`, `chain`, `chunk`,\n     * `commit`, `compact`, `concat`, `conforms`, `constant`, `countBy`, `create`,\n     * `curry`, `debounce`, `defaults`, `defaultsDeep`, `defer`, `delay`,\n     * `difference`, `differenceBy`, `differenceWith`, `drop`, `dropRight`,\n     * `dropRightWhile`, `dropWhile`, `extend`, `extendWith`, `fill`, `filter`,\n     * `flatMap`, `flatMapDeep`, `flatMapDepth`, `flatten`, `flattenDeep`,\n     * `flattenDepth`, `flip`, `flow`, `flowRight`, `fromPairs`, `functions`,\n     * `functionsIn`, `groupBy`, `initial`, `intersection`, `intersectionBy`,\n     * `intersectionWith`, `invert`, `invertBy`, `invokeMap`, `iteratee`, `keyBy`,\n     * `keys`, `keysIn`, `map`, `mapKeys`, `mapValues`, `matches`, `matchesProperty`,\n     * `memoize`, `merge`, `mergeWith`, `method`, `methodOf`, `mixin`, `negate`,\n     * `nthArg`, `omit`, `omitBy`, `once`, `orderBy`, `over`, `overArgs`,\n     * `overEvery`, `overSome`, `partial`, `partialRight`, `partition`, `pick`,\n     * `pickBy`, `plant`, `property`, `propertyOf`, `pull`, `pullAll`, `pullAllBy`,\n     * `pullAllWith`, `pullAt`, `push`, `range`, `rangeRight`, `rearg`, `reject`,\n     * `remove`, `rest`, `reverse`, `sampleSize`, `set`, `setWith`, `shuffle`,\n     * `slice`, `sort`, `sortBy`, `splice`, `spread`, `tail`, `take`, `takeRight`,\n     * `takeRightWhile`, `takeWhile`, `tap`, `throttle`, `thru`, `toArray`,\n     * `toPairs`, `toPairsIn`, `toPath`, `toPlainObject`, `transform`, `unary`,\n     * `union`, `unionBy`, `unionWith`, `uniq`, `uniqBy`, `uniqWith`, `unset`,\n     * `unshift`, `unzip`, `unzipWith`, `update`, `updateWith`, `values`,\n     * `valuesIn`, `without`, `wrap`, `xor`, `xorBy`, `xorWith`, `zip`,\n     * `zipObject`, `zipObjectDeep`, and `zipWith`\n     *\n     * The wrapper methods that are **not** chainable by default are:\n     * `add`, `attempt`, `camelCase`, `capitalize`, `ceil`, `clamp`, `clone`,\n     * `cloneDeep`, `cloneDeepWith`, `cloneWith`, `conformsTo`, `deburr`,\n     * `defaultTo`, `divide`, `each`, `eachRight`, `endsWith`, `eq`, `escape`,\n     * `escapeRegExp`, `every`, `find`, `findIndex`, `findKey`, `findLast`,\n     * `findLastIndex`, `findLastKey`, `first`, `floor`, `forEach`, `forEachRight`,\n     * `forIn`, `forInRight`, `forOwn`, `forOwnRight`, `get`, `gt`, `gte`, `has`,\n     * `hasIn`, `head`, `identity`, `includes`, `indexOf`, `inRange`, `invoke`,\n     * `isArguments`, `isArray`, `isArrayBuffer`, `isArrayLike`, `isArrayLikeObject`,\n     * `isBoolean`, `isBuffer`, `isDate`, `isElement`, `isEmpty`, `isEqual`,\n     * `isEqualWith`, `isError`, `isFinite`, `isFunction`, `isInteger`, `isLength`,\n     * `isMap`, `isMatch`, `isMatchWith`, `isNaN`, `isNative`, `isNil`, `isNull`,\n     * `isNumber`, `isObject`, `isObjectLike`, `isPlainObject`, `isRegExp`,\n     * `isSafeInteger`, `isSet`, `isString`, `isUndefined`, `isTypedArray`,\n     * `isWeakMap`, `isWeakSet`, `join`, `kebabCase`, `last`, `lastIndexOf`,\n     * `lowerCase`, `lowerFirst`, `lt`, `lte`, `max`, `maxBy`, `mean`, `meanBy`,\n     * `min`, `minBy`, `multiply`, `noConflict`, `noop`, `now`, `nth`, `pad`,\n     * `padEnd`, `padStart`, `parseInt`, `pop`, `random`, `reduce`, `reduceRight`,\n     * `repeat`, `result`, `round`, `runInContext`, `sample`, `shift`, `size`,\n     * `snakeCase`, `some`, `sortedIndex`, `sortedIndexBy`, `sortedLastIndex`,\n     * `sortedLastIndexBy`, `startCase`, `startsWith`, `stubArray`, `stubFalse`,\n     * `stubObject`, `stubString`, `stubTrue`, `subtract`, `sum`, `sumBy`,\n     * `template`, `times`, `toFinite`, `toInteger`, `toJSON`, `toLength`,\n     * `toLower`, `toNumber`, `toSafeInteger`, `toString`, `toUpper`, `trim`,\n     * `trimEnd`, `trimStart`, `truncate`, `unescape`, `uniqueId`, `upperCase`,\n     * `upperFirst`, `value`, and `words`\n     *\n     * @name _\n     * @constructor\n     * @category Seq\n     * @param {*} value The value to wrap in a `lodash` instance.\n     * @returns {Object} Returns the new `lodash` wrapper instance.\n     * @example\n     *\n     * function square(n) {\n     *   return n * n;\n     * }\n     *\n     * var wrapped = _([1, 2, 3]);\n     *\n     * // Returns an unwrapped value.\n     * wrapped.reduce(_.add);\n     * // => 6\n     *\n     * // Returns a wrapped value.\n     * var squares = wrapped.map(square);\n     *\n     * _.isArray(squares);\n     * // => false\n     *\n     * _.isArray(squares.value());\n     * // => true\n     */\n    function lodash(value) {\n      if (isObjectLike(value) && !isArray(value) && !(value instanceof LazyWrapper)) {\n        if (value instanceof LodashWrapper) {\n          return value;\n        }\n        if (hasOwnProperty.call(value, '__wrapped__')) {\n          return wrapperClone(value);\n        }\n      }\n      return new LodashWrapper(value);\n    }\n\n    /**\n     * The base implementation of `_.create` without support for assigning\n     * properties to the created object.\n     *\n     * @private\n     * @param {Object} proto The object to inherit from.\n     * @returns {Object} Returns the new object.\n     */\n    var baseCreate = (function() {\n      function object() {}\n      return function(proto) {\n        if (!isObject(proto)) {\n          return {};\n        }\n        if (objectCreate) {\n          return objectCreate(proto);\n        }\n        object.prototype = proto;\n        var result = new object;\n        object.prototype = undefined;\n        return result;\n      };\n    }());\n\n    /**\n     * The function whose prototype chain sequence wrappers inherit from.\n     *\n     * @private\n     */\n    function baseLodash() {\n      // No operation performed.\n    }\n\n    /**\n     * The base constructor for creating `lodash` wrapper objects.\n     *\n     * @private\n     * @param {*} value The value to wrap.\n     * @param {boolean} [chainAll] Enable explicit method chain sequences.\n     */\n    function LodashWrapper(value, chainAll) {\n      this.__wrapped__ = value;\n      this.__actions__ = [];\n      this.__chain__ = !!chainAll;\n      this.__index__ = 0;\n      this.__values__ = undefined;\n    }\n\n    /**\n     * By default, the template delimiters used by lodash are like those in\n     * embedded Ruby (ERB) as well as ES2015 template strings. Change the\n     * following template settings to use alternative delimiters.\n     *\n     * @static\n     * @memberOf _\n     * @type {Object}\n     */\n    lodash.templateSettings = {\n\n      /**\n       * Used to detect `data` property values to be HTML-escaped.\n       *\n       * @memberOf _.templateSettings\n       * @type {RegExp}\n       */\n      'escape': reEscape,\n\n      /**\n       * Used to detect code to be evaluated.\n       *\n       * @memberOf _.templateSettings\n       * @type {RegExp}\n       */\n      'evaluate': reEvaluate,\n\n      /**\n       * Used to detect `data` property values to inject.\n       *\n       * @memberOf _.templateSettings\n       * @type {RegExp}\n       */\n      'interpolate': reInterpolate,\n\n      /**\n       * Used to reference the data object in the template text.\n       *\n       * @memberOf _.templateSettings\n       * @type {string}\n       */\n      'variable': '',\n\n      /**\n       * Used to import variables into the compiled template.\n       *\n       * @memberOf _.templateSettings\n       * @type {Object}\n       */\n      'imports': {\n\n        /**\n         * A reference to the `lodash` function.\n         *\n         * @memberOf _.templateSettings.imports\n         * @type {Function}\n         */\n        '_': lodash\n      }\n    };\n\n    // Ensure wrappers are instances of `baseLodash`.\n    lodash.prototype = baseLodash.prototype;\n    lodash.prototype.constructor = lodash;\n\n    LodashWrapper.prototype = baseCreate(baseLodash.prototype);\n    LodashWrapper.prototype.constructor = LodashWrapper;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates a lazy wrapper object which wraps `value` to enable lazy evaluation.\n     *\n     * @private\n     * @constructor\n     * @param {*} value The value to wrap.\n     */\n    function LazyWrapper(value) {\n      this.__wrapped__ = value;\n      this.__actions__ = [];\n      this.__dir__ = 1;\n      this.__filtered__ = false;\n      this.__iteratees__ = [];\n      this.__takeCount__ = MAX_ARRAY_LENGTH;\n      this.__views__ = [];\n    }\n\n    /**\n     * Creates a clone of the lazy wrapper object.\n     *\n     * @private\n     * @name clone\n     * @memberOf LazyWrapper\n     * @returns {Object} Returns the cloned `LazyWrapper` object.\n     */\n    function lazyClone() {\n      var result = new LazyWrapper(this.__wrapped__);\n      result.__actions__ = copyArray(this.__actions__);\n      result.__dir__ = this.__dir__;\n      result.__filtered__ = this.__filtered__;\n      result.__iteratees__ = copyArray(this.__iteratees__);\n      result.__takeCount__ = this.__takeCount__;\n      result.__views__ = copyArray(this.__views__);\n      return result;\n    }\n\n    /**\n     * Reverses the direction of lazy iteration.\n     *\n     * @private\n     * @name reverse\n     * @memberOf LazyWrapper\n     * @returns {Object} Returns the new reversed `LazyWrapper` object.\n     */\n    function lazyReverse() {\n      if (this.__filtered__) {\n        var result = new LazyWrapper(this);\n        result.__dir__ = -1;\n        result.__filtered__ = true;\n      } else {\n        result = this.clone();\n        result.__dir__ *= -1;\n      }\n      return result;\n    }\n\n    /**\n     * Extracts the unwrapped value from its lazy wrapper.\n     *\n     * @private\n     * @name value\n     * @memberOf LazyWrapper\n     * @returns {*} Returns the unwrapped value.\n     */\n    function lazyValue() {\n      var array = this.__wrapped__.value(),\n          dir = this.__dir__,\n          isArr = isArray(array),\n          isRight = dir < 0,\n          arrLength = isArr ? array.length : 0,\n          view = getView(0, arrLength, this.__views__),\n          start = view.start,\n          end = view.end,\n          length = end - start,\n          index = isRight ? end : (start - 1),\n          iteratees = this.__iteratees__,\n          iterLength = iteratees.length,\n          resIndex = 0,\n          takeCount = nativeMin(length, this.__takeCount__);\n\n      if (!isArr || (!isRight && arrLength == length && takeCount == length)) {\n        return baseWrapperValue(array, this.__actions__);\n      }\n      var result = [];\n\n      outer:\n      while (length-- && resIndex < takeCount) {\n        index += dir;\n\n        var iterIndex = -1,\n            value = array[index];\n\n        while (++iterIndex < iterLength) {\n          var data = iteratees[iterIndex],\n              iteratee = data.iteratee,\n              type = data.type,\n              computed = iteratee(value);\n\n          if (type == LAZY_MAP_FLAG) {\n            value = computed;\n          } else if (!computed) {\n            if (type == LAZY_FILTER_FLAG) {\n              continue outer;\n            } else {\n              break outer;\n            }\n          }\n        }\n        result[resIndex++] = value;\n      }\n      return result;\n    }\n\n    // Ensure `LazyWrapper` is an instance of `baseLodash`.\n    LazyWrapper.prototype = baseCreate(baseLodash.prototype);\n    LazyWrapper.prototype.constructor = LazyWrapper;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates a hash object.\n     *\n     * @private\n     * @constructor\n     * @param {Array} [entries] The key-value pairs to cache.\n     */\n    function Hash(entries) {\n      var index = -1,\n          length = entries == null ? 0 : entries.length;\n\n      this.clear();\n      while (++index < length) {\n        var entry = entries[index];\n        this.set(entry[0], entry[1]);\n      }\n    }\n\n    /**\n     * Removes all key-value entries from the hash.\n     *\n     * @private\n     * @name clear\n     * @memberOf Hash\n     */\n    function hashClear() {\n      this.__data__ = nativeCreate ? nativeCreate(null) : {};\n      this.size = 0;\n    }\n\n    /**\n     * Removes `key` and its value from the hash.\n     *\n     * @private\n     * @name delete\n     * @memberOf Hash\n     * @param {Object} hash The hash to modify.\n     * @param {string} key The key of the value to remove.\n     * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n     */\n    function hashDelete(key) {\n      var result = this.has(key) && delete this.__data__[key];\n      this.size -= result ? 1 : 0;\n      return result;\n    }\n\n    /**\n     * Gets the hash value for `key`.\n     *\n     * @private\n     * @name get\n     * @memberOf Hash\n     * @param {string} key The key of the value to get.\n     * @returns {*} Returns the entry value.\n     */\n    function hashGet(key) {\n      var data = this.__data__;\n      if (nativeCreate) {\n        var result = data[key];\n        return result === HASH_UNDEFINED ? undefined : result;\n      }\n      return hasOwnProperty.call(data, key) ? data[key] : undefined;\n    }\n\n    /**\n     * Checks if a hash value for `key` exists.\n     *\n     * @private\n     * @name has\n     * @memberOf Hash\n     * @param {string} key The key of the entry to check.\n     * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n     */\n    function hashHas(key) {\n      var data = this.__data__;\n      return nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);\n    }\n\n    /**\n     * Sets the hash `key` to `value`.\n     *\n     * @private\n     * @name set\n     * @memberOf Hash\n     * @param {string} key The key of the value to set.\n     * @param {*} value The value to set.\n     * @returns {Object} Returns the hash instance.\n     */\n    function hashSet(key, value) {\n      var data = this.__data__;\n      this.size += this.has(key) ? 0 : 1;\n      data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n      return this;\n    }\n\n    // Add methods to `Hash`.\n    Hash.prototype.clear = hashClear;\n    Hash.prototype['delete'] = hashDelete;\n    Hash.prototype.get = hashGet;\n    Hash.prototype.has = hashHas;\n    Hash.prototype.set = hashSet;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates an list cache object.\n     *\n     * @private\n     * @constructor\n     * @param {Array} [entries] The key-value pairs to cache.\n     */\n    function ListCache(entries) {\n      var index = -1,\n          length = entries == null ? 0 : entries.length;\n\n      this.clear();\n      while (++index < length) {\n        var entry = entries[index];\n        this.set(entry[0], entry[1]);\n      }\n    }\n\n    /**\n     * Removes all key-value entries from the list cache.\n     *\n     * @private\n     * @name clear\n     * @memberOf ListCache\n     */\n    function listCacheClear() {\n      this.__data__ = [];\n      this.size = 0;\n    }\n\n    /**\n     * Removes `key` and its value from the list cache.\n     *\n     * @private\n     * @name delete\n     * @memberOf ListCache\n     * @param {string} key The key of the value to remove.\n     * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n     */\n    function listCacheDelete(key) {\n      var data = this.__data__,\n          index = assocIndexOf(data, key);\n\n      if (index < 0) {\n        return false;\n      }\n      var lastIndex = data.length - 1;\n      if (index == lastIndex) {\n        data.pop();\n      } else {\n        splice.call(data, index, 1);\n      }\n      --this.size;\n      return true;\n    }\n\n    /**\n     * Gets the list cache value for `key`.\n     *\n     * @private\n     * @name get\n     * @memberOf ListCache\n     * @param {string} key The key of the value to get.\n     * @returns {*} Returns the entry value.\n     */\n    function listCacheGet(key) {\n      var data = this.__data__,\n          index = assocIndexOf(data, key);\n\n      return index < 0 ? undefined : data[index][1];\n    }\n\n    /**\n     * Checks if a list cache value for `key` exists.\n     *\n     * @private\n     * @name has\n     * @memberOf ListCache\n     * @param {string} key The key of the entry to check.\n     * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n     */\n    function listCacheHas(key) {\n      return assocIndexOf(this.__data__, key) > -1;\n    }\n\n    /**\n     * Sets the list cache `key` to `value`.\n     *\n     * @private\n     * @name set\n     * @memberOf ListCache\n     * @param {string} key The key of the value to set.\n     * @param {*} value The value to set.\n     * @returns {Object} Returns the list cache instance.\n     */\n    function listCacheSet(key, value) {\n      var data = this.__data__,\n          index = assocIndexOf(data, key);\n\n      if (index < 0) {\n        ++this.size;\n        data.push([key, value]);\n      } else {\n        data[index][1] = value;\n      }\n      return this;\n    }\n\n    // Add methods to `ListCache`.\n    ListCache.prototype.clear = listCacheClear;\n    ListCache.prototype['delete'] = listCacheDelete;\n    ListCache.prototype.get = listCacheGet;\n    ListCache.prototype.has = listCacheHas;\n    ListCache.prototype.set = listCacheSet;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates a map cache object to store key-value pairs.\n     *\n     * @private\n     * @constructor\n     * @param {Array} [entries] The key-value pairs to cache.\n     */\n    function MapCache(entries) {\n      var index = -1,\n          length = entries == null ? 0 : entries.length;\n\n      this.clear();\n      while (++index < length) {\n        var entry = entries[index];\n        this.set(entry[0], entry[1]);\n      }\n    }\n\n    /**\n     * Removes all key-value entries from the map.\n     *\n     * @private\n     * @name clear\n     * @memberOf MapCache\n     */\n    function mapCacheClear() {\n      this.size = 0;\n      this.__data__ = {\n        'hash': new Hash,\n        'map': new (Map || ListCache),\n        'string': new Hash\n      };\n    }\n\n    /**\n     * Removes `key` and its value from the map.\n     *\n     * @private\n     * @name delete\n     * @memberOf MapCache\n     * @param {string} key The key of the value to remove.\n     * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n     */\n    function mapCacheDelete(key) {\n      var result = getMapData(this, key)['delete'](key);\n      this.size -= result ? 1 : 0;\n      return result;\n    }\n\n    /**\n     * Gets the map value for `key`.\n     *\n     * @private\n     * @name get\n     * @memberOf MapCache\n     * @param {string} key The key of the value to get.\n     * @returns {*} Returns the entry value.\n     */\n    function mapCacheGet(key) {\n      return getMapData(this, key).get(key);\n    }\n\n    /**\n     * Checks if a map value for `key` exists.\n     *\n     * @private\n     * @name has\n     * @memberOf MapCache\n     * @param {string} key The key of the entry to check.\n     * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n     */\n    function mapCacheHas(key) {\n      return getMapData(this, key).has(key);\n    }\n\n    /**\n     * Sets the map `key` to `value`.\n     *\n     * @private\n     * @name set\n     * @memberOf MapCache\n     * @param {string} key The key of the value to set.\n     * @param {*} value The value to set.\n     * @returns {Object} Returns the map cache instance.\n     */\n    function mapCacheSet(key, value) {\n      var data = getMapData(this, key),\n          size = data.size;\n\n      data.set(key, value);\n      this.size += data.size == size ? 0 : 1;\n      return this;\n    }\n\n    // Add methods to `MapCache`.\n    MapCache.prototype.clear = mapCacheClear;\n    MapCache.prototype['delete'] = mapCacheDelete;\n    MapCache.prototype.get = mapCacheGet;\n    MapCache.prototype.has = mapCacheHas;\n    MapCache.prototype.set = mapCacheSet;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     *\n     * Creates an array cache object to store unique values.\n     *\n     * @private\n     * @constructor\n     * @param {Array} [values] The values to cache.\n     */\n    function SetCache(values) {\n      var index = -1,\n          length = values == null ? 0 : values.length;\n\n      this.__data__ = new MapCache;\n      while (++index < length) {\n        this.add(values[index]);\n      }\n    }\n\n    /**\n     * Adds `value` to the array cache.\n     *\n     * @private\n     * @name add\n     * @memberOf SetCache\n     * @alias push\n     * @param {*} value The value to cache.\n     * @returns {Object} Returns the cache instance.\n     */\n    function setCacheAdd(value) {\n      this.__data__.set(value, HASH_UNDEFINED);\n      return this;\n    }\n\n    /**\n     * Checks if `value` is in the array cache.\n     *\n     * @private\n     * @name has\n     * @memberOf SetCache\n     * @param {*} value The value to search for.\n     * @returns {number} Returns `true` if `value` is found, else `false`.\n     */\n    function setCacheHas(value) {\n      return this.__data__.has(value);\n    }\n\n    // Add methods to `SetCache`.\n    SetCache.prototype.add = SetCache.prototype.push = setCacheAdd;\n    SetCache.prototype.has = setCacheHas;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates a stack cache object to store key-value pairs.\n     *\n     * @private\n     * @constructor\n     * @param {Array} [entries] The key-value pairs to cache.\n     */\n    function Stack(entries) {\n      var data = this.__data__ = new ListCache(entries);\n      this.size = data.size;\n    }\n\n    /**\n     * Removes all key-value entries from the stack.\n     *\n     * @private\n     * @name clear\n     * @memberOf Stack\n     */\n    function stackClear() {\n      this.__data__ = new ListCache;\n      this.size = 0;\n    }\n\n    /**\n     * Removes `key` and its value from the stack.\n     *\n     * @private\n     * @name delete\n     * @memberOf Stack\n     * @param {string} key The key of the value to remove.\n     * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n     */\n    function stackDelete(key) {\n      var data = this.__data__,\n          result = data['delete'](key);\n\n      this.size = data.size;\n      return result;\n    }\n\n    /**\n     * Gets the stack value for `key`.\n     *\n     * @private\n     * @name get\n     * @memberOf Stack\n     * @param {string} key The key of the value to get.\n     * @returns {*} Returns the entry value.\n     */\n    function stackGet(key) {\n      return this.__data__.get(key);\n    }\n\n    /**\n     * Checks if a stack value for `key` exists.\n     *\n     * @private\n     * @name has\n     * @memberOf Stack\n     * @param {string} key The key of the entry to check.\n     * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n     */\n    function stackHas(key) {\n      return this.__data__.has(key);\n    }\n\n    /**\n     * Sets the stack `key` to `value`.\n     *\n     * @private\n     * @name set\n     * @memberOf Stack\n     * @param {string} key The key of the value to set.\n     * @param {*} value The value to set.\n     * @returns {Object} Returns the stack cache instance.\n     */\n    function stackSet(key, value) {\n      var data = this.__data__;\n      if (data instanceof ListCache) {\n        var pairs = data.__data__;\n        if (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {\n          pairs.push([key, value]);\n          this.size = ++data.size;\n          return this;\n        }\n        data = this.__data__ = new MapCache(pairs);\n      }\n      data.set(key, value);\n      this.size = data.size;\n      return this;\n    }\n\n    // Add methods to `Stack`.\n    Stack.prototype.clear = stackClear;\n    Stack.prototype['delete'] = stackDelete;\n    Stack.prototype.get = stackGet;\n    Stack.prototype.has = stackHas;\n    Stack.prototype.set = stackSet;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates an array of the enumerable property names of the array-like `value`.\n     *\n     * @private\n     * @param {*} value The value to query.\n     * @param {boolean} inherited Specify returning inherited property names.\n     * @returns {Array} Returns the array of property names.\n     */\n    function arrayLikeKeys(value, inherited) {\n      var isArr = isArray(value),\n          isArg = !isArr && isArguments(value),\n          isBuff = !isArr && !isArg && isBuffer(value),\n          isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n          skipIndexes = isArr || isArg || isBuff || isType,\n          result = skipIndexes ? baseTimes(value.length, String) : [],\n          length = result.length;\n\n      for (var key in value) {\n        if ((inherited || hasOwnProperty.call(value, key)) &&\n            !(skipIndexes && (\n               // Safari 9 has enumerable `arguments.length` in strict mode.\n               key == 'length' ||\n               // Node.js 0.10 has enumerable non-index properties on buffers.\n               (isBuff && (key == 'offset' || key == 'parent')) ||\n               // PhantomJS 2 has enumerable non-index properties on typed arrays.\n               (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n               // Skip index properties.\n               isIndex(key, length)\n            ))) {\n          result.push(key);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * A specialized version of `_.sample` for arrays.\n     *\n     * @private\n     * @param {Array} array The array to sample.\n     * @returns {*} Returns the random element.\n     */\n    function arraySample(array) {\n      var length = array.length;\n      return length ? array[baseRandom(0, length - 1)] : undefined;\n    }\n\n    /**\n     * A specialized version of `_.sampleSize` for arrays.\n     *\n     * @private\n     * @param {Array} array The array to sample.\n     * @param {number} n The number of elements to sample.\n     * @returns {Array} Returns the random elements.\n     */\n    function arraySampleSize(array, n) {\n      return shuffleSelf(copyArray(array), baseClamp(n, 0, array.length));\n    }\n\n    /**\n     * A specialized version of `_.shuffle` for arrays.\n     *\n     * @private\n     * @param {Array} array The array to shuffle.\n     * @returns {Array} Returns the new shuffled array.\n     */\n    function arrayShuffle(array) {\n      return shuffleSelf(copyArray(array));\n    }\n\n    /**\n     * This function is like `assignValue` except that it doesn't assign\n     * `undefined` values.\n     *\n     * @private\n     * @param {Object} object The object to modify.\n     * @param {string} key The key of the property to assign.\n     * @param {*} value The value to assign.\n     */\n    function assignMergeValue(object, key, value) {\n      if ((value !== undefined && !eq(object[key], value)) ||\n          (value === undefined && !(key in object))) {\n        baseAssignValue(object, key, value);\n      }\n    }\n\n    /**\n     * Assigns `value` to `key` of `object` if the existing value is not equivalent\n     * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons.\n     *\n     * @private\n     * @param {Object} object The object to modify.\n     * @param {string} key The key of the property to assign.\n     * @param {*} value The value to assign.\n     */\n    function assignValue(object, key, value) {\n      var objValue = object[key];\n      if (!(hasOwnProperty.call(object, key) && eq(objValue, value)) ||\n          (value === undefined && !(key in object))) {\n        baseAssignValue(object, key, value);\n      }\n    }\n\n    /**\n     * Gets the index at which the `key` is found in `array` of key-value pairs.\n     *\n     * @private\n     * @param {Array} array The array to inspect.\n     * @param {*} key The key to search for.\n     * @returns {number} Returns the index of the matched value, else `-1`.\n     */\n    function assocIndexOf(array, key) {\n      var length = array.length;\n      while (length--) {\n        if (eq(array[length][0], key)) {\n          return length;\n        }\n      }\n      return -1;\n    }\n\n    /**\n     * Aggregates elements of `collection` on `accumulator` with keys transformed\n     * by `iteratee` and values set by `setter`.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} setter The function to set `accumulator` values.\n     * @param {Function} iteratee The iteratee to transform keys.\n     * @param {Object} accumulator The initial aggregated object.\n     * @returns {Function} Returns `accumulator`.\n     */\n    function baseAggregator(collection, setter, iteratee, accumulator) {\n      baseEach(collection, function(value, key, collection) {\n        setter(accumulator, value, iteratee(value), collection);\n      });\n      return accumulator;\n    }\n\n    /**\n     * The base implementation of `_.assign` without support for multiple sources\n     * or `customizer` functions.\n     *\n     * @private\n     * @param {Object} object The destination object.\n     * @param {Object} source The source object.\n     * @returns {Object} Returns `object`.\n     */\n    function baseAssign(object, source) {\n      return object && copyObject(source, keys(source), object);\n    }\n\n    /**\n     * The base implementation of `_.assignIn` without support for multiple sources\n     * or `customizer` functions.\n     *\n     * @private\n     * @param {Object} object The destination object.\n     * @param {Object} source The source object.\n     * @returns {Object} Returns `object`.\n     */\n    function baseAssignIn(object, source) {\n      return object && copyObject(source, keysIn(source), object);\n    }\n\n    /**\n     * The base implementation of `assignValue` and `assignMergeValue` without\n     * value checks.\n     *\n     * @private\n     * @param {Object} object The object to modify.\n     * @param {string} key The key of the property to assign.\n     * @param {*} value The value to assign.\n     */\n    function baseAssignValue(object, key, value) {\n      if (key == '__proto__' && defineProperty) {\n        defineProperty(object, key, {\n          'configurable': true,\n          'enumerable': true,\n          'value': value,\n          'writable': true\n        });\n      } else {\n        object[key] = value;\n      }\n    }\n\n    /**\n     * The base implementation of `_.at` without support for individual paths.\n     *\n     * @private\n     * @param {Object} object The object to iterate over.\n     * @param {string[]} paths The property paths to pick.\n     * @returns {Array} Returns the picked elements.\n     */\n    function baseAt(object, paths) {\n      var index = -1,\n          length = paths.length,\n          result = Array(length),\n          skip = object == null;\n\n      while (++index < length) {\n        result[index] = skip ? undefined : get(object, paths[index]);\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.clamp` which doesn't coerce arguments.\n     *\n     * @private\n     * @param {number} number The number to clamp.\n     * @param {number} [lower] The lower bound.\n     * @param {number} upper The upper bound.\n     * @returns {number} Returns the clamped number.\n     */\n    function baseClamp(number, lower, upper) {\n      if (number === number) {\n        if (upper !== undefined) {\n          number = number <= upper ? number : upper;\n        }\n        if (lower !== undefined) {\n          number = number >= lower ? number : lower;\n        }\n      }\n      return number;\n    }\n\n    /**\n     * The base implementation of `_.clone` and `_.cloneDeep` which tracks\n     * traversed objects.\n     *\n     * @private\n     * @param {*} value The value to clone.\n     * @param {boolean} bitmask The bitmask flags.\n     *  1 - Deep clone\n     *  2 - Flatten inherited properties\n     *  4 - Clone symbols\n     * @param {Function} [customizer] The function to customize cloning.\n     * @param {string} [key] The key of `value`.\n     * @param {Object} [object] The parent object of `value`.\n     * @param {Object} [stack] Tracks traversed objects and their clone counterparts.\n     * @returns {*} Returns the cloned value.\n     */\n    function baseClone(value, bitmask, customizer, key, object, stack) {\n      var result,\n          isDeep = bitmask & CLONE_DEEP_FLAG,\n          isFlat = bitmask & CLONE_FLAT_FLAG,\n          isFull = bitmask & CLONE_SYMBOLS_FLAG;\n\n      if (customizer) {\n        result = object ? customizer(value, key, object, stack) : customizer(value);\n      }\n      if (result !== undefined) {\n        return result;\n      }\n      if (!isObject(value)) {\n        return value;\n      }\n      var isArr = isArray(value);\n      if (isArr) {\n        result = initCloneArray(value);\n        if (!isDeep) {\n          return copyArray(value, result);\n        }\n      } else {\n        var tag = getTag(value),\n            isFunc = tag == funcTag || tag == genTag;\n\n        if (isBuffer(value)) {\n          return cloneBuffer(value, isDeep);\n        }\n        if (tag == objectTag || tag == argsTag || (isFunc && !object)) {\n          result = (isFlat || isFunc) ? {} : initCloneObject(value);\n          if (!isDeep) {\n            return isFlat\n              ? copySymbolsIn(value, baseAssignIn(result, value))\n              : copySymbols(value, baseAssign(result, value));\n          }\n        } else {\n          if (!cloneableTags[tag]) {\n            return object ? value : {};\n          }\n          result = initCloneByTag(value, tag, isDeep);\n        }\n      }\n      // Check for circular references and return its corresponding clone.\n      stack || (stack = new Stack);\n      var stacked = stack.get(value);\n      if (stacked) {\n        return stacked;\n      }\n      stack.set(value, result);\n\n      if (isSet(value)) {\n        value.forEach(function(subValue) {\n          result.add(baseClone(subValue, bitmask, customizer, subValue, value, stack));\n        });\n      } else if (isMap(value)) {\n        value.forEach(function(subValue, key) {\n          result.set(key, baseClone(subValue, bitmask, customizer, key, value, stack));\n        });\n      }\n\n      var keysFunc = isFull\n        ? (isFlat ? getAllKeysIn : getAllKeys)\n        : (isFlat ? keysIn : keys);\n\n      var props = isArr ? undefined : keysFunc(value);\n      arrayEach(props || value, function(subValue, key) {\n        if (props) {\n          key = subValue;\n          subValue = value[key];\n        }\n        // Recursively populate clone (susceptible to call stack limits).\n        assignValue(result, key, baseClone(subValue, bitmask, customizer, key, value, stack));\n      });\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.conforms` which doesn't clone `source`.\n     *\n     * @private\n     * @param {Object} source The object of property predicates to conform to.\n     * @returns {Function} Returns the new spec function.\n     */\n    function baseConforms(source) {\n      var props = keys(source);\n      return function(object) {\n        return baseConformsTo(object, source, props);\n      };\n    }\n\n    /**\n     * The base implementation of `_.conformsTo` which accepts `props` to check.\n     *\n     * @private\n     * @param {Object} object The object to inspect.\n     * @param {Object} source The object of property predicates to conform to.\n     * @returns {boolean} Returns `true` if `object` conforms, else `false`.\n     */\n    function baseConformsTo(object, source, props) {\n      var length = props.length;\n      if (object == null) {\n        return !length;\n      }\n      object = Object(object);\n      while (length--) {\n        var key = props[length],\n            predicate = source[key],\n            value = object[key];\n\n        if ((value === undefined && !(key in object)) || !predicate(value)) {\n          return false;\n        }\n      }\n      return true;\n    }\n\n    /**\n     * The base implementation of `_.delay` and `_.defer` which accepts `args`\n     * to provide to `func`.\n     *\n     * @private\n     * @param {Function} func The function to delay.\n     * @param {number} wait The number of milliseconds to delay invocation.\n     * @param {Array} args The arguments to provide to `func`.\n     * @returns {number|Object} Returns the timer id or timeout object.\n     */\n    function baseDelay(func, wait, args) {\n      if (typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      return setTimeout(function() { func.apply(undefined, args); }, wait);\n    }\n\n    /**\n     * The base implementation of methods like `_.difference` without support\n     * for excluding multiple arrays or iteratee shorthands.\n     *\n     * @private\n     * @param {Array} array The array to inspect.\n     * @param {Array} values The values to exclude.\n     * @param {Function} [iteratee] The iteratee invoked per element.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new array of filtered values.\n     */\n    function baseDifference(array, values, iteratee, comparator) {\n      var index = -1,\n          includes = arrayIncludes,\n          isCommon = true,\n          length = array.length,\n          result = [],\n          valuesLength = values.length;\n\n      if (!length) {\n        return result;\n      }\n      if (iteratee) {\n        values = arrayMap(values, baseUnary(iteratee));\n      }\n      if (comparator) {\n        includes = arrayIncludesWith;\n        isCommon = false;\n      }\n      else if (values.length >= LARGE_ARRAY_SIZE) {\n        includes = cacheHas;\n        isCommon = false;\n        values = new SetCache(values);\n      }\n      outer:\n      while (++index < length) {\n        var value = array[index],\n            computed = iteratee == null ? value : iteratee(value);\n\n        value = (comparator || value !== 0) ? value : 0;\n        if (isCommon && computed === computed) {\n          var valuesIndex = valuesLength;\n          while (valuesIndex--) {\n            if (values[valuesIndex] === computed) {\n              continue outer;\n            }\n          }\n          result.push(value);\n        }\n        else if (!includes(values, computed, comparator)) {\n          result.push(value);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.forEach` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} iteratee The function invoked per iteration.\n     * @returns {Array|Object} Returns `collection`.\n     */\n    var baseEach = createBaseEach(baseForOwn);\n\n    /**\n     * The base implementation of `_.forEachRight` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} iteratee The function invoked per iteration.\n     * @returns {Array|Object} Returns `collection`.\n     */\n    var baseEachRight = createBaseEach(baseForOwnRight, true);\n\n    /**\n     * The base implementation of `_.every` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} predicate The function invoked per iteration.\n     * @returns {boolean} Returns `true` if all elements pass the predicate check,\n     *  else `false`\n     */\n    function baseEvery(collection, predicate) {\n      var result = true;\n      baseEach(collection, function(value, index, collection) {\n        result = !!predicate(value, index, collection);\n        return result;\n      });\n      return result;\n    }\n\n    /**\n     * The base implementation of methods like `_.max` and `_.min` which accepts a\n     * `comparator` to determine the extremum value.\n     *\n     * @private\n     * @param {Array} array The array to iterate over.\n     * @param {Function} iteratee The iteratee invoked per iteration.\n     * @param {Function} comparator The comparator used to compare values.\n     * @returns {*} Returns the extremum value.\n     */\n    function baseExtremum(array, iteratee, comparator) {\n      var index = -1,\n          length = array.length;\n\n      while (++index < length) {\n        var value = array[index],\n            current = iteratee(value);\n\n        if (current != null && (computed === undefined\n              ? (current === current && !isSymbol(current))\n              : comparator(current, computed)\n            )) {\n          var computed = current,\n              result = value;\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.fill` without an iteratee call guard.\n     *\n     * @private\n     * @param {Array} array The array to fill.\n     * @param {*} value The value to fill `array` with.\n     * @param {number} [start=0] The start position.\n     * @param {number} [end=array.length] The end position.\n     * @returns {Array} Returns `array`.\n     */\n    function baseFill(array, value, start, end) {\n      var length = array.length;\n\n      start = toInteger(start);\n      if (start < 0) {\n        start = -start > length ? 0 : (length + start);\n      }\n      end = (end === undefined || end > length) ? length : toInteger(end);\n      if (end < 0) {\n        end += length;\n      }\n      end = start > end ? 0 : toLength(end);\n      while (start < end) {\n        array[start++] = value;\n      }\n      return array;\n    }\n\n    /**\n     * The base implementation of `_.filter` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} predicate The function invoked per iteration.\n     * @returns {Array} Returns the new filtered array.\n     */\n    function baseFilter(collection, predicate) {\n      var result = [];\n      baseEach(collection, function(value, index, collection) {\n        if (predicate(value, index, collection)) {\n          result.push(value);\n        }\n      });\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.flatten` with support for restricting flattening.\n     *\n     * @private\n     * @param {Array} array The array to flatten.\n     * @param {number} depth The maximum recursion depth.\n     * @param {boolean} [predicate=isFlattenable] The function invoked per iteration.\n     * @param {boolean} [isStrict] Restrict to values that pass `predicate` checks.\n     * @param {Array} [result=[]] The initial result value.\n     * @returns {Array} Returns the new flattened array.\n     */\n    function baseFlatten(array, depth, predicate, isStrict, result) {\n      var index = -1,\n          length = array.length;\n\n      predicate || (predicate = isFlattenable);\n      result || (result = []);\n\n      while (++index < length) {\n        var value = array[index];\n        if (depth > 0 && predicate(value)) {\n          if (depth > 1) {\n            // Recursively flatten arrays (susceptible to call stack limits).\n            baseFlatten(value, depth - 1, predicate, isStrict, result);\n          } else {\n            arrayPush(result, value);\n          }\n        } else if (!isStrict) {\n          result[result.length] = value;\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `baseForOwn` which iterates over `object`\n     * properties returned by `keysFunc` and invokes `iteratee` for each property.\n     * Iteratee functions may exit iteration early by explicitly returning `false`.\n     *\n     * @private\n     * @param {Object} object The object to iterate over.\n     * @param {Function} iteratee The function invoked per iteration.\n     * @param {Function} keysFunc The function to get the keys of `object`.\n     * @returns {Object} Returns `object`.\n     */\n    var baseFor = createBaseFor();\n\n    /**\n     * This function is like `baseFor` except that it iterates over properties\n     * in the opposite order.\n     *\n     * @private\n     * @param {Object} object The object to iterate over.\n     * @param {Function} iteratee The function invoked per iteration.\n     * @param {Function} keysFunc The function to get the keys of `object`.\n     * @returns {Object} Returns `object`.\n     */\n    var baseForRight = createBaseFor(true);\n\n    /**\n     * The base implementation of `_.forOwn` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Object} object The object to iterate over.\n     * @param {Function} iteratee The function invoked per iteration.\n     * @returns {Object} Returns `object`.\n     */\n    function baseForOwn(object, iteratee) {\n      return object && baseFor(object, iteratee, keys);\n    }\n\n    /**\n     * The base implementation of `_.forOwnRight` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Object} object The object to iterate over.\n     * @param {Function} iteratee The function invoked per iteration.\n     * @returns {Object} Returns `object`.\n     */\n    function baseForOwnRight(object, iteratee) {\n      return object && baseForRight(object, iteratee, keys);\n    }\n\n    /**\n     * The base implementation of `_.functions` which creates an array of\n     * `object` function property names filtered from `props`.\n     *\n     * @private\n     * @param {Object} object The object to inspect.\n     * @param {Array} props The property names to filter.\n     * @returns {Array} Returns the function names.\n     */\n    function baseFunctions(object, props) {\n      return arrayFilter(props, function(key) {\n        return isFunction(object[key]);\n      });\n    }\n\n    /**\n     * The base implementation of `_.get` without support for default values.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path of the property to get.\n     * @returns {*} Returns the resolved value.\n     */\n    function baseGet(object, path) {\n      path = castPath(path, object);\n\n      var index = 0,\n          length = path.length;\n\n      while (object != null && index < length) {\n        object = object[toKey(path[index++])];\n      }\n      return (index && index == length) ? object : undefined;\n    }\n\n    /**\n     * The base implementation of `getAllKeys` and `getAllKeysIn` which uses\n     * `keysFunc` and `symbolsFunc` to get the enumerable property names and\n     * symbols of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @param {Function} keysFunc The function to get the keys of `object`.\n     * @param {Function} symbolsFunc The function to get the symbols of `object`.\n     * @returns {Array} Returns the array of property names and symbols.\n     */\n    function baseGetAllKeys(object, keysFunc, symbolsFunc) {\n      var result = keysFunc(object);\n      return isArray(object) ? result : arrayPush(result, symbolsFunc(object));\n    }\n\n    /**\n     * The base implementation of `getTag` without fallbacks for buggy environments.\n     *\n     * @private\n     * @param {*} value The value to query.\n     * @returns {string} Returns the `toStringTag`.\n     */\n    function baseGetTag(value) {\n      if (value == null) {\n        return value === undefined ? undefinedTag : nullTag;\n      }\n      return (symToStringTag && symToStringTag in Object(value))\n        ? getRawTag(value)\n        : objectToString(value);\n    }\n\n    /**\n     * The base implementation of `_.gt` which doesn't coerce arguments.\n     *\n     * @private\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if `value` is greater than `other`,\n     *  else `false`.\n     */\n    function baseGt(value, other) {\n      return value > other;\n    }\n\n    /**\n     * The base implementation of `_.has` without support for deep paths.\n     *\n     * @private\n     * @param {Object} [object] The object to query.\n     * @param {Array|string} key The key to check.\n     * @returns {boolean} Returns `true` if `key` exists, else `false`.\n     */\n    function baseHas(object, key) {\n      return object != null && hasOwnProperty.call(object, key);\n    }\n\n    /**\n     * The base implementation of `_.hasIn` without support for deep paths.\n     *\n     * @private\n     * @param {Object} [object] The object to query.\n     * @param {Array|string} key The key to check.\n     * @returns {boolean} Returns `true` if `key` exists, else `false`.\n     */\n    function baseHasIn(object, key) {\n      return object != null && key in Object(object);\n    }\n\n    /**\n     * The base implementation of `_.inRange` which doesn't coerce arguments.\n     *\n     * @private\n     * @param {number} number The number to check.\n     * @param {number} start The start of the range.\n     * @param {number} end The end of the range.\n     * @returns {boolean} Returns `true` if `number` is in the range, else `false`.\n     */\n    function baseInRange(number, start, end) {\n      return number >= nativeMin(start, end) && number < nativeMax(start, end);\n    }\n\n    /**\n     * The base implementation of methods like `_.intersection`, without support\n     * for iteratee shorthands, that accepts an array of arrays to inspect.\n     *\n     * @private\n     * @param {Array} arrays The arrays to inspect.\n     * @param {Function} [iteratee] The iteratee invoked per element.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new array of shared values.\n     */\n    function baseIntersection(arrays, iteratee, comparator) {\n      var includes = comparator ? arrayIncludesWith : arrayIncludes,\n          length = arrays[0].length,\n          othLength = arrays.length,\n          othIndex = othLength,\n          caches = Array(othLength),\n          maxLength = Infinity,\n          result = [];\n\n      while (othIndex--) {\n        var array = arrays[othIndex];\n        if (othIndex && iteratee) {\n          array = arrayMap(array, baseUnary(iteratee));\n        }\n        maxLength = nativeMin(array.length, maxLength);\n        caches[othIndex] = !comparator && (iteratee || (length >= 120 && array.length >= 120))\n          ? new SetCache(othIndex && array)\n          : undefined;\n      }\n      array = arrays[0];\n\n      var index = -1,\n          seen = caches[0];\n\n      outer:\n      while (++index < length && result.length < maxLength) {\n        var value = array[index],\n            computed = iteratee ? iteratee(value) : value;\n\n        value = (comparator || value !== 0) ? value : 0;\n        if (!(seen\n              ? cacheHas(seen, computed)\n              : includes(result, computed, comparator)\n            )) {\n          othIndex = othLength;\n          while (--othIndex) {\n            var cache = caches[othIndex];\n            if (!(cache\n                  ? cacheHas(cache, computed)\n                  : includes(arrays[othIndex], computed, comparator))\n                ) {\n              continue outer;\n            }\n          }\n          if (seen) {\n            seen.push(computed);\n          }\n          result.push(value);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.invert` and `_.invertBy` which inverts\n     * `object` with values transformed by `iteratee` and set by `setter`.\n     *\n     * @private\n     * @param {Object} object The object to iterate over.\n     * @param {Function} setter The function to set `accumulator` values.\n     * @param {Function} iteratee The iteratee to transform values.\n     * @param {Object} accumulator The initial inverted object.\n     * @returns {Function} Returns `accumulator`.\n     */\n    function baseInverter(object, setter, iteratee, accumulator) {\n      baseForOwn(object, function(value, key, object) {\n        setter(accumulator, iteratee(value), key, object);\n      });\n      return accumulator;\n    }\n\n    /**\n     * The base implementation of `_.invoke` without support for individual\n     * method arguments.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path of the method to invoke.\n     * @param {Array} args The arguments to invoke the method with.\n     * @returns {*} Returns the result of the invoked method.\n     */\n    function baseInvoke(object, path, args) {\n      path = castPath(path, object);\n      object = parent(object, path);\n      var func = object == null ? object : object[toKey(last(path))];\n      return func == null ? undefined : apply(func, object, args);\n    }\n\n    /**\n     * The base implementation of `_.isArguments`.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n     */\n    function baseIsArguments(value) {\n      return isObjectLike(value) && baseGetTag(value) == argsTag;\n    }\n\n    /**\n     * The base implementation of `_.isArrayBuffer` without Node.js optimizations.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an array buffer, else `false`.\n     */\n    function baseIsArrayBuffer(value) {\n      return isObjectLike(value) && baseGetTag(value) == arrayBufferTag;\n    }\n\n    /**\n     * The base implementation of `_.isDate` without Node.js optimizations.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a date object, else `false`.\n     */\n    function baseIsDate(value) {\n      return isObjectLike(value) && baseGetTag(value) == dateTag;\n    }\n\n    /**\n     * The base implementation of `_.isEqual` which supports partial comparisons\n     * and tracks traversed objects.\n     *\n     * @private\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @param {boolean} bitmask The bitmask flags.\n     *  1 - Unordered comparison\n     *  2 - Partial comparison\n     * @param {Function} [customizer] The function to customize comparisons.\n     * @param {Object} [stack] Tracks traversed `value` and `other` objects.\n     * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n     */\n    function baseIsEqual(value, other, bitmask, customizer, stack) {\n      if (value === other) {\n        return true;\n      }\n      if (value == null || other == null || (!isObjectLike(value) && !isObjectLike(other))) {\n        return value !== value && other !== other;\n      }\n      return baseIsEqualDeep(value, other, bitmask, customizer, baseIsEqual, stack);\n    }\n\n    /**\n     * A specialized version of `baseIsEqual` for arrays and objects which performs\n     * deep comparisons and tracks traversed objects enabling objects with circular\n     * references to be compared.\n     *\n     * @private\n     * @param {Object} object The object to compare.\n     * @param {Object} other The other object to compare.\n     * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n     * @param {Function} customizer The function to customize comparisons.\n     * @param {Function} equalFunc The function to determine equivalents of values.\n     * @param {Object} [stack] Tracks traversed `object` and `other` objects.\n     * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n     */\n    function baseIsEqualDeep(object, other, bitmask, customizer, equalFunc, stack) {\n      var objIsArr = isArray(object),\n          othIsArr = isArray(other),\n          objTag = objIsArr ? arrayTag : getTag(object),\n          othTag = othIsArr ? arrayTag : getTag(other);\n\n      objTag = objTag == argsTag ? objectTag : objTag;\n      othTag = othTag == argsTag ? objectTag : othTag;\n\n      var objIsObj = objTag == objectTag,\n          othIsObj = othTag == objectTag,\n          isSameTag = objTag == othTag;\n\n      if (isSameTag && isBuffer(object)) {\n        if (!isBuffer(other)) {\n          return false;\n        }\n        objIsArr = true;\n        objIsObj = false;\n      }\n      if (isSameTag && !objIsObj) {\n        stack || (stack = new Stack);\n        return (objIsArr || isTypedArray(object))\n          ? equalArrays(object, other, bitmask, customizer, equalFunc, stack)\n          : equalByTag(object, other, objTag, bitmask, customizer, equalFunc, stack);\n      }\n      if (!(bitmask & COMPARE_PARTIAL_FLAG)) {\n        var objIsWrapped = objIsObj && hasOwnProperty.call(object, '__wrapped__'),\n            othIsWrapped = othIsObj && hasOwnProperty.call(other, '__wrapped__');\n\n        if (objIsWrapped || othIsWrapped) {\n          var objUnwrapped = objIsWrapped ? object.value() : object,\n              othUnwrapped = othIsWrapped ? other.value() : other;\n\n          stack || (stack = new Stack);\n          return equalFunc(objUnwrapped, othUnwrapped, bitmask, customizer, stack);\n        }\n      }\n      if (!isSameTag) {\n        return false;\n      }\n      stack || (stack = new Stack);\n      return equalObjects(object, other, bitmask, customizer, equalFunc, stack);\n    }\n\n    /**\n     * The base implementation of `_.isMap` without Node.js optimizations.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a map, else `false`.\n     */\n    function baseIsMap(value) {\n      return isObjectLike(value) && getTag(value) == mapTag;\n    }\n\n    /**\n     * The base implementation of `_.isMatch` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Object} object The object to inspect.\n     * @param {Object} source The object of property values to match.\n     * @param {Array} matchData The property names, values, and compare flags to match.\n     * @param {Function} [customizer] The function to customize comparisons.\n     * @returns {boolean} Returns `true` if `object` is a match, else `false`.\n     */\n    function baseIsMatch(object, source, matchData, customizer) {\n      var index = matchData.length,\n          length = index,\n          noCustomizer = !customizer;\n\n      if (object == null) {\n        return !length;\n      }\n      object = Object(object);\n      while (index--) {\n        var data = matchData[index];\n        if ((noCustomizer && data[2])\n              ? data[1] !== object[data[0]]\n              : !(data[0] in object)\n            ) {\n          return false;\n        }\n      }\n      while (++index < length) {\n        data = matchData[index];\n        var key = data[0],\n            objValue = object[key],\n            srcValue = data[1];\n\n        if (noCustomizer && data[2]) {\n          if (objValue === undefined && !(key in object)) {\n            return false;\n          }\n        } else {\n          var stack = new Stack;\n          if (customizer) {\n            var result = customizer(objValue, srcValue, key, object, source, stack);\n          }\n          if (!(result === undefined\n                ? baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG, customizer, stack)\n                : result\n              )) {\n            return false;\n          }\n        }\n      }\n      return true;\n    }\n\n    /**\n     * The base implementation of `_.isNative` without bad shim checks.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a native function,\n     *  else `false`.\n     */\n    function baseIsNative(value) {\n      if (!isObject(value) || isMasked(value)) {\n        return false;\n      }\n      var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n      return pattern.test(toSource(value));\n    }\n\n    /**\n     * The base implementation of `_.isRegExp` without Node.js optimizations.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a regexp, else `false`.\n     */\n    function baseIsRegExp(value) {\n      return isObjectLike(value) && baseGetTag(value) == regexpTag;\n    }\n\n    /**\n     * The base implementation of `_.isSet` without Node.js optimizations.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a set, else `false`.\n     */\n    function baseIsSet(value) {\n      return isObjectLike(value) && getTag(value) == setTag;\n    }\n\n    /**\n     * The base implementation of `_.isTypedArray` without Node.js optimizations.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n     */\n    function baseIsTypedArray(value) {\n      return isObjectLike(value) &&\n        isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n    }\n\n    /**\n     * The base implementation of `_.iteratee`.\n     *\n     * @private\n     * @param {*} [value=_.identity] The value to convert to an iteratee.\n     * @returns {Function} Returns the iteratee.\n     */\n    function baseIteratee(value) {\n      // Don't store the `typeof` result in a variable to avoid a JIT bug in Safari 9.\n      // See https://bugs.webkit.org/show_bug.cgi?id=156034 for more details.\n      if (typeof value == 'function') {\n        return value;\n      }\n      if (value == null) {\n        return identity;\n      }\n      if (typeof value == 'object') {\n        return isArray(value)\n          ? baseMatchesProperty(value[0], value[1])\n          : baseMatches(value);\n      }\n      return property(value);\n    }\n\n    /**\n     * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property names.\n     */\n    function baseKeys(object) {\n      if (!isPrototype(object)) {\n        return nativeKeys(object);\n      }\n      var result = [];\n      for (var key in Object(object)) {\n        if (hasOwnProperty.call(object, key) && key != 'constructor') {\n          result.push(key);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.keysIn` which doesn't treat sparse arrays as dense.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property names.\n     */\n    function baseKeysIn(object) {\n      if (!isObject(object)) {\n        return nativeKeysIn(object);\n      }\n      var isProto = isPrototype(object),\n          result = [];\n\n      for (var key in object) {\n        if (!(key == 'constructor' && (isProto || !hasOwnProperty.call(object, key)))) {\n          result.push(key);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.lt` which doesn't coerce arguments.\n     *\n     * @private\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if `value` is less than `other`,\n     *  else `false`.\n     */\n    function baseLt(value, other) {\n      return value < other;\n    }\n\n    /**\n     * The base implementation of `_.map` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} iteratee The function invoked per iteration.\n     * @returns {Array} Returns the new mapped array.\n     */\n    function baseMap(collection, iteratee) {\n      var index = -1,\n          result = isArrayLike(collection) ? Array(collection.length) : [];\n\n      baseEach(collection, function(value, key, collection) {\n        result[++index] = iteratee(value, key, collection);\n      });\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.matches` which doesn't clone `source`.\n     *\n     * @private\n     * @param {Object} source The object of property values to match.\n     * @returns {Function} Returns the new spec function.\n     */\n    function baseMatches(source) {\n      var matchData = getMatchData(source);\n      if (matchData.length == 1 && matchData[0][2]) {\n        return matchesStrictComparable(matchData[0][0], matchData[0][1]);\n      }\n      return function(object) {\n        return object === source || baseIsMatch(object, source, matchData);\n      };\n    }\n\n    /**\n     * The base implementation of `_.matchesProperty` which doesn't clone `srcValue`.\n     *\n     * @private\n     * @param {string} path The path of the property to get.\n     * @param {*} srcValue The value to match.\n     * @returns {Function} Returns the new spec function.\n     */\n    function baseMatchesProperty(path, srcValue) {\n      if (isKey(path) && isStrictComparable(srcValue)) {\n        return matchesStrictComparable(toKey(path), srcValue);\n      }\n      return function(object) {\n        var objValue = get(object, path);\n        return (objValue === undefined && objValue === srcValue)\n          ? hasIn(object, path)\n          : baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG);\n      };\n    }\n\n    /**\n     * The base implementation of `_.merge` without support for multiple sources.\n     *\n     * @private\n     * @param {Object} object The destination object.\n     * @param {Object} source The source object.\n     * @param {number} srcIndex The index of `source`.\n     * @param {Function} [customizer] The function to customize merged values.\n     * @param {Object} [stack] Tracks traversed source values and their merged\n     *  counterparts.\n     */\n    function baseMerge(object, source, srcIndex, customizer, stack) {\n      if (object === source) {\n        return;\n      }\n      baseFor(source, function(srcValue, key) {\n        stack || (stack = new Stack);\n        if (isObject(srcValue)) {\n          baseMergeDeep(object, source, key, srcIndex, baseMerge, customizer, stack);\n        }\n        else {\n          var newValue = customizer\n            ? customizer(safeGet(object, key), srcValue, (key + ''), object, source, stack)\n            : undefined;\n\n          if (newValue === undefined) {\n            newValue = srcValue;\n          }\n          assignMergeValue(object, key, newValue);\n        }\n      }, keysIn);\n    }\n\n    /**\n     * A specialized version of `baseMerge` for arrays and objects which performs\n     * deep merges and tracks traversed objects enabling objects with circular\n     * references to be merged.\n     *\n     * @private\n     * @param {Object} object The destination object.\n     * @param {Object} source The source object.\n     * @param {string} key The key of the value to merge.\n     * @param {number} srcIndex The index of `source`.\n     * @param {Function} mergeFunc The function to merge values.\n     * @param {Function} [customizer] The function to customize assigned values.\n     * @param {Object} [stack] Tracks traversed source values and their merged\n     *  counterparts.\n     */\n    function baseMergeDeep(object, source, key, srcIndex, mergeFunc, customizer, stack) {\n      var objValue = safeGet(object, key),\n          srcValue = safeGet(source, key),\n          stacked = stack.get(srcValue);\n\n      if (stacked) {\n        assignMergeValue(object, key, stacked);\n        return;\n      }\n      var newValue = customizer\n        ? customizer(objValue, srcValue, (key + ''), object, source, stack)\n        : undefined;\n\n      var isCommon = newValue === undefined;\n\n      if (isCommon) {\n        var isArr = isArray(srcValue),\n            isBuff = !isArr && isBuffer(srcValue),\n            isTyped = !isArr && !isBuff && isTypedArray(srcValue);\n\n        newValue = srcValue;\n        if (isArr || isBuff || isTyped) {\n          if (isArray(objValue)) {\n            newValue = objValue;\n          }\n          else if (isArrayLikeObject(objValue)) {\n            newValue = copyArray(objValue);\n          }\n          else if (isBuff) {\n            isCommon = false;\n            newValue = cloneBuffer(srcValue, true);\n          }\n          else if (isTyped) {\n            isCommon = false;\n            newValue = cloneTypedArray(srcValue, true);\n          }\n          else {\n            newValue = [];\n          }\n        }\n        else if (isPlainObject(srcValue) || isArguments(srcValue)) {\n          newValue = objValue;\n          if (isArguments(objValue)) {\n            newValue = toPlainObject(objValue);\n          }\n          else if (!isObject(objValue) || isFunction(objValue)) {\n            newValue = initCloneObject(srcValue);\n          }\n        }\n        else {\n          isCommon = false;\n        }\n      }\n      if (isCommon) {\n        // Recursively merge objects and arrays (susceptible to call stack limits).\n        stack.set(srcValue, newValue);\n        mergeFunc(newValue, srcValue, srcIndex, customizer, stack);\n        stack['delete'](srcValue);\n      }\n      assignMergeValue(object, key, newValue);\n    }\n\n    /**\n     * The base implementation of `_.nth` which doesn't coerce arguments.\n     *\n     * @private\n     * @param {Array} array The array to query.\n     * @param {number} n The index of the element to return.\n     * @returns {*} Returns the nth element of `array`.\n     */\n    function baseNth(array, n) {\n      var length = array.length;\n      if (!length) {\n        return;\n      }\n      n += n < 0 ? length : 0;\n      return isIndex(n, length) ? array[n] : undefined;\n    }\n\n    /**\n     * The base implementation of `_.orderBy` without param guards.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function[]|Object[]|string[]} iteratees The iteratees to sort by.\n     * @param {string[]} orders The sort orders of `iteratees`.\n     * @returns {Array} Returns the new sorted array.\n     */\n    function baseOrderBy(collection, iteratees, orders) {\n      if (iteratees.length) {\n        iteratees = arrayMap(iteratees, function(iteratee) {\n          if (isArray(iteratee)) {\n            return function(value) {\n              return baseGet(value, iteratee.length === 1 ? iteratee[0] : iteratee);\n            }\n          }\n          return iteratee;\n        });\n      } else {\n        iteratees = [identity];\n      }\n\n      var index = -1;\n      iteratees = arrayMap(iteratees, baseUnary(getIteratee()));\n\n      var result = baseMap(collection, function(value, key, collection) {\n        var criteria = arrayMap(iteratees, function(iteratee) {\n          return iteratee(value);\n        });\n        return { 'criteria': criteria, 'index': ++index, 'value': value };\n      });\n\n      return baseSortBy(result, function(object, other) {\n        return compareMultiple(object, other, orders);\n      });\n    }\n\n    /**\n     * The base implementation of `_.pick` without support for individual\n     * property identifiers.\n     *\n     * @private\n     * @param {Object} object The source object.\n     * @param {string[]} paths The property paths to pick.\n     * @returns {Object} Returns the new object.\n     */\n    function basePick(object, paths) {\n      return basePickBy(object, paths, function(value, path) {\n        return hasIn(object, path);\n      });\n    }\n\n    /**\n     * The base implementation of  `_.pickBy` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Object} object The source object.\n     * @param {string[]} paths The property paths to pick.\n     * @param {Function} predicate The function invoked per property.\n     * @returns {Object} Returns the new object.\n     */\n    function basePickBy(object, paths, predicate) {\n      var index = -1,\n          length = paths.length,\n          result = {};\n\n      while (++index < length) {\n        var path = paths[index],\n            value = baseGet(object, path);\n\n        if (predicate(value, path)) {\n          baseSet(result, castPath(path, object), value);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * A specialized version of `baseProperty` which supports deep paths.\n     *\n     * @private\n     * @param {Array|string} path The path of the property to get.\n     * @returns {Function} Returns the new accessor function.\n     */\n    function basePropertyDeep(path) {\n      return function(object) {\n        return baseGet(object, path);\n      };\n    }\n\n    /**\n     * The base implementation of `_.pullAllBy` without support for iteratee\n     * shorthands.\n     *\n     * @private\n     * @param {Array} array The array to modify.\n     * @param {Array} values The values to remove.\n     * @param {Function} [iteratee] The iteratee invoked per element.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns `array`.\n     */\n    function basePullAll(array, values, iteratee, comparator) {\n      var indexOf = comparator ? baseIndexOfWith : baseIndexOf,\n          index = -1,\n          length = values.length,\n          seen = array;\n\n      if (array === values) {\n        values = copyArray(values);\n      }\n      if (iteratee) {\n        seen = arrayMap(array, baseUnary(iteratee));\n      }\n      while (++index < length) {\n        var fromIndex = 0,\n            value = values[index],\n            computed = iteratee ? iteratee(value) : value;\n\n        while ((fromIndex = indexOf(seen, computed, fromIndex, comparator)) > -1) {\n          if (seen !== array) {\n            splice.call(seen, fromIndex, 1);\n          }\n          splice.call(array, fromIndex, 1);\n        }\n      }\n      return array;\n    }\n\n    /**\n     * The base implementation of `_.pullAt` without support for individual\n     * indexes or capturing the removed elements.\n     *\n     * @private\n     * @param {Array} array The array to modify.\n     * @param {number[]} indexes The indexes of elements to remove.\n     * @returns {Array} Returns `array`.\n     */\n    function basePullAt(array, indexes) {\n      var length = array ? indexes.length : 0,\n          lastIndex = length - 1;\n\n      while (length--) {\n        var index = indexes[length];\n        if (length == lastIndex || index !== previous) {\n          var previous = index;\n          if (isIndex(index)) {\n            splice.call(array, index, 1);\n          } else {\n            baseUnset(array, index);\n          }\n        }\n      }\n      return array;\n    }\n\n    /**\n     * The base implementation of `_.random` without support for returning\n     * floating-point numbers.\n     *\n     * @private\n     * @param {number} lower The lower bound.\n     * @param {number} upper The upper bound.\n     * @returns {number} Returns the random number.\n     */\n    function baseRandom(lower, upper) {\n      return lower + nativeFloor(nativeRandom() * (upper - lower + 1));\n    }\n\n    /**\n     * The base implementation of `_.range` and `_.rangeRight` which doesn't\n     * coerce arguments.\n     *\n     * @private\n     * @param {number} start The start of the range.\n     * @param {number} end The end of the range.\n     * @param {number} step The value to increment or decrement by.\n     * @param {boolean} [fromRight] Specify iterating from right to left.\n     * @returns {Array} Returns the range of numbers.\n     */\n    function baseRange(start, end, step, fromRight) {\n      var index = -1,\n          length = nativeMax(nativeCeil((end - start) / (step || 1)), 0),\n          result = Array(length);\n\n      while (length--) {\n        result[fromRight ? length : ++index] = start;\n        start += step;\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.repeat` which doesn't coerce arguments.\n     *\n     * @private\n     * @param {string} string The string to repeat.\n     * @param {number} n The number of times to repeat the string.\n     * @returns {string} Returns the repeated string.\n     */\n    function baseRepeat(string, n) {\n      var result = '';\n      if (!string || n < 1 || n > MAX_SAFE_INTEGER) {\n        return result;\n      }\n      // Leverage the exponentiation by squaring algorithm for a faster repeat.\n      // See https://en.wikipedia.org/wiki/Exponentiation_by_squaring for more details.\n      do {\n        if (n % 2) {\n          result += string;\n        }\n        n = nativeFloor(n / 2);\n        if (n) {\n          string += string;\n        }\n      } while (n);\n\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.rest` which doesn't validate or coerce arguments.\n     *\n     * @private\n     * @param {Function} func The function to apply a rest parameter to.\n     * @param {number} [start=func.length-1] The start position of the rest parameter.\n     * @returns {Function} Returns the new function.\n     */\n    function baseRest(func, start) {\n      return setToString(overRest(func, start, identity), func + '');\n    }\n\n    /**\n     * The base implementation of `_.sample`.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to sample.\n     * @returns {*} Returns the random element.\n     */\n    function baseSample(collection) {\n      return arraySample(values(collection));\n    }\n\n    /**\n     * The base implementation of `_.sampleSize` without param guards.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to sample.\n     * @param {number} n The number of elements to sample.\n     * @returns {Array} Returns the random elements.\n     */\n    function baseSampleSize(collection, n) {\n      var array = values(collection);\n      return shuffleSelf(array, baseClamp(n, 0, array.length));\n    }\n\n    /**\n     * The base implementation of `_.set`.\n     *\n     * @private\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The path of the property to set.\n     * @param {*} value The value to set.\n     * @param {Function} [customizer] The function to customize path creation.\n     * @returns {Object} Returns `object`.\n     */\n    function baseSet(object, path, value, customizer) {\n      if (!isObject(object)) {\n        return object;\n      }\n      path = castPath(path, object);\n\n      var index = -1,\n          length = path.length,\n          lastIndex = length - 1,\n          nested = object;\n\n      while (nested != null && ++index < length) {\n        var key = toKey(path[index]),\n            newValue = value;\n\n        if (key === '__proto__' || key === 'constructor' || key === 'prototype') {\n          return object;\n        }\n\n        if (index != lastIndex) {\n          var objValue = nested[key];\n          newValue = customizer ? customizer(objValue, key, nested) : undefined;\n          if (newValue === undefined) {\n            newValue = isObject(objValue)\n              ? objValue\n              : (isIndex(path[index + 1]) ? [] : {});\n          }\n        }\n        assignValue(nested, key, newValue);\n        nested = nested[key];\n      }\n      return object;\n    }\n\n    /**\n     * The base implementation of `setData` without support for hot loop shorting.\n     *\n     * @private\n     * @param {Function} func The function to associate metadata with.\n     * @param {*} data The metadata.\n     * @returns {Function} Returns `func`.\n     */\n    var baseSetData = !metaMap ? identity : function(func, data) {\n      metaMap.set(func, data);\n      return func;\n    };\n\n    /**\n     * The base implementation of `setToString` without support for hot loop shorting.\n     *\n     * @private\n     * @param {Function} func The function to modify.\n     * @param {Function} string The `toString` result.\n     * @returns {Function} Returns `func`.\n     */\n    var baseSetToString = !defineProperty ? identity : function(func, string) {\n      return defineProperty(func, 'toString', {\n        'configurable': true,\n        'enumerable': false,\n        'value': constant(string),\n        'writable': true\n      });\n    };\n\n    /**\n     * The base implementation of `_.shuffle`.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to shuffle.\n     * @returns {Array} Returns the new shuffled array.\n     */\n    function baseShuffle(collection) {\n      return shuffleSelf(values(collection));\n    }\n\n    /**\n     * The base implementation of `_.slice` without an iteratee call guard.\n     *\n     * @private\n     * @param {Array} array The array to slice.\n     * @param {number} [start=0] The start position.\n     * @param {number} [end=array.length] The end position.\n     * @returns {Array} Returns the slice of `array`.\n     */\n    function baseSlice(array, start, end) {\n      var index = -1,\n          length = array.length;\n\n      if (start < 0) {\n        start = -start > length ? 0 : (length + start);\n      }\n      end = end > length ? length : end;\n      if (end < 0) {\n        end += length;\n      }\n      length = start > end ? 0 : ((end - start) >>> 0);\n      start >>>= 0;\n\n      var result = Array(length);\n      while (++index < length) {\n        result[index] = array[index + start];\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.some` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} predicate The function invoked per iteration.\n     * @returns {boolean} Returns `true` if any element passes the predicate check,\n     *  else `false`.\n     */\n    function baseSome(collection, predicate) {\n      var result;\n\n      baseEach(collection, function(value, index, collection) {\n        result = predicate(value, index, collection);\n        return !result;\n      });\n      return !!result;\n    }\n\n    /**\n     * The base implementation of `_.sortedIndex` and `_.sortedLastIndex` which\n     * performs a binary search of `array` to determine the index at which `value`\n     * should be inserted into `array` in order to maintain its sort order.\n     *\n     * @private\n     * @param {Array} array The sorted array to inspect.\n     * @param {*} value The value to evaluate.\n     * @param {boolean} [retHighest] Specify returning the highest qualified index.\n     * @returns {number} Returns the index at which `value` should be inserted\n     *  into `array`.\n     */\n    function baseSortedIndex(array, value, retHighest) {\n      var low = 0,\n          high = array == null ? low : array.length;\n\n      if (typeof value == 'number' && value === value && high <= HALF_MAX_ARRAY_LENGTH) {\n        while (low < high) {\n          var mid = (low + high) >>> 1,\n              computed = array[mid];\n\n          if (computed !== null && !isSymbol(computed) &&\n              (retHighest ? (computed <= value) : (computed < value))) {\n            low = mid + 1;\n          } else {\n            high = mid;\n          }\n        }\n        return high;\n      }\n      return baseSortedIndexBy(array, value, identity, retHighest);\n    }\n\n    /**\n     * The base implementation of `_.sortedIndexBy` and `_.sortedLastIndexBy`\n     * which invokes `iteratee` for `value` and each element of `array` to compute\n     * their sort ranking. The iteratee is invoked with one argument; (value).\n     *\n     * @private\n     * @param {Array} array The sorted array to inspect.\n     * @param {*} value The value to evaluate.\n     * @param {Function} iteratee The iteratee invoked per element.\n     * @param {boolean} [retHighest] Specify returning the highest qualified index.\n     * @returns {number} Returns the index at which `value` should be inserted\n     *  into `array`.\n     */\n    function baseSortedIndexBy(array, value, iteratee, retHighest) {\n      var low = 0,\n          high = array == null ? 0 : array.length;\n      if (high === 0) {\n        return 0;\n      }\n\n      value = iteratee(value);\n      var valIsNaN = value !== value,\n          valIsNull = value === null,\n          valIsSymbol = isSymbol(value),\n          valIsUndefined = value === undefined;\n\n      while (low < high) {\n        var mid = nativeFloor((low + high) / 2),\n            computed = iteratee(array[mid]),\n            othIsDefined = computed !== undefined,\n            othIsNull = computed === null,\n            othIsReflexive = computed === computed,\n            othIsSymbol = isSymbol(computed);\n\n        if (valIsNaN) {\n          var setLow = retHighest || othIsReflexive;\n        } else if (valIsUndefined) {\n          setLow = othIsReflexive && (retHighest || othIsDefined);\n        } else if (valIsNull) {\n          setLow = othIsReflexive && othIsDefined && (retHighest || !othIsNull);\n        } else if (valIsSymbol) {\n          setLow = othIsReflexive && othIsDefined && !othIsNull && (retHighest || !othIsSymbol);\n        } else if (othIsNull || othIsSymbol) {\n          setLow = false;\n        } else {\n          setLow = retHighest ? (computed <= value) : (computed < value);\n        }\n        if (setLow) {\n          low = mid + 1;\n        } else {\n          high = mid;\n        }\n      }\n      return nativeMin(high, MAX_ARRAY_INDEX);\n    }\n\n    /**\n     * The base implementation of `_.sortedUniq` and `_.sortedUniqBy` without\n     * support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array} array The array to inspect.\n     * @param {Function} [iteratee] The iteratee invoked per element.\n     * @returns {Array} Returns the new duplicate free array.\n     */\n    function baseSortedUniq(array, iteratee) {\n      var index = -1,\n          length = array.length,\n          resIndex = 0,\n          result = [];\n\n      while (++index < length) {\n        var value = array[index],\n            computed = iteratee ? iteratee(value) : value;\n\n        if (!index || !eq(computed, seen)) {\n          var seen = computed;\n          result[resIndex++] = value === 0 ? 0 : value;\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.toNumber` which doesn't ensure correct\n     * conversions of binary, hexadecimal, or octal string values.\n     *\n     * @private\n     * @param {*} value The value to process.\n     * @returns {number} Returns the number.\n     */\n    function baseToNumber(value) {\n      if (typeof value == 'number') {\n        return value;\n      }\n      if (isSymbol(value)) {\n        return NAN;\n      }\n      return +value;\n    }\n\n    /**\n     * The base implementation of `_.toString` which doesn't convert nullish\n     * values to empty strings.\n     *\n     * @private\n     * @param {*} value The value to process.\n     * @returns {string} Returns the string.\n     */\n    function baseToString(value) {\n      // Exit early for strings to avoid a performance hit in some environments.\n      if (typeof value == 'string') {\n        return value;\n      }\n      if (isArray(value)) {\n        // Recursively convert values (susceptible to call stack limits).\n        return arrayMap(value, baseToString) + '';\n      }\n      if (isSymbol(value)) {\n        return symbolToString ? symbolToString.call(value) : '';\n      }\n      var result = (value + '');\n      return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n    }\n\n    /**\n     * The base implementation of `_.uniqBy` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array} array The array to inspect.\n     * @param {Function} [iteratee] The iteratee invoked per element.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new duplicate free array.\n     */\n    function baseUniq(array, iteratee, comparator) {\n      var index = -1,\n          includes = arrayIncludes,\n          length = array.length,\n          isCommon = true,\n          result = [],\n          seen = result;\n\n      if (comparator) {\n        isCommon = false;\n        includes = arrayIncludesWith;\n      }\n      else if (length >= LARGE_ARRAY_SIZE) {\n        var set = iteratee ? null : createSet(array);\n        if (set) {\n          return setToArray(set);\n        }\n        isCommon = false;\n        includes = cacheHas;\n        seen = new SetCache;\n      }\n      else {\n        seen = iteratee ? [] : result;\n      }\n      outer:\n      while (++index < length) {\n        var value = array[index],\n            computed = iteratee ? iteratee(value) : value;\n\n        value = (comparator || value !== 0) ? value : 0;\n        if (isCommon && computed === computed) {\n          var seenIndex = seen.length;\n          while (seenIndex--) {\n            if (seen[seenIndex] === computed) {\n              continue outer;\n            }\n          }\n          if (iteratee) {\n            seen.push(computed);\n          }\n          result.push(value);\n        }\n        else if (!includes(seen, computed, comparator)) {\n          if (seen !== result) {\n            seen.push(computed);\n          }\n          result.push(value);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.unset`.\n     *\n     * @private\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The property path to unset.\n     * @returns {boolean} Returns `true` if the property is deleted, else `false`.\n     */\n    function baseUnset(object, path) {\n      path = castPath(path, object);\n      object = parent(object, path);\n      return object == null || delete object[toKey(last(path))];\n    }\n\n    /**\n     * The base implementation of `_.update`.\n     *\n     * @private\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The path of the property to update.\n     * @param {Function} updater The function to produce the updated value.\n     * @param {Function} [customizer] The function to customize path creation.\n     * @returns {Object} Returns `object`.\n     */\n    function baseUpdate(object, path, updater, customizer) {\n      return baseSet(object, path, updater(baseGet(object, path)), customizer);\n    }\n\n    /**\n     * The base implementation of methods like `_.dropWhile` and `_.takeWhile`\n     * without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array} array The array to query.\n     * @param {Function} predicate The function invoked per iteration.\n     * @param {boolean} [isDrop] Specify dropping elements instead of taking them.\n     * @param {boolean} [fromRight] Specify iterating from right to left.\n     * @returns {Array} Returns the slice of `array`.\n     */\n    function baseWhile(array, predicate, isDrop, fromRight) {\n      var length = array.length,\n          index = fromRight ? length : -1;\n\n      while ((fromRight ? index-- : ++index < length) &&\n        predicate(array[index], index, array)) {}\n\n      return isDrop\n        ? baseSlice(array, (fromRight ? 0 : index), (fromRight ? index + 1 : length))\n        : baseSlice(array, (fromRight ? index + 1 : 0), (fromRight ? length : index));\n    }\n\n    /**\n     * The base implementation of `wrapperValue` which returns the result of\n     * performing a sequence of actions on the unwrapped `value`, where each\n     * successive action is supplied the return value of the previous.\n     *\n     * @private\n     * @param {*} value The unwrapped value.\n     * @param {Array} actions Actions to perform to resolve the unwrapped value.\n     * @returns {*} Returns the resolved value.\n     */\n    function baseWrapperValue(value, actions) {\n      var result = value;\n      if (result instanceof LazyWrapper) {\n        result = result.value();\n      }\n      return arrayReduce(actions, function(result, action) {\n        return action.func.apply(action.thisArg, arrayPush([result], action.args));\n      }, result);\n    }\n\n    /**\n     * The base implementation of methods like `_.xor`, without support for\n     * iteratee shorthands, that accepts an array of arrays to inspect.\n     *\n     * @private\n     * @param {Array} arrays The arrays to inspect.\n     * @param {Function} [iteratee] The iteratee invoked per element.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new array of values.\n     */\n    function baseXor(arrays, iteratee, comparator) {\n      var length = arrays.length;\n      if (length < 2) {\n        return length ? baseUniq(arrays[0]) : [];\n      }\n      var index = -1,\n          result = Array(length);\n\n      while (++index < length) {\n        var array = arrays[index],\n            othIndex = -1;\n\n        while (++othIndex < length) {\n          if (othIndex != index) {\n            result[index] = baseDifference(result[index] || array, arrays[othIndex], iteratee, comparator);\n          }\n        }\n      }\n      return baseUniq(baseFlatten(result, 1), iteratee, comparator);\n    }\n\n    /**\n     * This base implementation of `_.zipObject` which assigns values using `assignFunc`.\n     *\n     * @private\n     * @param {Array} props The property identifiers.\n     * @param {Array} values The property values.\n     * @param {Function} assignFunc The function to assign values.\n     * @returns {Object} Returns the new object.\n     */\n    function baseZipObject(props, values, assignFunc) {\n      var index = -1,\n          length = props.length,\n          valsLength = values.length,\n          result = {};\n\n      while (++index < length) {\n        var value = index < valsLength ? values[index] : undefined;\n        assignFunc(result, props[index], value);\n      }\n      return result;\n    }\n\n    /**\n     * Casts `value` to an empty array if it's not an array like object.\n     *\n     * @private\n     * @param {*} value The value to inspect.\n     * @returns {Array|Object} Returns the cast array-like object.\n     */\n    function castArrayLikeObject(value) {\n      return isArrayLikeObject(value) ? value : [];\n    }\n\n    /**\n     * Casts `value` to `identity` if it's not a function.\n     *\n     * @private\n     * @param {*} value The value to inspect.\n     * @returns {Function} Returns cast function.\n     */\n    function castFunction(value) {\n      return typeof value == 'function' ? value : identity;\n    }\n\n    /**\n     * Casts `value` to a path array if it's not one.\n     *\n     * @private\n     * @param {*} value The value to inspect.\n     * @param {Object} [object] The object to query keys on.\n     * @returns {Array} Returns the cast property path array.\n     */\n    function castPath(value, object) {\n      if (isArray(value)) {\n        return value;\n      }\n      return isKey(value, object) ? [value] : stringToPath(toString(value));\n    }\n\n    /**\n     * A `baseRest` alias which can be replaced with `identity` by module\n     * replacement plugins.\n     *\n     * @private\n     * @type {Function}\n     * @param {Function} func The function to apply a rest parameter to.\n     * @returns {Function} Returns the new function.\n     */\n    var castRest = baseRest;\n\n    /**\n     * Casts `array` to a slice if it's needed.\n     *\n     * @private\n     * @param {Array} array The array to inspect.\n     * @param {number} start The start position.\n     * @param {number} [end=array.length] The end position.\n     * @returns {Array} Returns the cast slice.\n     */\n    function castSlice(array, start, end) {\n      var length = array.length;\n      end = end === undefined ? length : end;\n      return (!start && end >= length) ? array : baseSlice(array, start, end);\n    }\n\n    /**\n     * A simple wrapper around the global [`clearTimeout`](https://mdn.io/clearTimeout).\n     *\n     * @private\n     * @param {number|Object} id The timer id or timeout object of the timer to clear.\n     */\n    var clearTimeout = ctxClearTimeout || function(id) {\n      return root.clearTimeout(id);\n    };\n\n    /**\n     * Creates a clone of  `buffer`.\n     *\n     * @private\n     * @param {Buffer} buffer The buffer to clone.\n     * @param {boolean} [isDeep] Specify a deep clone.\n     * @returns {Buffer} Returns the cloned buffer.\n     */\n    function cloneBuffer(buffer, isDeep) {\n      if (isDeep) {\n        return buffer.slice();\n      }\n      var length = buffer.length,\n          result = allocUnsafe ? allocUnsafe(length) : new buffer.constructor(length);\n\n      buffer.copy(result);\n      return result;\n    }\n\n    /**\n     * Creates a clone of `arrayBuffer`.\n     *\n     * @private\n     * @param {ArrayBuffer} arrayBuffer The array buffer to clone.\n     * @returns {ArrayBuffer} Returns the cloned array buffer.\n     */\n    function cloneArrayBuffer(arrayBuffer) {\n      var result = new arrayBuffer.constructor(arrayBuffer.byteLength);\n      new Uint8Array(result).set(new Uint8Array(arrayBuffer));\n      return result;\n    }\n\n    /**\n     * Creates a clone of `dataView`.\n     *\n     * @private\n     * @param {Object} dataView The data view to clone.\n     * @param {boolean} [isDeep] Specify a deep clone.\n     * @returns {Object} Returns the cloned data view.\n     */\n    function cloneDataView(dataView, isDeep) {\n      var buffer = isDeep ? cloneArrayBuffer(dataView.buffer) : dataView.buffer;\n      return new dataView.constructor(buffer, dataView.byteOffset, dataView.byteLength);\n    }\n\n    /**\n     * Creates a clone of `regexp`.\n     *\n     * @private\n     * @param {Object} regexp The regexp to clone.\n     * @returns {Object} Returns the cloned regexp.\n     */\n    function cloneRegExp(regexp) {\n      var result = new regexp.constructor(regexp.source, reFlags.exec(regexp));\n      result.lastIndex = regexp.lastIndex;\n      return result;\n    }\n\n    /**\n     * Creates a clone of the `symbol` object.\n     *\n     * @private\n     * @param {Object} symbol The symbol object to clone.\n     * @returns {Object} Returns the cloned symbol object.\n     */\n    function cloneSymbol(symbol) {\n      return symbolValueOf ? Object(symbolValueOf.call(symbol)) : {};\n    }\n\n    /**\n     * Creates a clone of `typedArray`.\n     *\n     * @private\n     * @param {Object} typedArray The typed array to clone.\n     * @param {boolean} [isDeep] Specify a deep clone.\n     * @returns {Object} Returns the cloned typed array.\n     */\n    function cloneTypedArray(typedArray, isDeep) {\n      var buffer = isDeep ? cloneArrayBuffer(typedArray.buffer) : typedArray.buffer;\n      return new typedArray.constructor(buffer, typedArray.byteOffset, typedArray.length);\n    }\n\n    /**\n     * Compares values to sort them in ascending order.\n     *\n     * @private\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {number} Returns the sort order indicator for `value`.\n     */\n    function compareAscending(value, other) {\n      if (value !== other) {\n        var valIsDefined = value !== undefined,\n            valIsNull = value === null,\n            valIsReflexive = value === value,\n            valIsSymbol = isSymbol(value);\n\n        var othIsDefined = other !== undefined,\n            othIsNull = other === null,\n            othIsReflexive = other === other,\n            othIsSymbol = isSymbol(other);\n\n        if ((!othIsNull && !othIsSymbol && !valIsSymbol && value > other) ||\n            (valIsSymbol && othIsDefined && othIsReflexive && !othIsNull && !othIsSymbol) ||\n            (valIsNull && othIsDefined && othIsReflexive) ||\n            (!valIsDefined && othIsReflexive) ||\n            !valIsReflexive) {\n          return 1;\n        }\n        if ((!valIsNull && !valIsSymbol && !othIsSymbol && value < other) ||\n            (othIsSymbol && valIsDefined && valIsReflexive && !valIsNull && !valIsSymbol) ||\n            (othIsNull && valIsDefined && valIsReflexive) ||\n            (!othIsDefined && valIsReflexive) ||\n            !othIsReflexive) {\n          return -1;\n        }\n      }\n      return 0;\n    }\n\n    /**\n     * Used by `_.orderBy` to compare multiple properties of a value to another\n     * and stable sort them.\n     *\n     * If `orders` is unspecified, all values are sorted in ascending order. Otherwise,\n     * specify an order of \"desc\" for descending or \"asc\" for ascending sort order\n     * of corresponding values.\n     *\n     * @private\n     * @param {Object} object The object to compare.\n     * @param {Object} other The other object to compare.\n     * @param {boolean[]|string[]} orders The order to sort by for each property.\n     * @returns {number} Returns the sort order indicator for `object`.\n     */\n    function compareMultiple(object, other, orders) {\n      var index = -1,\n          objCriteria = object.criteria,\n          othCriteria = other.criteria,\n          length = objCriteria.length,\n          ordersLength = orders.length;\n\n      while (++index < length) {\n        var result = compareAscending(objCriteria[index], othCriteria[index]);\n        if (result) {\n          if (index >= ordersLength) {\n            return result;\n          }\n          var order = orders[index];\n          return result * (order == 'desc' ? -1 : 1);\n        }\n      }\n      // Fixes an `Array#sort` bug in the JS engine embedded in Adobe applications\n      // that causes it, under certain circumstances, to provide the same value for\n      // `object` and `other`. See https://github.com/jashkenas/underscore/pull/1247\n      // for more details.\n      //\n      // This also ensures a stable sort in V8 and other engines.\n      // See https://bugs.chromium.org/p/v8/issues/detail?id=90 for more details.\n      return object.index - other.index;\n    }\n\n    /**\n     * Creates an array that is the composition of partially applied arguments,\n     * placeholders, and provided arguments into a single array of arguments.\n     *\n     * @private\n     * @param {Array} args The provided arguments.\n     * @param {Array} partials The arguments to prepend to those provided.\n     * @param {Array} holders The `partials` placeholder indexes.\n     * @params {boolean} [isCurried] Specify composing for a curried function.\n     * @returns {Array} Returns the new array of composed arguments.\n     */\n    function composeArgs(args, partials, holders, isCurried) {\n      var argsIndex = -1,\n          argsLength = args.length,\n          holdersLength = holders.length,\n          leftIndex = -1,\n          leftLength = partials.length,\n          rangeLength = nativeMax(argsLength - holdersLength, 0),\n          result = Array(leftLength + rangeLength),\n          isUncurried = !isCurried;\n\n      while (++leftIndex < leftLength) {\n        result[leftIndex] = partials[leftIndex];\n      }\n      while (++argsIndex < holdersLength) {\n        if (isUncurried || argsIndex < argsLength) {\n          result[holders[argsIndex]] = args[argsIndex];\n        }\n      }\n      while (rangeLength--) {\n        result[leftIndex++] = args[argsIndex++];\n      }\n      return result;\n    }\n\n    /**\n     * This function is like `composeArgs` except that the arguments composition\n     * is tailored for `_.partialRight`.\n     *\n     * @private\n     * @param {Array} args The provided arguments.\n     * @param {Array} partials The arguments to append to those provided.\n     * @param {Array} holders The `partials` placeholder indexes.\n     * @params {boolean} [isCurried] Specify composing for a curried function.\n     * @returns {Array} Returns the new array of composed arguments.\n     */\n    function composeArgsRight(args, partials, holders, isCurried) {\n      var argsIndex = -1,\n          argsLength = args.length,\n          holdersIndex = -1,\n          holdersLength = holders.length,\n          rightIndex = -1,\n          rightLength = partials.length,\n          rangeLength = nativeMax(argsLength - holdersLength, 0),\n          result = Array(rangeLength + rightLength),\n          isUncurried = !isCurried;\n\n      while (++argsIndex < rangeLength) {\n        result[argsIndex] = args[argsIndex];\n      }\n      var offset = argsIndex;\n      while (++rightIndex < rightLength) {\n        result[offset + rightIndex] = partials[rightIndex];\n      }\n      while (++holdersIndex < holdersLength) {\n        if (isUncurried || argsIndex < argsLength) {\n          result[offset + holders[holdersIndex]] = args[argsIndex++];\n        }\n      }\n      return result;\n    }\n\n    /**\n     * Copies the values of `source` to `array`.\n     *\n     * @private\n     * @param {Array} source The array to copy values from.\n     * @param {Array} [array=[]] The array to copy values to.\n     * @returns {Array} Returns `array`.\n     */\n    function copyArray(source, array) {\n      var index = -1,\n          length = source.length;\n\n      array || (array = Array(length));\n      while (++index < length) {\n        array[index] = source[index];\n      }\n      return array;\n    }\n\n    /**\n     * Copies properties of `source` to `object`.\n     *\n     * @private\n     * @param {Object} source The object to copy properties from.\n     * @param {Array} props The property identifiers to copy.\n     * @param {Object} [object={}] The object to copy properties to.\n     * @param {Function} [customizer] The function to customize copied values.\n     * @returns {Object} Returns `object`.\n     */\n    function copyObject(source, props, object, customizer) {\n      var isNew = !object;\n      object || (object = {});\n\n      var index = -1,\n          length = props.length;\n\n      while (++index < length) {\n        var key = props[index];\n\n        var newValue = customizer\n          ? customizer(object[key], source[key], key, object, source)\n          : undefined;\n\n        if (newValue === undefined) {\n          newValue = source[key];\n        }\n        if (isNew) {\n          baseAssignValue(object, key, newValue);\n        } else {\n          assignValue(object, key, newValue);\n        }\n      }\n      return object;\n    }\n\n    /**\n     * Copies own symbols of `source` to `object`.\n     *\n     * @private\n     * @param {Object} source The object to copy symbols from.\n     * @param {Object} [object={}] The object to copy symbols to.\n     * @returns {Object} Returns `object`.\n     */\n    function copySymbols(source, object) {\n      return copyObject(source, getSymbols(source), object);\n    }\n\n    /**\n     * Copies own and inherited symbols of `source` to `object`.\n     *\n     * @private\n     * @param {Object} source The object to copy symbols from.\n     * @param {Object} [object={}] The object to copy symbols to.\n     * @returns {Object} Returns `object`.\n     */\n    function copySymbolsIn(source, object) {\n      return copyObject(source, getSymbolsIn(source), object);\n    }\n\n    /**\n     * Creates a function like `_.groupBy`.\n     *\n     * @private\n     * @param {Function} setter The function to set accumulator values.\n     * @param {Function} [initializer] The accumulator object initializer.\n     * @returns {Function} Returns the new aggregator function.\n     */\n    function createAggregator(setter, initializer) {\n      return function(collection, iteratee) {\n        var func = isArray(collection) ? arrayAggregator : baseAggregator,\n            accumulator = initializer ? initializer() : {};\n\n        return func(collection, setter, getIteratee(iteratee, 2), accumulator);\n      };\n    }\n\n    /**\n     * Creates a function like `_.assign`.\n     *\n     * @private\n     * @param {Function} assigner The function to assign values.\n     * @returns {Function} Returns the new assigner function.\n     */\n    function createAssigner(assigner) {\n      return baseRest(function(object, sources) {\n        var index = -1,\n            length = sources.length,\n            customizer = length > 1 ? sources[length - 1] : undefined,\n            guard = length > 2 ? sources[2] : undefined;\n\n        customizer = (assigner.length > 3 && typeof customizer == 'function')\n          ? (length--, customizer)\n          : undefined;\n\n        if (guard && isIterateeCall(sources[0], sources[1], guard)) {\n          customizer = length < 3 ? undefined : customizer;\n          length = 1;\n        }\n        object = Object(object);\n        while (++index < length) {\n          var source = sources[index];\n          if (source) {\n            assigner(object, source, index, customizer);\n          }\n        }\n        return object;\n      });\n    }\n\n    /**\n     * Creates a `baseEach` or `baseEachRight` function.\n     *\n     * @private\n     * @param {Function} eachFunc The function to iterate over a collection.\n     * @param {boolean} [fromRight] Specify iterating from right to left.\n     * @returns {Function} Returns the new base function.\n     */\n    function createBaseEach(eachFunc, fromRight) {\n      return function(collection, iteratee) {\n        if (collection == null) {\n          return collection;\n        }\n        if (!isArrayLike(collection)) {\n          return eachFunc(collection, iteratee);\n        }\n        var length = collection.length,\n            index = fromRight ? length : -1,\n            iterable = Object(collection);\n\n        while ((fromRight ? index-- : ++index < length)) {\n          if (iteratee(iterable[index], index, iterable) === false) {\n            break;\n          }\n        }\n        return collection;\n      };\n    }\n\n    /**\n     * Creates a base function for methods like `_.forIn` and `_.forOwn`.\n     *\n     * @private\n     * @param {boolean} [fromRight] Specify iterating from right to left.\n     * @returns {Function} Returns the new base function.\n     */\n    function createBaseFor(fromRight) {\n      return function(object, iteratee, keysFunc) {\n        var index = -1,\n            iterable = Object(object),\n            props = keysFunc(object),\n            length = props.length;\n\n        while (length--) {\n          var key = props[fromRight ? length : ++index];\n          if (iteratee(iterable[key], key, iterable) === false) {\n            break;\n          }\n        }\n        return object;\n      };\n    }\n\n    /**\n     * Creates a function that wraps `func` to invoke it with the optional `this`\n     * binding of `thisArg`.\n     *\n     * @private\n     * @param {Function} func The function to wrap.\n     * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n     * @param {*} [thisArg] The `this` binding of `func`.\n     * @returns {Function} Returns the new wrapped function.\n     */\n    function createBind(func, bitmask, thisArg) {\n      var isBind = bitmask & WRAP_BIND_FLAG,\n          Ctor = createCtor(func);\n\n      function wrapper() {\n        var fn = (this && this !== root && this instanceof wrapper) ? Ctor : func;\n        return fn.apply(isBind ? thisArg : this, arguments);\n      }\n      return wrapper;\n    }\n\n    /**\n     * Creates a function like `_.lowerFirst`.\n     *\n     * @private\n     * @param {string} methodName The name of the `String` case method to use.\n     * @returns {Function} Returns the new case function.\n     */\n    function createCaseFirst(methodName) {\n      return function(string) {\n        string = toString(string);\n\n        var strSymbols = hasUnicode(string)\n          ? stringToArray(string)\n          : undefined;\n\n        var chr = strSymbols\n          ? strSymbols[0]\n          : string.charAt(0);\n\n        var trailing = strSymbols\n          ? castSlice(strSymbols, 1).join('')\n          : string.slice(1);\n\n        return chr[methodName]() + trailing;\n      };\n    }\n\n    /**\n     * Creates a function like `_.camelCase`.\n     *\n     * @private\n     * @param {Function} callback The function to combine each word.\n     * @returns {Function} Returns the new compounder function.\n     */\n    function createCompounder(callback) {\n      return function(string) {\n        return arrayReduce(words(deburr(string).replace(reApos, '')), callback, '');\n      };\n    }\n\n    /**\n     * Creates a function that produces an instance of `Ctor` regardless of\n     * whether it was invoked as part of a `new` expression or by `call` or `apply`.\n     *\n     * @private\n     * @param {Function} Ctor The constructor to wrap.\n     * @returns {Function} Returns the new wrapped function.\n     */\n    function createCtor(Ctor) {\n      return function() {\n        // Use a `switch` statement to work with class constructors. See\n        // http://ecma-international.org/ecma-262/7.0/#sec-ecmascript-function-objects-call-thisargument-argumentslist\n        // for more details.\n        var args = arguments;\n        switch (args.length) {\n          case 0: return new Ctor;\n          case 1: return new Ctor(args[0]);\n          case 2: return new Ctor(args[0], args[1]);\n          case 3: return new Ctor(args[0], args[1], args[2]);\n          case 4: return new Ctor(args[0], args[1], args[2], args[3]);\n          case 5: return new Ctor(args[0], args[1], args[2], args[3], args[4]);\n          case 6: return new Ctor(args[0], args[1], args[2], args[3], args[4], args[5]);\n          case 7: return new Ctor(args[0], args[1], args[2], args[3], args[4], args[5], args[6]);\n        }\n        var thisBinding = baseCreate(Ctor.prototype),\n            result = Ctor.apply(thisBinding, args);\n\n        // Mimic the constructor's `return` behavior.\n        // See https://es5.github.io/#x13.2.2 for more details.\n        return isObject(result) ? result : thisBinding;\n      };\n    }\n\n    /**\n     * Creates a function that wraps `func` to enable currying.\n     *\n     * @private\n     * @param {Function} func The function to wrap.\n     * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n     * @param {number} arity The arity of `func`.\n     * @returns {Function} Returns the new wrapped function.\n     */\n    function createCurry(func, bitmask, arity) {\n      var Ctor = createCtor(func);\n\n      function wrapper() {\n        var length = arguments.length,\n            args = Array(length),\n            index = length,\n            placeholder = getHolder(wrapper);\n\n        while (index--) {\n          args[index] = arguments[index];\n        }\n        var holders = (length < 3 && args[0] !== placeholder && args[length - 1] !== placeholder)\n          ? []\n          : replaceHolders(args, placeholder);\n\n        length -= holders.length;\n        if (length < arity) {\n          return createRecurry(\n            func, bitmask, createHybrid, wrapper.placeholder, undefined,\n            args, holders, undefined, undefined, arity - length);\n        }\n        var fn = (this && this !== root && this instanceof wrapper) ? Ctor : func;\n        return apply(fn, this, args);\n      }\n      return wrapper;\n    }\n\n    /**\n     * Creates a `_.find` or `_.findLast` function.\n     *\n     * @private\n     * @param {Function} findIndexFunc The function to find the collection index.\n     * @returns {Function} Returns the new find function.\n     */\n    function createFind(findIndexFunc) {\n      return function(collection, predicate, fromIndex) {\n        var iterable = Object(collection);\n        if (!isArrayLike(collection)) {\n          var iteratee = getIteratee(predicate, 3);\n          collection = keys(collection);\n          predicate = function(key) { return iteratee(iterable[key], key, iterable); };\n        }\n        var index = findIndexFunc(collection, predicate, fromIndex);\n        return index > -1 ? iterable[iteratee ? collection[index] : index] : undefined;\n      };\n    }\n\n    /**\n     * Creates a `_.flow` or `_.flowRight` function.\n     *\n     * @private\n     * @param {boolean} [fromRight] Specify iterating from right to left.\n     * @returns {Function} Returns the new flow function.\n     */\n    function createFlow(fromRight) {\n      return flatRest(function(funcs) {\n        var length = funcs.length,\n            index = length,\n            prereq = LodashWrapper.prototype.thru;\n\n        if (fromRight) {\n          funcs.reverse();\n        }\n        while (index--) {\n          var func = funcs[index];\n          if (typeof func != 'function') {\n            throw new TypeError(FUNC_ERROR_TEXT);\n          }\n          if (prereq && !wrapper && getFuncName(func) == 'wrapper') {\n            var wrapper = new LodashWrapper([], true);\n          }\n        }\n        index = wrapper ? index : length;\n        while (++index < length) {\n          func = funcs[index];\n\n          var funcName = getFuncName(func),\n              data = funcName == 'wrapper' ? getData(func) : undefined;\n\n          if (data && isLaziable(data[0]) &&\n                data[1] == (WRAP_ARY_FLAG | WRAP_CURRY_FLAG | WRAP_PARTIAL_FLAG | WRAP_REARG_FLAG) &&\n                !data[4].length && data[9] == 1\n              ) {\n            wrapper = wrapper[getFuncName(data[0])].apply(wrapper, data[3]);\n          } else {\n            wrapper = (func.length == 1 && isLaziable(func))\n              ? wrapper[funcName]()\n              : wrapper.thru(func);\n          }\n        }\n        return function() {\n          var args = arguments,\n              value = args[0];\n\n          if (wrapper && args.length == 1 && isArray(value)) {\n            return wrapper.plant(value).value();\n          }\n          var index = 0,\n              result = length ? funcs[index].apply(this, args) : value;\n\n          while (++index < length) {\n            result = funcs[index].call(this, result);\n          }\n          return result;\n        };\n      });\n    }\n\n    /**\n     * Creates a function that wraps `func` to invoke it with optional `this`\n     * binding of `thisArg`, partial application, and currying.\n     *\n     * @private\n     * @param {Function|string} func The function or method name to wrap.\n     * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n     * @param {*} [thisArg] The `this` binding of `func`.\n     * @param {Array} [partials] The arguments to prepend to those provided to\n     *  the new function.\n     * @param {Array} [holders] The `partials` placeholder indexes.\n     * @param {Array} [partialsRight] The arguments to append to those provided\n     *  to the new function.\n     * @param {Array} [holdersRight] The `partialsRight` placeholder indexes.\n     * @param {Array} [argPos] The argument positions of the new function.\n     * @param {number} [ary] The arity cap of `func`.\n     * @param {number} [arity] The arity of `func`.\n     * @returns {Function} Returns the new wrapped function.\n     */\n    function createHybrid(func, bitmask, thisArg, partials, holders, partialsRight, holdersRight, argPos, ary, arity) {\n      var isAry = bitmask & WRAP_ARY_FLAG,\n          isBind = bitmask & WRAP_BIND_FLAG,\n          isBindKey = bitmask & WRAP_BIND_KEY_FLAG,\n          isCurried = bitmask & (WRAP_CURRY_FLAG | WRAP_CURRY_RIGHT_FLAG),\n          isFlip = bitmask & WRAP_FLIP_FLAG,\n          Ctor = isBindKey ? undefined : createCtor(func);\n\n      function wrapper() {\n        var length = arguments.length,\n            args = Array(length),\n            index = length;\n\n        while (index--) {\n          args[index] = arguments[index];\n        }\n        if (isCurried) {\n          var placeholder = getHolder(wrapper),\n              holdersCount = countHolders(args, placeholder);\n        }\n        if (partials) {\n          args = composeArgs(args, partials, holders, isCurried);\n        }\n        if (partialsRight) {\n          args = composeArgsRight(args, partialsRight, holdersRight, isCurried);\n        }\n        length -= holdersCount;\n        if (isCurried && length < arity) {\n          var newHolders = replaceHolders(args, placeholder);\n          return createRecurry(\n            func, bitmask, createHybrid, wrapper.placeholder, thisArg,\n            args, newHolders, argPos, ary, arity - length\n          );\n        }\n        var thisBinding = isBind ? thisArg : this,\n            fn = isBindKey ? thisBinding[func] : func;\n\n        length = args.length;\n        if (argPos) {\n          args = reorder(args, argPos);\n        } else if (isFlip && length > 1) {\n          args.reverse();\n        }\n        if (isAry && ary < length) {\n          args.length = ary;\n        }\n        if (this && this !== root && this instanceof wrapper) {\n          fn = Ctor || createCtor(fn);\n        }\n        return fn.apply(thisBinding, args);\n      }\n      return wrapper;\n    }\n\n    /**\n     * Creates a function like `_.invertBy`.\n     *\n     * @private\n     * @param {Function} setter The function to set accumulator values.\n     * @param {Function} toIteratee The function to resolve iteratees.\n     * @returns {Function} Returns the new inverter function.\n     */\n    function createInverter(setter, toIteratee) {\n      return function(object, iteratee) {\n        return baseInverter(object, setter, toIteratee(iteratee), {});\n      };\n    }\n\n    /**\n     * Creates a function that performs a mathematical operation on two values.\n     *\n     * @private\n     * @param {Function} operator The function to perform the operation.\n     * @param {number} [defaultValue] The value used for `undefined` arguments.\n     * @returns {Function} Returns the new mathematical operation function.\n     */\n    function createMathOperation(operator, defaultValue) {\n      return function(value, other) {\n        var result;\n        if (value === undefined && other === undefined) {\n          return defaultValue;\n        }\n        if (value !== undefined) {\n          result = value;\n        }\n        if (other !== undefined) {\n          if (result === undefined) {\n            return other;\n          }\n          if (typeof value == 'string' || typeof other == 'string') {\n            value = baseToString(value);\n            other = baseToString(other);\n          } else {\n            value = baseToNumber(value);\n            other = baseToNumber(other);\n          }\n          result = operator(value, other);\n        }\n        return result;\n      };\n    }\n\n    /**\n     * Creates a function like `_.over`.\n     *\n     * @private\n     * @param {Function} arrayFunc The function to iterate over iteratees.\n     * @returns {Function} Returns the new over function.\n     */\n    function createOver(arrayFunc) {\n      return flatRest(function(iteratees) {\n        iteratees = arrayMap(iteratees, baseUnary(getIteratee()));\n        return baseRest(function(args) {\n          var thisArg = this;\n          return arrayFunc(iteratees, function(iteratee) {\n            return apply(iteratee, thisArg, args);\n          });\n        });\n      });\n    }\n\n    /**\n     * Creates the padding for `string` based on `length`. The `chars` string\n     * is truncated if the number of characters exceeds `length`.\n     *\n     * @private\n     * @param {number} length The padding length.\n     * @param {string} [chars=' '] The string used as padding.\n     * @returns {string} Returns the padding for `string`.\n     */\n    function createPadding(length, chars) {\n      chars = chars === undefined ? ' ' : baseToString(chars);\n\n      var charsLength = chars.length;\n      if (charsLength < 2) {\n        return charsLength ? baseRepeat(chars, length) : chars;\n      }\n      var result = baseRepeat(chars, nativeCeil(length / stringSize(chars)));\n      return hasUnicode(chars)\n        ? castSlice(stringToArray(result), 0, length).join('')\n        : result.slice(0, length);\n    }\n\n    /**\n     * Creates a function that wraps `func` to invoke it with the `this` binding\n     * of `thisArg` and `partials` prepended to the arguments it receives.\n     *\n     * @private\n     * @param {Function} func The function to wrap.\n     * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n     * @param {*} thisArg The `this` binding of `func`.\n     * @param {Array} partials The arguments to prepend to those provided to\n     *  the new function.\n     * @returns {Function} Returns the new wrapped function.\n     */\n    function createPartial(func, bitmask, thisArg, partials) {\n      var isBind = bitmask & WRAP_BIND_FLAG,\n          Ctor = createCtor(func);\n\n      function wrapper() {\n        var argsIndex = -1,\n            argsLength = arguments.length,\n            leftIndex = -1,\n            leftLength = partials.length,\n            args = Array(leftLength + argsLength),\n            fn = (this && this !== root && this instanceof wrapper) ? Ctor : func;\n\n        while (++leftIndex < leftLength) {\n          args[leftIndex] = partials[leftIndex];\n        }\n        while (argsLength--) {\n          args[leftIndex++] = arguments[++argsIndex];\n        }\n        return apply(fn, isBind ? thisArg : this, args);\n      }\n      return wrapper;\n    }\n\n    /**\n     * Creates a `_.range` or `_.rangeRight` function.\n     *\n     * @private\n     * @param {boolean} [fromRight] Specify iterating from right to left.\n     * @returns {Function} Returns the new range function.\n     */\n    function createRange(fromRight) {\n      return function(start, end, step) {\n        if (step && typeof step != 'number' && isIterateeCall(start, end, step)) {\n          end = step = undefined;\n        }\n        // Ensure the sign of `-0` is preserved.\n        start = toFinite(start);\n        if (end === undefined) {\n          end = start;\n          start = 0;\n        } else {\n          end = toFinite(end);\n        }\n        step = step === undefined ? (start < end ? 1 : -1) : toFinite(step);\n        return baseRange(start, end, step, fromRight);\n      };\n    }\n\n    /**\n     * Creates a function that performs a relational operation on two values.\n     *\n     * @private\n     * @param {Function} operator The function to perform the operation.\n     * @returns {Function} Returns the new relational operation function.\n     */\n    function createRelationalOperation(operator) {\n      return function(value, other) {\n        if (!(typeof value == 'string' && typeof other == 'string')) {\n          value = toNumber(value);\n          other = toNumber(other);\n        }\n        return operator(value, other);\n      };\n    }\n\n    /**\n     * Creates a function that wraps `func` to continue currying.\n     *\n     * @private\n     * @param {Function} func The function to wrap.\n     * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n     * @param {Function} wrapFunc The function to create the `func` wrapper.\n     * @param {*} placeholder The placeholder value.\n     * @param {*} [thisArg] The `this` binding of `func`.\n     * @param {Array} [partials] The arguments to prepend to those provided to\n     *  the new function.\n     * @param {Array} [holders] The `partials` placeholder indexes.\n     * @param {Array} [argPos] The argument positions of the new function.\n     * @param {number} [ary] The arity cap of `func`.\n     * @param {number} [arity] The arity of `func`.\n     * @returns {Function} Returns the new wrapped function.\n     */\n    function createRecurry(func, bitmask, wrapFunc, placeholder, thisArg, partials, holders, argPos, ary, arity) {\n      var isCurry = bitmask & WRAP_CURRY_FLAG,\n          newHolders = isCurry ? holders : undefined,\n          newHoldersRight = isCurry ? undefined : holders,\n          newPartials = isCurry ? partials : undefined,\n          newPartialsRight = isCurry ? undefined : partials;\n\n      bitmask |= (isCurry ? WRAP_PARTIAL_FLAG : WRAP_PARTIAL_RIGHT_FLAG);\n      bitmask &= ~(isCurry ? WRAP_PARTIAL_RIGHT_FLAG : WRAP_PARTIAL_FLAG);\n\n      if (!(bitmask & WRAP_CURRY_BOUND_FLAG)) {\n        bitmask &= ~(WRAP_BIND_FLAG | WRAP_BIND_KEY_FLAG);\n      }\n      var newData = [\n        func, bitmask, thisArg, newPartials, newHolders, newPartialsRight,\n        newHoldersRight, argPos, ary, arity\n      ];\n\n      var result = wrapFunc.apply(undefined, newData);\n      if (isLaziable(func)) {\n        setData(result, newData);\n      }\n      result.placeholder = placeholder;\n      return setWrapToString(result, func, bitmask);\n    }\n\n    /**\n     * Creates a function like `_.round`.\n     *\n     * @private\n     * @param {string} methodName The name of the `Math` method to use when rounding.\n     * @returns {Function} Returns the new round function.\n     */\n    function createRound(methodName) {\n      var func = Math[methodName];\n      return function(number, precision) {\n        number = toNumber(number);\n        precision = precision == null ? 0 : nativeMin(toInteger(precision), 292);\n        if (precision && nativeIsFinite(number)) {\n          // Shift with exponential notation to avoid floating-point issues.\n          // See [MDN](https://mdn.io/round#Examples) for more details.\n          var pair = (toString(number) + 'e').split('e'),\n              value = func(pair[0] + 'e' + (+pair[1] + precision));\n\n          pair = (toString(value) + 'e').split('e');\n          return +(pair[0] + 'e' + (+pair[1] - precision));\n        }\n        return func(number);\n      };\n    }\n\n    /**\n     * Creates a set object of `values`.\n     *\n     * @private\n     * @param {Array} values The values to add to the set.\n     * @returns {Object} Returns the new set.\n     */\n    var createSet = !(Set && (1 / setToArray(new Set([,-0]))[1]) == INFINITY) ? noop : function(values) {\n      return new Set(values);\n    };\n\n    /**\n     * Creates a `_.toPairs` or `_.toPairsIn` function.\n     *\n     * @private\n     * @param {Function} keysFunc The function to get the keys of a given object.\n     * @returns {Function} Returns the new pairs function.\n     */\n    function createToPairs(keysFunc) {\n      return function(object) {\n        var tag = getTag(object);\n        if (tag == mapTag) {\n          return mapToArray(object);\n        }\n        if (tag == setTag) {\n          return setToPairs(object);\n        }\n        return baseToPairs(object, keysFunc(object));\n      };\n    }\n\n    /**\n     * Creates a function that either curries or invokes `func` with optional\n     * `this` binding and partially applied arguments.\n     *\n     * @private\n     * @param {Function|string} func The function or method name to wrap.\n     * @param {number} bitmask The bitmask flags.\n     *    1 - `_.bind`\n     *    2 - `_.bindKey`\n     *    4 - `_.curry` or `_.curryRight` of a bound function\n     *    8 - `_.curry`\n     *   16 - `_.curryRight`\n     *   32 - `_.partial`\n     *   64 - `_.partialRight`\n     *  128 - `_.rearg`\n     *  256 - `_.ary`\n     *  512 - `_.flip`\n     * @param {*} [thisArg] The `this` binding of `func`.\n     * @param {Array} [partials] The arguments to be partially applied.\n     * @param {Array} [holders] The `partials` placeholder indexes.\n     * @param {Array} [argPos] The argument positions of the new function.\n     * @param {number} [ary] The arity cap of `func`.\n     * @param {number} [arity] The arity of `func`.\n     * @returns {Function} Returns the new wrapped function.\n     */\n    function createWrap(func, bitmask, thisArg, partials, holders, argPos, ary, arity) {\n      var isBindKey = bitmask & WRAP_BIND_KEY_FLAG;\n      if (!isBindKey && typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      var length = partials ? partials.length : 0;\n      if (!length) {\n        bitmask &= ~(WRAP_PARTIAL_FLAG | WRAP_PARTIAL_RIGHT_FLAG);\n        partials = holders = undefined;\n      }\n      ary = ary === undefined ? ary : nativeMax(toInteger(ary), 0);\n      arity = arity === undefined ? arity : toInteger(arity);\n      length -= holders ? holders.length : 0;\n\n      if (bitmask & WRAP_PARTIAL_RIGHT_FLAG) {\n        var partialsRight = partials,\n            holdersRight = holders;\n\n        partials = holders = undefined;\n      }\n      var data = isBindKey ? undefined : getData(func);\n\n      var newData = [\n        func, bitmask, thisArg, partials, holders, partialsRight, holdersRight,\n        argPos, ary, arity\n      ];\n\n      if (data) {\n        mergeData(newData, data);\n      }\n      func = newData[0];\n      bitmask = newData[1];\n      thisArg = newData[2];\n      partials = newData[3];\n      holders = newData[4];\n      arity = newData[9] = newData[9] === undefined\n        ? (isBindKey ? 0 : func.length)\n        : nativeMax(newData[9] - length, 0);\n\n      if (!arity && bitmask & (WRAP_CURRY_FLAG | WRAP_CURRY_RIGHT_FLAG)) {\n        bitmask &= ~(WRAP_CURRY_FLAG | WRAP_CURRY_RIGHT_FLAG);\n      }\n      if (!bitmask || bitmask == WRAP_BIND_FLAG) {\n        var result = createBind(func, bitmask, thisArg);\n      } else if (bitmask == WRAP_CURRY_FLAG || bitmask == WRAP_CURRY_RIGHT_FLAG) {\n        result = createCurry(func, bitmask, arity);\n      } else if ((bitmask == WRAP_PARTIAL_FLAG || bitmask == (WRAP_BIND_FLAG | WRAP_PARTIAL_FLAG)) && !holders.length) {\n        result = createPartial(func, bitmask, thisArg, partials);\n      } else {\n        result = createHybrid.apply(undefined, newData);\n      }\n      var setter = data ? baseSetData : setData;\n      return setWrapToString(setter(result, newData), func, bitmask);\n    }\n\n    /**\n     * Used by `_.defaults` to customize its `_.assignIn` use to assign properties\n     * of source objects to the destination object for all destination properties\n     * that resolve to `undefined`.\n     *\n     * @private\n     * @param {*} objValue The destination value.\n     * @param {*} srcValue The source value.\n     * @param {string} key The key of the property to assign.\n     * @param {Object} object The parent object of `objValue`.\n     * @returns {*} Returns the value to assign.\n     */\n    function customDefaultsAssignIn(objValue, srcValue, key, object) {\n      if (objValue === undefined ||\n          (eq(objValue, objectProto[key]) && !hasOwnProperty.call(object, key))) {\n        return srcValue;\n      }\n      return objValue;\n    }\n\n    /**\n     * Used by `_.defaultsDeep` to customize its `_.merge` use to merge source\n     * objects into destination objects that are passed thru.\n     *\n     * @private\n     * @param {*} objValue The destination value.\n     * @param {*} srcValue The source value.\n     * @param {string} key The key of the property to merge.\n     * @param {Object} object The parent object of `objValue`.\n     * @param {Object} source The parent object of `srcValue`.\n     * @param {Object} [stack] Tracks traversed source values and their merged\n     *  counterparts.\n     * @returns {*} Returns the value to assign.\n     */\n    function customDefaultsMerge(objValue, srcValue, key, object, source, stack) {\n      if (isObject(objValue) && isObject(srcValue)) {\n        // Recursively merge objects and arrays (susceptible to call stack limits).\n        stack.set(srcValue, objValue);\n        baseMerge(objValue, srcValue, undefined, customDefaultsMerge, stack);\n        stack['delete'](srcValue);\n      }\n      return objValue;\n    }\n\n    /**\n     * Used by `_.omit` to customize its `_.cloneDeep` use to only clone plain\n     * objects.\n     *\n     * @private\n     * @param {*} value The value to inspect.\n     * @param {string} key The key of the property to inspect.\n     * @returns {*} Returns the uncloned value or `undefined` to defer cloning to `_.cloneDeep`.\n     */\n    function customOmitClone(value) {\n      return isPlainObject(value) ? undefined : value;\n    }\n\n    /**\n     * A specialized version of `baseIsEqualDeep` for arrays with support for\n     * partial deep comparisons.\n     *\n     * @private\n     * @param {Array} array The array to compare.\n     * @param {Array} other The other array to compare.\n     * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n     * @param {Function} customizer The function to customize comparisons.\n     * @param {Function} equalFunc The function to determine equivalents of values.\n     * @param {Object} stack Tracks traversed `array` and `other` objects.\n     * @returns {boolean} Returns `true` if the arrays are equivalent, else `false`.\n     */\n    function equalArrays(array, other, bitmask, customizer, equalFunc, stack) {\n      var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n          arrLength = array.length,\n          othLength = other.length;\n\n      if (arrLength != othLength && !(isPartial && othLength > arrLength)) {\n        return false;\n      }\n      // Check that cyclic values are equal.\n      var arrStacked = stack.get(array);\n      var othStacked = stack.get(other);\n      if (arrStacked && othStacked) {\n        return arrStacked == other && othStacked == array;\n      }\n      var index = -1,\n          result = true,\n          seen = (bitmask & COMPARE_UNORDERED_FLAG) ? new SetCache : undefined;\n\n      stack.set(array, other);\n      stack.set(other, array);\n\n      // Ignore non-index properties.\n      while (++index < arrLength) {\n        var arrValue = array[index],\n            othValue = other[index];\n\n        if (customizer) {\n          var compared = isPartial\n            ? customizer(othValue, arrValue, index, other, array, stack)\n            : customizer(arrValue, othValue, index, array, other, stack);\n        }\n        if (compared !== undefined) {\n          if (compared) {\n            continue;\n          }\n          result = false;\n          break;\n        }\n        // Recursively compare arrays (susceptible to call stack limits).\n        if (seen) {\n          if (!arraySome(other, function(othValue, othIndex) {\n                if (!cacheHas(seen, othIndex) &&\n                    (arrValue === othValue || equalFunc(arrValue, othValue, bitmask, customizer, stack))) {\n                  return seen.push(othIndex);\n                }\n              })) {\n            result = false;\n            break;\n          }\n        } else if (!(\n              arrValue === othValue ||\n                equalFunc(arrValue, othValue, bitmask, customizer, stack)\n            )) {\n          result = false;\n          break;\n        }\n      }\n      stack['delete'](array);\n      stack['delete'](other);\n      return result;\n    }\n\n    /**\n     * A specialized version of `baseIsEqualDeep` for comparing objects of\n     * the same `toStringTag`.\n     *\n     * **Note:** This function only supports comparing values with tags of\n     * `Boolean`, `Date`, `Error`, `Number`, `RegExp`, or `String`.\n     *\n     * @private\n     * @param {Object} object The object to compare.\n     * @param {Object} other The other object to compare.\n     * @param {string} tag The `toStringTag` of the objects to compare.\n     * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n     * @param {Function} customizer The function to customize comparisons.\n     * @param {Function} equalFunc The function to determine equivalents of values.\n     * @param {Object} stack Tracks traversed `object` and `other` objects.\n     * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n     */\n    function equalByTag(object, other, tag, bitmask, customizer, equalFunc, stack) {\n      switch (tag) {\n        case dataViewTag:\n          if ((object.byteLength != other.byteLength) ||\n              (object.byteOffset != other.byteOffset)) {\n            return false;\n          }\n          object = object.buffer;\n          other = other.buffer;\n\n        case arrayBufferTag:\n          if ((object.byteLength != other.byteLength) ||\n              !equalFunc(new Uint8Array(object), new Uint8Array(other))) {\n            return false;\n          }\n          return true;\n\n        case boolTag:\n        case dateTag:\n        case numberTag:\n          // Coerce booleans to `1` or `0` and dates to milliseconds.\n          // Invalid dates are coerced to `NaN`.\n          return eq(+object, +other);\n\n        case errorTag:\n          return object.name == other.name && object.message == other.message;\n\n        case regexpTag:\n        case stringTag:\n          // Coerce regexes to strings and treat strings, primitives and objects,\n          // as equal. See http://www.ecma-international.org/ecma-262/7.0/#sec-regexp.prototype.tostring\n          // for more details.\n          return object == (other + '');\n\n        case mapTag:\n          var convert = mapToArray;\n\n        case setTag:\n          var isPartial = bitmask & COMPARE_PARTIAL_FLAG;\n          convert || (convert = setToArray);\n\n          if (object.size != other.size && !isPartial) {\n            return false;\n          }\n          // Assume cyclic values are equal.\n          var stacked = stack.get(object);\n          if (stacked) {\n            return stacked == other;\n          }\n          bitmask |= COMPARE_UNORDERED_FLAG;\n\n          // Recursively compare objects (susceptible to call stack limits).\n          stack.set(object, other);\n          var result = equalArrays(convert(object), convert(other), bitmask, customizer, equalFunc, stack);\n          stack['delete'](object);\n          return result;\n\n        case symbolTag:\n          if (symbolValueOf) {\n            return symbolValueOf.call(object) == symbolValueOf.call(other);\n          }\n      }\n      return false;\n    }\n\n    /**\n     * A specialized version of `baseIsEqualDeep` for objects with support for\n     * partial deep comparisons.\n     *\n     * @private\n     * @param {Object} object The object to compare.\n     * @param {Object} other The other object to compare.\n     * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n     * @param {Function} customizer The function to customize comparisons.\n     * @param {Function} equalFunc The function to determine equivalents of values.\n     * @param {Object} stack Tracks traversed `object` and `other` objects.\n     * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n     */\n    function equalObjects(object, other, bitmask, customizer, equalFunc, stack) {\n      var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n          objProps = getAllKeys(object),\n          objLength = objProps.length,\n          othProps = getAllKeys(other),\n          othLength = othProps.length;\n\n      if (objLength != othLength && !isPartial) {\n        return false;\n      }\n      var index = objLength;\n      while (index--) {\n        var key = objProps[index];\n        if (!(isPartial ? key in other : hasOwnProperty.call(other, key))) {\n          return false;\n        }\n      }\n      // Check that cyclic values are equal.\n      var objStacked = stack.get(object);\n      var othStacked = stack.get(other);\n      if (objStacked && othStacked) {\n        return objStacked == other && othStacked == object;\n      }\n      var result = true;\n      stack.set(object, other);\n      stack.set(other, object);\n\n      var skipCtor = isPartial;\n      while (++index < objLength) {\n        key = objProps[index];\n        var objValue = object[key],\n            othValue = other[key];\n\n        if (customizer) {\n          var compared = isPartial\n            ? customizer(othValue, objValue, key, other, object, stack)\n            : customizer(objValue, othValue, key, object, other, stack);\n        }\n        // Recursively compare objects (susceptible to call stack limits).\n        if (!(compared === undefined\n              ? (objValue === othValue || equalFunc(objValue, othValue, bitmask, customizer, stack))\n              : compared\n            )) {\n          result = false;\n          break;\n        }\n        skipCtor || (skipCtor = key == 'constructor');\n      }\n      if (result && !skipCtor) {\n        var objCtor = object.constructor,\n            othCtor = other.constructor;\n\n        // Non `Object` object instances with different constructors are not equal.\n        if (objCtor != othCtor &&\n            ('constructor' in object && 'constructor' in other) &&\n            !(typeof objCtor == 'function' && objCtor instanceof objCtor &&\n              typeof othCtor == 'function' && othCtor instanceof othCtor)) {\n          result = false;\n        }\n      }\n      stack['delete'](object);\n      stack['delete'](other);\n      return result;\n    }\n\n    /**\n     * A specialized version of `baseRest` which flattens the rest array.\n     *\n     * @private\n     * @param {Function} func The function to apply a rest parameter to.\n     * @returns {Function} Returns the new function.\n     */\n    function flatRest(func) {\n      return setToString(overRest(func, undefined, flatten), func + '');\n    }\n\n    /**\n     * Creates an array of own enumerable property names and symbols of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property names and symbols.\n     */\n    function getAllKeys(object) {\n      return baseGetAllKeys(object, keys, getSymbols);\n    }\n\n    /**\n     * Creates an array of own and inherited enumerable property names and\n     * symbols of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property names and symbols.\n     */\n    function getAllKeysIn(object) {\n      return baseGetAllKeys(object, keysIn, getSymbolsIn);\n    }\n\n    /**\n     * Gets metadata for `func`.\n     *\n     * @private\n     * @param {Function} func The function to query.\n     * @returns {*} Returns the metadata for `func`.\n     */\n    var getData = !metaMap ? noop : function(func) {\n      return metaMap.get(func);\n    };\n\n    /**\n     * Gets the name of `func`.\n     *\n     * @private\n     * @param {Function} func The function to query.\n     * @returns {string} Returns the function name.\n     */\n    function getFuncName(func) {\n      var result = (func.name + ''),\n          array = realNames[result],\n          length = hasOwnProperty.call(realNames, result) ? array.length : 0;\n\n      while (length--) {\n        var data = array[length],\n            otherFunc = data.func;\n        if (otherFunc == null || otherFunc == func) {\n          return data.name;\n        }\n      }\n      return result;\n    }\n\n    /**\n     * Gets the argument placeholder value for `func`.\n     *\n     * @private\n     * @param {Function} func The function to inspect.\n     * @returns {*} Returns the placeholder value.\n     */\n    function getHolder(func) {\n      var object = hasOwnProperty.call(lodash, 'placeholder') ? lodash : func;\n      return object.placeholder;\n    }\n\n    /**\n     * Gets the appropriate \"iteratee\" function. If `_.iteratee` is customized,\n     * this function returns the custom method, otherwise it returns `baseIteratee`.\n     * If arguments are provided, the chosen function is invoked with them and\n     * its result is returned.\n     *\n     * @private\n     * @param {*} [value] The value to convert to an iteratee.\n     * @param {number} [arity] The arity of the created iteratee.\n     * @returns {Function} Returns the chosen function or its result.\n     */\n    function getIteratee() {\n      var result = lodash.iteratee || iteratee;\n      result = result === iteratee ? baseIteratee : result;\n      return arguments.length ? result(arguments[0], arguments[1]) : result;\n    }\n\n    /**\n     * Gets the data for `map`.\n     *\n     * @private\n     * @param {Object} map The map to query.\n     * @param {string} key The reference key.\n     * @returns {*} Returns the map data.\n     */\n    function getMapData(map, key) {\n      var data = map.__data__;\n      return isKeyable(key)\n        ? data[typeof key == 'string' ? 'string' : 'hash']\n        : data.map;\n    }\n\n    /**\n     * Gets the property names, values, and compare flags of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the match data of `object`.\n     */\n    function getMatchData(object) {\n      var result = keys(object),\n          length = result.length;\n\n      while (length--) {\n        var key = result[length],\n            value = object[key];\n\n        result[length] = [key, value, isStrictComparable(value)];\n      }\n      return result;\n    }\n\n    /**\n     * Gets the native function at `key` of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @param {string} key The key of the method to get.\n     * @returns {*} Returns the function if it's native, else `undefined`.\n     */\n    function getNative(object, key) {\n      var value = getValue(object, key);\n      return baseIsNative(value) ? value : undefined;\n    }\n\n    /**\n     * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n     *\n     * @private\n     * @param {*} value The value to query.\n     * @returns {string} Returns the raw `toStringTag`.\n     */\n    function getRawTag(value) {\n      var isOwn = hasOwnProperty.call(value, symToStringTag),\n          tag = value[symToStringTag];\n\n      try {\n        value[symToStringTag] = undefined;\n        var unmasked = true;\n      } catch (e) {}\n\n      var result = nativeObjectToString.call(value);\n      if (unmasked) {\n        if (isOwn) {\n          value[symToStringTag] = tag;\n        } else {\n          delete value[symToStringTag];\n        }\n      }\n      return result;\n    }\n\n    /**\n     * Creates an array of the own enumerable symbols of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of symbols.\n     */\n    var getSymbols = !nativeGetSymbols ? stubArray : function(object) {\n      if (object == null) {\n        return [];\n      }\n      object = Object(object);\n      return arrayFilter(nativeGetSymbols(object), function(symbol) {\n        return propertyIsEnumerable.call(object, symbol);\n      });\n    };\n\n    /**\n     * Creates an array of the own and inherited enumerable symbols of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of symbols.\n     */\n    var getSymbolsIn = !nativeGetSymbols ? stubArray : function(object) {\n      var result = [];\n      while (object) {\n        arrayPush(result, getSymbols(object));\n        object = getPrototype(object);\n      }\n      return result;\n    };\n\n    /**\n     * Gets the `toStringTag` of `value`.\n     *\n     * @private\n     * @param {*} value The value to query.\n     * @returns {string} Returns the `toStringTag`.\n     */\n    var getTag = baseGetTag;\n\n    // Fallback for data views, maps, sets, and weak maps in IE 11 and promises in Node.js < 6.\n    if ((DataView && getTag(new DataView(new ArrayBuffer(1))) != dataViewTag) ||\n        (Map && getTag(new Map) != mapTag) ||\n        (Promise && getTag(Promise.resolve()) != promiseTag) ||\n        (Set && getTag(new Set) != setTag) ||\n        (WeakMap && getTag(new WeakMap) != weakMapTag)) {\n      getTag = function(value) {\n        var result = baseGetTag(value),\n            Ctor = result == objectTag ? value.constructor : undefined,\n            ctorString = Ctor ? toSource(Ctor) : '';\n\n        if (ctorString) {\n          switch (ctorString) {\n            case dataViewCtorString: return dataViewTag;\n            case mapCtorString: return mapTag;\n            case promiseCtorString: return promiseTag;\n            case setCtorString: return setTag;\n            case weakMapCtorString: return weakMapTag;\n          }\n        }\n        return result;\n      };\n    }\n\n    /**\n     * Gets the view, applying any `transforms` to the `start` and `end` positions.\n     *\n     * @private\n     * @param {number} start The start of the view.\n     * @param {number} end The end of the view.\n     * @param {Array} transforms The transformations to apply to the view.\n     * @returns {Object} Returns an object containing the `start` and `end`\n     *  positions of the view.\n     */\n    function getView(start, end, transforms) {\n      var index = -1,\n          length = transforms.length;\n\n      while (++index < length) {\n        var data = transforms[index],\n            size = data.size;\n\n        switch (data.type) {\n          case 'drop':      start += size; break;\n          case 'dropRight': end -= size; break;\n          case 'take':      end = nativeMin(end, start + size); break;\n          case 'takeRight': start = nativeMax(start, end - size); break;\n        }\n      }\n      return { 'start': start, 'end': end };\n    }\n\n    /**\n     * Extracts wrapper details from the `source` body comment.\n     *\n     * @private\n     * @param {string} source The source to inspect.\n     * @returns {Array} Returns the wrapper details.\n     */\n    function getWrapDetails(source) {\n      var match = source.match(reWrapDetails);\n      return match ? match[1].split(reSplitDetails) : [];\n    }\n\n    /**\n     * Checks if `path` exists on `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path to check.\n     * @param {Function} hasFunc The function to check properties.\n     * @returns {boolean} Returns `true` if `path` exists, else `false`.\n     */\n    function hasPath(object, path, hasFunc) {\n      path = castPath(path, object);\n\n      var index = -1,\n          length = path.length,\n          result = false;\n\n      while (++index < length) {\n        var key = toKey(path[index]);\n        if (!(result = object != null && hasFunc(object, key))) {\n          break;\n        }\n        object = object[key];\n      }\n      if (result || ++index != length) {\n        return result;\n      }\n      length = object == null ? 0 : object.length;\n      return !!length && isLength(length) && isIndex(key, length) &&\n        (isArray(object) || isArguments(object));\n    }\n\n    /**\n     * Initializes an array clone.\n     *\n     * @private\n     * @param {Array} array The array to clone.\n     * @returns {Array} Returns the initialized clone.\n     */\n    function initCloneArray(array) {\n      var length = array.length,\n          result = new array.constructor(length);\n\n      // Add properties assigned by `RegExp#exec`.\n      if (length && typeof array[0] == 'string' && hasOwnProperty.call(array, 'index')) {\n        result.index = array.index;\n        result.input = array.input;\n      }\n      return result;\n    }\n\n    /**\n     * Initializes an object clone.\n     *\n     * @private\n     * @param {Object} object The object to clone.\n     * @returns {Object} Returns the initialized clone.\n     */\n    function initCloneObject(object) {\n      return (typeof object.constructor == 'function' && !isPrototype(object))\n        ? baseCreate(getPrototype(object))\n        : {};\n    }\n\n    /**\n     * Initializes an object clone based on its `toStringTag`.\n     *\n     * **Note:** This function only supports cloning values with tags of\n     * `Boolean`, `Date`, `Error`, `Map`, `Number`, `RegExp`, `Set`, or `String`.\n     *\n     * @private\n     * @param {Object} object The object to clone.\n     * @param {string} tag The `toStringTag` of the object to clone.\n     * @param {boolean} [isDeep] Specify a deep clone.\n     * @returns {Object} Returns the initialized clone.\n     */\n    function initCloneByTag(object, tag, isDeep) {\n      var Ctor = object.constructor;\n      switch (tag) {\n        case arrayBufferTag:\n          return cloneArrayBuffer(object);\n\n        case boolTag:\n        case dateTag:\n          return new Ctor(+object);\n\n        case dataViewTag:\n          return cloneDataView(object, isDeep);\n\n        case float32Tag: case float64Tag:\n        case int8Tag: case int16Tag: case int32Tag:\n        case uint8Tag: case uint8ClampedTag: case uint16Tag: case uint32Tag:\n          return cloneTypedArray(object, isDeep);\n\n        case mapTag:\n          return new Ctor;\n\n        case numberTag:\n        case stringTag:\n          return new Ctor(object);\n\n        case regexpTag:\n          return cloneRegExp(object);\n\n        case setTag:\n          return new Ctor;\n\n        case symbolTag:\n          return cloneSymbol(object);\n      }\n    }\n\n    /**\n     * Inserts wrapper `details` in a comment at the top of the `source` body.\n     *\n     * @private\n     * @param {string} source The source to modify.\n     * @returns {Array} details The details to insert.\n     * @returns {string} Returns the modified source.\n     */\n    function insertWrapDetails(source, details) {\n      var length = details.length;\n      if (!length) {\n        return source;\n      }\n      var lastIndex = length - 1;\n      details[lastIndex] = (length > 1 ? '& ' : '') + details[lastIndex];\n      details = details.join(length > 2 ? ', ' : ' ');\n      return source.replace(reWrapComment, '{\\n/* [wrapped with ' + details + '] */\\n');\n    }\n\n    /**\n     * Checks if `value` is a flattenable `arguments` object or array.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is flattenable, else `false`.\n     */\n    function isFlattenable(value) {\n      return isArray(value) || isArguments(value) ||\n        !!(spreadableSymbol && value && value[spreadableSymbol]);\n    }\n\n    /**\n     * Checks if `value` is a valid array-like index.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n     * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n     */\n    function isIndex(value, length) {\n      var type = typeof value;\n      length = length == null ? MAX_SAFE_INTEGER : length;\n\n      return !!length &&\n        (type == 'number' ||\n          (type != 'symbol' && reIsUint.test(value))) &&\n            (value > -1 && value % 1 == 0 && value < length);\n    }\n\n    /**\n     * Checks if the given arguments are from an iteratee call.\n     *\n     * @private\n     * @param {*} value The potential iteratee value argument.\n     * @param {*} index The potential iteratee index or key argument.\n     * @param {*} object The potential iteratee object argument.\n     * @returns {boolean} Returns `true` if the arguments are from an iteratee call,\n     *  else `false`.\n     */\n    function isIterateeCall(value, index, object) {\n      if (!isObject(object)) {\n        return false;\n      }\n      var type = typeof index;\n      if (type == 'number'\n            ? (isArrayLike(object) && isIndex(index, object.length))\n            : (type == 'string' && index in object)\n          ) {\n        return eq(object[index], value);\n      }\n      return false;\n    }\n\n    /**\n     * Checks if `value` is a property name and not a property path.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @param {Object} [object] The object to query keys on.\n     * @returns {boolean} Returns `true` if `value` is a property name, else `false`.\n     */\n    function isKey(value, object) {\n      if (isArray(value)) {\n        return false;\n      }\n      var type = typeof value;\n      if (type == 'number' || type == 'symbol' || type == 'boolean' ||\n          value == null || isSymbol(value)) {\n        return true;\n      }\n      return reIsPlainProp.test(value) || !reIsDeepProp.test(value) ||\n        (object != null && value in Object(object));\n    }\n\n    /**\n     * Checks if `value` is suitable for use as unique object key.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n     */\n    function isKeyable(value) {\n      var type = typeof value;\n      return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n        ? (value !== '__proto__')\n        : (value === null);\n    }\n\n    /**\n     * Checks if `func` has a lazy counterpart.\n     *\n     * @private\n     * @param {Function} func The function to check.\n     * @returns {boolean} Returns `true` if `func` has a lazy counterpart,\n     *  else `false`.\n     */\n    function isLaziable(func) {\n      var funcName = getFuncName(func),\n          other = lodash[funcName];\n\n      if (typeof other != 'function' || !(funcName in LazyWrapper.prototype)) {\n        return false;\n      }\n      if (func === other) {\n        return true;\n      }\n      var data = getData(other);\n      return !!data && func === data[0];\n    }\n\n    /**\n     * Checks if `func` has its source masked.\n     *\n     * @private\n     * @param {Function} func The function to check.\n     * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n     */\n    function isMasked(func) {\n      return !!maskSrcKey && (maskSrcKey in func);\n    }\n\n    /**\n     * Checks if `func` is capable of being masked.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `func` is maskable, else `false`.\n     */\n    var isMaskable = coreJsData ? isFunction : stubFalse;\n\n    /**\n     * Checks if `value` is likely a prototype object.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n     */\n    function isPrototype(value) {\n      var Ctor = value && value.constructor,\n          proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n      return value === proto;\n    }\n\n    /**\n     * Checks if `value` is suitable for strict equality comparisons, i.e. `===`.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` if suitable for strict\n     *  equality comparisons, else `false`.\n     */\n    function isStrictComparable(value) {\n      return value === value && !isObject(value);\n    }\n\n    /**\n     * A specialized version of `matchesProperty` for source values suitable\n     * for strict equality comparisons, i.e. `===`.\n     *\n     * @private\n     * @param {string} key The key of the property to get.\n     * @param {*} srcValue The value to match.\n     * @returns {Function} Returns the new spec function.\n     */\n    function matchesStrictComparable(key, srcValue) {\n      return function(object) {\n        if (object == null) {\n          return false;\n        }\n        return object[key] === srcValue &&\n          (srcValue !== undefined || (key in Object(object)));\n      };\n    }\n\n    /**\n     * A specialized version of `_.memoize` which clears the memoized function's\n     * cache when it exceeds `MAX_MEMOIZE_SIZE`.\n     *\n     * @private\n     * @param {Function} func The function to have its output memoized.\n     * @returns {Function} Returns the new memoized function.\n     */\n    function memoizeCapped(func) {\n      var result = memoize(func, function(key) {\n        if (cache.size === MAX_MEMOIZE_SIZE) {\n          cache.clear();\n        }\n        return key;\n      });\n\n      var cache = result.cache;\n      return result;\n    }\n\n    /**\n     * Merges the function metadata of `source` into `data`.\n     *\n     * Merging metadata reduces the number of wrappers used to invoke a function.\n     * This is possible because methods like `_.bind`, `_.curry`, and `_.partial`\n     * may be applied regardless of execution order. Methods like `_.ary` and\n     * `_.rearg` modify function arguments, making the order in which they are\n     * executed important, preventing the merging of metadata. However, we make\n     * an exception for a safe combined case where curried functions have `_.ary`\n     * and or `_.rearg` applied.\n     *\n     * @private\n     * @param {Array} data The destination metadata.\n     * @param {Array} source The source metadata.\n     * @returns {Array} Returns `data`.\n     */\n    function mergeData(data, source) {\n      var bitmask = data[1],\n          srcBitmask = source[1],\n          newBitmask = bitmask | srcBitmask,\n          isCommon = newBitmask < (WRAP_BIND_FLAG | WRAP_BIND_KEY_FLAG | WRAP_ARY_FLAG);\n\n      var isCombo =\n        ((srcBitmask == WRAP_ARY_FLAG) && (bitmask == WRAP_CURRY_FLAG)) ||\n        ((srcBitmask == WRAP_ARY_FLAG) && (bitmask == WRAP_REARG_FLAG) && (data[7].length <= source[8])) ||\n        ((srcBitmask == (WRAP_ARY_FLAG | WRAP_REARG_FLAG)) && (source[7].length <= source[8]) && (bitmask == WRAP_CURRY_FLAG));\n\n      // Exit early if metadata can't be merged.\n      if (!(isCommon || isCombo)) {\n        return data;\n      }\n      // Use source `thisArg` if available.\n      if (srcBitmask & WRAP_BIND_FLAG) {\n        data[2] = source[2];\n        // Set when currying a bound function.\n        newBitmask |= bitmask & WRAP_BIND_FLAG ? 0 : WRAP_CURRY_BOUND_FLAG;\n      }\n      // Compose partial arguments.\n      var value = source[3];\n      if (value) {\n        var partials = data[3];\n        data[3] = partials ? composeArgs(partials, value, source[4]) : value;\n        data[4] = partials ? replaceHolders(data[3], PLACEHOLDER) : source[4];\n      }\n      // Compose partial right arguments.\n      value = source[5];\n      if (value) {\n        partials = data[5];\n        data[5] = partials ? composeArgsRight(partials, value, source[6]) : value;\n        data[6] = partials ? replaceHolders(data[5], PLACEHOLDER) : source[6];\n      }\n      // Use source `argPos` if available.\n      value = source[7];\n      if (value) {\n        data[7] = value;\n      }\n      // Use source `ary` if it's smaller.\n      if (srcBitmask & WRAP_ARY_FLAG) {\n        data[8] = data[8] == null ? source[8] : nativeMin(data[8], source[8]);\n      }\n      // Use source `arity` if one is not provided.\n      if (data[9] == null) {\n        data[9] = source[9];\n      }\n      // Use source `func` and merge bitmasks.\n      data[0] = source[0];\n      data[1] = newBitmask;\n\n      return data;\n    }\n\n    /**\n     * This function is like\n     * [`Object.keys`](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n     * except that it includes inherited enumerable properties.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property names.\n     */\n    function nativeKeysIn(object) {\n      var result = [];\n      if (object != null) {\n        for (var key in Object(object)) {\n          result.push(key);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * Converts `value` to a string using `Object.prototype.toString`.\n     *\n     * @private\n     * @param {*} value The value to convert.\n     * @returns {string} Returns the converted string.\n     */\n    function objectToString(value) {\n      return nativeObjectToString.call(value);\n    }\n\n    /**\n     * A specialized version of `baseRest` which transforms the rest array.\n     *\n     * @private\n     * @param {Function} func The function to apply a rest parameter to.\n     * @param {number} [start=func.length-1] The start position of the rest parameter.\n     * @param {Function} transform The rest array transform.\n     * @returns {Function} Returns the new function.\n     */\n    function overRest(func, start, transform) {\n      start = nativeMax(start === undefined ? (func.length - 1) : start, 0);\n      return function() {\n        var args = arguments,\n            index = -1,\n            length = nativeMax(args.length - start, 0),\n            array = Array(length);\n\n        while (++index < length) {\n          array[index] = args[start + index];\n        }\n        index = -1;\n        var otherArgs = Array(start + 1);\n        while (++index < start) {\n          otherArgs[index] = args[index];\n        }\n        otherArgs[start] = transform(array);\n        return apply(func, this, otherArgs);\n      };\n    }\n\n    /**\n     * Gets the parent value at `path` of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @param {Array} path The path to get the parent value of.\n     * @returns {*} Returns the parent value.\n     */\n    function parent(object, path) {\n      return path.length < 2 ? object : baseGet(object, baseSlice(path, 0, -1));\n    }\n\n    /**\n     * Reorder `array` according to the specified indexes where the element at\n     * the first index is assigned as the first element, the element at\n     * the second index is assigned as the second element, and so on.\n     *\n     * @private\n     * @param {Array} array The array to reorder.\n     * @param {Array} indexes The arranged array indexes.\n     * @returns {Array} Returns `array`.\n     */\n    function reorder(array, indexes) {\n      var arrLength = array.length,\n          length = nativeMin(indexes.length, arrLength),\n          oldArray = copyArray(array);\n\n      while (length--) {\n        var index = indexes[length];\n        array[length] = isIndex(index, arrLength) ? oldArray[index] : undefined;\n      }\n      return array;\n    }\n\n    /**\n     * Gets the value at `key`, unless `key` is \"__proto__\" or \"constructor\".\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @param {string} key The key of the property to get.\n     * @returns {*} Returns the property value.\n     */\n    function safeGet(object, key) {\n      if (key === 'constructor' && typeof object[key] === 'function') {\n        return;\n      }\n\n      if (key == '__proto__') {\n        return;\n      }\n\n      return object[key];\n    }\n\n    /**\n     * Sets metadata for `func`.\n     *\n     * **Note:** If this function becomes hot, i.e. is invoked a lot in a short\n     * period of time, it will trip its breaker and transition to an identity\n     * function to avoid garbage collection pauses in V8. See\n     * [V8 issue 2070](https://bugs.chromium.org/p/v8/issues/detail?id=2070)\n     * for more details.\n     *\n     * @private\n     * @param {Function} func The function to associate metadata with.\n     * @param {*} data The metadata.\n     * @returns {Function} Returns `func`.\n     */\n    var setData = shortOut(baseSetData);\n\n    /**\n     * A simple wrapper around the global [`setTimeout`](https://mdn.io/setTimeout).\n     *\n     * @private\n     * @param {Function} func The function to delay.\n     * @param {number} wait The number of milliseconds to delay invocation.\n     * @returns {number|Object} Returns the timer id or timeout object.\n     */\n    var setTimeout = ctxSetTimeout || function(func, wait) {\n      return root.setTimeout(func, wait);\n    };\n\n    /**\n     * Sets the `toString` method of `func` to return `string`.\n     *\n     * @private\n     * @param {Function} func The function to modify.\n     * @param {Function} string The `toString` result.\n     * @returns {Function} Returns `func`.\n     */\n    var setToString = shortOut(baseSetToString);\n\n    /**\n     * Sets the `toString` method of `wrapper` to mimic the source of `reference`\n     * with wrapper details in a comment at the top of the source body.\n     *\n     * @private\n     * @param {Function} wrapper The function to modify.\n     * @param {Function} reference The reference function.\n     * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n     * @returns {Function} Returns `wrapper`.\n     */\n    function setWrapToString(wrapper, reference, bitmask) {\n      var source = (reference + '');\n      return setToString(wrapper, insertWrapDetails(source, updateWrapDetails(getWrapDetails(source), bitmask)));\n    }\n\n    /**\n     * Creates a function that'll short out and invoke `identity` instead\n     * of `func` when it's called `HOT_COUNT` or more times in `HOT_SPAN`\n     * milliseconds.\n     *\n     * @private\n     * @param {Function} func The function to restrict.\n     * @returns {Function} Returns the new shortable function.\n     */\n    function shortOut(func) {\n      var count = 0,\n          lastCalled = 0;\n\n      return function() {\n        var stamp = nativeNow(),\n            remaining = HOT_SPAN - (stamp - lastCalled);\n\n        lastCalled = stamp;\n        if (remaining > 0) {\n          if (++count >= HOT_COUNT) {\n            return arguments[0];\n          }\n        } else {\n          count = 0;\n        }\n        return func.apply(undefined, arguments);\n      };\n    }\n\n    /**\n     * A specialized version of `_.shuffle` which mutates and sets the size of `array`.\n     *\n     * @private\n     * @param {Array} array The array to shuffle.\n     * @param {number} [size=array.length] The size of `array`.\n     * @returns {Array} Returns `array`.\n     */\n    function shuffleSelf(array, size) {\n      var index = -1,\n          length = array.length,\n          lastIndex = length - 1;\n\n      size = size === undefined ? length : size;\n      while (++index < size) {\n        var rand = baseRandom(index, lastIndex),\n            value = array[rand];\n\n        array[rand] = array[index];\n        array[index] = value;\n      }\n      array.length = size;\n      return array;\n    }\n\n    /**\n     * Converts `string` to a property path array.\n     *\n     * @private\n     * @param {string} string The string to convert.\n     * @returns {Array} Returns the property path array.\n     */\n    var stringToPath = memoizeCapped(function(string) {\n      var result = [];\n      if (string.charCodeAt(0) === 46 /* . */) {\n        result.push('');\n      }\n      string.replace(rePropName, function(match, number, quote, subString) {\n        result.push(quote ? subString.replace(reEscapeChar, '$1') : (number || match));\n      });\n      return result;\n    });\n\n    /**\n     * Converts `value` to a string key if it's not a string or symbol.\n     *\n     * @private\n     * @param {*} value The value to inspect.\n     * @returns {string|symbol} Returns the key.\n     */\n    function toKey(value) {\n      if (typeof value == 'string' || isSymbol(value)) {\n        return value;\n      }\n      var result = (value + '');\n      return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n    }\n\n    /**\n     * Converts `func` to its source code.\n     *\n     * @private\n     * @param {Function} func The function to convert.\n     * @returns {string} Returns the source code.\n     */\n    function toSource(func) {\n      if (func != null) {\n        try {\n          return funcToString.call(func);\n        } catch (e) {}\n        try {\n          return (func + '');\n        } catch (e) {}\n      }\n      return '';\n    }\n\n    /**\n     * Updates wrapper `details` based on `bitmask` flags.\n     *\n     * @private\n     * @returns {Array} details The details to modify.\n     * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n     * @returns {Array} Returns `details`.\n     */\n    function updateWrapDetails(details, bitmask) {\n      arrayEach(wrapFlags, function(pair) {\n        var value = '_.' + pair[0];\n        if ((bitmask & pair[1]) && !arrayIncludes(details, value)) {\n          details.push(value);\n        }\n      });\n      return details.sort();\n    }\n\n    /**\n     * Creates a clone of `wrapper`.\n     *\n     * @private\n     * @param {Object} wrapper The wrapper to clone.\n     * @returns {Object} Returns the cloned wrapper.\n     */\n    function wrapperClone(wrapper) {\n      if (wrapper instanceof LazyWrapper) {\n        return wrapper.clone();\n      }\n      var result = new LodashWrapper(wrapper.__wrapped__, wrapper.__chain__);\n      result.__actions__ = copyArray(wrapper.__actions__);\n      result.__index__  = wrapper.__index__;\n      result.__values__ = wrapper.__values__;\n      return result;\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates an array of elements split into groups the length of `size`.\n     * If `array` can't be split evenly, the final chunk will be the remaining\n     * elements.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to process.\n     * @param {number} [size=1] The length of each chunk\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Array} Returns the new array of chunks.\n     * @example\n     *\n     * _.chunk(['a', 'b', 'c', 'd'], 2);\n     * // => [['a', 'b'], ['c', 'd']]\n     *\n     * _.chunk(['a', 'b', 'c', 'd'], 3);\n     * // => [['a', 'b', 'c'], ['d']]\n     */\n    function chunk(array, size, guard) {\n      if ((guard ? isIterateeCall(array, size, guard) : size === undefined)) {\n        size = 1;\n      } else {\n        size = nativeMax(toInteger(size), 0);\n      }\n      var length = array == null ? 0 : array.length;\n      if (!length || size < 1) {\n        return [];\n      }\n      var index = 0,\n          resIndex = 0,\n          result = Array(nativeCeil(length / size));\n\n      while (index < length) {\n        result[resIndex++] = baseSlice(array, index, (index += size));\n      }\n      return result;\n    }\n\n    /**\n     * Creates an array with all falsey values removed. The values `false`, `null`,\n     * `0`, `\"\"`, `undefined`, and `NaN` are falsey.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to compact.\n     * @returns {Array} Returns the new array of filtered values.\n     * @example\n     *\n     * _.compact([0, 1, false, 2, '', 3]);\n     * // => [1, 2, 3]\n     */\n    function compact(array) {\n      var index = -1,\n          length = array == null ? 0 : array.length,\n          resIndex = 0,\n          result = [];\n\n      while (++index < length) {\n        var value = array[index];\n        if (value) {\n          result[resIndex++] = value;\n        }\n      }\n      return result;\n    }\n\n    /**\n     * Creates a new array concatenating `array` with any additional arrays\n     * and/or values.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to concatenate.\n     * @param {...*} [values] The values to concatenate.\n     * @returns {Array} Returns the new concatenated array.\n     * @example\n     *\n     * var array = [1];\n     * var other = _.concat(array, 2, [3], [[4]]);\n     *\n     * console.log(other);\n     * // => [1, 2, 3, [4]]\n     *\n     * console.log(array);\n     * // => [1]\n     */\n    function concat() {\n      var length = arguments.length;\n      if (!length) {\n        return [];\n      }\n      var args = Array(length - 1),\n          array = arguments[0],\n          index = length;\n\n      while (index--) {\n        args[index - 1] = arguments[index];\n      }\n      return arrayPush(isArray(array) ? copyArray(array) : [array], baseFlatten(args, 1));\n    }\n\n    /**\n     * Creates an array of `array` values not included in the other given arrays\n     * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons. The order and references of result values are\n     * determined by the first array.\n     *\n     * **Note:** Unlike `_.pullAll`, this method returns a new array.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {...Array} [values] The values to exclude.\n     * @returns {Array} Returns the new array of filtered values.\n     * @see _.without, _.xor\n     * @example\n     *\n     * _.difference([2, 1], [2, 3]);\n     * // => [1]\n     */\n    var difference = baseRest(function(array, values) {\n      return isArrayLikeObject(array)\n        ? baseDifference(array, baseFlatten(values, 1, isArrayLikeObject, true))\n        : [];\n    });\n\n    /**\n     * This method is like `_.difference` except that it accepts `iteratee` which\n     * is invoked for each element of `array` and `values` to generate the criterion\n     * by which they're compared. The order and references of result values are\n     * determined by the first array. The iteratee is invoked with one argument:\n     * (value).\n     *\n     * **Note:** Unlike `_.pullAllBy`, this method returns a new array.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {...Array} [values] The values to exclude.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {Array} Returns the new array of filtered values.\n     * @example\n     *\n     * _.differenceBy([2.1, 1.2], [2.3, 3.4], Math.floor);\n     * // => [1.2]\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.differenceBy([{ 'x': 2 }, { 'x': 1 }], [{ 'x': 1 }], 'x');\n     * // => [{ 'x': 2 }]\n     */\n    var differenceBy = baseRest(function(array, values) {\n      var iteratee = last(values);\n      if (isArrayLikeObject(iteratee)) {\n        iteratee = undefined;\n      }\n      return isArrayLikeObject(array)\n        ? baseDifference(array, baseFlatten(values, 1, isArrayLikeObject, true), getIteratee(iteratee, 2))\n        : [];\n    });\n\n    /**\n     * This method is like `_.difference` except that it accepts `comparator`\n     * which is invoked to compare elements of `array` to `values`. The order and\n     * references of result values are determined by the first array. The comparator\n     * is invoked with two arguments: (arrVal, othVal).\n     *\n     * **Note:** Unlike `_.pullAllWith`, this method returns a new array.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {...Array} [values] The values to exclude.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new array of filtered values.\n     * @example\n     *\n     * var objects = [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }];\n     *\n     * _.differenceWith(objects, [{ 'x': 1, 'y': 2 }], _.isEqual);\n     * // => [{ 'x': 2, 'y': 1 }]\n     */\n    var differenceWith = baseRest(function(array, values) {\n      var comparator = last(values);\n      if (isArrayLikeObject(comparator)) {\n        comparator = undefined;\n      }\n      return isArrayLikeObject(array)\n        ? baseDifference(array, baseFlatten(values, 1, isArrayLikeObject, true), undefined, comparator)\n        : [];\n    });\n\n    /**\n     * Creates a slice of `array` with `n` elements dropped from the beginning.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.5.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {number} [n=1] The number of elements to drop.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * _.drop([1, 2, 3]);\n     * // => [2, 3]\n     *\n     * _.drop([1, 2, 3], 2);\n     * // => [3]\n     *\n     * _.drop([1, 2, 3], 5);\n     * // => []\n     *\n     * _.drop([1, 2, 3], 0);\n     * // => [1, 2, 3]\n     */\n    function drop(array, n, guard) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return [];\n      }\n      n = (guard || n === undefined) ? 1 : toInteger(n);\n      return baseSlice(array, n < 0 ? 0 : n, length);\n    }\n\n    /**\n     * Creates a slice of `array` with `n` elements dropped from the end.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {number} [n=1] The number of elements to drop.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * _.dropRight([1, 2, 3]);\n     * // => [1, 2]\n     *\n     * _.dropRight([1, 2, 3], 2);\n     * // => [1]\n     *\n     * _.dropRight([1, 2, 3], 5);\n     * // => []\n     *\n     * _.dropRight([1, 2, 3], 0);\n     * // => [1, 2, 3]\n     */\n    function dropRight(array, n, guard) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return [];\n      }\n      n = (guard || n === undefined) ? 1 : toInteger(n);\n      n = length - n;\n      return baseSlice(array, 0, n < 0 ? 0 : n);\n    }\n\n    /**\n     * Creates a slice of `array` excluding elements dropped from the end.\n     * Elements are dropped until `predicate` returns falsey. The predicate is\n     * invoked with three arguments: (value, index, array).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'active': true },\n     *   { 'user': 'fred',    'active': false },\n     *   { 'user': 'pebbles', 'active': false }\n     * ];\n     *\n     * _.dropRightWhile(users, function(o) { return !o.active; });\n     * // => objects for ['barney']\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.dropRightWhile(users, { 'user': 'pebbles', 'active': false });\n     * // => objects for ['barney', 'fred']\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.dropRightWhile(users, ['active', false]);\n     * // => objects for ['barney']\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.dropRightWhile(users, 'active');\n     * // => objects for ['barney', 'fred', 'pebbles']\n     */\n    function dropRightWhile(array, predicate) {\n      return (array && array.length)\n        ? baseWhile(array, getIteratee(predicate, 3), true, true)\n        : [];\n    }\n\n    /**\n     * Creates a slice of `array` excluding elements dropped from the beginning.\n     * Elements are dropped until `predicate` returns falsey. The predicate is\n     * invoked with three arguments: (value, index, array).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'active': false },\n     *   { 'user': 'fred',    'active': false },\n     *   { 'user': 'pebbles', 'active': true }\n     * ];\n     *\n     * _.dropWhile(users, function(o) { return !o.active; });\n     * // => objects for ['pebbles']\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.dropWhile(users, { 'user': 'barney', 'active': false });\n     * // => objects for ['fred', 'pebbles']\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.dropWhile(users, ['active', false]);\n     * // => objects for ['pebbles']\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.dropWhile(users, 'active');\n     * // => objects for ['barney', 'fred', 'pebbles']\n     */\n    function dropWhile(array, predicate) {\n      return (array && array.length)\n        ? baseWhile(array, getIteratee(predicate, 3), true)\n        : [];\n    }\n\n    /**\n     * Fills elements of `array` with `value` from `start` up to, but not\n     * including, `end`.\n     *\n     * **Note:** This method mutates `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.2.0\n     * @category Array\n     * @param {Array} array The array to fill.\n     * @param {*} value The value to fill `array` with.\n     * @param {number} [start=0] The start position.\n     * @param {number} [end=array.length] The end position.\n     * @returns {Array} Returns `array`.\n     * @example\n     *\n     * var array = [1, 2, 3];\n     *\n     * _.fill(array, 'a');\n     * console.log(array);\n     * // => ['a', 'a', 'a']\n     *\n     * _.fill(Array(3), 2);\n     * // => [2, 2, 2]\n     *\n     * _.fill([4, 6, 8, 10], '*', 1, 3);\n     * // => [4, '*', '*', 10]\n     */\n    function fill(array, value, start, end) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return [];\n      }\n      if (start && typeof start != 'number' && isIterateeCall(array, value, start)) {\n        start = 0;\n        end = length;\n      }\n      return baseFill(array, value, start, end);\n    }\n\n    /**\n     * This method is like `_.find` except that it returns the index of the first\n     * element `predicate` returns truthy for instead of the element itself.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.1.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @param {number} [fromIndex=0] The index to search from.\n     * @returns {number} Returns the index of the found element, else `-1`.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'active': false },\n     *   { 'user': 'fred',    'active': false },\n     *   { 'user': 'pebbles', 'active': true }\n     * ];\n     *\n     * _.findIndex(users, function(o) { return o.user == 'barney'; });\n     * // => 0\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.findIndex(users, { 'user': 'fred', 'active': false });\n     * // => 1\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.findIndex(users, ['active', false]);\n     * // => 0\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.findIndex(users, 'active');\n     * // => 2\n     */\n    function findIndex(array, predicate, fromIndex) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return -1;\n      }\n      var index = fromIndex == null ? 0 : toInteger(fromIndex);\n      if (index < 0) {\n        index = nativeMax(length + index, 0);\n      }\n      return baseFindIndex(array, getIteratee(predicate, 3), index);\n    }\n\n    /**\n     * This method is like `_.findIndex` except that it iterates over elements\n     * of `collection` from right to left.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @param {number} [fromIndex=array.length-1] The index to search from.\n     * @returns {number} Returns the index of the found element, else `-1`.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'active': true },\n     *   { 'user': 'fred',    'active': false },\n     *   { 'user': 'pebbles', 'active': false }\n     * ];\n     *\n     * _.findLastIndex(users, function(o) { return o.user == 'pebbles'; });\n     * // => 2\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.findLastIndex(users, { 'user': 'barney', 'active': true });\n     * // => 0\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.findLastIndex(users, ['active', false]);\n     * // => 2\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.findLastIndex(users, 'active');\n     * // => 0\n     */\n    function findLastIndex(array, predicate, fromIndex) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return -1;\n      }\n      var index = length - 1;\n      if (fromIndex !== undefined) {\n        index = toInteger(fromIndex);\n        index = fromIndex < 0\n          ? nativeMax(length + index, 0)\n          : nativeMin(index, length - 1);\n      }\n      return baseFindIndex(array, getIteratee(predicate, 3), index, true);\n    }\n\n    /**\n     * Flattens `array` a single level deep.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to flatten.\n     * @returns {Array} Returns the new flattened array.\n     * @example\n     *\n     * _.flatten([1, [2, [3, [4]], 5]]);\n     * // => [1, 2, [3, [4]], 5]\n     */\n    function flatten(array) {\n      var length = array == null ? 0 : array.length;\n      return length ? baseFlatten(array, 1) : [];\n    }\n\n    /**\n     * Recursively flattens `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to flatten.\n     * @returns {Array} Returns the new flattened array.\n     * @example\n     *\n     * _.flattenDeep([1, [2, [3, [4]], 5]]);\n     * // => [1, 2, 3, 4, 5]\n     */\n    function flattenDeep(array) {\n      var length = array == null ? 0 : array.length;\n      return length ? baseFlatten(array, INFINITY) : [];\n    }\n\n    /**\n     * Recursively flatten `array` up to `depth` times.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.4.0\n     * @category Array\n     * @param {Array} array The array to flatten.\n     * @param {number} [depth=1] The maximum recursion depth.\n     * @returns {Array} Returns the new flattened array.\n     * @example\n     *\n     * var array = [1, [2, [3, [4]], 5]];\n     *\n     * _.flattenDepth(array, 1);\n     * // => [1, 2, [3, [4]], 5]\n     *\n     * _.flattenDepth(array, 2);\n     * // => [1, 2, 3, [4], 5]\n     */\n    function flattenDepth(array, depth) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return [];\n      }\n      depth = depth === undefined ? 1 : toInteger(depth);\n      return baseFlatten(array, depth);\n    }\n\n    /**\n     * The inverse of `_.toPairs`; this method returns an object composed\n     * from key-value `pairs`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} pairs The key-value pairs.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * _.fromPairs([['a', 1], ['b', 2]]);\n     * // => { 'a': 1, 'b': 2 }\n     */\n    function fromPairs(pairs) {\n      var index = -1,\n          length = pairs == null ? 0 : pairs.length,\n          result = {};\n\n      while (++index < length) {\n        var pair = pairs[index];\n        result[pair[0]] = pair[1];\n      }\n      return result;\n    }\n\n    /**\n     * Gets the first element of `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @alias first\n     * @category Array\n     * @param {Array} array The array to query.\n     * @returns {*} Returns the first element of `array`.\n     * @example\n     *\n     * _.head([1, 2, 3]);\n     * // => 1\n     *\n     * _.head([]);\n     * // => undefined\n     */\n    function head(array) {\n      return (array && array.length) ? array[0] : undefined;\n    }\n\n    /**\n     * Gets the index at which the first occurrence of `value` is found in `array`\n     * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons. If `fromIndex` is negative, it's used as the\n     * offset from the end of `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {*} value The value to search for.\n     * @param {number} [fromIndex=0] The index to search from.\n     * @returns {number} Returns the index of the matched value, else `-1`.\n     * @example\n     *\n     * _.indexOf([1, 2, 1, 2], 2);\n     * // => 1\n     *\n     * // Search from the `fromIndex`.\n     * _.indexOf([1, 2, 1, 2], 2, 2);\n     * // => 3\n     */\n    function indexOf(array, value, fromIndex) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return -1;\n      }\n      var index = fromIndex == null ? 0 : toInteger(fromIndex);\n      if (index < 0) {\n        index = nativeMax(length + index, 0);\n      }\n      return baseIndexOf(array, value, index);\n    }\n\n    /**\n     * Gets all but the last element of `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * _.initial([1, 2, 3]);\n     * // => [1, 2]\n     */\n    function initial(array) {\n      var length = array == null ? 0 : array.length;\n      return length ? baseSlice(array, 0, -1) : [];\n    }\n\n    /**\n     * Creates an array of unique values that are included in all given arrays\n     * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons. The order and references of result values are\n     * determined by the first array.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @returns {Array} Returns the new array of intersecting values.\n     * @example\n     *\n     * _.intersection([2, 1], [2, 3]);\n     * // => [2]\n     */\n    var intersection = baseRest(function(arrays) {\n      var mapped = arrayMap(arrays, castArrayLikeObject);\n      return (mapped.length && mapped[0] === arrays[0])\n        ? baseIntersection(mapped)\n        : [];\n    });\n\n    /**\n     * This method is like `_.intersection` except that it accepts `iteratee`\n     * which is invoked for each element of each `arrays` to generate the criterion\n     * by which they're compared. The order and references of result values are\n     * determined by the first array. The iteratee is invoked with one argument:\n     * (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {Array} Returns the new array of intersecting values.\n     * @example\n     *\n     * _.intersectionBy([2.1, 1.2], [2.3, 3.4], Math.floor);\n     * // => [2.1]\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.intersectionBy([{ 'x': 1 }], [{ 'x': 2 }, { 'x': 1 }], 'x');\n     * // => [{ 'x': 1 }]\n     */\n    var intersectionBy = baseRest(function(arrays) {\n      var iteratee = last(arrays),\n          mapped = arrayMap(arrays, castArrayLikeObject);\n\n      if (iteratee === last(mapped)) {\n        iteratee = undefined;\n      } else {\n        mapped.pop();\n      }\n      return (mapped.length && mapped[0] === arrays[0])\n        ? baseIntersection(mapped, getIteratee(iteratee, 2))\n        : [];\n    });\n\n    /**\n     * This method is like `_.intersection` except that it accepts `comparator`\n     * which is invoked to compare elements of `arrays`. The order and references\n     * of result values are determined by the first array. The comparator is\n     * invoked with two arguments: (arrVal, othVal).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new array of intersecting values.\n     * @example\n     *\n     * var objects = [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }];\n     * var others = [{ 'x': 1, 'y': 1 }, { 'x': 1, 'y': 2 }];\n     *\n     * _.intersectionWith(objects, others, _.isEqual);\n     * // => [{ 'x': 1, 'y': 2 }]\n     */\n    var intersectionWith = baseRest(function(arrays) {\n      var comparator = last(arrays),\n          mapped = arrayMap(arrays, castArrayLikeObject);\n\n      comparator = typeof comparator == 'function' ? comparator : undefined;\n      if (comparator) {\n        mapped.pop();\n      }\n      return (mapped.length && mapped[0] === arrays[0])\n        ? baseIntersection(mapped, undefined, comparator)\n        : [];\n    });\n\n    /**\n     * Converts all elements in `array` into a string separated by `separator`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to convert.\n     * @param {string} [separator=','] The element separator.\n     * @returns {string} Returns the joined string.\n     * @example\n     *\n     * _.join(['a', 'b', 'c'], '~');\n     * // => 'a~b~c'\n     */\n    function join(array, separator) {\n      return array == null ? '' : nativeJoin.call(array, separator);\n    }\n\n    /**\n     * Gets the last element of `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @returns {*} Returns the last element of `array`.\n     * @example\n     *\n     * _.last([1, 2, 3]);\n     * // => 3\n     */\n    function last(array) {\n      var length = array == null ? 0 : array.length;\n      return length ? array[length - 1] : undefined;\n    }\n\n    /**\n     * This method is like `_.indexOf` except that it iterates over elements of\n     * `array` from right to left.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {*} value The value to search for.\n     * @param {number} [fromIndex=array.length-1] The index to search from.\n     * @returns {number} Returns the index of the matched value, else `-1`.\n     * @example\n     *\n     * _.lastIndexOf([1, 2, 1, 2], 2);\n     * // => 3\n     *\n     * // Search from the `fromIndex`.\n     * _.lastIndexOf([1, 2, 1, 2], 2, 2);\n     * // => 1\n     */\n    function lastIndexOf(array, value, fromIndex) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return -1;\n      }\n      var index = length;\n      if (fromIndex !== undefined) {\n        index = toInteger(fromIndex);\n        index = index < 0 ? nativeMax(length + index, 0) : nativeMin(index, length - 1);\n      }\n      return value === value\n        ? strictLastIndexOf(array, value, index)\n        : baseFindIndex(array, baseIsNaN, index, true);\n    }\n\n    /**\n     * Gets the element at index `n` of `array`. If `n` is negative, the nth\n     * element from the end is returned.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.11.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {number} [n=0] The index of the element to return.\n     * @returns {*} Returns the nth element of `array`.\n     * @example\n     *\n     * var array = ['a', 'b', 'c', 'd'];\n     *\n     * _.nth(array, 1);\n     * // => 'b'\n     *\n     * _.nth(array, -2);\n     * // => 'c';\n     */\n    function nth(array, n) {\n      return (array && array.length) ? baseNth(array, toInteger(n)) : undefined;\n    }\n\n    /**\n     * Removes all given values from `array` using\n     * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons.\n     *\n     * **Note:** Unlike `_.without`, this method mutates `array`. Use `_.remove`\n     * to remove elements from an array by predicate.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Array\n     * @param {Array} array The array to modify.\n     * @param {...*} [values] The values to remove.\n     * @returns {Array} Returns `array`.\n     * @example\n     *\n     * var array = ['a', 'b', 'c', 'a', 'b', 'c'];\n     *\n     * _.pull(array, 'a', 'c');\n     * console.log(array);\n     * // => ['b', 'b']\n     */\n    var pull = baseRest(pullAll);\n\n    /**\n     * This method is like `_.pull` except that it accepts an array of values to remove.\n     *\n     * **Note:** Unlike `_.difference`, this method mutates `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to modify.\n     * @param {Array} values The values to remove.\n     * @returns {Array} Returns `array`.\n     * @example\n     *\n     * var array = ['a', 'b', 'c', 'a', 'b', 'c'];\n     *\n     * _.pullAll(array, ['a', 'c']);\n     * console.log(array);\n     * // => ['b', 'b']\n     */\n    function pullAll(array, values) {\n      return (array && array.length && values && values.length)\n        ? basePullAll(array, values)\n        : array;\n    }\n\n    /**\n     * This method is like `_.pullAll` except that it accepts `iteratee` which is\n     * invoked for each element of `array` and `values` to generate the criterion\n     * by which they're compared. The iteratee is invoked with one argument: (value).\n     *\n     * **Note:** Unlike `_.differenceBy`, this method mutates `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to modify.\n     * @param {Array} values The values to remove.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {Array} Returns `array`.\n     * @example\n     *\n     * var array = [{ 'x': 1 }, { 'x': 2 }, { 'x': 3 }, { 'x': 1 }];\n     *\n     * _.pullAllBy(array, [{ 'x': 1 }, { 'x': 3 }], 'x');\n     * console.log(array);\n     * // => [{ 'x': 2 }]\n     */\n    function pullAllBy(array, values, iteratee) {\n      return (array && array.length && values && values.length)\n        ? basePullAll(array, values, getIteratee(iteratee, 2))\n        : array;\n    }\n\n    /**\n     * This method is like `_.pullAll` except that it accepts `comparator` which\n     * is invoked to compare elements of `array` to `values`. The comparator is\n     * invoked with two arguments: (arrVal, othVal).\n     *\n     * **Note:** Unlike `_.differenceWith`, this method mutates `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.6.0\n     * @category Array\n     * @param {Array} array The array to modify.\n     * @param {Array} values The values to remove.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns `array`.\n     * @example\n     *\n     * var array = [{ 'x': 1, 'y': 2 }, { 'x': 3, 'y': 4 }, { 'x': 5, 'y': 6 }];\n     *\n     * _.pullAllWith(array, [{ 'x': 3, 'y': 4 }], _.isEqual);\n     * console.log(array);\n     * // => [{ 'x': 1, 'y': 2 }, { 'x': 5, 'y': 6 }]\n     */\n    function pullAllWith(array, values, comparator) {\n      return (array && array.length && values && values.length)\n        ? basePullAll(array, values, undefined, comparator)\n        : array;\n    }\n\n    /**\n     * Removes elements from `array` corresponding to `indexes` and returns an\n     * array of removed elements.\n     *\n     * **Note:** Unlike `_.at`, this method mutates `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to modify.\n     * @param {...(number|number[])} [indexes] The indexes of elements to remove.\n     * @returns {Array} Returns the new array of removed elements.\n     * @example\n     *\n     * var array = ['a', 'b', 'c', 'd'];\n     * var pulled = _.pullAt(array, [1, 3]);\n     *\n     * console.log(array);\n     * // => ['a', 'c']\n     *\n     * console.log(pulled);\n     * // => ['b', 'd']\n     */\n    var pullAt = flatRest(function(array, indexes) {\n      var length = array == null ? 0 : array.length,\n          result = baseAt(array, indexes);\n\n      basePullAt(array, arrayMap(indexes, function(index) {\n        return isIndex(index, length) ? +index : index;\n      }).sort(compareAscending));\n\n      return result;\n    });\n\n    /**\n     * Removes all elements from `array` that `predicate` returns truthy for\n     * and returns an array of the removed elements. The predicate is invoked\n     * with three arguments: (value, index, array).\n     *\n     * **Note:** Unlike `_.filter`, this method mutates `array`. Use `_.pull`\n     * to pull elements from an array by value.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Array\n     * @param {Array} array The array to modify.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the new array of removed elements.\n     * @example\n     *\n     * var array = [1, 2, 3, 4];\n     * var evens = _.remove(array, function(n) {\n     *   return n % 2 == 0;\n     * });\n     *\n     * console.log(array);\n     * // => [1, 3]\n     *\n     * console.log(evens);\n     * // => [2, 4]\n     */\n    function remove(array, predicate) {\n      var result = [];\n      if (!(array && array.length)) {\n        return result;\n      }\n      var index = -1,\n          indexes = [],\n          length = array.length;\n\n      predicate = getIteratee(predicate, 3);\n      while (++index < length) {\n        var value = array[index];\n        if (predicate(value, index, array)) {\n          result.push(value);\n          indexes.push(index);\n        }\n      }\n      basePullAt(array, indexes);\n      return result;\n    }\n\n    /**\n     * Reverses `array` so that the first element becomes the last, the second\n     * element becomes the second to last, and so on.\n     *\n     * **Note:** This method mutates `array` and is based on\n     * [`Array#reverse`](https://mdn.io/Array/reverse).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to modify.\n     * @returns {Array} Returns `array`.\n     * @example\n     *\n     * var array = [1, 2, 3];\n     *\n     * _.reverse(array);\n     * // => [3, 2, 1]\n     *\n     * console.log(array);\n     * // => [3, 2, 1]\n     */\n    function reverse(array) {\n      return array == null ? array : nativeReverse.call(array);\n    }\n\n    /**\n     * Creates a slice of `array` from `start` up to, but not including, `end`.\n     *\n     * **Note:** This method is used instead of\n     * [`Array#slice`](https://mdn.io/Array/slice) to ensure dense arrays are\n     * returned.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to slice.\n     * @param {number} [start=0] The start position.\n     * @param {number} [end=array.length] The end position.\n     * @returns {Array} Returns the slice of `array`.\n     */\n    function slice(array, start, end) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return [];\n      }\n      if (end && typeof end != 'number' && isIterateeCall(array, start, end)) {\n        start = 0;\n        end = length;\n      }\n      else {\n        start = start == null ? 0 : toInteger(start);\n        end = end === undefined ? length : toInteger(end);\n      }\n      return baseSlice(array, start, end);\n    }\n\n    /**\n     * Uses a binary search to determine the lowest index at which `value`\n     * should be inserted into `array` in order to maintain its sort order.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The sorted array to inspect.\n     * @param {*} value The value to evaluate.\n     * @returns {number} Returns the index at which `value` should be inserted\n     *  into `array`.\n     * @example\n     *\n     * _.sortedIndex([30, 50], 40);\n     * // => 1\n     */\n    function sortedIndex(array, value) {\n      return baseSortedIndex(array, value);\n    }\n\n    /**\n     * This method is like `_.sortedIndex` except that it accepts `iteratee`\n     * which is invoked for `value` and each element of `array` to compute their\n     * sort ranking. The iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The sorted array to inspect.\n     * @param {*} value The value to evaluate.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {number} Returns the index at which `value` should be inserted\n     *  into `array`.\n     * @example\n     *\n     * var objects = [{ 'x': 4 }, { 'x': 5 }];\n     *\n     * _.sortedIndexBy(objects, { 'x': 4 }, function(o) { return o.x; });\n     * // => 0\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.sortedIndexBy(objects, { 'x': 4 }, 'x');\n     * // => 0\n     */\n    function sortedIndexBy(array, value, iteratee) {\n      return baseSortedIndexBy(array, value, getIteratee(iteratee, 2));\n    }\n\n    /**\n     * This method is like `_.indexOf` except that it performs a binary\n     * search on a sorted `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {*} value The value to search for.\n     * @returns {number} Returns the index of the matched value, else `-1`.\n     * @example\n     *\n     * _.sortedIndexOf([4, 5, 5, 5, 6], 5);\n     * // => 1\n     */\n    function sortedIndexOf(array, value) {\n      var length = array == null ? 0 : array.length;\n      if (length) {\n        var index = baseSortedIndex(array, value);\n        if (index < length && eq(array[index], value)) {\n          return index;\n        }\n      }\n      return -1;\n    }\n\n    /**\n     * This method is like `_.sortedIndex` except that it returns the highest\n     * index at which `value` should be inserted into `array` in order to\n     * maintain its sort order.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The sorted array to inspect.\n     * @param {*} value The value to evaluate.\n     * @returns {number} Returns the index at which `value` should be inserted\n     *  into `array`.\n     * @example\n     *\n     * _.sortedLastIndex([4, 5, 5, 5, 6], 5);\n     * // => 4\n     */\n    function sortedLastIndex(array, value) {\n      return baseSortedIndex(array, value, true);\n    }\n\n    /**\n     * This method is like `_.sortedLastIndex` except that it accepts `iteratee`\n     * which is invoked for `value` and each element of `array` to compute their\n     * sort ranking. The iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The sorted array to inspect.\n     * @param {*} value The value to evaluate.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {number} Returns the index at which `value` should be inserted\n     *  into `array`.\n     * @example\n     *\n     * var objects = [{ 'x': 4 }, { 'x': 5 }];\n     *\n     * _.sortedLastIndexBy(objects, { 'x': 4 }, function(o) { return o.x; });\n     * // => 1\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.sortedLastIndexBy(objects, { 'x': 4 }, 'x');\n     * // => 1\n     */\n    function sortedLastIndexBy(array, value, iteratee) {\n      return baseSortedIndexBy(array, value, getIteratee(iteratee, 2), true);\n    }\n\n    /**\n     * This method is like `_.lastIndexOf` except that it performs a binary\n     * search on a sorted `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {*} value The value to search for.\n     * @returns {number} Returns the index of the matched value, else `-1`.\n     * @example\n     *\n     * _.sortedLastIndexOf([4, 5, 5, 5, 6], 5);\n     * // => 3\n     */\n    function sortedLastIndexOf(array, value) {\n      var length = array == null ? 0 : array.length;\n      if (length) {\n        var index = baseSortedIndex(array, value, true) - 1;\n        if (eq(array[index], value)) {\n          return index;\n        }\n      }\n      return -1;\n    }\n\n    /**\n     * This method is like `_.uniq` except that it's designed and optimized\n     * for sorted arrays.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @returns {Array} Returns the new duplicate free array.\n     * @example\n     *\n     * _.sortedUniq([1, 1, 2]);\n     * // => [1, 2]\n     */\n    function sortedUniq(array) {\n      return (array && array.length)\n        ? baseSortedUniq(array)\n        : [];\n    }\n\n    /**\n     * This method is like `_.uniqBy` except that it's designed and optimized\n     * for sorted arrays.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {Function} [iteratee] The iteratee invoked per element.\n     * @returns {Array} Returns the new duplicate free array.\n     * @example\n     *\n     * _.sortedUniqBy([1.1, 1.2, 2.3, 2.4], Math.floor);\n     * // => [1.1, 2.3]\n     */\n    function sortedUniqBy(array, iteratee) {\n      return (array && array.length)\n        ? baseSortedUniq(array, getIteratee(iteratee, 2))\n        : [];\n    }\n\n    /**\n     * Gets all but the first element of `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * _.tail([1, 2, 3]);\n     * // => [2, 3]\n     */\n    function tail(array) {\n      var length = array == null ? 0 : array.length;\n      return length ? baseSlice(array, 1, length) : [];\n    }\n\n    /**\n     * Creates a slice of `array` with `n` elements taken from the beginning.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {number} [n=1] The number of elements to take.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * _.take([1, 2, 3]);\n     * // => [1]\n     *\n     * _.take([1, 2, 3], 2);\n     * // => [1, 2]\n     *\n     * _.take([1, 2, 3], 5);\n     * // => [1, 2, 3]\n     *\n     * _.take([1, 2, 3], 0);\n     * // => []\n     */\n    function take(array, n, guard) {\n      if (!(array && array.length)) {\n        return [];\n      }\n      n = (guard || n === undefined) ? 1 : toInteger(n);\n      return baseSlice(array, 0, n < 0 ? 0 : n);\n    }\n\n    /**\n     * Creates a slice of `array` with `n` elements taken from the end.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {number} [n=1] The number of elements to take.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * _.takeRight([1, 2, 3]);\n     * // => [3]\n     *\n     * _.takeRight([1, 2, 3], 2);\n     * // => [2, 3]\n     *\n     * _.takeRight([1, 2, 3], 5);\n     * // => [1, 2, 3]\n     *\n     * _.takeRight([1, 2, 3], 0);\n     * // => []\n     */\n    function takeRight(array, n, guard) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return [];\n      }\n      n = (guard || n === undefined) ? 1 : toInteger(n);\n      n = length - n;\n      return baseSlice(array, n < 0 ? 0 : n, length);\n    }\n\n    /**\n     * Creates a slice of `array` with elements taken from the end. Elements are\n     * taken until `predicate` returns falsey. The predicate is invoked with\n     * three arguments: (value, index, array).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'active': true },\n     *   { 'user': 'fred',    'active': false },\n     *   { 'user': 'pebbles', 'active': false }\n     * ];\n     *\n     * _.takeRightWhile(users, function(o) { return !o.active; });\n     * // => objects for ['fred', 'pebbles']\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.takeRightWhile(users, { 'user': 'pebbles', 'active': false });\n     * // => objects for ['pebbles']\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.takeRightWhile(users, ['active', false]);\n     * // => objects for ['fred', 'pebbles']\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.takeRightWhile(users, 'active');\n     * // => []\n     */\n    function takeRightWhile(array, predicate) {\n      return (array && array.length)\n        ? baseWhile(array, getIteratee(predicate, 3), false, true)\n        : [];\n    }\n\n    /**\n     * Creates a slice of `array` with elements taken from the beginning. Elements\n     * are taken until `predicate` returns falsey. The predicate is invoked with\n     * three arguments: (value, index, array).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'active': false },\n     *   { 'user': 'fred',    'active': false },\n     *   { 'user': 'pebbles', 'active': true }\n     * ];\n     *\n     * _.takeWhile(users, function(o) { return !o.active; });\n     * // => objects for ['barney', 'fred']\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.takeWhile(users, { 'user': 'barney', 'active': false });\n     * // => objects for ['barney']\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.takeWhile(users, ['active', false]);\n     * // => objects for ['barney', 'fred']\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.takeWhile(users, 'active');\n     * // => []\n     */\n    function takeWhile(array, predicate) {\n      return (array && array.length)\n        ? baseWhile(array, getIteratee(predicate, 3))\n        : [];\n    }\n\n    /**\n     * Creates an array of unique values, in order, from all given arrays using\n     * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @returns {Array} Returns the new array of combined values.\n     * @example\n     *\n     * _.union([2], [1, 2]);\n     * // => [2, 1]\n     */\n    var union = baseRest(function(arrays) {\n      return baseUniq(baseFlatten(arrays, 1, isArrayLikeObject, true));\n    });\n\n    /**\n     * This method is like `_.union` except that it accepts `iteratee` which is\n     * invoked for each element of each `arrays` to generate the criterion by\n     * which uniqueness is computed. Result values are chosen from the first\n     * array in which the value occurs. The iteratee is invoked with one argument:\n     * (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {Array} Returns the new array of combined values.\n     * @example\n     *\n     * _.unionBy([2.1], [1.2, 2.3], Math.floor);\n     * // => [2.1, 1.2]\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.unionBy([{ 'x': 1 }], [{ 'x': 2 }, { 'x': 1 }], 'x');\n     * // => [{ 'x': 1 }, { 'x': 2 }]\n     */\n    var unionBy = baseRest(function(arrays) {\n      var iteratee = last(arrays);\n      if (isArrayLikeObject(iteratee)) {\n        iteratee = undefined;\n      }\n      return baseUniq(baseFlatten(arrays, 1, isArrayLikeObject, true), getIteratee(iteratee, 2));\n    });\n\n    /**\n     * This method is like `_.union` except that it accepts `comparator` which\n     * is invoked to compare elements of `arrays`. Result values are chosen from\n     * the first array in which the value occurs. The comparator is invoked\n     * with two arguments: (arrVal, othVal).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new array of combined values.\n     * @example\n     *\n     * var objects = [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }];\n     * var others = [{ 'x': 1, 'y': 1 }, { 'x': 1, 'y': 2 }];\n     *\n     * _.unionWith(objects, others, _.isEqual);\n     * // => [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }, { 'x': 1, 'y': 1 }]\n     */\n    var unionWith = baseRest(function(arrays) {\n      var comparator = last(arrays);\n      comparator = typeof comparator == 'function' ? comparator : undefined;\n      return baseUniq(baseFlatten(arrays, 1, isArrayLikeObject, true), undefined, comparator);\n    });\n\n    /**\n     * Creates a duplicate-free version of an array, using\n     * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons, in which only the first occurrence of each element\n     * is kept. The order of result values is determined by the order they occur\n     * in the array.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @returns {Array} Returns the new duplicate free array.\n     * @example\n     *\n     * _.uniq([2, 1, 2]);\n     * // => [2, 1]\n     */\n    function uniq(array) {\n      return (array && array.length) ? baseUniq(array) : [];\n    }\n\n    /**\n     * This method is like `_.uniq` except that it accepts `iteratee` which is\n     * invoked for each element in `array` to generate the criterion by which\n     * uniqueness is computed. The order of result values is determined by the\n     * order they occur in the array. The iteratee is invoked with one argument:\n     * (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {Array} Returns the new duplicate free array.\n     * @example\n     *\n     * _.uniqBy([2.1, 1.2, 2.3], Math.floor);\n     * // => [2.1, 1.2]\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.uniqBy([{ 'x': 1 }, { 'x': 2 }, { 'x': 1 }], 'x');\n     * // => [{ 'x': 1 }, { 'x': 2 }]\n     */\n    function uniqBy(array, iteratee) {\n      return (array && array.length) ? baseUniq(array, getIteratee(iteratee, 2)) : [];\n    }\n\n    /**\n     * This method is like `_.uniq` except that it accepts `comparator` which\n     * is invoked to compare elements of `array`. The order of result values is\n     * determined by the order they occur in the array.The comparator is invoked\n     * with two arguments: (arrVal, othVal).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new duplicate free array.\n     * @example\n     *\n     * var objects = [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }, { 'x': 1, 'y': 2 }];\n     *\n     * _.uniqWith(objects, _.isEqual);\n     * // => [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }]\n     */\n    function uniqWith(array, comparator) {\n      comparator = typeof comparator == 'function' ? comparator : undefined;\n      return (array && array.length) ? baseUniq(array, undefined, comparator) : [];\n    }\n\n    /**\n     * This method is like `_.zip` except that it accepts an array of grouped\n     * elements and creates an array regrouping the elements to their pre-zip\n     * configuration.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.2.0\n     * @category Array\n     * @param {Array} array The array of grouped elements to process.\n     * @returns {Array} Returns the new array of regrouped elements.\n     * @example\n     *\n     * var zipped = _.zip(['a', 'b'], [1, 2], [true, false]);\n     * // => [['a', 1, true], ['b', 2, false]]\n     *\n     * _.unzip(zipped);\n     * // => [['a', 'b'], [1, 2], [true, false]]\n     */\n    function unzip(array) {\n      if (!(array && array.length)) {\n        return [];\n      }\n      var length = 0;\n      array = arrayFilter(array, function(group) {\n        if (isArrayLikeObject(group)) {\n          length = nativeMax(group.length, length);\n          return true;\n        }\n      });\n      return baseTimes(length, function(index) {\n        return arrayMap(array, baseProperty(index));\n      });\n    }\n\n    /**\n     * This method is like `_.unzip` except that it accepts `iteratee` to specify\n     * how regrouped values should be combined. The iteratee is invoked with the\n     * elements of each group: (...group).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.8.0\n     * @category Array\n     * @param {Array} array The array of grouped elements to process.\n     * @param {Function} [iteratee=_.identity] The function to combine\n     *  regrouped values.\n     * @returns {Array} Returns the new array of regrouped elements.\n     * @example\n     *\n     * var zipped = _.zip([1, 2], [10, 20], [100, 200]);\n     * // => [[1, 10, 100], [2, 20, 200]]\n     *\n     * _.unzipWith(zipped, _.add);\n     * // => [3, 30, 300]\n     */\n    function unzipWith(array, iteratee) {\n      if (!(array && array.length)) {\n        return [];\n      }\n      var result = unzip(array);\n      if (iteratee == null) {\n        return result;\n      }\n      return arrayMap(result, function(group) {\n        return apply(iteratee, undefined, group);\n      });\n    }\n\n    /**\n     * Creates an array excluding all given values using\n     * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons.\n     *\n     * **Note:** Unlike `_.pull`, this method returns a new array.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {...*} [values] The values to exclude.\n     * @returns {Array} Returns the new array of filtered values.\n     * @see _.difference, _.xor\n     * @example\n     *\n     * _.without([2, 1, 2, 3], 1, 2);\n     * // => [3]\n     */\n    var without = baseRest(function(array, values) {\n      return isArrayLikeObject(array)\n        ? baseDifference(array, values)\n        : [];\n    });\n\n    /**\n     * Creates an array of unique values that is the\n     * [symmetric difference](https://en.wikipedia.org/wiki/Symmetric_difference)\n     * of the given arrays. The order of result values is determined by the order\n     * they occur in the arrays.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.4.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @returns {Array} Returns the new array of filtered values.\n     * @see _.difference, _.without\n     * @example\n     *\n     * _.xor([2, 1], [2, 3]);\n     * // => [1, 3]\n     */\n    var xor = baseRest(function(arrays) {\n      return baseXor(arrayFilter(arrays, isArrayLikeObject));\n    });\n\n    /**\n     * This method is like `_.xor` except that it accepts `iteratee` which is\n     * invoked for each element of each `arrays` to generate the criterion by\n     * which by which they're compared. The order of result values is determined\n     * by the order they occur in the arrays. The iteratee is invoked with one\n     * argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {Array} Returns the new array of filtered values.\n     * @example\n     *\n     * _.xorBy([2.1, 1.2], [2.3, 3.4], Math.floor);\n     * // => [1.2, 3.4]\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.xorBy([{ 'x': 1 }], [{ 'x': 2 }, { 'x': 1 }], 'x');\n     * // => [{ 'x': 2 }]\n     */\n    var xorBy = baseRest(function(arrays) {\n      var iteratee = last(arrays);\n      if (isArrayLikeObject(iteratee)) {\n        iteratee = undefined;\n      }\n      return baseXor(arrayFilter(arrays, isArrayLikeObject), getIteratee(iteratee, 2));\n    });\n\n    /**\n     * This method is like `_.xor` except that it accepts `comparator` which is\n     * invoked to compare elements of `arrays`. The order of result values is\n     * determined by the order they occur in the arrays. The comparator is invoked\n     * with two arguments: (arrVal, othVal).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new array of filtered values.\n     * @example\n     *\n     * var objects = [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }];\n     * var others = [{ 'x': 1, 'y': 1 }, { 'x': 1, 'y': 2 }];\n     *\n     * _.xorWith(objects, others, _.isEqual);\n     * // => [{ 'x': 2, 'y': 1 }, { 'x': 1, 'y': 1 }]\n     */\n    var xorWith = baseRest(function(arrays) {\n      var comparator = last(arrays);\n      comparator = typeof comparator == 'function' ? comparator : undefined;\n      return baseXor(arrayFilter(arrays, isArrayLikeObject), undefined, comparator);\n    });\n\n    /**\n     * Creates an array of grouped elements, the first of which contains the\n     * first elements of the given arrays, the second of which contains the\n     * second elements of the given arrays, and so on.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to process.\n     * @returns {Array} Returns the new array of grouped elements.\n     * @example\n     *\n     * _.zip(['a', 'b'], [1, 2], [true, false]);\n     * // => [['a', 1, true], ['b', 2, false]]\n     */\n    var zip = baseRest(unzip);\n\n    /**\n     * This method is like `_.fromPairs` except that it accepts two arrays,\n     * one of property identifiers and one of corresponding values.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.4.0\n     * @category Array\n     * @param {Array} [props=[]] The property identifiers.\n     * @param {Array} [values=[]] The property values.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * _.zipObject(['a', 'b'], [1, 2]);\n     * // => { 'a': 1, 'b': 2 }\n     */\n    function zipObject(props, values) {\n      return baseZipObject(props || [], values || [], assignValue);\n    }\n\n    /**\n     * This method is like `_.zipObject` except that it supports property paths.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.1.0\n     * @category Array\n     * @param {Array} [props=[]] The property identifiers.\n     * @param {Array} [values=[]] The property values.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * _.zipObjectDeep(['a.b[0].c', 'a.b[1].d'], [1, 2]);\n     * // => { 'a': { 'b': [{ 'c': 1 }, { 'd': 2 }] } }\n     */\n    function zipObjectDeep(props, values) {\n      return baseZipObject(props || [], values || [], baseSet);\n    }\n\n    /**\n     * This method is like `_.zip` except that it accepts `iteratee` to specify\n     * how grouped values should be combined. The iteratee is invoked with the\n     * elements of each group: (...group).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.8.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to process.\n     * @param {Function} [iteratee=_.identity] The function to combine\n     *  grouped values.\n     * @returns {Array} Returns the new array of grouped elements.\n     * @example\n     *\n     * _.zipWith([1, 2], [10, 20], [100, 200], function(a, b, c) {\n     *   return a + b + c;\n     * });\n     * // => [111, 222]\n     */\n    var zipWith = baseRest(function(arrays) {\n      var length = arrays.length,\n          iteratee = length > 1 ? arrays[length - 1] : undefined;\n\n      iteratee = typeof iteratee == 'function' ? (arrays.pop(), iteratee) : undefined;\n      return unzipWith(arrays, iteratee);\n    });\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates a `lodash` wrapper instance that wraps `value` with explicit method\n     * chain sequences enabled. The result of such sequences must be unwrapped\n     * with `_#value`.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.3.0\n     * @category Seq\n     * @param {*} value The value to wrap.\n     * @returns {Object} Returns the new `lodash` wrapper instance.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'age': 36 },\n     *   { 'user': 'fred',    'age': 40 },\n     *   { 'user': 'pebbles', 'age': 1 }\n     * ];\n     *\n     * var youngest = _\n     *   .chain(users)\n     *   .sortBy('age')\n     *   .map(function(o) {\n     *     return o.user + ' is ' + o.age;\n     *   })\n     *   .head()\n     *   .value();\n     * // => 'pebbles is 1'\n     */\n    function chain(value) {\n      var result = lodash(value);\n      result.__chain__ = true;\n      return result;\n    }\n\n    /**\n     * This method invokes `interceptor` and returns `value`. The interceptor\n     * is invoked with one argument; (value). The purpose of this method is to\n     * \"tap into\" a method chain sequence in order to modify intermediate results.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Seq\n     * @param {*} value The value to provide to `interceptor`.\n     * @param {Function} interceptor The function to invoke.\n     * @returns {*} Returns `value`.\n     * @example\n     *\n     * _([1, 2, 3])\n     *  .tap(function(array) {\n     *    // Mutate input array.\n     *    array.pop();\n     *  })\n     *  .reverse()\n     *  .value();\n     * // => [2, 1]\n     */\n    function tap(value, interceptor) {\n      interceptor(value);\n      return value;\n    }\n\n    /**\n     * This method is like `_.tap` except that it returns the result of `interceptor`.\n     * The purpose of this method is to \"pass thru\" values replacing intermediate\n     * results in a method chain sequence.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Seq\n     * @param {*} value The value to provide to `interceptor`.\n     * @param {Function} interceptor The function to invoke.\n     * @returns {*} Returns the result of `interceptor`.\n     * @example\n     *\n     * _('  abc  ')\n     *  .chain()\n     *  .trim()\n     *  .thru(function(value) {\n     *    return [value];\n     *  })\n     *  .value();\n     * // => ['abc']\n     */\n    function thru(value, interceptor) {\n      return interceptor(value);\n    }\n\n    /**\n     * This method is the wrapper version of `_.at`.\n     *\n     * @name at\n     * @memberOf _\n     * @since 1.0.0\n     * @category Seq\n     * @param {...(string|string[])} [paths] The property paths to pick.\n     * @returns {Object} Returns the new `lodash` wrapper instance.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c': 3 } }, 4] };\n     *\n     * _(object).at(['a[0].b.c', 'a[1]']).value();\n     * // => [3, 4]\n     */\n    var wrapperAt = flatRest(function(paths) {\n      var length = paths.length,\n          start = length ? paths[0] : 0,\n          value = this.__wrapped__,\n          interceptor = function(object) { return baseAt(object, paths); };\n\n      if (length > 1 || this.__actions__.length ||\n          !(value instanceof LazyWrapper) || !isIndex(start)) {\n        return this.thru(interceptor);\n      }\n      value = value.slice(start, +start + (length ? 1 : 0));\n      value.__actions__.push({\n        'func': thru,\n        'args': [interceptor],\n        'thisArg': undefined\n      });\n      return new LodashWrapper(value, this.__chain__).thru(function(array) {\n        if (length && !array.length) {\n          array.push(undefined);\n        }\n        return array;\n      });\n    });\n\n    /**\n     * Creates a `lodash` wrapper instance with explicit method chain sequences enabled.\n     *\n     * @name chain\n     * @memberOf _\n     * @since 0.1.0\n     * @category Seq\n     * @returns {Object} Returns the new `lodash` wrapper instance.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney', 'age': 36 },\n     *   { 'user': 'fred',   'age': 40 }\n     * ];\n     *\n     * // A sequence without explicit chaining.\n     * _(users).head();\n     * // => { 'user': 'barney', 'age': 36 }\n     *\n     * // A sequence with explicit chaining.\n     * _(users)\n     *   .chain()\n     *   .head()\n     *   .pick('user')\n     *   .value();\n     * // => { 'user': 'barney' }\n     */\n    function wrapperChain() {\n      return chain(this);\n    }\n\n    /**\n     * Executes the chain sequence and returns the wrapped result.\n     *\n     * @name commit\n     * @memberOf _\n     * @since 3.2.0\n     * @category Seq\n     * @returns {Object} Returns the new `lodash` wrapper instance.\n     * @example\n     *\n     * var array = [1, 2];\n     * var wrapped = _(array).push(3);\n     *\n     * console.log(array);\n     * // => [1, 2]\n     *\n     * wrapped = wrapped.commit();\n     * console.log(array);\n     * // => [1, 2, 3]\n     *\n     * wrapped.last();\n     * // => 3\n     *\n     * console.log(array);\n     * // => [1, 2, 3]\n     */\n    function wrapperCommit() {\n      return new LodashWrapper(this.value(), this.__chain__);\n    }\n\n    /**\n     * Gets the next value on a wrapped object following the\n     * [iterator protocol](https://mdn.io/iteration_protocols#iterator).\n     *\n     * @name next\n     * @memberOf _\n     * @since 4.0.0\n     * @category Seq\n     * @returns {Object} Returns the next iterator value.\n     * @example\n     *\n     * var wrapped = _([1, 2]);\n     *\n     * wrapped.next();\n     * // => { 'done': false, 'value': 1 }\n     *\n     * wrapped.next();\n     * // => { 'done': false, 'value': 2 }\n     *\n     * wrapped.next();\n     * // => { 'done': true, 'value': undefined }\n     */\n    function wrapperNext() {\n      if (this.__values__ === undefined) {\n        this.__values__ = toArray(this.value());\n      }\n      var done = this.__index__ >= this.__values__.length,\n          value = done ? undefined : this.__values__[this.__index__++];\n\n      return { 'done': done, 'value': value };\n    }\n\n    /**\n     * Enables the wrapper to be iterable.\n     *\n     * @name Symbol.iterator\n     * @memberOf _\n     * @since 4.0.0\n     * @category Seq\n     * @returns {Object} Returns the wrapper object.\n     * @example\n     *\n     * var wrapped = _([1, 2]);\n     *\n     * wrapped[Symbol.iterator]() === wrapped;\n     * // => true\n     *\n     * Array.from(wrapped);\n     * // => [1, 2]\n     */\n    function wrapperToIterator() {\n      return this;\n    }\n\n    /**\n     * Creates a clone of the chain sequence planting `value` as the wrapped value.\n     *\n     * @name plant\n     * @memberOf _\n     * @since 3.2.0\n     * @category Seq\n     * @param {*} value The value to plant.\n     * @returns {Object} Returns the new `lodash` wrapper instance.\n     * @example\n     *\n     * function square(n) {\n     *   return n * n;\n     * }\n     *\n     * var wrapped = _([1, 2]).map(square);\n     * var other = wrapped.plant([3, 4]);\n     *\n     * other.value();\n     * // => [9, 16]\n     *\n     * wrapped.value();\n     * // => [1, 4]\n     */\n    function wrapperPlant(value) {\n      var result,\n          parent = this;\n\n      while (parent instanceof baseLodash) {\n        var clone = wrapperClone(parent);\n        clone.__index__ = 0;\n        clone.__values__ = undefined;\n        if (result) {\n          previous.__wrapped__ = clone;\n        } else {\n          result = clone;\n        }\n        var previous = clone;\n        parent = parent.__wrapped__;\n      }\n      previous.__wrapped__ = value;\n      return result;\n    }\n\n    /**\n     * This method is the wrapper version of `_.reverse`.\n     *\n     * **Note:** This method mutates the wrapped array.\n     *\n     * @name reverse\n     * @memberOf _\n     * @since 0.1.0\n     * @category Seq\n     * @returns {Object} Returns the new `lodash` wrapper instance.\n     * @example\n     *\n     * var array = [1, 2, 3];\n     *\n     * _(array).reverse().value()\n     * // => [3, 2, 1]\n     *\n     * console.log(array);\n     * // => [3, 2, 1]\n     */\n    function wrapperReverse() {\n      var value = this.__wrapped__;\n      if (value instanceof LazyWrapper) {\n        var wrapped = value;\n        if (this.__actions__.length) {\n          wrapped = new LazyWrapper(this);\n        }\n        wrapped = wrapped.reverse();\n        wrapped.__actions__.push({\n          'func': thru,\n          'args': [reverse],\n          'thisArg': undefined\n        });\n        return new LodashWrapper(wrapped, this.__chain__);\n      }\n      return this.thru(reverse);\n    }\n\n    /**\n     * Executes the chain sequence to resolve the unwrapped value.\n     *\n     * @name value\n     * @memberOf _\n     * @since 0.1.0\n     * @alias toJSON, valueOf\n     * @category Seq\n     * @returns {*} Returns the resolved unwrapped value.\n     * @example\n     *\n     * _([1, 2, 3]).value();\n     * // => [1, 2, 3]\n     */\n    function wrapperValue() {\n      return baseWrapperValue(this.__wrapped__, this.__actions__);\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates an object composed of keys generated from the results of running\n     * each element of `collection` thru `iteratee`. The corresponding value of\n     * each key is the number of times the key was returned by `iteratee`. The\n     * iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.5.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The iteratee to transform keys.\n     * @returns {Object} Returns the composed aggregate object.\n     * @example\n     *\n     * _.countBy([6.1, 4.2, 6.3], Math.floor);\n     * // => { '4': 1, '6': 2 }\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.countBy(['one', 'two', 'three'], 'length');\n     * // => { '3': 2, '5': 1 }\n     */\n    var countBy = createAggregator(function(result, value, key) {\n      if (hasOwnProperty.call(result, key)) {\n        ++result[key];\n      } else {\n        baseAssignValue(result, key, 1);\n      }\n    });\n\n    /**\n     * Checks if `predicate` returns truthy for **all** elements of `collection`.\n     * Iteration is stopped once `predicate` returns falsey. The predicate is\n     * invoked with three arguments: (value, index|key, collection).\n     *\n     * **Note:** This method returns `true` for\n     * [empty collections](https://en.wikipedia.org/wiki/Empty_set) because\n     * [everything is true](https://en.wikipedia.org/wiki/Vacuous_truth) of\n     * elements of empty collections.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {boolean} Returns `true` if all elements pass the predicate check,\n     *  else `false`.\n     * @example\n     *\n     * _.every([true, 1, null, 'yes'], Boolean);\n     * // => false\n     *\n     * var users = [\n     *   { 'user': 'barney', 'age': 36, 'active': false },\n     *   { 'user': 'fred',   'age': 40, 'active': false }\n     * ];\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.every(users, { 'user': 'barney', 'active': false });\n     * // => false\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.every(users, ['active', false]);\n     * // => true\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.every(users, 'active');\n     * // => false\n     */\n    function every(collection, predicate, guard) {\n      var func = isArray(collection) ? arrayEvery : baseEvery;\n      if (guard && isIterateeCall(collection, predicate, guard)) {\n        predicate = undefined;\n      }\n      return func(collection, getIteratee(predicate, 3));\n    }\n\n    /**\n     * Iterates over elements of `collection`, returning an array of all elements\n     * `predicate` returns truthy for. The predicate is invoked with three\n     * arguments: (value, index|key, collection).\n     *\n     * **Note:** Unlike `_.remove`, this method returns a new array.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the new filtered array.\n     * @see _.reject\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney', 'age': 36, 'active': true },\n     *   { 'user': 'fred',   'age': 40, 'active': false }\n     * ];\n     *\n     * _.filter(users, function(o) { return !o.active; });\n     * // => objects for ['fred']\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.filter(users, { 'age': 36, 'active': true });\n     * // => objects for ['barney']\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.filter(users, ['active', false]);\n     * // => objects for ['fred']\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.filter(users, 'active');\n     * // => objects for ['barney']\n     *\n     * // Combining several predicates using `_.overEvery` or `_.overSome`.\n     * _.filter(users, _.overSome([{ 'age': 36 }, ['age', 40]]));\n     * // => objects for ['fred', 'barney']\n     */\n    function filter(collection, predicate) {\n      var func = isArray(collection) ? arrayFilter : baseFilter;\n      return func(collection, getIteratee(predicate, 3));\n    }\n\n    /**\n     * Iterates over elements of `collection`, returning the first element\n     * `predicate` returns truthy for. The predicate is invoked with three\n     * arguments: (value, index|key, collection).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to inspect.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @param {number} [fromIndex=0] The index to search from.\n     * @returns {*} Returns the matched element, else `undefined`.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'age': 36, 'active': true },\n     *   { 'user': 'fred',    'age': 40, 'active': false },\n     *   { 'user': 'pebbles', 'age': 1,  'active': true }\n     * ];\n     *\n     * _.find(users, function(o) { return o.age < 40; });\n     * // => object for 'barney'\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.find(users, { 'age': 1, 'active': true });\n     * // => object for 'pebbles'\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.find(users, ['active', false]);\n     * // => object for 'fred'\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.find(users, 'active');\n     * // => object for 'barney'\n     */\n    var find = createFind(findIndex);\n\n    /**\n     * This method is like `_.find` except that it iterates over elements of\n     * `collection` from right to left.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to inspect.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @param {number} [fromIndex=collection.length-1] The index to search from.\n     * @returns {*} Returns the matched element, else `undefined`.\n     * @example\n     *\n     * _.findLast([1, 2, 3, 4], function(n) {\n     *   return n % 2 == 1;\n     * });\n     * // => 3\n     */\n    var findLast = createFind(findLastIndex);\n\n    /**\n     * Creates a flattened array of values by running each element in `collection`\n     * thru `iteratee` and flattening the mapped results. The iteratee is invoked\n     * with three arguments: (value, index|key, collection).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the new flattened array.\n     * @example\n     *\n     * function duplicate(n) {\n     *   return [n, n];\n     * }\n     *\n     * _.flatMap([1, 2], duplicate);\n     * // => [1, 1, 2, 2]\n     */\n    function flatMap(collection, iteratee) {\n      return baseFlatten(map(collection, iteratee), 1);\n    }\n\n    /**\n     * This method is like `_.flatMap` except that it recursively flattens the\n     * mapped results.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.7.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the new flattened array.\n     * @example\n     *\n     * function duplicate(n) {\n     *   return [[[n, n]]];\n     * }\n     *\n     * _.flatMapDeep([1, 2], duplicate);\n     * // => [1, 1, 2, 2]\n     */\n    function flatMapDeep(collection, iteratee) {\n      return baseFlatten(map(collection, iteratee), INFINITY);\n    }\n\n    /**\n     * This method is like `_.flatMap` except that it recursively flattens the\n     * mapped results up to `depth` times.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.7.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @param {number} [depth=1] The maximum recursion depth.\n     * @returns {Array} Returns the new flattened array.\n     * @example\n     *\n     * function duplicate(n) {\n     *   return [[[n, n]]];\n     * }\n     *\n     * _.flatMapDepth([1, 2], duplicate, 2);\n     * // => [[1, 1], [2, 2]]\n     */\n    function flatMapDepth(collection, iteratee, depth) {\n      depth = depth === undefined ? 1 : toInteger(depth);\n      return baseFlatten(map(collection, iteratee), depth);\n    }\n\n    /**\n     * Iterates over elements of `collection` and invokes `iteratee` for each element.\n     * The iteratee is invoked with three arguments: (value, index|key, collection).\n     * Iteratee functions may exit iteration early by explicitly returning `false`.\n     *\n     * **Note:** As with other \"Collections\" methods, objects with a \"length\"\n     * property are iterated like arrays. To avoid this behavior use `_.forIn`\n     * or `_.forOwn` for object iteration.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @alias each\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Array|Object} Returns `collection`.\n     * @see _.forEachRight\n     * @example\n     *\n     * _.forEach([1, 2], function(value) {\n     *   console.log(value);\n     * });\n     * // => Logs `1` then `2`.\n     *\n     * _.forEach({ 'a': 1, 'b': 2 }, function(value, key) {\n     *   console.log(key);\n     * });\n     * // => Logs 'a' then 'b' (iteration order is not guaranteed).\n     */\n    function forEach(collection, iteratee) {\n      var func = isArray(collection) ? arrayEach : baseEach;\n      return func(collection, getIteratee(iteratee, 3));\n    }\n\n    /**\n     * This method is like `_.forEach` except that it iterates over elements of\n     * `collection` from right to left.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @alias eachRight\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Array|Object} Returns `collection`.\n     * @see _.forEach\n     * @example\n     *\n     * _.forEachRight([1, 2], function(value) {\n     *   console.log(value);\n     * });\n     * // => Logs `2` then `1`.\n     */\n    function forEachRight(collection, iteratee) {\n      var func = isArray(collection) ? arrayEachRight : baseEachRight;\n      return func(collection, getIteratee(iteratee, 3));\n    }\n\n    /**\n     * Creates an object composed of keys generated from the results of running\n     * each element of `collection` thru `iteratee`. The order of grouped values\n     * is determined by the order they occur in `collection`. The corresponding\n     * value of each key is an array of elements responsible for generating the\n     * key. The iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The iteratee to transform keys.\n     * @returns {Object} Returns the composed aggregate object.\n     * @example\n     *\n     * _.groupBy([6.1, 4.2, 6.3], Math.floor);\n     * // => { '4': [4.2], '6': [6.1, 6.3] }\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.groupBy(['one', 'two', 'three'], 'length');\n     * // => { '3': ['one', 'two'], '5': ['three'] }\n     */\n    var groupBy = createAggregator(function(result, value, key) {\n      if (hasOwnProperty.call(result, key)) {\n        result[key].push(value);\n      } else {\n        baseAssignValue(result, key, [value]);\n      }\n    });\n\n    /**\n     * Checks if `value` is in `collection`. If `collection` is a string, it's\n     * checked for a substring of `value`, otherwise\n     * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * is used for equality comparisons. If `fromIndex` is negative, it's used as\n     * the offset from the end of `collection`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object|string} collection The collection to inspect.\n     * @param {*} value The value to search for.\n     * @param {number} [fromIndex=0] The index to search from.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.reduce`.\n     * @returns {boolean} Returns `true` if `value` is found, else `false`.\n     * @example\n     *\n     * _.includes([1, 2, 3], 1);\n     * // => true\n     *\n     * _.includes([1, 2, 3], 1, 2);\n     * // => false\n     *\n     * _.includes({ 'a': 1, 'b': 2 }, 1);\n     * // => true\n     *\n     * _.includes('abcd', 'bc');\n     * // => true\n     */\n    function includes(collection, value, fromIndex, guard) {\n      collection = isArrayLike(collection) ? collection : values(collection);\n      fromIndex = (fromIndex && !guard) ? toInteger(fromIndex) : 0;\n\n      var length = collection.length;\n      if (fromIndex < 0) {\n        fromIndex = nativeMax(length + fromIndex, 0);\n      }\n      return isString(collection)\n        ? (fromIndex <= length && collection.indexOf(value, fromIndex) > -1)\n        : (!!length && baseIndexOf(collection, value, fromIndex) > -1);\n    }\n\n    /**\n     * Invokes the method at `path` of each element in `collection`, returning\n     * an array of the results of each invoked method. Any additional arguments\n     * are provided to each invoked method. If `path` is a function, it's invoked\n     * for, and `this` bound to, each element in `collection`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Array|Function|string} path The path of the method to invoke or\n     *  the function invoked per iteration.\n     * @param {...*} [args] The arguments to invoke each method with.\n     * @returns {Array} Returns the array of results.\n     * @example\n     *\n     * _.invokeMap([[5, 1, 7], [3, 2, 1]], 'sort');\n     * // => [[1, 5, 7], [1, 2, 3]]\n     *\n     * _.invokeMap([123, 456], String.prototype.split, '');\n     * // => [['1', '2', '3'], ['4', '5', '6']]\n     */\n    var invokeMap = baseRest(function(collection, path, args) {\n      var index = -1,\n          isFunc = typeof path == 'function',\n          result = isArrayLike(collection) ? Array(collection.length) : [];\n\n      baseEach(collection, function(value) {\n        result[++index] = isFunc ? apply(path, value, args) : baseInvoke(value, path, args);\n      });\n      return result;\n    });\n\n    /**\n     * Creates an object composed of keys generated from the results of running\n     * each element of `collection` thru `iteratee`. The corresponding value of\n     * each key is the last element responsible for generating the key. The\n     * iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The iteratee to transform keys.\n     * @returns {Object} Returns the composed aggregate object.\n     * @example\n     *\n     * var array = [\n     *   { 'dir': 'left', 'code': 97 },\n     *   { 'dir': 'right', 'code': 100 }\n     * ];\n     *\n     * _.keyBy(array, function(o) {\n     *   return String.fromCharCode(o.code);\n     * });\n     * // => { 'a': { 'dir': 'left', 'code': 97 }, 'd': { 'dir': 'right', 'code': 100 } }\n     *\n     * _.keyBy(array, 'dir');\n     * // => { 'left': { 'dir': 'left', 'code': 97 }, 'right': { 'dir': 'right', 'code': 100 } }\n     */\n    var keyBy = createAggregator(function(result, value, key) {\n      baseAssignValue(result, key, value);\n    });\n\n    /**\n     * Creates an array of values by running each element in `collection` thru\n     * `iteratee`. The iteratee is invoked with three arguments:\n     * (value, index|key, collection).\n     *\n     * Many lodash methods are guarded to work as iteratees for methods like\n     * `_.every`, `_.filter`, `_.map`, `_.mapValues`, `_.reject`, and `_.some`.\n     *\n     * The guarded methods are:\n     * `ary`, `chunk`, `curry`, `curryRight`, `drop`, `dropRight`, `every`,\n     * `fill`, `invert`, `parseInt`, `random`, `range`, `rangeRight`, `repeat`,\n     * `sampleSize`, `slice`, `some`, `sortBy`, `split`, `take`, `takeRight`,\n     * `template`, `trim`, `trimEnd`, `trimStart`, and `words`\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the new mapped array.\n     * @example\n     *\n     * function square(n) {\n     *   return n * n;\n     * }\n     *\n     * _.map([4, 8], square);\n     * // => [16, 64]\n     *\n     * _.map({ 'a': 4, 'b': 8 }, square);\n     * // => [16, 64] (iteration order is not guaranteed)\n     *\n     * var users = [\n     *   { 'user': 'barney' },\n     *   { 'user': 'fred' }\n     * ];\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.map(users, 'user');\n     * // => ['barney', 'fred']\n     */\n    function map(collection, iteratee) {\n      var func = isArray(collection) ? arrayMap : baseMap;\n      return func(collection, getIteratee(iteratee, 3));\n    }\n\n    /**\n     * This method is like `_.sortBy` except that it allows specifying the sort\n     * orders of the iteratees to sort by. If `orders` is unspecified, all values\n     * are sorted in ascending order. Otherwise, specify an order of \"desc\" for\n     * descending or \"asc\" for ascending sort order of corresponding values.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Array[]|Function[]|Object[]|string[]} [iteratees=[_.identity]]\n     *  The iteratees to sort by.\n     * @param {string[]} [orders] The sort orders of `iteratees`.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.reduce`.\n     * @returns {Array} Returns the new sorted array.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'fred',   'age': 48 },\n     *   { 'user': 'barney', 'age': 34 },\n     *   { 'user': 'fred',   'age': 40 },\n     *   { 'user': 'barney', 'age': 36 }\n     * ];\n     *\n     * // Sort by `user` in ascending order and by `age` in descending order.\n     * _.orderBy(users, ['user', 'age'], ['asc', 'desc']);\n     * // => objects for [['barney', 36], ['barney', 34], ['fred', 48], ['fred', 40]]\n     */\n    function orderBy(collection, iteratees, orders, guard) {\n      if (collection == null) {\n        return [];\n      }\n      if (!isArray(iteratees)) {\n        iteratees = iteratees == null ? [] : [iteratees];\n      }\n      orders = guard ? undefined : orders;\n      if (!isArray(orders)) {\n        orders = orders == null ? [] : [orders];\n      }\n      return baseOrderBy(collection, iteratees, orders);\n    }\n\n    /**\n     * Creates an array of elements split into two groups, the first of which\n     * contains elements `predicate` returns truthy for, the second of which\n     * contains elements `predicate` returns falsey for. The predicate is\n     * invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the array of grouped elements.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'age': 36, 'active': false },\n     *   { 'user': 'fred',    'age': 40, 'active': true },\n     *   { 'user': 'pebbles', 'age': 1,  'active': false }\n     * ];\n     *\n     * _.partition(users, function(o) { return o.active; });\n     * // => objects for [['fred'], ['barney', 'pebbles']]\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.partition(users, { 'age': 1, 'active': false });\n     * // => objects for [['pebbles'], ['barney', 'fred']]\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.partition(users, ['active', false]);\n     * // => objects for [['barney', 'pebbles'], ['fred']]\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.partition(users, 'active');\n     * // => objects for [['fred'], ['barney', 'pebbles']]\n     */\n    var partition = createAggregator(function(result, value, key) {\n      result[key ? 0 : 1].push(value);\n    }, function() { return [[], []]; });\n\n    /**\n     * Reduces `collection` to a value which is the accumulated result of running\n     * each element in `collection` thru `iteratee`, where each successive\n     * invocation is supplied the return value of the previous. If `accumulator`\n     * is not given, the first element of `collection` is used as the initial\n     * value. The iteratee is invoked with four arguments:\n     * (accumulator, value, index|key, collection).\n     *\n     * Many lodash methods are guarded to work as iteratees for methods like\n     * `_.reduce`, `_.reduceRight`, and `_.transform`.\n     *\n     * The guarded methods are:\n     * `assign`, `defaults`, `defaultsDeep`, `includes`, `merge`, `orderBy`,\n     * and `sortBy`\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @param {*} [accumulator] The initial value.\n     * @returns {*} Returns the accumulated value.\n     * @see _.reduceRight\n     * @example\n     *\n     * _.reduce([1, 2], function(sum, n) {\n     *   return sum + n;\n     * }, 0);\n     * // => 3\n     *\n     * _.reduce({ 'a': 1, 'b': 2, 'c': 1 }, function(result, value, key) {\n     *   (result[value] || (result[value] = [])).push(key);\n     *   return result;\n     * }, {});\n     * // => { '1': ['a', 'c'], '2': ['b'] } (iteration order is not guaranteed)\n     */\n    function reduce(collection, iteratee, accumulator) {\n      var func = isArray(collection) ? arrayReduce : baseReduce,\n          initAccum = arguments.length < 3;\n\n      return func(collection, getIteratee(iteratee, 4), accumulator, initAccum, baseEach);\n    }\n\n    /**\n     * This method is like `_.reduce` except that it iterates over elements of\n     * `collection` from right to left.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @param {*} [accumulator] The initial value.\n     * @returns {*} Returns the accumulated value.\n     * @see _.reduce\n     * @example\n     *\n     * var array = [[0, 1], [2, 3], [4, 5]];\n     *\n     * _.reduceRight(array, function(flattened, other) {\n     *   return flattened.concat(other);\n     * }, []);\n     * // => [4, 5, 2, 3, 0, 1]\n     */\n    function reduceRight(collection, iteratee, accumulator) {\n      var func = isArray(collection) ? arrayReduceRight : baseReduce,\n          initAccum = arguments.length < 3;\n\n      return func(collection, getIteratee(iteratee, 4), accumulator, initAccum, baseEachRight);\n    }\n\n    /**\n     * The opposite of `_.filter`; this method returns the elements of `collection`\n     * that `predicate` does **not** return truthy for.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the new filtered array.\n     * @see _.filter\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney', 'age': 36, 'active': false },\n     *   { 'user': 'fred',   'age': 40, 'active': true }\n     * ];\n     *\n     * _.reject(users, function(o) { return !o.active; });\n     * // => objects for ['fred']\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.reject(users, { 'age': 40, 'active': true });\n     * // => objects for ['barney']\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.reject(users, ['active', false]);\n     * // => objects for ['fred']\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.reject(users, 'active');\n     * // => objects for ['barney']\n     */\n    function reject(collection, predicate) {\n      var func = isArray(collection) ? arrayFilter : baseFilter;\n      return func(collection, negate(getIteratee(predicate, 3)));\n    }\n\n    /**\n     * Gets a random element from `collection`.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to sample.\n     * @returns {*} Returns the random element.\n     * @example\n     *\n     * _.sample([1, 2, 3, 4]);\n     * // => 2\n     */\n    function sample(collection) {\n      var func = isArray(collection) ? arraySample : baseSample;\n      return func(collection);\n    }\n\n    /**\n     * Gets `n` random elements at unique keys from `collection` up to the\n     * size of `collection`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to sample.\n     * @param {number} [n=1] The number of elements to sample.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Array} Returns the random elements.\n     * @example\n     *\n     * _.sampleSize([1, 2, 3], 2);\n     * // => [3, 1]\n     *\n     * _.sampleSize([1, 2, 3], 4);\n     * // => [2, 3, 1]\n     */\n    function sampleSize(collection, n, guard) {\n      if ((guard ? isIterateeCall(collection, n, guard) : n === undefined)) {\n        n = 1;\n      } else {\n        n = toInteger(n);\n      }\n      var func = isArray(collection) ? arraySampleSize : baseSampleSize;\n      return func(collection, n);\n    }\n\n    /**\n     * Creates an array of shuffled values, using a version of the\n     * [Fisher-Yates shuffle](https://en.wikipedia.org/wiki/Fisher-Yates_shuffle).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to shuffle.\n     * @returns {Array} Returns the new shuffled array.\n     * @example\n     *\n     * _.shuffle([1, 2, 3, 4]);\n     * // => [4, 1, 3, 2]\n     */\n    function shuffle(collection) {\n      var func = isArray(collection) ? arrayShuffle : baseShuffle;\n      return func(collection);\n    }\n\n    /**\n     * Gets the size of `collection` by returning its length for array-like\n     * values or the number of own enumerable string keyed properties for objects.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object|string} collection The collection to inspect.\n     * @returns {number} Returns the collection size.\n     * @example\n     *\n     * _.size([1, 2, 3]);\n     * // => 3\n     *\n     * _.size({ 'a': 1, 'b': 2 });\n     * // => 2\n     *\n     * _.size('pebbles');\n     * // => 7\n     */\n    function size(collection) {\n      if (collection == null) {\n        return 0;\n      }\n      if (isArrayLike(collection)) {\n        return isString(collection) ? stringSize(collection) : collection.length;\n      }\n      var tag = getTag(collection);\n      if (tag == mapTag || tag == setTag) {\n        return collection.size;\n      }\n      return baseKeys(collection).length;\n    }\n\n    /**\n     * Checks if `predicate` returns truthy for **any** element of `collection`.\n     * Iteration is stopped once `predicate` returns truthy. The predicate is\n     * invoked with three arguments: (value, index|key, collection).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {boolean} Returns `true` if any element passes the predicate check,\n     *  else `false`.\n     * @example\n     *\n     * _.some([null, 0, 'yes', false], Boolean);\n     * // => true\n     *\n     * var users = [\n     *   { 'user': 'barney', 'active': true },\n     *   { 'user': 'fred',   'active': false }\n     * ];\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.some(users, { 'user': 'barney', 'active': false });\n     * // => false\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.some(users, ['active', false]);\n     * // => true\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.some(users, 'active');\n     * // => true\n     */\n    function some(collection, predicate, guard) {\n      var func = isArray(collection) ? arraySome : baseSome;\n      if (guard && isIterateeCall(collection, predicate, guard)) {\n        predicate = undefined;\n      }\n      return func(collection, getIteratee(predicate, 3));\n    }\n\n    /**\n     * Creates an array of elements, sorted in ascending order by the results of\n     * running each element in a collection thru each iteratee. This method\n     * performs a stable sort, that is, it preserves the original sort order of\n     * equal elements. The iteratees are invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {...(Function|Function[])} [iteratees=[_.identity]]\n     *  The iteratees to sort by.\n     * @returns {Array} Returns the new sorted array.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'fred',   'age': 48 },\n     *   { 'user': 'barney', 'age': 36 },\n     *   { 'user': 'fred',   'age': 30 },\n     *   { 'user': 'barney', 'age': 34 }\n     * ];\n     *\n     * _.sortBy(users, [function(o) { return o.user; }]);\n     * // => objects for [['barney', 36], ['barney', 34], ['fred', 48], ['fred', 30]]\n     *\n     * _.sortBy(users, ['user', 'age']);\n     * // => objects for [['barney', 34], ['barney', 36], ['fred', 30], ['fred', 48]]\n     */\n    var sortBy = baseRest(function(collection, iteratees) {\n      if (collection == null) {\n        return [];\n      }\n      var length = iteratees.length;\n      if (length > 1 && isIterateeCall(collection, iteratees[0], iteratees[1])) {\n        iteratees = [];\n      } else if (length > 2 && isIterateeCall(iteratees[0], iteratees[1], iteratees[2])) {\n        iteratees = [iteratees[0]];\n      }\n      return baseOrderBy(collection, baseFlatten(iteratees, 1), []);\n    });\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Gets the timestamp of the number of milliseconds that have elapsed since\n     * the Unix epoch (1 January 1970 00:00:00 UTC).\n     *\n     * @static\n     * @memberOf _\n     * @since 2.4.0\n     * @category Date\n     * @returns {number} Returns the timestamp.\n     * @example\n     *\n     * _.defer(function(stamp) {\n     *   console.log(_.now() - stamp);\n     * }, _.now());\n     * // => Logs the number of milliseconds it took for the deferred invocation.\n     */\n    var now = ctxNow || function() {\n      return root.Date.now();\n    };\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * The opposite of `_.before`; this method creates a function that invokes\n     * `func` once it's called `n` or more times.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {number} n The number of calls before `func` is invoked.\n     * @param {Function} func The function to restrict.\n     * @returns {Function} Returns the new restricted function.\n     * @example\n     *\n     * var saves = ['profile', 'settings'];\n     *\n     * var done = _.after(saves.length, function() {\n     *   console.log('done saving!');\n     * });\n     *\n     * _.forEach(saves, function(type) {\n     *   asyncSave({ 'type': type, 'complete': done });\n     * });\n     * // => Logs 'done saving!' after the two async saves have completed.\n     */\n    function after(n, func) {\n      if (typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      n = toInteger(n);\n      return function() {\n        if (--n < 1) {\n          return func.apply(this, arguments);\n        }\n      };\n    }\n\n    /**\n     * Creates a function that invokes `func`, with up to `n` arguments,\n     * ignoring any additional arguments.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Function\n     * @param {Function} func The function to cap arguments for.\n     * @param {number} [n=func.length] The arity cap.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Function} Returns the new capped function.\n     * @example\n     *\n     * _.map(['6', '8', '10'], _.ary(parseInt, 1));\n     * // => [6, 8, 10]\n     */\n    function ary(func, n, guard) {\n      n = guard ? undefined : n;\n      n = (func && n == null) ? func.length : n;\n      return createWrap(func, WRAP_ARY_FLAG, undefined, undefined, undefined, undefined, n);\n    }\n\n    /**\n     * Creates a function that invokes `func`, with the `this` binding and arguments\n     * of the created function, while it's called less than `n` times. Subsequent\n     * calls to the created function return the result of the last `func` invocation.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Function\n     * @param {number} n The number of calls at which `func` is no longer invoked.\n     * @param {Function} func The function to restrict.\n     * @returns {Function} Returns the new restricted function.\n     * @example\n     *\n     * jQuery(element).on('click', _.before(5, addContactToList));\n     * // => Allows adding up to 4 contacts to the list.\n     */\n    function before(n, func) {\n      var result;\n      if (typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      n = toInteger(n);\n      return function() {\n        if (--n > 0) {\n          result = func.apply(this, arguments);\n        }\n        if (n <= 1) {\n          func = undefined;\n        }\n        return result;\n      };\n    }\n\n    /**\n     * Creates a function that invokes `func` with the `this` binding of `thisArg`\n     * and `partials` prepended to the arguments it receives.\n     *\n     * The `_.bind.placeholder` value, which defaults to `_` in monolithic builds,\n     * may be used as a placeholder for partially applied arguments.\n     *\n     * **Note:** Unlike native `Function#bind`, this method doesn't set the \"length\"\n     * property of bound functions.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {Function} func The function to bind.\n     * @param {*} thisArg The `this` binding of `func`.\n     * @param {...*} [partials] The arguments to be partially applied.\n     * @returns {Function} Returns the new bound function.\n     * @example\n     *\n     * function greet(greeting, punctuation) {\n     *   return greeting + ' ' + this.user + punctuation;\n     * }\n     *\n     * var object = { 'user': 'fred' };\n     *\n     * var bound = _.bind(greet, object, 'hi');\n     * bound('!');\n     * // => 'hi fred!'\n     *\n     * // Bound with placeholders.\n     * var bound = _.bind(greet, object, _, '!');\n     * bound('hi');\n     * // => 'hi fred!'\n     */\n    var bind = baseRest(function(func, thisArg, partials) {\n      var bitmask = WRAP_BIND_FLAG;\n      if (partials.length) {\n        var holders = replaceHolders(partials, getHolder(bind));\n        bitmask |= WRAP_PARTIAL_FLAG;\n      }\n      return createWrap(func, bitmask, thisArg, partials, holders);\n    });\n\n    /**\n     * Creates a function that invokes the method at `object[key]` with `partials`\n     * prepended to the arguments it receives.\n     *\n     * This method differs from `_.bind` by allowing bound functions to reference\n     * methods that may be redefined or don't yet exist. See\n     * [Peter Michaux's article](http://peter.michaux.ca/articles/lazy-function-definition-pattern)\n     * for more details.\n     *\n     * The `_.bindKey.placeholder` value, which defaults to `_` in monolithic\n     * builds, may be used as a placeholder for partially applied arguments.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.10.0\n     * @category Function\n     * @param {Object} object The object to invoke the method on.\n     * @param {string} key The key of the method.\n     * @param {...*} [partials] The arguments to be partially applied.\n     * @returns {Function} Returns the new bound function.\n     * @example\n     *\n     * var object = {\n     *   'user': 'fred',\n     *   'greet': function(greeting, punctuation) {\n     *     return greeting + ' ' + this.user + punctuation;\n     *   }\n     * };\n     *\n     * var bound = _.bindKey(object, 'greet', 'hi');\n     * bound('!');\n     * // => 'hi fred!'\n     *\n     * object.greet = function(greeting, punctuation) {\n     *   return greeting + 'ya ' + this.user + punctuation;\n     * };\n     *\n     * bound('!');\n     * // => 'hiya fred!'\n     *\n     * // Bound with placeholders.\n     * var bound = _.bindKey(object, 'greet', _, '!');\n     * bound('hi');\n     * // => 'hiya fred!'\n     */\n    var bindKey = baseRest(function(object, key, partials) {\n      var bitmask = WRAP_BIND_FLAG | WRAP_BIND_KEY_FLAG;\n      if (partials.length) {\n        var holders = replaceHolders(partials, getHolder(bindKey));\n        bitmask |= WRAP_PARTIAL_FLAG;\n      }\n      return createWrap(key, bitmask, object, partials, holders);\n    });\n\n    /**\n     * Creates a function that accepts arguments of `func` and either invokes\n     * `func` returning its result, if at least `arity` number of arguments have\n     * been provided, or returns a function that accepts the remaining `func`\n     * arguments, and so on. The arity of `func` may be specified if `func.length`\n     * is not sufficient.\n     *\n     * The `_.curry.placeholder` value, which defaults to `_` in monolithic builds,\n     * may be used as a placeholder for provided arguments.\n     *\n     * **Note:** This method doesn't set the \"length\" property of curried functions.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Function\n     * @param {Function} func The function to curry.\n     * @param {number} [arity=func.length] The arity of `func`.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Function} Returns the new curried function.\n     * @example\n     *\n     * var abc = function(a, b, c) {\n     *   return [a, b, c];\n     * };\n     *\n     * var curried = _.curry(abc);\n     *\n     * curried(1)(2)(3);\n     * // => [1, 2, 3]\n     *\n     * curried(1, 2)(3);\n     * // => [1, 2, 3]\n     *\n     * curried(1, 2, 3);\n     * // => [1, 2, 3]\n     *\n     * // Curried with placeholders.\n     * curried(1)(_, 3)(2);\n     * // => [1, 2, 3]\n     */\n    function curry(func, arity, guard) {\n      arity = guard ? undefined : arity;\n      var result = createWrap(func, WRAP_CURRY_FLAG, undefined, undefined, undefined, undefined, undefined, arity);\n      result.placeholder = curry.placeholder;\n      return result;\n    }\n\n    /**\n     * This method is like `_.curry` except that arguments are applied to `func`\n     * in the manner of `_.partialRight` instead of `_.partial`.\n     *\n     * The `_.curryRight.placeholder` value, which defaults to `_` in monolithic\n     * builds, may be used as a placeholder for provided arguments.\n     *\n     * **Note:** This method doesn't set the \"length\" property of curried functions.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Function\n     * @param {Function} func The function to curry.\n     * @param {number} [arity=func.length] The arity of `func`.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Function} Returns the new curried function.\n     * @example\n     *\n     * var abc = function(a, b, c) {\n     *   return [a, b, c];\n     * };\n     *\n     * var curried = _.curryRight(abc);\n     *\n     * curried(3)(2)(1);\n     * // => [1, 2, 3]\n     *\n     * curried(2, 3)(1);\n     * // => [1, 2, 3]\n     *\n     * curried(1, 2, 3);\n     * // => [1, 2, 3]\n     *\n     * // Curried with placeholders.\n     * curried(3)(1, _)(2);\n     * // => [1, 2, 3]\n     */\n    function curryRight(func, arity, guard) {\n      arity = guard ? undefined : arity;\n      var result = createWrap(func, WRAP_CURRY_RIGHT_FLAG, undefined, undefined, undefined, undefined, undefined, arity);\n      result.placeholder = curryRight.placeholder;\n      return result;\n    }\n\n    /**\n     * Creates a debounced function that delays invoking `func` until after `wait`\n     * milliseconds have elapsed since the last time the debounced function was\n     * invoked. The debounced function comes with a `cancel` method to cancel\n     * delayed `func` invocations and a `flush` method to immediately invoke them.\n     * Provide `options` to indicate whether `func` should be invoked on the\n     * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n     * with the last arguments provided to the debounced function. Subsequent\n     * calls to the debounced function return the result of the last `func`\n     * invocation.\n     *\n     * **Note:** If `leading` and `trailing` options are `true`, `func` is\n     * invoked on the trailing edge of the timeout only if the debounced function\n     * is invoked more than once during the `wait` timeout.\n     *\n     * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n     * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n     *\n     * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n     * for details over the differences between `_.debounce` and `_.throttle`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {Function} func The function to debounce.\n     * @param {number} [wait=0] The number of milliseconds to delay.\n     * @param {Object} [options={}] The options object.\n     * @param {boolean} [options.leading=false]\n     *  Specify invoking on the leading edge of the timeout.\n     * @param {number} [options.maxWait]\n     *  The maximum time `func` is allowed to be delayed before it's invoked.\n     * @param {boolean} [options.trailing=true]\n     *  Specify invoking on the trailing edge of the timeout.\n     * @returns {Function} Returns the new debounced function.\n     * @example\n     *\n     * // Avoid costly calculations while the window size is in flux.\n     * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n     *\n     * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n     * jQuery(element).on('click', _.debounce(sendMail, 300, {\n     *   'leading': true,\n     *   'trailing': false\n     * }));\n     *\n     * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n     * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n     * var source = new EventSource('/stream');\n     * jQuery(source).on('message', debounced);\n     *\n     * // Cancel the trailing debounced invocation.\n     * jQuery(window).on('popstate', debounced.cancel);\n     */\n    function debounce(func, wait, options) {\n      var lastArgs,\n          lastThis,\n          maxWait,\n          result,\n          timerId,\n          lastCallTime,\n          lastInvokeTime = 0,\n          leading = false,\n          maxing = false,\n          trailing = true;\n\n      if (typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      wait = toNumber(wait) || 0;\n      if (isObject(options)) {\n        leading = !!options.leading;\n        maxing = 'maxWait' in options;\n        maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n        trailing = 'trailing' in options ? !!options.trailing : trailing;\n      }\n\n      function invokeFunc(time) {\n        var args = lastArgs,\n            thisArg = lastThis;\n\n        lastArgs = lastThis = undefined;\n        lastInvokeTime = time;\n        result = func.apply(thisArg, args);\n        return result;\n      }\n\n      function leadingEdge(time) {\n        // Reset any `maxWait` timer.\n        lastInvokeTime = time;\n        // Start the timer for the trailing edge.\n        timerId = setTimeout(timerExpired, wait);\n        // Invoke the leading edge.\n        return leading ? invokeFunc(time) : result;\n      }\n\n      function remainingWait(time) {\n        var timeSinceLastCall = time - lastCallTime,\n            timeSinceLastInvoke = time - lastInvokeTime,\n            timeWaiting = wait - timeSinceLastCall;\n\n        return maxing\n          ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n          : timeWaiting;\n      }\n\n      function shouldInvoke(time) {\n        var timeSinceLastCall = time - lastCallTime,\n            timeSinceLastInvoke = time - lastInvokeTime;\n\n        // Either this is the first call, activity has stopped and we're at the\n        // trailing edge, the system time has gone backwards and we're treating\n        // it as the trailing edge, or we've hit the `maxWait` limit.\n        return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n          (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n      }\n\n      function timerExpired() {\n        var time = now();\n        if (shouldInvoke(time)) {\n          return trailingEdge(time);\n        }\n        // Restart the timer.\n        timerId = setTimeout(timerExpired, remainingWait(time));\n      }\n\n      function trailingEdge(time) {\n        timerId = undefined;\n\n        // Only invoke if we have `lastArgs` which means `func` has been\n        // debounced at least once.\n        if (trailing && lastArgs) {\n          return invokeFunc(time);\n        }\n        lastArgs = lastThis = undefined;\n        return result;\n      }\n\n      function cancel() {\n        if (timerId !== undefined) {\n          clearTimeout(timerId);\n        }\n        lastInvokeTime = 0;\n        lastArgs = lastCallTime = lastThis = timerId = undefined;\n      }\n\n      function flush() {\n        return timerId === undefined ? result : trailingEdge(now());\n      }\n\n      function debounced() {\n        var time = now(),\n            isInvoking = shouldInvoke(time);\n\n        lastArgs = arguments;\n        lastThis = this;\n        lastCallTime = time;\n\n        if (isInvoking) {\n          if (timerId === undefined) {\n            return leadingEdge(lastCallTime);\n          }\n          if (maxing) {\n            // Handle invocations in a tight loop.\n            clearTimeout(timerId);\n            timerId = setTimeout(timerExpired, wait);\n            return invokeFunc(lastCallTime);\n          }\n        }\n        if (timerId === undefined) {\n          timerId = setTimeout(timerExpired, wait);\n        }\n        return result;\n      }\n      debounced.cancel = cancel;\n      debounced.flush = flush;\n      return debounced;\n    }\n\n    /**\n     * Defers invoking the `func` until the current call stack has cleared. Any\n     * additional arguments are provided to `func` when it's invoked.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {Function} func The function to defer.\n     * @param {...*} [args] The arguments to invoke `func` with.\n     * @returns {number} Returns the timer id.\n     * @example\n     *\n     * _.defer(function(text) {\n     *   console.log(text);\n     * }, 'deferred');\n     * // => Logs 'deferred' after one millisecond.\n     */\n    var defer = baseRest(function(func, args) {\n      return baseDelay(func, 1, args);\n    });\n\n    /**\n     * Invokes `func` after `wait` milliseconds. Any additional arguments are\n     * provided to `func` when it's invoked.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {Function} func The function to delay.\n     * @param {number} wait The number of milliseconds to delay invocation.\n     * @param {...*} [args] The arguments to invoke `func` with.\n     * @returns {number} Returns the timer id.\n     * @example\n     *\n     * _.delay(function(text) {\n     *   console.log(text);\n     * }, 1000, 'later');\n     * // => Logs 'later' after one second.\n     */\n    var delay = baseRest(function(func, wait, args) {\n      return baseDelay(func, toNumber(wait) || 0, args);\n    });\n\n    /**\n     * Creates a function that invokes `func` with arguments reversed.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Function\n     * @param {Function} func The function to flip arguments for.\n     * @returns {Function} Returns the new flipped function.\n     * @example\n     *\n     * var flipped = _.flip(function() {\n     *   return _.toArray(arguments);\n     * });\n     *\n     * flipped('a', 'b', 'c', 'd');\n     * // => ['d', 'c', 'b', 'a']\n     */\n    function flip(func) {\n      return createWrap(func, WRAP_FLIP_FLAG);\n    }\n\n    /**\n     * Creates a function that memoizes the result of `func`. If `resolver` is\n     * provided, it determines the cache key for storing the result based on the\n     * arguments provided to the memoized function. By default, the first argument\n     * provided to the memoized function is used as the map cache key. The `func`\n     * is invoked with the `this` binding of the memoized function.\n     *\n     * **Note:** The cache is exposed as the `cache` property on the memoized\n     * function. Its creation may be customized by replacing the `_.memoize.Cache`\n     * constructor with one whose instances implement the\n     * [`Map`](http://ecma-international.org/ecma-262/7.0/#sec-properties-of-the-map-prototype-object)\n     * method interface of `clear`, `delete`, `get`, `has`, and `set`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {Function} func The function to have its output memoized.\n     * @param {Function} [resolver] The function to resolve the cache key.\n     * @returns {Function} Returns the new memoized function.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': 2 };\n     * var other = { 'c': 3, 'd': 4 };\n     *\n     * var values = _.memoize(_.values);\n     * values(object);\n     * // => [1, 2]\n     *\n     * values(other);\n     * // => [3, 4]\n     *\n     * object.a = 2;\n     * values(object);\n     * // => [1, 2]\n     *\n     * // Modify the result cache.\n     * values.cache.set(object, ['a', 'b']);\n     * values(object);\n     * // => ['a', 'b']\n     *\n     * // Replace `_.memoize.Cache`.\n     * _.memoize.Cache = WeakMap;\n     */\n    function memoize(func, resolver) {\n      if (typeof func != 'function' || (resolver != null && typeof resolver != 'function')) {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      var memoized = function() {\n        var args = arguments,\n            key = resolver ? resolver.apply(this, args) : args[0],\n            cache = memoized.cache;\n\n        if (cache.has(key)) {\n          return cache.get(key);\n        }\n        var result = func.apply(this, args);\n        memoized.cache = cache.set(key, result) || cache;\n        return result;\n      };\n      memoized.cache = new (memoize.Cache || MapCache);\n      return memoized;\n    }\n\n    // Expose `MapCache`.\n    memoize.Cache = MapCache;\n\n    /**\n     * Creates a function that negates the result of the predicate `func`. The\n     * `func` predicate is invoked with the `this` binding and arguments of the\n     * created function.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Function\n     * @param {Function} predicate The predicate to negate.\n     * @returns {Function} Returns the new negated function.\n     * @example\n     *\n     * function isEven(n) {\n     *   return n % 2 == 0;\n     * }\n     *\n     * _.filter([1, 2, 3, 4, 5, 6], _.negate(isEven));\n     * // => [1, 3, 5]\n     */\n    function negate(predicate) {\n      if (typeof predicate != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      return function() {\n        var args = arguments;\n        switch (args.length) {\n          case 0: return !predicate.call(this);\n          case 1: return !predicate.call(this, args[0]);\n          case 2: return !predicate.call(this, args[0], args[1]);\n          case 3: return !predicate.call(this, args[0], args[1], args[2]);\n        }\n        return !predicate.apply(this, args);\n      };\n    }\n\n    /**\n     * Creates a function that is restricted to invoking `func` once. Repeat calls\n     * to the function return the value of the first invocation. The `func` is\n     * invoked with the `this` binding and arguments of the created function.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {Function} func The function to restrict.\n     * @returns {Function} Returns the new restricted function.\n     * @example\n     *\n     * var initialize = _.once(createApplication);\n     * initialize();\n     * initialize();\n     * // => `createApplication` is invoked once\n     */\n    function once(func) {\n      return before(2, func);\n    }\n\n    /**\n     * Creates a function that invokes `func` with its arguments transformed.\n     *\n     * @static\n     * @since 4.0.0\n     * @memberOf _\n     * @category Function\n     * @param {Function} func The function to wrap.\n     * @param {...(Function|Function[])} [transforms=[_.identity]]\n     *  The argument transforms.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * function doubled(n) {\n     *   return n * 2;\n     * }\n     *\n     * function square(n) {\n     *   return n * n;\n     * }\n     *\n     * var func = _.overArgs(function(x, y) {\n     *   return [x, y];\n     * }, [square, doubled]);\n     *\n     * func(9, 3);\n     * // => [81, 6]\n     *\n     * func(10, 5);\n     * // => [100, 10]\n     */\n    var overArgs = castRest(function(func, transforms) {\n      transforms = (transforms.length == 1 && isArray(transforms[0]))\n        ? arrayMap(transforms[0], baseUnary(getIteratee()))\n        : arrayMap(baseFlatten(transforms, 1), baseUnary(getIteratee()));\n\n      var funcsLength = transforms.length;\n      return baseRest(function(args) {\n        var index = -1,\n            length = nativeMin(args.length, funcsLength);\n\n        while (++index < length) {\n          args[index] = transforms[index].call(this, args[index]);\n        }\n        return apply(func, this, args);\n      });\n    });\n\n    /**\n     * Creates a function that invokes `func` with `partials` prepended to the\n     * arguments it receives. This method is like `_.bind` except it does **not**\n     * alter the `this` binding.\n     *\n     * The `_.partial.placeholder` value, which defaults to `_` in monolithic\n     * builds, may be used as a placeholder for partially applied arguments.\n     *\n     * **Note:** This method doesn't set the \"length\" property of partially\n     * applied functions.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.2.0\n     * @category Function\n     * @param {Function} func The function to partially apply arguments to.\n     * @param {...*} [partials] The arguments to be partially applied.\n     * @returns {Function} Returns the new partially applied function.\n     * @example\n     *\n     * function greet(greeting, name) {\n     *   return greeting + ' ' + name;\n     * }\n     *\n     * var sayHelloTo = _.partial(greet, 'hello');\n     * sayHelloTo('fred');\n     * // => 'hello fred'\n     *\n     * // Partially applied with placeholders.\n     * var greetFred = _.partial(greet, _, 'fred');\n     * greetFred('hi');\n     * // => 'hi fred'\n     */\n    var partial = baseRest(function(func, partials) {\n      var holders = replaceHolders(partials, getHolder(partial));\n      return createWrap(func, WRAP_PARTIAL_FLAG, undefined, partials, holders);\n    });\n\n    /**\n     * This method is like `_.partial` except that partially applied arguments\n     * are appended to the arguments it receives.\n     *\n     * The `_.partialRight.placeholder` value, which defaults to `_` in monolithic\n     * builds, may be used as a placeholder for partially applied arguments.\n     *\n     * **Note:** This method doesn't set the \"length\" property of partially\n     * applied functions.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.0.0\n     * @category Function\n     * @param {Function} func The function to partially apply arguments to.\n     * @param {...*} [partials] The arguments to be partially applied.\n     * @returns {Function} Returns the new partially applied function.\n     * @example\n     *\n     * function greet(greeting, name) {\n     *   return greeting + ' ' + name;\n     * }\n     *\n     * var greetFred = _.partialRight(greet, 'fred');\n     * greetFred('hi');\n     * // => 'hi fred'\n     *\n     * // Partially applied with placeholders.\n     * var sayHelloTo = _.partialRight(greet, 'hello', _);\n     * sayHelloTo('fred');\n     * // => 'hello fred'\n     */\n    var partialRight = baseRest(function(func, partials) {\n      var holders = replaceHolders(partials, getHolder(partialRight));\n      return createWrap(func, WRAP_PARTIAL_RIGHT_FLAG, undefined, partials, holders);\n    });\n\n    /**\n     * Creates a function that invokes `func` with arguments arranged according\n     * to the specified `indexes` where the argument value at the first index is\n     * provided as the first argument, the argument value at the second index is\n     * provided as the second argument, and so on.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Function\n     * @param {Function} func The function to rearrange arguments for.\n     * @param {...(number|number[])} indexes The arranged argument indexes.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var rearged = _.rearg(function(a, b, c) {\n     *   return [a, b, c];\n     * }, [2, 0, 1]);\n     *\n     * rearged('b', 'c', 'a')\n     * // => ['a', 'b', 'c']\n     */\n    var rearg = flatRest(function(func, indexes) {\n      return createWrap(func, WRAP_REARG_FLAG, undefined, undefined, undefined, indexes);\n    });\n\n    /**\n     * Creates a function that invokes `func` with the `this` binding of the\n     * created function and arguments from `start` and beyond provided as\n     * an array.\n     *\n     * **Note:** This method is based on the\n     * [rest parameter](https://mdn.io/rest_parameters).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Function\n     * @param {Function} func The function to apply a rest parameter to.\n     * @param {number} [start=func.length-1] The start position of the rest parameter.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var say = _.rest(function(what, names) {\n     *   return what + ' ' + _.initial(names).join(', ') +\n     *     (_.size(names) > 1 ? ', & ' : '') + _.last(names);\n     * });\n     *\n     * say('hello', 'fred', 'barney', 'pebbles');\n     * // => 'hello fred, barney, & pebbles'\n     */\n    function rest(func, start) {\n      if (typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      start = start === undefined ? start : toInteger(start);\n      return baseRest(func, start);\n    }\n\n    /**\n     * Creates a function that invokes `func` with the `this` binding of the\n     * create function and an array of arguments much like\n     * [`Function#apply`](http://www.ecma-international.org/ecma-262/7.0/#sec-function.prototype.apply).\n     *\n     * **Note:** This method is based on the\n     * [spread operator](https://mdn.io/spread_operator).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.2.0\n     * @category Function\n     * @param {Function} func The function to spread arguments over.\n     * @param {number} [start=0] The start position of the spread.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var say = _.spread(function(who, what) {\n     *   return who + ' says ' + what;\n     * });\n     *\n     * say(['fred', 'hello']);\n     * // => 'fred says hello'\n     *\n     * var numbers = Promise.all([\n     *   Promise.resolve(40),\n     *   Promise.resolve(36)\n     * ]);\n     *\n     * numbers.then(_.spread(function(x, y) {\n     *   return x + y;\n     * }));\n     * // => a Promise of 76\n     */\n    function spread(func, start) {\n      if (typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      start = start == null ? 0 : nativeMax(toInteger(start), 0);\n      return baseRest(function(args) {\n        var array = args[start],\n            otherArgs = castSlice(args, 0, start);\n\n        if (array) {\n          arrayPush(otherArgs, array);\n        }\n        return apply(func, this, otherArgs);\n      });\n    }\n\n    /**\n     * Creates a throttled function that only invokes `func` at most once per\n     * every `wait` milliseconds. The throttled function comes with a `cancel`\n     * method to cancel delayed `func` invocations and a `flush` method to\n     * immediately invoke them. Provide `options` to indicate whether `func`\n     * should be invoked on the leading and/or trailing edge of the `wait`\n     * timeout. The `func` is invoked with the last arguments provided to the\n     * throttled function. Subsequent calls to the throttled function return the\n     * result of the last `func` invocation.\n     *\n     * **Note:** If `leading` and `trailing` options are `true`, `func` is\n     * invoked on the trailing edge of the timeout only if the throttled function\n     * is invoked more than once during the `wait` timeout.\n     *\n     * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n     * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n     *\n     * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n     * for details over the differences between `_.throttle` and `_.debounce`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {Function} func The function to throttle.\n     * @param {number} [wait=0] The number of milliseconds to throttle invocations to.\n     * @param {Object} [options={}] The options object.\n     * @param {boolean} [options.leading=true]\n     *  Specify invoking on the leading edge of the timeout.\n     * @param {boolean} [options.trailing=true]\n     *  Specify invoking on the trailing edge of the timeout.\n     * @returns {Function} Returns the new throttled function.\n     * @example\n     *\n     * // Avoid excessively updating the position while scrolling.\n     * jQuery(window).on('scroll', _.throttle(updatePosition, 100));\n     *\n     * // Invoke `renewToken` when the click event is fired, but not more than once every 5 minutes.\n     * var throttled = _.throttle(renewToken, 300000, { 'trailing': false });\n     * jQuery(element).on('click', throttled);\n     *\n     * // Cancel the trailing throttled invocation.\n     * jQuery(window).on('popstate', throttled.cancel);\n     */\n    function throttle(func, wait, options) {\n      var leading = true,\n          trailing = true;\n\n      if (typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      if (isObject(options)) {\n        leading = 'leading' in options ? !!options.leading : leading;\n        trailing = 'trailing' in options ? !!options.trailing : trailing;\n      }\n      return debounce(func, wait, {\n        'leading': leading,\n        'maxWait': wait,\n        'trailing': trailing\n      });\n    }\n\n    /**\n     * Creates a function that accepts up to one argument, ignoring any\n     * additional arguments.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Function\n     * @param {Function} func The function to cap arguments for.\n     * @returns {Function} Returns the new capped function.\n     * @example\n     *\n     * _.map(['6', '8', '10'], _.unary(parseInt));\n     * // => [6, 8, 10]\n     */\n    function unary(func) {\n      return ary(func, 1);\n    }\n\n    /**\n     * Creates a function that provides `value` to `wrapper` as its first\n     * argument. Any additional arguments provided to the function are appended\n     * to those provided to the `wrapper`. The wrapper is invoked with the `this`\n     * binding of the created function.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {*} value The value to wrap.\n     * @param {Function} [wrapper=identity] The wrapper function.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var p = _.wrap(_.escape, function(func, text) {\n     *   return '<p>' + func(text) + '</p>';\n     * });\n     *\n     * p('fred, barney, & pebbles');\n     * // => '<p>fred, barney, &amp; pebbles</p>'\n     */\n    function wrap(value, wrapper) {\n      return partial(castFunction(wrapper), value);\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Casts `value` as an array if it's not one.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.4.0\n     * @category Lang\n     * @param {*} value The value to inspect.\n     * @returns {Array} Returns the cast array.\n     * @example\n     *\n     * _.castArray(1);\n     * // => [1]\n     *\n     * _.castArray({ 'a': 1 });\n     * // => [{ 'a': 1 }]\n     *\n     * _.castArray('abc');\n     * // => ['abc']\n     *\n     * _.castArray(null);\n     * // => [null]\n     *\n     * _.castArray(undefined);\n     * // => [undefined]\n     *\n     * _.castArray();\n     * // => []\n     *\n     * var array = [1, 2, 3];\n     * console.log(_.castArray(array) === array);\n     * // => true\n     */\n    function castArray() {\n      if (!arguments.length) {\n        return [];\n      }\n      var value = arguments[0];\n      return isArray(value) ? value : [value];\n    }\n\n    /**\n     * Creates a shallow clone of `value`.\n     *\n     * **Note:** This method is loosely based on the\n     * [structured clone algorithm](https://mdn.io/Structured_clone_algorithm)\n     * and supports cloning arrays, array buffers, booleans, date objects, maps,\n     * numbers, `Object` objects, regexes, sets, strings, symbols, and typed\n     * arrays. The own enumerable properties of `arguments` objects are cloned\n     * as plain objects. An empty object is returned for uncloneable values such\n     * as error objects, functions, DOM nodes, and WeakMaps.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to clone.\n     * @returns {*} Returns the cloned value.\n     * @see _.cloneDeep\n     * @example\n     *\n     * var objects = [{ 'a': 1 }, { 'b': 2 }];\n     *\n     * var shallow = _.clone(objects);\n     * console.log(shallow[0] === objects[0]);\n     * // => true\n     */\n    function clone(value) {\n      return baseClone(value, CLONE_SYMBOLS_FLAG);\n    }\n\n    /**\n     * This method is like `_.clone` except that it accepts `customizer` which\n     * is invoked to produce the cloned value. If `customizer` returns `undefined`,\n     * cloning is handled by the method instead. The `customizer` is invoked with\n     * up to four arguments; (value [, index|key, object, stack]).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to clone.\n     * @param {Function} [customizer] The function to customize cloning.\n     * @returns {*} Returns the cloned value.\n     * @see _.cloneDeepWith\n     * @example\n     *\n     * function customizer(value) {\n     *   if (_.isElement(value)) {\n     *     return value.cloneNode(false);\n     *   }\n     * }\n     *\n     * var el = _.cloneWith(document.body, customizer);\n     *\n     * console.log(el === document.body);\n     * // => false\n     * console.log(el.nodeName);\n     * // => 'BODY'\n     * console.log(el.childNodes.length);\n     * // => 0\n     */\n    function cloneWith(value, customizer) {\n      customizer = typeof customizer == 'function' ? customizer : undefined;\n      return baseClone(value, CLONE_SYMBOLS_FLAG, customizer);\n    }\n\n    /**\n     * This method is like `_.clone` except that it recursively clones `value`.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.0.0\n     * @category Lang\n     * @param {*} value The value to recursively clone.\n     * @returns {*} Returns the deep cloned value.\n     * @see _.clone\n     * @example\n     *\n     * var objects = [{ 'a': 1 }, { 'b': 2 }];\n     *\n     * var deep = _.cloneDeep(objects);\n     * console.log(deep[0] === objects[0]);\n     * // => false\n     */\n    function cloneDeep(value) {\n      return baseClone(value, CLONE_DEEP_FLAG | CLONE_SYMBOLS_FLAG);\n    }\n\n    /**\n     * This method is like `_.cloneWith` except that it recursively clones `value`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to recursively clone.\n     * @param {Function} [customizer] The function to customize cloning.\n     * @returns {*} Returns the deep cloned value.\n     * @see _.cloneWith\n     * @example\n     *\n     * function customizer(value) {\n     *   if (_.isElement(value)) {\n     *     return value.cloneNode(true);\n     *   }\n     * }\n     *\n     * var el = _.cloneDeepWith(document.body, customizer);\n     *\n     * console.log(el === document.body);\n     * // => false\n     * console.log(el.nodeName);\n     * // => 'BODY'\n     * console.log(el.childNodes.length);\n     * // => 20\n     */\n    function cloneDeepWith(value, customizer) {\n      customizer = typeof customizer == 'function' ? customizer : undefined;\n      return baseClone(value, CLONE_DEEP_FLAG | CLONE_SYMBOLS_FLAG, customizer);\n    }\n\n    /**\n     * Checks if `object` conforms to `source` by invoking the predicate\n     * properties of `source` with the corresponding property values of `object`.\n     *\n     * **Note:** This method is equivalent to `_.conforms` when `source` is\n     * partially applied.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.14.0\n     * @category Lang\n     * @param {Object} object The object to inspect.\n     * @param {Object} source The object of property predicates to conform to.\n     * @returns {boolean} Returns `true` if `object` conforms, else `false`.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': 2 };\n     *\n     * _.conformsTo(object, { 'b': function(n) { return n > 1; } });\n     * // => true\n     *\n     * _.conformsTo(object, { 'b': function(n) { return n > 2; } });\n     * // => false\n     */\n    function conformsTo(object, source) {\n      return source == null || baseConformsTo(object, source, keys(source));\n    }\n\n    /**\n     * Performs a\n     * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * comparison between two values to determine if they are equivalent.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n     * @example\n     *\n     * var object = { 'a': 1 };\n     * var other = { 'a': 1 };\n     *\n     * _.eq(object, object);\n     * // => true\n     *\n     * _.eq(object, other);\n     * // => false\n     *\n     * _.eq('a', 'a');\n     * // => true\n     *\n     * _.eq('a', Object('a'));\n     * // => false\n     *\n     * _.eq(NaN, NaN);\n     * // => true\n     */\n    function eq(value, other) {\n      return value === other || (value !== value && other !== other);\n    }\n\n    /**\n     * Checks if `value` is greater than `other`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.9.0\n     * @category Lang\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if `value` is greater than `other`,\n     *  else `false`.\n     * @see _.lt\n     * @example\n     *\n     * _.gt(3, 1);\n     * // => true\n     *\n     * _.gt(3, 3);\n     * // => false\n     *\n     * _.gt(1, 3);\n     * // => false\n     */\n    var gt = createRelationalOperation(baseGt);\n\n    /**\n     * Checks if `value` is greater than or equal to `other`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.9.0\n     * @category Lang\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if `value` is greater than or equal to\n     *  `other`, else `false`.\n     * @see _.lte\n     * @example\n     *\n     * _.gte(3, 1);\n     * // => true\n     *\n     * _.gte(3, 3);\n     * // => true\n     *\n     * _.gte(1, 3);\n     * // => false\n     */\n    var gte = createRelationalOperation(function(value, other) {\n      return value >= other;\n    });\n\n    /**\n     * Checks if `value` is likely an `arguments` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n     *  else `false`.\n     * @example\n     *\n     * _.isArguments(function() { return arguments; }());\n     * // => true\n     *\n     * _.isArguments([1, 2, 3]);\n     * // => false\n     */\n    var isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n      return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n        !propertyIsEnumerable.call(value, 'callee');\n    };\n\n    /**\n     * Checks if `value` is classified as an `Array` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n     * @example\n     *\n     * _.isArray([1, 2, 3]);\n     * // => true\n     *\n     * _.isArray(document.body.children);\n     * // => false\n     *\n     * _.isArray('abc');\n     * // => false\n     *\n     * _.isArray(_.noop);\n     * // => false\n     */\n    var isArray = Array.isArray;\n\n    /**\n     * Checks if `value` is classified as an `ArrayBuffer` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.3.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an array buffer, else `false`.\n     * @example\n     *\n     * _.isArrayBuffer(new ArrayBuffer(2));\n     * // => true\n     *\n     * _.isArrayBuffer(new Array(2));\n     * // => false\n     */\n    var isArrayBuffer = nodeIsArrayBuffer ? baseUnary(nodeIsArrayBuffer) : baseIsArrayBuffer;\n\n    /**\n     * Checks if `value` is array-like. A value is considered array-like if it's\n     * not a function and has a `value.length` that's an integer greater than or\n     * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n     * @example\n     *\n     * _.isArrayLike([1, 2, 3]);\n     * // => true\n     *\n     * _.isArrayLike(document.body.children);\n     * // => true\n     *\n     * _.isArrayLike('abc');\n     * // => true\n     *\n     * _.isArrayLike(_.noop);\n     * // => false\n     */\n    function isArrayLike(value) {\n      return value != null && isLength(value.length) && !isFunction(value);\n    }\n\n    /**\n     * This method is like `_.isArrayLike` except that it also checks if `value`\n     * is an object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an array-like object,\n     *  else `false`.\n     * @example\n     *\n     * _.isArrayLikeObject([1, 2, 3]);\n     * // => true\n     *\n     * _.isArrayLikeObject(document.body.children);\n     * // => true\n     *\n     * _.isArrayLikeObject('abc');\n     * // => false\n     *\n     * _.isArrayLikeObject(_.noop);\n     * // => false\n     */\n    function isArrayLikeObject(value) {\n      return isObjectLike(value) && isArrayLike(value);\n    }\n\n    /**\n     * Checks if `value` is classified as a boolean primitive or object.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a boolean, else `false`.\n     * @example\n     *\n     * _.isBoolean(false);\n     * // => true\n     *\n     * _.isBoolean(null);\n     * // => false\n     */\n    function isBoolean(value) {\n      return value === true || value === false ||\n        (isObjectLike(value) && baseGetTag(value) == boolTag);\n    }\n\n    /**\n     * Checks if `value` is a buffer.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.3.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n     * @example\n     *\n     * _.isBuffer(new Buffer(2));\n     * // => true\n     *\n     * _.isBuffer(new Uint8Array(2));\n     * // => false\n     */\n    var isBuffer = nativeIsBuffer || stubFalse;\n\n    /**\n     * Checks if `value` is classified as a `Date` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a date object, else `false`.\n     * @example\n     *\n     * _.isDate(new Date);\n     * // => true\n     *\n     * _.isDate('Mon April 23 2012');\n     * // => false\n     */\n    var isDate = nodeIsDate ? baseUnary(nodeIsDate) : baseIsDate;\n\n    /**\n     * Checks if `value` is likely a DOM element.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a DOM element, else `false`.\n     * @example\n     *\n     * _.isElement(document.body);\n     * // => true\n     *\n     * _.isElement('<body>');\n     * // => false\n     */\n    function isElement(value) {\n      return isObjectLike(value) && value.nodeType === 1 && !isPlainObject(value);\n    }\n\n    /**\n     * Checks if `value` is an empty object, collection, map, or set.\n     *\n     * Objects are considered empty if they have no own enumerable string keyed\n     * properties.\n     *\n     * Array-like values such as `arguments` objects, arrays, buffers, strings, or\n     * jQuery-like collections are considered empty if they have a `length` of `0`.\n     * Similarly, maps and sets are considered empty if they have a `size` of `0`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is empty, else `false`.\n     * @example\n     *\n     * _.isEmpty(null);\n     * // => true\n     *\n     * _.isEmpty(true);\n     * // => true\n     *\n     * _.isEmpty(1);\n     * // => true\n     *\n     * _.isEmpty([1, 2, 3]);\n     * // => false\n     *\n     * _.isEmpty({ 'a': 1 });\n     * // => false\n     */\n    function isEmpty(value) {\n      if (value == null) {\n        return true;\n      }\n      if (isArrayLike(value) &&\n          (isArray(value) || typeof value == 'string' || typeof value.splice == 'function' ||\n            isBuffer(value) || isTypedArray(value) || isArguments(value))) {\n        return !value.length;\n      }\n      var tag = getTag(value);\n      if (tag == mapTag || tag == setTag) {\n        return !value.size;\n      }\n      if (isPrototype(value)) {\n        return !baseKeys(value).length;\n      }\n      for (var key in value) {\n        if (hasOwnProperty.call(value, key)) {\n          return false;\n        }\n      }\n      return true;\n    }\n\n    /**\n     * Performs a deep comparison between two values to determine if they are\n     * equivalent.\n     *\n     * **Note:** This method supports comparing arrays, array buffers, booleans,\n     * date objects, error objects, maps, numbers, `Object` objects, regexes,\n     * sets, strings, symbols, and typed arrays. `Object` objects are compared\n     * by their own, not inherited, enumerable properties. Functions and DOM\n     * nodes are compared by strict equality, i.e. `===`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n     * @example\n     *\n     * var object = { 'a': 1 };\n     * var other = { 'a': 1 };\n     *\n     * _.isEqual(object, other);\n     * // => true\n     *\n     * object === other;\n     * // => false\n     */\n    function isEqual(value, other) {\n      return baseIsEqual(value, other);\n    }\n\n    /**\n     * This method is like `_.isEqual` except that it accepts `customizer` which\n     * is invoked to compare values. If `customizer` returns `undefined`, comparisons\n     * are handled by the method instead. The `customizer` is invoked with up to\n     * six arguments: (objValue, othValue [, index|key, object, other, stack]).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @param {Function} [customizer] The function to customize comparisons.\n     * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n     * @example\n     *\n     * function isGreeting(value) {\n     *   return /^h(?:i|ello)$/.test(value);\n     * }\n     *\n     * function customizer(objValue, othValue) {\n     *   if (isGreeting(objValue) && isGreeting(othValue)) {\n     *     return true;\n     *   }\n     * }\n     *\n     * var array = ['hello', 'goodbye'];\n     * var other = ['hi', 'goodbye'];\n     *\n     * _.isEqualWith(array, other, customizer);\n     * // => true\n     */\n    function isEqualWith(value, other, customizer) {\n      customizer = typeof customizer == 'function' ? customizer : undefined;\n      var result = customizer ? customizer(value, other) : undefined;\n      return result === undefined ? baseIsEqual(value, other, undefined, customizer) : !!result;\n    }\n\n    /**\n     * Checks if `value` is an `Error`, `EvalError`, `RangeError`, `ReferenceError`,\n     * `SyntaxError`, `TypeError`, or `URIError` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an error object, else `false`.\n     * @example\n     *\n     * _.isError(new Error);\n     * // => true\n     *\n     * _.isError(Error);\n     * // => false\n     */\n    function isError(value) {\n      if (!isObjectLike(value)) {\n        return false;\n      }\n      var tag = baseGetTag(value);\n      return tag == errorTag || tag == domExcTag ||\n        (typeof value.message == 'string' && typeof value.name == 'string' && !isPlainObject(value));\n    }\n\n    /**\n     * Checks if `value` is a finite primitive number.\n     *\n     * **Note:** This method is based on\n     * [`Number.isFinite`](https://mdn.io/Number/isFinite).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a finite number, else `false`.\n     * @example\n     *\n     * _.isFinite(3);\n     * // => true\n     *\n     * _.isFinite(Number.MIN_VALUE);\n     * // => true\n     *\n     * _.isFinite(Infinity);\n     * // => false\n     *\n     * _.isFinite('3');\n     * // => false\n     */\n    function isFinite(value) {\n      return typeof value == 'number' && nativeIsFinite(value);\n    }\n\n    /**\n     * Checks if `value` is classified as a `Function` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n     * @example\n     *\n     * _.isFunction(_);\n     * // => true\n     *\n     * _.isFunction(/abc/);\n     * // => false\n     */\n    function isFunction(value) {\n      if (!isObject(value)) {\n        return false;\n      }\n      // The use of `Object#toString` avoids issues with the `typeof` operator\n      // in Safari 9 which returns 'object' for typed arrays and other constructors.\n      var tag = baseGetTag(value);\n      return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n    }\n\n    /**\n     * Checks if `value` is an integer.\n     *\n     * **Note:** This method is based on\n     * [`Number.isInteger`](https://mdn.io/Number/isInteger).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an integer, else `false`.\n     * @example\n     *\n     * _.isInteger(3);\n     * // => true\n     *\n     * _.isInteger(Number.MIN_VALUE);\n     * // => false\n     *\n     * _.isInteger(Infinity);\n     * // => false\n     *\n     * _.isInteger('3');\n     * // => false\n     */\n    function isInteger(value) {\n      return typeof value == 'number' && value == toInteger(value);\n    }\n\n    /**\n     * Checks if `value` is a valid array-like length.\n     *\n     * **Note:** This method is loosely based on\n     * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n     * @example\n     *\n     * _.isLength(3);\n     * // => true\n     *\n     * _.isLength(Number.MIN_VALUE);\n     * // => false\n     *\n     * _.isLength(Infinity);\n     * // => false\n     *\n     * _.isLength('3');\n     * // => false\n     */\n    function isLength(value) {\n      return typeof value == 'number' &&\n        value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n    }\n\n    /**\n     * Checks if `value` is the\n     * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n     * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n     * @example\n     *\n     * _.isObject({});\n     * // => true\n     *\n     * _.isObject([1, 2, 3]);\n     * // => true\n     *\n     * _.isObject(_.noop);\n     * // => true\n     *\n     * _.isObject(null);\n     * // => false\n     */\n    function isObject(value) {\n      var type = typeof value;\n      return value != null && (type == 'object' || type == 'function');\n    }\n\n    /**\n     * Checks if `value` is object-like. A value is object-like if it's not `null`\n     * and has a `typeof` result of \"object\".\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n     * @example\n     *\n     * _.isObjectLike({});\n     * // => true\n     *\n     * _.isObjectLike([1, 2, 3]);\n     * // => true\n     *\n     * _.isObjectLike(_.noop);\n     * // => false\n     *\n     * _.isObjectLike(null);\n     * // => false\n     */\n    function isObjectLike(value) {\n      return value != null && typeof value == 'object';\n    }\n\n    /**\n     * Checks if `value` is classified as a `Map` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.3.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a map, else `false`.\n     * @example\n     *\n     * _.isMap(new Map);\n     * // => true\n     *\n     * _.isMap(new WeakMap);\n     * // => false\n     */\n    var isMap = nodeIsMap ? baseUnary(nodeIsMap) : baseIsMap;\n\n    /**\n     * Performs a partial deep comparison between `object` and `source` to\n     * determine if `object` contains equivalent property values.\n     *\n     * **Note:** This method is equivalent to `_.matches` when `source` is\n     * partially applied.\n     *\n     * Partial comparisons will match empty array and empty object `source`\n     * values against any array or object value, respectively. See `_.isEqual`\n     * for a list of supported value comparisons.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Lang\n     * @param {Object} object The object to inspect.\n     * @param {Object} source The object of property values to match.\n     * @returns {boolean} Returns `true` if `object` is a match, else `false`.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': 2 };\n     *\n     * _.isMatch(object, { 'b': 2 });\n     * // => true\n     *\n     * _.isMatch(object, { 'b': 1 });\n     * // => false\n     */\n    function isMatch(object, source) {\n      return object === source || baseIsMatch(object, source, getMatchData(source));\n    }\n\n    /**\n     * This method is like `_.isMatch` except that it accepts `customizer` which\n     * is invoked to compare values. If `customizer` returns `undefined`, comparisons\n     * are handled by the method instead. The `customizer` is invoked with five\n     * arguments: (objValue, srcValue, index|key, object, source).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {Object} object The object to inspect.\n     * @param {Object} source The object of property values to match.\n     * @param {Function} [customizer] The function to customize comparisons.\n     * @returns {boolean} Returns `true` if `object` is a match, else `false`.\n     * @example\n     *\n     * function isGreeting(value) {\n     *   return /^h(?:i|ello)$/.test(value);\n     * }\n     *\n     * function customizer(objValue, srcValue) {\n     *   if (isGreeting(objValue) && isGreeting(srcValue)) {\n     *     return true;\n     *   }\n     * }\n     *\n     * var object = { 'greeting': 'hello' };\n     * var source = { 'greeting': 'hi' };\n     *\n     * _.isMatchWith(object, source, customizer);\n     * // => true\n     */\n    function isMatchWith(object, source, customizer) {\n      customizer = typeof customizer == 'function' ? customizer : undefined;\n      return baseIsMatch(object, source, getMatchData(source), customizer);\n    }\n\n    /**\n     * Checks if `value` is `NaN`.\n     *\n     * **Note:** This method is based on\n     * [`Number.isNaN`](https://mdn.io/Number/isNaN) and is not the same as\n     * global [`isNaN`](https://mdn.io/isNaN) which returns `true` for\n     * `undefined` and other non-number values.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.\n     * @example\n     *\n     * _.isNaN(NaN);\n     * // => true\n     *\n     * _.isNaN(new Number(NaN));\n     * // => true\n     *\n     * isNaN(undefined);\n     * // => true\n     *\n     * _.isNaN(undefined);\n     * // => false\n     */\n    function isNaN(value) {\n      // An `NaN` primitive is the only value that is not equal to itself.\n      // Perform the `toStringTag` check first to avoid errors with some\n      // ActiveX objects in IE.\n      return isNumber(value) && value != +value;\n    }\n\n    /**\n     * Checks if `value` is a pristine native function.\n     *\n     * **Note:** This method can't reliably detect native functions in the presence\n     * of the core-js package because core-js circumvents this kind of detection.\n     * Despite multiple requests, the core-js maintainer has made it clear: any\n     * attempt to fix the detection will be obstructed. As a result, we're left\n     * with little choice but to throw an error. Unfortunately, this also affects\n     * packages, like [babel-polyfill](https://www.npmjs.com/package/babel-polyfill),\n     * which rely on core-js.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a native function,\n     *  else `false`.\n     * @example\n     *\n     * _.isNative(Array.prototype.push);\n     * // => true\n     *\n     * _.isNative(_);\n     * // => false\n     */\n    function isNative(value) {\n      if (isMaskable(value)) {\n        throw new Error(CORE_ERROR_TEXT);\n      }\n      return baseIsNative(value);\n    }\n\n    /**\n     * Checks if `value` is `null`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is `null`, else `false`.\n     * @example\n     *\n     * _.isNull(null);\n     * // => true\n     *\n     * _.isNull(void 0);\n     * // => false\n     */\n    function isNull(value) {\n      return value === null;\n    }\n\n    /**\n     * Checks if `value` is `null` or `undefined`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is nullish, else `false`.\n     * @example\n     *\n     * _.isNil(null);\n     * // => true\n     *\n     * _.isNil(void 0);\n     * // => true\n     *\n     * _.isNil(NaN);\n     * // => false\n     */\n    function isNil(value) {\n      return value == null;\n    }\n\n    /**\n     * Checks if `value` is classified as a `Number` primitive or object.\n     *\n     * **Note:** To exclude `Infinity`, `-Infinity`, and `NaN`, which are\n     * classified as numbers, use the `_.isFinite` method.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a number, else `false`.\n     * @example\n     *\n     * _.isNumber(3);\n     * // => true\n     *\n     * _.isNumber(Number.MIN_VALUE);\n     * // => true\n     *\n     * _.isNumber(Infinity);\n     * // => true\n     *\n     * _.isNumber('3');\n     * // => false\n     */\n    function isNumber(value) {\n      return typeof value == 'number' ||\n        (isObjectLike(value) && baseGetTag(value) == numberTag);\n    }\n\n    /**\n     * Checks if `value` is a plain object, that is, an object created by the\n     * `Object` constructor or one with a `[[Prototype]]` of `null`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.8.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     * }\n     *\n     * _.isPlainObject(new Foo);\n     * // => false\n     *\n     * _.isPlainObject([1, 2, 3]);\n     * // => false\n     *\n     * _.isPlainObject({ 'x': 0, 'y': 0 });\n     * // => true\n     *\n     * _.isPlainObject(Object.create(null));\n     * // => true\n     */\n    function isPlainObject(value) {\n      if (!isObjectLike(value) || baseGetTag(value) != objectTag) {\n        return false;\n      }\n      var proto = getPrototype(value);\n      if (proto === null) {\n        return true;\n      }\n      var Ctor = hasOwnProperty.call(proto, 'constructor') && proto.constructor;\n      return typeof Ctor == 'function' && Ctor instanceof Ctor &&\n        funcToString.call(Ctor) == objectCtorString;\n    }\n\n    /**\n     * Checks if `value` is classified as a `RegExp` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a regexp, else `false`.\n     * @example\n     *\n     * _.isRegExp(/abc/);\n     * // => true\n     *\n     * _.isRegExp('/abc/');\n     * // => false\n     */\n    var isRegExp = nodeIsRegExp ? baseUnary(nodeIsRegExp) : baseIsRegExp;\n\n    /**\n     * Checks if `value` is a safe integer. An integer is safe if it's an IEEE-754\n     * double precision number which isn't the result of a rounded unsafe integer.\n     *\n     * **Note:** This method is based on\n     * [`Number.isSafeInteger`](https://mdn.io/Number/isSafeInteger).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a safe integer, else `false`.\n     * @example\n     *\n     * _.isSafeInteger(3);\n     * // => true\n     *\n     * _.isSafeInteger(Number.MIN_VALUE);\n     * // => false\n     *\n     * _.isSafeInteger(Infinity);\n     * // => false\n     *\n     * _.isSafeInteger('3');\n     * // => false\n     */\n    function isSafeInteger(value) {\n      return isInteger(value) && value >= -MAX_SAFE_INTEGER && value <= MAX_SAFE_INTEGER;\n    }\n\n    /**\n     * Checks if `value` is classified as a `Set` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.3.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a set, else `false`.\n     * @example\n     *\n     * _.isSet(new Set);\n     * // => true\n     *\n     * _.isSet(new WeakSet);\n     * // => false\n     */\n    var isSet = nodeIsSet ? baseUnary(nodeIsSet) : baseIsSet;\n\n    /**\n     * Checks if `value` is classified as a `String` primitive or object.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a string, else `false`.\n     * @example\n     *\n     * _.isString('abc');\n     * // => true\n     *\n     * _.isString(1);\n     * // => false\n     */\n    function isString(value) {\n      return typeof value == 'string' ||\n        (!isArray(value) && isObjectLike(value) && baseGetTag(value) == stringTag);\n    }\n\n    /**\n     * Checks if `value` is classified as a `Symbol` primitive or object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n     * @example\n     *\n     * _.isSymbol(Symbol.iterator);\n     * // => true\n     *\n     * _.isSymbol('abc');\n     * // => false\n     */\n    function isSymbol(value) {\n      return typeof value == 'symbol' ||\n        (isObjectLike(value) && baseGetTag(value) == symbolTag);\n    }\n\n    /**\n     * Checks if `value` is classified as a typed array.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n     * @example\n     *\n     * _.isTypedArray(new Uint8Array);\n     * // => true\n     *\n     * _.isTypedArray([]);\n     * // => false\n     */\n    var isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\n    /**\n     * Checks if `value` is `undefined`.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is `undefined`, else `false`.\n     * @example\n     *\n     * _.isUndefined(void 0);\n     * // => true\n     *\n     * _.isUndefined(null);\n     * // => false\n     */\n    function isUndefined(value) {\n      return value === undefined;\n    }\n\n    /**\n     * Checks if `value` is classified as a `WeakMap` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.3.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a weak map, else `false`.\n     * @example\n     *\n     * _.isWeakMap(new WeakMap);\n     * // => true\n     *\n     * _.isWeakMap(new Map);\n     * // => false\n     */\n    function isWeakMap(value) {\n      return isObjectLike(value) && getTag(value) == weakMapTag;\n    }\n\n    /**\n     * Checks if `value` is classified as a `WeakSet` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.3.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a weak set, else `false`.\n     * @example\n     *\n     * _.isWeakSet(new WeakSet);\n     * // => true\n     *\n     * _.isWeakSet(new Set);\n     * // => false\n     */\n    function isWeakSet(value) {\n      return isObjectLike(value) && baseGetTag(value) == weakSetTag;\n    }\n\n    /**\n     * Checks if `value` is less than `other`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.9.0\n     * @category Lang\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if `value` is less than `other`,\n     *  else `false`.\n     * @see _.gt\n     * @example\n     *\n     * _.lt(1, 3);\n     * // => true\n     *\n     * _.lt(3, 3);\n     * // => false\n     *\n     * _.lt(3, 1);\n     * // => false\n     */\n    var lt = createRelationalOperation(baseLt);\n\n    /**\n     * Checks if `value` is less than or equal to `other`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.9.0\n     * @category Lang\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if `value` is less than or equal to\n     *  `other`, else `false`.\n     * @see _.gte\n     * @example\n     *\n     * _.lte(1, 3);\n     * // => true\n     *\n     * _.lte(3, 3);\n     * // => true\n     *\n     * _.lte(3, 1);\n     * // => false\n     */\n    var lte = createRelationalOperation(function(value, other) {\n      return value <= other;\n    });\n\n    /**\n     * Converts `value` to an array.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Lang\n     * @param {*} value The value to convert.\n     * @returns {Array} Returns the converted array.\n     * @example\n     *\n     * _.toArray({ 'a': 1, 'b': 2 });\n     * // => [1, 2]\n     *\n     * _.toArray('abc');\n     * // => ['a', 'b', 'c']\n     *\n     * _.toArray(1);\n     * // => []\n     *\n     * _.toArray(null);\n     * // => []\n     */\n    function toArray(value) {\n      if (!value) {\n        return [];\n      }\n      if (isArrayLike(value)) {\n        return isString(value) ? stringToArray(value) : copyArray(value);\n      }\n      if (symIterator && value[symIterator]) {\n        return iteratorToArray(value[symIterator]());\n      }\n      var tag = getTag(value),\n          func = tag == mapTag ? mapToArray : (tag == setTag ? setToArray : values);\n\n      return func(value);\n    }\n\n    /**\n     * Converts `value` to a finite number.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.12.0\n     * @category Lang\n     * @param {*} value The value to convert.\n     * @returns {number} Returns the converted number.\n     * @example\n     *\n     * _.toFinite(3.2);\n     * // => 3.2\n     *\n     * _.toFinite(Number.MIN_VALUE);\n     * // => 5e-324\n     *\n     * _.toFinite(Infinity);\n     * // => 1.7976931348623157e+308\n     *\n     * _.toFinite('3.2');\n     * // => 3.2\n     */\n    function toFinite(value) {\n      if (!value) {\n        return value === 0 ? value : 0;\n      }\n      value = toNumber(value);\n      if (value === INFINITY || value === -INFINITY) {\n        var sign = (value < 0 ? -1 : 1);\n        return sign * MAX_INTEGER;\n      }\n      return value === value ? value : 0;\n    }\n\n    /**\n     * Converts `value` to an integer.\n     *\n     * **Note:** This method is loosely based on\n     * [`ToInteger`](http://www.ecma-international.org/ecma-262/7.0/#sec-tointeger).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to convert.\n     * @returns {number} Returns the converted integer.\n     * @example\n     *\n     * _.toInteger(3.2);\n     * // => 3\n     *\n     * _.toInteger(Number.MIN_VALUE);\n     * // => 0\n     *\n     * _.toInteger(Infinity);\n     * // => 1.7976931348623157e+308\n     *\n     * _.toInteger('3.2');\n     * // => 3\n     */\n    function toInteger(value) {\n      var result = toFinite(value),\n          remainder = result % 1;\n\n      return result === result ? (remainder ? result - remainder : result) : 0;\n    }\n\n    /**\n     * Converts `value` to an integer suitable for use as the length of an\n     * array-like object.\n     *\n     * **Note:** This method is based on\n     * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to convert.\n     * @returns {number} Returns the converted integer.\n     * @example\n     *\n     * _.toLength(3.2);\n     * // => 3\n     *\n     * _.toLength(Number.MIN_VALUE);\n     * // => 0\n     *\n     * _.toLength(Infinity);\n     * // => 4294967295\n     *\n     * _.toLength('3.2');\n     * // => 3\n     */\n    function toLength(value) {\n      return value ? baseClamp(toInteger(value), 0, MAX_ARRAY_LENGTH) : 0;\n    }\n\n    /**\n     * Converts `value` to a number.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to process.\n     * @returns {number} Returns the number.\n     * @example\n     *\n     * _.toNumber(3.2);\n     * // => 3.2\n     *\n     * _.toNumber(Number.MIN_VALUE);\n     * // => 5e-324\n     *\n     * _.toNumber(Infinity);\n     * // => Infinity\n     *\n     * _.toNumber('3.2');\n     * // => 3.2\n     */\n    function toNumber(value) {\n      if (typeof value == 'number') {\n        return value;\n      }\n      if (isSymbol(value)) {\n        return NAN;\n      }\n      if (isObject(value)) {\n        var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n        value = isObject(other) ? (other + '') : other;\n      }\n      if (typeof value != 'string') {\n        return value === 0 ? value : +value;\n      }\n      value = baseTrim(value);\n      var isBinary = reIsBinary.test(value);\n      return (isBinary || reIsOctal.test(value))\n        ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n        : (reIsBadHex.test(value) ? NAN : +value);\n    }\n\n    /**\n     * Converts `value` to a plain object flattening inherited enumerable string\n     * keyed properties of `value` to own properties of the plain object.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Lang\n     * @param {*} value The value to convert.\n     * @returns {Object} Returns the converted plain object.\n     * @example\n     *\n     * function Foo() {\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.assign({ 'a': 1 }, new Foo);\n     * // => { 'a': 1, 'b': 2 }\n     *\n     * _.assign({ 'a': 1 }, _.toPlainObject(new Foo));\n     * // => { 'a': 1, 'b': 2, 'c': 3 }\n     */\n    function toPlainObject(value) {\n      return copyObject(value, keysIn(value));\n    }\n\n    /**\n     * Converts `value` to a safe integer. A safe integer can be compared and\n     * represented correctly.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to convert.\n     * @returns {number} Returns the converted integer.\n     * @example\n     *\n     * _.toSafeInteger(3.2);\n     * // => 3\n     *\n     * _.toSafeInteger(Number.MIN_VALUE);\n     * // => 0\n     *\n     * _.toSafeInteger(Infinity);\n     * // => 9007199254740991\n     *\n     * _.toSafeInteger('3.2');\n     * // => 3\n     */\n    function toSafeInteger(value) {\n      return value\n        ? baseClamp(toInteger(value), -MAX_SAFE_INTEGER, MAX_SAFE_INTEGER)\n        : (value === 0 ? value : 0);\n    }\n\n    /**\n     * Converts `value` to a string. An empty string is returned for `null`\n     * and `undefined` values. The sign of `-0` is preserved.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to convert.\n     * @returns {string} Returns the converted string.\n     * @example\n     *\n     * _.toString(null);\n     * // => ''\n     *\n     * _.toString(-0);\n     * // => '-0'\n     *\n     * _.toString([1, 2, 3]);\n     * // => '1,2,3'\n     */\n    function toString(value) {\n      return value == null ? '' : baseToString(value);\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Assigns own enumerable string keyed properties of source objects to the\n     * destination object. Source objects are applied from left to right.\n     * Subsequent sources overwrite property assignments of previous sources.\n     *\n     * **Note:** This method mutates `object` and is loosely based on\n     * [`Object.assign`](https://mdn.io/Object/assign).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.10.0\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} [sources] The source objects.\n     * @returns {Object} Returns `object`.\n     * @see _.assignIn\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     * }\n     *\n     * function Bar() {\n     *   this.c = 3;\n     * }\n     *\n     * Foo.prototype.b = 2;\n     * Bar.prototype.d = 4;\n     *\n     * _.assign({ 'a': 0 }, new Foo, new Bar);\n     * // => { 'a': 1, 'c': 3 }\n     */\n    var assign = createAssigner(function(object, source) {\n      if (isPrototype(source) || isArrayLike(source)) {\n        copyObject(source, keys(source), object);\n        return;\n      }\n      for (var key in source) {\n        if (hasOwnProperty.call(source, key)) {\n          assignValue(object, key, source[key]);\n        }\n      }\n    });\n\n    /**\n     * This method is like `_.assign` except that it iterates over own and\n     * inherited source properties.\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @alias extend\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} [sources] The source objects.\n     * @returns {Object} Returns `object`.\n     * @see _.assign\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     * }\n     *\n     * function Bar() {\n     *   this.c = 3;\n     * }\n     *\n     * Foo.prototype.b = 2;\n     * Bar.prototype.d = 4;\n     *\n     * _.assignIn({ 'a': 0 }, new Foo, new Bar);\n     * // => { 'a': 1, 'b': 2, 'c': 3, 'd': 4 }\n     */\n    var assignIn = createAssigner(function(object, source) {\n      copyObject(source, keysIn(source), object);\n    });\n\n    /**\n     * This method is like `_.assignIn` except that it accepts `customizer`\n     * which is invoked to produce the assigned values. If `customizer` returns\n     * `undefined`, assignment is handled by the method instead. The `customizer`\n     * is invoked with five arguments: (objValue, srcValue, key, object, source).\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @alias extendWith\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} sources The source objects.\n     * @param {Function} [customizer] The function to customize assigned values.\n     * @returns {Object} Returns `object`.\n     * @see _.assignWith\n     * @example\n     *\n     * function customizer(objValue, srcValue) {\n     *   return _.isUndefined(objValue) ? srcValue : objValue;\n     * }\n     *\n     * var defaults = _.partialRight(_.assignInWith, customizer);\n     *\n     * defaults({ 'a': 1 }, { 'b': 2 }, { 'a': 3 });\n     * // => { 'a': 1, 'b': 2 }\n     */\n    var assignInWith = createAssigner(function(object, source, srcIndex, customizer) {\n      copyObject(source, keysIn(source), object, customizer);\n    });\n\n    /**\n     * This method is like `_.assign` except that it accepts `customizer`\n     * which is invoked to produce the assigned values. If `customizer` returns\n     * `undefined`, assignment is handled by the method instead. The `customizer`\n     * is invoked with five arguments: (objValue, srcValue, key, object, source).\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} sources The source objects.\n     * @param {Function} [customizer] The function to customize assigned values.\n     * @returns {Object} Returns `object`.\n     * @see _.assignInWith\n     * @example\n     *\n     * function customizer(objValue, srcValue) {\n     *   return _.isUndefined(objValue) ? srcValue : objValue;\n     * }\n     *\n     * var defaults = _.partialRight(_.assignWith, customizer);\n     *\n     * defaults({ 'a': 1 }, { 'b': 2 }, { 'a': 3 });\n     * // => { 'a': 1, 'b': 2 }\n     */\n    var assignWith = createAssigner(function(object, source, srcIndex, customizer) {\n      copyObject(source, keys(source), object, customizer);\n    });\n\n    /**\n     * Creates an array of values corresponding to `paths` of `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.0.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {...(string|string[])} [paths] The property paths to pick.\n     * @returns {Array} Returns the picked values.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c': 3 } }, 4] };\n     *\n     * _.at(object, ['a[0].b.c', 'a[1]']);\n     * // => [3, 4]\n     */\n    var at = flatRest(baseAt);\n\n    /**\n     * Creates an object that inherits from the `prototype` object. If a\n     * `properties` object is given, its own enumerable string keyed properties\n     * are assigned to the created object.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.3.0\n     * @category Object\n     * @param {Object} prototype The object to inherit from.\n     * @param {Object} [properties] The properties to assign to the object.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * function Shape() {\n     *   this.x = 0;\n     *   this.y = 0;\n     * }\n     *\n     * function Circle() {\n     *   Shape.call(this);\n     * }\n     *\n     * Circle.prototype = _.create(Shape.prototype, {\n     *   'constructor': Circle\n     * });\n     *\n     * var circle = new Circle;\n     * circle instanceof Circle;\n     * // => true\n     *\n     * circle instanceof Shape;\n     * // => true\n     */\n    function create(prototype, properties) {\n      var result = baseCreate(prototype);\n      return properties == null ? result : baseAssign(result, properties);\n    }\n\n    /**\n     * Assigns own and inherited enumerable string keyed properties of source\n     * objects to the destination object for all destination properties that\n     * resolve to `undefined`. Source objects are applied from left to right.\n     * Once a property is set, additional values of the same property are ignored.\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} [sources] The source objects.\n     * @returns {Object} Returns `object`.\n     * @see _.defaultsDeep\n     * @example\n     *\n     * _.defaults({ 'a': 1 }, { 'b': 2 }, { 'a': 3 });\n     * // => { 'a': 1, 'b': 2 }\n     */\n    var defaults = baseRest(function(object, sources) {\n      object = Object(object);\n\n      var index = -1;\n      var length = sources.length;\n      var guard = length > 2 ? sources[2] : undefined;\n\n      if (guard && isIterateeCall(sources[0], sources[1], guard)) {\n        length = 1;\n      }\n\n      while (++index < length) {\n        var source = sources[index];\n        var props = keysIn(source);\n        var propsIndex = -1;\n        var propsLength = props.length;\n\n        while (++propsIndex < propsLength) {\n          var key = props[propsIndex];\n          var value = object[key];\n\n          if (value === undefined ||\n              (eq(value, objectProto[key]) && !hasOwnProperty.call(object, key))) {\n            object[key] = source[key];\n          }\n        }\n      }\n\n      return object;\n    });\n\n    /**\n     * This method is like `_.defaults` except that it recursively assigns\n     * default properties.\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.10.0\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} [sources] The source objects.\n     * @returns {Object} Returns `object`.\n     * @see _.defaults\n     * @example\n     *\n     * _.defaultsDeep({ 'a': { 'b': 2 } }, { 'a': { 'b': 1, 'c': 3 } });\n     * // => { 'a': { 'b': 2, 'c': 3 } }\n     */\n    var defaultsDeep = baseRest(function(args) {\n      args.push(undefined, customDefaultsMerge);\n      return apply(mergeWith, undefined, args);\n    });\n\n    /**\n     * This method is like `_.find` except that it returns the key of the first\n     * element `predicate` returns truthy for instead of the element itself.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.1.0\n     * @category Object\n     * @param {Object} object The object to inspect.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {string|undefined} Returns the key of the matched element,\n     *  else `undefined`.\n     * @example\n     *\n     * var users = {\n     *   'barney':  { 'age': 36, 'active': true },\n     *   'fred':    { 'age': 40, 'active': false },\n     *   'pebbles': { 'age': 1,  'active': true }\n     * };\n     *\n     * _.findKey(users, function(o) { return o.age < 40; });\n     * // => 'barney' (iteration order is not guaranteed)\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.findKey(users, { 'age': 1, 'active': true });\n     * // => 'pebbles'\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.findKey(users, ['active', false]);\n     * // => 'fred'\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.findKey(users, 'active');\n     * // => 'barney'\n     */\n    function findKey(object, predicate) {\n      return baseFindKey(object, getIteratee(predicate, 3), baseForOwn);\n    }\n\n    /**\n     * This method is like `_.findKey` except that it iterates over elements of\n     * a collection in the opposite order.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Object\n     * @param {Object} object The object to inspect.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {string|undefined} Returns the key of the matched element,\n     *  else `undefined`.\n     * @example\n     *\n     * var users = {\n     *   'barney':  { 'age': 36, 'active': true },\n     *   'fred':    { 'age': 40, 'active': false },\n     *   'pebbles': { 'age': 1,  'active': true }\n     * };\n     *\n     * _.findLastKey(users, function(o) { return o.age < 40; });\n     * // => returns 'pebbles' assuming `_.findKey` returns 'barney'\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.findLastKey(users, { 'age': 36, 'active': true });\n     * // => 'barney'\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.findLastKey(users, ['active', false]);\n     * // => 'fred'\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.findLastKey(users, 'active');\n     * // => 'pebbles'\n     */\n    function findLastKey(object, predicate) {\n      return baseFindKey(object, getIteratee(predicate, 3), baseForOwnRight);\n    }\n\n    /**\n     * Iterates over own and inherited enumerable string keyed properties of an\n     * object and invokes `iteratee` for each property. The iteratee is invoked\n     * with three arguments: (value, key, object). Iteratee functions may exit\n     * iteration early by explicitly returning `false`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.3.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Object} Returns `object`.\n     * @see _.forInRight\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.forIn(new Foo, function(value, key) {\n     *   console.log(key);\n     * });\n     * // => Logs 'a', 'b', then 'c' (iteration order is not guaranteed).\n     */\n    function forIn(object, iteratee) {\n      return object == null\n        ? object\n        : baseFor(object, getIteratee(iteratee, 3), keysIn);\n    }\n\n    /**\n     * This method is like `_.forIn` except that it iterates over properties of\n     * `object` in the opposite order.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Object} Returns `object`.\n     * @see _.forIn\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.forInRight(new Foo, function(value, key) {\n     *   console.log(key);\n     * });\n     * // => Logs 'c', 'b', then 'a' assuming `_.forIn` logs 'a', 'b', then 'c'.\n     */\n    function forInRight(object, iteratee) {\n      return object == null\n        ? object\n        : baseForRight(object, getIteratee(iteratee, 3), keysIn);\n    }\n\n    /**\n     * Iterates over own enumerable string keyed properties of an object and\n     * invokes `iteratee` for each property. The iteratee is invoked with three\n     * arguments: (value, key, object). Iteratee functions may exit iteration\n     * early by explicitly returning `false`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.3.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Object} Returns `object`.\n     * @see _.forOwnRight\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.forOwn(new Foo, function(value, key) {\n     *   console.log(key);\n     * });\n     * // => Logs 'a' then 'b' (iteration order is not guaranteed).\n     */\n    function forOwn(object, iteratee) {\n      return object && baseForOwn(object, getIteratee(iteratee, 3));\n    }\n\n    /**\n     * This method is like `_.forOwn` except that it iterates over properties of\n     * `object` in the opposite order.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Object} Returns `object`.\n     * @see _.forOwn\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.forOwnRight(new Foo, function(value, key) {\n     *   console.log(key);\n     * });\n     * // => Logs 'b' then 'a' assuming `_.forOwn` logs 'a' then 'b'.\n     */\n    function forOwnRight(object, iteratee) {\n      return object && baseForOwnRight(object, getIteratee(iteratee, 3));\n    }\n\n    /**\n     * Creates an array of function property names from own enumerable properties\n     * of `object`.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The object to inspect.\n     * @returns {Array} Returns the function names.\n     * @see _.functionsIn\n     * @example\n     *\n     * function Foo() {\n     *   this.a = _.constant('a');\n     *   this.b = _.constant('b');\n     * }\n     *\n     * Foo.prototype.c = _.constant('c');\n     *\n     * _.functions(new Foo);\n     * // => ['a', 'b']\n     */\n    function functions(object) {\n      return object == null ? [] : baseFunctions(object, keys(object));\n    }\n\n    /**\n     * Creates an array of function property names from own and inherited\n     * enumerable properties of `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The object to inspect.\n     * @returns {Array} Returns the function names.\n     * @see _.functions\n     * @example\n     *\n     * function Foo() {\n     *   this.a = _.constant('a');\n     *   this.b = _.constant('b');\n     * }\n     *\n     * Foo.prototype.c = _.constant('c');\n     *\n     * _.functionsIn(new Foo);\n     * // => ['a', 'b', 'c']\n     */\n    function functionsIn(object) {\n      return object == null ? [] : baseFunctions(object, keysIn(object));\n    }\n\n    /**\n     * Gets the value at `path` of `object`. If the resolved value is\n     * `undefined`, the `defaultValue` is returned in its place.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.7.0\n     * @category Object\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path of the property to get.\n     * @param {*} [defaultValue] The value returned for `undefined` resolved values.\n     * @returns {*} Returns the resolved value.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n     *\n     * _.get(object, 'a[0].b.c');\n     * // => 3\n     *\n     * _.get(object, ['a', '0', 'b', 'c']);\n     * // => 3\n     *\n     * _.get(object, 'a.b.c', 'default');\n     * // => 'default'\n     */\n    function get(object, path, defaultValue) {\n      var result = object == null ? undefined : baseGet(object, path);\n      return result === undefined ? defaultValue : result;\n    }\n\n    /**\n     * Checks if `path` is a direct property of `object`.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path to check.\n     * @returns {boolean} Returns `true` if `path` exists, else `false`.\n     * @example\n     *\n     * var object = { 'a': { 'b': 2 } };\n     * var other = _.create({ 'a': _.create({ 'b': 2 }) });\n     *\n     * _.has(object, 'a');\n     * // => true\n     *\n     * _.has(object, 'a.b');\n     * // => true\n     *\n     * _.has(object, ['a', 'b']);\n     * // => true\n     *\n     * _.has(other, 'a');\n     * // => false\n     */\n    function has(object, path) {\n      return object != null && hasPath(object, path, baseHas);\n    }\n\n    /**\n     * Checks if `path` is a direct or inherited property of `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path to check.\n     * @returns {boolean} Returns `true` if `path` exists, else `false`.\n     * @example\n     *\n     * var object = _.create({ 'a': _.create({ 'b': 2 }) });\n     *\n     * _.hasIn(object, 'a');\n     * // => true\n     *\n     * _.hasIn(object, 'a.b');\n     * // => true\n     *\n     * _.hasIn(object, ['a', 'b']);\n     * // => true\n     *\n     * _.hasIn(object, 'b');\n     * // => false\n     */\n    function hasIn(object, path) {\n      return object != null && hasPath(object, path, baseHasIn);\n    }\n\n    /**\n     * Creates an object composed of the inverted keys and values of `object`.\n     * If `object` contains duplicate values, subsequent values overwrite\n     * property assignments of previous values.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.7.0\n     * @category Object\n     * @param {Object} object The object to invert.\n     * @returns {Object} Returns the new inverted object.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': 2, 'c': 1 };\n     *\n     * _.invert(object);\n     * // => { '1': 'c', '2': 'b' }\n     */\n    var invert = createInverter(function(result, value, key) {\n      if (value != null &&\n          typeof value.toString != 'function') {\n        value = nativeObjectToString.call(value);\n      }\n\n      result[value] = key;\n    }, constant(identity));\n\n    /**\n     * This method is like `_.invert` except that the inverted object is generated\n     * from the results of running each element of `object` thru `iteratee`. The\n     * corresponding inverted value of each inverted key is an array of keys\n     * responsible for generating the inverted value. The iteratee is invoked\n     * with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.1.0\n     * @category Object\n     * @param {Object} object The object to invert.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {Object} Returns the new inverted object.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': 2, 'c': 1 };\n     *\n     * _.invertBy(object);\n     * // => { '1': ['a', 'c'], '2': ['b'] }\n     *\n     * _.invertBy(object, function(value) {\n     *   return 'group' + value;\n     * });\n     * // => { 'group1': ['a', 'c'], 'group2': ['b'] }\n     */\n    var invertBy = createInverter(function(result, value, key) {\n      if (value != null &&\n          typeof value.toString != 'function') {\n        value = nativeObjectToString.call(value);\n      }\n\n      if (hasOwnProperty.call(result, value)) {\n        result[value].push(key);\n      } else {\n        result[value] = [key];\n      }\n    }, getIteratee);\n\n    /**\n     * Invokes the method at `path` of `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path of the method to invoke.\n     * @param {...*} [args] The arguments to invoke the method with.\n     * @returns {*} Returns the result of the invoked method.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c': [1, 2, 3, 4] } }] };\n     *\n     * _.invoke(object, 'a[0].b.c.slice', 1, 3);\n     * // => [2, 3]\n     */\n    var invoke = baseRest(baseInvoke);\n\n    /**\n     * Creates an array of the own enumerable property names of `object`.\n     *\n     * **Note:** Non-object values are coerced to objects. See the\n     * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n     * for more details.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property names.\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.keys(new Foo);\n     * // => ['a', 'b'] (iteration order is not guaranteed)\n     *\n     * _.keys('hi');\n     * // => ['0', '1']\n     */\n    function keys(object) {\n      return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n    }\n\n    /**\n     * Creates an array of the own and inherited enumerable property names of `object`.\n     *\n     * **Note:** Non-object values are coerced to objects.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Object\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property names.\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.keysIn(new Foo);\n     * // => ['a', 'b', 'c'] (iteration order is not guaranteed)\n     */\n    function keysIn(object) {\n      return isArrayLike(object) ? arrayLikeKeys(object, true) : baseKeysIn(object);\n    }\n\n    /**\n     * The opposite of `_.mapValues`; this method creates an object with the\n     * same values as `object` and keys generated by running each own enumerable\n     * string keyed property of `object` thru `iteratee`. The iteratee is invoked\n     * with three arguments: (value, key, object).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.8.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Object} Returns the new mapped object.\n     * @see _.mapValues\n     * @example\n     *\n     * _.mapKeys({ 'a': 1, 'b': 2 }, function(value, key) {\n     *   return key + value;\n     * });\n     * // => { 'a1': 1, 'b2': 2 }\n     */\n    function mapKeys(object, iteratee) {\n      var result = {};\n      iteratee = getIteratee(iteratee, 3);\n\n      baseForOwn(object, function(value, key, object) {\n        baseAssignValue(result, iteratee(value, key, object), value);\n      });\n      return result;\n    }\n\n    /**\n     * Creates an object with the same keys as `object` and values generated\n     * by running each own enumerable string keyed property of `object` thru\n     * `iteratee`. The iteratee is invoked with three arguments:\n     * (value, key, object).\n     *\n     * @static\n     * @memberOf _\n     * @since 2.4.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Object} Returns the new mapped object.\n     * @see _.mapKeys\n     * @example\n     *\n     * var users = {\n     *   'fred':    { 'user': 'fred',    'age': 40 },\n     *   'pebbles': { 'user': 'pebbles', 'age': 1 }\n     * };\n     *\n     * _.mapValues(users, function(o) { return o.age; });\n     * // => { 'fred': 40, 'pebbles': 1 } (iteration order is not guaranteed)\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.mapValues(users, 'age');\n     * // => { 'fred': 40, 'pebbles': 1 } (iteration order is not guaranteed)\n     */\n    function mapValues(object, iteratee) {\n      var result = {};\n      iteratee = getIteratee(iteratee, 3);\n\n      baseForOwn(object, function(value, key, object) {\n        baseAssignValue(result, key, iteratee(value, key, object));\n      });\n      return result;\n    }\n\n    /**\n     * This method is like `_.assign` except that it recursively merges own and\n     * inherited enumerable string keyed properties of source objects into the\n     * destination object. Source properties that resolve to `undefined` are\n     * skipped if a destination value exists. Array and plain object properties\n     * are merged recursively. Other objects and value types are overridden by\n     * assignment. Source objects are applied from left to right. Subsequent\n     * sources overwrite property assignments of previous sources.\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.5.0\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} [sources] The source objects.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * var object = {\n     *   'a': [{ 'b': 2 }, { 'd': 4 }]\n     * };\n     *\n     * var other = {\n     *   'a': [{ 'c': 3 }, { 'e': 5 }]\n     * };\n     *\n     * _.merge(object, other);\n     * // => { 'a': [{ 'b': 2, 'c': 3 }, { 'd': 4, 'e': 5 }] }\n     */\n    var merge = createAssigner(function(object, source, srcIndex) {\n      baseMerge(object, source, srcIndex);\n    });\n\n    /**\n     * This method is like `_.merge` except that it accepts `customizer` which\n     * is invoked to produce the merged values of the destination and source\n     * properties. If `customizer` returns `undefined`, merging is handled by the\n     * method instead. The `customizer` is invoked with six arguments:\n     * (objValue, srcValue, key, object, source, stack).\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} sources The source objects.\n     * @param {Function} customizer The function to customize assigned values.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * function customizer(objValue, srcValue) {\n     *   if (_.isArray(objValue)) {\n     *     return objValue.concat(srcValue);\n     *   }\n     * }\n     *\n     * var object = { 'a': [1], 'b': [2] };\n     * var other = { 'a': [3], 'b': [4] };\n     *\n     * _.mergeWith(object, other, customizer);\n     * // => { 'a': [1, 3], 'b': [2, 4] }\n     */\n    var mergeWith = createAssigner(function(object, source, srcIndex, customizer) {\n      baseMerge(object, source, srcIndex, customizer);\n    });\n\n    /**\n     * The opposite of `_.pick`; this method creates an object composed of the\n     * own and inherited enumerable property paths of `object` that are not omitted.\n     *\n     * **Note:** This method is considerably slower than `_.pick`.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The source object.\n     * @param {...(string|string[])} [paths] The property paths to omit.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': '2', 'c': 3 };\n     *\n     * _.omit(object, ['a', 'c']);\n     * // => { 'b': '2' }\n     */\n    var omit = flatRest(function(object, paths) {\n      var result = {};\n      if (object == null) {\n        return result;\n      }\n      var isDeep = false;\n      paths = arrayMap(paths, function(path) {\n        path = castPath(path, object);\n        isDeep || (isDeep = path.length > 1);\n        return path;\n      });\n      copyObject(object, getAllKeysIn(object), result);\n      if (isDeep) {\n        result = baseClone(result, CLONE_DEEP_FLAG | CLONE_FLAT_FLAG | CLONE_SYMBOLS_FLAG, customOmitClone);\n      }\n      var length = paths.length;\n      while (length--) {\n        baseUnset(result, paths[length]);\n      }\n      return result;\n    });\n\n    /**\n     * The opposite of `_.pickBy`; this method creates an object composed of\n     * the own and inherited enumerable string keyed properties of `object` that\n     * `predicate` doesn't return truthy for. The predicate is invoked with two\n     * arguments: (value, key).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The source object.\n     * @param {Function} [predicate=_.identity] The function invoked per property.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': '2', 'c': 3 };\n     *\n     * _.omitBy(object, _.isNumber);\n     * // => { 'b': '2' }\n     */\n    function omitBy(object, predicate) {\n      return pickBy(object, negate(getIteratee(predicate)));\n    }\n\n    /**\n     * Creates an object composed of the picked `object` properties.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The source object.\n     * @param {...(string|string[])} [paths] The property paths to pick.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': '2', 'c': 3 };\n     *\n     * _.pick(object, ['a', 'c']);\n     * // => { 'a': 1, 'c': 3 }\n     */\n    var pick = flatRest(function(object, paths) {\n      return object == null ? {} : basePick(object, paths);\n    });\n\n    /**\n     * Creates an object composed of the `object` properties `predicate` returns\n     * truthy for. The predicate is invoked with two arguments: (value, key).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The source object.\n     * @param {Function} [predicate=_.identity] The function invoked per property.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': '2', 'c': 3 };\n     *\n     * _.pickBy(object, _.isNumber);\n     * // => { 'a': 1, 'c': 3 }\n     */\n    function pickBy(object, predicate) {\n      if (object == null) {\n        return {};\n      }\n      var props = arrayMap(getAllKeysIn(object), function(prop) {\n        return [prop];\n      });\n      predicate = getIteratee(predicate);\n      return basePickBy(object, props, function(value, path) {\n        return predicate(value, path[0]);\n      });\n    }\n\n    /**\n     * This method is like `_.get` except that if the resolved value is a\n     * function it's invoked with the `this` binding of its parent object and\n     * its result is returned.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path of the property to resolve.\n     * @param {*} [defaultValue] The value returned for `undefined` resolved values.\n     * @returns {*} Returns the resolved value.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c1': 3, 'c2': _.constant(4) } }] };\n     *\n     * _.result(object, 'a[0].b.c1');\n     * // => 3\n     *\n     * _.result(object, 'a[0].b.c2');\n     * // => 4\n     *\n     * _.result(object, 'a[0].b.c3', 'default');\n     * // => 'default'\n     *\n     * _.result(object, 'a[0].b.c3', _.constant('default'));\n     * // => 'default'\n     */\n    function result(object, path, defaultValue) {\n      path = castPath(path, object);\n\n      var index = -1,\n          length = path.length;\n\n      // Ensure the loop is entered when path is empty.\n      if (!length) {\n        length = 1;\n        object = undefined;\n      }\n      while (++index < length) {\n        var value = object == null ? undefined : object[toKey(path[index])];\n        if (value === undefined) {\n          index = length;\n          value = defaultValue;\n        }\n        object = isFunction(value) ? value.call(object) : value;\n      }\n      return object;\n    }\n\n    /**\n     * Sets the value at `path` of `object`. If a portion of `path` doesn't exist,\n     * it's created. Arrays are created for missing index properties while objects\n     * are created for all other missing properties. Use `_.setWith` to customize\n     * `path` creation.\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.7.0\n     * @category Object\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The path of the property to set.\n     * @param {*} value The value to set.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n     *\n     * _.set(object, 'a[0].b.c', 4);\n     * console.log(object.a[0].b.c);\n     * // => 4\n     *\n     * _.set(object, ['x', '0', 'y', 'z'], 5);\n     * console.log(object.x[0].y.z);\n     * // => 5\n     */\n    function set(object, path, value) {\n      return object == null ? object : baseSet(object, path, value);\n    }\n\n    /**\n     * This method is like `_.set` except that it accepts `customizer` which is\n     * invoked to produce the objects of `path`.  If `customizer` returns `undefined`\n     * path creation is handled by the method instead. The `customizer` is invoked\n     * with three arguments: (nsValue, key, nsObject).\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The path of the property to set.\n     * @param {*} value The value to set.\n     * @param {Function} [customizer] The function to customize assigned values.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * var object = {};\n     *\n     * _.setWith(object, '[0][1]', 'a', Object);\n     * // => { '0': { '1': 'a' } }\n     */\n    function setWith(object, path, value, customizer) {\n      customizer = typeof customizer == 'function' ? customizer : undefined;\n      return object == null ? object : baseSet(object, path, value, customizer);\n    }\n\n    /**\n     * Creates an array of own enumerable string keyed-value pairs for `object`\n     * which can be consumed by `_.fromPairs`. If `object` is a map or set, its\n     * entries are returned.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @alias entries\n     * @category Object\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the key-value pairs.\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.toPairs(new Foo);\n     * // => [['a', 1], ['b', 2]] (iteration order is not guaranteed)\n     */\n    var toPairs = createToPairs(keys);\n\n    /**\n     * Creates an array of own and inherited enumerable string keyed-value pairs\n     * for `object` which can be consumed by `_.fromPairs`. If `object` is a map\n     * or set, its entries are returned.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @alias entriesIn\n     * @category Object\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the key-value pairs.\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.toPairsIn(new Foo);\n     * // => [['a', 1], ['b', 2], ['c', 3]] (iteration order is not guaranteed)\n     */\n    var toPairsIn = createToPairs(keysIn);\n\n    /**\n     * An alternative to `_.reduce`; this method transforms `object` to a new\n     * `accumulator` object which is the result of running each of its own\n     * enumerable string keyed properties thru `iteratee`, with each invocation\n     * potentially mutating the `accumulator` object. If `accumulator` is not\n     * provided, a new object with the same `[[Prototype]]` will be used. The\n     * iteratee is invoked with four arguments: (accumulator, value, key, object).\n     * Iteratee functions may exit iteration early by explicitly returning `false`.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.3.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @param {*} [accumulator] The custom accumulator value.\n     * @returns {*} Returns the accumulated value.\n     * @example\n     *\n     * _.transform([2, 3, 4], function(result, n) {\n     *   result.push(n *= n);\n     *   return n % 2 == 0;\n     * }, []);\n     * // => [4, 9]\n     *\n     * _.transform({ 'a': 1, 'b': 2, 'c': 1 }, function(result, value, key) {\n     *   (result[value] || (result[value] = [])).push(key);\n     * }, {});\n     * // => { '1': ['a', 'c'], '2': ['b'] }\n     */\n    function transform(object, iteratee, accumulator) {\n      var isArr = isArray(object),\n          isArrLike = isArr || isBuffer(object) || isTypedArray(object);\n\n      iteratee = getIteratee(iteratee, 4);\n      if (accumulator == null) {\n        var Ctor = object && object.constructor;\n        if (isArrLike) {\n          accumulator = isArr ? new Ctor : [];\n        }\n        else if (isObject(object)) {\n          accumulator = isFunction(Ctor) ? baseCreate(getPrototype(object)) : {};\n        }\n        else {\n          accumulator = {};\n        }\n      }\n      (isArrLike ? arrayEach : baseForOwn)(object, function(value, index, object) {\n        return iteratee(accumulator, value, index, object);\n      });\n      return accumulator;\n    }\n\n    /**\n     * Removes the property at `path` of `object`.\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The path of the property to unset.\n     * @returns {boolean} Returns `true` if the property is deleted, else `false`.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c': 7 } }] };\n     * _.unset(object, 'a[0].b.c');\n     * // => true\n     *\n     * console.log(object);\n     * // => { 'a': [{ 'b': {} }] };\n     *\n     * _.unset(object, ['a', '0', 'b', 'c']);\n     * // => true\n     *\n     * console.log(object);\n     * // => { 'a': [{ 'b': {} }] };\n     */\n    function unset(object, path) {\n      return object == null ? true : baseUnset(object, path);\n    }\n\n    /**\n     * This method is like `_.set` except that accepts `updater` to produce the\n     * value to set. Use `_.updateWith` to customize `path` creation. The `updater`\n     * is invoked with one argument: (value).\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.6.0\n     * @category Object\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The path of the property to set.\n     * @param {Function} updater The function to produce the updated value.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n     *\n     * _.update(object, 'a[0].b.c', function(n) { return n * n; });\n     * console.log(object.a[0].b.c);\n     * // => 9\n     *\n     * _.update(object, 'x[0].y.z', function(n) { return n ? n + 1 : 0; });\n     * console.log(object.x[0].y.z);\n     * // => 0\n     */\n    function update(object, path, updater) {\n      return object == null ? object : baseUpdate(object, path, castFunction(updater));\n    }\n\n    /**\n     * This method is like `_.update` except that it accepts `customizer` which is\n     * invoked to produce the objects of `path`.  If `customizer` returns `undefined`\n     * path creation is handled by the method instead. The `customizer` is invoked\n     * with three arguments: (nsValue, key, nsObject).\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.6.0\n     * @category Object\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The path of the property to set.\n     * @param {Function} updater The function to produce the updated value.\n     * @param {Function} [customizer] The function to customize assigned values.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * var object = {};\n     *\n     * _.updateWith(object, '[0][1]', _.constant('a'), Object);\n     * // => { '0': { '1': 'a' } }\n     */\n    function updateWith(object, path, updater, customizer) {\n      customizer = typeof customizer == 'function' ? customizer : undefined;\n      return object == null ? object : baseUpdate(object, path, castFunction(updater), customizer);\n    }\n\n    /**\n     * Creates an array of the own enumerable string keyed property values of `object`.\n     *\n     * **Note:** Non-object values are coerced to objects.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property values.\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.values(new Foo);\n     * // => [1, 2] (iteration order is not guaranteed)\n     *\n     * _.values('hi');\n     * // => ['h', 'i']\n     */\n    function values(object) {\n      return object == null ? [] : baseValues(object, keys(object));\n    }\n\n    /**\n     * Creates an array of the own and inherited enumerable string keyed property\n     * values of `object`.\n     *\n     * **Note:** Non-object values are coerced to objects.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Object\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property values.\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.valuesIn(new Foo);\n     * // => [1, 2, 3] (iteration order is not guaranteed)\n     */\n    function valuesIn(object) {\n      return object == null ? [] : baseValues(object, keysIn(object));\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Clamps `number` within the inclusive `lower` and `upper` bounds.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Number\n     * @param {number} number The number to clamp.\n     * @param {number} [lower] The lower bound.\n     * @param {number} upper The upper bound.\n     * @returns {number} Returns the clamped number.\n     * @example\n     *\n     * _.clamp(-10, -5, 5);\n     * // => -5\n     *\n     * _.clamp(10, -5, 5);\n     * // => 5\n     */\n    function clamp(number, lower, upper) {\n      if (upper === undefined) {\n        upper = lower;\n        lower = undefined;\n      }\n      if (upper !== undefined) {\n        upper = toNumber(upper);\n        upper = upper === upper ? upper : 0;\n      }\n      if (lower !== undefined) {\n        lower = toNumber(lower);\n        lower = lower === lower ? lower : 0;\n      }\n      return baseClamp(toNumber(number), lower, upper);\n    }\n\n    /**\n     * Checks if `n` is between `start` and up to, but not including, `end`. If\n     * `end` is not specified, it's set to `start` with `start` then set to `0`.\n     * If `start` is greater than `end` the params are swapped to support\n     * negative ranges.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.3.0\n     * @category Number\n     * @param {number} number The number to check.\n     * @param {number} [start=0] The start of the range.\n     * @param {number} end The end of the range.\n     * @returns {boolean} Returns `true` if `number` is in the range, else `false`.\n     * @see _.range, _.rangeRight\n     * @example\n     *\n     * _.inRange(3, 2, 4);\n     * // => true\n     *\n     * _.inRange(4, 8);\n     * // => true\n     *\n     * _.inRange(4, 2);\n     * // => false\n     *\n     * _.inRange(2, 2);\n     * // => false\n     *\n     * _.inRange(1.2, 2);\n     * // => true\n     *\n     * _.inRange(5.2, 4);\n     * // => false\n     *\n     * _.inRange(-3, -2, -6);\n     * // => true\n     */\n    function inRange(number, start, end) {\n      start = toFinite(start);\n      if (end === undefined) {\n        end = start;\n        start = 0;\n      } else {\n        end = toFinite(end);\n      }\n      number = toNumber(number);\n      return baseInRange(number, start, end);\n    }\n\n    /**\n     * Produces a random number between the inclusive `lower` and `upper` bounds.\n     * If only one argument is provided a number between `0` and the given number\n     * is returned. If `floating` is `true`, or either `lower` or `upper` are\n     * floats, a floating-point number is returned instead of an integer.\n     *\n     * **Note:** JavaScript follows the IEEE-754 standard for resolving\n     * floating-point values which can produce unexpected results.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.7.0\n     * @category Number\n     * @param {number} [lower=0] The lower bound.\n     * @param {number} [upper=1] The upper bound.\n     * @param {boolean} [floating] Specify returning a floating-point number.\n     * @returns {number} Returns the random number.\n     * @example\n     *\n     * _.random(0, 5);\n     * // => an integer between 0 and 5\n     *\n     * _.random(5);\n     * // => also an integer between 0 and 5\n     *\n     * _.random(5, true);\n     * // => a floating-point number between 0 and 5\n     *\n     * _.random(1.2, 5.2);\n     * // => a floating-point number between 1.2 and 5.2\n     */\n    function random(lower, upper, floating) {\n      if (floating && typeof floating != 'boolean' && isIterateeCall(lower, upper, floating)) {\n        upper = floating = undefined;\n      }\n      if (floating === undefined) {\n        if (typeof upper == 'boolean') {\n          floating = upper;\n          upper = undefined;\n        }\n        else if (typeof lower == 'boolean') {\n          floating = lower;\n          lower = undefined;\n        }\n      }\n      if (lower === undefined && upper === undefined) {\n        lower = 0;\n        upper = 1;\n      }\n      else {\n        lower = toFinite(lower);\n        if (upper === undefined) {\n          upper = lower;\n          lower = 0;\n        } else {\n          upper = toFinite(upper);\n        }\n      }\n      if (lower > upper) {\n        var temp = lower;\n        lower = upper;\n        upper = temp;\n      }\n      if (floating || lower % 1 || upper % 1) {\n        var rand = nativeRandom();\n        return nativeMin(lower + (rand * (upper - lower + freeParseFloat('1e-' + ((rand + '').length - 1)))), upper);\n      }\n      return baseRandom(lower, upper);\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Converts `string` to [camel case](https://en.wikipedia.org/wiki/CamelCase).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the camel cased string.\n     * @example\n     *\n     * _.camelCase('Foo Bar');\n     * // => 'fooBar'\n     *\n     * _.camelCase('--foo-bar--');\n     * // => 'fooBar'\n     *\n     * _.camelCase('__FOO_BAR__');\n     * // => 'fooBar'\n     */\n    var camelCase = createCompounder(function(result, word, index) {\n      word = word.toLowerCase();\n      return result + (index ? capitalize(word) : word);\n    });\n\n    /**\n     * Converts the first character of `string` to upper case and the remaining\n     * to lower case.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to capitalize.\n     * @returns {string} Returns the capitalized string.\n     * @example\n     *\n     * _.capitalize('FRED');\n     * // => 'Fred'\n     */\n    function capitalize(string) {\n      return upperFirst(toString(string).toLowerCase());\n    }\n\n    /**\n     * Deburrs `string` by converting\n     * [Latin-1 Supplement](https://en.wikipedia.org/wiki/Latin-1_Supplement_(Unicode_block)#Character_table)\n     * and [Latin Extended-A](https://en.wikipedia.org/wiki/Latin_Extended-A)\n     * letters to basic Latin letters and removing\n     * [combining diacritical marks](https://en.wikipedia.org/wiki/Combining_Diacritical_Marks).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to deburr.\n     * @returns {string} Returns the deburred string.\n     * @example\n     *\n     * _.deburr('déjà vu');\n     * // => 'deja vu'\n     */\n    function deburr(string) {\n      string = toString(string);\n      return string && string.replace(reLatin, deburrLetter).replace(reComboMark, '');\n    }\n\n    /**\n     * Checks if `string` ends with the given target string.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to inspect.\n     * @param {string} [target] The string to search for.\n     * @param {number} [position=string.length] The position to search up to.\n     * @returns {boolean} Returns `true` if `string` ends with `target`,\n     *  else `false`.\n     * @example\n     *\n     * _.endsWith('abc', 'c');\n     * // => true\n     *\n     * _.endsWith('abc', 'b');\n     * // => false\n     *\n     * _.endsWith('abc', 'b', 2);\n     * // => true\n     */\n    function endsWith(string, target, position) {\n      string = toString(string);\n      target = baseToString(target);\n\n      var length = string.length;\n      position = position === undefined\n        ? length\n        : baseClamp(toInteger(position), 0, length);\n\n      var end = position;\n      position -= target.length;\n      return position >= 0 && string.slice(position, end) == target;\n    }\n\n    /**\n     * Converts the characters \"&\", \"<\", \">\", '\"', and \"'\" in `string` to their\n     * corresponding HTML entities.\n     *\n     * **Note:** No other characters are escaped. To escape additional\n     * characters use a third-party library like [_he_](https://mths.be/he).\n     *\n     * Though the \">\" character is escaped for symmetry, characters like\n     * \">\" and \"/\" don't need escaping in HTML and have no special meaning\n     * unless they're part of a tag or unquoted attribute value. See\n     * [Mathias Bynens's article](https://mathiasbynens.be/notes/ambiguous-ampersands)\n     * (under \"semi-related fun fact\") for more details.\n     *\n     * When working with HTML you should always\n     * [quote attribute values](http://wonko.com/post/html-escaping) to reduce\n     * XSS vectors.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category String\n     * @param {string} [string=''] The string to escape.\n     * @returns {string} Returns the escaped string.\n     * @example\n     *\n     * _.escape('fred, barney, & pebbles');\n     * // => 'fred, barney, &amp; pebbles'\n     */\n    function escape(string) {\n      string = toString(string);\n      return (string && reHasUnescapedHtml.test(string))\n        ? string.replace(reUnescapedHtml, escapeHtmlChar)\n        : string;\n    }\n\n    /**\n     * Escapes the `RegExp` special characters \"^\", \"$\", \"\\\", \".\", \"*\", \"+\",\n     * \"?\", \"(\", \")\", \"[\", \"]\", \"{\", \"}\", and \"|\" in `string`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to escape.\n     * @returns {string} Returns the escaped string.\n     * @example\n     *\n     * _.escapeRegExp('[lodash](https://lodash.com/)');\n     * // => '\\[lodash\\]\\(https://lodash\\.com/\\)'\n     */\n    function escapeRegExp(string) {\n      string = toString(string);\n      return (string && reHasRegExpChar.test(string))\n        ? string.replace(reRegExpChar, '\\\\$&')\n        : string;\n    }\n\n    /**\n     * Converts `string` to\n     * [kebab case](https://en.wikipedia.org/wiki/Letter_case#Special_case_styles).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the kebab cased string.\n     * @example\n     *\n     * _.kebabCase('Foo Bar');\n     * // => 'foo-bar'\n     *\n     * _.kebabCase('fooBar');\n     * // => 'foo-bar'\n     *\n     * _.kebabCase('__FOO_BAR__');\n     * // => 'foo-bar'\n     */\n    var kebabCase = createCompounder(function(result, word, index) {\n      return result + (index ? '-' : '') + word.toLowerCase();\n    });\n\n    /**\n     * Converts `string`, as space separated words, to lower case.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the lower cased string.\n     * @example\n     *\n     * _.lowerCase('--Foo-Bar--');\n     * // => 'foo bar'\n     *\n     * _.lowerCase('fooBar');\n     * // => 'foo bar'\n     *\n     * _.lowerCase('__FOO_BAR__');\n     * // => 'foo bar'\n     */\n    var lowerCase = createCompounder(function(result, word, index) {\n      return result + (index ? ' ' : '') + word.toLowerCase();\n    });\n\n    /**\n     * Converts the first character of `string` to lower case.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the converted string.\n     * @example\n     *\n     * _.lowerFirst('Fred');\n     * // => 'fred'\n     *\n     * _.lowerFirst('FRED');\n     * // => 'fRED'\n     */\n    var lowerFirst = createCaseFirst('toLowerCase');\n\n    /**\n     * Pads `string` on the left and right sides if it's shorter than `length`.\n     * Padding characters are truncated if they can't be evenly divided by `length`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to pad.\n     * @param {number} [length=0] The padding length.\n     * @param {string} [chars=' '] The string used as padding.\n     * @returns {string} Returns the padded string.\n     * @example\n     *\n     * _.pad('abc', 8);\n     * // => '  abc   '\n     *\n     * _.pad('abc', 8, '_-');\n     * // => '_-abc_-_'\n     *\n     * _.pad('abc', 3);\n     * // => 'abc'\n     */\n    function pad(string, length, chars) {\n      string = toString(string);\n      length = toInteger(length);\n\n      var strLength = length ? stringSize(string) : 0;\n      if (!length || strLength >= length) {\n        return string;\n      }\n      var mid = (length - strLength) / 2;\n      return (\n        createPadding(nativeFloor(mid), chars) +\n        string +\n        createPadding(nativeCeil(mid), chars)\n      );\n    }\n\n    /**\n     * Pads `string` on the right side if it's shorter than `length`. Padding\n     * characters are truncated if they exceed `length`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to pad.\n     * @param {number} [length=0] The padding length.\n     * @param {string} [chars=' '] The string used as padding.\n     * @returns {string} Returns the padded string.\n     * @example\n     *\n     * _.padEnd('abc', 6);\n     * // => 'abc   '\n     *\n     * _.padEnd('abc', 6, '_-');\n     * // => 'abc_-_'\n     *\n     * _.padEnd('abc', 3);\n     * // => 'abc'\n     */\n    function padEnd(string, length, chars) {\n      string = toString(string);\n      length = toInteger(length);\n\n      var strLength = length ? stringSize(string) : 0;\n      return (length && strLength < length)\n        ? (string + createPadding(length - strLength, chars))\n        : string;\n    }\n\n    /**\n     * Pads `string` on the left side if it's shorter than `length`. Padding\n     * characters are truncated if they exceed `length`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to pad.\n     * @param {number} [length=0] The padding length.\n     * @param {string} [chars=' '] The string used as padding.\n     * @returns {string} Returns the padded string.\n     * @example\n     *\n     * _.padStart('abc', 6);\n     * // => '   abc'\n     *\n     * _.padStart('abc', 6, '_-');\n     * // => '_-_abc'\n     *\n     * _.padStart('abc', 3);\n     * // => 'abc'\n     */\n    function padStart(string, length, chars) {\n      string = toString(string);\n      length = toInteger(length);\n\n      var strLength = length ? stringSize(string) : 0;\n      return (length && strLength < length)\n        ? (createPadding(length - strLength, chars) + string)\n        : string;\n    }\n\n    /**\n     * Converts `string` to an integer of the specified radix. If `radix` is\n     * `undefined` or `0`, a `radix` of `10` is used unless `value` is a\n     * hexadecimal, in which case a `radix` of `16` is used.\n     *\n     * **Note:** This method aligns with the\n     * [ES5 implementation](https://es5.github.io/#x15.1.2.2) of `parseInt`.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.1.0\n     * @category String\n     * @param {string} string The string to convert.\n     * @param {number} [radix=10] The radix to interpret `value` by.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {number} Returns the converted integer.\n     * @example\n     *\n     * _.parseInt('08');\n     * // => 8\n     *\n     * _.map(['6', '08', '10'], _.parseInt);\n     * // => [6, 8, 10]\n     */\n    function parseInt(string, radix, guard) {\n      if (guard || radix == null) {\n        radix = 0;\n      } else if (radix) {\n        radix = +radix;\n      }\n      return nativeParseInt(toString(string).replace(reTrimStart, ''), radix || 0);\n    }\n\n    /**\n     * Repeats the given string `n` times.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to repeat.\n     * @param {number} [n=1] The number of times to repeat the string.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {string} Returns the repeated string.\n     * @example\n     *\n     * _.repeat('*', 3);\n     * // => '***'\n     *\n     * _.repeat('abc', 2);\n     * // => 'abcabc'\n     *\n     * _.repeat('abc', 0);\n     * // => ''\n     */\n    function repeat(string, n, guard) {\n      if ((guard ? isIterateeCall(string, n, guard) : n === undefined)) {\n        n = 1;\n      } else {\n        n = toInteger(n);\n      }\n      return baseRepeat(toString(string), n);\n    }\n\n    /**\n     * Replaces matches for `pattern` in `string` with `replacement`.\n     *\n     * **Note:** This method is based on\n     * [`String#replace`](https://mdn.io/String/replace).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to modify.\n     * @param {RegExp|string} pattern The pattern to replace.\n     * @param {Function|string} replacement The match replacement.\n     * @returns {string} Returns the modified string.\n     * @example\n     *\n     * _.replace('Hi Fred', 'Fred', 'Barney');\n     * // => 'Hi Barney'\n     */\n    function replace() {\n      var args = arguments,\n          string = toString(args[0]);\n\n      return args.length < 3 ? string : string.replace(args[1], args[2]);\n    }\n\n    /**\n     * Converts `string` to\n     * [snake case](https://en.wikipedia.org/wiki/Snake_case).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the snake cased string.\n     * @example\n     *\n     * _.snakeCase('Foo Bar');\n     * // => 'foo_bar'\n     *\n     * _.snakeCase('fooBar');\n     * // => 'foo_bar'\n     *\n     * _.snakeCase('--FOO-BAR--');\n     * // => 'foo_bar'\n     */\n    var snakeCase = createCompounder(function(result, word, index) {\n      return result + (index ? '_' : '') + word.toLowerCase();\n    });\n\n    /**\n     * Splits `string` by `separator`.\n     *\n     * **Note:** This method is based on\n     * [`String#split`](https://mdn.io/String/split).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to split.\n     * @param {RegExp|string} separator The separator pattern to split by.\n     * @param {number} [limit] The length to truncate results to.\n     * @returns {Array} Returns the string segments.\n     * @example\n     *\n     * _.split('a-b-c', '-', 2);\n     * // => ['a', 'b']\n     */\n    function split(string, separator, limit) {\n      if (limit && typeof limit != 'number' && isIterateeCall(string, separator, limit)) {\n        separator = limit = undefined;\n      }\n      limit = limit === undefined ? MAX_ARRAY_LENGTH : limit >>> 0;\n      if (!limit) {\n        return [];\n      }\n      string = toString(string);\n      if (string && (\n            typeof separator == 'string' ||\n            (separator != null && !isRegExp(separator))\n          )) {\n        separator = baseToString(separator);\n        if (!separator && hasUnicode(string)) {\n          return castSlice(stringToArray(string), 0, limit);\n        }\n      }\n      return string.split(separator, limit);\n    }\n\n    /**\n     * Converts `string` to\n     * [start case](https://en.wikipedia.org/wiki/Letter_case#Stylistic_or_specialised_usage).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.1.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the start cased string.\n     * @example\n     *\n     * _.startCase('--foo-bar--');\n     * // => 'Foo Bar'\n     *\n     * _.startCase('fooBar');\n     * // => 'Foo Bar'\n     *\n     * _.startCase('__FOO_BAR__');\n     * // => 'FOO BAR'\n     */\n    var startCase = createCompounder(function(result, word, index) {\n      return result + (index ? ' ' : '') + upperFirst(word);\n    });\n\n    /**\n     * Checks if `string` starts with the given target string.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to inspect.\n     * @param {string} [target] The string to search for.\n     * @param {number} [position=0] The position to search from.\n     * @returns {boolean} Returns `true` if `string` starts with `target`,\n     *  else `false`.\n     * @example\n     *\n     * _.startsWith('abc', 'a');\n     * // => true\n     *\n     * _.startsWith('abc', 'b');\n     * // => false\n     *\n     * _.startsWith('abc', 'b', 1);\n     * // => true\n     */\n    function startsWith(string, target, position) {\n      string = toString(string);\n      position = position == null\n        ? 0\n        : baseClamp(toInteger(position), 0, string.length);\n\n      target = baseToString(target);\n      return string.slice(position, position + target.length) == target;\n    }\n\n    /**\n     * Creates a compiled template function that can interpolate data properties\n     * in \"interpolate\" delimiters, HTML-escape interpolated data properties in\n     * \"escape\" delimiters, and execute JavaScript in \"evaluate\" delimiters. Data\n     * properties may be accessed as free variables in the template. If a setting\n     * object is given, it takes precedence over `_.templateSettings` values.\n     *\n     * **Note:** In the development build `_.template` utilizes\n     * [sourceURLs](http://www.html5rocks.com/en/tutorials/developertools/sourcemaps/#toc-sourceurl)\n     * for easier debugging.\n     *\n     * For more information on precompiling templates see\n     * [lodash's custom builds documentation](https://lodash.com/custom-builds).\n     *\n     * For more information on Chrome extension sandboxes see\n     * [Chrome's extensions documentation](https://developer.chrome.com/extensions/sandboxingEval).\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category String\n     * @param {string} [string=''] The template string.\n     * @param {Object} [options={}] The options object.\n     * @param {RegExp} [options.escape=_.templateSettings.escape]\n     *  The HTML \"escape\" delimiter.\n     * @param {RegExp} [options.evaluate=_.templateSettings.evaluate]\n     *  The \"evaluate\" delimiter.\n     * @param {Object} [options.imports=_.templateSettings.imports]\n     *  An object to import into the template as free variables.\n     * @param {RegExp} [options.interpolate=_.templateSettings.interpolate]\n     *  The \"interpolate\" delimiter.\n     * @param {string} [options.sourceURL='lodash.templateSources[n]']\n     *  The sourceURL of the compiled template.\n     * @param {string} [options.variable='obj']\n     *  The data object variable name.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Function} Returns the compiled template function.\n     * @example\n     *\n     * // Use the \"interpolate\" delimiter to create a compiled template.\n     * var compiled = _.template('hello <%= user %>!');\n     * compiled({ 'user': 'fred' });\n     * // => 'hello fred!'\n     *\n     * // Use the HTML \"escape\" delimiter to escape data property values.\n     * var compiled = _.template('<b><%- value %></b>');\n     * compiled({ 'value': '<script>' });\n     * // => '<b>&lt;script&gt;</b>'\n     *\n     * // Use the \"evaluate\" delimiter to execute JavaScript and generate HTML.\n     * var compiled = _.template('<% _.forEach(users, function(user) { %><li><%- user %></li><% }); %>');\n     * compiled({ 'users': ['fred', 'barney'] });\n     * // => '<li>fred</li><li>barney</li>'\n     *\n     * // Use the internal `print` function in \"evaluate\" delimiters.\n     * var compiled = _.template('<% print(\"hello \" + user); %>!');\n     * compiled({ 'user': 'barney' });\n     * // => 'hello barney!'\n     *\n     * // Use the ES template literal delimiter as an \"interpolate\" delimiter.\n     * // Disable support by replacing the \"interpolate\" delimiter.\n     * var compiled = _.template('hello ${ user }!');\n     * compiled({ 'user': 'pebbles' });\n     * // => 'hello pebbles!'\n     *\n     * // Use backslashes to treat delimiters as plain text.\n     * var compiled = _.template('<%= \"\\\\<%- value %\\\\>\" %>');\n     * compiled({ 'value': 'ignored' });\n     * // => '<%- value %>'\n     *\n     * // Use the `imports` option to import `jQuery` as `jq`.\n     * var text = '<% jq.each(users, function(user) { %><li><%- user %></li><% }); %>';\n     * var compiled = _.template(text, { 'imports': { 'jq': jQuery } });\n     * compiled({ 'users': ['fred', 'barney'] });\n     * // => '<li>fred</li><li>barney</li>'\n     *\n     * // Use the `sourceURL` option to specify a custom sourceURL for the template.\n     * var compiled = _.template('hello <%= user %>!', { 'sourceURL': '/basic/greeting.jst' });\n     * compiled(data);\n     * // => Find the source of \"greeting.jst\" under the Sources tab or Resources panel of the web inspector.\n     *\n     * // Use the `variable` option to ensure a with-statement isn't used in the compiled template.\n     * var compiled = _.template('hi <%= data.user %>!', { 'variable': 'data' });\n     * compiled.source;\n     * // => function(data) {\n     * //   var __t, __p = '';\n     * //   __p += 'hi ' + ((__t = ( data.user )) == null ? '' : __t) + '!';\n     * //   return __p;\n     * // }\n     *\n     * // Use custom template delimiters.\n     * _.templateSettings.interpolate = /{{([\\s\\S]+?)}}/g;\n     * var compiled = _.template('hello {{ user }}!');\n     * compiled({ 'user': 'mustache' });\n     * // => 'hello mustache!'\n     *\n     * // Use the `source` property to inline compiled templates for meaningful\n     * // line numbers in error messages and stack traces.\n     * fs.writeFileSync(path.join(process.cwd(), 'jst.js'), '\\\n     *   var JST = {\\\n     *     \"main\": ' + _.template(mainText).source + '\\\n     *   };\\\n     * ');\n     */\n    function template(string, options, guard) {\n      // Based on John Resig's `tmpl` implementation\n      // (http://ejohn.org/blog/javascript-micro-templating/)\n      // and Laura Doktorova's doT.js (https://github.com/olado/doT).\n      var settings = lodash.templateSettings;\n\n      if (guard && isIterateeCall(string, options, guard)) {\n        options = undefined;\n      }\n      string = toString(string);\n      options = assignInWith({}, options, settings, customDefaultsAssignIn);\n\n      var imports = assignInWith({}, options.imports, settings.imports, customDefaultsAssignIn),\n          importsKeys = keys(imports),\n          importsValues = baseValues(imports, importsKeys);\n\n      var isEscaping,\n          isEvaluating,\n          index = 0,\n          interpolate = options.interpolate || reNoMatch,\n          source = \"__p += '\";\n\n      // Compile the regexp to match each delimiter.\n      var reDelimiters = RegExp(\n        (options.escape || reNoMatch).source + '|' +\n        interpolate.source + '|' +\n        (interpolate === reInterpolate ? reEsTemplate : reNoMatch).source + '|' +\n        (options.evaluate || reNoMatch).source + '|$'\n      , 'g');\n\n      // Use a sourceURL for easier debugging.\n      // The sourceURL gets injected into the source that's eval-ed, so be careful\n      // to normalize all kinds of whitespace, so e.g. newlines (and unicode versions of it) can't sneak in\n      // and escape the comment, thus injecting code that gets evaled.\n      var sourceURL = '//# sourceURL=' +\n        (hasOwnProperty.call(options, 'sourceURL')\n          ? (options.sourceURL + '').replace(/\\s/g, ' ')\n          : ('lodash.templateSources[' + (++templateCounter) + ']')\n        ) + '\\n';\n\n      string.replace(reDelimiters, function(match, escapeValue, interpolateValue, esTemplateValue, evaluateValue, offset) {\n        interpolateValue || (interpolateValue = esTemplateValue);\n\n        // Escape characters that can't be included in string literals.\n        source += string.slice(index, offset).replace(reUnescapedString, escapeStringChar);\n\n        // Replace delimiters with snippets.\n        if (escapeValue) {\n          isEscaping = true;\n          source += \"' +\\n__e(\" + escapeValue + \") +\\n'\";\n        }\n        if (evaluateValue) {\n          isEvaluating = true;\n          source += \"';\\n\" + evaluateValue + \";\\n__p += '\";\n        }\n        if (interpolateValue) {\n          source += \"' +\\n((__t = (\" + interpolateValue + \")) == null ? '' : __t) +\\n'\";\n        }\n        index = offset + match.length;\n\n        // The JS engine embedded in Adobe products needs `match` returned in\n        // order to produce the correct `offset` value.\n        return match;\n      });\n\n      source += \"';\\n\";\n\n      // If `variable` is not specified wrap a with-statement around the generated\n      // code to add the data object to the top of the scope chain.\n      var variable = hasOwnProperty.call(options, 'variable') && options.variable;\n      if (!variable) {\n        source = 'with (obj) {\\n' + source + '\\n}\\n';\n      }\n      // Throw an error if a forbidden character was found in `variable`, to prevent\n      // potential command injection attacks.\n      else if (reForbiddenIdentifierChars.test(variable)) {\n        throw new Error(INVALID_TEMPL_VAR_ERROR_TEXT);\n      }\n\n      // Cleanup code by stripping empty strings.\n      source = (isEvaluating ? source.replace(reEmptyStringLeading, '') : source)\n        .replace(reEmptyStringMiddle, '$1')\n        .replace(reEmptyStringTrailing, '$1;');\n\n      // Frame code as the function body.\n      source = 'function(' + (variable || 'obj') + ') {\\n' +\n        (variable\n          ? ''\n          : 'obj || (obj = {});\\n'\n        ) +\n        \"var __t, __p = ''\" +\n        (isEscaping\n           ? ', __e = _.escape'\n           : ''\n        ) +\n        (isEvaluating\n          ? ', __j = Array.prototype.join;\\n' +\n            \"function print() { __p += __j.call(arguments, '') }\\n\"\n          : ';\\n'\n        ) +\n        source +\n        'return __p\\n}';\n\n      var result = attempt(function() {\n        return Function(importsKeys, sourceURL + 'return ' + source)\n          .apply(undefined, importsValues);\n      });\n\n      // Provide the compiled function's source by its `toString` method or\n      // the `source` property as a convenience for inlining compiled templates.\n      result.source = source;\n      if (isError(result)) {\n        throw result;\n      }\n      return result;\n    }\n\n    /**\n     * Converts `string`, as a whole, to lower case just like\n     * [String#toLowerCase](https://mdn.io/toLowerCase).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the lower cased string.\n     * @example\n     *\n     * _.toLower('--Foo-Bar--');\n     * // => '--foo-bar--'\n     *\n     * _.toLower('fooBar');\n     * // => 'foobar'\n     *\n     * _.toLower('__FOO_BAR__');\n     * // => '__foo_bar__'\n     */\n    function toLower(value) {\n      return toString(value).toLowerCase();\n    }\n\n    /**\n     * Converts `string`, as a whole, to upper case just like\n     * [String#toUpperCase](https://mdn.io/toUpperCase).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the upper cased string.\n     * @example\n     *\n     * _.toUpper('--foo-bar--');\n     * // => '--FOO-BAR--'\n     *\n     * _.toUpper('fooBar');\n     * // => 'FOOBAR'\n     *\n     * _.toUpper('__foo_bar__');\n     * // => '__FOO_BAR__'\n     */\n    function toUpper(value) {\n      return toString(value).toUpperCase();\n    }\n\n    /**\n     * Removes leading and trailing whitespace or specified characters from `string`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to trim.\n     * @param {string} [chars=whitespace] The characters to trim.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {string} Returns the trimmed string.\n     * @example\n     *\n     * _.trim('  abc  ');\n     * // => 'abc'\n     *\n     * _.trim('-_-abc-_-', '_-');\n     * // => 'abc'\n     *\n     * _.map(['  foo  ', '  bar  '], _.trim);\n     * // => ['foo', 'bar']\n     */\n    function trim(string, chars, guard) {\n      string = toString(string);\n      if (string && (guard || chars === undefined)) {\n        return baseTrim(string);\n      }\n      if (!string || !(chars = baseToString(chars))) {\n        return string;\n      }\n      var strSymbols = stringToArray(string),\n          chrSymbols = stringToArray(chars),\n          start = charsStartIndex(strSymbols, chrSymbols),\n          end = charsEndIndex(strSymbols, chrSymbols) + 1;\n\n      return castSlice(strSymbols, start, end).join('');\n    }\n\n    /**\n     * Removes trailing whitespace or specified characters from `string`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to trim.\n     * @param {string} [chars=whitespace] The characters to trim.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {string} Returns the trimmed string.\n     * @example\n     *\n     * _.trimEnd('  abc  ');\n     * // => '  abc'\n     *\n     * _.trimEnd('-_-abc-_-', '_-');\n     * // => '-_-abc'\n     */\n    function trimEnd(string, chars, guard) {\n      string = toString(string);\n      if (string && (guard || chars === undefined)) {\n        return string.slice(0, trimmedEndIndex(string) + 1);\n      }\n      if (!string || !(chars = baseToString(chars))) {\n        return string;\n      }\n      var strSymbols = stringToArray(string),\n          end = charsEndIndex(strSymbols, stringToArray(chars)) + 1;\n\n      return castSlice(strSymbols, 0, end).join('');\n    }\n\n    /**\n     * Removes leading whitespace or specified characters from `string`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to trim.\n     * @param {string} [chars=whitespace] The characters to trim.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {string} Returns the trimmed string.\n     * @example\n     *\n     * _.trimStart('  abc  ');\n     * // => 'abc  '\n     *\n     * _.trimStart('-_-abc-_-', '_-');\n     * // => 'abc-_-'\n     */\n    function trimStart(string, chars, guard) {\n      string = toString(string);\n      if (string && (guard || chars === undefined)) {\n        return string.replace(reTrimStart, '');\n      }\n      if (!string || !(chars = baseToString(chars))) {\n        return string;\n      }\n      var strSymbols = stringToArray(string),\n          start = charsStartIndex(strSymbols, stringToArray(chars));\n\n      return castSlice(strSymbols, start).join('');\n    }\n\n    /**\n     * Truncates `string` if it's longer than the given maximum string length.\n     * The last characters of the truncated string are replaced with the omission\n     * string which defaults to \"...\".\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to truncate.\n     * @param {Object} [options={}] The options object.\n     * @param {number} [options.length=30] The maximum string length.\n     * @param {string} [options.omission='...'] The string to indicate text is omitted.\n     * @param {RegExp|string} [options.separator] The separator pattern to truncate to.\n     * @returns {string} Returns the truncated string.\n     * @example\n     *\n     * _.truncate('hi-diddly-ho there, neighborino');\n     * // => 'hi-diddly-ho there, neighbo...'\n     *\n     * _.truncate('hi-diddly-ho there, neighborino', {\n     *   'length': 24,\n     *   'separator': ' '\n     * });\n     * // => 'hi-diddly-ho there,...'\n     *\n     * _.truncate('hi-diddly-ho there, neighborino', {\n     *   'length': 24,\n     *   'separator': /,? +/\n     * });\n     * // => 'hi-diddly-ho there...'\n     *\n     * _.truncate('hi-diddly-ho there, neighborino', {\n     *   'omission': ' [...]'\n     * });\n     * // => 'hi-diddly-ho there, neig [...]'\n     */\n    function truncate(string, options) {\n      var length = DEFAULT_TRUNC_LENGTH,\n          omission = DEFAULT_TRUNC_OMISSION;\n\n      if (isObject(options)) {\n        var separator = 'separator' in options ? options.separator : separator;\n        length = 'length' in options ? toInteger(options.length) : length;\n        omission = 'omission' in options ? baseToString(options.omission) : omission;\n      }\n      string = toString(string);\n\n      var strLength = string.length;\n      if (hasUnicode(string)) {\n        var strSymbols = stringToArray(string);\n        strLength = strSymbols.length;\n      }\n      if (length >= strLength) {\n        return string;\n      }\n      var end = length - stringSize(omission);\n      if (end < 1) {\n        return omission;\n      }\n      var result = strSymbols\n        ? castSlice(strSymbols, 0, end).join('')\n        : string.slice(0, end);\n\n      if (separator === undefined) {\n        return result + omission;\n      }\n      if (strSymbols) {\n        end += (result.length - end);\n      }\n      if (isRegExp(separator)) {\n        if (string.slice(end).search(separator)) {\n          var match,\n              substring = result;\n\n          if (!separator.global) {\n            separator = RegExp(separator.source, toString(reFlags.exec(separator)) + 'g');\n          }\n          separator.lastIndex = 0;\n          while ((match = separator.exec(substring))) {\n            var newEnd = match.index;\n          }\n          result = result.slice(0, newEnd === undefined ? end : newEnd);\n        }\n      } else if (string.indexOf(baseToString(separator), end) != end) {\n        var index = result.lastIndexOf(separator);\n        if (index > -1) {\n          result = result.slice(0, index);\n        }\n      }\n      return result + omission;\n    }\n\n    /**\n     * The inverse of `_.escape`; this method converts the HTML entities\n     * `&amp;`, `&lt;`, `&gt;`, `&quot;`, and `&#39;` in `string` to\n     * their corresponding characters.\n     *\n     * **Note:** No other HTML entities are unescaped. To unescape additional\n     * HTML entities use a third-party library like [_he_](https://mths.be/he).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.6.0\n     * @category String\n     * @param {string} [string=''] The string to unescape.\n     * @returns {string} Returns the unescaped string.\n     * @example\n     *\n     * _.unescape('fred, barney, &amp; pebbles');\n     * // => 'fred, barney, & pebbles'\n     */\n    function unescape(string) {\n      string = toString(string);\n      return (string && reHasEscapedHtml.test(string))\n        ? string.replace(reEscapedHtml, unescapeHtmlChar)\n        : string;\n    }\n\n    /**\n     * Converts `string`, as space separated words, to upper case.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the upper cased string.\n     * @example\n     *\n     * _.upperCase('--foo-bar');\n     * // => 'FOO BAR'\n     *\n     * _.upperCase('fooBar');\n     * // => 'FOO BAR'\n     *\n     * _.upperCase('__foo_bar__');\n     * // => 'FOO BAR'\n     */\n    var upperCase = createCompounder(function(result, word, index) {\n      return result + (index ? ' ' : '') + word.toUpperCase();\n    });\n\n    /**\n     * Converts the first character of `string` to upper case.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the converted string.\n     * @example\n     *\n     * _.upperFirst('fred');\n     * // => 'Fred'\n     *\n     * _.upperFirst('FRED');\n     * // => 'FRED'\n     */\n    var upperFirst = createCaseFirst('toUpperCase');\n\n    /**\n     * Splits `string` into an array of its words.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to inspect.\n     * @param {RegExp|string} [pattern] The pattern to match words.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Array} Returns the words of `string`.\n     * @example\n     *\n     * _.words('fred, barney, & pebbles');\n     * // => ['fred', 'barney', 'pebbles']\n     *\n     * _.words('fred, barney, & pebbles', /[^, ]+/g);\n     * // => ['fred', 'barney', '&', 'pebbles']\n     */\n    function words(string, pattern, guard) {\n      string = toString(string);\n      pattern = guard ? undefined : pattern;\n\n      if (pattern === undefined) {\n        return hasUnicodeWord(string) ? unicodeWords(string) : asciiWords(string);\n      }\n      return string.match(pattern) || [];\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Attempts to invoke `func`, returning either the result or the caught error\n     * object. Any additional arguments are provided to `func` when it's invoked.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Util\n     * @param {Function} func The function to attempt.\n     * @param {...*} [args] The arguments to invoke `func` with.\n     * @returns {*} Returns the `func` result or error object.\n     * @example\n     *\n     * // Avoid throwing errors for invalid selectors.\n     * var elements = _.attempt(function(selector) {\n     *   return document.querySelectorAll(selector);\n     * }, '>_>');\n     *\n     * if (_.isError(elements)) {\n     *   elements = [];\n     * }\n     */\n    var attempt = baseRest(function(func, args) {\n      try {\n        return apply(func, undefined, args);\n      } catch (e) {\n        return isError(e) ? e : new Error(e);\n      }\n    });\n\n    /**\n     * Binds methods of an object to the object itself, overwriting the existing\n     * method.\n     *\n     * **Note:** This method doesn't set the \"length\" property of bound functions.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Util\n     * @param {Object} object The object to bind and assign the bound methods to.\n     * @param {...(string|string[])} methodNames The object method names to bind.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * var view = {\n     *   'label': 'docs',\n     *   'click': function() {\n     *     console.log('clicked ' + this.label);\n     *   }\n     * };\n     *\n     * _.bindAll(view, ['click']);\n     * jQuery(element).on('click', view.click);\n     * // => Logs 'clicked docs' when clicked.\n     */\n    var bindAll = flatRest(function(object, methodNames) {\n      arrayEach(methodNames, function(key) {\n        key = toKey(key);\n        baseAssignValue(object, key, bind(object[key], object));\n      });\n      return object;\n    });\n\n    /**\n     * Creates a function that iterates over `pairs` and invokes the corresponding\n     * function of the first predicate to return truthy. The predicate-function\n     * pairs are invoked with the `this` binding and arguments of the created\n     * function.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {Array} pairs The predicate-function pairs.\n     * @returns {Function} Returns the new composite function.\n     * @example\n     *\n     * var func = _.cond([\n     *   [_.matches({ 'a': 1 }),           _.constant('matches A')],\n     *   [_.conforms({ 'b': _.isNumber }), _.constant('matches B')],\n     *   [_.stubTrue,                      _.constant('no match')]\n     * ]);\n     *\n     * func({ 'a': 1, 'b': 2 });\n     * // => 'matches A'\n     *\n     * func({ 'a': 0, 'b': 1 });\n     * // => 'matches B'\n     *\n     * func({ 'a': '1', 'b': '2' });\n     * // => 'no match'\n     */\n    function cond(pairs) {\n      var length = pairs == null ? 0 : pairs.length,\n          toIteratee = getIteratee();\n\n      pairs = !length ? [] : arrayMap(pairs, function(pair) {\n        if (typeof pair[1] != 'function') {\n          throw new TypeError(FUNC_ERROR_TEXT);\n        }\n        return [toIteratee(pair[0]), pair[1]];\n      });\n\n      return baseRest(function(args) {\n        var index = -1;\n        while (++index < length) {\n          var pair = pairs[index];\n          if (apply(pair[0], this, args)) {\n            return apply(pair[1], this, args);\n          }\n        }\n      });\n    }\n\n    /**\n     * Creates a function that invokes the predicate properties of `source` with\n     * the corresponding property values of a given object, returning `true` if\n     * all predicates return truthy, else `false`.\n     *\n     * **Note:** The created function is equivalent to `_.conformsTo` with\n     * `source` partially applied.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {Object} source The object of property predicates to conform to.\n     * @returns {Function} Returns the new spec function.\n     * @example\n     *\n     * var objects = [\n     *   { 'a': 2, 'b': 1 },\n     *   { 'a': 1, 'b': 2 }\n     * ];\n     *\n     * _.filter(objects, _.conforms({ 'b': function(n) { return n > 1; } }));\n     * // => [{ 'a': 1, 'b': 2 }]\n     */\n    function conforms(source) {\n      return baseConforms(baseClone(source, CLONE_DEEP_FLAG));\n    }\n\n    /**\n     * Creates a function that returns `value`.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.4.0\n     * @category Util\n     * @param {*} value The value to return from the new function.\n     * @returns {Function} Returns the new constant function.\n     * @example\n     *\n     * var objects = _.times(2, _.constant({ 'a': 1 }));\n     *\n     * console.log(objects);\n     * // => [{ 'a': 1 }, { 'a': 1 }]\n     *\n     * console.log(objects[0] === objects[1]);\n     * // => true\n     */\n    function constant(value) {\n      return function() {\n        return value;\n      };\n    }\n\n    /**\n     * Checks `value` to determine whether a default value should be returned in\n     * its place. The `defaultValue` is returned if `value` is `NaN`, `null`,\n     * or `undefined`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.14.0\n     * @category Util\n     * @param {*} value The value to check.\n     * @param {*} defaultValue The default value.\n     * @returns {*} Returns the resolved value.\n     * @example\n     *\n     * _.defaultTo(1, 10);\n     * // => 1\n     *\n     * _.defaultTo(undefined, 10);\n     * // => 10\n     */\n    function defaultTo(value, defaultValue) {\n      return (value == null || value !== value) ? defaultValue : value;\n    }\n\n    /**\n     * Creates a function that returns the result of invoking the given functions\n     * with the `this` binding of the created function, where each successive\n     * invocation is supplied the return value of the previous.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Util\n     * @param {...(Function|Function[])} [funcs] The functions to invoke.\n     * @returns {Function} Returns the new composite function.\n     * @see _.flowRight\n     * @example\n     *\n     * function square(n) {\n     *   return n * n;\n     * }\n     *\n     * var addSquare = _.flow([_.add, square]);\n     * addSquare(1, 2);\n     * // => 9\n     */\n    var flow = createFlow();\n\n    /**\n     * This method is like `_.flow` except that it creates a function that\n     * invokes the given functions from right to left.\n     *\n     * @static\n     * @since 3.0.0\n     * @memberOf _\n     * @category Util\n     * @param {...(Function|Function[])} [funcs] The functions to invoke.\n     * @returns {Function} Returns the new composite function.\n     * @see _.flow\n     * @example\n     *\n     * function square(n) {\n     *   return n * n;\n     * }\n     *\n     * var addSquare = _.flowRight([square, _.add]);\n     * addSquare(1, 2);\n     * // => 9\n     */\n    var flowRight = createFlow(true);\n\n    /**\n     * This method returns the first argument it receives.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Util\n     * @param {*} value Any value.\n     * @returns {*} Returns `value`.\n     * @example\n     *\n     * var object = { 'a': 1 };\n     *\n     * console.log(_.identity(object) === object);\n     * // => true\n     */\n    function identity(value) {\n      return value;\n    }\n\n    /**\n     * Creates a function that invokes `func` with the arguments of the created\n     * function. If `func` is a property name, the created function returns the\n     * property value for a given element. If `func` is an array or object, the\n     * created function returns `true` for elements that contain the equivalent\n     * source properties, otherwise it returns `false`.\n     *\n     * @static\n     * @since 4.0.0\n     * @memberOf _\n     * @category Util\n     * @param {*} [func=_.identity] The value to convert to a callback.\n     * @returns {Function} Returns the callback.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney', 'age': 36, 'active': true },\n     *   { 'user': 'fred',   'age': 40, 'active': false }\n     * ];\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.filter(users, _.iteratee({ 'user': 'barney', 'active': true }));\n     * // => [{ 'user': 'barney', 'age': 36, 'active': true }]\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.filter(users, _.iteratee(['user', 'fred']));\n     * // => [{ 'user': 'fred', 'age': 40 }]\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.map(users, _.iteratee('user'));\n     * // => ['barney', 'fred']\n     *\n     * // Create custom iteratee shorthands.\n     * _.iteratee = _.wrap(_.iteratee, function(iteratee, func) {\n     *   return !_.isRegExp(func) ? iteratee(func) : function(string) {\n     *     return func.test(string);\n     *   };\n     * });\n     *\n     * _.filter(['abc', 'def'], /ef/);\n     * // => ['def']\n     */\n    function iteratee(func) {\n      return baseIteratee(typeof func == 'function' ? func : baseClone(func, CLONE_DEEP_FLAG));\n    }\n\n    /**\n     * Creates a function that performs a partial deep comparison between a given\n     * object and `source`, returning `true` if the given object has equivalent\n     * property values, else `false`.\n     *\n     * **Note:** The created function is equivalent to `_.isMatch` with `source`\n     * partially applied.\n     *\n     * Partial comparisons will match empty array and empty object `source`\n     * values against any array or object value, respectively. See `_.isEqual`\n     * for a list of supported value comparisons.\n     *\n     * **Note:** Multiple values can be checked by combining several matchers\n     * using `_.overSome`\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Util\n     * @param {Object} source The object of property values to match.\n     * @returns {Function} Returns the new spec function.\n     * @example\n     *\n     * var objects = [\n     *   { 'a': 1, 'b': 2, 'c': 3 },\n     *   { 'a': 4, 'b': 5, 'c': 6 }\n     * ];\n     *\n     * _.filter(objects, _.matches({ 'a': 4, 'c': 6 }));\n     * // => [{ 'a': 4, 'b': 5, 'c': 6 }]\n     *\n     * // Checking for several possible values\n     * _.filter(objects, _.overSome([_.matches({ 'a': 1 }), _.matches({ 'a': 4 })]));\n     * // => [{ 'a': 1, 'b': 2, 'c': 3 }, { 'a': 4, 'b': 5, 'c': 6 }]\n     */\n    function matches(source) {\n      return baseMatches(baseClone(source, CLONE_DEEP_FLAG));\n    }\n\n    /**\n     * Creates a function that performs a partial deep comparison between the\n     * value at `path` of a given object to `srcValue`, returning `true` if the\n     * object value is equivalent, else `false`.\n     *\n     * **Note:** Partial comparisons will match empty array and empty object\n     * `srcValue` values against any array or object value, respectively. See\n     * `_.isEqual` for a list of supported value comparisons.\n     *\n     * **Note:** Multiple values can be checked by combining several matchers\n     * using `_.overSome`\n     *\n     * @static\n     * @memberOf _\n     * @since 3.2.0\n     * @category Util\n     * @param {Array|string} path The path of the property to get.\n     * @param {*} srcValue The value to match.\n     * @returns {Function} Returns the new spec function.\n     * @example\n     *\n     * var objects = [\n     *   { 'a': 1, 'b': 2, 'c': 3 },\n     *   { 'a': 4, 'b': 5, 'c': 6 }\n     * ];\n     *\n     * _.find(objects, _.matchesProperty('a', 4));\n     * // => { 'a': 4, 'b': 5, 'c': 6 }\n     *\n     * // Checking for several possible values\n     * _.filter(objects, _.overSome([_.matchesProperty('a', 1), _.matchesProperty('a', 4)]));\n     * // => [{ 'a': 1, 'b': 2, 'c': 3 }, { 'a': 4, 'b': 5, 'c': 6 }]\n     */\n    function matchesProperty(path, srcValue) {\n      return baseMatchesProperty(path, baseClone(srcValue, CLONE_DEEP_FLAG));\n    }\n\n    /**\n     * Creates a function that invokes the method at `path` of a given object.\n     * Any additional arguments are provided to the invoked method.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.7.0\n     * @category Util\n     * @param {Array|string} path The path of the method to invoke.\n     * @param {...*} [args] The arguments to invoke the method with.\n     * @returns {Function} Returns the new invoker function.\n     * @example\n     *\n     * var objects = [\n     *   { 'a': { 'b': _.constant(2) } },\n     *   { 'a': { 'b': _.constant(1) } }\n     * ];\n     *\n     * _.map(objects, _.method('a.b'));\n     * // => [2, 1]\n     *\n     * _.map(objects, _.method(['a', 'b']));\n     * // => [2, 1]\n     */\n    var method = baseRest(function(path, args) {\n      return function(object) {\n        return baseInvoke(object, path, args);\n      };\n    });\n\n    /**\n     * The opposite of `_.method`; this method creates a function that invokes\n     * the method at a given path of `object`. Any additional arguments are\n     * provided to the invoked method.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.7.0\n     * @category Util\n     * @param {Object} object The object to query.\n     * @param {...*} [args] The arguments to invoke the method with.\n     * @returns {Function} Returns the new invoker function.\n     * @example\n     *\n     * var array = _.times(3, _.constant),\n     *     object = { 'a': array, 'b': array, 'c': array };\n     *\n     * _.map(['a[2]', 'c[0]'], _.methodOf(object));\n     * // => [2, 0]\n     *\n     * _.map([['a', '2'], ['c', '0']], _.methodOf(object));\n     * // => [2, 0]\n     */\n    var methodOf = baseRest(function(object, args) {\n      return function(path) {\n        return baseInvoke(object, path, args);\n      };\n    });\n\n    /**\n     * Adds all own enumerable string keyed function properties of a source\n     * object to the destination object. If `object` is a function, then methods\n     * are added to its prototype as well.\n     *\n     * **Note:** Use `_.runInContext` to create a pristine `lodash` function to\n     * avoid conflicts caused by modifying the original.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Util\n     * @param {Function|Object} [object=lodash] The destination object.\n     * @param {Object} source The object of functions to add.\n     * @param {Object} [options={}] The options object.\n     * @param {boolean} [options.chain=true] Specify whether mixins are chainable.\n     * @returns {Function|Object} Returns `object`.\n     * @example\n     *\n     * function vowels(string) {\n     *   return _.filter(string, function(v) {\n     *     return /[aeiou]/i.test(v);\n     *   });\n     * }\n     *\n     * _.mixin({ 'vowels': vowels });\n     * _.vowels('fred');\n     * // => ['e']\n     *\n     * _('fred').vowels().value();\n     * // => ['e']\n     *\n     * _.mixin({ 'vowels': vowels }, { 'chain': false });\n     * _('fred').vowels();\n     * // => ['e']\n     */\n    function mixin(object, source, options) {\n      var props = keys(source),\n          methodNames = baseFunctions(source, props);\n\n      if (options == null &&\n          !(isObject(source) && (methodNames.length || !props.length))) {\n        options = source;\n        source = object;\n        object = this;\n        methodNames = baseFunctions(source, keys(source));\n      }\n      var chain = !(isObject(options) && 'chain' in options) || !!options.chain,\n          isFunc = isFunction(object);\n\n      arrayEach(methodNames, function(methodName) {\n        var func = source[methodName];\n        object[methodName] = func;\n        if (isFunc) {\n          object.prototype[methodName] = function() {\n            var chainAll = this.__chain__;\n            if (chain || chainAll) {\n              var result = object(this.__wrapped__),\n                  actions = result.__actions__ = copyArray(this.__actions__);\n\n              actions.push({ 'func': func, 'args': arguments, 'thisArg': object });\n              result.__chain__ = chainAll;\n              return result;\n            }\n            return func.apply(object, arrayPush([this.value()], arguments));\n          };\n        }\n      });\n\n      return object;\n    }\n\n    /**\n     * Reverts the `_` variable to its previous value and returns a reference to\n     * the `lodash` function.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Util\n     * @returns {Function} Returns the `lodash` function.\n     * @example\n     *\n     * var lodash = _.noConflict();\n     */\n    function noConflict() {\n      if (root._ === this) {\n        root._ = oldDash;\n      }\n      return this;\n    }\n\n    /**\n     * This method returns `undefined`.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.3.0\n     * @category Util\n     * @example\n     *\n     * _.times(2, _.noop);\n     * // => [undefined, undefined]\n     */\n    function noop() {\n      // No operation performed.\n    }\n\n    /**\n     * Creates a function that gets the argument at index `n`. If `n` is negative,\n     * the nth argument from the end is returned.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {number} [n=0] The index of the argument to return.\n     * @returns {Function} Returns the new pass-thru function.\n     * @example\n     *\n     * var func = _.nthArg(1);\n     * func('a', 'b', 'c', 'd');\n     * // => 'b'\n     *\n     * var func = _.nthArg(-2);\n     * func('a', 'b', 'c', 'd');\n     * // => 'c'\n     */\n    function nthArg(n) {\n      n = toInteger(n);\n      return baseRest(function(args) {\n        return baseNth(args, n);\n      });\n    }\n\n    /**\n     * Creates a function that invokes `iteratees` with the arguments it receives\n     * and returns their results.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {...(Function|Function[])} [iteratees=[_.identity]]\n     *  The iteratees to invoke.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var func = _.over([Math.max, Math.min]);\n     *\n     * func(1, 2, 3, 4);\n     * // => [4, 1]\n     */\n    var over = createOver(arrayMap);\n\n    /**\n     * Creates a function that checks if **all** of the `predicates` return\n     * truthy when invoked with the arguments it receives.\n     *\n     * Following shorthands are possible for providing predicates.\n     * Pass an `Object` and it will be used as an parameter for `_.matches` to create the predicate.\n     * Pass an `Array` of parameters for `_.matchesProperty` and the predicate will be created using them.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {...(Function|Function[])} [predicates=[_.identity]]\n     *  The predicates to check.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var func = _.overEvery([Boolean, isFinite]);\n     *\n     * func('1');\n     * // => true\n     *\n     * func(null);\n     * // => false\n     *\n     * func(NaN);\n     * // => false\n     */\n    var overEvery = createOver(arrayEvery);\n\n    /**\n     * Creates a function that checks if **any** of the `predicates` return\n     * truthy when invoked with the arguments it receives.\n     *\n     * Following shorthands are possible for providing predicates.\n     * Pass an `Object` and it will be used as an parameter for `_.matches` to create the predicate.\n     * Pass an `Array` of parameters for `_.matchesProperty` and the predicate will be created using them.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {...(Function|Function[])} [predicates=[_.identity]]\n     *  The predicates to check.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var func = _.overSome([Boolean, isFinite]);\n     *\n     * func('1');\n     * // => true\n     *\n     * func(null);\n     * // => true\n     *\n     * func(NaN);\n     * // => false\n     *\n     * var matchesFunc = _.overSome([{ 'a': 1 }, { 'a': 2 }])\n     * var matchesPropertyFunc = _.overSome([['a', 1], ['a', 2]])\n     */\n    var overSome = createOver(arraySome);\n\n    /**\n     * Creates a function that returns the value at `path` of a given object.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.4.0\n     * @category Util\n     * @param {Array|string} path The path of the property to get.\n     * @returns {Function} Returns the new accessor function.\n     * @example\n     *\n     * var objects = [\n     *   { 'a': { 'b': 2 } },\n     *   { 'a': { 'b': 1 } }\n     * ];\n     *\n     * _.map(objects, _.property('a.b'));\n     * // => [2, 1]\n     *\n     * _.map(_.sortBy(objects, _.property(['a', 'b'])), 'a.b');\n     * // => [1, 2]\n     */\n    function property(path) {\n      return isKey(path) ? baseProperty(toKey(path)) : basePropertyDeep(path);\n    }\n\n    /**\n     * The opposite of `_.property`; this method creates a function that returns\n     * the value at a given path of `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Util\n     * @param {Object} object The object to query.\n     * @returns {Function} Returns the new accessor function.\n     * @example\n     *\n     * var array = [0, 1, 2],\n     *     object = { 'a': array, 'b': array, 'c': array };\n     *\n     * _.map(['a[2]', 'c[0]'], _.propertyOf(object));\n     * // => [2, 0]\n     *\n     * _.map([['a', '2'], ['c', '0']], _.propertyOf(object));\n     * // => [2, 0]\n     */\n    function propertyOf(object) {\n      return function(path) {\n        return object == null ? undefined : baseGet(object, path);\n      };\n    }\n\n    /**\n     * Creates an array of numbers (positive and/or negative) progressing from\n     * `start` up to, but not including, `end`. A step of `-1` is used if a negative\n     * `start` is specified without an `end` or `step`. If `end` is not specified,\n     * it's set to `start` with `start` then set to `0`.\n     *\n     * **Note:** JavaScript follows the IEEE-754 standard for resolving\n     * floating-point values which can produce unexpected results.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Util\n     * @param {number} [start=0] The start of the range.\n     * @param {number} end The end of the range.\n     * @param {number} [step=1] The value to increment or decrement by.\n     * @returns {Array} Returns the range of numbers.\n     * @see _.inRange, _.rangeRight\n     * @example\n     *\n     * _.range(4);\n     * // => [0, 1, 2, 3]\n     *\n     * _.range(-4);\n     * // => [0, -1, -2, -3]\n     *\n     * _.range(1, 5);\n     * // => [1, 2, 3, 4]\n     *\n     * _.range(0, 20, 5);\n     * // => [0, 5, 10, 15]\n     *\n     * _.range(0, -4, -1);\n     * // => [0, -1, -2, -3]\n     *\n     * _.range(1, 4, 0);\n     * // => [1, 1, 1]\n     *\n     * _.range(0);\n     * // => []\n     */\n    var range = createRange();\n\n    /**\n     * This method is like `_.range` except that it populates values in\n     * descending order.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {number} [start=0] The start of the range.\n     * @param {number} end The end of the range.\n     * @param {number} [step=1] The value to increment or decrement by.\n     * @returns {Array} Returns the range of numbers.\n     * @see _.inRange, _.range\n     * @example\n     *\n     * _.rangeRight(4);\n     * // => [3, 2, 1, 0]\n     *\n     * _.rangeRight(-4);\n     * // => [-3, -2, -1, 0]\n     *\n     * _.rangeRight(1, 5);\n     * // => [4, 3, 2, 1]\n     *\n     * _.rangeRight(0, 20, 5);\n     * // => [15, 10, 5, 0]\n     *\n     * _.rangeRight(0, -4, -1);\n     * // => [-3, -2, -1, 0]\n     *\n     * _.rangeRight(1, 4, 0);\n     * // => [1, 1, 1]\n     *\n     * _.rangeRight(0);\n     * // => []\n     */\n    var rangeRight = createRange(true);\n\n    /**\n     * This method returns a new empty array.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.13.0\n     * @category Util\n     * @returns {Array} Returns the new empty array.\n     * @example\n     *\n     * var arrays = _.times(2, _.stubArray);\n     *\n     * console.log(arrays);\n     * // => [[], []]\n     *\n     * console.log(arrays[0] === arrays[1]);\n     * // => false\n     */\n    function stubArray() {\n      return [];\n    }\n\n    /**\n     * This method returns `false`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.13.0\n     * @category Util\n     * @returns {boolean} Returns `false`.\n     * @example\n     *\n     * _.times(2, _.stubFalse);\n     * // => [false, false]\n     */\n    function stubFalse() {\n      return false;\n    }\n\n    /**\n     * This method returns a new empty object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.13.0\n     * @category Util\n     * @returns {Object} Returns the new empty object.\n     * @example\n     *\n     * var objects = _.times(2, _.stubObject);\n     *\n     * console.log(objects);\n     * // => [{}, {}]\n     *\n     * console.log(objects[0] === objects[1]);\n     * // => false\n     */\n    function stubObject() {\n      return {};\n    }\n\n    /**\n     * This method returns an empty string.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.13.0\n     * @category Util\n     * @returns {string} Returns the empty string.\n     * @example\n     *\n     * _.times(2, _.stubString);\n     * // => ['', '']\n     */\n    function stubString() {\n      return '';\n    }\n\n    /**\n     * This method returns `true`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.13.0\n     * @category Util\n     * @returns {boolean} Returns `true`.\n     * @example\n     *\n     * _.times(2, _.stubTrue);\n     * // => [true, true]\n     */\n    function stubTrue() {\n      return true;\n    }\n\n    /**\n     * Invokes the iteratee `n` times, returning an array of the results of\n     * each invocation. The iteratee is invoked with one argument; (index).\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Util\n     * @param {number} n The number of times to invoke `iteratee`.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the array of results.\n     * @example\n     *\n     * _.times(3, String);\n     * // => ['0', '1', '2']\n     *\n     *  _.times(4, _.constant(0));\n     * // => [0, 0, 0, 0]\n     */\n    function times(n, iteratee) {\n      n = toInteger(n);\n      if (n < 1 || n > MAX_SAFE_INTEGER) {\n        return [];\n      }\n      var index = MAX_ARRAY_LENGTH,\n          length = nativeMin(n, MAX_ARRAY_LENGTH);\n\n      iteratee = getIteratee(iteratee);\n      n -= MAX_ARRAY_LENGTH;\n\n      var result = baseTimes(length, iteratee);\n      while (++index < n) {\n        iteratee(index);\n      }\n      return result;\n    }\n\n    /**\n     * Converts `value` to a property path array.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {*} value The value to convert.\n     * @returns {Array} Returns the new property path array.\n     * @example\n     *\n     * _.toPath('a.b.c');\n     * // => ['a', 'b', 'c']\n     *\n     * _.toPath('a[0].b.c');\n     * // => ['a', '0', 'b', 'c']\n     */\n    function toPath(value) {\n      if (isArray(value)) {\n        return arrayMap(value, toKey);\n      }\n      return isSymbol(value) ? [value] : copyArray(stringToPath(toString(value)));\n    }\n\n    /**\n     * Generates a unique ID. If `prefix` is given, the ID is appended to it.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Util\n     * @param {string} [prefix=''] The value to prefix the ID with.\n     * @returns {string} Returns the unique ID.\n     * @example\n     *\n     * _.uniqueId('contact_');\n     * // => 'contact_104'\n     *\n     * _.uniqueId();\n     * // => '105'\n     */\n    function uniqueId(prefix) {\n      var id = ++idCounter;\n      return toString(prefix) + id;\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Adds two numbers.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.4.0\n     * @category Math\n     * @param {number} augend The first number in an addition.\n     * @param {number} addend The second number in an addition.\n     * @returns {number} Returns the total.\n     * @example\n     *\n     * _.add(6, 4);\n     * // => 10\n     */\n    var add = createMathOperation(function(augend, addend) {\n      return augend + addend;\n    }, 0);\n\n    /**\n     * Computes `number` rounded up to `precision`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.10.0\n     * @category Math\n     * @param {number} number The number to round up.\n     * @param {number} [precision=0] The precision to round up to.\n     * @returns {number} Returns the rounded up number.\n     * @example\n     *\n     * _.ceil(4.006);\n     * // => 5\n     *\n     * _.ceil(6.004, 2);\n     * // => 6.01\n     *\n     * _.ceil(6040, -2);\n     * // => 6100\n     */\n    var ceil = createRound('ceil');\n\n    /**\n     * Divide two numbers.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.7.0\n     * @category Math\n     * @param {number} dividend The first number in a division.\n     * @param {number} divisor The second number in a division.\n     * @returns {number} Returns the quotient.\n     * @example\n     *\n     * _.divide(6, 4);\n     * // => 1.5\n     */\n    var divide = createMathOperation(function(dividend, divisor) {\n      return dividend / divisor;\n    }, 1);\n\n    /**\n     * Computes `number` rounded down to `precision`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.10.0\n     * @category Math\n     * @param {number} number The number to round down.\n     * @param {number} [precision=0] The precision to round down to.\n     * @returns {number} Returns the rounded down number.\n     * @example\n     *\n     * _.floor(4.006);\n     * // => 4\n     *\n     * _.floor(0.046, 2);\n     * // => 0.04\n     *\n     * _.floor(4060, -2);\n     * // => 4000\n     */\n    var floor = createRound('floor');\n\n    /**\n     * Computes the maximum value of `array`. If `array` is empty or falsey,\n     * `undefined` is returned.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @returns {*} Returns the maximum value.\n     * @example\n     *\n     * _.max([4, 2, 8, 6]);\n     * // => 8\n     *\n     * _.max([]);\n     * // => undefined\n     */\n    function max(array) {\n      return (array && array.length)\n        ? baseExtremum(array, identity, baseGt)\n        : undefined;\n    }\n\n    /**\n     * This method is like `_.max` except that it accepts `iteratee` which is\n     * invoked for each element in `array` to generate the criterion by which\n     * the value is ranked. The iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {*} Returns the maximum value.\n     * @example\n     *\n     * var objects = [{ 'n': 1 }, { 'n': 2 }];\n     *\n     * _.maxBy(objects, function(o) { return o.n; });\n     * // => { 'n': 2 }\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.maxBy(objects, 'n');\n     * // => { 'n': 2 }\n     */\n    function maxBy(array, iteratee) {\n      return (array && array.length)\n        ? baseExtremum(array, getIteratee(iteratee, 2), baseGt)\n        : undefined;\n    }\n\n    /**\n     * Computes the mean of the values in `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @returns {number} Returns the mean.\n     * @example\n     *\n     * _.mean([4, 2, 8, 6]);\n     * // => 5\n     */\n    function mean(array) {\n      return baseMean(array, identity);\n    }\n\n    /**\n     * This method is like `_.mean` except that it accepts `iteratee` which is\n     * invoked for each element in `array` to generate the value to be averaged.\n     * The iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.7.0\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {number} Returns the mean.\n     * @example\n     *\n     * var objects = [{ 'n': 4 }, { 'n': 2 }, { 'n': 8 }, { 'n': 6 }];\n     *\n     * _.meanBy(objects, function(o) { return o.n; });\n     * // => 5\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.meanBy(objects, 'n');\n     * // => 5\n     */\n    function meanBy(array, iteratee) {\n      return baseMean(array, getIteratee(iteratee, 2));\n    }\n\n    /**\n     * Computes the minimum value of `array`. If `array` is empty or falsey,\n     * `undefined` is returned.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @returns {*} Returns the minimum value.\n     * @example\n     *\n     * _.min([4, 2, 8, 6]);\n     * // => 2\n     *\n     * _.min([]);\n     * // => undefined\n     */\n    function min(array) {\n      return (array && array.length)\n        ? baseExtremum(array, identity, baseLt)\n        : undefined;\n    }\n\n    /**\n     * This method is like `_.min` except that it accepts `iteratee` which is\n     * invoked for each element in `array` to generate the criterion by which\n     * the value is ranked. The iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {*} Returns the minimum value.\n     * @example\n     *\n     * var objects = [{ 'n': 1 }, { 'n': 2 }];\n     *\n     * _.minBy(objects, function(o) { return o.n; });\n     * // => { 'n': 1 }\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.minBy(objects, 'n');\n     * // => { 'n': 1 }\n     */\n    function minBy(array, iteratee) {\n      return (array && array.length)\n        ? baseExtremum(array, getIteratee(iteratee, 2), baseLt)\n        : undefined;\n    }\n\n    /**\n     * Multiply two numbers.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.7.0\n     * @category Math\n     * @param {number} multiplier The first number in a multiplication.\n     * @param {number} multiplicand The second number in a multiplication.\n     * @returns {number} Returns the product.\n     * @example\n     *\n     * _.multiply(6, 4);\n     * // => 24\n     */\n    var multiply = createMathOperation(function(multiplier, multiplicand) {\n      return multiplier * multiplicand;\n    }, 1);\n\n    /**\n     * Computes `number` rounded to `precision`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.10.0\n     * @category Math\n     * @param {number} number The number to round.\n     * @param {number} [precision=0] The precision to round to.\n     * @returns {number} Returns the rounded number.\n     * @example\n     *\n     * _.round(4.006);\n     * // => 4\n     *\n     * _.round(4.006, 2);\n     * // => 4.01\n     *\n     * _.round(4060, -2);\n     * // => 4100\n     */\n    var round = createRound('round');\n\n    /**\n     * Subtract two numbers.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Math\n     * @param {number} minuend The first number in a subtraction.\n     * @param {number} subtrahend The second number in a subtraction.\n     * @returns {number} Returns the difference.\n     * @example\n     *\n     * _.subtract(6, 4);\n     * // => 2\n     */\n    var subtract = createMathOperation(function(minuend, subtrahend) {\n      return minuend - subtrahend;\n    }, 0);\n\n    /**\n     * Computes the sum of the values in `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.4.0\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @returns {number} Returns the sum.\n     * @example\n     *\n     * _.sum([4, 2, 8, 6]);\n     * // => 20\n     */\n    function sum(array) {\n      return (array && array.length)\n        ? baseSum(array, identity)\n        : 0;\n    }\n\n    /**\n     * This method is like `_.sum` except that it accepts `iteratee` which is\n     * invoked for each element in `array` to generate the value to be summed.\n     * The iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {number} Returns the sum.\n     * @example\n     *\n     * var objects = [{ 'n': 4 }, { 'n': 2 }, { 'n': 8 }, { 'n': 6 }];\n     *\n     * _.sumBy(objects, function(o) { return o.n; });\n     * // => 20\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.sumBy(objects, 'n');\n     * // => 20\n     */\n    function sumBy(array, iteratee) {\n      return (array && array.length)\n        ? baseSum(array, getIteratee(iteratee, 2))\n        : 0;\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    // Add methods that return wrapped values in chain sequences.\n    lodash.after = after;\n    lodash.ary = ary;\n    lodash.assign = assign;\n    lodash.assignIn = assignIn;\n    lodash.assignInWith = assignInWith;\n    lodash.assignWith = assignWith;\n    lodash.at = at;\n    lodash.before = before;\n    lodash.bind = bind;\n    lodash.bindAll = bindAll;\n    lodash.bindKey = bindKey;\n    lodash.castArray = castArray;\n    lodash.chain = chain;\n    lodash.chunk = chunk;\n    lodash.compact = compact;\n    lodash.concat = concat;\n    lodash.cond = cond;\n    lodash.conforms = conforms;\n    lodash.constant = constant;\n    lodash.countBy = countBy;\n    lodash.create = create;\n    lodash.curry = curry;\n    lodash.curryRight = curryRight;\n    lodash.debounce = debounce;\n    lodash.defaults = defaults;\n    lodash.defaultsDeep = defaultsDeep;\n    lodash.defer = defer;\n    lodash.delay = delay;\n    lodash.difference = difference;\n    lodash.differenceBy = differenceBy;\n    lodash.differenceWith = differenceWith;\n    lodash.drop = drop;\n    lodash.dropRight = dropRight;\n    lodash.dropRightWhile = dropRightWhile;\n    lodash.dropWhile = dropWhile;\n    lodash.fill = fill;\n    lodash.filter = filter;\n    lodash.flatMap = flatMap;\n    lodash.flatMapDeep = flatMapDeep;\n    lodash.flatMapDepth = flatMapDepth;\n    lodash.flatten = flatten;\n    lodash.flattenDeep = flattenDeep;\n    lodash.flattenDepth = flattenDepth;\n    lodash.flip = flip;\n    lodash.flow = flow;\n    lodash.flowRight = flowRight;\n    lodash.fromPairs = fromPairs;\n    lodash.functions = functions;\n    lodash.functionsIn = functionsIn;\n    lodash.groupBy = groupBy;\n    lodash.initial = initial;\n    lodash.intersection = intersection;\n    lodash.intersectionBy = intersectionBy;\n    lodash.intersectionWith = intersectionWith;\n    lodash.invert = invert;\n    lodash.invertBy = invertBy;\n    lodash.invokeMap = invokeMap;\n    lodash.iteratee = iteratee;\n    lodash.keyBy = keyBy;\n    lodash.keys = keys;\n    lodash.keysIn = keysIn;\n    lodash.map = map;\n    lodash.mapKeys = mapKeys;\n    lodash.mapValues = mapValues;\n    lodash.matches = matches;\n    lodash.matchesProperty = matchesProperty;\n    lodash.memoize = memoize;\n    lodash.merge = merge;\n    lodash.mergeWith = mergeWith;\n    lodash.method = method;\n    lodash.methodOf = methodOf;\n    lodash.mixin = mixin;\n    lodash.negate = negate;\n    lodash.nthArg = nthArg;\n    lodash.omit = omit;\n    lodash.omitBy = omitBy;\n    lodash.once = once;\n    lodash.orderBy = orderBy;\n    lodash.over = over;\n    lodash.overArgs = overArgs;\n    lodash.overEvery = overEvery;\n    lodash.overSome = overSome;\n    lodash.partial = partial;\n    lodash.partialRight = partialRight;\n    lodash.partition = partition;\n    lodash.pick = pick;\n    lodash.pickBy = pickBy;\n    lodash.property = property;\n    lodash.propertyOf = propertyOf;\n    lodash.pull = pull;\n    lodash.pullAll = pullAll;\n    lodash.pullAllBy = pullAllBy;\n    lodash.pullAllWith = pullAllWith;\n    lodash.pullAt = pullAt;\n    lodash.range = range;\n    lodash.rangeRight = rangeRight;\n    lodash.rearg = rearg;\n    lodash.reject = reject;\n    lodash.remove = remove;\n    lodash.rest = rest;\n    lodash.reverse = reverse;\n    lodash.sampleSize = sampleSize;\n    lodash.set = set;\n    lodash.setWith = setWith;\n    lodash.shuffle = shuffle;\n    lodash.slice = slice;\n    lodash.sortBy = sortBy;\n    lodash.sortedUniq = sortedUniq;\n    lodash.sortedUniqBy = sortedUniqBy;\n    lodash.split = split;\n    lodash.spread = spread;\n    lodash.tail = tail;\n    lodash.take = take;\n    lodash.takeRight = takeRight;\n    lodash.takeRightWhile = takeRightWhile;\n    lodash.takeWhile = takeWhile;\n    lodash.tap = tap;\n    lodash.throttle = throttle;\n    lodash.thru = thru;\n    lodash.toArray = toArray;\n    lodash.toPairs = toPairs;\n    lodash.toPairsIn = toPairsIn;\n    lodash.toPath = toPath;\n    lodash.toPlainObject = toPlainObject;\n    lodash.transform = transform;\n    lodash.unary = unary;\n    lodash.union = union;\n    lodash.unionBy = unionBy;\n    lodash.unionWith = unionWith;\n    lodash.uniq = uniq;\n    lodash.uniqBy = uniqBy;\n    lodash.uniqWith = uniqWith;\n    lodash.unset = unset;\n    lodash.unzip = unzip;\n    lodash.unzipWith = unzipWith;\n    lodash.update = update;\n    lodash.updateWith = updateWith;\n    lodash.values = values;\n    lodash.valuesIn = valuesIn;\n    lodash.without = without;\n    lodash.words = words;\n    lodash.wrap = wrap;\n    lodash.xor = xor;\n    lodash.xorBy = xorBy;\n    lodash.xorWith = xorWith;\n    lodash.zip = zip;\n    lodash.zipObject = zipObject;\n    lodash.zipObjectDeep = zipObjectDeep;\n    lodash.zipWith = zipWith;\n\n    // Add aliases.\n    lodash.entries = toPairs;\n    lodash.entriesIn = toPairsIn;\n    lodash.extend = assignIn;\n    lodash.extendWith = assignInWith;\n\n    // Add methods to `lodash.prototype`.\n    mixin(lodash, lodash);\n\n    /*------------------------------------------------------------------------*/\n\n    // Add methods that return unwrapped values in chain sequences.\n    lodash.add = add;\n    lodash.attempt = attempt;\n    lodash.camelCase = camelCase;\n    lodash.capitalize = capitalize;\n    lodash.ceil = ceil;\n    lodash.clamp = clamp;\n    lodash.clone = clone;\n    lodash.cloneDeep = cloneDeep;\n    lodash.cloneDeepWith = cloneDeepWith;\n    lodash.cloneWith = cloneWith;\n    lodash.conformsTo = conformsTo;\n    lodash.deburr = deburr;\n    lodash.defaultTo = defaultTo;\n    lodash.divide = divide;\n    lodash.endsWith = endsWith;\n    lodash.eq = eq;\n    lodash.escape = escape;\n    lodash.escapeRegExp = escapeRegExp;\n    lodash.every = every;\n    lodash.find = find;\n    lodash.findIndex = findIndex;\n    lodash.findKey = findKey;\n    lodash.findLast = findLast;\n    lodash.findLastIndex = findLastIndex;\n    lodash.findLastKey = findLastKey;\n    lodash.floor = floor;\n    lodash.forEach = forEach;\n    lodash.forEachRight = forEachRight;\n    lodash.forIn = forIn;\n    lodash.forInRight = forInRight;\n    lodash.forOwn = forOwn;\n    lodash.forOwnRight = forOwnRight;\n    lodash.get = get;\n    lodash.gt = gt;\n    lodash.gte = gte;\n    lodash.has = has;\n    lodash.hasIn = hasIn;\n    lodash.head = head;\n    lodash.identity = identity;\n    lodash.includes = includes;\n    lodash.indexOf = indexOf;\n    lodash.inRange = inRange;\n    lodash.invoke = invoke;\n    lodash.isArguments = isArguments;\n    lodash.isArray = isArray;\n    lodash.isArrayBuffer = isArrayBuffer;\n    lodash.isArrayLike = isArrayLike;\n    lodash.isArrayLikeObject = isArrayLikeObject;\n    lodash.isBoolean = isBoolean;\n    lodash.isBuffer = isBuffer;\n    lodash.isDate = isDate;\n    lodash.isElement = isElement;\n    lodash.isEmpty = isEmpty;\n    lodash.isEqual = isEqual;\n    lodash.isEqualWith = isEqualWith;\n    lodash.isError = isError;\n    lodash.isFinite = isFinite;\n    lodash.isFunction = isFunction;\n    lodash.isInteger = isInteger;\n    lodash.isLength = isLength;\n    lodash.isMap = isMap;\n    lodash.isMatch = isMatch;\n    lodash.isMatchWith = isMatchWith;\n    lodash.isNaN = isNaN;\n    lodash.isNative = isNative;\n    lodash.isNil = isNil;\n    lodash.isNull = isNull;\n    lodash.isNumber = isNumber;\n    lodash.isObject = isObject;\n    lodash.isObjectLike = isObjectLike;\n    lodash.isPlainObject = isPlainObject;\n    lodash.isRegExp = isRegExp;\n    lodash.isSafeInteger = isSafeInteger;\n    lodash.isSet = isSet;\n    lodash.isString = isString;\n    lodash.isSymbol = isSymbol;\n    lodash.isTypedArray = isTypedArray;\n    lodash.isUndefined = isUndefined;\n    lodash.isWeakMap = isWeakMap;\n    lodash.isWeakSet = isWeakSet;\n    lodash.join = join;\n    lodash.kebabCase = kebabCase;\n    lodash.last = last;\n    lodash.lastIndexOf = lastIndexOf;\n    lodash.lowerCase = lowerCase;\n    lodash.lowerFirst = lowerFirst;\n    lodash.lt = lt;\n    lodash.lte = lte;\n    lodash.max = max;\n    lodash.maxBy = maxBy;\n    lodash.mean = mean;\n    lodash.meanBy = meanBy;\n    lodash.min = min;\n    lodash.minBy = minBy;\n    lodash.stubArray = stubArray;\n    lodash.stubFalse = stubFalse;\n    lodash.stubObject = stubObject;\n    lodash.stubString = stubString;\n    lodash.stubTrue = stubTrue;\n    lodash.multiply = multiply;\n    lodash.nth = nth;\n    lodash.noConflict = noConflict;\n    lodash.noop = noop;\n    lodash.now = now;\n    lodash.pad = pad;\n    lodash.padEnd = padEnd;\n    lodash.padStart = padStart;\n    lodash.parseInt = parseInt;\n    lodash.random = random;\n    lodash.reduce = reduce;\n    lodash.reduceRight = reduceRight;\n    lodash.repeat = repeat;\n    lodash.replace = replace;\n    lodash.result = result;\n    lodash.round = round;\n    lodash.runInContext = runInContext;\n    lodash.sample = sample;\n    lodash.size = size;\n    lodash.snakeCase = snakeCase;\n    lodash.some = some;\n    lodash.sortedIndex = sortedIndex;\n    lodash.sortedIndexBy = sortedIndexBy;\n    lodash.sortedIndexOf = sortedIndexOf;\n    lodash.sortedLastIndex = sortedLastIndex;\n    lodash.sortedLastIndexBy = sortedLastIndexBy;\n    lodash.sortedLastIndexOf = sortedLastIndexOf;\n    lodash.startCase = startCase;\n    lodash.startsWith = startsWith;\n    lodash.subtract = subtract;\n    lodash.sum = sum;\n    lodash.sumBy = sumBy;\n    lodash.template = template;\n    lodash.times = times;\n    lodash.toFinite = toFinite;\n    lodash.toInteger = toInteger;\n    lodash.toLength = toLength;\n    lodash.toLower = toLower;\n    lodash.toNumber = toNumber;\n    lodash.toSafeInteger = toSafeInteger;\n    lodash.toString = toString;\n    lodash.toUpper = toUpper;\n    lodash.trim = trim;\n    lodash.trimEnd = trimEnd;\n    lodash.trimStart = trimStart;\n    lodash.truncate = truncate;\n    lodash.unescape = unescape;\n    lodash.uniqueId = uniqueId;\n    lodash.upperCase = upperCase;\n    lodash.upperFirst = upperFirst;\n\n    // Add aliases.\n    lodash.each = forEach;\n    lodash.eachRight = forEachRight;\n    lodash.first = head;\n\n    mixin(lodash, (function() {\n      var source = {};\n      baseForOwn(lodash, function(func, methodName) {\n        if (!hasOwnProperty.call(lodash.prototype, methodName)) {\n          source[methodName] = func;\n        }\n      });\n      return source;\n    }()), { 'chain': false });\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * The semantic version number.\n     *\n     * @static\n     * @memberOf _\n     * @type {string}\n     */\n    lodash.VERSION = VERSION;\n\n    // Assign default placeholders.\n    arrayEach(['bind', 'bindKey', 'curry', 'curryRight', 'partial', 'partialRight'], function(methodName) {\n      lodash[methodName].placeholder = lodash;\n    });\n\n    // Add `LazyWrapper` methods for `_.drop` and `_.take` variants.\n    arrayEach(['drop', 'take'], function(methodName, index) {\n      LazyWrapper.prototype[methodName] = function(n) {\n        n = n === undefined ? 1 : nativeMax(toInteger(n), 0);\n\n        var result = (this.__filtered__ && !index)\n          ? new LazyWrapper(this)\n          : this.clone();\n\n        if (result.__filtered__) {\n          result.__takeCount__ = nativeMin(n, result.__takeCount__);\n        } else {\n          result.__views__.push({\n            'size': nativeMin(n, MAX_ARRAY_LENGTH),\n            'type': methodName + (result.__dir__ < 0 ? 'Right' : '')\n          });\n        }\n        return result;\n      };\n\n      LazyWrapper.prototype[methodName + 'Right'] = function(n) {\n        return this.reverse()[methodName](n).reverse();\n      };\n    });\n\n    // Add `LazyWrapper` methods that accept an `iteratee` value.\n    arrayEach(['filter', 'map', 'takeWhile'], function(methodName, index) {\n      var type = index + 1,\n          isFilter = type == LAZY_FILTER_FLAG || type == LAZY_WHILE_FLAG;\n\n      LazyWrapper.prototype[methodName] = function(iteratee) {\n        var result = this.clone();\n        result.__iteratees__.push({\n          'iteratee': getIteratee(iteratee, 3),\n          'type': type\n        });\n        result.__filtered__ = result.__filtered__ || isFilter;\n        return result;\n      };\n    });\n\n    // Add `LazyWrapper` methods for `_.head` and `_.last`.\n    arrayEach(['head', 'last'], function(methodName, index) {\n      var takeName = 'take' + (index ? 'Right' : '');\n\n      LazyWrapper.prototype[methodName] = function() {\n        return this[takeName](1).value()[0];\n      };\n    });\n\n    // Add `LazyWrapper` methods for `_.initial` and `_.tail`.\n    arrayEach(['initial', 'tail'], function(methodName, index) {\n      var dropName = 'drop' + (index ? '' : 'Right');\n\n      LazyWrapper.prototype[methodName] = function() {\n        return this.__filtered__ ? new LazyWrapper(this) : this[dropName](1);\n      };\n    });\n\n    LazyWrapper.prototype.compact = function() {\n      return this.filter(identity);\n    };\n\n    LazyWrapper.prototype.find = function(predicate) {\n      return this.filter(predicate).head();\n    };\n\n    LazyWrapper.prototype.findLast = function(predicate) {\n      return this.reverse().find(predicate);\n    };\n\n    LazyWrapper.prototype.invokeMap = baseRest(function(path, args) {\n      if (typeof path == 'function') {\n        return new LazyWrapper(this);\n      }\n      return this.map(function(value) {\n        return baseInvoke(value, path, args);\n      });\n    });\n\n    LazyWrapper.prototype.reject = function(predicate) {\n      return this.filter(negate(getIteratee(predicate)));\n    };\n\n    LazyWrapper.prototype.slice = function(start, end) {\n      start = toInteger(start);\n\n      var result = this;\n      if (result.__filtered__ && (start > 0 || end < 0)) {\n        return new LazyWrapper(result);\n      }\n      if (start < 0) {\n        result = result.takeRight(-start);\n      } else if (start) {\n        result = result.drop(start);\n      }\n      if (end !== undefined) {\n        end = toInteger(end);\n        result = end < 0 ? result.dropRight(-end) : result.take(end - start);\n      }\n      return result;\n    };\n\n    LazyWrapper.prototype.takeRightWhile = function(predicate) {\n      return this.reverse().takeWhile(predicate).reverse();\n    };\n\n    LazyWrapper.prototype.toArray = function() {\n      return this.take(MAX_ARRAY_LENGTH);\n    };\n\n    // Add `LazyWrapper` methods to `lodash.prototype`.\n    baseForOwn(LazyWrapper.prototype, function(func, methodName) {\n      var checkIteratee = /^(?:filter|find|map|reject)|While$/.test(methodName),\n          isTaker = /^(?:head|last)$/.test(methodName),\n          lodashFunc = lodash[isTaker ? ('take' + (methodName == 'last' ? 'Right' : '')) : methodName],\n          retUnwrapped = isTaker || /^find/.test(methodName);\n\n      if (!lodashFunc) {\n        return;\n      }\n      lodash.prototype[methodName] = function() {\n        var value = this.__wrapped__,\n            args = isTaker ? [1] : arguments,\n            isLazy = value instanceof LazyWrapper,\n            iteratee = args[0],\n            useLazy = isLazy || isArray(value);\n\n        var interceptor = function(value) {\n          var result = lodashFunc.apply(lodash, arrayPush([value], args));\n          return (isTaker && chainAll) ? result[0] : result;\n        };\n\n        if (useLazy && checkIteratee && typeof iteratee == 'function' && iteratee.length != 1) {\n          // Avoid lazy use if the iteratee has a \"length\" value other than `1`.\n          isLazy = useLazy = false;\n        }\n        var chainAll = this.__chain__,\n            isHybrid = !!this.__actions__.length,\n            isUnwrapped = retUnwrapped && !chainAll,\n            onlyLazy = isLazy && !isHybrid;\n\n        if (!retUnwrapped && useLazy) {\n          value = onlyLazy ? value : new LazyWrapper(this);\n          var result = func.apply(value, args);\n          result.__actions__.push({ 'func': thru, 'args': [interceptor], 'thisArg': undefined });\n          return new LodashWrapper(result, chainAll);\n        }\n        if (isUnwrapped && onlyLazy) {\n          return func.apply(this, args);\n        }\n        result = this.thru(interceptor);\n        return isUnwrapped ? (isTaker ? result.value()[0] : result.value()) : result;\n      };\n    });\n\n    // Add `Array` methods to `lodash.prototype`.\n    arrayEach(['pop', 'push', 'shift', 'sort', 'splice', 'unshift'], function(methodName) {\n      var func = arrayProto[methodName],\n          chainName = /^(?:push|sort|unshift)$/.test(methodName) ? 'tap' : 'thru',\n          retUnwrapped = /^(?:pop|shift)$/.test(methodName);\n\n      lodash.prototype[methodName] = function() {\n        var args = arguments;\n        if (retUnwrapped && !this.__chain__) {\n          var value = this.value();\n          return func.apply(isArray(value) ? value : [], args);\n        }\n        return this[chainName](function(value) {\n          return func.apply(isArray(value) ? value : [], args);\n        });\n      };\n    });\n\n    // Map minified method names to their real names.\n    baseForOwn(LazyWrapper.prototype, function(func, methodName) {\n      var lodashFunc = lodash[methodName];\n      if (lodashFunc) {\n        var key = lodashFunc.name + '';\n        if (!hasOwnProperty.call(realNames, key)) {\n          realNames[key] = [];\n        }\n        realNames[key].push({ 'name': methodName, 'func': lodashFunc });\n      }\n    });\n\n    realNames[createHybrid(undefined, WRAP_BIND_KEY_FLAG).name] = [{\n      'name': 'wrapper',\n      'func': undefined\n    }];\n\n    // Add methods to `LazyWrapper`.\n    LazyWrapper.prototype.clone = lazyClone;\n    LazyWrapper.prototype.reverse = lazyReverse;\n    LazyWrapper.prototype.value = lazyValue;\n\n    // Add chain sequence methods to the `lodash` wrapper.\n    lodash.prototype.at = wrapperAt;\n    lodash.prototype.chain = wrapperChain;\n    lodash.prototype.commit = wrapperCommit;\n    lodash.prototype.next = wrapperNext;\n    lodash.prototype.plant = wrapperPlant;\n    lodash.prototype.reverse = wrapperReverse;\n    lodash.prototype.toJSON = lodash.prototype.valueOf = lodash.prototype.value = wrapperValue;\n\n    // Add lazy aliases.\n    lodash.prototype.first = lodash.prototype.head;\n\n    if (symIterator) {\n      lodash.prototype[symIterator] = wrapperToIterator;\n    }\n    return lodash;\n  });\n\n  /*--------------------------------------------------------------------------*/\n\n  // Export lodash.\n  var _ = runInContext();\n\n  // Some AMD build optimizers, like r.js, check for condition patterns like:\n  if (typeof define == 'function' && typeof define.amd == 'object' && define.amd) {\n    // Expose Lodash on the global object to prevent errors when Lodash is\n    // loaded by a script tag in the presence of an AMD loader.\n    // See http://requirejs.org/docs/errors.html#mismatch for more details.\n    // Use `_.noConflict` to remove Lodash from the global object.\n    root._ = _;\n\n    // Define as an anonymous module so, through path mapping, it can be\n    // referenced as the \"underscore\" module.\n    define(function() {\n      return _;\n    });\n  }\n  // Check for `exports` after `define` in case a build optimizer adds it.\n  else if (freeModule) {\n    // Export for Node.js.\n    (freeModule.exports = _)._ = _;\n    // Export for CommonJS support.\n    freeExports._ = _;\n  }\n  else {\n    // Export to the global object.\n    root._ = _;\n  }\n}.call(this));\n","module.exports = require('./helpers/bundle-url').getBundleURL('gIy7C') + \"endive_wasm_bg.87f53988.wasm\" + \"?\" + Date.now();","export const prop = {\n  type: \"universe\",\n  level: {},\n};\n\nexport const customTypes = [[\"Prop\", prop]];\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as Blockly from \"blockly/core\";\n\nimport { customTypes } from \"./definitions\";\n\nBlockly.defineBlocksWithJsonArray([\n  // Theorems and lemmas\n  {\n    type: \"theorem\",\n    message0: \"Théorème: %1 Preuve: %2 %3\",\n    args0: [\n      {\n        type: \"input_value\",\n        name: \"STATEMENT\",\n      },\n      {\n        type: \"input_end_row\",\n      },\n      {\n        type: \"input_statement\",\n        name: \"PROOF\",\n      },\n    ],\n    inputsInline: false,\n    colour: 300,\n    tooltip: \"\",\n    helpUrl: \"\",\n  },\n\n  {\n    type: \"lemma\",\n    message0: \"Lemme %1 %2 %3 Preuve: %4 %5\",\n    args0: [\n      {\n        type: \"field_input\",\n        name: \"NAME\",\n        text: \"whatever\",\n      },\n      {\n        type: \"input_value\",\n        name: \"STATEMENT\",\n      },\n      {\n        type: \"input_end_row\",\n      },\n      {\n        type: \"input_end_row\",\n      },\n      {\n        type: \"input_statement\",\n        name: \"PROOF\",\n      },\n    ],\n    previousStatement: null,\n    nextStatement: null,\n    colour: 230,\n    tooltip: \"\",\n    helpUrl: \"\",\n  },\n\n  // Statements\n  {\n    type: \"proposition_forall\",\n    message0: \"Pour tout %1 , %2\",\n    args0: [\n      {\n        type: \"field_variable\",\n        name: \"VARIABLE\",\n        variable: \"%{BKY_VARIABLES_DEFAULT_NAME}\",\n      },\n      {\n        type: \"input_value\",\n        name: \"PROPOSITION\",\n      },\n    ],\n    output: null,\n    colour: 65,\n    tooltip: \"\",\n    helpUrl: \"\",\n  },\n\n  {\n    type: \"proposition_exists\",\n    message0: \"Il existe %1 tel que %2\",\n    args0: [\n      {\n        type: \"field_variable\",\n        name: \"VARIABLE\",\n        variable: \"%{BKY_VARIABLES_DEFAULT_NAME}\",\n      },\n      {\n        type: \"input_value\",\n        name: \"PROPOSITION\",\n      },\n    ],\n    output: null,\n    colour: 65,\n    tooltip: \"\",\n    helpUrl: \"\",\n  },\n\n  {\n    type: \"proposition_or\",\n    message0: \"%1 ou %2\",\n    args0: [\n      {\n        type: \"input_value\",\n        name: \"LEFT\",\n      },\n      {\n        type: \"input_value\",\n        name: \"RIGHT\",\n      },\n    ],\n    inputsInline: true,\n    output: null,\n    colour: 65,\n    tooltip: \"\",\n    helpUrl: \"\",\n  },\n\n  {\n    type: \"proposition_and\",\n    message0: \"%1 et %2\",\n    args0: [\n      {\n        type: \"input_value\",\n        name: \"LEFT\",\n      },\n      {\n        type: \"input_value\",\n        name: \"RIGHT\",\n      },\n    ],\n    inputsInline: true,\n    output: null,\n    colour: 65,\n    tooltip: \"\",\n    helpUrl: \"\",\n  },\n\n  {\n    type: \"proposition_reference\",\n    message0: \"%1\",\n    args0: [\n      {\n        type: \"field_variable\",\n        name: \"NAME\",\n        variable: \"x\",\n      },\n    ],\n    output: null,\n    colour: 65,\n    tooltip: \"\",\n    helpUrl: \"\",\n  },\n\n  // Tactics\n  {\n    type: \"tactic_let\",\n    message0: \"Soit %1 dans %2.\",\n    args0: [\n      {\n        type: \"field_variable\",\n        name: \"VARIABLE\",\n        variable: \"x\",\n      },\n      {\n        type: \"input_dummy\",\n        name: \"TYPE\",\n      },\n    ],\n    inputsInline: true,\n    previousStatement: null,\n    nextStatement: null,\n    colour: 170,\n    tooltip: \"\",\n    helpUrl: \"\",\n    extensions: [\"dynamic_type_dropdown\"],\n  },\n\n  {\n    type: \"tactic_suppose\",\n    message0: \"Supposons %1.\",\n    args0: [\n      {\n        type: \"input_value\",\n        name: \"HYPOTHESIS\",\n      },\n    ],\n    previousStatement: null,\n    nextStatement: null,\n    colour: 170,\n    tooltip: \"\",\n    helpUrl: \"\",\n  },\n\n  {\n    type: \"tactic_then\",\n    message0: \"Alors, %1.\",\n    args0: [\n      {\n        type: \"input_value\",\n        name: \"CONCLUSION\",\n      },\n    ],\n    previousStatement: null,\n    nextStatement: null,\n    colour: 170,\n    tooltip: \"\",\n    helpUrl: \"\",\n  },\n]);\n\nBlockly.Blocks[\"proposition_implies\"] = {\n  init: function () {\n    this.appendValueInput(\"ANTECEDENT\");\n    this.appendValueInput(\"CONSEQUENT\").appendField(\"⇒\");\n    this.setOutput(true, null);\n    this.setColour(65);\n    this.inputsInline = true;\n    let thisBlock = this;\n    this.svgGroup_.addEventListener(\"dblclick\", function (event) {\n      thisBlock.inputsInline = !thisBlock.inputsInline;\n      thisBlock.setInputsInline(thisBlock.inputsInline);\n      event.stopPropagation();\n    });\n  },\n};\n\nBlockly.Extensions.register(\"dynamic_type_dropdown\", function () {\n  let thisBlock = this;\n  this.getInput(\"TYPE\").appendField(\n    new Blockly.FieldDropdown(function () {\n      return customTypes.map((t) => [t[0], t[0].toUpperCase()]);\n    }),\n  );\n});\n"],"names":["register","validate","unregister","getItem","hasItem","getClass","getObject","getAllItems","getClassFromOptions","getWorkspaceById","getAllWorkspaces","registerWorkspace","unregisterWorkpace","getMainWorkspace","setMainWorkspace","getSelected","setSelected","getParentContainer","setParentContainer","svgResize","getBlockTypeCounts","jsonInitFactory","defineBlocksWithJsonArray","defineBlocksWithJsonArrayInternal","getNextUniqueId","genUid","setRecordUndo","getRecordUndo","fire","fireInternal","fireNow","filter","clearPendingUndo","isEnabled","setGroupInternal","getDescendantIds","fromJson","get","disableOrphans","longStart","longStop","clearTouchIdentifier","shouldHandleEvent","getTouchIdentifierFromEvent","checkTouchIdentifier","conditionalBind","bind","unbind","isTargetInput","isRightButton","mouseToSvg","getScrollDeltaPixels","removeElem","inject","warn","createSvgElement","addClass","removeClasses","removeClass","hasClass","removeNode","insertAfter","containsNode","setCssTransform","startTextWidthCache","stopTextWidthCache","getTextWidth","getFastTextWidth","getFastTextWidthWithSizeString","measureFontMetrics","getSize","getSizeInternal","getSizeWithDisplay","getComputedStyle","getPageOffset","getViewportPageOffset","getBorderBox","scrollIntoContainerView","getContainerOffsetToScrollInto","getRelativeXY","getInjectionDivXY","getViewportBBox","getDocumentScroll","screenToWsCoordinates","wsToScreenCoordinates","injectDependencies","domToText","sanitizeText","convertToolboxDefToJson","validateToolbox","convertFlyoutDefToJsonArray","hasCategories","hasCategoriesInternal","isCategoryCollapsible","convertToToolboxJson","xmlToJsonArray","addAttributes","parseToolboxTree","getStartPositionRect","getCornerOppositeToolbox","bumpPositionRect","alert","setAlert","confirm","confirmInternal","setConfirm","prompt","setPrompt","isVariableBackedParameterModel","isLegacyProcedureDefBlock","isLegacyProcedureCallBlock","flyoutCategory","flyoutCategoryBlocks","generateUniqueName","generateUniqueNameInternal","generateUniqueNameFromOptions","createVariableButtonHandler","promptName","nameUsedWithOtherType","nameUsedWithAnyType","nameUsedWithConflictingParam","checkForConflictingParamWithProcedureModels","checkForConflictingParamWithLegacyProcedures","generateVariableFieldDom","createVariable","getAddedVariables","queueRender","finishQueuedRenders","triggerQueuedRenders","alwaysImmediatelyRender","queueBlock","doRenders","dequeueBlock","shouldRenderRootBlock","renderBlock","workspaceToDom","variablesToDom","blockToDomWithXY","fieldToDom","allFieldsToDom","blockToDom","cloneShadow","domToPrettyText","clearWorkspaceAndLoadFromXml","appendDomToWorkspace","domToBlockInternal","domToVariables","mapSupportedXmlTags","applyMutationTagNodes","applyCommentTagNodes","applyDataTagNodes","applyFieldTagNodes","findChildBlocks","applyInputTagNodes","applyNextTagNodes","domToBlockHeadless","domToField","deleteNext","isElement","isSerializable","save","saveAttributes","saveCoords","saveExtraState","saveIcons","saveFields","saveInputBlocks","saveNextBlocks","saveConnection","append","appendInternal","appendPrivate","loadCoords","loadAttributes","loadExtraState","tryToConnectParent","loadIcons","loadFields","loadInputBlocks","loadNextBlocks","loadConnection","initBlock","moveBlockToNotConflict","blockOverlapsOtherExactly","blockIsInSnapRadius","copy","copyInternal","paste","pasteFromData","duplicate","duplicateInternal","setRole","setState","getDiv","testOnly_setDiv","createDom","show","hide","isVisible","hideIfOwner","positionInternal","positionWithAnchor","calculateX","calculateY","isRepositionable","repositionForWindowResize","getCurrentBlock","setCurrentBlock","populate_","position_","createWidget_","haltPropagation","dispose","commentDeleteOption","commentDuplicateOption","workspaceCommentOption","toRadians","toDegrees","clamp","setBoundsElement","getOwner","getContentDiv","clearContent","setColour","showPositionedByBlock","showPositionedByField","getScaledBboxOfBlock","getScaledBboxOfField","showPositionedByRect","getPositionBelowMetrics","getPositionAboveMetrics","getPositionTopOfPageMetrics","getPositionX","hideWithoutAnimation","disposeUiEffect","disposeUiStep","connectionUiEffect","disconnectUiEffect","disconnectUiStep","disconnectUiStop","startsWith","shortestStringLength","commonWordPrefix","commonWordSuffix","wrapLine","wrapScore","wrapMutate","wrapToText","setCustomTooltip","getCustomTooltip","getTooltipOfObject","getTargetObject","bindMouseEvents","unbindMouseEvents","onMouseOver","onMouseOut","onMouseMove","block","unblock","renderContent","renderDefaultContent","getPosition","deepMerge","hasBubble","getHsvSaturation","setHsvSaturation","getHsvValue","setHsvValue","parse","rgbToHex","hexToRgb","hsvToHex","blend","hueToHex","tokenizeInterpolationInternal","tokenizeInterpolation","replaceMessageReferences","checkMessageReferences","parseBlockColour","isProcedureBlock","isObservable","fromJsonInternal","trimOptions","applyTrim","validateOptions","isRegistered","apply","checkNoMutatorProperties","checkXmlHooks","checkJsonHooks","checkMutatorDialog","checkHasFunctionPair","checkHasMutatorProperties","getMutatorProperties","mutatorPropertiesMatch","runAfterPageLoad","checkDropdownOptionsInTable","extensionParentTooltip","point","curve","moveTo","moveBy","lineTo","line","lineOnAxis","arc","allProcedures","procTupleComparator","isLegalName","isNameUsed","updateMutatorFlyout","mutatorOpenListener","mutatorChangeListener","getCallers","blockIsModernCallerFor","isDynamicShape","isPuzzleTab","isNotch","getParentConnection","connectReciprocally","getSingleConnection","getConnectionForOrphanedOutput","init","stringButtonClickHandler","numberButtonClickHandler","colourButtonClickHandler","resizeSvgContents","isCopyable","registerEscape","registerDelete","registerCopy","registerCut","registerPaste","registerUndo","registerRedo","registerDefaultShortcuts","saveProcedure","saveParameter","loadProcedure","loadParameter","load","bumpObjectIntoBounds","bumpIntoBoundsHandler","extractObjectFromEvent","bumpTopObjectsIntoBounds","initIconData","registerCleanup","toggleOption_","registerCollapse","registerExpand","addDeletableBlocks_","getDeletableBlocks_","deleteNext_","registerDeleteAll","registerWorkspaceOptions_","registerDuplicate","registerComment","registerInline","registerCollapseExpandBlock","registerDisable","registerHelp","registerBlockOptions_","registerDefaultOptions","createMainWorkspace","onKeyDown","bindDocumentEvents","loadSounds","isIcon","isPaster","isSelectableToolboxItem","hideChaff","isRenderedElement","type","name","registryItem","opt_allowOverrides","Type","trim","Error","toLowerCase","caselessName","typeRegistry","typeMap","nameRegistry","nameMap","Object","create","String","FIELD","console","opt_throwIfMissing","msg","opt_cased","casedRegistry","key","keys","options","plugin","plugins","DEFAULT","id","WorkspaceDB_","workspaces","workspaceId","push","workspace","mainWorkspace","selected","newSelection","parentContainer","newParent","parentWorkspace","svg","getParentSvg","cachedSize","getCachedParentSvgSize","div","parentElement","HTMLElement","width","offsetWidth","height","offsetHeight","setAttribute","setCachedParentSvgSize","resize","opt_stripFollowing","typeCountsMap","descendants","getDescendants","nextBlock","getNextBlock","index","indexOf","splice","length","i","checkBlock","jsonDef","jsonInit","jsonArray","TEST_ONLY","defineBlocks","createBlockDefinitionsFromJsonArray","blocks","elem","definition","Blocks","toString","nextId","internal","newValue","recordUndo","event","FIRE_QUEUE","requestAnimationFrame","setTimeout","e","queue","eventWorkspace","fireChangeListener","workspaceIds","Set","map","undoStack","getUndoStack","group","undefined","events","queueIn","forward","slice","reverse","mergedQueue","hash","isNull","isUiEvent","eventType","UI","blockId","join","lastEntry","lastEvent","MOVE","moveEvent","newParentId","newInputName","newCoordinate","reason","reasonSet","concat","Array","from","CHANGE","element","VIEWPORT_CHANGE","viewportEvent","viewTop","viewLeft","scale","oldScale","CLICK","BUBBLE_OPEN","unshift","disable","disabled","enable","getGroup","setGroup","state","ids","descendant","json","eventClass","EVENT","CREATE","getBlockById","initialUndoFlag","parent","getParent","children","child","setEnabled","outputConnection","previousConnection","isDragging","gesture","longPid_","handleRightClick","LONGPRESS","clearTimeout","touchIdentifier_","PointerEvent","pointerId","identifier","node","thisObject","func","opt_noCaptureIdentifier","wrapFunc","call","bindData","TOUCH_MAP","addEventListener","callback","pop","removeEventListener","target","isContentEditable","getAttribute","HTMLInputElement","HTMLTextAreaElement","ctrlKey","MAC","button","matrix","svgPoint","createSVGPoint","x","clientX","y","clientY","getScreenCTM","inverse","matrixTransform","deltaMode","deltaX","deltaY","LINE_MODE_MULTIPLIER","PAGE_MODE_MULTIPLIER","arr","value","cssContent","injected","content","hasCss","pathToMedia","mediaPath","replace","cssNode","document","createElement","cssTextNode","createTextNode","appendChild","head","insertBefore","firstChild","deprecationDate","deletionDate","opt_use","previousWarnings","has","add","attrs","opt_parent","createElementNS","SVG_NS","className","classNames","split","every","classList","contains","remove","parentNode","removeChild","newNode","refNode","siblingNode","nextSibling","transform","style","cacheReference","cacheWidths","textElement","textContent","baseVal","getComputedTextLength","fontSize","fontWeight","fontFamily","text","canvasContext","computeCanvas","body","getContext","font","measureText","span","display","position","top","left","result","baseline","alignItems","offsetTop","originalDisplay","originalVisibility","visibility","originalPosition","Size","property","styles","window","getPropertyValue","el","pos","Coordinate","box","getBoundingClientRect","documentElement","scrollCoord","pageXOffset","scrollLeft","pageYOffset","scrollTop","parseFloat","right","bottom","Rect","container","opt_center","offset","elementPos","containerPos","containerBorder","relX","relY","elementSize","spaceX","clientWidth","spaceY","clientHeight","Math","min","max","xy","parseInt","r","match","XY_REGEX","Number","styleComponents","XY_STYLE_REGEX","scrollOffset","win","ws","screenCoordinates","screenX","screenY","boundingRect","getInjectionDiv","injectionDiv","clientOffsetPixels","mainOffsetPixels","getOriginOffsetInPixels","difference","finalOffsetPixels","finalOffsetMainWs","workspaceCoordinates","mainOffset","dependencies","DOMParser","XMLSerializer","domParser","xmlSerializer","tagName","NAME_SPACE","textToDom","doc","parseFromString","getElementsByTagName","nodeName","dom","serializeToString","INVALID_CONTROL_CHARS","charCodeAt","toolboxDef","Element","toolboxJson","toolboxKind","toolboxContents","FLYOUT_TOOLBOX_KIND","CATEGORY_TOOLBOX_KIND","flyoutDef","isArray","nodeType","categories","item","toUpperCase","categoryInfo","contents","Node","childNodes","obj","j","attributes","attr","parsedToolboxDef","TypeError","size","horizontalPadding","verticalPadding","metrics","hasVerticalScrollbar","scrollbar","canScrollVertically","horizontal","horizontalPosition","LEFT","absoluteMetrics","RTL","Scrollbar","scrollbarThickness","viewMetrics","vertical","verticalPosition","TOP","canScrollHorizontally","toolboxMetrics","hPosition","Position","horizontalLayout","RIGHT","vPosition","BOTTOM","startRect","margin","bumpDir","savedPositions","otherEl","intersects","bumpDirection","UP","message","opt_callback","alertImplementation","alertFunction","confirmImplementation","confirmFunction","defaultValue","promptImplementation","promptFunction","param","getVariableModel","getProcedureDef","getProcedureCall","renameProcedure","allUsedVarModels","getAllBlocks","variables","blockVariables","getVarModels","variable","getId","values","allDeveloperVariables","getDeveloperVariables","devVars","xmlList","registerButtonCallback","getTargetWorkspace","blockList","variableModelList","getVariablesOfType","mostRecentVariable","sort","VariableModel","compareByName","VAR_LETTER_OPTIONS","charAt","getAllVariableNames","startChar","usedNames","letters","suffix","letterIndex","inUse","potName","opt_type","promptAndCheckWithAlert","defaultName","Msg","existing","renameVariable","promptText","newName","procedure","renameVariableById","defaultText","newVar","allVariables","getVariableMap","getAllVariables","oldName","getProcedureMap","getProcedures","procedures","params","getParameters","procHasOld","some","procHasNew","getName","def","blockHasOld","blockHasNew","variableModel","field","getOrCreateVariablePackage","opt_name","getVariable","potentialVariableMap","getPotentialVariableMap","getVariableById","isFlyout","targetWorkspace","originalVariables","allCurrentVariables","addedVariables","paster","PASTER","Promise","resolve","afterRendersPromise","afterRendersResolver","animationRequestId","cancelAnimationFrame","JavaFx","dirtyBlocks","rootBlocks","b","resizeContents","blockOrigin","getRelativeToSurfaceXY","updateComponentLocations","delete","getChildren","isDisposed","renderEfficiently","opt_noId","treeXml","variablesElement","hasChildNodes","comments","getTopComments","comment","toXmlWithXY","getTopBlocks","variableList","isInsertionMarker","DocumentFragment","getWidth","round","toXml","inputList","input","fieldRow","fieldDom","isShadow","mutationToDom","mutation","hasAttributes","commentText","getCommentText","getIcon","IconType","COMMENT","getBubbleSize","pinned","bubbleIsVisible","commentElement","data","dataElement","empty","inputTypes","DUMMY","END_ROW","childBlock","connection","targetBlock","VALUE","STATEMENT","childShadow","getShadowDom","childElem","NodeType","ELEMENT_NODE","inputsInline","inputsInlineDefault","isCollapsed","isDeletable","isMovable","isEditable","nextElem","nextShadow","nextConnection","shadow","cloneNode","textNode","removeAttribute","TEXT_NODE","lines","blob","indent","substring","xml","setResizesEnabled","clear","blockIds","domToWorkspace","newBlockIds","existingGroup","variablesFirst","xmlChild","xmlChildElement","blockX","blockY","isNaN","rendered","WorkspaceCommentSvg","fromXmlRendered","WorkspaceComment","fromXml","FINISHED_LOADING","getBlocksBoundingBox","bbox","farY","topX","newLeftX","Infinity","newRightX","newY","blockXY","offsetY","ySeparation","offsetX","domToBlock","xmlBlock","variablesBeforeCreation","topBlock","topBlockSvg","setConnectionTracking","initSvg","disposed","initModel","newVariables","thisVariable","VAR_CREATE","xmlVariables","childNodeMap","next","xmlChildren","shouldCallInitSvg","domToMutation","setCommentText","setBubbleSize","setBubbleVisible","xmlNode","childBlockElement","childShadowElement","prototypeName","getInput","childBlockInfo","setShadowDom","isConnected","parentConnection","connectedToParentNext","outerHTML","newBlock","xmlChildNameMap","connect","inline","setInputsInline","deletable","setDeletable","movable","setMovable","editable","setEditable","collapsed","setCollapsed","setShadow","fieldName","getField","saveState","loadState","serializer","SERIALIZER","addCoordinates","addInputBlocks","addNextBlocks","doFullSerialization","saveIds","isOwnDeletable","isOwnMovable","isOwnEditable","extraState","icons","icon","getIcons","getType","fields","inputs","connectionState","getShadowState","prevRecordUndo","BLOCK_CREATE","blockSvg","MissingBlockType","getSourceBlock","RealChildOfShadow","childConnection","MissingConnection","connected","checker","connectionChecker","BadConnectionCheck","getErrorMessage","canConnectWithReason","iconTypes","iconType","iconState","constructor","ICON","UnregisteredIcon","addIcon","fieldState","inputName","setShadowState","onLocationChange","snapRadius","config","coord","otherCoords","otherBlock","sum","translate","otherCoord","abs","getConnections_","closest","toCopy","toCopyData","stashedCopyData","stashedWorkspace","copyData","coordinate","getRootWorkspace","toDuplicate","roleName","ROLE_ATTRIBUTE","stateName","ARIA_PREFIX","containerDiv","newDiv","querySelector","containerClassName","newOwner","rtl","newDispose","owner","direction","rendererClassName","getRenderer","getClassName","themeClassName","getTheme","markFocused","oldOwner","viewportBBox","anchorBBox","widgetSize","currentBlock","dummyOwner","menu","menu_","focus","Menu","Role","MENU","option","menuItem","MenuItem","setRightToLeft","MENUITEM","addChild","enabled","onAction","actionHandler","scope","menuSize","menuDom","render","preventDefault","stopPropagation","callbackFactory","select","deleteOption","duplicateOption","wsCommentOption","wsCommentOption.callback","DEFAULT_SIZE","finalOffset","angleDegrees","PI","angleRadians","lowerBound","number","upperBound","temp","arrow","opacity","transition","ANIMATION_TIME","boundsElem","boundsElement","backgroundColour","borderColour","backgroundColor","borderColor","opt_onHide","opt_secondaryYOffset","positionToField","getSvgRoot","scaledHeight","scaledWidth","bBox","getScaledBBox","primaryX","primaryY","secondaryY","sourceBlock","secondaryX","onHide","renderedClassName","boundsInfo","divSize","xCoords","initialX","divX","initialY","finalX","finalY","PADDING_Y","arrowX","arrowY","ARROW_SIZE","BORDER_SIZE","arrowAtTop","arrowVisible","sourceX","boundsLeft","boundsRight","divWidth","relativeArrowX","horizPadding","ARROW_HORIZONTAL_PADDING","divOwner","opt_withoutAnimation","animateOutTimer","getPositionMetrics","floor","svgGroup","getAudioManager","play","getSvgXY","clone","cloneRect","Date","rect","start","workspaceScale","percent","getTime","ripple","Svg","CIRCLE","scaleAnimation","ANIMATE","opacityAnimation","beginElement","getHeightWidth","magnitude","atan","DISPLACEMENT","wobblingBlock","DURATION","skew","val","sin","WIGGLES","disconnectPid","getTranslation","str","prefix","array","reduce","a","opt_shortest","wordPrefix","len","letter","substr","wrap","limit","words","score","lastText","lineCount","lastScore","wordBreaks","steps","insertedBreaks","lineLengths","linePunctuation","maxLength","pow","bestScore","bestBreaks","mutatedWordBreaks","mutatedScore","isNumber","test","customFn","customTooltip","visible","object","tooltip","mouseOverWrapper_","mouseOutWrapper_","blocked","newElement","currentTarget","poisonedElement","mouseOutPid","_e","showPid","dx","lastX","pageX","dy","lastY","pageY","sqrt","RADIUS_OK","HOVER_MS","tip","LIMIT","windowWidth","windowHeight","anchorX","OFFSET_X","anchorY","OFFSET_Y","scrollY","MARGINS","scrollX","source","hsvSaturation","newSaturation","hsvValue","hex","names","rgb","g","colour","h","s","v","red","green","blue","sextant","remainder","val1","val2","val3","colour1","colour2","factor","hex1","hex2","rgb1","rgb2","hue","parseInterpolationTokens","tokenizeNewlines","tokens","chars","buffer","c","rawKey","keyUpper","bklyKey","rawValue","prototype","mergedTokens","interpolatedResult","validSoFar","msgTable","m","msgKey","dereferenced","errorMsg","getProcedureModel","doProcedureUpdate","isProcedureDef","startPublishing","stopPublishing","fieldClass","fieldObject","hasImages","trimmedOptions","label","imageLabel","alt","stringLabels","shortest","prefixLength","suffixLength","foundError","tuple","error","src","initFn","allExtensions","registerMixin","mixinObj","mixin","registerMutator","opt_helperFn","opt_blockList","errorPrefix","hasMutatorDialog","setMutator","MutatorIcon","isMutator","extensionFn","mutatorProperties","mutationName","properties","compose","decompose","func1","func2","hasXmlHooks","hasJsonHooks","oldProperties","newProperties","fn","readyState","readyStateCheckInterval","setInterval","clearInterval","buildTooltipForDropdown","dropdownName","lookupTable","blockTypesChecked","setTooltip","getFieldValue","dropdown","FieldDropdown","isOptionListDynamic","getOptions","buildTooltipWithFieldText","msgTemplate","getText","tooltipWhenNotConnected","getInputsInline","command","points","flags","radius","iconConstructor","root","proceduresNoReturn","p","getReturnTypes","pa","getBlocksByType","forEach","proceduresReturn","ta","tb","localeCompare","sensitivity","findLegalName","isInFlyout","opt_exclude","Names","equals","excludeModel","model","rename","UnattachedFieldError","legalName","setName","getValue","procedureBlock","populateProcedures","procedureList","templateName","args","arg","nameField","xmlElement","argBlock","argValue","DEFAULT_ARG","fieldContent","updateToolbox","bubbleType","isOpen","TYPE","getWorkspace","addChangeListener","BLOCK_DELETE","BLOCK_CHANGE","BLOCK_FIELD_INTERMEDIATE_CHANGE","procName","mutateCallers","defBlock","oldRecordUndo","callers","caller","oldMutation","oldMutationDom","newMutationDom","newMutation","getDefinition","shape","isDynamic","pathDown","pathUp","pathLeft","pathRight","topConnection","first","second","targetConnection","orphanBlock","foundConnection","output","typeChecker","getConnectionChecker","canConnect","startBlock","rendererClass","RENDERER","theme","opt_rendererOverrides","renderer","firstVariable","ShortcutRegistry","registry","escapeAction","ESCAPE","preconditionFn","readOnly","keyCodes","KeyCodes","ESC","deleteShortcut","DELETE","Gesture","inProgress","checkAndDelete","BACKSPACE","ctrlC","createSerializedKey","C","CTRL","altC","ALT","metaC","META","copyShortcut","COPY","copyWorkspace","ctrlX","X","altX","metaX","cutShortcut","CUT","BlockSvg","ctrlV","V","altV","metaV","pasteShortcut","PASTE","ctrlZ","Z","altZ","metaZ","undoShortcut","UNDO","undo","ctrlShiftZ","SHIFT","altShiftZ","metaShiftZ","ctrlY","Y","redoShortcut","REDO","proc","returnTypes","parameters","getTypes","types","procedureModelClass","parameterModelClass","setReturnTypes","entries","insertParameter","setTypes","serializerMap","deserializers","priority","WorkspaceSvg","deserializer","pluginState","bounds","objectMetrics","getBoundingRectangle","newYPosition","leftClamp","rightClamp","newXPosition","metricsManager","getMetricsManager","hasFixedEdges","BUMP_EVENTS","scrollMetricsInWsCoords","getScrollMetrics","wasBumped","BLOCK_MOVE","getRootBlock","COMMENT_CREATE","COMMENT_MOVE","getCommentById","commentId","topBlocks","getTopBoundedElements","dragIconData","location","relativeCoords","ContextMenuRegistry","undoOption","displayText","scopeType","ScopeType","WORKSPACE","weight","redoOption","getRedoStack","cleanOption","cleanUp","shouldCollapse","timeoutFn","timeoutCounter","ms","DELAY","collapseOption","collapse","expandOption","deleteList","eventGroup","shift","isDeadOrDying","deletableBlocksLength","cancelCurrentGesture","deletableBlocks","ok","isDuplicatable","BLOCK","commentOption","hasIcon","CommentIcon","inlineOption","StatementInput","collapseExpandOption","disableOption","getInheritedDisabled","descendantCount","helpOption","url","helpUrl","showHelp","opt_options","containerElement","getElementById","ownerDocument","Options","subContainer","tabIndex","State","LABEL","SVG","HTML_NS","XLINK_NS","defs","DEFS","rnd","random","gridPattern","Grid","gridOptions","wsOptions","zoomOptions","startScale","languageTree","flyout","addFlyout","hasTrashcan","addTrashcan","controls","addZoomControls","getThemeManager","subscribe","workspaceResizeHandler","hideComponents","setResizeHandlerWrapper","toolbox","getToolbox","getFlyout","scrollToStart","trashcan","zoomControls_","moveOptions","scrollbars","ScrollbarPair","setMetrics","hasSounds","documentEventsBound","updateInverseScreenCTM","IPAD","unbindSounds","soundBinds","oldSoundBinding","audioMgr","preload","initView","getWeight","applyColour","hideForInsertionMarker","updateEditable","updateCollapsed","isShownWhenCollapsed","setOffsetInBlock","onClick","toolboxItem","isSelectable","opt_onlyClosePopups","CONNECTION_CHECKER","CONNECTION_PREVIEWER","CURSOR","INPUT","TOOLBOX","THEME","TOOLBOX_ITEM","FLYOUTS_VERTICAL_TOOLBOX","FLYOUTS_HORIZONTAL_TOOLBOX","METRICS_MANAGER","BLOCK_DRAGGER","$jscomp$tmp$exports$module$name","draggingConnections","soup","soupLength","VAR_DELETE","VAR_RENAME","BLOCK_DRAG","SELECTED","MARKER_MOVE","TRASHCAN_OPEN","TOOLBOX_ITEM_SELECT","THEME_CHANGE","COMMENT_DELETE","COMMENT_CHANGE","Abstract","toJson","isBlank","run","_forward","getEventWorkspace_","UiBase","AbstractEvent","opt_workspaceId","Click","opt_block","opt_targetType","targetType","newEvent","ClickTarget","ZOOM_CONTROLS","TOUCH_ENABLED","globalThis","rawUserAgent","isJavaFx","isWebKit","isGecko","isAndroid","isIPad","isIPhone","isMac","isTablet","isMobile","raw","rawUpper","maxTouchPoints","GECKO","ANDROID","IPHONE","MOBILE","Capability","name_","POSITIONABLE","DRAG_TARGET","DELETE_AREA","AUTOHIDEABLE","ComponentManager","componentData","Map","capabilityToComponentIds","addComponent","componentInfo","component","capabilities","set","stringCapabilities","capability","removeComponent","addCapability","getComponent","hasCapability","removeCapability","getComponents","sorted","componentIds","components","componentDataList","componentDatum","tx","ty","distance","COMMENT_NODE","CLIPPATH","FECOMPOSITE","FECOMPONENTTRANSFER","FEFLOOD","FEFUNCA","FEGAUSSIANBLUR","FEPOINTLIGHT","FESPECULARLIGHTING","FILTER","FOREIGNOBJECT","G","IMAGE","LINE","PATH","PATTERN","POLYGON","RECT","TEXT","TSPAN","getHeight","other","opt_pair","opt_class","opt_margin","oldHostMetrics","ratio","origin","startDragHandle","handlePosition","handleLength","scrollbarLength","startDragMouse","containerVisible","isHandleVisible","onMouseMoveWrapper_","onMouseUpWrapper_","pair","DEFAULT_SCROLLBAR_MARGIN","outerSvg","svgBackground","svgHandle","setInitialThickness","lengthAttribute_","positionAttribute_","onMouseDownBarWrapper_","onMouseDownBar","onMouseDownHandleWrapper_","onMouseDownHandle","unsubscribe","constrainHandleLength","setHandleLength","newLength","constrainHandlePosition","setHandlePosition","newPosition","setScrollbarLength","newSize","setPosition","opt_metrics","hostMetrics","getMetrics","metricsAreEquivalent","resizeHorizontal","resizeVertical","updateMetrics","requiresViewResize","viewWidth","viewHeight","absoluteLeft","absoluteTop","resizeViewHorizontal","resizeContentHorizontal","viewSize","xCoordinate","scrollWidth","setVisible","maxScrollDistance","maxHandleOffset","handleOffset","resizeViewVertical","resizeContentVertical","scrollHeight","setContainerVisible","visibilityChanged","updateDisplay_","setVisibleInternal","mouseXY","getInverseScreenCTM","mouseLocation","handleXY","handleStart","pageLength","onMouseUpHandle","onMouseMoveHandle","currentMouse","getRatio_","setOrigin","DOWN","SPRITE","ZoomControls","boundEvents","zoomResetGroup","zoomOutGroup","zoomInGroup","HEIGHT","WIDTH","SMALL_SPACING","LARGE_SPACING","MARGIN_HORIZONTAL","MARGIN_VERTICAL","initialized","createZoomOutSvg","createZoomInSvg","createZoomResetSvg","getComponentManager","cornerPosition","positionRect","zoomInTranslateY","zoomOutTranslateY","clip","zoomoutSvg","setAttributeNS","zoom","zoominSvg","amount","zoomCenter","fireZoomEvent","zoomresetSvg","resetZoom","log","scaleSpeed","beginCanvasTransition","scrollCenter","endCanvasTransition","uiEvent","MUTATOR","WARNING","CUSTOM","setLocale","locale","k","VarBase","opt_variable","varId","VarCreate","varType","varName","deleteVariableById","opt_id","id_","var1","var2","CATEGORY_NAME","disposed_","isComment","addTopComment","xy_","height_","width_","content_","fireCreateEvent","removeTopComment","setHeight","setWidth","recordNew","getContent","setContent","xmlComment","info","parseAttributes","w","xmlX","xmlY","commentX","NaN","commentY","xmlH","xmlW","xmlId","Selected","opt_oldElementId","opt_newElementId","oldElementId","newElementId","WorkspaceCommentPaster","commentState","RESIZE_SIZE","BORDER_RADIUS","TEXTAREA_OFFSET","onMouseMoveWrapper","onMouseUpWrapper","eventsInit","deleteIconBorder","deleteGroup","resizeGroup","foreignObject","svgHandleTarget","svgRectTarget","textarea","autoLayout","focused","svgRect_","unselect","opt_noSelect","pathMouseDown","updateMovable","getBubbleCanvas","getGesture","handleBubbleStart","showContextMenu","oldId","addSelect","removeSelect","blurFocus","setFocus","addFocus","removeFocus","layerManger","getLayerManager","hasLayer","moveDuringDrag","newLoc","translation","clearTransformAttributes","commentBounds","setDragging","adding","setDeleteStyle","setAutoLayout","_enable","createEditor","addResizeDom","addDeleteDom","setSize","resizeMouseDown","deleteMouseDown","deleteMouseOut","deleteMouseUp","TOP_OFFSET","unbindDragEvents","startDrag","resizeMouseUp","resizeMouseMove","newXY","moveDrag","resizeComment","topOffset","textOffset","blur","opt_wsWidth","wsWidth","WeakSet","DeserializationError","toDevString","childState","VARIABLES","PROCEDURES","BLOCKS","saveBlock","BlockSerializer","blockStates","BlockBase","BlockCreate","allShadowBlocks","shadows","ThemeChange","opt_themeName","themeName","ViewportChange","opt_top","opt_left","opt_scale","opt_oldScale","DEFAULT_SNAP_RADIUS","dragRadius","flyoutDragRadius","connectingSnapRadius","currentConnectionPreference","bumpDelay","ConnectionType","INPUT_VALUE","OUTPUT_VALUE","NEXT_STATEMENT","PREVIOUS_STATEMENT","ConnectionDB","connections","addConnection","yPos","calculateIndexForYPos","findIndexOfConnection","conn","bestGuess","pointer","pointerMin","pointerMax","pointerMid","removeConnection","getNeighbours","maxRadius","checkConnection","yIndex","currentX","db","currentY","neighbours","isInYRange","baseY","searchForClosest","dxy","baseX","closestIndex","bestConnection","bestRadius","distanceFrom","dbList","BlockPaster","isCapacityAvailable","typeCounts","blockState","GRID","GRIDCELL","GROUP","LISTBOX","MENUITEMCHECKBOX","OPTION","PRESENTATION","ROW","TREE","TREEITEM","menuItems","onKeyDownHandler","mouseLeaveHandler","mouseEnterHandler","clickHandler","mouseOverHandler","highlightedItem","openingCoords","handleMouseOver","handleClick","handleMouseEnter","handleMouseLeave","handleKeyEvent","getElement","preventScroll","getMenuItem","menuElem","currentElement","setHighlighted","currentHighlighted","ACTIVEDESCENDANT","highlightNext","highlightHelper","highlightPrevious","highlightFirst","highlightLast","startIndex","delta","oldCoords","newCoords","performAction","shiftKey","metaKey","altKey","highlighted","opt_value","rightToLeft","highlight","checked","checkable","checkbox","contentDom","DISABLED","setCheckable","setChecked","nameDep","registry_","reset","getContextMenuOptions","menuOptions","precondition","menuOption","getBoundsInfo","boundPosition","boundSize","clientTop","BUBBLE","BubbleDragger","bubble","dragTarget_","wouldDeleteBubble_","startXY_","startBubbleDrag","moveToDragLayer","dragBubble","currentDragDeltaXY","pixelsToWorkspaceUnits_","oldDragTarget","getDragTarget","oldWouldDeleteBubble","shouldDelete_","updateCursorDuringBubbleDrag_","onDragExit","onDragEnter","onDragOver","dragTarget","componentManager","isDeleteArea","wouldDelete","endBubbleDrag","shouldPreventMove","onDrop","fireMoveEvent_","moveOffDragLayer","setOldCoordinate","pixelCoord","COLLAPSE_CHARS","DRAG_STACK","OPPOSITE_TYPE","RENAME_VARIABLE_ID","DELETE_VARIABLE_ID","WorkspaceDragger","horizontalScrollEnabled_","isMovableHorizontally","verticalScrollEnabled_","isMovableVertically","startScrollXY_","endDrag","drag","scroll","ZOOM_IN_MULTIPLIER","ZOOM_OUT_MULTIPLIER","creatorWorkspace","mouseDownXY","startWorkspace_","startIcon","startField","startBubble","hasExceededDragRadius","workspaceDragger","blockDragger","bubbleDragger","isMultiTouch_","isEnding_","gestureHasStarted","calledUpdateIsDragging","cachedPoints","startDistance","previousScale","currentDropdownOwner","isPinchZoomEnabled","mostRecentEvent","healStack","clearGesture","updateFromEvent","currentXY","updateDragDelta","changed","updateIsDragging","currentDragDelta","limitRadius","updateIsDraggingFromFlyout","isBlockCreatable","isScrollable","isDragTowardWorkspace","updateScreenCalculationsIfScrolled","createBlock","updateIsDraggingBubble","startDraggingBubble","updateIsDraggingBlock","startDraggingBlock","updateIsDraggingWorkspace","wsMovable","isDraggable","BlockDraggerClass","doStart","pinch","cancel","pointerType","handleTouchStart","handleMove","handleUp","isMultiTouch","handleTouchMove","handleTouchEnd","isBubbleClick","doBubbleClick","isFieldClick","doFieldClick","isIconClick","doIconClick","isBlockClick","doBlockClick","isWorkspaceClick","doWorkspaceClick","getTouchPoint","pointers","point0","point1","handlePinch","moveDistance","gestureScale","bringBlockToFront","handleWsStart","setStartWorkspace","fireWorkspaceClick","handleFlyoutStart","setStartFlyout","handleBlockStart","setStartBlock","setStartBubble","showEditor","autoClose","scheduleSnapAndBump","bringToFront","setStartField","setStartIcon","setTargetBlock","hasStartBubble","hasStartBlock","isClickable","isClickableInFlyout","handleInFlyout","hasStarted","getInsertionMarkers","getCurrentDragger","currentGesture_","pattern","spacing","line2","line1","snapToGrid","setSpacing","update","setLength","setSnapToGrid","snap","shouldSnap","getSpacing","getPatternId","safeSpacing","half","end","setLineAttributes","x1","x2","y1","y2","MarkerManager","cursorSvg_","cursor_","markers","markerSvg_","registerMarker","marker","unregisterMarker","setDrawer","makeMarkerDrawer","setMarkerSvg","getDrawer","getCursor","getMarker","setCursor","cursor","drawer","setCursorSvg","cursorSvg","getBlockCanvas","markerSvg","updateMarkers","keyboardAccessibilityMode","draw","markerIds","markerId","LOCAL_MARKER","Theme","opt_blockStyles","opt_categoryStyles","opt_componentStyles","startHats","blockStyles","categoryStyles","componentStyles","fontStyle","setBlockStyle","blockStyleName","blockStyle","setCategoryStyle","categoryStyleName","categoryStyle","getComponentStyle","componentName","recursiveStyle","setComponentStyle","styleValue","setFontStyle","setStartHats","defineTheme","themeObj","base","defaultBlockStyles","Classic","toolboxJsonDef","hasCollapse","hasComments","hasDisable","rawHasTrashcan","rawHasCollapse","rawHasComments","rawHasDisable","rawHasSounds","maxTrashcanContents","toolboxAtStart","toolboxPosition","endsWith","rawOneBasedIndex","modalInputs","oneBasedIndex","maxBlocks","maxInstances","parseMoveOptions_","hasScrollbars","parseGridOptions_","parseZoomOptions_","parseThemeOptions_","rendererOverrides","move","wheel","maxScale","minScale","grid","BlockChange","opt_element","opt_oldValue","opt_newValue","oldValue","setValue","oldState","getExtraBlockState_","JSON","stringify","Field","validator","DEFAULT_VALUE","constants_","mouseDownWrapper_","textContent_","textElement_","borderRect_","fieldGroup_","tooltip_","validator_","maxDisplayLength","sourceBlock_","enabled_","visible_","isDirty_","suffixField","prefixField","clickTarget_","EDITABLE","SERIALIZABLE","value_","size_","SKIP_SETUP","configure_","setValidator","setSourceBlock","getConstants","bindEvents_","createBorderRect_","createTextElement_","isFullBlockField","FIELD_BORDER_RECT_RADIUS","FIELD_TEXT_BASELINE_CENTER","clickTarget","getClickTarget_","onMouseDown_","fieldElement","_doFullSerialization","legacyState","saveLegacyState","loadLegacyState","callingClass","showEditor_","autoClosingFlyout","isCurrentlyEditable","handler","getValidator","getBorderRect","getTextElement","getTextContent","render_","nodeValue","getDisplayText_","updateSize_","constants","xOffset","FIELD_BORDER_RECT_X_PADDING","totalWidth","totalHeight","FIELD_TEXT_HEIGHT","contentWidth","FIELD_TEXT_FONTSIZE","FIELD_TEXT_FONTWEIGHT","FIELD_TEXT_FONTFAMILY","FIELD_BORDER_RECT_HEIGHT","positionTextElement_","positionBorderRect_","halfHeight","FIELD_TEXT_BASELINE","getAbsoluteXY_","_","NBSP","getText_","markDirty","forceRerender","bumpNeighbours","fireChangeEvent","classValidation","doClassValidation_","classValue","processValidation_","localValidation","localValue","doValueUpdate_","validatedValue","doValueInvalid_","_invalidValue","newTip","getTooltip","referencesVariables","refreshVariableName","getParentInput","parentInput","idx","fieldRows","getFlipRtl","isTabNavigable","onShortcut","_shortcut","updateMarkers_","Symbol","reservedWordsList","opt_variablePrefix","dbReverse","variableMap","variablePrefix","reservedWords","setVariableMap","getNameForUserVariable","populateVariables","NameType","VARIABLE","nameOrId","normalizedName","DEVELOPER_VARIABLE","typeDb","safeName","getDistinctName","getUserNames","userNames","encodeURI","name1","name2","PROCEDURE","DEVELOPER_VARIABLE_TYPE","ObservableProcedureMap","existed","Icon","offsetInBlock","workspaceLocation","svgRoot","pointerdownListener","svgBlock","updateSvgRootOffset","menuGenerator","svgArrow","imageElement","selectedMenuItem","generatedOptions","trimmed","menuGenerator_","selectedOption","shouldAddBorderRect_","FIELD_DROPDOWN_SVG_ARROW","createSVGArrow_","createTextArrow_","FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW","ARROW_CHAR","FIELD_DROPDOWN_SVG_ARROW_SIZE","FIELD_DROPDOWN_SVG_ARROW_DATAURI","dropdownCreate","menuElement","FIELD_DROPDOWN_COLOURED_DIV","primaryColour","getColour","colourTertiary","dropdownDispose_","image","Image","handleMenuActionEvent","onItemSelected_","useCache","isValueValid","fill","colourSecondary","colourPrimary","renderSelectedImage","renderSelectedText","imageJson","imageHeight","imageWidth","hasBorder","FIELD_DROPDOWN_BORDER_RECT_HEIGHT","IMAGE_Y_PADDING","xPadding","arrowWidth","positionSVGArrow","textWidth","textPadding","FIELD_DROPDOWN_SVG_ARROW_PADDING","svgArrowSize","CHECKMARK_OVERHANG","MAX_MENU_HEIGHT_VH","IMAGE_Y_OFFSET","_a","Bubble","anchor","ownerRect","relativeLeft","relativeTop","embossGroup","embossFilterId","tail","background","BORDER_WIDTH","contentContainer","onMouseDown","setAnchorLocation","relayout","positionByRect","positionRelativeToAnchor","renderTail","setPositionRelativeToAnchor","MIN_SIZE","getViewMetrics","optimalLeft","getOptimalRelativeLeft","optimalTop","getOptimalRelativeTop","topPosition","MIN_BLOCK_HEIGHT","startPosition","endPosition","bottomPosition","closerPosition","fartherPosition","topPositionOverlap","getOverlap","startPositionOverlap","closerPositionOverlap","fartherPositionOverlap","mostOverlap","relativeMin","workspaceRect","getWorkspaceViewRect","bubbleRight","bubbleLeft","getScrollbarThickness","relBubbleX","relBubbleY","relAnchorX","relAnchorY","rise","hypotenuse","angle","acos","rightAngle","rightRise","rightRun","cos","thickness","TAIL_THICKNESS","backoffRatio","ANCHOR_RADIUS","baseX1","baseY1","baseX2","baseY2","radians","TAIL_ANGLE","swirlAngle","swirlRise","TAIL_BEND","swirlRun","lastChild","_start","DOUBLE_BORDER","MiniWorkspaceBubble","workspaceOptions","validateWorkspaceOptions","svgDialog","miniWorkspace","newWorkspaceSvg","internalIsMutator","getCanvas","onWorkspaceChange","updateBubbleSize","addWorkspaceChangeListener","listener","bumpBlocksIntoBounds","MARGIN","currSize","calculateWorkspaceSize","MINIMUM_VIEW_CHANGE","recordDragTargets","workspaceSize","getBBox","flyoutScrollMetrics","updateBlockStyles","setStyle","getStyleName","flyoutWs","SIZE","WORKSPACE_MARGIN","flyoutBlockTypes","saveConnectionsListener","updateWorkspacePid","rootBlock","miniWorkspaceBubble","WEIGHT","getAnchorLocation","getMiniWorkspaceConfig","getBubbleOwnerRect","createRootBlock","addSaveConnectionsListener","createMiniWorkspaceChangeListener","removeChangeListener","midIcon","flyoutWidth","saveConnections","this.saveConnectionsListener","isIgnorableMutatorEvent","recomposeSourceBlock","oldExtraState","newExtraState","reconnect","connectionChild","findParentWs","WIN_KEY_FF_LINUX","MAC_ENTER","TAB","NUM_CENTER","ENTER","PAUSE","CAPS_LOCK","SPACE","PAGE_UP","PAGE_DOWN","END","HOME","PLUS_SIGN","PRINT_SCREEN","INSERT","ZERO","ONE","TWO","THREE","FOUR","FIVE","SIX","SEVEN","EIGHT","NINE","FF_SEMICOLON","FF_EQUALS","FF_DASH","FF_HASH","QUESTION_MARK","AT_SIGN","A","B","D","E","F","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","W","WIN_KEY_RIGHT","CONTEXT_MENU","NUM_ZERO","NUM_ONE","NUM_TWO","NUM_THREE","NUM_FOUR","NUM_FIVE","NUM_SIX","NUM_SEVEN","NUM_EIGHT","NUM_NINE","NUM_MULTIPLY","NUM_PLUS","NUM_MINUS","NUM_PERIOD","NUM_DIVISION","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","NUMLOCK","SCROLL_LOCK","FIRST_MEDIA_KEY","LAST_MEDIA_KEY","SEMICOLON","DASH","EQUALS","COMMA","PERIOD","SLASH","APOSTROPHE","TILDE","SINGLE_QUOTE","OPEN_SQUARE_BRACKET","BACKSLASH","CLOSE_SQUARE_BRACKET","WIN_KEY","MAC_FF_META","MAC_WK_CMD_LEFT","MAC_WK_CMD_RIGHT","WIN_IME","VK_NONAME","PHANTOM","aria","arrayUtils","browserEvents","deprecation","extensions","idGenerator","math","parsing","stringUtils","svgMath","svgPaths","userAgent","TextBubble","paragraph","stringToSvg","setText","createParagraph","spans","createSpans","rightAlignSpans","tspan","maxWidth","TextInputBubble","resizePointerMoveListener","resizePointerUpListener","textChangeListeners","sizeChangeListeners","inputRoot","textArea","createResizeHandle","onTextChange","addTextChangeListener","addSizeChangeListener","bindTextAreaEvents","onStartEdit","onResizePointerDown","widthMinusBorder","heightMinusBorder","onSizeChange","onResizePointerUp","onResizePointerMove","DEFAULT_BUBBLE_WIDTH","DEFAULT_BUBBLE_HEIGHT","textBubble","textInputBubble","bubbleSize","bubbleVisiblity","anchorLocation","oldText","newText","showEditableBubble","showNonEditableBubble","hideBubble","WarningIcon","textMap","addMessage","DuplicateIconType","exceptions","TypesContainer","NONE","HAT","SPACER","BETWEEN_ROW_SPACER","IN_ROW_SPACER","EXTERNAL_VALUE_INPUT","INLINE_INPUT","STATEMENT_INPUT","CONNECTION","PREVIOUS_CONNECTION","NEXT_CONNECTION","OUTPUT_CONNECTION","CORNER","LEFT_SQUARE_CORNER","LEFT_ROUND_CORNER","RIGHT_SQUARE_CORNER","RIGHT_ROUND_CORNER","JAGGED_EDGE","TOP_ROW","BOTTOM_ROW","INPUT_ROW","LEFT_CORNER","RIGHT_CORNER","nextTypeValue_","hasOwnProperty","isField","isHat","isSpacer","isInRowSpacer","isInput","isExternalInput","isInlineInput","isStatementInput","isPreviousConnection","isNextConnection","isPreviousOrNextConnection","isLeftRoundedCorner","isRightRoundedCorner","isLeftSquareCorner","isRightSquareCorner","isCorner","isJaggedEdge","isRow","row","isBetweenRowSpacer","isTopRow","isBottomRow","isTopOrBottomRow","isInputRow","Types","Measurable","centerline","xPos","notchOffset","NOTCH_OFFSET_LEFT","Row","elements","widthWithConnectedBlocks","minWidth","minHeight","hasStatement","hasExternalInput","statementEdge","hasJaggedEdge","hasDummyInput","hasInlineInput","align","getLastInput","measure","startsWithElemSpacer","endsWithElemSpacer","getFirstSpacer","getLastSpacer","BottomRow","hasNextConnection","descenderHeight","hasLeftSquareCorner","hasRightSquareCorner","_block","Connection","connectionModel","shapeFor","isHighlighted","InputConnection","connectionOffsetY","connectionOffsetX","connectedBlock","connectedBlockWidth","connectedBlockHeight","ExternalValueInput","TAB_OFFSET_FROM_TOP","MEDIUM_PADDING","EXTERNAL_VALUE_INPUT_PADDING","connectionHeight","connectionWidth","flipRtl","Hat","START_HAT","ascenderHeight","InRowSpacer","SPACER_DEFAULT_HEIGHT","InlineInput","EMPTY_INLINE_INPUT_HEIGHT","EMPTY_INLINE_INPUT_PADDING","STATEMENT_BOTTOM_SPACER","EMPTY_STATEMENT_INPUT_HEIGHT","STATEMENT_INPUT_NOTCH_OFFSET","InputRow","connectedBlockWidths","JaggedEdge","JAGGED_TEETH","NextConnection","OutputConnection","startX","PreviousConnection","RoundCorner","opt_position","CORNER_RADIUS","SpacerRow","precedesStatement","followsStatement","SquareCorner","NO_PADDING","TopRow","capline","hasPreviousConnection","hasHat","hat","ADD_START_HATS","prevBlock","getPreviousBlock","ConstantProvider","SMALL_PADDING","MEDIUM_LARGE_PADDING","LARGE_PADDING","TAB_HEIGHT","TAB_VERTICAL_OVERLAP","TAB_WIDTH","NOTCH_WIDTH","NOTCH_HEIGHT","MIN_BLOCK_WIDTH","EMPTY_BLOCK_SPACER_HEIGHT","STATEMENT_INPUT_PADDING_LEFT","BETWEEN_STATEMENT_PADDING_Y","START_HAT_HEIGHT","START_HAT_WIDTH","JAGGED_TEETH_HEIGHT","JAGGED_TEETH_WIDTH","FIELD_BORDER_RECT_Y_PADDING","FIELD_BORDER_RECT_COLOUR","FIELD_COLOUR_FULL_BLOCK","FIELD_TEXTINPUT_BOX_SHADOW","FIELD_COLOUR_DEFAULT_WIDTH","embossFilter","disabledPatternId","disabledPattern","debugFilterId","debugFilter","CURSOR_COLOUR","MARKER_COLOUR","CURSOR_WS_WIDTH","WS_CURSOR_HEIGHT","CURSOR_STACK_PADDING","CURSOR_BLOCK_PADDING","CURSOR_STROKE_WIDTH","FULL_BLOCK_FIELDS","INSERTION_MARKER_COLOUR","INSERTION_MARKER_OPACITY","SHAPES","PUZZLE","NOTCH","TALL_INPUT_FIELD_OFFSET_Y","DUMMY_INPUT_SHADOW_MIN_HEIGHT","DUMMY_INPUT_MIN_HEIGHT","TOP_ROW_MIN_HEIGHT","TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT","BOTTOM_ROW_MIN_HEIGHT","BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT","START_POINT","FIELD_COLOUR_DEFAULT_HEIGHT","FIELD_CHECKBOX_X_OFFSET","randomIdentifier","makeJaggedTeeth","makeNotch","makeStartHat","PUZZLE_TAB","makePuzzleTab","INSIDE_CORNERS","makeInsideCorners","OUTSIDE_CORNERS","makeOutsideCorners","setTheme","validatedBlockStyle_","setDynamicProperties_","setFontConstants_","setComponentConstants_","fontMetrics","getBlockStyleForColour","createBlockStyle_","getBlockStyle","valid","assign","parsedColour","generateSecondaryColour_","generateTertiaryColour_","inputColour","mainPath","path","makeMainPath","up","back","control1Y","overlap","control2Y","endPoint1","endPoint2","dir","outerWidth","innerWidth","innerTopLeftCorner","innerBottomLeftCorner","pathTop","pathBottom","topLeft","topRight","bottomLeft","bottomRight","rightHeight","selector","injectCSS_","feSpecularLighting","createDebugFilter","debugComponentTransfer","cssArray","getCSS_","cssNodeId","Drawer","inlinePath_","outlinePath_","block_","info_","topLeft_","drawOutline_","drawInternals_","updateConnectionHighlights","pathObject","setPath","flipRTL","recordSizeOnBlock_","hideHiddenIcons_","widthWithChildren","drawTop_","rows","drawJaggedEdge_","drawStatementInput_","drawValueInput_","drawRightSideRow_","drawBottom_","drawLeft_","topRow","positionPreviousConnection_","startY","positionExternalValueConnection_","innerHeight","positionStatementInputConnection_","bottomRow","elems","positionNextConnection_","rightCornerYOffset","outlinePath","positionOutputConnection_","tabBottom","drawInlineInput_","layoutField_","fieldInfo","connectionTop","connectionBottom","positionInlineInputConnection_","connX","connInfo","drawConnectionHighlightPath","removeConnectionHighlight","measurable","getExpressionConnectionHighlightPath","getStatementConnectionHighlightPath","addConnectionHighlight","getOffsetInBlock","connPath","yLen","xLen","Align","CENTRE","FieldLabel","textClass","class","setClass","cssClass","Input","appendField","insertFieldAt","removeField","opt_quiet","renderList","renderedConnection","startTrackingAll","stopTrackingAll","setCheck","check","setAlign","makeConnection","makeConnection_","DummyInput","EndRowInput","ValueInput","RenderInfo","inputRows","renderer_","isInline","createRows_","addElemSpacing_","addRowSpacing_","computeBounds_","alignRowElements_","finalize_","populateTopRow_","activeRow","iconInfo","lastInput","shouldStartNewRow_","addInput_","populateBottomRow_","hasPrevious","cornerClass","leftSquareCorner","rightSquareCorner","StatementInputMeasurable","currInput","prevInput","oldElems","getInRowSpacing_","prev","widestStatementRowFields","blockWidth","widestRowWithConnectedBlocks","statementInput","alignStatementRow_","currentWidth","missingSpace","getDesiredRowWidth_","desiredWidth","addAlignmentPadding_","_row","firstSpacer","lastSpacer","oldRows","makeSpacerRow_","getSpacerRowHeight_","getSpacerRowWidth_","spacer","_prev","_next","getElemCenterline_","recordElemPositions_","xCursor","yCursor","getMeasureableForConnection","ASTNode","opt_params","wsCoordinate","isConnectionLocation","isConnectionType","processParams","getLocation","getWsCoordinate","isConnection","findNextForInput","curIdx","NAVIGATE_ALL_FIELDS","createFieldNode","createInputNode","findNextForField","fieldIdx","newInput","findPrevForInput","findPrevForField","navigateBetweenStacks","curLocation","curLocationAsBlock","curRoot","resultIndex","createStackNode","findTopASTNodeForBlock","createConnectionNode","createBlockNode","getOutAstNodeForBlock","getTopStackBlock","findFirstFieldOrInput","STACK","OUTPUT","PREVIOUS","NEXT","in","out","blockPos","DEFAULT_OFFSET_Y","createWorkspaceNode","createTopNode","astNode","MarkerMove","isCursor","opt_oldNode","opt_newNode","oldNode","CURSOR_CLASS","MARKER_CLASS","HEIGHT_MULTIPLIER","MarkerSvg","markerSvgRect_","markerSvgLine_","markerInput_","markerBlock_","svgGroup_","currentMarkerSvg","defaultColour","colour_","createDomInternal_","setParent_","curNode","applyColour_","showAtLocation_","fireMarkerEvent","animate","connectionType","curNodeAsConnection","showWithBlock_","showWithOutput_","showWithInput_","showWithNext_","showWithPrevious_","showWithField_","showWithCoordinates_","showWithStack_","showWithBlockPrevOutput","markerHeight","markerOffset","connectionShape","positionPrevious_","positionOutput_","positionBlock_","showCurrent_","positionLine_","positionRect_","positionInput_","heightWidth","yPadding","markerPath","curBlock","getBlinkProperties_","blinkProperties","attributeName","_curNode","firstElementChild","PathObject","connectionHighlights","WeakMap","highlightOffsets","svgPath","pathString","updateShadow_","updateDisabled_","setClass_","updateHighlighted","updateSelected","updateDraggingDelete","updateInsertionMarker","updateReplacementFade","updateShapeForInputHighlight","_conn","connectionPath","currentHighlightMatchesNew","newPath","newOffset","currPath","currOffset","shadowDom","shadowState","connect_","parentBlock","disconnectInternal","orphan","stashShadowState","applyShadowState","setReason","setParent","orphanConnection","getConnectionForOrphanedConnection","onFailedConnect","setShadowStateInternal","unplug","isSuperior","_otherConnection","otherConnection","disconnect","getParentAndChildConnections","respawnShadow_","createShadowBlock","connectionParent","currentParent","onCheckChanged_","getCheck","returnCurrent","_maxLimit","serializeShadow","attemptToConnect","blockShadow","lastConnectionInStack","CAN_CONNECT","REASON_SELF_CONNECTION","REASON_WRONG_TYPE","REASON_TARGET_NULL","REASON_CHECKS_FAILED","REASON_DIFFERENT_WORKSPACES","REASON_SHADOW_PARENT","REASON_DRAG_CHECKS_FAILED","REASON_PREVIOUS_AND_OUTPUT","COLLAPSED_INPUT_NAME","COLLAPSED_FIELD_NAME","DUPLICATE_BLOCK_ERROR","InsertionMarkerManager","activeCandidate","lastMarker","lastOnStack","wouldDeleteBlock","fadedBlock","highlightedBlock","markerConnection","firstMarker","createMarkerBlock","availableConnections","initAvailableConnections","disposeInsertionMarker","updateAvailableConnections","wouldConnectBlock","applyConnections","hidePreview","local","inferiorConnection","then","newCandidate","getCandidate","shouldDelete","shouldUpdatePreviews","maybeHidePreview","maybeShowPreview","imType","setInsertionMarker","sourceInput","resultInput","sourceField","resultField","available","activeLocal","activeClosest","xDiff","yDiff","curDistance","getStartRadius","candidate","myConnection","neighbour","showPreview","getConnectionPreviewMethod","method","PREVIEW_TYPE","INPUT_OUTLINE","showInsertionInputOutline","INSERTION_MARKER","showInsertionMarker","REPLACEMENT_FADE","showReplacementFade","shouldHighlightConnection","localChanged","unhighlight","hideReplacementFade","hideInsertionInputOutline","hideInsertionMarker","insertionMarker","isLastInStack","imConn","getMatchingConnection","originalOffsetToTarget","originalOffsetInBlock","imConnConst","positionNearConnection","markerConn","imBlock","markerOutput","markerPrev","highlightShapeForInput","fadeForReplacement","PreviewType","Renderer","overrides","makeConstants_","refreshDom","previousConstants","makeRenderInfo_","makeDrawer_","makePathObject","orphanCanConnectAtEnd","localType","ThemeManager","subscribedWorkspaces_","componentDB","prevTheme","oldClassName","newClassName","refreshTheme","componentList","propertyName","setProperty","subscribeWorkspace","unsubscribeWorkspace","onCreateVariableButtonClick_String","onCreateVariableButtonClick_Number","onCreateVariableButtonClick_Colour","ConnectionChecker","opt_distance","safety","doSafetyChecks","doTypeChecks","doDragChecks","errorCode","superiorBlock","inferiorBlock","superiorConnection","checkArrayOne","checkArrayTwo","canConnectToPrevious_","VarDelete","VarRename","VariableMap","deleteVariable","conflictVar","renameVariableWithConflict_","renameVariableAndUses_","updateVarName","renameVarById","variableId","tempVar","variableName","uses","getVariableUsesById","procedureName","deleteText","confirmText","deleteVariableInternal","list","getVariableTypes","variableTypes","flat","Workspace","internalIsFlyout","isClearing","MAX_UNDO","connectionDBList","topComments","commentDB","listeners","undoStack_","redoStack_","blockDB","typedBlocksDB","procedureMap","connectionCheckerClass","sortObjects_","SCAN_ANGLE","aXY","bXY","addTopBlock","removeTopBlock","ordered","addTypedBlock","removeTypedBlock","filtered","remainingCapacity","remainingCapacityOfType","maxInstanceOfType","hasBlockLimits","copyableBlocksCount","redo","inputStack","outputStack","inputEvent","clearUndo","setBlockById","removeBlockById","allInputsFilled","opt_shadowBlocksAreFilled","createPotentialVariableMap","outerWs","getById","getAll","SOUND_LIMIT","WorkspaceAudio","sounds","lastSound_","muted","filenames","audioTest","filename","ext","canPlayType","sound","volume","playPromise","pause","catch","opt_volume","now","mySound","setMuted","getMuted","LayerManager","layers","dragLayer","createDragLayer","blockLayer","createLayer","bubbleLayer","translateLayers","newCoord","newScale","layer","layerNum","getSvgGroup","inserted","sortedLayers","num","sib","getBlockLayer","getBubbleLayer","ZOOM_TO_FIT_MARGIN","resizeHandlerWrapper","resizesEnabled","isVisible_","startScrollY","startScrollX","dragDeltaXY","oldLeft","oldTop","inverseScreenCTM","dummyWheelListener","configureContextMenu","lastRecordedPageScroll","toolbox_","inverseScreenCTMDirty","highlightedBlocks","toolboxCategoryCallbacks","flyoutButtonCallbacks","cachedParentSvg","topBoundedElements","dragTargetAreas","layerManager","MetricsManagerClass","setTopLevelWorkspaceMetrics_","audioManager","markerManager","Variables","registerToolboxCategoryCallback","VariablesDynamic","Procedures","themeManager_","cachedParentSvgSize","getMarkerManager","setMetricsManager","updateBlockStyles_","refreshToolboxSelection","ctm","opt_backgroundClass","svgBackground_","svgBlockCanvas_","svgBubbleCanvas_","this.dummyWheelListener","onMouseWheel_","ToolboxClass","CursorClass","parentSvg","newTrashcan","svgTrashcan","_workspace","svgZoomControls","HorizontalFlyout","VerticalFlyout","opt_own","updateScreenCalculations_","positionables","getUiMetrics","positionable","currScroll","maybeFireViewportChangeEvent","imList","highlightBlock","opt_state","pastedThing","pasteBlock_","pasteWorkspaceComment_","jsonBlock","collide","allBlocks","otherXY","refreshSelection","dragTargets","targetArea","getClientRect","clientRect","canWheelZoom","canWheelMove","scrollDelta","commandKey","PIXELS_PER_ZOOM_STEP","topElements","boundary","topElement","blockBoundary","cursorY","scaleChange","getCTM","center","f","setScale","svgWidth","svgHeight","zoomToFit","workspaceWidth","workspaceHeight","blocksBox","doubleMargin","blocksWidth","blocksHeight","ratioX","ratioY","centerOnBlock","blockOnly","pixelX","multiplier","pixelY","reflow","resizeView","resizeContent","getScale","maxYScroll","maxYDisplacement","maxXDisplacement","addTopBoundedElement","removeTopBoundedElement","reenabled","getButtonCallback","removeButtonCallback","getToolboxCategoryCallback","removeToolboxCategoryCallback","isStart","getGrid","onlyClosePopups","autoHideables","autoHideable","autoHide","xyRatio","TrashcanOpen","opt_isOpen","BlockDelete","oldXml","wasShadow","oldJson","Block","hue_","styleName_","suppressPrefixSuffix","contextMenu","parentBlock_","childBlocks_","editable_","movable_","deletable_","collapsed_","isShadow_","outputShape_","isInsertionMarker_","disposing","onchangeWrapper_","statementInputCount","isInMutator","doInit_","onchange","setOnChange","disposeInternal","destroy","opt_healStack","unplugFromRow_","unplugFromStack_","thisConnection","getOnlyValueConnection_","previousTarget","nextTarget","_all","myConnections","ignoreShadows","getInputWithBlock","getSurroundParent","previous","childBlocks","isSimpleReporter","otherConnections","setHelpUrl","getHue","parsed","onchangeFn","getVars","vars","newId","setFieldValue","setPreviousStatement","newBoolean","opt_check","setNextStatement","setOutput","setOutputShape","outputShape","getOutputShape","ancestor","opt_maxLength","opt_emptyToken","toTokens","acc","curr","emptyToken","checks","shouldAddParens","appendValueInput","appendInput","appendStatementInput","appendDummyInput","appendEndRowInput","appendInputFromRegistry","inputConstructor","warningPrefix","n","jsonInitStyle_","jsonInitColour_","interpolate_","localizedText","localizedValue","extensionNames","styleError","opt_disableCheck","overwrites","implicitAlign","validateTokens_","interpolateArguments_","fieldStack","isInputKeyword_","inputFromJson_","fieldFromJson_","argsCount","visitedArgsHash","visitedArgsCount","token","newlineInput","stringToFieldJson_","dummyInput","alignmentLookup","alignment","moveInputBefore","refName","inputIndex","refIndex","moveNumberedInputBefore","RangeError","removeInput","getInputTargetBlock","removeIcon","setWarningText","_text","_opt_id","_mutator","find","Marker","getCurNode","setCurNode","Cursor","BasicCursor","getNextNode_","validNode_","getPreviousNode_","isValid","siblingOrParent","findSiblingOrParent","getRightMostChild","nextNode","registrationName","TabNavigateCursor","BUMP_RANDOMNESS","RenderedConnection","dbOpposite","trackedState","TrackedState","WILL_TRACK","TRACKED","bumpAwayFrom","staticConnection","updated","moveToOffset","blockTL","tightenEfficiently","maxLimit","setTracking","doTracking","UNTRACKED","updateDisabled","parentRendered","childRendered","warningTextDb","warning","mutator","eventsInit_","renderIsInProgress_","visuallyDisabled","bumpNeighboursPid","dragging","createIconPointerDownListener","getColourSecondary","getColourTertiary","oldParent","oldXY","draggingBlock","eventsEnabled","currLoc","curXY","blockBounds","updateCollapsed_","collapsedInputName","collapsedFieldName","tab","tabCursor","currentNode","nextField","open","generateContextMenu","customContextMenu","updateConnectionLocations","updateIconLocations","updateFieldLocations","getCommentIcon","timeout","collapsedParent","COLLAPSED_WARNING_ID","removed","styleObj","track","all","oldGroup","bumpNeighboursInternal","sourceConnection","tightenChildrenEfficiently","nextHeightWidth","tabHeight","INLINE","DragTarget","_dragElement","DeleteArea","wouldDelete_","couldConnect","couldDeleteBlock","updateWouldDelete_","Trashcan","isLidOpen","minOpenness","lidTask","svgLid","lidOpen","flyoutWorkspaceOptions","onDelete","BODY_HEIGHT","LID_HEIGHT","SPRITE_LEFT","SPRITE_TOP","blockMouseDownWhenOpenable","click","mouseOver","mouseOut","animateLid","setLidOpen","hasContents","contentsIsOpen","openFlyout","string","blocklyStyle","fireUiEvent","closeFlyout","emptyContents","setMinOpenness","trashRect","MARGIN_HOTSPOT","frames","ANIMATION_FRAMES","setLidAngle","MAX_LID_ANGLE","OPACITY_MIN","OPACITY_MAX","ANIMATION_LENGTH","lidAngle","openAtRight","newMin","closeLid","trashcanOpen","cleanedJson","cleanBlockJson","HAS_BLOCKS_LID_ANGLE","cleanRec","blockInfo","shortcuts","keyMap","shortcut","registeredShortcut","addKeyMapping","allowCollision","shortcutName","removeAllKeyMappings","keyCode","opt_allowCollision","shortcutNames","removeKeyMapping","shortcutIdx","setKeyMap","newKeyMap","getKeyMap","legacyKeyMap","getRegistry","legacyRegistry","serializeKeyEvent_","getShortcutNamesByKeyCode","getKeyCodesByShortcutName","serializedKey","modifier","modifierKeys","getModifierState","checkModifiers_","modifiers","modifierKeyCode","Shift","Control","Alt","Meta","ProcedureSerializer","procState","VariableSerializer","variableStates","varState","priorities","addHorizontal","addVertical","oldHostMetrics_","corner_","vScroll","hScroll","isPair","resizeH","resizeV","setX","setY","MetricsManager","workspace_","getDimensionsPx_","getFlyoutMetrics","flyoutDimensions","getToolboxMetrics","toolboxDimensions","getSvgMetrics","getAbsoluteMetrics","flyoutMetrics","respectToolbox","respectFlyout","atTop","opt_getWorkspaceCoordinates","svgMetrics","vertToolbox","getContentMetrics","blockBox","getComputedFixedEdges_","opt_viewMetrics","hScrollEnabled","vScrollEnabled","edges","getPaddedContent_","contentMetrics","contentBottom","contentRight","halfWidth","opt_contentMetrics","fixedEdges","paddedContent","scrollMetrics","contentHeight","contentTop","contentLeft","toolboxWidth","toolboxHeight","flyoutHeight","FinishedLoading","opt_workspace","BlockDrag","opt_isStart","opt_blocks","bumpIntoBounds","BlockDragger","connectionCandidate","wouldDeleteBlock_","dragIconData_","draggingBlock_","connectionPreviewer","previewerConstructor","fireDragStartEvent_","shouldDisconnect_","disconnectBlock_","moveBlock","updateDragTargets","updateCursorDuringBlockDrag_","updateConnectionPreview","dragDelta","newDragTarget","getConnectionCandidate","currCandidate","currCandidateIsBetter","previewConnection","previewReplacement","currCandiate","currLocal","currNeighbour","localPos","neighbourPos","localConns","getLocalConnections","rad","fireDragEndEvent_","getNewLocationAfterDrag_","newValues","maybeDeleteBlock_","deleted","updateBlockAfterMove_","newLocation","updateToolboxStyle_","isEnd","removeStyle","addStyle","oldCoordinate","dragIcons_","BlockFieldIntermediateChange","BlockMove","currentLocation_","oldParentId","parentId","oldInputName","blockConnection","BubbleOpen","opt_bubbleType","BubbleType","CommentBase","opt_comment","CommentCreateDeleteHelper","CommentChange","opt_oldContents","opt_newContents","oldContents_","newContents_","CommentCreate","CommentDelete","CommentMove","comment_","oldCoordinate_","newCoordinate_","current","ToolboxItemSelect","opt_oldItem","opt_newItem","oldItem","newItem","BaseConstantProvider","GRID_UNIT","CURSOR_RADIUS","HEXAGONAL","ROUND","SQUARE","SHAPE_IN_SHAPE_PADDING","SELECTED_GLOW_COLOUR","SELECTED_GLOW_SIZE","REPLACEMENT_GLOW_COLOUR","REPLACEMENT_GLOW_SIZE","selectedGlowFilterId","selectedGlowFilter","replacementGlowFilterId","SQUARED","ROUNDED","replacementGlowFilter","STATEMENT_INPUT_SPACER_MIN_WIDTH","MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH","makeHexagonal","makeRounded","makeSquared","rightWidth","selectedGlowSize","replacementGlowSize","pathRightDown","pathRightUp","blockHeight","remainingHeight","maxHeight","sweep","_height","curveWidth","quarterHeight","innerTopRightCorner","innerBottomRightCorner","pathTopRight","pathBottomRight","selectedComponentTransfer","replacementComponentTransfer","BaseDrawer","beginDrawing","outputShapeType","endDrawing","hasStatementInput","drawFlatTop_","drawRightDynamicConnection_","drawFlatBottom_","drawLeftDynamicConnection_","insideCorners","cornerHeight","bottomRightPath","verticalPath","topRightPath","getInlineInputPath","setOutlinePath","connectedBottomNextConnection","FieldImage","altText","Y_PADDING","setAlt","setOnClickHandler","FieldInput","spellcheck_","htmlInput_","isTextValid_","isBeingEdited_","onKeyInputWrapper_","onKeyDownWrapper_","valueWhenEditorWasOpened_","fullBlockClickTarget_","spellcheck","resizeEditor_","htmlInput","INVALID","setSpellcheck","quietInput","showPromptEditor_","showInlineEditor_","getValueFromEditorText_","onFinishEditing_","widgetDispose_","widgetCreate_","borderRadius","BORDERRADIUS","strokeColour","border","boxShadow","getEditorText_","bindInputEvents_","unbindInputEvents_","_value","onHtmlInputKeyDown_","onHtmlInputChange_","setEditorValue_","bumped","FieldTextInput","BaseBottomRow","BaseStatementInput","RightConnectionShape","BaseTopRow","BaseRenderInfo","isMultiRow","rightSide","rightAlignedDummyInputs","adjustXPosition_","alignmentDivider","notchTotalWidth","minXPos","prevSpacer","nextSpacer","hasPrevNotch","hasNextNotch","prevInRowSpacer","finalizeOutputConnection_","outputConnectionShape","rightConnectionWidth","finalizeHorizontalAlignment_","totalNegativeSpacing","lastElem","leftNegPadding","getNegativeSpacing_","firstElem","rightNegPadding","minBlockWidth","outerShape","innerShape","finalizeVerticalAlignment_","firstRow","hasSingleTextOrImageField","hasNonShadowConnectedBlocks","minVerticalTightNestingHeight","BaseMarkerSvg","markerCircle","showWithInputOutput","positionCircle","BasePathObject","svgPathSelected","outlines","remainingOutlines","outline","getOutlinePath","removeOutlinePath","BaseRenderer","FieldAngle","clockwise","CLOCKWISE","OFFSET","WRAP","symbol_","gauge","mode","Mode","COMPASS","PROTRACTOR","updateGraph","editor","dropdownDispose","HALF","touchAction","circle","RADIUS","onMouseMove_","ownerSVGElement","displayMouseOrKeyboardValue","wrapValue","clockwiseFlag","angle1","largeFlag","isFinite","FieldCheckbox","checkChar","CHECK_CHAR","checkCharacter","getValueBoolean","setCheckCharacter","character","convertValueToBool_","FieldColour","highlightedIndex","picker","titles","colours","columns","colourOptions","colourTitles","borderRect","setColours","setColumns","cell","handled","moveHighlightBy","getHighlighted","COLOURS","COLUMNS","setHighlightedCell","onMouseEnter","onMouseLeave","cellId","TITLES","selectedColour","table","EXPANDED","ROWCOUNT","COLCOUNT","title","FieldLabelSerializable","FieldMultilineInput","textGroup","maxLines_","isOverflowedY_","maxLines","setMaxLines","textLines","displayLinesNumber","currentChild","lineHeight","nodes","actualEditorLines","dummyTextElement","lineWidth","paddingX","paddingY","padding","getMaxLines","FieldNumber","precision","min_","max_","precision_","decimalPlaces","setConstraints","setMinInternal","setMaxInternal","setPrecisionInternal","setMin","getMin","setMax","getMax","setPrecision","precisionString","toLocaleString","maximumFractionDigits","decimalIndex","getPrecision","toFixed","VALUEMIN","VALUEMAX","FieldVariable","defaultType","defaultVariableName","variableType","typeIsAllowed","typeList","isInArray","FlyoutButton","isLabel_","svgText","callbackKey","TEXT_MARGIN_X","TEXT_MARGIN_Y","updateTransform","onMouseUp","isLabel","getButtonText","FlyoutMetricsManager","flyout_","getBoundingBox_","blockBoundingBox","FlyoutItemType","BUTTON","Flyout","filterWrapper","reflowWrapper","mats","buttons_","permanentlyDisabled","recycledBlocks","SCROLLBAR_MARGIN","dragAngleRange_","setMetrics_","toolboxPosition_","tabWidth_","rectMap_","GAP_X","GAP_Y","wheel_","filterForCapacity","getFlyoutScale","setAutoClose","updateDisplay","positionAt_","listen","clearOldBlocks","getDynamicCategoryContents","parsedContent","flyoutInfo","createFlyoutInfo","layout_","gaps","emptyRecycledBlocks","defaultGap","categoryName","parsedDynamicContent","dynamicContents","dynamicGaps","createFlyoutBlock","addBlockGap","addSeparatorGap","createButton","fnToApply","btnInfo","curButton","getRecycledBlock","blockType","gap","sepInfo","newGap","oldBlocks","blockIsRecyclable_","recycleBlock","addBlockListeners_","blockMouseDown","originalBlock","placeNewBlock","initFlyoutButton_","buttonSvg","createRect_","blockHW","moveRectToBlock_","reflowInternal_","oldBlock","svgRootOld","positionNewBlock","flyoutOffsetPixels","oldBlockPos","oldBlockOffsetPixels","getX","getY","targetWorkspaceViewMetrics","setBackgroundPath","cursorX","moveX","dragDirection","atan2","range","flyoutRect","BIG_NUM","buttons","atRight","oldX","newX","registryName","CodeGenerator","forBlock","FUNCTION_NAME_PLACEHOLDER_","STATEMENT_SUFFIX","STATEMENT_PREFIX","INFINITE_LOOP_TRAP","INDENT","COMMENT_WRAP","ORDER_OVERRIDES","isInitialized","RESERVED_WORDS_","definitions_","functionNames_","nameDB_","FUNCTION_NAME_PLACEHOLDER_REGEXP_","RegExp","workspaceToCode","code","blockToCode","scrubNakedValue","injectId","codeString","finish","prefixLines","allNestedComments","opt_thisOnly","scrub_","SyntaxError","valueToCode","outerOrder","innerOrder","parensNeeded","outerOrderClass","innerOrderClass","statementToCode","addLoopTrap","branch","addReservedWords","provideFunction_","desiredName","functionName","codeText","oldCodeText","getVariableName","getProcedureName","_opt_thisOnly","InsertionMarkerPreviewer","draggedBlock","staticConn","draggedConn","replacedBlock","shouldUseMarkerPreview","previewMarker","_draggedConn","ZelosRenderer","dragged","createInsertionMarker","origBlock","orig","origConn","origConns","markerConns","DARK_PATH_OFFSET","MAX_BOTTOM_WIDTH","Highlighter","inlineSteps_","steps_","RTL_","highlightConstants_","getHighlightConstants","highlightOffset","outsideCornerPaths_","OUTSIDE_CORNER","insideCornerPaths_","INSIDE_CORNER","puzzleTabPaths_","notchPaths_","startPaths_","jaggedTeethPaths_","getPath","drawTopCorner","drawValueInput","belowTabHeight","drawStatementInput","drawRightSideRow","rightEdge","drawBottomRow","cornerElem","drawLeft","drawInlineInput","connectionRight","bottomHighlightWidth","aboveTabHeight","highlighter_","setHighlightPath","HighlightConstantProvider","constantProvider","makeInsideCorner","makeOutsideCorner","distance45outside","SQRT1_2","pathTopRtl","pathBottomRtl","pathBottomLtr","distance45inside","topLeftCornerHighlightRtl","topLeftCornerHighlightLtr","bottomLeftStartY","bottomLeftPath","highlightRtlUp","highlightRtlDown","verticalOverlap","highlightLtrUp","highlightLtrDown","hatHeight","pathRtl","pathLtr","BaseInlineInput","hasExternalInputs","nextRightEdge","rowNextRightEdges","prevRightEdge","heightWithoutHat","diff","colourDark","svgPathDark","svgPathLight","highlightPath","highlightConstants","makeHighlightConstants_","Zelos","ToolboxItem","toolboxItemDef","parentToolbox","level_","parent_","getLevel","toolboxItemDef_","parentToolbox_","getClickTarget","isCollapsible","setVisible_","_isVisible","ToolboxCategory","categoryDef","labelDom_","iconDom_","rowContents_","rowDiv_","htmlDiv_","isDisabled_","isHidden_","flyoutItems_","cssConfig_","makeDefaultCssConfig_","parseCategoryDef_","parseContents_","createDom_","flyoutItem","itemDef","getColour_","createContainer_","LEVEL","createRowContainer_","pointerEvents","createRowContentsContainer_","createIconDom_","createLabelDom_","LABELLEDBY","addColourBorder_","rowDiv","nestedPadding","paddingRight","paddingLeft","contentsContainer","toolboxIcon","isHorizontal","toolboxLabel","borderWidth","borderRight","borderLeft","styleName","getColourfromStyle_","parseColour_","colourValue","openIcon_","iconDiv","closedIconClass","closeIcon_","openIconClass","getSelectedItem","clearSelection","allAncestorsExpanded_","category","isExpanded","isSelected","defaultBackgroundColour","setDisabled","isDisabled","getContents","updateFlyoutContents","newDefinition","kind","custom","categorystyle","cssconfig","hidden","ToolboxSeparator","separatorDef","CollapsibleToolboxCategory","subcategoriesDiv_","expanded_","toolboxItems_","cssConfig","prevIsFlyoutItem","createToolboxItem_","ToolboxItemClass","setExpanded","subCategories","getChildToolboxItems","createSubCategoriesDom_","subcategories","newCategory","newCategoryDiv","handleToolboxItemResize","childToolboxItems","toggleExpanded","Toolbox","contentsDiv_","HtmlDiv","contents_","previouslySelectedItem_","selectedItem_","boundEvents_","toolboxDef_","horizontalLayout_","contentMap_","createFlyout_","themeManager","createContentsContainer_","attachEvents_","toolboxContainer","flexDirection","clickEvent","onClick_","keyDownEvent","onKeyDown_","itemId","getToolboxItemById","setSelectedItem","selectNext_","selectPrevious_","selectParent_","selectChild_","FlyoutClass","renderContents_","fragment","createDocumentFragment","addToolboxItem_","toolboxItemDom","getToolboxItems","toolboxRect","_couldConnect","updateCursorDeleteStyle_","getPreviouslySelectedItem","workspaceMetrics","toolboxDiv","childAsCategory","shouldDeselectItem_","deselectItem_","shouldSelectItem_","selectItem_","updateFlyout_","fireSelectEvent_","selectItemByPosition","oldElement","collapsibleItem","nextItemIdx","nextItem","prevItemIdx","prevItem","VERSION","ALIGN_LEFT","ALIGN_CENTRE","ALIGN_RIGHT","DUMMY_INPUT","TOOLBOX_AT_TOP","TOOLBOX_AT_BOTTOM","TOOLBOX_AT_LEFT","TOOLBOX_AT_RIGHT","VARIABLE_CATEGORY_NAME","VARIABLE_DYNAMIC_CATEGORY_NAME","PROCEDURE_CATEGORY_NAME","Workspace.prototype.newBlock","WorkspaceSvg.prototype.newBlock","WorkspaceSvg.newTrashcan","WorkspaceCommentSvg.prototype.showContextMenu","MiniWorkspaceBubble.prototype.newWorkspaceSvg","Names.prototype.populateProcedures","flattenedProcedures","DropDownDiv","dropDownDiv","connectionTypes","ContextMenu","ContextMenuItems","Css","Events","Extensions","ShortcutItems","Themes","Tooltip","Touch","WidgetDiv","Xml","blockAnimations","blockRendering","bubbles","bumpObjects","clipboard","common","dialog","fieldRegistry","geras","minimalist","renderManagement","serialization","thrasos","uiPosition","utils","zelos","defineProperties","Blockly","HSV_SATURATION","HSV_VALUE"],"version":3,"file":"index.693b7d15.js.map","sourceRoot":"/__parcel_source_root/"}